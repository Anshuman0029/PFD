Namespace(active=1.0, anneal_factor=0.5, batch_size=128, ci=0, client_num_in_total=5, client_num_per_round=5, client_optimizer='sgd', comm_round=100, cs='random', data_dir='/Date/FL/DisPFL-master/data/', dataset='mnist', dense_ratio=0.5, diff_spa=False, different_initial=True, dis_gradient_check=True, epochs=5, erk_power_scale=1, frac=1.0, frequency_of_the_test=1, global_test=False, gpu=0, identity='DisPFL-mnist-dir0.3-mdlcnn_mnist-csrandom-ERK_init-diff_init-DST-cm100-total_clnt5-neighbor5-dr0.5-active1.0-seed1118', lr=0.1, lr_decay=0.998, model='cnn_mnist', momentum=0, partition_alpha=0.3, partition_method='dir', public_portion=0, record_mask_diff=False, save_masks=False, seed=1118, static=False, strict_avg=False, tag='test', uniform=False, wd=0.0005)
cuda:0
*********partition data***************
train_num12000  test_num2004
client_idx = 0, local_sample_number = 12000
train_num12000  test_num2004
client_idx = 1, local_sample_number = 12000
train_num12000  test_num2004
client_idx = 2, local_sample_number = 12000
train_num12000  test_num2004
client_idx = 3, local_sample_number = 12000
train_num12000  test_num2004
client_idx = 4, local_sample_number = 12000
DATA Partition: Train [4737, 2203, 407, 9, 5, 2873, 9, 777, 533, 447]; Test [790, 368, 68, 2, 1, 479, 2, 130, 89, 75]
DATA Partition: Train [720, 1035, 2609, 3833, 50, 1832, 0, 65, 775, 1081]; Test [120, 173, 435, 639, 9, 306, 0, 11, 130, 181]
DATA Partition: Train [502, 1733, 862, 1214, 1405, 0, 2761, 356, 1362, 1805]; Test [84, 289, 144, 203, 235, 0, 461, 60, 227, 301]
DATA Partition: Train [0, 855, 1009, 798, 2679, 1162, 2552, 1541, 650, 754]; Test [0, 143, 169, 133, 447, 194, 426, 257, 109, 126]
DATA Partition: Train [41, 174, 1113, 146, 1861, 133, 678, 3261, 2680, 1913]; Test [7, 29, 186, 25, 311, 23, 113, 544, 447, 319]
CNNMnist(
  (conv1): Conv2d(1, 10, kernel_size=(5, 5), stride=(1, 1))
  (conv2): Conv2d(10, 20, kernel_size=(5, 5), stride=(1, 1))
  (conv2_drop): Dropout2d(p=0.5, inplace=False)
  (fc1): Linear(in_features=320, out_features=50, bias=True)
  (fc2): Linear(in_features=50, out_features=10, bias=True)
)
############setup_clients (START)#############
self.local_sample_number = 12000
self.local_sample_number = 12000
self.local_sample_number = 12000
self.local_sample_number = 12000
self.local_sample_number = 12000
############setup_clients (END)#############
initialize by ERK
################Communication round : 0
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 0
local mask changes: 0.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [0.0, 9528.0, 9488.0, 9484.0, 9378.0]
Doing local aggregation!
test acc on this client before 71 / 2004 : 0.04
Client Index = 0	Epoch: 0	Loss: 1.195584
Client Index = 0	Epoch: 1	Loss: 0.536039
Client Index = 0	Epoch: 2	Loss: 0.405292
Client Index = 0	Epoch: 3	Loss: 0.343453
Client Index = 0	Epoch: 4	Loss: 0.328031
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 1
local mask changes: 0.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9528.0, 0.0, 9370.0, 9266.0, 9430.0]
Doing local aggregation!
test acc on this client before 233 / 2004 : 0.12
Client Index = 1	Epoch: 0	Loss: 1.393673
Client Index = 1	Epoch: 1	Loss: 0.678541
Client Index = 1	Epoch: 2	Loss: 0.530710
Client Index = 1	Epoch: 3	Loss: 0.464643
Client Index = 1	Epoch: 4	Loss: 0.431101
test acc on this client after 1846 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 2
local mask changes: 0.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9488.0, 9370.0, 0.0, 9556.0, 9542.0]
Doing local aggregation!
test acc on this client before 145 / 2004 : 0.07
Client Index = 2	Epoch: 0	Loss: 1.655475
Client Index = 2	Epoch: 1	Loss: 1.021531
Client Index = 2	Epoch: 2	Loss: 0.881724
Client Index = 2	Epoch: 3	Loss: 0.832743
Client Index = 2	Epoch: 4	Loss: 0.790254
test acc on this client after 1501 / 2004 : 0.75
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 3
local mask changes: 0.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9484.0, 9266.0, 9556.0, 0.0, 9518.0]
Doing local aggregation!
test acc on this client before 276 / 2004 : 0.14
Client Index = 3	Epoch: 0	Loss: 1.773193
Client Index = 3	Epoch: 1	Loss: 1.140270
Client Index = 3	Epoch: 2	Loss: 0.965163
Client Index = 3	Epoch: 3	Loss: 0.891311
Client Index = 3	Epoch: 4	Loss: 0.829073
test acc on this client after 1489 / 2004 : 0.74
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 4
local mask changes: 0.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9378.0, 9430.0, 9542.0, 9518.0, 0.0]
Doing local aggregation!
test acc on this client before 174 / 2004 : 0.09
Client Index = 4	Epoch: 0	Loss: 1.340216
Client Index = 4	Epoch: 1	Loss: 0.793700
Client Index = 4	Epoch: 2	Loss: 0.712438
Client Index = 4	Epoch: 3	Loss: 0.659278
Client Index = 4	Epoch: 4	Loss: 0.636506
test acc on this client after 1631 / 2004 : 0.81
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.8491977935902616}
################local_test_on_all_clients after local training in communication round: 0
{'test_acc_after': 0.8318363273453094, 'test_loss_after': 0.46143113484758586}
################local_test_on_all_clients before local training in communication round: 0
{'test_acc_before': 0.08972055888223554, 'test_loss_before': 2.3057456316348324}
################Communication round : 1
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 0
local mask changes: 6302.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6302.0, 9478.0, 9470.0, 9466.0, 9366.0]
Doing local aggregation!
test acc on this client before 1090 / 2004 : 0.54
Client Index = 0	Epoch: 0	Loss: 0.455171
Client Index = 0	Epoch: 1	Loss: 0.328714
Client Index = 0	Epoch: 2	Loss: 0.296414
Client Index = 0	Epoch: 3	Loss: 0.281221
Client Index = 0	Epoch: 4	Loss: 0.257853
test acc on this client after 1901 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 1
local mask changes: 6400.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9450.0, 6400.0, 9360.0, 9380.0, 9500.0]
Doing local aggregation!
test acc on this client before 1413 / 2004 : 0.71
Client Index = 1	Epoch: 0	Loss: 0.569719
Client Index = 1	Epoch: 1	Loss: 0.425280
Client Index = 1	Epoch: 2	Loss: 0.384326
Client Index = 1	Epoch: 3	Loss: 0.355806
Client Index = 1	Epoch: 4	Loss: 0.342868
test acc on this client after 1871 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 2
local mask changes: 6400.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9464.0, 9372.0, 6400.0, 9468.0, 9616.0]
Doing local aggregation!
test acc on this client before 1082 / 2004 : 0.54
Client Index = 2	Epoch: 0	Loss: 0.904062
Client Index = 2	Epoch: 1	Loss: 0.795144
Client Index = 2	Epoch: 2	Loss: 0.749769
Client Index = 2	Epoch: 3	Loss: 0.731087
Client Index = 2	Epoch: 4	Loss: 0.705517
test acc on this client after 1528 / 2004 : 0.76
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 3
local mask changes: 6352.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9552.0, 9368.0, 9430.0, 6352.0, 9446.0]
Doing local aggregation!
test acc on this client before 719 / 2004 : 0.36
Client Index = 3	Epoch: 0	Loss: 0.967767
Client Index = 3	Epoch: 1	Loss: 0.843326
Client Index = 3	Epoch: 2	Loss: 0.788526
Client Index = 3	Epoch: 3	Loss: 0.749473
Client Index = 3	Epoch: 4	Loss: 0.722960
test acc on this client after 1510 / 2004 : 0.75
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 4
local mask changes: 6322.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9334.0, 9450.0, 9452.0, 9506.0, 6322.0]
Doing local aggregation!
test acc on this client before 1454 / 2004 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.714463
Client Index = 4	Epoch: 1	Loss: 0.608918
Client Index = 4	Epoch: 2	Loss: 0.563933
Client Index = 4	Epoch: 3	Loss: 0.539869
Client Index = 4	Epoch: 4	Loss: 0.521213
test acc on this client after 1718 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.5841359473321033}
################local_test_on_all_clients after local training in communication round: 1
{'test_acc_after': 0.8510978043912176, 'test_loss_after': 0.4004881562081402}
################local_test_on_all_clients before local training in communication round: 1
{'test_acc_before': 0.5746506986027944, 'test_loss_before': 1.1759612905527068}
################Communication round : 2
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 0
local mask changes: 6360.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6360.0, 9212.0, 9144.0, 9112.0, 9144.0]
Doing local aggregation!
test acc on this client before 1627 / 2004 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.338348
Client Index = 0	Epoch: 1	Loss: 0.270420
Client Index = 0	Epoch: 2	Loss: 0.244878
Client Index = 0	Epoch: 3	Loss: 0.244271
Client Index = 0	Epoch: 4	Loss: 0.232220
test acc on this client after 1897 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 1
local mask changes: 6310.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9142.0, 6310.0, 9244.0, 9202.0, 9180.0]
Doing local aggregation!
test acc on this client before 1676 / 2004 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.423261
Client Index = 1	Epoch: 1	Loss: 0.365357
Client Index = 1	Epoch: 2	Loss: 0.336875
Client Index = 1	Epoch: 3	Loss: 0.324108
Client Index = 1	Epoch: 4	Loss: 0.310938
test acc on this client after 1870 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 2
local mask changes: 6414.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9134.0, 9230.0, 6414.0, 9236.0, 9154.0]
Doing local aggregation!
test acc on this client before 1211 / 2004 : 0.60
Client Index = 2	Epoch: 0	Loss: 0.771007
Client Index = 2	Epoch: 1	Loss: 0.713134
Client Index = 2	Epoch: 2	Loss: 0.683681
Client Index = 2	Epoch: 3	Loss: 0.673423
Client Index = 2	Epoch: 4	Loss: 0.654857
test acc on this client after 1566 / 2004 : 0.78
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 3
local mask changes: 6368.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9162.0, 9118.0, 9138.0, 6368.0, 9204.0]
Doing local aggregation!
test acc on this client before 1033 / 2004 : 0.52
Client Index = 3	Epoch: 0	Loss: 0.802576
Client Index = 3	Epoch: 1	Loss: 0.737438
Client Index = 3	Epoch: 2	Loss: 0.720210
Client Index = 3	Epoch: 3	Loss: 0.687416
Client Index = 3	Epoch: 4	Loss: 0.688213
test acc on this client after 1603 / 2004 : 0.80
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 4
local mask changes: 6246.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9110.0, 9228.0, 9010.0, 9146.0, 6246.0]
Doing local aggregation!
test acc on this client before 1517 / 2004 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.598491
Client Index = 4	Epoch: 1	Loss: 0.544932
Client Index = 4	Epoch: 2	Loss: 0.507516
Client Index = 4	Epoch: 3	Loss: 0.486910
Client Index = 4	Epoch: 4	Loss: 0.483021
test acc on this client after 1735 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.5137400667305957}
################local_test_on_all_clients after local training in communication round: 2
{'test_acc_after': 0.865369261477046, 'test_loss_after': 0.3689360445309542}
################local_test_on_all_clients before local training in communication round: 2
{'test_acc_before': 0.7049900199600799, 'test_loss_before': 0.7744868835527263}
################Communication round : 3
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 0
local mask changes: 6346.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6346.0, 8804.0, 8794.0, 8828.0, 8804.0]
Doing local aggregation!
test acc on this client before 1715 / 2004 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.281674
Client Index = 0	Epoch: 1	Loss: 0.238504
Client Index = 0	Epoch: 2	Loss: 0.225172
Client Index = 0	Epoch: 3	Loss: 0.220651
Client Index = 0	Epoch: 4	Loss: 0.212875
test acc on this client after 1902 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 1
local mask changes: 6300.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8728.0, 6300.0, 8834.0, 8898.0, 8912.0]
Doing local aggregation!
test acc on this client before 1749 / 2004 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.375500
Client Index = 1	Epoch: 1	Loss: 0.323412
Client Index = 1	Epoch: 2	Loss: 0.311536
Client Index = 1	Epoch: 3	Loss: 0.294026
Client Index = 1	Epoch: 4	Loss: 0.273783
test acc on this client after 1888 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 2
local mask changes: 6378.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8884.0, 8910.0, 6378.0, 8852.0, 8722.0]
Doing local aggregation!
test acc on this client before 1250 / 2004 : 0.62
Client Index = 2	Epoch: 0	Loss: 0.713811
Client Index = 2	Epoch: 1	Loss: 0.674435
Client Index = 2	Epoch: 2	Loss: 0.657051
Client Index = 2	Epoch: 3	Loss: 0.647054
Client Index = 2	Epoch: 4	Loss: 0.628687
test acc on this client after 1625 / 2004 : 0.81
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 3
local mask changes: 6366.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8824.0, 8774.0, 8776.0, 6366.0, 8870.0]
Doing local aggregation!
test acc on this client before 1174 / 2004 : 0.59
Client Index = 3	Epoch: 0	Loss: 0.750571
Client Index = 3	Epoch: 1	Loss: 0.693879
Client Index = 3	Epoch: 2	Loss: 0.670442
Client Index = 3	Epoch: 3	Loss: 0.659362
Client Index = 3	Epoch: 4	Loss: 0.636573
test acc on this client after 1591 / 2004 : 0.79
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 4
local mask changes: 6330.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8854.0, 8852.0, 8698.0, 8804.0, 6330.0]
Doing local aggregation!
test acc on this client before 1543 / 2004 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.532314
Client Index = 4	Epoch: 1	Loss: 0.495901
Client Index = 4	Epoch: 2	Loss: 0.477725
Client Index = 4	Epoch: 3	Loss: 0.459833
Client Index = 4	Epoch: 4	Loss: 0.452307
test acc on this client after 1752 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.4762831225325453}
################local_test_on_all_clients after local training in communication round: 3
{'test_acc_after': 0.8740518962075849, 'test_loss_after': 0.3501754710536279}
################local_test_on_all_clients before local training in communication round: 3
{'test_acc_before': 0.741616766467066, 'test_loss_before': 0.6311620086490989}
################Communication round : 4
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 0
local mask changes: 6284.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6284.0, 8342.0, 8460.0, 8484.0, 8442.0]
Doing local aggregation!
test acc on this client before 1792 / 2004 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.251350
Client Index = 0	Epoch: 1	Loss: 0.220230
Client Index = 0	Epoch: 2	Loss: 0.209695
Client Index = 0	Epoch: 3	Loss: 0.196053
Client Index = 0	Epoch: 4	Loss: 0.188421
test acc on this client after 1915 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 1
local mask changes: 6338.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8488.0, 6338.0, 8584.0, 8584.0, 8534.0]
Doing local aggregation!
test acc on this client before 1823 / 2004 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.338207
Client Index = 1	Epoch: 1	Loss: 0.294632
Client Index = 1	Epoch: 2	Loss: 0.285712
Client Index = 1	Epoch: 3	Loss: 0.270321
Client Index = 1	Epoch: 4	Loss: 0.268395
test acc on this client after 1890 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 2
local mask changes: 6356.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8514.0, 8434.0, 6356.0, 8392.0, 8516.0]
Doing local aggregation!
test acc on this client before 1288 / 2004 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.675425
Client Index = 2	Epoch: 1	Loss: 0.640380
Client Index = 2	Epoch: 2	Loss: 0.625761
Client Index = 2	Epoch: 3	Loss: 0.621753
Client Index = 2	Epoch: 4	Loss: 0.604511
test acc on this client after 1629 / 2004 : 0.81
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 3
local mask changes: 6404.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8402.0, 8430.0, 8358.0, 6404.0, 8502.0]
Doing local aggregation!
test acc on this client before 1266 / 2004 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.699194
Client Index = 3	Epoch: 1	Loss: 0.650375
Client Index = 3	Epoch: 2	Loss: 0.635334
Client Index = 3	Epoch: 3	Loss: 0.626770
Client Index = 3	Epoch: 4	Loss: 0.610023
test acc on this client after 1620 / 2004 : 0.81
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 4
local mask changes: 6436.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8562.0, 8584.0, 8458.0, 8376.0, 6436.0]
Doing local aggregation!
test acc on this client before 1591 / 2004 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.489692
Client Index = 4	Epoch: 1	Loss: 0.454796
Client Index = 4	Epoch: 2	Loss: 0.447497
Client Index = 4	Epoch: 3	Loss: 0.432053
Client Index = 4	Epoch: 4	Loss: 0.428829
test acc on this client after 1773 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.446616335314639}
################local_test_on_all_clients after local training in communication round: 4
{'test_acc_after': 0.8809381237524951, 'test_loss_after': 0.3249140176557733}
################local_test_on_all_clients before local training in communication round: 4
{'test_acc_before': 0.7744510978043913, 'test_loss_before': 0.5466290856906754}
################Communication round : 5
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 0
local mask changes: 6320.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6320.0, 8224.0, 8240.0, 8080.0, 8324.0]
Doing local aggregation!
test acc on this client before 1777 / 2004 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.231886
Client Index = 0	Epoch: 1	Loss: 0.202807
Client Index = 0	Epoch: 2	Loss: 0.192627
Client Index = 0	Epoch: 3	Loss: 0.185862
Client Index = 0	Epoch: 4	Loss: 0.181866
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 1
local mask changes: 6394.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8186.0, 6394.0, 8246.0, 8174.0, 8184.0]
Doing local aggregation!
test acc on this client before 1799 / 2004 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.318759
Client Index = 1	Epoch: 1	Loss: 0.279151
Client Index = 1	Epoch: 2	Loss: 0.265613
Client Index = 1	Epoch: 3	Loss: 0.261778
Client Index = 1	Epoch: 4	Loss: 0.255378
test acc on this client after 1893 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 2
local mask changes: 6238.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8276.0, 8260.0, 6238.0, 8112.0, 8204.0]
Doing local aggregation!
test acc on this client before 1265 / 2004 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.640358
Client Index = 2	Epoch: 1	Loss: 0.616319
Client Index = 2	Epoch: 2	Loss: 0.601563
Client Index = 2	Epoch: 3	Loss: 0.589274
Client Index = 2	Epoch: 4	Loss: 0.584355
test acc on this client after 1643 / 2004 : 0.82
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 3
local mask changes: 6280.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8294.0, 8284.0, 8204.0, 6280.0, 8146.0]
Doing local aggregation!
test acc on this client before 1265 / 2004 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.652824
Client Index = 3	Epoch: 1	Loss: 0.639962
Client Index = 3	Epoch: 2	Loss: 0.611670
Client Index = 3	Epoch: 3	Loss: 0.605684
Client Index = 3	Epoch: 4	Loss: 0.591559
test acc on this client after 1632 / 2004 : 0.81
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 4
local mask changes: 6394.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8214.0, 8288.0, 8128.0, 8166.0, 6394.0]
Doing local aggregation!
test acc on this client before 1669 / 2004 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.474211
Client Index = 4	Epoch: 1	Loss: 0.438680
Client Index = 4	Epoch: 2	Loss: 0.427217
Client Index = 4	Epoch: 3	Loss: 0.415327
Client Index = 4	Epoch: 4	Loss: 0.409371
test acc on this client after 1766 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.42696404893030515}
################local_test_on_all_clients after local training in communication round: 5
{'test_acc_after': 0.883932135728543, 'test_loss_after': 0.31760430960598107}
################local_test_on_all_clients before local training in communication round: 5
{'test_acc_before': 0.7759481037924152, 'test_loss_before': 0.5498738785941681}
################Communication round : 6
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 0
local mask changes: 6254.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6254.0, 7924.0, 8072.0, 7952.0, 8030.0]
Doing local aggregation!
test acc on this client before 1795 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.224500
Client Index = 0	Epoch: 1	Loss: 0.193272
Client Index = 0	Epoch: 2	Loss: 0.181012
Client Index = 0	Epoch: 3	Loss: 0.173039
Client Index = 0	Epoch: 4	Loss: 0.172456
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 1
local mask changes: 6332.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7996.0, 6332.0, 7998.0, 7930.0, 8000.0]
Doing local aggregation!
test acc on this client before 1821 / 2004 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.297517
Client Index = 1	Epoch: 1	Loss: 0.267504
Client Index = 1	Epoch: 2	Loss: 0.265445
Client Index = 1	Epoch: 3	Loss: 0.253240
Client Index = 1	Epoch: 4	Loss: 0.245449
test acc on this client after 1892 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 2
local mask changes: 6220.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8110.0, 8066.0, 6220.0, 7912.0, 7838.0]
Doing local aggregation!
test acc on this client before 1342 / 2004 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.616923
Client Index = 2	Epoch: 1	Loss: 0.598363
Client Index = 2	Epoch: 2	Loss: 0.579311
Client Index = 2	Epoch: 3	Loss: 0.572303
Client Index = 2	Epoch: 4	Loss: 0.565114
test acc on this client after 1645 / 2004 : 0.82
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 3
local mask changes: 6328.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [8116.0, 7978.0, 7994.0, 6328.0, 7950.0]
Doing local aggregation!
test acc on this client before 1359 / 2004 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.643181
Client Index = 3	Epoch: 1	Loss: 0.610559
Client Index = 3	Epoch: 2	Loss: 0.589166
Client Index = 3	Epoch: 3	Loss: 0.578224
Client Index = 3	Epoch: 4	Loss: 0.574422
test acc on this client after 1657 / 2004 : 0.83
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 4
local mask changes: 6352.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7956.0, 7994.0, 7960.0, 7964.0, 6352.0]
Doing local aggregation!
test acc on this client before 1651 / 2004 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.445365
Client Index = 4	Epoch: 1	Loss: 0.424223
Client Index = 4	Epoch: 2	Loss: 0.418413
Client Index = 4	Epoch: 3	Loss: 0.403041
Client Index = 4	Epoch: 4	Loss: 0.401034
test acc on this client after 1792 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.4117230701509942}
################local_test_on_all_clients after local training in communication round: 6
{'test_acc_after': 0.8897205588822354, 'test_loss_after': 0.3072652281936771}
################local_test_on_all_clients before local training in communication round: 6
{'test_acc_before': 0.7952095808383233, 'test_loss_before': 0.5019561477525982}
################Communication round : 7
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 0
local mask changes: 6360.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6360.0, 7816.0, 7806.0, 7814.0, 7810.0]
Doing local aggregation!
test acc on this client before 1788 / 2004 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.205847
Client Index = 0	Epoch: 1	Loss: 0.179567
Client Index = 0	Epoch: 2	Loss: 0.182696
Client Index = 0	Epoch: 3	Loss: 0.171245
Client Index = 0	Epoch: 4	Loss: 0.165753
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 1
local mask changes: 6326.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7748.0, 6326.0, 7852.0, 7822.0, 7870.0]
Doing local aggregation!
test acc on this client before 1853 / 2004 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.294912
Client Index = 1	Epoch: 1	Loss: 0.259996
Client Index = 1	Epoch: 2	Loss: 0.250050
Client Index = 1	Epoch: 3	Loss: 0.245927
Client Index = 1	Epoch: 4	Loss: 0.238968
test acc on this client after 1895 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 2
local mask changes: 6314.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7918.0, 7912.0, 6314.0, 7854.0, 7734.0]
Doing local aggregation!
test acc on this client before 1375 / 2004 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.614273
Client Index = 2	Epoch: 1	Loss: 0.580531
Client Index = 2	Epoch: 2	Loss: 0.565266
Client Index = 2	Epoch: 3	Loss: 0.558991
Client Index = 2	Epoch: 4	Loss: 0.562069
test acc on this client after 1654 / 2004 : 0.83
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 3
local mask changes: 6336.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7882.0, 7810.0, 7864.0, 6336.0, 7760.0]
Doing local aggregation!
test acc on this client before 1365 / 2004 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.609942
Client Index = 3	Epoch: 1	Loss: 0.582348
Client Index = 3	Epoch: 2	Loss: 0.567830
Client Index = 3	Epoch: 3	Loss: 0.559301
Client Index = 3	Epoch: 4	Loss: 0.554116
test acc on this client after 1646 / 2004 : 0.82
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 4
local mask changes: 6276.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7798.0, 7876.0, 7786.0, 7760.0, 6276.0]
Doing local aggregation!
test acc on this client before 1627 / 2004 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.424632
Client Index = 4	Epoch: 1	Loss: 0.406882
Client Index = 4	Epoch: 2	Loss: 0.388942
Client Index = 4	Epoch: 3	Loss: 0.392203
Client Index = 4	Epoch: 4	Loss: 0.386924
test acc on this client after 1806 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.397968454202439}
################local_test_on_all_clients after local training in communication round: 7
{'test_acc_after': 0.8914171656686627, 'test_loss_after': 0.30064512318717745}
################local_test_on_all_clients before local training in communication round: 7
{'test_acc_before': 0.7992015968063872, 'test_loss_before': 0.49053597132602855}
################Communication round : 8
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 0
local mask changes: 6304.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6304.0, 7526.0, 7710.0, 7566.0, 7572.0]
Doing local aggregation!
test acc on this client before 1830 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.204399
Client Index = 0	Epoch: 1	Loss: 0.183435
Client Index = 0	Epoch: 2	Loss: 0.172102
Client Index = 0	Epoch: 3	Loss: 0.161701
Client Index = 0	Epoch: 4	Loss: 0.161747
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 1
local mask changes: 6274.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7608.0, 6274.0, 7644.0, 7596.0, 7620.0]
Doing local aggregation!
test acc on this client before 1863 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.284085
Client Index = 1	Epoch: 1	Loss: 0.252191
Client Index = 1	Epoch: 2	Loss: 0.242114
Client Index = 1	Epoch: 3	Loss: 0.235225
Client Index = 1	Epoch: 4	Loss: 0.230435
test acc on this client after 1896 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 2
local mask changes: 6334.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7742.0, 7626.0, 6334.0, 7552.0, 7606.0]
Doing local aggregation!
test acc on this client before 1343 / 2004 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.588197
Client Index = 2	Epoch: 1	Loss: 0.563726
Client Index = 2	Epoch: 2	Loss: 0.552829
Client Index = 2	Epoch: 3	Loss: 0.546278
Client Index = 2	Epoch: 4	Loss: 0.545924
test acc on this client after 1635 / 2004 : 0.82
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 3
local mask changes: 6376.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7688.0, 7722.0, 7676.0, 6376.0, 7648.0]
Doing local aggregation!
test acc on this client before 1468 / 2004 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.584127
Client Index = 3	Epoch: 1	Loss: 0.570761
Client Index = 3	Epoch: 2	Loss: 0.541132
Client Index = 3	Epoch: 3	Loss: 0.549255
Client Index = 3	Epoch: 4	Loss: 0.534001
test acc on this client after 1673 / 2004 : 0.83
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 4
local mask changes: 6352.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7676.0, 7732.0, 7640.0, 7606.0, 6352.0]
Doing local aggregation!
test acc on this client before 1689 / 2004 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.416489
Client Index = 4	Epoch: 1	Loss: 0.399101
Client Index = 4	Epoch: 2	Loss: 0.389849
Client Index = 4	Epoch: 3	Loss: 0.387122
Client Index = 4	Epoch: 4	Loss: 0.373017
test acc on this client after 1793 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3867696892612792}
################local_test_on_all_clients after local training in communication round: 8
{'test_acc_after': 0.8909181636726548, 'test_loss_after': 0.2945129434505622}
################local_test_on_all_clients before local training in communication round: 8
{'test_acc_before': 0.8176646706586826, 'test_loss_before': 0.450327334581259}
################Communication round : 9
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 0
local mask changes: 6198.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6198.0, 7538.0, 7574.0, 7634.0, 7492.0]
Doing local aggregation!
test acc on this client before 1776 / 2004 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.193812
Client Index = 0	Epoch: 1	Loss: 0.177525
Client Index = 0	Epoch: 2	Loss: 0.162822
Client Index = 0	Epoch: 3	Loss: 0.162782
Client Index = 0	Epoch: 4	Loss: 0.165442
test acc on this client after 1933 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 1
local mask changes: 6290.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7620.0, 6290.0, 7618.0, 7590.0, 7532.0]
Doing local aggregation!
test acc on this client before 1837 / 2004 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.263486
Client Index = 1	Epoch: 1	Loss: 0.248877
Client Index = 1	Epoch: 2	Loss: 0.240210
Client Index = 1	Epoch: 3	Loss: 0.237792
Client Index = 1	Epoch: 4	Loss: 0.228010
test acc on this client after 1896 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 2
local mask changes: 6308.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7624.0, 7646.0, 6308.0, 7516.0, 7518.0]
Doing local aggregation!
test acc on this client before 1377 / 2004 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.575873
Client Index = 2	Epoch: 1	Loss: 0.562319
Client Index = 2	Epoch: 2	Loss: 0.538116
Client Index = 2	Epoch: 3	Loss: 0.540419
Client Index = 2	Epoch: 4	Loss: 0.528265
test acc on this client after 1654 / 2004 : 0.83
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 3
local mask changes: 6348.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7636.0, 7602.0, 7488.0, 6348.0, 7520.0]
Doing local aggregation!
test acc on this client before 1438 / 2004 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.579629
Client Index = 3	Epoch: 1	Loss: 0.551970
Client Index = 3	Epoch: 2	Loss: 0.537663
Client Index = 3	Epoch: 3	Loss: 0.532828
Client Index = 3	Epoch: 4	Loss: 0.523938
test acc on this client after 1651 / 2004 : 0.82
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 4
local mask changes: 6328.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7516.0, 7558.0, 7502.0, 7514.0, 6328.0]
Doing local aggregation!
test acc on this client before 1661 / 2004 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.395404
Client Index = 4	Epoch: 1	Loss: 0.376928
Client Index = 4	Epoch: 2	Loss: 0.380300
Client Index = 4	Epoch: 3	Loss: 0.370455
Client Index = 4	Epoch: 4	Loss: 0.365603
test acc on this client after 1800 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.377618777244649}
################local_test_on_all_clients after local training in communication round: 9
{'test_acc_after': 0.8916167664670658, 'test_loss_after': 0.28896030462876765}
################local_test_on_all_clients before local training in communication round: 9
{'test_acc_before': 0.8072854291417165, 'test_loss_before': 0.4771041755785723}
################Communication round : 10
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 0
local mask changes: 6258.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6258.0, 7412.0, 7366.0, 7478.0, 7354.0]
Doing local aggregation!
test acc on this client before 1797 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.195743
Client Index = 0	Epoch: 1	Loss: 0.175666
Client Index = 0	Epoch: 2	Loss: 0.165759
Client Index = 0	Epoch: 3	Loss: 0.154149
Client Index = 0	Epoch: 4	Loss: 0.150870
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 1
local mask changes: 6286.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7462.0, 6286.0, 7484.0, 7490.0, 7394.0]
Doing local aggregation!
test acc on this client before 1838 / 2004 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.260994
Client Index = 1	Epoch: 1	Loss: 0.237147
Client Index = 1	Epoch: 2	Loss: 0.230668
Client Index = 1	Epoch: 3	Loss: 0.226173
Client Index = 1	Epoch: 4	Loss: 0.216628
test acc on this client after 1906 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 2
local mask changes: 6304.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7718.0, 7412.0, 6304.0, 7400.0, 7440.0]
Doing local aggregation!
test acc on this client before 1390 / 2004 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.564629
Client Index = 2	Epoch: 1	Loss: 0.546592
Client Index = 2	Epoch: 2	Loss: 0.531013
Client Index = 2	Epoch: 3	Loss: 0.530108
Client Index = 2	Epoch: 4	Loss: 0.526780
test acc on this client after 1676 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 3
local mask changes: 6196.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7524.0, 7550.0, 7358.0, 6196.0, 7328.0]
Doing local aggregation!
test acc on this client before 1440 / 2004 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.571646
Client Index = 3	Epoch: 1	Loss: 0.543821
Client Index = 3	Epoch: 2	Loss: 0.543477
Client Index = 3	Epoch: 3	Loss: 0.521513
Client Index = 3	Epoch: 4	Loss: 0.527380
test acc on this client after 1685 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 4
local mask changes: 6390.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7578.0, 7540.0, 7356.0, 7434.0, 6390.0]
Doing local aggregation!
test acc on this client before 1729 / 2004 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.398337
Client Index = 4	Epoch: 1	Loss: 0.384296
Client Index = 4	Epoch: 2	Loss: 0.366256
Client Index = 4	Epoch: 3	Loss: 0.362287
Client Index = 4	Epoch: 4	Loss: 0.357341
test acc on this client after 1803 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.37157087201450734}
################local_test_on_all_clients after local training in communication round: 10
{'test_acc_after': 0.8973053892215569, 'test_loss_after': 0.2781297610369985}
################local_test_on_all_clients before local training in communication round: 10
{'test_acc_before': 0.8177644710578843, 'test_loss_before': 0.46503199617900776}
################Communication round : 11
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 0
local mask changes: 6312.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6312.0, 7354.0, 7422.0, 7348.0, 7304.0]
Doing local aggregation!
test acc on this client before 1790 / 2004 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.193930
Client Index = 0	Epoch: 1	Loss: 0.168277
Client Index = 0	Epoch: 2	Loss: 0.164437
Client Index = 0	Epoch: 3	Loss: 0.161994
Client Index = 0	Epoch: 4	Loss: 0.153373
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 1
local mask changes: 6270.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7370.0, 6270.0, 7438.0, 7410.0, 7432.0]
Doing local aggregation!
test acc on this client before 1855 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.256111
Client Index = 1	Epoch: 1	Loss: 0.236249
Client Index = 1	Epoch: 2	Loss: 0.227213
Client Index = 1	Epoch: 3	Loss: 0.216050
Client Index = 1	Epoch: 4	Loss: 0.216812
test acc on this client after 1909 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 2
local mask changes: 6212.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7408.0, 7244.0, 6212.0, 7370.0, 7216.0]
Doing local aggregation!
test acc on this client before 1477 / 2004 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.550758
Client Index = 2	Epoch: 1	Loss: 0.527247
Client Index = 2	Epoch: 2	Loss: 0.525709
Client Index = 2	Epoch: 3	Loss: 0.520182
Client Index = 2	Epoch: 4	Loss: 0.514951
test acc on this client after 1697 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 3
local mask changes: 6306.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7304.0, 7378.0, 7342.0, 6306.0, 7310.0]
Doing local aggregation!
test acc on this client before 1508 / 2004 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.543998
Client Index = 3	Epoch: 1	Loss: 0.524595
Client Index = 3	Epoch: 2	Loss: 0.522936
Client Index = 3	Epoch: 3	Loss: 0.519086
Client Index = 3	Epoch: 4	Loss: 0.507322
test acc on this client after 1712 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 4
local mask changes: 6266.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7332.0, 7430.0, 7350.0, 7292.0, 6266.0]
Doing local aggregation!
test acc on this client before 1748 / 2004 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.397247
Client Index = 4	Epoch: 1	Loss: 0.373527
Client Index = 4	Epoch: 2	Loss: 0.365097
Client Index = 4	Epoch: 3	Loss: 0.355499
Client Index = 4	Epoch: 4	Loss: 0.355502
test acc on this client after 1806 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.36392411078544373}
################local_test_on_all_clients after local training in communication round: 11
{'test_acc_after': 0.9035928143712575, 'test_loss_after': 0.2682756313931442}
################local_test_on_all_clients before local training in communication round: 11
{'test_acc_before': 0.8361277445109779, 'test_loss_before': 0.42325092675443177}
################Communication round : 12
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 0
local mask changes: 6228.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6228.0, 7210.0, 7350.0, 7336.0, 7320.0]
Doing local aggregation!
test acc on this client before 1767 / 2004 : 0.88
Client Index = 0	Epoch: 0	Loss: 0.186430
Client Index = 0	Epoch: 1	Loss: 0.165008
Client Index = 0	Epoch: 2	Loss: 0.154922
Client Index = 0	Epoch: 3	Loss: 0.158073
Client Index = 0	Epoch: 4	Loss: 0.148449
test acc on this client after 1934 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 1
local mask changes: 6244.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7312.0, 6244.0, 7372.0, 7260.0, 7440.0]
Doing local aggregation!
test acc on this client before 1843 / 2004 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.252109
Client Index = 1	Epoch: 1	Loss: 0.221395
Client Index = 1	Epoch: 2	Loss: 0.224958
Client Index = 1	Epoch: 3	Loss: 0.217765
Client Index = 1	Epoch: 4	Loss: 0.219793
test acc on this client after 1911 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 2
local mask changes: 6340.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7454.0, 7272.0, 6340.0, 7194.0, 7224.0]
Doing local aggregation!
test acc on this client before 1486 / 2004 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.544458
Client Index = 2	Epoch: 1	Loss: 0.527473
Client Index = 2	Epoch: 2	Loss: 0.527277
Client Index = 2	Epoch: 3	Loss: 0.516671
Client Index = 2	Epoch: 4	Loss: 0.497140
test acc on this client after 1689 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 3
local mask changes: 6248.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7366.0, 7390.0, 7338.0, 6248.0, 7310.0]
Doing local aggregation!
test acc on this client before 1485 / 2004 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.545252
Client Index = 3	Epoch: 1	Loss: 0.518404
Client Index = 3	Epoch: 2	Loss: 0.510088
Client Index = 3	Epoch: 3	Loss: 0.504400
Client Index = 3	Epoch: 4	Loss: 0.508278
test acc on this client after 1673 / 2004 : 0.83
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 4
local mask changes: 6228.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7324.0, 7368.0, 7352.0, 7242.0, 6228.0]
Doing local aggregation!
test acc on this client before 1725 / 2004 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.385682
Client Index = 4	Epoch: 1	Loss: 0.362378
Client Index = 4	Epoch: 2	Loss: 0.356281
Client Index = 4	Epoch: 3	Loss: 0.352200
Client Index = 4	Epoch: 4	Loss: 0.349852
test acc on this client after 1820 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3581893154217842}
################local_test_on_all_clients after local training in communication round: 12
{'test_acc_after': 0.9008982035928144, 'test_loss_after': 0.2704689763798685}
################local_test_on_all_clients before local training in communication round: 12
{'test_acc_before': 0.8289421157684631, 'test_loss_before': 0.43225739682149034}
################Communication round : 13
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 0
local mask changes: 6154.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6154.0, 7170.0, 7272.0, 7304.0, 7248.0]
Doing local aggregation!
test acc on this client before 1799 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.173209
Client Index = 0	Epoch: 1	Loss: 0.156729
Client Index = 0	Epoch: 2	Loss: 0.151106
Client Index = 0	Epoch: 3	Loss: 0.151082
Client Index = 0	Epoch: 4	Loss: 0.153083
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 1
local mask changes: 6222.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7218.0, 6222.0, 7266.0, 7184.0, 7240.0]
Doing local aggregation!
test acc on this client before 1859 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.242501
Client Index = 1	Epoch: 1	Loss: 0.231227
Client Index = 1	Epoch: 2	Loss: 0.224303
Client Index = 1	Epoch: 3	Loss: 0.216310
Client Index = 1	Epoch: 4	Loss: 0.209233
test acc on this client after 1911 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 2
local mask changes: 6166.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7296.0, 7350.0, 6166.0, 7262.0, 7216.0]
Doing local aggregation!
test acc on this client before 1552 / 2004 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.543805
Client Index = 2	Epoch: 1	Loss: 0.518381
Client Index = 2	Epoch: 2	Loss: 0.503810
Client Index = 2	Epoch: 3	Loss: 0.511584
Client Index = 2	Epoch: 4	Loss: 0.504289
test acc on this client after 1693 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 3
local mask changes: 6254.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7402.0, 7340.0, 7268.0, 6254.0, 7208.0]
Doing local aggregation!
test acc on this client before 1428 / 2004 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.530095
Client Index = 3	Epoch: 1	Loss: 0.526159
Client Index = 3	Epoch: 2	Loss: 0.515186
Client Index = 3	Epoch: 3	Loss: 0.502319
Client Index = 3	Epoch: 4	Loss: 0.491190
test acc on this client after 1709 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 4
local mask changes: 6270.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7254.0, 7306.0, 7180.0, 7136.0, 6270.0]
Doing local aggregation!
test acc on this client before 1767 / 2004 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.376987
Client Index = 4	Epoch: 1	Loss: 0.355916
Client Index = 4	Epoch: 2	Loss: 0.351978
Client Index = 4	Epoch: 3	Loss: 0.347792
Client Index = 4	Epoch: 4	Loss: 0.340677
test acc on this client after 1834 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3531579400503889}
################local_test_on_all_clients after local training in communication round: 13
{'test_acc_after': 0.906686626746507, 'test_loss_after': 0.26348390265436705}
################local_test_on_all_clients before local training in communication round: 13
{'test_acc_before': 0.8388223552894212, 'test_loss_before': 0.41415504620460686}
################Communication round : 14
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 0
local mask changes: 6178.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6178.0, 7122.0, 7144.0, 7208.0, 7162.0]
Doing local aggregation!
test acc on this client before 1808 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.181575
Client Index = 0	Epoch: 1	Loss: 0.162995
Client Index = 0	Epoch: 2	Loss: 0.145759
Client Index = 0	Epoch: 3	Loss: 0.149989
Client Index = 0	Epoch: 4	Loss: 0.147149
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 1
local mask changes: 6184.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7220.0, 6184.0, 7224.0, 7190.0, 7152.0]
Doing local aggregation!
test acc on this client before 1864 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.248574
Client Index = 1	Epoch: 1	Loss: 0.226825
Client Index = 1	Epoch: 2	Loss: 0.213666
Client Index = 1	Epoch: 3	Loss: 0.216254
Client Index = 1	Epoch: 4	Loss: 0.212293
test acc on this client after 1911 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 2
local mask changes: 6262.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7230.0, 7198.0, 6262.0, 7124.0, 7120.0]
Doing local aggregation!
test acc on this client before 1455 / 2004 : 0.73
Client Index = 2	Epoch: 0	Loss: 0.539229
Client Index = 2	Epoch: 1	Loss: 0.514668
Client Index = 2	Epoch: 2	Loss: 0.511625
Client Index = 2	Epoch: 3	Loss: 0.503177
Client Index = 2	Epoch: 4	Loss: 0.496114
test acc on this client after 1704 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 3
local mask changes: 6236.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7190.0, 7212.0, 7104.0, 6236.0, 7166.0]
Doing local aggregation!
test acc on this client before 1397 / 2004 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.531830
Client Index = 3	Epoch: 1	Loss: 0.504234
Client Index = 3	Epoch: 2	Loss: 0.494472
Client Index = 3	Epoch: 3	Loss: 0.494022
Client Index = 3	Epoch: 4	Loss: 0.497833
test acc on this client after 1701 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 4
local mask changes: 6134.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7242.0, 7252.0, 7060.0, 7192.0, 6134.0]
Doing local aggregation!
test acc on this client before 1728 / 2004 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.363669
Client Index = 4	Epoch: 1	Loss: 0.353980
Client Index = 4	Epoch: 2	Loss: 0.335812
Client Index = 4	Epoch: 3	Loss: 0.339822
Client Index = 4	Epoch: 4	Loss: 0.342163
test acc on this client after 1822 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.34910925925253555}
################local_test_on_all_clients after local training in communication round: 14
{'test_acc_after': 0.9044910179640719, 'test_loss_after': 0.2605840554464601}
################local_test_on_all_clients before local training in communication round: 14
{'test_acc_before': 0.8235528942115768, 'test_loss_before': 0.43969507274513475}
################Communication round : 15
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 0
local mask changes: 6218.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6218.0, 7090.0, 7130.0, 7178.0, 6986.0]
Doing local aggregation!
test acc on this client before 1821 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.174481
Client Index = 0	Epoch: 1	Loss: 0.157175
Client Index = 0	Epoch: 2	Loss: 0.153024
Client Index = 0	Epoch: 3	Loss: 0.144645
Client Index = 0	Epoch: 4	Loss: 0.145307
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 1
local mask changes: 6150.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7034.0, 6150.0, 7060.0, 7118.0, 7138.0]
Doing local aggregation!
test acc on this client before 1851 / 2004 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.236984
Client Index = 1	Epoch: 1	Loss: 0.225807
Client Index = 1	Epoch: 2	Loss: 0.215064
Client Index = 1	Epoch: 3	Loss: 0.211488
Client Index = 1	Epoch: 4	Loss: 0.208971
test acc on this client after 1910 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 2
local mask changes: 6202.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7026.0, 7152.0, 6202.0, 7082.0, 7098.0]
Doing local aggregation!
test acc on this client before 1530 / 2004 : 0.76
Client Index = 2	Epoch: 0	Loss: 0.520330
Client Index = 2	Epoch: 1	Loss: 0.507720
Client Index = 2	Epoch: 2	Loss: 0.504496
Client Index = 2	Epoch: 3	Loss: 0.491223
Client Index = 2	Epoch: 4	Loss: 0.491837
test acc on this client after 1698 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 3
local mask changes: 6172.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7008.0, 7202.0, 6990.0, 6172.0, 7144.0]
Doing local aggregation!
test acc on this client before 1426 / 2004 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.519099
Client Index = 3	Epoch: 1	Loss: 0.495811
Client Index = 3	Epoch: 2	Loss: 0.502423
Client Index = 3	Epoch: 3	Loss: 0.499910
Client Index = 3	Epoch: 4	Loss: 0.475115
test acc on this client after 1704 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 4
local mask changes: 6150.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7052.0, 7180.0, 7060.0, 7096.0, 6150.0]
Doing local aggregation!
test acc on this client before 1782 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.367447
Client Index = 4	Epoch: 1	Loss: 0.352560
Client Index = 4	Epoch: 2	Loss: 0.348143
Client Index = 4	Epoch: 3	Loss: 0.337116
Client Index = 4	Epoch: 4	Loss: 0.336859
test acc on this client after 1829 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.34492138429683566}
################local_test_on_all_clients after local training in communication round: 15
{'test_acc_after': 0.9052894211576845, 'test_loss_after': 0.2573498405590504}
################local_test_on_all_clients before local training in communication round: 15
{'test_acc_before': 0.8393213572854291, 'test_loss_before': 0.40712214694051685}
################Communication round : 16
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 0
local mask changes: 6094.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6094.0, 6980.0, 7054.0, 7106.0, 6940.0]
Doing local aggregation!
test acc on this client before 1807 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.171137
Client Index = 0	Epoch: 1	Loss: 0.155328
Client Index = 0	Epoch: 2	Loss: 0.149143
Client Index = 0	Epoch: 3	Loss: 0.148799
Client Index = 0	Epoch: 4	Loss: 0.143536
test acc on this client after 1935 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 1
local mask changes: 6100.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7002.0, 6100.0, 7152.0, 7098.0, 7082.0]
Doing local aggregation!
test acc on this client before 1868 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.234406
Client Index = 1	Epoch: 1	Loss: 0.221199
Client Index = 1	Epoch: 2	Loss: 0.208266
Client Index = 1	Epoch: 3	Loss: 0.202869
Client Index = 1	Epoch: 4	Loss: 0.200635
test acc on this client after 1914 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 2
local mask changes: 6106.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7160.0, 7170.0, 6106.0, 7088.0, 7030.0]
Doing local aggregation!
test acc on this client before 1508 / 2004 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.523904
Client Index = 2	Epoch: 1	Loss: 0.506119
Client Index = 2	Epoch: 2	Loss: 0.500689
Client Index = 2	Epoch: 3	Loss: 0.492832
Client Index = 2	Epoch: 4	Loss: 0.494628
test acc on this client after 1691 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 3
local mask changes: 6104.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7136.0, 7204.0, 7092.0, 6104.0, 6996.0]
Doing local aggregation!
test acc on this client before 1451 / 2004 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.512593
Client Index = 3	Epoch: 1	Loss: 0.493422
Client Index = 3	Epoch: 2	Loss: 0.495858
Client Index = 3	Epoch: 3	Loss: 0.483214
Client Index = 3	Epoch: 4	Loss: 0.478198
test acc on this client after 1696 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 4
local mask changes: 6110.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7068.0, 7188.0, 6996.0, 7018.0, 6110.0]
Doing local aggregation!
test acc on this client before 1691 / 2004 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.366303
Client Index = 4	Epoch: 1	Loss: 0.344355
Client Index = 4	Epoch: 2	Loss: 0.343257
Client Index = 4	Epoch: 3	Loss: 0.346964
Client Index = 4	Epoch: 4	Loss: 0.337776
test acc on this client after 1820 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.34221731650861026}
################local_test_on_all_clients after local training in communication round: 16
{'test_acc_after': 0.9037924151696608, 'test_loss_after': 0.26277578628646164}
################local_test_on_all_clients before local training in communication round: 16
{'test_acc_before': 0.8308383233532934, 'test_loss_before': 0.428810001995987}
################Communication round : 17
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 0
local mask changes: 6040.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6040.0, 6954.0, 6968.0, 6958.0, 7012.0]
Doing local aggregation!
test acc on this client before 1796 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.172137
Client Index = 0	Epoch: 1	Loss: 0.156745
Client Index = 0	Epoch: 2	Loss: 0.148765
Client Index = 0	Epoch: 3	Loss: 0.149187
Client Index = 0	Epoch: 4	Loss: 0.145570
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 1
local mask changes: 6160.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6974.0, 6160.0, 7080.0, 7014.0, 7040.0]
Doing local aggregation!
test acc on this client before 1868 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.232944
Client Index = 1	Epoch: 1	Loss: 0.219356
Client Index = 1	Epoch: 2	Loss: 0.218243
Client Index = 1	Epoch: 3	Loss: 0.196780
Client Index = 1	Epoch: 4	Loss: 0.202807
test acc on this client after 1914 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 2
local mask changes: 6038.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7100.0, 7064.0, 6038.0, 6974.0, 7006.0]
Doing local aggregation!
test acc on this client before 1537 / 2004 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.518675
Client Index = 2	Epoch: 1	Loss: 0.500257
Client Index = 2	Epoch: 2	Loss: 0.499481
Client Index = 2	Epoch: 3	Loss: 0.485451
Client Index = 2	Epoch: 4	Loss: 0.484534
test acc on this client after 1693 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 3
local mask changes: 6092.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7052.0, 7146.0, 7010.0, 6092.0, 7044.0]
Doing local aggregation!
test acc on this client before 1480 / 2004 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.523463
Client Index = 3	Epoch: 1	Loss: 0.497066
Client Index = 3	Epoch: 2	Loss: 0.487493
Client Index = 3	Epoch: 3	Loss: 0.483026
Client Index = 3	Epoch: 4	Loss: 0.479046
test acc on this client after 1723 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 4
local mask changes: 6030.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7026.0, 7036.0, 6848.0, 6946.0, 6030.0]
Doing local aggregation!
test acc on this client before 1750 / 2004 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.353297
Client Index = 4	Epoch: 1	Loss: 0.339331
Client Index = 4	Epoch: 2	Loss: 0.339178
Client Index = 4	Epoch: 3	Loss: 0.331765
Client Index = 4	Epoch: 4	Loss: 0.332621
test acc on this client after 1831 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.33988879858337817}
################local_test_on_all_clients after local training in communication round: 17
{'test_acc_after': 0.9071856287425151, 'test_loss_after': 0.2563118586640158}
################local_test_on_all_clients before local training in communication round: 17
{'test_acc_before': 0.8414171656686626, 'test_loss_before': 0.409777765252633}
################Communication round : 18
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 0
local mask changes: 6102.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6102.0, 6890.0, 7004.0, 6842.0, 6924.0]
Doing local aggregation!
test acc on this client before 1809 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.164858
Client Index = 0	Epoch: 1	Loss: 0.151868
Client Index = 0	Epoch: 2	Loss: 0.149127
Client Index = 0	Epoch: 3	Loss: 0.146436
Client Index = 0	Epoch: 4	Loss: 0.130822
test acc on this client after 1932 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 1
local mask changes: 6072.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6886.0, 6072.0, 6960.0, 6992.0, 7036.0]
Doing local aggregation!
test acc on this client before 1864 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.242541
Client Index = 1	Epoch: 1	Loss: 0.218035
Client Index = 1	Epoch: 2	Loss: 0.208049
Client Index = 1	Epoch: 3	Loss: 0.200971
Client Index = 1	Epoch: 4	Loss: 0.199002
test acc on this client after 1909 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 2
local mask changes: 6084.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [7054.0, 7102.0, 6084.0, 6888.0, 6942.0]
Doing local aggregation!
test acc on this client before 1513 / 2004 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.514432
Client Index = 2	Epoch: 1	Loss: 0.491609
Client Index = 2	Epoch: 2	Loss: 0.489348
Client Index = 2	Epoch: 3	Loss: 0.482861
Client Index = 2	Epoch: 4	Loss: 0.487578
test acc on this client after 1705 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 3
local mask changes: 6028.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6966.0, 6980.0, 6892.0, 6028.0, 7030.0]
Doing local aggregation!
test acc on this client before 1422 / 2004 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.509000
Client Index = 3	Epoch: 1	Loss: 0.489583
Client Index = 3	Epoch: 2	Loss: 0.477795
Client Index = 3	Epoch: 3	Loss: 0.463480
Client Index = 3	Epoch: 4	Loss: 0.472492
test acc on this client after 1689 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 4
local mask changes: 5990.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6886.0, 7028.0, 6980.0, 6814.0, 5990.0]
Doing local aggregation!
test acc on this client before 1768 / 2004 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.350323
Client Index = 4	Epoch: 1	Loss: 0.335575
Client Index = 4	Epoch: 2	Loss: 0.324519
Client Index = 4	Epoch: 3	Loss: 0.326957
Client Index = 4	Epoch: 4	Loss: 0.321089
test acc on this client after 1844 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3339340005719915}
################local_test_on_all_clients after local training in communication round: 18
{'test_acc_after': 0.9060878243512974, 'test_loss_after': 0.25624389516379303}
################local_test_on_all_clients before local training in communication round: 18
{'test_acc_before': 0.8359281437125748, 'test_loss_before': 0.42556626660500213}
################Communication round : 19
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 0
local mask changes: 6046.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6046.0, 6870.0, 7010.0, 6886.0, 6944.0]
Doing local aggregation!
test acc on this client before 1825 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.164442
Client Index = 0	Epoch: 1	Loss: 0.151126
Client Index = 0	Epoch: 2	Loss: 0.144009
Client Index = 0	Epoch: 3	Loss: 0.137977
Client Index = 0	Epoch: 4	Loss: 0.139705
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 1
local mask changes: 5950.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6868.0, 5950.0, 6900.0, 6990.0, 6976.0]
Doing local aggregation!
test acc on this client before 1884 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.229032
Client Index = 1	Epoch: 1	Loss: 0.219843
Client Index = 1	Epoch: 2	Loss: 0.207871
Client Index = 1	Epoch: 3	Loss: 0.198122
Client Index = 1	Epoch: 4	Loss: 0.203512
test acc on this client after 1912 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 2
local mask changes: 6176.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6948.0, 6906.0, 6176.0, 6872.0, 6844.0]
Doing local aggregation!
test acc on this client before 1507 / 2004 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.514641
Client Index = 2	Epoch: 1	Loss: 0.487075
Client Index = 2	Epoch: 2	Loss: 0.484980
Client Index = 2	Epoch: 3	Loss: 0.479180
Client Index = 2	Epoch: 4	Loss: 0.473205
test acc on this client after 1701 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 3
local mask changes: 6048.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6854.0, 6976.0, 6914.0, 6048.0, 6844.0]
Doing local aggregation!
test acc on this client before 1462 / 2004 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.502463
Client Index = 3	Epoch: 1	Loss: 0.484723
Client Index = 3	Epoch: 2	Loss: 0.484534
Client Index = 3	Epoch: 3	Loss: 0.475938
Client Index = 3	Epoch: 4	Loss: 0.469031
test acc on this client after 1723 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 4
local mask changes: 6094.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6870.0, 7074.0, 6776.0, 6816.0, 6094.0]
Doing local aggregation!
test acc on this client before 1748 / 2004 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.346371
Client Index = 4	Epoch: 1	Loss: 0.334992
Client Index = 4	Epoch: 2	Loss: 0.333143
Client Index = 4	Epoch: 3	Loss: 0.340643
Client Index = 4	Epoch: 4	Loss: 0.317479
test acc on this client after 1832 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3329616149847812}
################local_test_on_all_clients after local training in communication round: 19
{'test_acc_after': 0.9079840319361278, 'test_loss_after': 0.2517098652150579}
################local_test_on_all_clients before local training in communication round: 19
{'test_acc_before': 0.8409181636726547, 'test_loss_before': 0.40703566383696843}
################Communication round : 20
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 0
local mask changes: 5862.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5862.0, 6808.0, 6814.0, 6838.0, 6840.0]
Doing local aggregation!
test acc on this client before 1835 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.168411
Client Index = 0	Epoch: 1	Loss: 0.151970
Client Index = 0	Epoch: 2	Loss: 0.148625
Client Index = 0	Epoch: 3	Loss: 0.141930
Client Index = 0	Epoch: 4	Loss: 0.131100
test acc on this client after 1935 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 1
local mask changes: 6028.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6856.0, 6028.0, 6894.0, 6906.0, 6780.0]
Doing local aggregation!
test acc on this client before 1889 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.229974
Client Index = 1	Epoch: 1	Loss: 0.212308
Client Index = 1	Epoch: 2	Loss: 0.206669
Client Index = 1	Epoch: 3	Loss: 0.201627
Client Index = 1	Epoch: 4	Loss: 0.202587
test acc on this client after 1909 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 2
local mask changes: 6038.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6810.0, 6994.0, 6038.0, 6790.0, 6752.0]
Doing local aggregation!
test acc on this client before 1576 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.505821
Client Index = 2	Epoch: 1	Loss: 0.498947
Client Index = 2	Epoch: 2	Loss: 0.473231
Client Index = 2	Epoch: 3	Loss: 0.479529
Client Index = 2	Epoch: 4	Loss: 0.475155
test acc on this client after 1685 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 3
local mask changes: 6050.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6778.0, 6904.0, 6774.0, 6050.0, 6768.0]
Doing local aggregation!
test acc on this client before 1576 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.502004
Client Index = 3	Epoch: 1	Loss: 0.480394
Client Index = 3	Epoch: 2	Loss: 0.474152
Client Index = 3	Epoch: 3	Loss: 0.469987
Client Index = 3	Epoch: 4	Loss: 0.463107
test acc on this client after 1729 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 4
local mask changes: 6004.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6846.0, 6982.0, 6864.0, 6762.0, 6004.0]
Doing local aggregation!
test acc on this client before 1780 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.341581
Client Index = 4	Epoch: 1	Loss: 0.330169
Client Index = 4	Epoch: 2	Loss: 0.328339
Client Index = 4	Epoch: 3	Loss: 0.326177
Client Index = 4	Epoch: 4	Loss: 0.318260
test acc on this client after 1843 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3304822572320699}
################local_test_on_all_clients after local training in communication round: 20
{'test_acc_after': 0.9082834331337326, 'test_loss_after': 0.2514783362116285}
################local_test_on_all_clients before local training in communication round: 20
{'test_acc_before': 0.8638722554890219, 'test_loss_before': 0.36534708716912184}
################Communication round : 21
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 0
local mask changes: 5972.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5972.0, 6726.0, 6888.0, 6762.0, 6746.0]
Doing local aggregation!
test acc on this client before 1827 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.162726
Client Index = 0	Epoch: 1	Loss: 0.146011
Client Index = 0	Epoch: 2	Loss: 0.144886
Client Index = 0	Epoch: 3	Loss: 0.139045
Client Index = 0	Epoch: 4	Loss: 0.139234
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 1
local mask changes: 5930.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6836.0, 5930.0, 6854.0, 6852.0, 6930.0]
Doing local aggregation!
test acc on this client before 1858 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.231258
Client Index = 1	Epoch: 1	Loss: 0.211727
Client Index = 1	Epoch: 2	Loss: 0.210152
Client Index = 1	Epoch: 3	Loss: 0.198250
Client Index = 1	Epoch: 4	Loss: 0.198112
test acc on this client after 1909 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 2
local mask changes: 5932.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6794.0, 6870.0, 5932.0, 6736.0, 6838.0]
Doing local aggregation!
test acc on this client before 1569 / 2004 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.500684
Client Index = 2	Epoch: 1	Loss: 0.481506
Client Index = 2	Epoch: 2	Loss: 0.482911
Client Index = 2	Epoch: 3	Loss: 0.474700
Client Index = 2	Epoch: 4	Loss: 0.465547
test acc on this client after 1708 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 3
local mask changes: 5988.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6846.0, 6824.0, 6792.0, 5988.0, 6670.0]
Doing local aggregation!
test acc on this client before 1570 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.491083
Client Index = 3	Epoch: 1	Loss: 0.478088
Client Index = 3	Epoch: 2	Loss: 0.460642
Client Index = 3	Epoch: 3	Loss: 0.462985
Client Index = 3	Epoch: 4	Loss: 0.458242
test acc on this client after 1730 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 4
local mask changes: 5928.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6868.0, 6814.0, 6778.0, 6840.0, 5928.0]
Doing local aggregation!
test acc on this client before 1810 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.335745
Client Index = 4	Epoch: 1	Loss: 0.321631
Client Index = 4	Epoch: 2	Loss: 0.316333
Client Index = 4	Epoch: 3	Loss: 0.314044
Client Index = 4	Epoch: 4	Loss: 0.315351
test acc on this client after 1852 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3256357249395644}
################local_test_on_all_clients after local training in communication round: 21
{'test_acc_after': 0.9116766467065869, 'test_loss_after': 0.24434508052831166}
################local_test_on_all_clients before local training in communication round: 21
{'test_acc_before': 0.8616766467065868, 'test_loss_before': 0.38235856092975523}
################Communication round : 22
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 0
local mask changes: 5928.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5928.0, 6694.0, 6864.0, 6690.0, 6696.0]
Doing local aggregation!
test acc on this client before 1815 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.159199
Client Index = 0	Epoch: 1	Loss: 0.156206
Client Index = 0	Epoch: 2	Loss: 0.140622
Client Index = 0	Epoch: 3	Loss: 0.139572
Client Index = 0	Epoch: 4	Loss: 0.140372
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 1
local mask changes: 5894.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6754.0, 5894.0, 6848.0, 6836.0, 6816.0]
Doing local aggregation!
test acc on this client before 1881 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.222177
Client Index = 1	Epoch: 1	Loss: 0.205933
Client Index = 1	Epoch: 2	Loss: 0.198357
Client Index = 1	Epoch: 3	Loss: 0.192650
Client Index = 1	Epoch: 4	Loss: 0.190590
test acc on this client after 1922 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 2
local mask changes: 5970.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6966.0, 6732.0, 5970.0, 6860.0, 6796.0]
Doing local aggregation!
test acc on this client before 1511 / 2004 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.497823
Client Index = 2	Epoch: 1	Loss: 0.478976
Client Index = 2	Epoch: 2	Loss: 0.479256
Client Index = 2	Epoch: 3	Loss: 0.478043
Client Index = 2	Epoch: 4	Loss: 0.466319
test acc on this client after 1710 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 3
local mask changes: 5870.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6864.0, 6722.0, 6702.0, 5870.0, 6750.0]
Doing local aggregation!
test acc on this client before 1527 / 2004 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.480076
Client Index = 3	Epoch: 1	Loss: 0.471433
Client Index = 3	Epoch: 2	Loss: 0.467171
Client Index = 3	Epoch: 3	Loss: 0.465201
Client Index = 3	Epoch: 4	Loss: 0.466742
test acc on this client after 1722 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 4
local mask changes: 5952.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6786.0, 6828.0, 6722.0, 6726.0, 5952.0]
Doing local aggregation!
test acc on this client before 1794 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.344004
Client Index = 4	Epoch: 1	Loss: 0.327870
Client Index = 4	Epoch: 2	Loss: 0.324709
Client Index = 4	Epoch: 3	Loss: 0.313752
Client Index = 4	Epoch: 4	Loss: 0.308698
test acc on this client after 1848 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.32462999445643825}
################local_test_on_all_clients after local training in communication round: 22
{'test_acc_after': 0.9113772455089819, 'test_loss_after': 0.24655935778589302}
################local_test_on_all_clients before local training in communication round: 22
{'test_acc_before': 0.8510978043912175, 'test_loss_before': 0.39859762871991133}
################Communication round : 23
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 0
local mask changes: 5914.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5914.0, 6706.0, 6812.0, 6714.0, 6680.0]
Doing local aggregation!
test acc on this client before 1820 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.166668
Client Index = 0	Epoch: 1	Loss: 0.144690
Client Index = 0	Epoch: 2	Loss: 0.134538
Client Index = 0	Epoch: 3	Loss: 0.137173
Client Index = 0	Epoch: 4	Loss: 0.142041
test acc on this client after 1932 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 1
local mask changes: 5920.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6740.0, 5920.0, 6814.0, 6734.0, 6742.0]
Doing local aggregation!
test acc on this client before 1891 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.221227
Client Index = 1	Epoch: 1	Loss: 0.213193
Client Index = 1	Epoch: 2	Loss: 0.202243
Client Index = 1	Epoch: 3	Loss: 0.196858
Client Index = 1	Epoch: 4	Loss: 0.190977
test acc on this client after 1913 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 2
local mask changes: 5934.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6742.0, 6696.0, 5934.0, 6610.0, 6646.0]
Doing local aggregation!
test acc on this client before 1539 / 2004 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.488698
Client Index = 2	Epoch: 1	Loss: 0.493441
Client Index = 2	Epoch: 2	Loss: 0.465510
Client Index = 2	Epoch: 3	Loss: 0.469865
Client Index = 2	Epoch: 4	Loss: 0.468975
test acc on this client after 1732 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 3
local mask changes: 5752.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6710.0, 6710.0, 6660.0, 5752.0, 6732.0]
Doing local aggregation!
test acc on this client before 1551 / 2004 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.488542
Client Index = 3	Epoch: 1	Loss: 0.468343
Client Index = 3	Epoch: 2	Loss: 0.460637
Client Index = 3	Epoch: 3	Loss: 0.461434
Client Index = 3	Epoch: 4	Loss: 0.456606
test acc on this client after 1717 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 4
local mask changes: 5856.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6764.0, 6788.0, 6694.0, 6644.0, 5856.0]
Doing local aggregation!
test acc on this client before 1778 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.341231
Client Index = 4	Epoch: 1	Loss: 0.321803
Client Index = 4	Epoch: 2	Loss: 0.323827
Client Index = 4	Epoch: 3	Loss: 0.317153
Client Index = 4	Epoch: 4	Loss: 0.308423
test acc on this client after 1846 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.32336394183971773}
################local_test_on_all_clients after local training in communication round: 23
{'test_acc_after': 0.9121756487025948, 'test_loss_after': 0.24529392986954326}
################local_test_on_all_clients before local training in communication round: 23
{'test_acc_before': 0.856187624750499, 'test_loss_before': 0.3828952951345615}
################Communication round : 24
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 0
local mask changes: 5866.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5866.0, 6678.0, 6596.0, 6630.0, 6626.0]
Doing local aggregation!
test acc on this client before 1812 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.165083
Client Index = 0	Epoch: 1	Loss: 0.150443
Client Index = 0	Epoch: 2	Loss: 0.139650
Client Index = 0	Epoch: 3	Loss: 0.142463
Client Index = 0	Epoch: 4	Loss: 0.129327
test acc on this client after 1934 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 1
local mask changes: 5840.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6642.0, 5840.0, 6674.0, 6640.0, 6744.0]
Doing local aggregation!
test acc on this client before 1892 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.224184
Client Index = 1	Epoch: 1	Loss: 0.209350
Client Index = 1	Epoch: 2	Loss: 0.200669
Client Index = 1	Epoch: 3	Loss: 0.194652
Client Index = 1	Epoch: 4	Loss: 0.187691
test acc on this client after 1914 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 2
local mask changes: 5824.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6794.0, 6656.0, 5824.0, 6586.0, 6580.0]
Doing local aggregation!
test acc on this client before 1553 / 2004 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.493171
Client Index = 2	Epoch: 1	Loss: 0.474443
Client Index = 2	Epoch: 2	Loss: 0.475367
Client Index = 2	Epoch: 3	Loss: 0.467261
Client Index = 2	Epoch: 4	Loss: 0.464029
test acc on this client after 1723 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 3
local mask changes: 5874.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6696.0, 6664.0, 6558.0, 5874.0, 6590.0]
Doing local aggregation!
test acc on this client before 1545 / 2004 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.483796
Client Index = 3	Epoch: 1	Loss: 0.465638
Client Index = 3	Epoch: 2	Loss: 0.462794
Client Index = 3	Epoch: 3	Loss: 0.458408
Client Index = 3	Epoch: 4	Loss: 0.453664
test acc on this client after 1739 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 4
local mask changes: 5892.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6624.0, 6624.0, 6570.0, 6580.0, 5892.0]
Doing local aggregation!
test acc on this client before 1779 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.329982
Client Index = 4	Epoch: 1	Loss: 0.322930
Client Index = 4	Epoch: 2	Loss: 0.313343
Client Index = 4	Epoch: 3	Loss: 0.319188
Client Index = 4	Epoch: 4	Loss: 0.313330
test acc on this client after 1845 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.32163428567508434}
################local_test_on_all_clients after local training in communication round: 24
{'test_acc_after': 0.9136726546906188, 'test_loss_after': 0.24215181224836324}
################local_test_on_all_clients before local training in communication round: 24
{'test_acc_before': 0.8563872255489022, 'test_loss_before': 0.383196254499896}
################Communication round : 25
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 0
local mask changes: 5808.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5808.0, 6582.0, 6560.0, 6608.0, 6626.0]
Doing local aggregation!
test acc on this client before 1837 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.162217
Client Index = 0	Epoch: 1	Loss: 0.143250
Client Index = 0	Epoch: 2	Loss: 0.143444
Client Index = 0	Epoch: 3	Loss: 0.138497
Client Index = 0	Epoch: 4	Loss: 0.129806
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 1
local mask changes: 5722.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6536.0, 5722.0, 6570.0, 6582.0, 6644.0]
Doing local aggregation!
test acc on this client before 1882 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.215228
Client Index = 1	Epoch: 1	Loss: 0.205000
Client Index = 1	Epoch: 2	Loss: 0.199008
Client Index = 1	Epoch: 3	Loss: 0.192825
Client Index = 1	Epoch: 4	Loss: 0.189208
test acc on this client after 1917 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 2
local mask changes: 5764.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6578.0, 6670.0, 5764.0, 6672.0, 6550.0]
Doing local aggregation!
test acc on this client before 1549 / 2004 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.489991
Client Index = 2	Epoch: 1	Loss: 0.472845
Client Index = 2	Epoch: 2	Loss: 0.473852
Client Index = 2	Epoch: 3	Loss: 0.462311
Client Index = 2	Epoch: 4	Loss: 0.462711
test acc on this client after 1696 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 3
local mask changes: 5778.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6616.0, 6722.0, 6450.0, 5778.0, 6570.0]
Doing local aggregation!
test acc on this client before 1522 / 2004 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.482978
Client Index = 3	Epoch: 1	Loss: 0.463502
Client Index = 3	Epoch: 2	Loss: 0.462225
Client Index = 3	Epoch: 3	Loss: 0.446047
Client Index = 3	Epoch: 4	Loss: 0.449360
test acc on this client after 1739 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 4
local mask changes: 5736.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6592.0, 6618.0, 6556.0, 6590.0, 5736.0]
Doing local aggregation!
test acc on this client before 1769 / 2004 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.326883
Client Index = 4	Epoch: 1	Loss: 0.328232
Client Index = 4	Epoch: 2	Loss: 0.316244
Client Index = 4	Epoch: 3	Loss: 0.312011
Client Index = 4	Epoch: 4	Loss: 0.309650
test acc on this client after 1844 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.31909305481755357}
################local_test_on_all_clients after local training in communication round: 25
{'test_acc_after': 0.9115768463073852, 'test_loss_after': 0.24206170834407598}
################local_test_on_all_clients before local training in communication round: 25
{'test_acc_before': 0.854191616766467, 'test_loss_before': 0.38561107981466725}
################Communication round : 26
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 0
local mask changes: 5734.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5734.0, 6486.0, 6590.0, 6676.0, 6572.0]
Doing local aggregation!
test acc on this client before 1803 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.157923
Client Index = 0	Epoch: 1	Loss: 0.145371
Client Index = 0	Epoch: 2	Loss: 0.139347
Client Index = 0	Epoch: 3	Loss: 0.128772
Client Index = 0	Epoch: 4	Loss: 0.137023
test acc on this client after 1935 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 1
local mask changes: 5738.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6470.0, 5738.0, 6442.0, 6504.0, 6518.0]
Doing local aggregation!
test acc on this client before 1879 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.210866
Client Index = 1	Epoch: 1	Loss: 0.197015
Client Index = 1	Epoch: 2	Loss: 0.197573
Client Index = 1	Epoch: 3	Loss: 0.190270
Client Index = 1	Epoch: 4	Loss: 0.182894
test acc on this client after 1919 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 2
local mask changes: 5724.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6646.0, 6486.0, 5724.0, 6584.0, 6532.0]
Doing local aggregation!
test acc on this client before 1588 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.491016
Client Index = 2	Epoch: 1	Loss: 0.472219
Client Index = 2	Epoch: 2	Loss: 0.469295
Client Index = 2	Epoch: 3	Loss: 0.464477
Client Index = 2	Epoch: 4	Loss: 0.465892
test acc on this client after 1727 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 3
local mask changes: 5788.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6532.0, 6666.0, 6544.0, 5788.0, 6438.0]
Doing local aggregation!
test acc on this client before 1556 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.477136
Client Index = 3	Epoch: 1	Loss: 0.467820
Client Index = 3	Epoch: 2	Loss: 0.463044
Client Index = 3	Epoch: 3	Loss: 0.450504
Client Index = 3	Epoch: 4	Loss: 0.458863
test acc on this client after 1717 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 4
local mask changes: 5650.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6618.0, 6614.0, 6454.0, 6438.0, 5650.0]
Doing local aggregation!
test acc on this client before 1785 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.327408
Client Index = 4	Epoch: 1	Loss: 0.322650
Client Index = 4	Epoch: 2	Loss: 0.315518
Client Index = 4	Epoch: 3	Loss: 0.314871
Client Index = 4	Epoch: 4	Loss: 0.308318
test acc on this client after 1830 / 2004 : 0.91
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3182434371240596}
################local_test_on_all_clients after local training in communication round: 26
{'test_acc_after': 0.9109780439121756, 'test_loss_after': 0.2465877379069547}
################local_test_on_all_clients before local training in communication round: 26
{'test_acc_before': 0.8593812375249501, 'test_loss_before': 0.3801308406267814}
################Communication round : 27
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 0
local mask changes: 5652.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5652.0, 6444.0, 6570.0, 6528.0, 6528.0]
Doing local aggregation!
test acc on this client before 1832 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.161679
Client Index = 0	Epoch: 1	Loss: 0.139006
Client Index = 0	Epoch: 2	Loss: 0.138495
Client Index = 0	Epoch: 3	Loss: 0.129271
Client Index = 0	Epoch: 4	Loss: 0.133914
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 1
local mask changes: 5730.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6536.0, 5730.0, 6540.0, 6492.0, 6498.0]
Doing local aggregation!
test acc on this client before 1892 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.216981
Client Index = 1	Epoch: 1	Loss: 0.205456
Client Index = 1	Epoch: 2	Loss: 0.193741
Client Index = 1	Epoch: 3	Loss: 0.191351
Client Index = 1	Epoch: 4	Loss: 0.188797
test acc on this client after 1916 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 2
local mask changes: 5700.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6608.0, 6484.0, 5700.0, 6586.0, 6376.0]
Doing local aggregation!
test acc on this client before 1591 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.487191
Client Index = 2	Epoch: 1	Loss: 0.475621
Client Index = 2	Epoch: 2	Loss: 0.466993
Client Index = 2	Epoch: 3	Loss: 0.468874
Client Index = 2	Epoch: 4	Loss: 0.453487
test acc on this client after 1719 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 3
local mask changes: 5688.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6576.0, 6478.0, 6458.0, 5688.0, 6500.0]
Doing local aggregation!
test acc on this client before 1536 / 2004 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.457799
Client Index = 3	Epoch: 1	Loss: 0.458317
Client Index = 3	Epoch: 2	Loss: 0.454134
Client Index = 3	Epoch: 3	Loss: 0.449541
Client Index = 3	Epoch: 4	Loss: 0.447064
test acc on this client after 1727 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 4
local mask changes: 5622.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6594.0, 6464.0, 6512.0, 6466.0, 5622.0]
Doing local aggregation!
test acc on this client before 1817 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.327702
Client Index = 4	Epoch: 1	Loss: 0.317024
Client Index = 4	Epoch: 2	Loss: 0.305491
Client Index = 4	Epoch: 3	Loss: 0.310306
Client Index = 4	Epoch: 4	Loss: 0.308033
test acc on this client after 1843 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.31545066662132737}
################local_test_on_all_clients after local training in communication round: 27
{'test_acc_after': 0.9122754491017963, 'test_loss_after': 0.23949749386477137}
################local_test_on_all_clients before local training in communication round: 27
{'test_acc_before': 0.865069860279441, 'test_loss_before': 0.3636343741666771}
################Communication round : 28
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 0
local mask changes: 5608.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5608.0, 6384.0, 6494.0, 6548.0, 6456.0]
Doing local aggregation!
test acc on this client before 1840 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.159647
Client Index = 0	Epoch: 1	Loss: 0.144204
Client Index = 0	Epoch: 2	Loss: 0.133063
Client Index = 0	Epoch: 3	Loss: 0.139366
Client Index = 0	Epoch: 4	Loss: 0.126057
test acc on this client after 1934 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 1
local mask changes: 5590.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6420.0, 5590.0, 6402.0, 6446.0, 6412.0]
Doing local aggregation!
test acc on this client before 1878 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.219175
Client Index = 1	Epoch: 1	Loss: 0.205766
Client Index = 1	Epoch: 2	Loss: 0.185386
Client Index = 1	Epoch: 3	Loss: 0.197076
Client Index = 1	Epoch: 4	Loss: 0.186004
test acc on this client after 1919 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 2
local mask changes: 5658.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6448.0, 6390.0, 5658.0, 6494.0, 6512.0]
Doing local aggregation!
test acc on this client before 1584 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.471556
Client Index = 2	Epoch: 1	Loss: 0.471031
Client Index = 2	Epoch: 2	Loss: 0.461017
Client Index = 2	Epoch: 3	Loss: 0.461794
Client Index = 2	Epoch: 4	Loss: 0.455940
test acc on this client after 1687 / 2004 : 0.84
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 3
local mask changes: 5568.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6544.0, 6434.0, 6466.0, 5568.0, 6340.0]
Doing local aggregation!
test acc on this client before 1572 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.464232
Client Index = 3	Epoch: 1	Loss: 0.452810
Client Index = 3	Epoch: 2	Loss: 0.447570
Client Index = 3	Epoch: 3	Loss: 0.444561
Client Index = 3	Epoch: 4	Loss: 0.446949
test acc on this client after 1741 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 4
local mask changes: 5646.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6472.0, 6558.0, 6448.0, 6442.0, 5646.0]
Doing local aggregation!
test acc on this client before 1809 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.325967
Client Index = 4	Epoch: 1	Loss: 0.317152
Client Index = 4	Epoch: 2	Loss: 0.305295
Client Index = 4	Epoch: 3	Loss: 0.307712
Client Index = 4	Epoch: 4	Loss: 0.294209
test acc on this client after 1858 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.31294157111581333}
################local_test_on_all_clients after local training in communication round: 28
{'test_acc_after': 0.9120758483033932, 'test_loss_after': 0.24123871568255795}
################local_test_on_all_clients before local training in communication round: 28
{'test_acc_before': 0.8665668662674652, 'test_loss_before': 0.36276615262031553}
################Communication round : 29
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 0
local mask changes: 5620.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5620.0, 6298.0, 6422.0, 6354.0, 6358.0]
Doing local aggregation!
test acc on this client before 1843 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.158207
Client Index = 0	Epoch: 1	Loss: 0.135561
Client Index = 0	Epoch: 2	Loss: 0.140708
Client Index = 0	Epoch: 3	Loss: 0.130829
Client Index = 0	Epoch: 4	Loss: 0.130096
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 1
local mask changes: 5582.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6344.0, 5582.0, 6358.0, 6416.0, 6394.0]
Doing local aggregation!
test acc on this client before 1889 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.207770
Client Index = 1	Epoch: 1	Loss: 0.190534
Client Index = 1	Epoch: 2	Loss: 0.195604
Client Index = 1	Epoch: 3	Loss: 0.186406
Client Index = 1	Epoch: 4	Loss: 0.191233
test acc on this client after 1920 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 2
local mask changes: 5568.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6364.0, 6428.0, 5568.0, 6426.0, 6398.0]
Doing local aggregation!
test acc on this client before 1587 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.486901
Client Index = 2	Epoch: 1	Loss: 0.472084
Client Index = 2	Epoch: 2	Loss: 0.459054
Client Index = 2	Epoch: 3	Loss: 0.458027
Client Index = 2	Epoch: 4	Loss: 0.457808
test acc on this client after 1729 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 3
local mask changes: 5536.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6474.0, 6418.0, 6454.0, 5536.0, 6386.0]
Doing local aggregation!
test acc on this client before 1533 / 2004 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.461869
Client Index = 3	Epoch: 1	Loss: 0.451418
Client Index = 3	Epoch: 2	Loss: 0.443168
Client Index = 3	Epoch: 3	Loss: 0.452960
Client Index = 3	Epoch: 4	Loss: 0.444706
test acc on this client after 1733 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 4
local mask changes: 5618.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6440.0, 6416.0, 6368.0, 6314.0, 5618.0]
Doing local aggregation!
test acc on this client before 1774 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.328733
Client Index = 4	Epoch: 1	Loss: 0.313682
Client Index = 4	Epoch: 2	Loss: 0.308556
Client Index = 4	Epoch: 3	Loss: 0.308787
Client Index = 4	Epoch: 4	Loss: 0.303273
test acc on this client after 1858 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.31271905666653144}
################local_test_on_all_clients after local training in communication round: 29
{'test_acc_after': 0.9157684630738524, 'test_loss_after': 0.23901176825909318}
################local_test_on_all_clients before local training in communication round: 29
{'test_acc_before': 0.860878243512974, 'test_loss_before': 0.36628198744413143}
################Communication round : 30
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 0
local mask changes: 5582.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5582.0, 6398.0, 6338.0, 6472.0, 6342.0]
Doing local aggregation!
test acc on this client before 1806 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.159391
Client Index = 0	Epoch: 1	Loss: 0.137341
Client Index = 0	Epoch: 2	Loss: 0.137876
Client Index = 0	Epoch: 3	Loss: 0.132098
Client Index = 0	Epoch: 4	Loss: 0.124312
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 1
local mask changes: 5466.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6234.0, 5466.0, 6390.0, 6346.0, 6324.0]
Doing local aggregation!
test acc on this client before 1874 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.204923
Client Index = 1	Epoch: 1	Loss: 0.206453
Client Index = 1	Epoch: 2	Loss: 0.191804
Client Index = 1	Epoch: 3	Loss: 0.189169
Client Index = 1	Epoch: 4	Loss: 0.186193
test acc on this client after 1916 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 2
local mask changes: 5484.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6344.0, 6416.0, 5484.0, 6340.0, 6380.0]
Doing local aggregation!
test acc on this client before 1611 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.476470
Client Index = 2	Epoch: 1	Loss: 0.458642
Client Index = 2	Epoch: 2	Loss: 0.467812
Client Index = 2	Epoch: 3	Loss: 0.458325
Client Index = 2	Epoch: 4	Loss: 0.453844
test acc on this client after 1715 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 3
local mask changes: 5524.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6354.0, 6326.0, 6312.0, 5524.0, 6350.0]
Doing local aggregation!
test acc on this client before 1553 / 2004 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.464890
Client Index = 3	Epoch: 1	Loss: 0.445279
Client Index = 3	Epoch: 2	Loss: 0.447849
Client Index = 3	Epoch: 3	Loss: 0.438129
Client Index = 3	Epoch: 4	Loss: 0.442093
test acc on this client after 1755 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 4
local mask changes: 5512.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6332.0, 6404.0, 6244.0, 6280.0, 5512.0]
Doing local aggregation!
test acc on this client before 1787 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.318372
Client Index = 4	Epoch: 1	Loss: 0.306929
Client Index = 4	Epoch: 2	Loss: 0.310038
Client Index = 4	Epoch: 3	Loss: 0.315140
Client Index = 4	Epoch: 4	Loss: 0.303652
test acc on this client after 1842 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.31108098094133624}
################local_test_on_all_clients after local training in communication round: 30
{'test_acc_after': 0.9148702594810378, 'test_loss_after': 0.23795239823069161}
################local_test_on_all_clients before local training in communication round: 30
{'test_acc_before': 0.8613772455089819, 'test_loss_before': 0.3828810412191345}
################Communication round : 31
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 0
local mask changes: 5410.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5410.0, 6204.0, 6374.0, 6290.0, 6280.0]
Doing local aggregation!
test acc on this client before 1817 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.153618
Client Index = 0	Epoch: 1	Loss: 0.142699
Client Index = 0	Epoch: 2	Loss: 0.140135
Client Index = 0	Epoch: 3	Loss: 0.125579
Client Index = 0	Epoch: 4	Loss: 0.126867
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 1
local mask changes: 5460.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6206.0, 5460.0, 6220.0, 6244.0, 6350.0]
Doing local aggregation!
test acc on this client before 1870 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.208311
Client Index = 1	Epoch: 1	Loss: 0.188621
Client Index = 1	Epoch: 2	Loss: 0.192089
Client Index = 1	Epoch: 3	Loss: 0.196013
Client Index = 1	Epoch: 4	Loss: 0.181464
test acc on this client after 1914 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 2
local mask changes: 5530.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6322.0, 6366.0, 5530.0, 6320.0, 6304.0]
Doing local aggregation!
test acc on this client before 1613 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.472690
Client Index = 2	Epoch: 1	Loss: 0.462161
Client Index = 2	Epoch: 2	Loss: 0.458415
Client Index = 2	Epoch: 3	Loss: 0.447305
Client Index = 2	Epoch: 4	Loss: 0.448560
test acc on this client after 1718 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 3
local mask changes: 5510.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6296.0, 6288.0, 6364.0, 5510.0, 6232.0]
Doing local aggregation!
test acc on this client before 1579 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.462230
Client Index = 3	Epoch: 1	Loss: 0.456472
Client Index = 3	Epoch: 2	Loss: 0.448094
Client Index = 3	Epoch: 3	Loss: 0.439577
Client Index = 3	Epoch: 4	Loss: 0.439323
test acc on this client after 1742 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 4
local mask changes: 5466.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6326.0, 6300.0, 6286.0, 6222.0, 5466.0]
Doing local aggregation!
test acc on this client before 1774 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.325909
Client Index = 4	Epoch: 1	Loss: 0.304259
Client Index = 4	Epoch: 2	Loss: 0.310323
Client Index = 4	Epoch: 3	Loss: 0.291912
Client Index = 4	Epoch: 4	Loss: 0.303006
test acc on this client after 1856 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3090253683100355}
################local_test_on_all_clients after local training in communication round: 31
{'test_acc_after': 0.9149700598802394, 'test_loss_after': 0.2358282934643789}
################local_test_on_all_clients before local training in communication round: 31
{'test_acc_before': 0.8635728542914171, 'test_loss_before': 0.36153240137828324}
################Communication round : 32
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 0
local mask changes: 5506.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5506.0, 6230.0, 6266.0, 6220.0, 6168.0]
Doing local aggregation!
test acc on this client before 1806 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.150786
Client Index = 0	Epoch: 1	Loss: 0.145485
Client Index = 0	Epoch: 2	Loss: 0.134022
Client Index = 0	Epoch: 3	Loss: 0.128641
Client Index = 0	Epoch: 4	Loss: 0.130398
test acc on this client after 1937 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 1
local mask changes: 5322.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6140.0, 5322.0, 6350.0, 6268.0, 6280.0]
Doing local aggregation!
test acc on this client before 1873 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.211809
Client Index = 1	Epoch: 1	Loss: 0.194020
Client Index = 1	Epoch: 2	Loss: 0.195109
Client Index = 1	Epoch: 3	Loss: 0.178502
Client Index = 1	Epoch: 4	Loss: 0.184835
test acc on this client after 1910 / 2004 : 0.95
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 2
local mask changes: 5298.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6354.0, 6178.0, 5298.0, 6318.0, 6200.0]
Doing local aggregation!
test acc on this client before 1633 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.471946
Client Index = 2	Epoch: 1	Loss: 0.463392
Client Index = 2	Epoch: 2	Loss: 0.453591
Client Index = 2	Epoch: 3	Loss: 0.449711
Client Index = 2	Epoch: 4	Loss: 0.452079
test acc on this client after 1731 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 3
local mask changes: 5362.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6380.0, 6252.0, 6266.0, 5362.0, 6150.0]
Doing local aggregation!
test acc on this client before 1579 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.462453
Client Index = 3	Epoch: 1	Loss: 0.447937
Client Index = 3	Epoch: 2	Loss: 0.438308
Client Index = 3	Epoch: 3	Loss: 0.439089
Client Index = 3	Epoch: 4	Loss: 0.432578
test acc on this client after 1724 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 4
local mask changes: 5444.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6248.0, 6268.0, 6312.0, 6190.0, 5444.0]
Doing local aggregation!
test acc on this client before 1800 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.318028
Client Index = 4	Epoch: 1	Loss: 0.311143
Client Index = 4	Epoch: 2	Loss: 0.304803
Client Index = 4	Epoch: 3	Loss: 0.304754
Client Index = 4	Epoch: 4	Loss: 0.299713
test acc on this client after 1855 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.30812526652946115}
################local_test_on_all_clients after local training in communication round: 32
{'test_acc_after': 0.9138722554890218, 'test_loss_after': 0.2370848734340744}
################local_test_on_all_clients before local training in communication round: 32
{'test_acc_before': 0.8673652694610778, 'test_loss_before': 0.36202058271019755}
################Communication round : 33
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 0
local mask changes: 5260.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5260.0, 6098.0, 6238.0, 6204.0, 6176.0]
Doing local aggregation!
test acc on this client before 1826 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.153105
Client Index = 0	Epoch: 1	Loss: 0.141739
Client Index = 0	Epoch: 2	Loss: 0.133654
Client Index = 0	Epoch: 3	Loss: 0.127410
Client Index = 0	Epoch: 4	Loss: 0.128983
test acc on this client after 1937 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 1
local mask changes: 5334.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6192.0, 5334.0, 6254.0, 6202.0, 6216.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.206112
Client Index = 1	Epoch: 1	Loss: 0.191989
Client Index = 1	Epoch: 2	Loss: 0.185972
Client Index = 1	Epoch: 3	Loss: 0.183268
Client Index = 1	Epoch: 4	Loss: 0.185953
test acc on this client after 1928 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 2
local mask changes: 5364.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6316.0, 6244.0, 5364.0, 6182.0, 6246.0]
Doing local aggregation!
test acc on this client before 1596 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.476115
Client Index = 2	Epoch: 1	Loss: 0.461905
Client Index = 2	Epoch: 2	Loss: 0.457623
Client Index = 2	Epoch: 3	Loss: 0.452389
Client Index = 2	Epoch: 4	Loss: 0.449792
test acc on this client after 1724 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 3
local mask changes: 5406.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6100.0, 6254.0, 6160.0, 5406.0, 6184.0]
Doing local aggregation!
test acc on this client before 1558 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.459368
Client Index = 3	Epoch: 1	Loss: 0.444542
Client Index = 3	Epoch: 2	Loss: 0.441915
Client Index = 3	Epoch: 3	Loss: 0.443135
Client Index = 3	Epoch: 4	Loss: 0.425342
test acc on this client after 1761 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 4
local mask changes: 5378.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6184.0, 6306.0, 6200.0, 6128.0, 5378.0]
Doing local aggregation!
test acc on this client before 1797 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.316786
Client Index = 4	Epoch: 1	Loss: 0.309423
Client Index = 4	Epoch: 2	Loss: 0.295771
Client Index = 4	Epoch: 3	Loss: 0.302932
Client Index = 4	Epoch: 4	Loss: 0.295556
test acc on this client after 1854 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3068311755771333}
################local_test_on_all_clients after local training in communication round: 33
{'test_acc_after': 0.918562874251497, 'test_loss_after': 0.23179276420208747}
################local_test_on_all_clients before local training in communication round: 33
{'test_acc_before': 0.8636726546906187, 'test_loss_before': 0.36387420390061515}
################Communication round : 34
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 0
local mask changes: 5242.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5242.0, 6200.0, 6190.0, 6140.0, 6148.0]
Doing local aggregation!
test acc on this client before 1829 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.150132
Client Index = 0	Epoch: 1	Loss: 0.136602
Client Index = 0	Epoch: 2	Loss: 0.136460
Client Index = 0	Epoch: 3	Loss: 0.133386
Client Index = 0	Epoch: 4	Loss: 0.121605
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 1
local mask changes: 5260.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6010.0, 5260.0, 6174.0, 6118.0, 6188.0]
Doing local aggregation!
test acc on this client before 1873 / 2004 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.215301
Client Index = 1	Epoch: 1	Loss: 0.193311
Client Index = 1	Epoch: 2	Loss: 0.191975
Client Index = 1	Epoch: 3	Loss: 0.186340
Client Index = 1	Epoch: 4	Loss: 0.181586
test acc on this client after 1917 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 2
local mask changes: 5256.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6224.0, 6164.0, 5256.0, 6164.0, 6254.0]
Doing local aggregation!
test acc on this client before 1620 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.460823
Client Index = 2	Epoch: 1	Loss: 0.457341
Client Index = 2	Epoch: 2	Loss: 0.457261
Client Index = 2	Epoch: 3	Loss: 0.444617
Client Index = 2	Epoch: 4	Loss: 0.436924
test acc on this client after 1724 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 3
local mask changes: 5296.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6118.0, 6174.0, 6090.0, 5296.0, 6132.0]
Doing local aggregation!
test acc on this client before 1572 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.462225
Client Index = 3	Epoch: 1	Loss: 0.435740
Client Index = 3	Epoch: 2	Loss: 0.436294
Client Index = 3	Epoch: 3	Loss: 0.430870
Client Index = 3	Epoch: 4	Loss: 0.426603
test acc on this client after 1721 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 4
local mask changes: 5270.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6126.0, 6222.0, 6114.0, 6078.0, 5270.0]
Doing local aggregation!
test acc on this client before 1803 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.313045
Client Index = 4	Epoch: 1	Loss: 0.298065
Client Index = 4	Epoch: 2	Loss: 0.297431
Client Index = 4	Epoch: 3	Loss: 0.294995
Client Index = 4	Epoch: 4	Loss: 0.292758
test acc on this client after 1855 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3036676723216759}
################local_test_on_all_clients after local training in communication round: 34
{'test_acc_after': 0.9136726546906188, 'test_loss_after': 0.23882686951441207}
################local_test_on_all_clients before local training in communication round: 34
{'test_acc_before': 0.8679640718562874, 'test_loss_before': 0.3511295348108409}
################Communication round : 35
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 0
local mask changes: 5218.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5218.0, 6038.0, 6086.0, 6056.0, 6136.0]
Doing local aggregation!
test acc on this client before 1836 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.151832
Client Index = 0	Epoch: 1	Loss: 0.137135
Client Index = 0	Epoch: 2	Loss: 0.132574
Client Index = 0	Epoch: 3	Loss: 0.125176
Client Index = 0	Epoch: 4	Loss: 0.125299
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 1
local mask changes: 5174.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6098.0, 5174.0, 6076.0, 6090.0, 5994.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.211689
Client Index = 1	Epoch: 1	Loss: 0.194243
Client Index = 1	Epoch: 2	Loss: 0.191776
Client Index = 1	Epoch: 3	Loss: 0.187504
Client Index = 1	Epoch: 4	Loss: 0.176769
test acc on this client after 1928 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 2
local mask changes: 5154.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6104.0, 6124.0, 5154.0, 6098.0, 6130.0]
Doing local aggregation!
test acc on this client before 1590 / 2004 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.467246
Client Index = 2	Epoch: 1	Loss: 0.455903
Client Index = 2	Epoch: 2	Loss: 0.448642
Client Index = 2	Epoch: 3	Loss: 0.442149
Client Index = 2	Epoch: 4	Loss: 0.446015
test acc on this client after 1712 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 3
local mask changes: 5242.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6110.0, 6168.0, 6118.0, 5242.0, 6072.0]
Doing local aggregation!
test acc on this client before 1578 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.463797
Client Index = 3	Epoch: 1	Loss: 0.438149
Client Index = 3	Epoch: 2	Loss: 0.430693
Client Index = 3	Epoch: 3	Loss: 0.434249
Client Index = 3	Epoch: 4	Loss: 0.434162
test acc on this client after 1758 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 4
local mask changes: 5150.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6138.0, 6228.0, 6054.0, 6098.0, 5150.0]
Doing local aggregation!
test acc on this client before 1802 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.308215
Client Index = 4	Epoch: 1	Loss: 0.300301
Client Index = 4	Epoch: 2	Loss: 0.300180
Client Index = 4	Epoch: 3	Loss: 0.296772
Client Index = 4	Epoch: 4	Loss: 0.291030
test acc on this client after 1860 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3036600131826832}
################local_test_on_all_clients after local training in communication round: 35
{'test_acc_after': 0.917564870259481, 'test_loss_after': 0.22910361466650478}
################local_test_on_all_clients before local training in communication round: 35
{'test_acc_before': 0.8665668662674652, 'test_loss_before': 0.3550148819497008}
################Communication round : 36
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 0
local mask changes: 5132.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5132.0, 5892.0, 5940.0, 6092.0, 6008.0]
Doing local aggregation!
test acc on this client before 1824 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.147989
Client Index = 0	Epoch: 1	Loss: 0.129814
Client Index = 0	Epoch: 2	Loss: 0.133482
Client Index = 0	Epoch: 3	Loss: 0.124159
Client Index = 0	Epoch: 4	Loss: 0.128969
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 1
local mask changes: 5110.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5992.0, 5110.0, 6018.0, 6060.0, 6066.0]
Doing local aggregation!
test acc on this client before 1882 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.198389
Client Index = 1	Epoch: 1	Loss: 0.190755
Client Index = 1	Epoch: 2	Loss: 0.186291
Client Index = 1	Epoch: 3	Loss: 0.178876
Client Index = 1	Epoch: 4	Loss: 0.182409
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 2
local mask changes: 5088.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6044.0, 5958.0, 5088.0, 6046.0, 6056.0]
Doing local aggregation!
test acc on this client before 1600 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.467501
Client Index = 2	Epoch: 1	Loss: 0.455196
Client Index = 2	Epoch: 2	Loss: 0.448316
Client Index = 2	Epoch: 3	Loss: 0.447371
Client Index = 2	Epoch: 4	Loss: 0.441206
test acc on this client after 1716 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 3
local mask changes: 5198.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [6084.0, 6050.0, 6060.0, 5198.0, 6000.0]
Doing local aggregation!
test acc on this client before 1600 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.451581
Client Index = 3	Epoch: 1	Loss: 0.433359
Client Index = 3	Epoch: 2	Loss: 0.437038
Client Index = 3	Epoch: 3	Loss: 0.428094
Client Index = 3	Epoch: 4	Loss: 0.426000
test acc on this client after 1748 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 4
local mask changes: 5158.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5978.0, 6016.0, 6006.0, 6042.0, 5158.0]
Doing local aggregation!
test acc on this client before 1773 / 2004 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.314195
Client Index = 4	Epoch: 1	Loss: 0.299314
Client Index = 4	Epoch: 2	Loss: 0.297182
Client Index = 4	Epoch: 3	Loss: 0.295576
Client Index = 4	Epoch: 4	Loss: 0.292538
test acc on this client after 1848 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.30142412497166626}
################local_test_on_all_clients after local training in communication round: 36
{'test_acc_after': 0.9159680638722556, 'test_loss_after': 0.2324855077346255}
################local_test_on_all_clients before local training in communication round: 36
{'test_acc_before': 0.8661676646706586, 'test_loss_before': 0.3535288484510547}
################Communication round : 37
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 0
local mask changes: 5050.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5050.0, 5800.0, 5924.0, 5916.0, 5884.0]
Doing local aggregation!
test acc on this client before 1808 / 2004 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.158499
Client Index = 0	Epoch: 1	Loss: 0.134839
Client Index = 0	Epoch: 2	Loss: 0.129928
Client Index = 0	Epoch: 3	Loss: 0.130232
Client Index = 0	Epoch: 4	Loss: 0.127653
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 1
local mask changes: 5126.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5882.0, 5126.0, 5894.0, 5888.0, 6018.0]
Doing local aggregation!
test acc on this client before 1888 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.204135
Client Index = 1	Epoch: 1	Loss: 0.188882
Client Index = 1	Epoch: 2	Loss: 0.182146
Client Index = 1	Epoch: 3	Loss: 0.181339
Client Index = 1	Epoch: 4	Loss: 0.175968
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 2
local mask changes: 5060.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5960.0, 6006.0, 5060.0, 5978.0, 6004.0]
Doing local aggregation!
test acc on this client before 1630 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.460477
Client Index = 2	Epoch: 1	Loss: 0.445014
Client Index = 2	Epoch: 2	Loss: 0.449452
Client Index = 2	Epoch: 3	Loss: 0.452785
Client Index = 2	Epoch: 4	Loss: 0.440657
test acc on this client after 1738 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 3
local mask changes: 5052.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5958.0, 6028.0, 6006.0, 5052.0, 6022.0]
Doing local aggregation!
test acc on this client before 1585 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.448888
Client Index = 3	Epoch: 1	Loss: 0.424883
Client Index = 3	Epoch: 2	Loss: 0.438017
Client Index = 3	Epoch: 3	Loss: 0.436171
Client Index = 3	Epoch: 4	Loss: 0.428430
test acc on this client after 1756 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 4
local mask changes: 5058.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5930.0, 5932.0, 5938.0, 6008.0, 5058.0]
Doing local aggregation!
test acc on this client before 1793 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.299117
Client Index = 4	Epoch: 1	Loss: 0.295103
Client Index = 4	Epoch: 2	Loss: 0.295237
Client Index = 4	Epoch: 3	Loss: 0.287281
Client Index = 4	Epoch: 4	Loss: 0.288177
test acc on this client after 1858 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.3001323776517777}
################local_test_on_all_clients after local training in communication round: 37
{'test_acc_after': 0.9201596806387226, 'test_loss_after': 0.22808149488653964}
################local_test_on_all_clients before local training in communication round: 37
{'test_acc_before': 0.8686626746506987, 'test_loss_before': 0.359969422506715}
################Communication round : 38
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 0
local mask changes: 5012.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5012.0, 5838.0, 5906.0, 5868.0, 5842.0]
Doing local aggregation!
test acc on this client before 1817 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.147067
Client Index = 0	Epoch: 1	Loss: 0.138419
Client Index = 0	Epoch: 2	Loss: 0.136060
Client Index = 0	Epoch: 3	Loss: 0.127129
Client Index = 0	Epoch: 4	Loss: 0.124504
test acc on this client after 1940 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 1
local mask changes: 5026.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5756.0, 5026.0, 5890.0, 5906.0, 5906.0]
Doing local aggregation!
test acc on this client before 1886 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.204627
Client Index = 1	Epoch: 1	Loss: 0.187661
Client Index = 1	Epoch: 2	Loss: 0.179810
Client Index = 1	Epoch: 3	Loss: 0.185453
Client Index = 1	Epoch: 4	Loss: 0.176573
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 2
local mask changes: 4920.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5906.0, 5834.0, 4920.0, 5870.0, 5838.0]
Doing local aggregation!
test acc on this client before 1604 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.459510
Client Index = 2	Epoch: 1	Loss: 0.450689
Client Index = 2	Epoch: 2	Loss: 0.448689
Client Index = 2	Epoch: 3	Loss: 0.446753
Client Index = 2	Epoch: 4	Loss: 0.440785
test acc on this client after 1728 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 3
local mask changes: 5024.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5834.0, 6004.0, 5810.0, 5024.0, 5914.0]
Doing local aggregation!
test acc on this client before 1609 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.454510
Client Index = 3	Epoch: 1	Loss: 0.438980
Client Index = 3	Epoch: 2	Loss: 0.427279
Client Index = 3	Epoch: 3	Loss: 0.427240
Client Index = 3	Epoch: 4	Loss: 0.430302
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 4
local mask changes: 5006.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5836.0, 5946.0, 5814.0, 5854.0, 5006.0]
Doing local aggregation!
test acc on this client before 1794 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.307955
Client Index = 4	Epoch: 1	Loss: 0.304308
Client Index = 4	Epoch: 2	Loss: 0.289504
Client Index = 4	Epoch: 3	Loss: 0.288116
Client Index = 4	Epoch: 4	Loss: 0.288152
test acc on this client after 1857 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.30040300614180715}
################local_test_on_all_clients after local training in communication round: 38
{'test_acc_after': 0.917065868263473, 'test_loss_after': 0.22810687179455974}
################local_test_on_all_clients before local training in communication round: 38
{'test_acc_before': 0.8692614770459082, 'test_loss_before': 0.3503636845631038}
################Communication round : 39
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 0
local mask changes: 4852.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4852.0, 5788.0, 5864.0, 5900.0, 5838.0]
Doing local aggregation!
test acc on this client before 1838 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.154766
Client Index = 0	Epoch: 1	Loss: 0.136326
Client Index = 0	Epoch: 2	Loss: 0.133281
Client Index = 0	Epoch: 3	Loss: 0.124444
Client Index = 0	Epoch: 4	Loss: 0.123344
test acc on this client after 1942 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 1
local mask changes: 4962.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5768.0, 4962.0, 5776.0, 5906.0, 5862.0]
Doing local aggregation!
test acc on this client before 1884 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.211536
Client Index = 1	Epoch: 1	Loss: 0.190365
Client Index = 1	Epoch: 2	Loss: 0.176538
Client Index = 1	Epoch: 3	Loss: 0.174623
Client Index = 1	Epoch: 4	Loss: 0.179034
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 2
local mask changes: 4932.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5862.0, 5904.0, 4932.0, 5784.0, 5904.0]
Doing local aggregation!
test acc on this client before 1602 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.466447
Client Index = 2	Epoch: 1	Loss: 0.446413
Client Index = 2	Epoch: 2	Loss: 0.438295
Client Index = 2	Epoch: 3	Loss: 0.444086
Client Index = 2	Epoch: 4	Loss: 0.432650
test acc on this client after 1704 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 3
local mask changes: 4966.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5768.0, 5866.0, 5864.0, 4966.0, 5816.0]
Doing local aggregation!
test acc on this client before 1587 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.444031
Client Index = 3	Epoch: 1	Loss: 0.434246
Client Index = 3	Epoch: 2	Loss: 0.432078
Client Index = 3	Epoch: 3	Loss: 0.430434
Client Index = 3	Epoch: 4	Loss: 0.426437
test acc on this client after 1745 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 4
local mask changes: 4884.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5796.0, 5920.0, 5812.0, 5864.0, 4884.0]
Doing local aggregation!
test acc on this client before 1775 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.304696
Client Index = 4	Epoch: 1	Loss: 0.294238
Client Index = 4	Epoch: 2	Loss: 0.296124
Client Index = 4	Epoch: 3	Loss: 0.282497
Client Index = 4	Epoch: 4	Loss: 0.290269
test acc on this client after 1856 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29868792204146694}
################local_test_on_all_clients after local training in communication round: 39
{'test_acc_after': 0.9149700598802397, 'test_loss_after': 0.22526992096634446}
################local_test_on_all_clients before local training in communication round: 39
{'test_acc_before': 0.8668662674650698, 'test_loss_before': 0.3488051566654099}
################Communication round : 40
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 0
local mask changes: 4762.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4762.0, 5790.0, 5942.0, 5888.0, 5862.0]
Doing local aggregation!
test acc on this client before 1839 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.157843
Client Index = 0	Epoch: 1	Loss: 0.131749
Client Index = 0	Epoch: 2	Loss: 0.127305
Client Index = 0	Epoch: 3	Loss: 0.128689
Client Index = 0	Epoch: 4	Loss: 0.122896
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 1
local mask changes: 4872.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5654.0, 4872.0, 5898.0, 5820.0, 5918.0]
Doing local aggregation!
test acc on this client before 1888 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.203717
Client Index = 1	Epoch: 1	Loss: 0.190317
Client Index = 1	Epoch: 2	Loss: 0.182649
Client Index = 1	Epoch: 3	Loss: 0.177945
Client Index = 1	Epoch: 4	Loss: 0.172558
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 2
local mask changes: 4920.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5880.0, 5788.0, 4920.0, 5814.0, 5842.0]
Doing local aggregation!
test acc on this client before 1631 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.458992
Client Index = 2	Epoch: 1	Loss: 0.439781
Client Index = 2	Epoch: 2	Loss: 0.441750
Client Index = 2	Epoch: 3	Loss: 0.443450
Client Index = 2	Epoch: 4	Loss: 0.438586
test acc on this client after 1734 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 3
local mask changes: 4780.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5754.0, 5846.0, 5918.0, 4780.0, 5764.0]
Doing local aggregation!
test acc on this client before 1596 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.443910
Client Index = 3	Epoch: 1	Loss: 0.433621
Client Index = 3	Epoch: 2	Loss: 0.425494
Client Index = 3	Epoch: 3	Loss: 0.430656
Client Index = 3	Epoch: 4	Loss: 0.420072
test acc on this client after 1758 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 4
local mask changes: 4844.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5658.0, 5722.0, 5800.0, 5720.0, 4844.0]
Doing local aggregation!
test acc on this client before 1812 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.306774
Client Index = 4	Epoch: 1	Loss: 0.297141
Client Index = 4	Epoch: 2	Loss: 0.296172
Client Index = 4	Epoch: 3	Loss: 0.287235
Client Index = 4	Epoch: 4	Loss: 0.292447
test acc on this client after 1867 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2980699662483753}
################local_test_on_all_clients after local training in communication round: 40
{'test_acc_after': 0.9197604790419162, 'test_loss_after': 0.2262813065163866}
################local_test_on_all_clients before local training in communication round: 40
{'test_acc_before': 0.8748502994011975, 'test_loss_before': 0.3416747536963808}
################Communication round : 41
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 0
local mask changes: 4710.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4710.0, 5660.0, 5790.0, 5610.0, 5714.0]
Doing local aggregation!
test acc on this client before 1850 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.148455
Client Index = 0	Epoch: 1	Loss: 0.133994
Client Index = 0	Epoch: 2	Loss: 0.134085
Client Index = 0	Epoch: 3	Loss: 0.127111
Client Index = 0	Epoch: 4	Loss: 0.128494
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 1
local mask changes: 4702.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5622.0, 4702.0, 5764.0, 5754.0, 5758.0]
Doing local aggregation!
test acc on this client before 1882 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.198231
Client Index = 1	Epoch: 1	Loss: 0.183699
Client Index = 1	Epoch: 2	Loss: 0.183819
Client Index = 1	Epoch: 3	Loss: 0.175897
Client Index = 1	Epoch: 4	Loss: 0.169689
test acc on this client after 1918 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 2
local mask changes: 4702.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5786.0, 5772.0, 4702.0, 5818.0, 5702.0]
Doing local aggregation!
test acc on this client before 1617 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.458078
Client Index = 2	Epoch: 1	Loss: 0.452590
Client Index = 2	Epoch: 2	Loss: 0.440192
Client Index = 2	Epoch: 3	Loss: 0.436529
Client Index = 2	Epoch: 4	Loss: 0.433823
test acc on this client after 1721 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 3
local mask changes: 4766.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5834.0, 5760.0, 5730.0, 4766.0, 5646.0]
Doing local aggregation!
test acc on this client before 1598 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.441166
Client Index = 3	Epoch: 1	Loss: 0.421866
Client Index = 3	Epoch: 2	Loss: 0.418823
Client Index = 3	Epoch: 3	Loss: 0.428303
Client Index = 3	Epoch: 4	Loss: 0.428108
test acc on this client after 1767 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 4
local mask changes: 4766.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5706.0, 5724.0, 5680.0, 5654.0, 4766.0]
Doing local aggregation!
test acc on this client before 1790 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.298234
Client Index = 4	Epoch: 1	Loss: 0.297687
Client Index = 4	Epoch: 2	Loss: 0.286633
Client Index = 4	Epoch: 3	Loss: 0.286479
Client Index = 4	Epoch: 4	Loss: 0.293548
test acc on this client after 1853 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29622132495204184}
################local_test_on_all_clients after local training in communication round: 41
{'test_acc_after': 0.9179640718562874, 'test_loss_after': 0.23039155810654993}
################local_test_on_all_clients before local training in communication round: 41
{'test_acc_before': 0.8719560878243513, 'test_loss_before': 0.3466266260086419}
################Communication round : 42
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 0
local mask changes: 4676.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4676.0, 5520.0, 5560.0, 5604.0, 5646.0]
Doing local aggregation!
test acc on this client before 1829 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.146204
Client Index = 0	Epoch: 1	Loss: 0.129994
Client Index = 0	Epoch: 2	Loss: 0.123789
Client Index = 0	Epoch: 3	Loss: 0.126264
Client Index = 0	Epoch: 4	Loss: 0.124432
test acc on this client after 1936 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 1
local mask changes: 4690.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5518.0, 4690.0, 5692.0, 5738.0, 5660.0]
Doing local aggregation!
test acc on this client before 1886 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.200913
Client Index = 1	Epoch: 1	Loss: 0.183973
Client Index = 1	Epoch: 2	Loss: 0.183612
Client Index = 1	Epoch: 3	Loss: 0.177451
Client Index = 1	Epoch: 4	Loss: 0.175740
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 2
local mask changes: 4600.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5722.0, 5706.0, 4600.0, 5610.0, 5640.0]
Doing local aggregation!
test acc on this client before 1639 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.456160
Client Index = 2	Epoch: 1	Loss: 0.450360
Client Index = 2	Epoch: 2	Loss: 0.448200
Client Index = 2	Epoch: 3	Loss: 0.432312
Client Index = 2	Epoch: 4	Loss: 0.439724
test acc on this client after 1718 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 3
local mask changes: 4682.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5760.0, 5644.0, 5676.0, 4682.0, 5718.0]
Doing local aggregation!
test acc on this client before 1603 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.437007
Client Index = 3	Epoch: 1	Loss: 0.427643
Client Index = 3	Epoch: 2	Loss: 0.427827
Client Index = 3	Epoch: 3	Loss: 0.423402
Client Index = 3	Epoch: 4	Loss: 0.421594
test acc on this client after 1752 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 4
local mask changes: 4622.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5620.0, 5738.0, 5698.0, 5608.0, 4622.0]
Doing local aggregation!
test acc on this client before 1775 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.299797
Client Index = 4	Epoch: 1	Loss: 0.291458
Client Index = 4	Epoch: 2	Loss: 0.295353
Client Index = 4	Epoch: 3	Loss: 0.294599
Client Index = 4	Epoch: 4	Loss: 0.284237
test acc on this client after 1851 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29608188604024493}
################local_test_on_all_clients after local training in communication round: 42
{'test_acc_after': 0.9159680638722556, 'test_loss_after': 0.22817408706018788}
################local_test_on_all_clients before local training in communication round: 42
{'test_acc_before': 0.8714570858283434, 'test_loss_before': 0.3482965983851941}
################Communication round : 43
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 0
local mask changes: 4584.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4584.0, 5438.0, 5556.0, 5616.0, 5530.0]
Doing local aggregation!
test acc on this client before 1831 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.151832
Client Index = 0	Epoch: 1	Loss: 0.135302
Client Index = 0	Epoch: 2	Loss: 0.129593
Client Index = 0	Epoch: 3	Loss: 0.125412
Client Index = 0	Epoch: 4	Loss: 0.126386
test acc on this client after 1943 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 1
local mask changes: 4582.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5512.0, 4582.0, 5672.0, 5562.0, 5658.0]
Doing local aggregation!
test acc on this client before 1879 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.192219
Client Index = 1	Epoch: 1	Loss: 0.180821
Client Index = 1	Epoch: 2	Loss: 0.172747
Client Index = 1	Epoch: 3	Loss: 0.171150
Client Index = 1	Epoch: 4	Loss: 0.177752
test acc on this client after 1920 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 2
local mask changes: 4534.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5634.0, 5674.0, 4534.0, 5636.0, 5576.0]
Doing local aggregation!
test acc on this client before 1616 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.453547
Client Index = 2	Epoch: 1	Loss: 0.439438
Client Index = 2	Epoch: 2	Loss: 0.437655
Client Index = 2	Epoch: 3	Loss: 0.438795
Client Index = 2	Epoch: 4	Loss: 0.435708
test acc on this client after 1709 / 2004 : 0.85
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 3
local mask changes: 4556.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5520.0, 5644.0, 5632.0, 4556.0, 5660.0]
Doing local aggregation!
test acc on this client before 1596 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.429953
Client Index = 3	Epoch: 1	Loss: 0.420507
Client Index = 3	Epoch: 2	Loss: 0.426504
Client Index = 3	Epoch: 3	Loss: 0.428031
Client Index = 3	Epoch: 4	Loss: 0.409705
test acc on this client after 1779 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 4
local mask changes: 4606.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5556.0, 5640.0, 5530.0, 5634.0, 4606.0]
Doing local aggregation!
test acc on this client before 1829 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.296546
Client Index = 4	Epoch: 1	Loss: 0.293433
Client Index = 4	Epoch: 2	Loss: 0.286119
Client Index = 4	Epoch: 3	Loss: 0.291777
Client Index = 4	Epoch: 4	Loss: 0.288893
test acc on this client after 1854 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29359299392221455}
################local_test_on_all_clients after local training in communication round: 43
{'test_acc_after': 0.9186626746506986, 'test_loss_after': 0.2248334965097928}
################local_test_on_all_clients before local training in communication round: 43
{'test_acc_before': 0.8733532934131736, 'test_loss_before': 0.34666363709344117}
################Communication round : 44
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 0
local mask changes: 4588.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4588.0, 5460.0, 5552.0, 5524.0, 5484.0]
Doing local aggregation!
test acc on this client before 1826 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.146000
Client Index = 0	Epoch: 1	Loss: 0.129877
Client Index = 0	Epoch: 2	Loss: 0.128930
Client Index = 0	Epoch: 3	Loss: 0.123649
Client Index = 0	Epoch: 4	Loss: 0.119248
test acc on this client after 1940 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 1
local mask changes: 4422.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5502.0, 4422.0, 5520.0, 5658.0, 5572.0]
Doing local aggregation!
test acc on this client before 1891 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.199137
Client Index = 1	Epoch: 1	Loss: 0.180053
Client Index = 1	Epoch: 2	Loss: 0.178620
Client Index = 1	Epoch: 3	Loss: 0.183345
Client Index = 1	Epoch: 4	Loss: 0.170018
test acc on this client after 1920 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 2
local mask changes: 4510.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5544.0, 5592.0, 4510.0, 5576.0, 5402.0]
Doing local aggregation!
test acc on this client before 1641 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.456429
Client Index = 2	Epoch: 1	Loss: 0.435016
Client Index = 2	Epoch: 2	Loss: 0.438192
Client Index = 2	Epoch: 3	Loss: 0.439432
Client Index = 2	Epoch: 4	Loss: 0.438748
test acc on this client after 1728 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 3
local mask changes: 4568.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5612.0, 5624.0, 5586.0, 4568.0, 5626.0]
Doing local aggregation!
test acc on this client before 1620 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.437984
Client Index = 3	Epoch: 1	Loss: 0.422754
Client Index = 3	Epoch: 2	Loss: 0.424718
Client Index = 3	Epoch: 3	Loss: 0.421638
Client Index = 3	Epoch: 4	Loss: 0.420333
test acc on this client after 1751 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 4
local mask changes: 4500.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5600.0, 5478.0, 5486.0, 5608.0, 4500.0]
Doing local aggregation!
test acc on this client before 1833 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.308093
Client Index = 4	Epoch: 1	Loss: 0.289510
Client Index = 4	Epoch: 2	Loss: 0.287223
Client Index = 4	Epoch: 3	Loss: 0.285425
Client Index = 4	Epoch: 4	Loss: 0.275137
test acc on this client after 1848 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29358039851993956}
################local_test_on_all_clients after local training in communication round: 44
{'test_acc_after': 0.9168662674650699, 'test_loss_after': 0.22552657327252232}
################local_test_on_all_clients before local training in communication round: 44
{'test_acc_before': 0.8793413173652695, 'test_loss_before': 0.33694600276128506}
################Communication round : 45
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 0
local mask changes: 4406.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4406.0, 5292.0, 5464.0, 5534.0, 5412.0]
Doing local aggregation!
test acc on this client before 1825 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.143860
Client Index = 0	Epoch: 1	Loss: 0.131758
Client Index = 0	Epoch: 2	Loss: 0.125760
Client Index = 0	Epoch: 3	Loss: 0.122260
Client Index = 0	Epoch: 4	Loss: 0.122979
test acc on this client after 1935 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 1
local mask changes: 4430.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5358.0, 4430.0, 5534.0, 5546.0, 5456.0]
Doing local aggregation!
test acc on this client before 1883 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.197735
Client Index = 1	Epoch: 1	Loss: 0.180286
Client Index = 1	Epoch: 2	Loss: 0.178409
Client Index = 1	Epoch: 3	Loss: 0.178075
Client Index = 1	Epoch: 4	Loss: 0.168396
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 2
local mask changes: 4398.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5464.0, 5442.0, 4398.0, 5490.0, 5508.0]
Doing local aggregation!
test acc on this client before 1652 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.452656
Client Index = 2	Epoch: 1	Loss: 0.440177
Client Index = 2	Epoch: 2	Loss: 0.446784
Client Index = 2	Epoch: 3	Loss: 0.434671
Client Index = 2	Epoch: 4	Loss: 0.437427
test acc on this client after 1725 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 3
local mask changes: 4480.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5474.0, 5666.0, 5542.0, 4480.0, 5512.0]
Doing local aggregation!
test acc on this client before 1609 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.429398
Client Index = 3	Epoch: 1	Loss: 0.427403
Client Index = 3	Epoch: 2	Loss: 0.419805
Client Index = 3	Epoch: 3	Loss: 0.417096
Client Index = 3	Epoch: 4	Loss: 0.411546
test acc on this client after 1759 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 4
local mask changes: 4358.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5476.0, 5442.0, 5438.0, 5524.0, 4358.0]
Doing local aggregation!
test acc on this client before 1836 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.291700
Client Index = 4	Epoch: 1	Loss: 0.290713
Client Index = 4	Epoch: 2	Loss: 0.285550
Client Index = 4	Epoch: 3	Loss: 0.272270
Client Index = 4	Epoch: 4	Loss: 0.279478
test acc on this client after 1863 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29144761737198277}
################local_test_on_all_clients after local training in communication round: 45
{'test_acc_after': 0.9188622754491018, 'test_loss_after': 0.22410273496619243}
################local_test_on_all_clients before local training in communication round: 45
{'test_acc_before': 0.87874251497006, 'test_loss_before': 0.3370384943223523}
################Communication round : 46
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 0
local mask changes: 4432.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4432.0, 5336.0, 5410.0, 5408.0, 5462.0]
Doing local aggregation!
test acc on this client before 1853 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.139959
Client Index = 0	Epoch: 1	Loss: 0.131244
Client Index = 0	Epoch: 2	Loss: 0.128192
Client Index = 0	Epoch: 3	Loss: 0.125241
Client Index = 0	Epoch: 4	Loss: 0.123034
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 1
local mask changes: 4340.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5354.0, 4340.0, 5440.0, 5468.0, 5338.0]
Doing local aggregation!
test acc on this client before 1884 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.192677
Client Index = 1	Epoch: 1	Loss: 0.178499
Client Index = 1	Epoch: 2	Loss: 0.173355
Client Index = 1	Epoch: 3	Loss: 0.171421
Client Index = 1	Epoch: 4	Loss: 0.175789
test acc on this client after 1922 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 2
local mask changes: 4256.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5504.0, 5380.0, 4256.0, 5472.0, 5412.0]
Doing local aggregation!
test acc on this client before 1617 / 2004 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.451188
Client Index = 2	Epoch: 1	Loss: 0.440391
Client Index = 2	Epoch: 2	Loss: 0.434608
Client Index = 2	Epoch: 3	Loss: 0.435703
Client Index = 2	Epoch: 4	Loss: 0.433225
test acc on this client after 1731 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 3
local mask changes: 4308.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5396.0, 5566.0, 5438.0, 4308.0, 5396.0]
Doing local aggregation!
test acc on this client before 1605 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.429409
Client Index = 3	Epoch: 1	Loss: 0.423002
Client Index = 3	Epoch: 2	Loss: 0.416674
Client Index = 3	Epoch: 3	Loss: 0.418617
Client Index = 3	Epoch: 4	Loss: 0.410727
test acc on this client after 1781 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 4
local mask changes: 4374.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5404.0, 5432.0, 5432.0, 5520.0, 4374.0]
Doing local aggregation!
test acc on this client before 1812 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.291515
Client Index = 4	Epoch: 1	Loss: 0.287378
Client Index = 4	Epoch: 2	Loss: 0.285943
Client Index = 4	Epoch: 3	Loss: 0.279626
Client Index = 4	Epoch: 4	Loss: 0.283273
test acc on this client after 1858 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2904274953014038}
################local_test_on_all_clients after local training in communication round: 46
{'test_acc_after': 0.9212574850299401, 'test_loss_after': 0.22240530469281944}
################local_test_on_all_clients before local training in communication round: 46
{'test_acc_before': 0.8753493013972055, 'test_loss_before': 0.341620660571757}
################Communication round : 47
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 0
local mask changes: 4264.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4264.0, 5234.0, 5336.0, 5300.0, 5328.0]
Doing local aggregation!
test acc on this client before 1858 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.134861
Client Index = 0	Epoch: 1	Loss: 0.126999
Client Index = 0	Epoch: 2	Loss: 0.121385
Client Index = 0	Epoch: 3	Loss: 0.117988
Client Index = 0	Epoch: 4	Loss: 0.122265
test acc on this client after 1941 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 1
local mask changes: 4238.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5208.0, 4238.0, 5310.0, 5384.0, 5388.0]
Doing local aggregation!
test acc on this client before 1888 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.198168
Client Index = 1	Epoch: 1	Loss: 0.181076
Client Index = 1	Epoch: 2	Loss: 0.180309
Client Index = 1	Epoch: 3	Loss: 0.177071
Client Index = 1	Epoch: 4	Loss: 0.167207
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 2
local mask changes: 4344.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5358.0, 5296.0, 4344.0, 5378.0, 5288.0]
Doing local aggregation!
test acc on this client before 1636 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.450199
Client Index = 2	Epoch: 1	Loss: 0.440951
Client Index = 2	Epoch: 2	Loss: 0.431386
Client Index = 2	Epoch: 3	Loss: 0.428684
Client Index = 2	Epoch: 4	Loss: 0.435338
test acc on this client after 1728 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 3
local mask changes: 4206.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5388.0, 5402.0, 5278.0, 4206.0, 5314.0]
Doing local aggregation!
test acc on this client before 1602 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.430473
Client Index = 3	Epoch: 1	Loss: 0.417295
Client Index = 3	Epoch: 2	Loss: 0.425190
Client Index = 3	Epoch: 3	Loss: 0.413726
Client Index = 3	Epoch: 4	Loss: 0.416595
test acc on this client after 1759 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 4
local mask changes: 4288.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5386.0, 5400.0, 5356.0, 5304.0, 4288.0]
Doing local aggregation!
test acc on this client before 1817 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.295079
Client Index = 4	Epoch: 1	Loss: 0.289427
Client Index = 4	Epoch: 2	Loss: 0.283811
Client Index = 4	Epoch: 3	Loss: 0.289117
Client Index = 4	Epoch: 4	Loss: 0.278244
test acc on this client after 1860 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.29011382703768446}
################local_test_on_all_clients after local training in communication round: 47
{'test_acc_after': 0.9192614770459082, 'test_loss_after': 0.2277713692800965}
################local_test_on_all_clients before local training in communication round: 47
{'test_acc_before': 0.8783433133732534, 'test_loss_before': 0.33329053347458143}
################Communication round : 48
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 0
local mask changes: 4258.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4258.0, 5062.0, 5240.0, 5262.0, 5278.0]
Doing local aggregation!
test acc on this client before 1832 / 2004 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.140580
Client Index = 0	Epoch: 1	Loss: 0.123753
Client Index = 0	Epoch: 2	Loss: 0.115459
Client Index = 0	Epoch: 3	Loss: 0.124294
Client Index = 0	Epoch: 4	Loss: 0.113279
test acc on this client after 1941 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 1
local mask changes: 4146.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5176.0, 4146.0, 5322.0, 5396.0, 5266.0]
Doing local aggregation!
test acc on this client before 1882 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.203499
Client Index = 1	Epoch: 1	Loss: 0.177744
Client Index = 1	Epoch: 2	Loss: 0.171905
Client Index = 1	Epoch: 3	Loss: 0.176030
Client Index = 1	Epoch: 4	Loss: 0.166772
test acc on this client after 1916 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 2
local mask changes: 4226.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5300.0, 5374.0, 4226.0, 5268.0, 5322.0]
Doing local aggregation!
test acc on this client before 1611 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.450541
Client Index = 2	Epoch: 1	Loss: 0.436918
Client Index = 2	Epoch: 2	Loss: 0.437645
Client Index = 2	Epoch: 3	Loss: 0.429530
Client Index = 2	Epoch: 4	Loss: 0.424811
test acc on this client after 1742 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 3
local mask changes: 4128.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5284.0, 5434.0, 5266.0, 4128.0, 5368.0]
Doing local aggregation!
test acc on this client before 1578 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.424769
Client Index = 3	Epoch: 1	Loss: 0.423008
Client Index = 3	Epoch: 2	Loss: 0.412465
Client Index = 3	Epoch: 3	Loss: 0.414230
Client Index = 3	Epoch: 4	Loss: 0.401183
test acc on this client after 1775 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 4
local mask changes: 4148.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5318.0, 5270.0, 5292.0, 5286.0, 4148.0]
Doing local aggregation!
test acc on this client before 1802 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.294429
Client Index = 4	Epoch: 1	Loss: 0.285100
Client Index = 4	Epoch: 2	Loss: 0.284429
Client Index = 4	Epoch: 3	Loss: 0.278711
Client Index = 4	Epoch: 4	Loss: 0.279362
test acc on this client after 1863 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.28761787178272263}
################local_test_on_all_clients after local training in communication round: 48
{'test_acc_after': 0.9218562874251497, 'test_loss_after': 0.22115722496560714}
################local_test_on_all_clients before local training in communication round: 48
{'test_acc_before': 0.8687624750499001, 'test_loss_before': 0.35777477064056545}
################Communication round : 49
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 0
local mask changes: 4094.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4094.0, 5092.0, 5198.0, 5294.0, 5212.0]
Doing local aggregation!
test acc on this client before 1861 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.144208
Client Index = 0	Epoch: 1	Loss: 0.125580
Client Index = 0	Epoch: 2	Loss: 0.122783
Client Index = 0	Epoch: 3	Loss: 0.118177
Client Index = 0	Epoch: 4	Loss: 0.116341
test acc on this client after 1940 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 1
local mask changes: 4122.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5126.0, 4122.0, 5184.0, 5302.0, 5296.0]
Doing local aggregation!
test acc on this client before 1885 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.200368
Client Index = 1	Epoch: 1	Loss: 0.180305
Client Index = 1	Epoch: 2	Loss: 0.177814
Client Index = 1	Epoch: 3	Loss: 0.174658
Client Index = 1	Epoch: 4	Loss: 0.175633
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 2
local mask changes: 4148.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5210.0, 5198.0, 4148.0, 5190.0, 5282.0]
Doing local aggregation!
test acc on this client before 1612 / 2004 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.449460
Client Index = 2	Epoch: 1	Loss: 0.434235
Client Index = 2	Epoch: 2	Loss: 0.432544
Client Index = 2	Epoch: 3	Loss: 0.426719
Client Index = 2	Epoch: 4	Loss: 0.421245
test acc on this client after 1738 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 3
local mask changes: 4112.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5306.0, 5300.0, 5222.0, 4112.0, 5240.0]
Doing local aggregation!
test acc on this client before 1617 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.419527
Client Index = 3	Epoch: 1	Loss: 0.411162
Client Index = 3	Epoch: 2	Loss: 0.421604
Client Index = 3	Epoch: 3	Loss: 0.410273
Client Index = 3	Epoch: 4	Loss: 0.409822
test acc on this client after 1758 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 4
local mask changes: 4062.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5272.0, 5334.0, 5290.0, 5294.0, 4062.0]
Doing local aggregation!
test acc on this client before 1831 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.293361
Client Index = 4	Epoch: 1	Loss: 0.285431
Client Index = 4	Epoch: 2	Loss: 0.285362
Client Index = 4	Epoch: 3	Loss: 0.274859
Client Index = 4	Epoch: 4	Loss: 0.276785
test acc on this client after 1856 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.28753017188386715}
################local_test_on_all_clients after local training in communication round: 49
{'test_acc_after': 0.9199600798403192, 'test_loss_after': 0.22323286128109565}
################local_test_on_all_clients before local training in communication round: 49
{'test_acc_before': 0.8788423153692614, 'test_loss_before': 0.33514772573274054}
################Communication round : 50
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 0
local mask changes: 4022.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4022.0, 5026.0, 5086.0, 5150.0, 5118.0]
Doing local aggregation!
test acc on this client before 1863 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.147042
Client Index = 0	Epoch: 1	Loss: 0.126397
Client Index = 0	Epoch: 2	Loss: 0.118026
Client Index = 0	Epoch: 3	Loss: 0.118095
Client Index = 0	Epoch: 4	Loss: 0.119918
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 1
local mask changes: 4040.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5076.0, 4040.0, 5100.0, 5178.0, 5192.0]
Doing local aggregation!
test acc on this client before 1893 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.187309
Client Index = 1	Epoch: 1	Loss: 0.182666
Client Index = 1	Epoch: 2	Loss: 0.171631
Client Index = 1	Epoch: 3	Loss: 0.172753
Client Index = 1	Epoch: 4	Loss: 0.167782
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 2
local mask changes: 3992.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5190.0, 5106.0, 3992.0, 5116.0, 5268.0]
Doing local aggregation!
test acc on this client before 1650 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.441269
Client Index = 2	Epoch: 1	Loss: 0.454071
Client Index = 2	Epoch: 2	Loss: 0.434160
Client Index = 2	Epoch: 3	Loss: 0.418628
Client Index = 2	Epoch: 4	Loss: 0.429772
test acc on this client after 1739 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 3
local mask changes: 3952.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5166.0, 5140.0, 5202.0, 3952.0, 5202.0]
Doing local aggregation!
test acc on this client before 1566 / 2004 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.424486
Client Index = 3	Epoch: 1	Loss: 0.411014
Client Index = 3	Epoch: 2	Loss: 0.412171
Client Index = 3	Epoch: 3	Loss: 0.407236
Client Index = 3	Epoch: 4	Loss: 0.410742
test acc on this client after 1774 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 4
local mask changes: 3966.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5132.0, 5122.0, 5218.0, 5180.0, 3966.0]
Doing local aggregation!
test acc on this client before 1791 / 2004 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.295279
Client Index = 4	Epoch: 1	Loss: 0.280626
Client Index = 4	Epoch: 2	Loss: 0.276170
Client Index = 4	Epoch: 3	Loss: 0.277289
Client Index = 4	Epoch: 4	Loss: 0.271584
test acc on this client after 1859 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2862446411025334}
################local_test_on_all_clients after local training in communication round: 50
{'test_acc_after': 0.9215568862275451, 'test_loss_after': 0.22026904103701223}
################local_test_on_all_clients before local training in communication round: 50
{'test_acc_before': 0.8745508982035929, 'test_loss_before': 0.33854334599779035}
################Communication round : 51
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 0
local mask changes: 3940.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3940.0, 4944.0, 5074.0, 5160.0, 5124.0]
Doing local aggregation!
test acc on this client before 1852 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.136347
Client Index = 0	Epoch: 1	Loss: 0.121949
Client Index = 0	Epoch: 2	Loss: 0.122037
Client Index = 0	Epoch: 3	Loss: 0.117703
Client Index = 0	Epoch: 4	Loss: 0.114334
test acc on this client after 1943 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 1
local mask changes: 3842.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5010.0, 3842.0, 5102.0, 5138.0, 5036.0]
Doing local aggregation!
test acc on this client before 1882 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.190948
Client Index = 1	Epoch: 1	Loss: 0.174185
Client Index = 1	Epoch: 2	Loss: 0.170103
Client Index = 1	Epoch: 3	Loss: 0.169843
Client Index = 1	Epoch: 4	Loss: 0.162261
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 2
local mask changes: 3890.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5182.0, 5090.0, 3890.0, 5096.0, 5118.0]
Doing local aggregation!
test acc on this client before 1649 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.438762
Client Index = 2	Epoch: 1	Loss: 0.439987
Client Index = 2	Epoch: 2	Loss: 0.439597
Client Index = 2	Epoch: 3	Loss: 0.422788
Client Index = 2	Epoch: 4	Loss: 0.420728
test acc on this client after 1728 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 3
local mask changes: 3970.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5130.0, 5046.0, 5078.0, 3970.0, 5086.0]
Doing local aggregation!
test acc on this client before 1631 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.428796
Client Index = 3	Epoch: 1	Loss: 0.422824
Client Index = 3	Epoch: 2	Loss: 0.416841
Client Index = 3	Epoch: 3	Loss: 0.411272
Client Index = 3	Epoch: 4	Loss: 0.410707
test acc on this client after 1761 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 4
local mask changes: 3866.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5068.0, 4992.0, 5100.0, 5006.0, 3866.0]
Doing local aggregation!
test acc on this client before 1830 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.288721
Client Index = 4	Epoch: 1	Loss: 0.282416
Client Index = 4	Epoch: 2	Loss: 0.283973
Client Index = 4	Epoch: 3	Loss: 0.281481
Client Index = 4	Epoch: 4	Loss: 0.276600
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.28580820562833165}
################local_test_on_all_clients after local training in communication round: 51
{'test_acc_after': 0.9207584830339322, 'test_loss_after': 0.2222466262960862}
################local_test_on_all_clients before local training in communication round: 51
{'test_acc_before': 0.8826347305389222, 'test_loss_before': 0.32772409664299673}
################Communication round : 52
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 0
local mask changes: 3780.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3780.0, 4938.0, 5064.0, 5062.0, 4944.0]
Doing local aggregation!
test acc on this client before 1835 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.137407
Client Index = 0	Epoch: 1	Loss: 0.124978
Client Index = 0	Epoch: 2	Loss: 0.119466
Client Index = 0	Epoch: 3	Loss: 0.112705
Client Index = 0	Epoch: 4	Loss: 0.115519
test acc on this client after 1938 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 1
local mask changes: 3836.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4956.0, 3836.0, 5040.0, 5062.0, 4994.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.188584
Client Index = 1	Epoch: 1	Loss: 0.178644
Client Index = 1	Epoch: 2	Loss: 0.170264
Client Index = 1	Epoch: 3	Loss: 0.172980
Client Index = 1	Epoch: 4	Loss: 0.171221
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 2
local mask changes: 3768.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5050.0, 5034.0, 3768.0, 4980.0, 5070.0]
Doing local aggregation!
test acc on this client before 1660 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.441036
Client Index = 2	Epoch: 1	Loss: 0.436231
Client Index = 2	Epoch: 2	Loss: 0.428067
Client Index = 2	Epoch: 3	Loss: 0.426063
Client Index = 2	Epoch: 4	Loss: 0.430966
test acc on this client after 1718 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 3
local mask changes: 3792.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4992.0, 4996.0, 4978.0, 3792.0, 5024.0]
Doing local aggregation!
test acc on this client before 1592 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.425641
Client Index = 3	Epoch: 1	Loss: 0.405259
Client Index = 3	Epoch: 2	Loss: 0.415486
Client Index = 3	Epoch: 3	Loss: 0.406036
Client Index = 3	Epoch: 4	Loss: 0.400829
test acc on this client after 1763 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 4
local mask changes: 3808.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5050.0, 4976.0, 5042.0, 4944.0, 3808.0]
Doing local aggregation!
test acc on this client before 1817 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.286677
Client Index = 4	Epoch: 1	Loss: 0.279812
Client Index = 4	Epoch: 2	Loss: 0.286537
Client Index = 4	Epoch: 3	Loss: 0.274769
Client Index = 4	Epoch: 4	Loss: 0.264734
test acc on this client after 1859 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2839965101751558}
################local_test_on_all_clients after local training in communication round: 52
{'test_acc_after': 0.9183632734530939, 'test_loss_after': 0.22283344792272755}
################local_test_on_all_clients before local training in communication round: 52
{'test_acc_before': 0.8763473053892217, 'test_loss_before': 0.33651762372719307}
################Communication round : 53
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 0
local mask changes: 3676.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3676.0, 4816.0, 4956.0, 4896.0, 4898.0]
Doing local aggregation!
test acc on this client before 1841 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.136529
Client Index = 0	Epoch: 1	Loss: 0.123398
Client Index = 0	Epoch: 2	Loss: 0.119274
Client Index = 0	Epoch: 3	Loss: 0.116665
Client Index = 0	Epoch: 4	Loss: 0.118323
test acc on this client after 1942 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 1
local mask changes: 3718.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4846.0, 3718.0, 5020.0, 4940.0, 4956.0]
Doing local aggregation!
test acc on this client before 1889 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.189991
Client Index = 1	Epoch: 1	Loss: 0.174806
Client Index = 1	Epoch: 2	Loss: 0.170240
Client Index = 1	Epoch: 3	Loss: 0.171759
Client Index = 1	Epoch: 4	Loss: 0.167619
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 2
local mask changes: 3714.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5028.0, 4940.0, 3714.0, 4864.0, 4986.0]
Doing local aggregation!
test acc on this client before 1661 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.445287
Client Index = 2	Epoch: 1	Loss: 0.433734
Client Index = 2	Epoch: 2	Loss: 0.424444
Client Index = 2	Epoch: 3	Loss: 0.421802
Client Index = 2	Epoch: 4	Loss: 0.427202
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 3
local mask changes: 3732.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4870.0, 4968.0, 4968.0, 3732.0, 4886.0]
Doing local aggregation!
test acc on this client before 1622 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.429008
Client Index = 3	Epoch: 1	Loss: 0.413923
Client Index = 3	Epoch: 2	Loss: 0.410431
Client Index = 3	Epoch: 3	Loss: 0.405305
Client Index = 3	Epoch: 4	Loss: 0.410779
test acc on this client after 1784 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 4
local mask changes: 3640.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4958.0, 4970.0, 5022.0, 4848.0, 3640.0]
Doing local aggregation!
test acc on this client before 1816 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.291066
Client Index = 4	Epoch: 1	Loss: 0.285104
Client Index = 4	Epoch: 2	Loss: 0.274257
Client Index = 4	Epoch: 3	Loss: 0.288175
Client Index = 4	Epoch: 4	Loss: 0.274485
test acc on this client after 1869 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2849442861791938}
################local_test_on_all_clients after local training in communication round: 53
{'test_acc_after': 0.9244510978043913, 'test_loss_after': 0.21514091377486727}
################local_test_on_all_clients before local training in communication round: 53
{'test_acc_before': 0.8811377245508982, 'test_loss_before': 0.33030472415055107}
################Communication round : 54
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 0
local mask changes: 3582.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3582.0, 4780.0, 4874.0, 4864.0, 4824.0]
Doing local aggregation!
test acc on this client before 1851 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.135897
Client Index = 0	Epoch: 1	Loss: 0.123339
Client Index = 0	Epoch: 2	Loss: 0.120432
Client Index = 0	Epoch: 3	Loss: 0.118201
Client Index = 0	Epoch: 4	Loss: 0.115865
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 1
local mask changes: 3588.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4800.0, 3588.0, 4912.0, 4892.0, 4886.0]
Doing local aggregation!
test acc on this client before 1891 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.188714
Client Index = 1	Epoch: 1	Loss: 0.175073
Client Index = 1	Epoch: 2	Loss: 0.172366
Client Index = 1	Epoch: 3	Loss: 0.169880
Client Index = 1	Epoch: 4	Loss: 0.165843
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 2
local mask changes: 3536.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [5004.0, 4908.0, 3536.0, 4880.0, 4896.0]
Doing local aggregation!
test acc on this client before 1655 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.443690
Client Index = 2	Epoch: 1	Loss: 0.432235
Client Index = 2	Epoch: 2	Loss: 0.431353
Client Index = 2	Epoch: 3	Loss: 0.424124
Client Index = 2	Epoch: 4	Loss: 0.416080
test acc on this client after 1738 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 3
local mask changes: 3620.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4872.0, 4942.0, 4930.0, 3620.0, 4944.0]
Doing local aggregation!
test acc on this client before 1616 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.422795
Client Index = 3	Epoch: 1	Loss: 0.408982
Client Index = 3	Epoch: 2	Loss: 0.408461
Client Index = 3	Epoch: 3	Loss: 0.403712
Client Index = 3	Epoch: 4	Loss: 0.398546
test acc on this client after 1762 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 4
local mask changes: 3576.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4796.0, 4918.0, 4894.0, 4852.0, 3576.0]
Doing local aggregation!
test acc on this client before 1818 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.285347
Client Index = 4	Epoch: 1	Loss: 0.283856
Client Index = 4	Epoch: 2	Loss: 0.280410
Client Index = 4	Epoch: 3	Loss: 0.272333
Client Index = 4	Epoch: 4	Loss: 0.271168
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.28274811935551625}
################local_test_on_all_clients after local training in communication round: 54
{'test_acc_after': 0.9214570858283434, 'test_loss_after': 0.22075702392472002}
################local_test_on_all_clients before local training in communication round: 54
{'test_acc_before': 0.8813373253493013, 'test_loss_before': 0.3256433543747295}
################Communication round : 55
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 0
local mask changes: 3460.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3460.0, 4728.0, 4862.0, 4764.0, 4804.0]
Doing local aggregation!
test acc on this client before 1850 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.141360
Client Index = 0	Epoch: 1	Loss: 0.125710
Client Index = 0	Epoch: 2	Loss: 0.121784
Client Index = 0	Epoch: 3	Loss: 0.111729
Client Index = 0	Epoch: 4	Loss: 0.111058
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 1
local mask changes: 3510.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4706.0, 3510.0, 4832.0, 4824.0, 4822.0]
Doing local aggregation!
test acc on this client before 1891 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.186843
Client Index = 1	Epoch: 1	Loss: 0.176510
Client Index = 1	Epoch: 2	Loss: 0.167803
Client Index = 1	Epoch: 3	Loss: 0.162030
Client Index = 1	Epoch: 4	Loss: 0.166042
test acc on this client after 1928 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 2
local mask changes: 3470.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4802.0, 4866.0, 3470.0, 4760.0, 4794.0]
Doing local aggregation!
test acc on this client before 1659 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.434849
Client Index = 2	Epoch: 1	Loss: 0.429201
Client Index = 2	Epoch: 2	Loss: 0.427231
Client Index = 2	Epoch: 3	Loss: 0.421358
Client Index = 2	Epoch: 4	Loss: 0.419914
test acc on this client after 1738 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 3
local mask changes: 3454.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4790.0, 4868.0, 4908.0, 3454.0, 4860.0]
Doing local aggregation!
test acc on this client before 1592 / 2004 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.421093
Client Index = 3	Epoch: 1	Loss: 0.406328
Client Index = 3	Epoch: 2	Loss: 0.405901
Client Index = 3	Epoch: 3	Loss: 0.404291
Client Index = 3	Epoch: 4	Loss: 0.401299
test acc on this client after 1767 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 4
local mask changes: 3484.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4774.0, 4812.0, 4758.0, 4842.0, 3484.0]
Doing local aggregation!
test acc on this client before 1832 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.285056
Client Index = 4	Epoch: 1	Loss: 0.268819
Client Index = 4	Epoch: 2	Loss: 0.275060
Client Index = 4	Epoch: 3	Loss: 0.274950
Client Index = 4	Epoch: 4	Loss: 0.266462
test acc on this client after 1850 / 2004 : 0.92
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2805072104748576}
################local_test_on_all_clients after local training in communication round: 55
{'test_acc_after': 0.9208582834331336, 'test_loss_after': 0.22298904063102012}
################local_test_on_all_clients before local training in communication round: 55
{'test_acc_before': 0.8806387225548903, 'test_loss_before': 0.33314744855710365}
################Communication round : 56
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 0
local mask changes: 3394.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3394.0, 4670.0, 4708.0, 4728.0, 4700.0]
Doing local aggregation!
test acc on this client before 1861 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.140178
Client Index = 0	Epoch: 1	Loss: 0.120250
Client Index = 0	Epoch: 2	Loss: 0.122488
Client Index = 0	Epoch: 3	Loss: 0.113541
Client Index = 0	Epoch: 4	Loss: 0.113034
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 1
local mask changes: 3432.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4634.0, 3432.0, 4760.0, 4872.0, 4782.0]
Doing local aggregation!
test acc on this client before 1899 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.186536
Client Index = 1	Epoch: 1	Loss: 0.178201
Client Index = 1	Epoch: 2	Loss: 0.173626
Client Index = 1	Epoch: 3	Loss: 0.169351
Client Index = 1	Epoch: 4	Loss: 0.161788
test acc on this client after 1928 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 2
local mask changes: 3354.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4810.0, 4836.0, 3354.0, 4660.0, 4702.0]
Doing local aggregation!
test acc on this client before 1662 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.434685
Client Index = 2	Epoch: 1	Loss: 0.433172
Client Index = 2	Epoch: 2	Loss: 0.425826
Client Index = 2	Epoch: 3	Loss: 0.422137
Client Index = 2	Epoch: 4	Loss: 0.416391
test acc on this client after 1731 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 3
local mask changes: 3412.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4760.0, 4946.0, 4742.0, 3412.0, 4730.0]
Doing local aggregation!
test acc on this client before 1641 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.418606
Client Index = 3	Epoch: 1	Loss: 0.416232
Client Index = 3	Epoch: 2	Loss: 0.399195
Client Index = 3	Epoch: 3	Loss: 0.404629
Client Index = 3	Epoch: 4	Loss: 0.396458
test acc on this client after 1772 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 4
local mask changes: 3392.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4718.0, 4768.0, 4724.0, 4724.0, 3392.0]
Doing local aggregation!
test acc on this client before 1847 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.283115
Client Index = 4	Epoch: 1	Loss: 0.278808
Client Index = 4	Epoch: 2	Loss: 0.269089
Client Index = 4	Epoch: 3	Loss: 0.279132
Client Index = 4	Epoch: 4	Loss: 0.277078
test acc on this client after 1861 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2813418525774428}
################local_test_on_all_clients after local training in communication round: 56
{'test_acc_after': 0.9217564870259481, 'test_loss_after': 0.21638977923495567}
################local_test_on_all_clients before local training in communication round: 56
{'test_acc_before': 0.8892215568862275, 'test_loss_before': 0.3123876275238163}
################Communication round : 57
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 0
local mask changes: 3300.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3300.0, 4572.0, 4680.0, 4726.0, 4668.0]
Doing local aggregation!
test acc on this client before 1839 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.136483
Client Index = 0	Epoch: 1	Loss: 0.126626
Client Index = 0	Epoch: 2	Loss: 0.120446
Client Index = 0	Epoch: 3	Loss: 0.118869
Client Index = 0	Epoch: 4	Loss: 0.112258
test acc on this client after 1943 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 1
local mask changes: 3330.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4580.0, 3330.0, 4642.0, 4728.0, 4698.0]
Doing local aggregation!
test acc on this client before 1898 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.179483
Client Index = 1	Epoch: 1	Loss: 0.172933
Client Index = 1	Epoch: 2	Loss: 0.170148
Client Index = 1	Epoch: 3	Loss: 0.169251
Client Index = 1	Epoch: 4	Loss: 0.155721
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 2
local mask changes: 3322.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4782.0, 4740.0, 3322.0, 4688.0, 4630.0]
Doing local aggregation!
test acc on this client before 1672 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.433236
Client Index = 2	Epoch: 1	Loss: 0.430660
Client Index = 2	Epoch: 2	Loss: 0.422954
Client Index = 2	Epoch: 3	Loss: 0.428638
Client Index = 2	Epoch: 4	Loss: 0.424663
test acc on this client after 1749 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 3
local mask changes: 3318.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4726.0, 4742.0, 4714.0, 3318.0, 4722.0]
Doing local aggregation!
test acc on this client before 1659 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.413162
Client Index = 3	Epoch: 1	Loss: 0.408424
Client Index = 3	Epoch: 2	Loss: 0.407154
Client Index = 3	Epoch: 3	Loss: 0.394367
Client Index = 3	Epoch: 4	Loss: 0.406040
test acc on this client after 1764 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 4
local mask changes: 3322.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4704.0, 4650.0, 4614.0, 4616.0, 3322.0]
Doing local aggregation!
test acc on this client before 1842 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.286653
Client Index = 4	Epoch: 1	Loss: 0.278328
Client Index = 4	Epoch: 2	Loss: 0.275281
Client Index = 4	Epoch: 3	Loss: 0.276503
Client Index = 4	Epoch: 4	Loss: 0.269257
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.28070157842433197}
################local_test_on_all_clients after local training in communication round: 57
{'test_acc_after': 0.9231536926147704, 'test_loss_after': 0.22021372540446812}
################local_test_on_all_clients before local training in communication round: 57
{'test_acc_before': 0.8892215568862276, 'test_loss_before': 0.308934205020973}
################Communication round : 58
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 0
local mask changes: 3196.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3196.0, 4522.0, 4650.0, 4668.0, 4560.0]
Doing local aggregation!
test acc on this client before 1854 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.134140
Client Index = 0	Epoch: 1	Loss: 0.123069
Client Index = 0	Epoch: 2	Loss: 0.123435
Client Index = 0	Epoch: 3	Loss: 0.110561
Client Index = 0	Epoch: 4	Loss: 0.114954
test acc on this client after 1941 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 1
local mask changes: 3184.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4526.0, 3184.0, 4578.0, 4734.0, 4616.0]
Doing local aggregation!
test acc on this client before 1895 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.187245
Client Index = 1	Epoch: 1	Loss: 0.174509
Client Index = 1	Epoch: 2	Loss: 0.172548
Client Index = 1	Epoch: 3	Loss: 0.165375
Client Index = 1	Epoch: 4	Loss: 0.165243
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 2
local mask changes: 3214.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4630.0, 4700.0, 3214.0, 4692.0, 4580.0]
Doing local aggregation!
test acc on this client before 1662 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.432733
Client Index = 2	Epoch: 1	Loss: 0.421140
Client Index = 2	Epoch: 2	Loss: 0.417368
Client Index = 2	Epoch: 3	Loss: 0.423529
Client Index = 2	Epoch: 4	Loss: 0.412921
test acc on this client after 1744 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 3
local mask changes: 3178.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4690.0, 4690.0, 4638.0, 3178.0, 4512.0]
Doing local aggregation!
test acc on this client before 1628 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.420456
Client Index = 3	Epoch: 1	Loss: 0.406059
Client Index = 3	Epoch: 2	Loss: 0.398453
Client Index = 3	Epoch: 3	Loss: 0.398347
Client Index = 3	Epoch: 4	Loss: 0.398755
test acc on this client after 1781 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 4
local mask changes: 3180.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4572.0, 4678.0, 4600.0, 4622.0, 3180.0]
Doing local aggregation!
test acc on this client before 1823 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.288067
Client Index = 4	Epoch: 1	Loss: 0.275285
Client Index = 4	Epoch: 2	Loss: 0.272578
Client Index = 4	Epoch: 3	Loss: 0.266519
Client Index = 4	Epoch: 4	Loss: 0.262654
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2786376735480859}
################local_test_on_all_clients after local training in communication round: 58
{'test_acc_after': 0.9240518962075848, 'test_loss_after': 0.21700444688905263}
################local_test_on_all_clients before local training in communication round: 58
{'test_acc_before': 0.8844311377245508, 'test_loss_before': 0.3224904181893}
################Communication round : 59
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 0
local mask changes: 3108.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3108.0, 4346.0, 4534.0, 4506.0, 4570.0]
Doing local aggregation!
test acc on this client before 1854 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.137037
Client Index = 0	Epoch: 1	Loss: 0.123851
Client Index = 0	Epoch: 2	Loss: 0.122554
Client Index = 0	Epoch: 3	Loss: 0.113869
Client Index = 0	Epoch: 4	Loss: 0.113887
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 1
local mask changes: 3112.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4464.0, 3112.0, 4574.0, 4640.0, 4592.0]
Doing local aggregation!
test acc on this client before 1889 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.178138
Client Index = 1	Epoch: 1	Loss: 0.168084
Client Index = 1	Epoch: 2	Loss: 0.175679
Client Index = 1	Epoch: 3	Loss: 0.168952
Client Index = 1	Epoch: 4	Loss: 0.165854
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 2
local mask changes: 3134.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4616.0, 4542.0, 3134.0, 4568.0, 4538.0]
Doing local aggregation!
test acc on this client before 1656 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.430426
Client Index = 2	Epoch: 1	Loss: 0.426450
Client Index = 2	Epoch: 2	Loss: 0.424223
Client Index = 2	Epoch: 3	Loss: 0.421630
Client Index = 2	Epoch: 4	Loss: 0.417588
test acc on this client after 1737 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 3
local mask changes: 3082.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4630.0, 4712.0, 4598.0, 3082.0, 4500.0]
Doing local aggregation!
test acc on this client before 1630 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.413436
Client Index = 3	Epoch: 1	Loss: 0.399733
Client Index = 3	Epoch: 2	Loss: 0.406880
Client Index = 3	Epoch: 3	Loss: 0.404092
Client Index = 3	Epoch: 4	Loss: 0.394704
test acc on this client after 1784 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 4
local mask changes: 3084.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4548.0, 4594.0, 4558.0, 4486.0, 3084.0]
Doing local aggregation!
test acc on this client before 1830 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.282651
Client Index = 4	Epoch: 1	Loss: 0.269749
Client Index = 4	Epoch: 2	Loss: 0.274693
Client Index = 4	Epoch: 3	Loss: 0.271044
Client Index = 4	Epoch: 4	Loss: 0.268284
test acc on this client after 1860 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2789394549502337}
################local_test_on_all_clients after local training in communication round: 59
{'test_acc_after': 0.923053892215569, 'test_loss_after': 0.21773512126606498}
################local_test_on_all_clients before local training in communication round: 59
{'test_acc_before': 0.8841317365269461, 'test_loss_before': 0.31808022256501894}
################Communication round : 60
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 0
local mask changes: 2968.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2968.0, 4388.0, 4486.0, 4524.0, 4464.0]
Doing local aggregation!
test acc on this client before 1861 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.132630
Client Index = 0	Epoch: 1	Loss: 0.123503
Client Index = 0	Epoch: 2	Loss: 0.111639
Client Index = 0	Epoch: 3	Loss: 0.113752
Client Index = 0	Epoch: 4	Loss: 0.112828
test acc on this client after 1939 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 1
local mask changes: 2982.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4408.0, 2982.0, 4496.0, 4570.0, 4524.0]
Doing local aggregation!
test acc on this client before 1907 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.190243
Client Index = 1	Epoch: 1	Loss: 0.169794
Client Index = 1	Epoch: 2	Loss: 0.171651
Client Index = 1	Epoch: 3	Loss: 0.159773
Client Index = 1	Epoch: 4	Loss: 0.157596
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 2
local mask changes: 3018.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4536.0, 4580.0, 3018.0, 4526.0, 4538.0]
Doing local aggregation!
test acc on this client before 1672 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.429680
Client Index = 2	Epoch: 1	Loss: 0.421432
Client Index = 2	Epoch: 2	Loss: 0.422623
Client Index = 2	Epoch: 3	Loss: 0.422485
Client Index = 2	Epoch: 4	Loss: 0.417000
test acc on this client after 1734 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 3
local mask changes: 2918.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4556.0, 4586.0, 4538.0, 2918.0, 4392.0]
Doing local aggregation!
test acc on this client before 1608 / 2004 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.408724
Client Index = 3	Epoch: 1	Loss: 0.405603
Client Index = 3	Epoch: 2	Loss: 0.395587
Client Index = 3	Epoch: 3	Loss: 0.396921
Client Index = 3	Epoch: 4	Loss: 0.394108
test acc on this client after 1763 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 4
local mask changes: 3028.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4440.0, 4480.0, 4552.0, 4410.0, 3028.0]
Doing local aggregation!
test acc on this client before 1825 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.287236
Client Index = 4	Epoch: 1	Loss: 0.272494
Client Index = 4	Epoch: 2	Loss: 0.266235
Client Index = 4	Epoch: 3	Loss: 0.270646
Client Index = 4	Epoch: 4	Loss: 0.265373
test acc on this client after 1858 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.27678221859354923}
################local_test_on_all_clients after local training in communication round: 60
{'test_acc_after': 0.9196606786427146, 'test_loss_after': 0.21843815588219434}
################local_test_on_all_clients before local training in communication round: 60
{'test_acc_before': 0.8855289421157684, 'test_loss_before': 0.31849805652321933}
################Communication round : 61
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 0
local mask changes: 2904.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2904.0, 4268.0, 4484.0, 4414.0, 4312.0]
Doing local aggregation!
test acc on this client before 1855 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.137694
Client Index = 0	Epoch: 1	Loss: 0.124305
Client Index = 0	Epoch: 2	Loss: 0.111083
Client Index = 0	Epoch: 3	Loss: 0.111721
Client Index = 0	Epoch: 4	Loss: 0.111342
test acc on this client after 1942 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 1
local mask changes: 2876.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4348.0, 2876.0, 4486.0, 4492.0, 4394.0]
Doing local aggregation!
test acc on this client before 1892 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.186956
Client Index = 1	Epoch: 1	Loss: 0.176087
Client Index = 1	Epoch: 2	Loss: 0.165964
Client Index = 1	Epoch: 3	Loss: 0.162338
Client Index = 1	Epoch: 4	Loss: 0.166735
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 2
local mask changes: 2872.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4400.0, 4424.0, 2872.0, 4428.0, 4414.0]
Doing local aggregation!
test acc on this client before 1662 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.440007
Client Index = 2	Epoch: 1	Loss: 0.425862
Client Index = 2	Epoch: 2	Loss: 0.419380
Client Index = 2	Epoch: 3	Loss: 0.415902
Client Index = 2	Epoch: 4	Loss: 0.411380
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 3
local mask changes: 2908.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4492.0, 4556.0, 4592.0, 2908.0, 4406.0]
Doing local aggregation!
test acc on this client before 1663 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.407171
Client Index = 3	Epoch: 1	Loss: 0.416260
Client Index = 3	Epoch: 2	Loss: 0.402124
Client Index = 3	Epoch: 3	Loss: 0.405573
Client Index = 3	Epoch: 4	Loss: 0.398364
test acc on this client after 1776 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 4
local mask changes: 2898.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4390.0, 4390.0, 4452.0, 4456.0, 2898.0]
Doing local aggregation!
test acc on this client before 1839 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.277046
Client Index = 4	Epoch: 1	Loss: 0.276159
Client Index = 4	Epoch: 2	Loss: 0.275291
Client Index = 4	Epoch: 3	Loss: 0.267142
Client Index = 4	Epoch: 4	Loss: 0.265609
test acc on this client after 1870 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2782997874717446}
################local_test_on_all_clients after local training in communication round: 61
{'test_acc_after': 0.9241516966067863, 'test_loss_after': 0.2136037732758922}
################local_test_on_all_clients before local training in communication round: 61
{'test_acc_before': 0.8893213572854292, 'test_loss_before': 0.3102285492027591}
################Communication round : 62
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 0
local mask changes: 2812.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2812.0, 4258.0, 4312.0, 4438.0, 4328.0]
Doing local aggregation!
test acc on this client before 1869 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.132857
Client Index = 0	Epoch: 1	Loss: 0.118704
Client Index = 0	Epoch: 2	Loss: 0.117437
Client Index = 0	Epoch: 3	Loss: 0.114792
Client Index = 0	Epoch: 4	Loss: 0.113858
test acc on this client after 1943 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 1
local mask changes: 2782.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4306.0, 2782.0, 4382.0, 4458.0, 4308.0]
Doing local aggregation!
test acc on this client before 1904 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.181062
Client Index = 1	Epoch: 1	Loss: 0.176040
Client Index = 1	Epoch: 2	Loss: 0.162105
Client Index = 1	Epoch: 3	Loss: 0.168382
Client Index = 1	Epoch: 4	Loss: 0.158844
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 2
local mask changes: 2814.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4338.0, 4388.0, 2814.0, 4360.0, 4378.0]
Doing local aggregation!
test acc on this client before 1658 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.430947
Client Index = 2	Epoch: 1	Loss: 0.424314
Client Index = 2	Epoch: 2	Loss: 0.413744
Client Index = 2	Epoch: 3	Loss: 0.419885
Client Index = 2	Epoch: 4	Loss: 0.411652
test acc on this client after 1737 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 3
local mask changes: 2818.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4402.0, 4470.0, 4414.0, 2818.0, 4326.0]
Doing local aggregation!
test acc on this client before 1627 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.408294
Client Index = 3	Epoch: 1	Loss: 0.401887
Client Index = 3	Epoch: 2	Loss: 0.401245
Client Index = 3	Epoch: 3	Loss: 0.397232
Client Index = 3	Epoch: 4	Loss: 0.409723
test acc on this client after 1787 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 4
local mask changes: 2750.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4302.0, 4316.0, 4344.0, 4328.0, 2750.0]
Doing local aggregation!
test acc on this client before 1826 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.276581
Client Index = 4	Epoch: 1	Loss: 0.273893
Client Index = 4	Epoch: 2	Loss: 0.275486
Client Index = 4	Epoch: 3	Loss: 0.274323
Client Index = 4	Epoch: 4	Loss: 0.267723
test acc on this client after 1862 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.27724043680156796}
################local_test_on_all_clients after local training in communication round: 62
{'test_acc_after': 0.9231536926147704, 'test_loss_after': 0.21791613751691497}
################local_test_on_all_clients before local training in communication round: 62
{'test_acc_before': 0.886626746506986, 'test_loss_before': 0.3173449487802749}
################Communication round : 63
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 0
local mask changes: 2654.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2654.0, 4200.0, 4284.0, 4292.0, 4144.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.134974
Client Index = 0	Epoch: 1	Loss: 0.125725
Client Index = 0	Epoch: 2	Loss: 0.114518
Client Index = 0	Epoch: 3	Loss: 0.112190
Client Index = 0	Epoch: 4	Loss: 0.112615
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 1
local mask changes: 2668.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4198.0, 2668.0, 4300.0, 4484.0, 4298.0]
Doing local aggregation!
test acc on this client before 1902 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.188570
Client Index = 1	Epoch: 1	Loss: 0.169537
Client Index = 1	Epoch: 2	Loss: 0.163083
Client Index = 1	Epoch: 3	Loss: 0.160635
Client Index = 1	Epoch: 4	Loss: 0.165423
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 2
local mask changes: 2692.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4358.0, 4388.0, 2692.0, 4418.0, 4268.0]
Doing local aggregation!
test acc on this client before 1657 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.427144
Client Index = 2	Epoch: 1	Loss: 0.418059
Client Index = 2	Epoch: 2	Loss: 0.417013
Client Index = 2	Epoch: 3	Loss: 0.416604
Client Index = 2	Epoch: 4	Loss: 0.418923
test acc on this client after 1739 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 3
local mask changes: 2674.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4354.0, 4460.0, 4370.0, 2674.0, 4206.0]
Doing local aggregation!
test acc on this client before 1635 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.409511
Client Index = 3	Epoch: 1	Loss: 0.396679
Client Index = 3	Epoch: 2	Loss: 0.400027
Client Index = 3	Epoch: 3	Loss: 0.399564
Client Index = 3	Epoch: 4	Loss: 0.383225
test acc on this client after 1759 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 4
local mask changes: 2692.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4282.0, 4322.0, 4282.0, 4232.0, 2692.0]
Doing local aggregation!
test acc on this client before 1813 / 2004 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.276689
Client Index = 4	Epoch: 1	Loss: 0.272380
Client Index = 4	Epoch: 2	Loss: 0.266979
Client Index = 4	Epoch: 3	Loss: 0.269276
Client Index = 4	Epoch: 4	Loss: 0.264782
test acc on this client after 1872 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2753649039915268}
################local_test_on_all_clients after local training in communication round: 63
{'test_acc_after': 0.9221556886227544, 'test_loss_after': 0.21631798768442073}
################local_test_on_all_clients before local training in communication round: 63
{'test_acc_before': 0.886626746506986, 'test_loss_before': 0.31573693671388303}
################Communication round : 64
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 0
local mask changes: 2546.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2546.0, 4148.0, 4272.0, 4286.0, 4198.0]
Doing local aggregation!
test acc on this client before 1862 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.127608
Client Index = 0	Epoch: 1	Loss: 0.125688
Client Index = 0	Epoch: 2	Loss: 0.119477
Client Index = 0	Epoch: 3	Loss: 0.113586
Client Index = 0	Epoch: 4	Loss: 0.117926
test acc on this client after 1941 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 1
local mask changes: 2582.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4072.0, 2582.0, 4218.0, 4358.0, 4200.0]
Doing local aggregation!
test acc on this client before 1897 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.181987
Client Index = 1	Epoch: 1	Loss: 0.167860
Client Index = 1	Epoch: 2	Loss: 0.165233
Client Index = 1	Epoch: 3	Loss: 0.163513
Client Index = 1	Epoch: 4	Loss: 0.159376
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 2
local mask changes: 2514.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4346.0, 4344.0, 2514.0, 4296.0, 4224.0]
Doing local aggregation!
test acc on this client before 1660 / 2004 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.423138
Client Index = 2	Epoch: 1	Loss: 0.425253
Client Index = 2	Epoch: 2	Loss: 0.420442
Client Index = 2	Epoch: 3	Loss: 0.409202
Client Index = 2	Epoch: 4	Loss: 0.410301
test acc on this client after 1760 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 3
local mask changes: 2562.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4236.0, 4356.0, 4232.0, 2562.0, 4206.0]
Doing local aggregation!
test acc on this client before 1655 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.415572
Client Index = 3	Epoch: 1	Loss: 0.403384
Client Index = 3	Epoch: 2	Loss: 0.402342
Client Index = 3	Epoch: 3	Loss: 0.390401
Client Index = 3	Epoch: 4	Loss: 0.389234
test acc on this client after 1782 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 4
local mask changes: 2618.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4068.0, 4202.0, 4178.0, 4182.0, 2618.0]
Doing local aggregation!
test acc on this client before 1834 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.283391
Client Index = 4	Epoch: 1	Loss: 0.277350
Client Index = 4	Epoch: 2	Loss: 0.267074
Client Index = 4	Epoch: 3	Loss: 0.262054
Client Index = 4	Epoch: 4	Loss: 0.260859
test acc on this client after 1876 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.27528999125703846}
################local_test_on_all_clients after local training in communication round: 64
{'test_acc_after': 0.9265469061876248, 'test_loss_after': 0.21353848399724554}
################local_test_on_all_clients before local training in communication round: 64
{'test_acc_before': 0.8890219560878243, 'test_loss_before': 0.309925866596951}
################Communication round : 65
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 0
local mask changes: 2494.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2494.0, 4044.0, 4246.0, 4198.0, 4122.0]
Doing local aggregation!
test acc on this client before 1862 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.128694
Client Index = 0	Epoch: 1	Loss: 0.123177
Client Index = 0	Epoch: 2	Loss: 0.107218
Client Index = 0	Epoch: 3	Loss: 0.106109
Client Index = 0	Epoch: 4	Loss: 0.112456
test acc on this client after 1949 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 1
local mask changes: 2478.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4084.0, 2478.0, 4216.0, 4260.0, 4168.0]
Doing local aggregation!
test acc on this client before 1891 / 2004 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.175865
Client Index = 1	Epoch: 1	Loss: 0.169156
Client Index = 1	Epoch: 2	Loss: 0.167552
Client Index = 1	Epoch: 3	Loss: 0.166789
Client Index = 1	Epoch: 4	Loss: 0.153870
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 2
local mask changes: 2530.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4262.0, 4152.0, 2530.0, 4220.0, 4070.0]
Doing local aggregation!
test acc on this client before 1652 / 2004 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.431298
Client Index = 2	Epoch: 1	Loss: 0.417673
Client Index = 2	Epoch: 2	Loss: 0.421277
Client Index = 2	Epoch: 3	Loss: 0.414923
Client Index = 2	Epoch: 4	Loss: 0.417403
test acc on this client after 1730 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 3
local mask changes: 2418.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4204.0, 4322.0, 4212.0, 2418.0, 4116.0]
Doing local aggregation!
test acc on this client before 1615 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.409562
Client Index = 3	Epoch: 1	Loss: 0.395176
Client Index = 3	Epoch: 2	Loss: 0.402822
Client Index = 3	Epoch: 3	Loss: 0.403436
Client Index = 3	Epoch: 4	Loss: 0.386381
test acc on this client after 1769 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 4
local mask changes: 2476.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4132.0, 4122.0, 4090.0, 4034.0, 2476.0]
Doing local aggregation!
test acc on this client before 1826 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.280420
Client Index = 4	Epoch: 1	Loss: 0.270772
Client Index = 4	Epoch: 2	Loss: 0.271367
Client Index = 4	Epoch: 3	Loss: 0.263232
Client Index = 4	Epoch: 4	Loss: 0.263533
test acc on this client after 1867 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.27440642271111615}
################local_test_on_all_clients after local training in communication round: 65
{'test_acc_after': 0.9227544910179641, 'test_loss_after': 0.2166314250754263}
################local_test_on_all_clients before local training in communication round: 65
{'test_acc_before': 0.8828343313373255, 'test_loss_before': 0.32138470815951947}
################Communication round : 66
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 0
local mask changes: 2392.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2392.0, 3974.0, 4212.0, 4122.0, 4026.0]
Doing local aggregation!
test acc on this client before 1858 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.130127
Client Index = 0	Epoch: 1	Loss: 0.120487
Client Index = 0	Epoch: 2	Loss: 0.115253
Client Index = 0	Epoch: 3	Loss: 0.114690
Client Index = 0	Epoch: 4	Loss: 0.117410
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 1
local mask changes: 2388.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3990.0, 2388.0, 4164.0, 4188.0, 4068.0]
Doing local aggregation!
test acc on this client before 1899 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.183593
Client Index = 1	Epoch: 1	Loss: 0.169488
Client Index = 1	Epoch: 2	Loss: 0.163354
Client Index = 1	Epoch: 3	Loss: 0.160832
Client Index = 1	Epoch: 4	Loss: 0.159439
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 2
local mask changes: 2384.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4132.0, 4168.0, 2384.0, 4140.0, 4018.0]
Doing local aggregation!
test acc on this client before 1682 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.428961
Client Index = 2	Epoch: 1	Loss: 0.423470
Client Index = 2	Epoch: 2	Loss: 0.419038
Client Index = 2	Epoch: 3	Loss: 0.408653
Client Index = 2	Epoch: 4	Loss: 0.410076
test acc on this client after 1731 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 3
local mask changes: 2328.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4174.0, 4226.0, 4090.0, 2328.0, 3948.0]
Doing local aggregation!
test acc on this client before 1673 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.406981
Client Index = 3	Epoch: 1	Loss: 0.381098
Client Index = 3	Epoch: 2	Loss: 0.395741
Client Index = 3	Epoch: 3	Loss: 0.391161
Client Index = 3	Epoch: 4	Loss: 0.389234
test acc on this client after 1778 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 4
local mask changes: 2338.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4092.0, 4114.0, 4032.0, 3954.0, 2338.0]
Doing local aggregation!
test acc on this client before 1834 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.273361
Client Index = 4	Epoch: 1	Loss: 0.271024
Client Index = 4	Epoch: 2	Loss: 0.270041
Client Index = 4	Epoch: 3	Loss: 0.263484
Client Index = 4	Epoch: 4	Loss: 0.259989
test acc on this client after 1870 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2730793945285234}
################local_test_on_all_clients after local training in communication round: 66
{'test_acc_after': 0.9229540918163673, 'test_loss_after': 0.21401693953569242}
################local_test_on_all_clients before local training in communication round: 66
{'test_acc_before': 0.8928143712574851, 'test_loss_before': 0.30252546519338497}
################Communication round : 67
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 0
local mask changes: 2250.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2250.0, 3890.0, 4078.0, 4088.0, 3906.0]
Doing local aggregation!
test acc on this client before 1864 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.134952
Client Index = 0	Epoch: 1	Loss: 0.124675
Client Index = 0	Epoch: 2	Loss: 0.111200
Client Index = 0	Epoch: 3	Loss: 0.115474
Client Index = 0	Epoch: 4	Loss: 0.111587
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 1
local mask changes: 2296.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3880.0, 2296.0, 4064.0, 4150.0, 4014.0]
Doing local aggregation!
test acc on this client before 1894 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.183757
Client Index = 1	Epoch: 1	Loss: 0.163824
Client Index = 1	Epoch: 2	Loss: 0.169423
Client Index = 1	Epoch: 3	Loss: 0.167173
Client Index = 1	Epoch: 4	Loss: 0.162119
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 2
local mask changes: 2262.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4142.0, 4116.0, 2262.0, 4046.0, 3980.0]
Doing local aggregation!
test acc on this client before 1682 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.422138
Client Index = 2	Epoch: 1	Loss: 0.413054
Client Index = 2	Epoch: 2	Loss: 0.410095
Client Index = 2	Epoch: 3	Loss: 0.412708
Client Index = 2	Epoch: 4	Loss: 0.412907
test acc on this client after 1715 / 2004 : 0.86
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 3
local mask changes: 2248.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4082.0, 4136.0, 4074.0, 2248.0, 3960.0]
Doing local aggregation!
test acc on this client before 1671 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.405733
Client Index = 3	Epoch: 1	Loss: 0.404098
Client Index = 3	Epoch: 2	Loss: 0.389376
Client Index = 3	Epoch: 3	Loss: 0.394053
Client Index = 3	Epoch: 4	Loss: 0.385233
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 4
local mask changes: 2262.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3952.0, 4060.0, 3964.0, 3894.0, 2262.0]
Doing local aggregation!
test acc on this client before 1833 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.274776
Client Index = 4	Epoch: 1	Loss: 0.267113
Client Index = 4	Epoch: 2	Loss: 0.268928
Client Index = 4	Epoch: 3	Loss: 0.268496
Client Index = 4	Epoch: 4	Loss: 0.263290
test acc on this client after 1866 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2734473120159608}
################local_test_on_all_clients after local training in communication round: 67
{'test_acc_after': 0.9222554890219561, 'test_loss_after': 0.21615215438806606}
################local_test_on_all_clients before local training in communication round: 67
{'test_acc_before': 0.8926147704590818, 'test_loss_before': 0.3015672707242404}
################Communication round : 68
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 0
local mask changes: 2156.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2156.0, 3836.0, 3990.0, 4016.0, 3866.0]
Doing local aggregation!
test acc on this client before 1870 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.133016
Client Index = 0	Epoch: 1	Loss: 0.119645
Client Index = 0	Epoch: 2	Loss: 0.113224
Client Index = 0	Epoch: 3	Loss: 0.119092
Client Index = 0	Epoch: 4	Loss: 0.109967
test acc on this client after 1946 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 1
local mask changes: 2164.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3802.0, 2164.0, 4058.0, 4100.0, 3950.0]
Doing local aggregation!
test acc on this client before 1902 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.178491
Client Index = 1	Epoch: 1	Loss: 0.161601
Client Index = 1	Epoch: 2	Loss: 0.162543
Client Index = 1	Epoch: 3	Loss: 0.152561
Client Index = 1	Epoch: 4	Loss: 0.163678
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 2
local mask changes: 2150.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3996.0, 3994.0, 2150.0, 4006.0, 3848.0]
Doing local aggregation!
test acc on this client before 1677 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.420255
Client Index = 2	Epoch: 1	Loss: 0.416458
Client Index = 2	Epoch: 2	Loss: 0.416458
Client Index = 2	Epoch: 3	Loss: 0.411609
Client Index = 2	Epoch: 4	Loss: 0.409489
test acc on this client after 1739 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 3
local mask changes: 2140.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3990.0, 4058.0, 3950.0, 2140.0, 3872.0]
Doing local aggregation!
test acc on this client before 1627 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.401139
Client Index = 3	Epoch: 1	Loss: 0.393354
Client Index = 3	Epoch: 2	Loss: 0.391864
Client Index = 3	Epoch: 3	Loss: 0.387161
Client Index = 3	Epoch: 4	Loss: 0.390044
test acc on this client after 1785 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 4
local mask changes: 2160.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3872.0, 4028.0, 3868.0, 3864.0, 2160.0]
Doing local aggregation!
test acc on this client before 1814 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.273655
Client Index = 4	Epoch: 1	Loss: 0.269379
Client Index = 4	Epoch: 2	Loss: 0.267917
Client Index = 4	Epoch: 3	Loss: 0.260620
Client Index = 4	Epoch: 4	Loss: 0.262672
test acc on this client after 1867 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.27143568454112144}
################local_test_on_all_clients after local training in communication round: 68
{'test_acc_after': 0.9241516966067864, 'test_loss_after': 0.2145408323372969}
################local_test_on_all_clients before local training in communication round: 68
{'test_acc_before': 0.8872255489021956, 'test_loss_before': 0.3103344262598041}
################Communication round : 69
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 0
local mask changes: 2028.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2028.0, 3732.0, 3922.0, 3908.0, 3810.0]
Doing local aggregation!
test acc on this client before 1857 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.129967
Client Index = 0	Epoch: 1	Loss: 0.115829
Client Index = 0	Epoch: 2	Loss: 0.110788
Client Index = 0	Epoch: 3	Loss: 0.111115
Client Index = 0	Epoch: 4	Loss: 0.111623
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 1
local mask changes: 2034.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3742.0, 2034.0, 3918.0, 3988.0, 3932.0]
Doing local aggregation!
test acc on this client before 1900 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.173662
Client Index = 1	Epoch: 1	Loss: 0.169448
Client Index = 1	Epoch: 2	Loss: 0.169596
Client Index = 1	Epoch: 3	Loss: 0.165489
Client Index = 1	Epoch: 4	Loss: 0.156814
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 2
local mask changes: 2064.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3996.0, 4004.0, 2064.0, 3900.0, 3806.0]
Doing local aggregation!
test acc on this client before 1682 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.427238
Client Index = 2	Epoch: 1	Loss: 0.419447
Client Index = 2	Epoch: 2	Loss: 0.411375
Client Index = 2	Epoch: 3	Loss: 0.414017
Client Index = 2	Epoch: 4	Loss: 0.414526
test acc on this client after 1747 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 3
local mask changes: 2030.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3986.0, 4024.0, 3912.0, 2030.0, 3798.0]
Doing local aggregation!
test acc on this client before 1628 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.394130
Client Index = 3	Epoch: 1	Loss: 0.393913
Client Index = 3	Epoch: 2	Loss: 0.396146
Client Index = 3	Epoch: 3	Loss: 0.388044
Client Index = 3	Epoch: 4	Loss: 0.389208
test acc on this client after 1768 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 4
local mask changes: 2070.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3866.0, 3914.0, 3774.0, 3810.0, 2070.0]
Doing local aggregation!
test acc on this client before 1819 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.279090
Client Index = 4	Epoch: 1	Loss: 0.263625
Client Index = 4	Epoch: 2	Loss: 0.263253
Client Index = 4	Epoch: 3	Loss: 0.267872
Client Index = 4	Epoch: 4	Loss: 0.261069
test acc on this client after 1859 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2718913664209082}
################local_test_on_all_clients after local training in communication round: 69
{'test_acc_after': 0.9227544910179641, 'test_loss_after': 0.2147080322731279}
################local_test_on_all_clients before local training in communication round: 69
{'test_acc_before': 0.8868263473053892, 'test_loss_before': 0.31079112480500504}
################Communication round : 70
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 0
local mask changes: 1942.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1942.0, 3642.0, 3896.0, 3914.0, 3744.0]
Doing local aggregation!
test acc on this client before 1878 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.136876
Client Index = 0	Epoch: 1	Loss: 0.114003
Client Index = 0	Epoch: 2	Loss: 0.108201
Client Index = 0	Epoch: 3	Loss: 0.109185
Client Index = 0	Epoch: 4	Loss: 0.109379
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 1
local mask changes: 1964.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3688.0, 1964.0, 3880.0, 3924.0, 3876.0]
Doing local aggregation!
test acc on this client before 1897 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.174756
Client Index = 1	Epoch: 1	Loss: 0.169547
Client Index = 1	Epoch: 2	Loss: 0.164161
Client Index = 1	Epoch: 3	Loss: 0.162034
Client Index = 1	Epoch: 4	Loss: 0.155638
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 2
local mask changes: 1938.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3914.0, 3864.0, 1938.0, 3920.0, 3854.0]
Doing local aggregation!
test acc on this client before 1686 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.426265
Client Index = 2	Epoch: 1	Loss: 0.413620
Client Index = 2	Epoch: 2	Loss: 0.410441
Client Index = 2	Epoch: 3	Loss: 0.404042
Client Index = 2	Epoch: 4	Loss: 0.406798
test acc on this client after 1749 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 3
local mask changes: 1926.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3928.0, 3978.0, 3854.0, 1926.0, 3838.0]
Doing local aggregation!
test acc on this client before 1631 / 2004 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.403050
Client Index = 3	Epoch: 1	Loss: 0.398226
Client Index = 3	Epoch: 2	Loss: 0.390595
Client Index = 3	Epoch: 3	Loss: 0.389710
Client Index = 3	Epoch: 4	Loss: 0.382965
test acc on this client after 1791 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 4
local mask changes: 1972.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3814.0, 3882.0, 3782.0, 3790.0, 1972.0]
Doing local aggregation!
test acc on this client before 1816 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.273449
Client Index = 4	Epoch: 1	Loss: 0.260683
Client Index = 4	Epoch: 2	Loss: 0.266261
Client Index = 4	Epoch: 3	Loss: 0.265202
Client Index = 4	Epoch: 4	Loss: 0.263835
test acc on this client after 1878 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2703568479989437}
################local_test_on_all_clients after local training in communication round: 70
{'test_acc_after': 0.9267465069860279, 'test_loss_after': 0.21091698730985323}
################local_test_on_all_clients before local training in communication round: 70
{'test_acc_before': 0.8890219560878243, 'test_loss_before': 0.3063881444240996}
################Communication round : 71
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 0
local mask changes: 1872.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1872.0, 3600.0, 3820.0, 3762.0, 3720.0]
Doing local aggregation!
test acc on this client before 1848 / 2004 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.127509
Client Index = 0	Epoch: 1	Loss: 0.119774
Client Index = 0	Epoch: 2	Loss: 0.116972
Client Index = 0	Epoch: 3	Loss: 0.113856
Client Index = 0	Epoch: 4	Loss: 0.109841
test acc on this client after 1947 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 1
local mask changes: 1824.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3606.0, 1824.0, 3782.0, 3846.0, 3802.0]
Doing local aggregation!
test acc on this client before 1901 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.174364
Client Index = 1	Epoch: 1	Loss: 0.170693
Client Index = 1	Epoch: 2	Loss: 0.164116
Client Index = 1	Epoch: 3	Loss: 0.161176
Client Index = 1	Epoch: 4	Loss: 0.156160
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 2
local mask changes: 1838.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3862.0, 3844.0, 1838.0, 3846.0, 3822.0]
Doing local aggregation!
test acc on this client before 1691 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.424711
Client Index = 2	Epoch: 1	Loss: 0.406949
Client Index = 2	Epoch: 2	Loss: 0.417078
Client Index = 2	Epoch: 3	Loss: 0.412883
Client Index = 2	Epoch: 4	Loss: 0.407494
test acc on this client after 1737 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 3
local mask changes: 1860.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3850.0, 3948.0, 3822.0, 1860.0, 3740.0]
Doing local aggregation!
test acc on this client before 1660 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.408899
Client Index = 3	Epoch: 1	Loss: 0.392747
Client Index = 3	Epoch: 2	Loss: 0.385136
Client Index = 3	Epoch: 3	Loss: 0.392930
Client Index = 3	Epoch: 4	Loss: 0.385783
test acc on this client after 1796 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 4
local mask changes: 1872.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3698.0, 3794.0, 3780.0, 3758.0, 1872.0]
Doing local aggregation!
test acc on this client before 1825 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.271062
Client Index = 4	Epoch: 1	Loss: 0.268959
Client Index = 4	Epoch: 2	Loss: 0.264261
Client Index = 4	Epoch: 3	Loss: 0.265784
Client Index = 4	Epoch: 4	Loss: 0.255026
test acc on this client after 1876 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2709664293600524}
################local_test_on_all_clients after local training in communication round: 71
{'test_acc_after': 0.9260479041916166, 'test_loss_after': 0.2098352510444894}
################local_test_on_all_clients before local training in communication round: 71
{'test_acc_before': 0.8907185628742516, 'test_loss_before': 0.3033135522744375}
################Communication round : 72
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 0
local mask changes: 1748.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1748.0, 3494.0, 3730.0, 3758.0, 3600.0]
Doing local aggregation!
test acc on this client before 1868 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.121606
Client Index = 0	Epoch: 1	Loss: 0.115105
Client Index = 0	Epoch: 2	Loss: 0.118767
Client Index = 0	Epoch: 3	Loss: 0.111714
Client Index = 0	Epoch: 4	Loss: 0.107263
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 1
local mask changes: 1756.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3488.0, 1756.0, 3746.0, 3778.0, 3776.0]
Doing local aggregation!
test acc on this client before 1894 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.179154
Client Index = 1	Epoch: 1	Loss: 0.169676
Client Index = 1	Epoch: 2	Loss: 0.162130
Client Index = 1	Epoch: 3	Loss: 0.156755
Client Index = 1	Epoch: 4	Loss: 0.155091
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 2
local mask changes: 1736.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3760.0, 3744.0, 1736.0, 3790.0, 3728.0]
Doing local aggregation!
test acc on this client before 1680 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.419602
Client Index = 2	Epoch: 1	Loss: 0.408876
Client Index = 2	Epoch: 2	Loss: 0.419338
Client Index = 2	Epoch: 3	Loss: 0.413385
Client Index = 2	Epoch: 4	Loss: 0.400316
test acc on this client after 1748 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 3
local mask changes: 1720.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3794.0, 3864.0, 3762.0, 1720.0, 3736.0]
Doing local aggregation!
test acc on this client before 1668 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.401148
Client Index = 3	Epoch: 1	Loss: 0.394883
Client Index = 3	Epoch: 2	Loss: 0.385276
Client Index = 3	Epoch: 3	Loss: 0.386144
Client Index = 3	Epoch: 4	Loss: 0.393059
test acc on this client after 1787 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 4
local mask changes: 1738.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3642.0, 3760.0, 3758.0, 3702.0, 1738.0]
Doing local aggregation!
test acc on this client before 1820 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.265970
Client Index = 4	Epoch: 1	Loss: 0.266479
Client Index = 4	Epoch: 2	Loss: 0.262539
Client Index = 4	Epoch: 3	Loss: 0.267186
Client Index = 4	Epoch: 4	Loss: 0.259352
test acc on this client after 1873 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2696325615722131}
################local_test_on_all_clients after local training in communication round: 72
{'test_acc_after': 0.9260479041916169, 'test_loss_after': 0.21151185654059143}
################local_test_on_all_clients before local training in communication round: 72
{'test_acc_before': 0.8912175648702595, 'test_loss_before': 0.3027072709120676}
################Communication round : 73
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 0
local mask changes: 1636.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1636.0, 3472.0, 3714.0, 3742.0, 3660.0]
Doing local aggregation!
test acc on this client before 1876 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.130288
Client Index = 0	Epoch: 1	Loss: 0.116749
Client Index = 0	Epoch: 2	Loss: 0.113132
Client Index = 0	Epoch: 3	Loss: 0.111908
Client Index = 0	Epoch: 4	Loss: 0.108684
test acc on this client after 1946 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 1
local mask changes: 1654.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3458.0, 1654.0, 3750.0, 3758.0, 3696.0]
Doing local aggregation!
test acc on this client before 1897 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.176412
Client Index = 1	Epoch: 1	Loss: 0.167421
Client Index = 1	Epoch: 2	Loss: 0.164530
Client Index = 1	Epoch: 3	Loss: 0.163356
Client Index = 1	Epoch: 4	Loss: 0.162432
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 2
local mask changes: 1668.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3768.0, 3746.0, 1668.0, 3724.0, 3670.0]
Doing local aggregation!
test acc on this client before 1683 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.418009
Client Index = 2	Epoch: 1	Loss: 0.412520
Client Index = 2	Epoch: 2	Loss: 0.405237
Client Index = 2	Epoch: 3	Loss: 0.406290
Client Index = 2	Epoch: 4	Loss: 0.407831
test acc on this client after 1758 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 3
local mask changes: 1666.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3756.0, 3764.0, 3794.0, 1666.0, 3694.0]
Doing local aggregation!
test acc on this client before 1674 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.399058
Client Index = 3	Epoch: 1	Loss: 0.393865
Client Index = 3	Epoch: 2	Loss: 0.387387
Client Index = 3	Epoch: 3	Loss: 0.386625
Client Index = 3	Epoch: 4	Loss: 0.383212
test acc on this client after 1800 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 4
local mask changes: 1652.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3638.0, 3682.0, 3710.0, 3650.0, 1652.0]
Doing local aggregation!
test acc on this client before 1827 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.265830
Client Index = 4	Epoch: 1	Loss: 0.266409
Client Index = 4	Epoch: 2	Loss: 0.257543
Client Index = 4	Epoch: 3	Loss: 0.254830
Client Index = 4	Epoch: 4	Loss: 0.256803
test acc on this client after 1861 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26865452716642235}
################local_test_on_all_clients after local training in communication round: 73
{'test_acc_after': 0.927245508982036, 'test_loss_after': 0.21046924180910737}
################local_test_on_all_clients before local training in communication round: 73
{'test_acc_before': 0.8939121756487026, 'test_loss_before': 0.2975825401658784}
################Communication round : 74
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 0
local mask changes: 1580.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1580.0, 3406.0, 3670.0, 3682.0, 3566.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.127607
Client Index = 0	Epoch: 1	Loss: 0.114864
Client Index = 0	Epoch: 2	Loss: 0.114395
Client Index = 0	Epoch: 3	Loss: 0.112670
Client Index = 0	Epoch: 4	Loss: 0.110737
test acc on this client after 1946 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 1
local mask changes: 1552.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3398.0, 1552.0, 3704.0, 3682.0, 3606.0]
Doing local aggregation!
test acc on this client before 1898 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.178183
Client Index = 1	Epoch: 1	Loss: 0.161808
Client Index = 1	Epoch: 2	Loss: 0.164168
Client Index = 1	Epoch: 3	Loss: 0.156406
Client Index = 1	Epoch: 4	Loss: 0.160996
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 2
local mask changes: 1560.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3690.0, 3718.0, 1560.0, 3650.0, 3644.0]
Doing local aggregation!
test acc on this client before 1678 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.420894
Client Index = 2	Epoch: 1	Loss: 0.406151
Client Index = 2	Epoch: 2	Loss: 0.417644
Client Index = 2	Epoch: 3	Loss: 0.406461
Client Index = 2	Epoch: 4	Loss: 0.405102
test acc on this client after 1747 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 3
local mask changes: 1556.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3680.0, 3658.0, 3710.0, 1556.0, 3646.0]
Doing local aggregation!
test acc on this client before 1635 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.407001
Client Index = 3	Epoch: 1	Loss: 0.391343
Client Index = 3	Epoch: 2	Loss: 0.384543
Client Index = 3	Epoch: 3	Loss: 0.382970
Client Index = 3	Epoch: 4	Loss: 0.384043
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 4
local mask changes: 1564.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3578.0, 3604.0, 3612.0, 3604.0, 1564.0]
Doing local aggregation!
test acc on this client before 1822 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.271513
Client Index = 4	Epoch: 1	Loss: 0.274900
Client Index = 4	Epoch: 2	Loss: 0.262528
Client Index = 4	Epoch: 3	Loss: 0.258305
Client Index = 4	Epoch: 4	Loss: 0.260318
test acc on this client after 1872 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2694219677411812}
################local_test_on_all_clients after local training in communication round: 74
{'test_acc_after': 0.9266467065868265, 'test_loss_after': 0.21053100780931538}
################local_test_on_all_clients before local training in communication round: 74
{'test_acc_before': 0.8892215568862276, 'test_loss_before': 0.30740127956082003}
################Communication round : 75
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 0
local mask changes: 1466.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1466.0, 3292.0, 3596.0, 3580.0, 3522.0]
Doing local aggregation!
test acc on this client before 1872 / 2004 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.130453
Client Index = 0	Epoch: 1	Loss: 0.116015
Client Index = 0	Epoch: 2	Loss: 0.109179
Client Index = 0	Epoch: 3	Loss: 0.109962
Client Index = 0	Epoch: 4	Loss: 0.106782
test acc on this client after 1947 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 1
local mask changes: 1438.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3374.0, 1438.0, 3592.0, 3638.0, 3584.0]
Doing local aggregation!
test acc on this client before 1898 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.177308
Client Index = 1	Epoch: 1	Loss: 0.161838
Client Index = 1	Epoch: 2	Loss: 0.167007
Client Index = 1	Epoch: 3	Loss: 0.157904
Client Index = 1	Epoch: 4	Loss: 0.156857
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 2
local mask changes: 1442.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3654.0, 3640.0, 1442.0, 3642.0, 3560.0]
Doing local aggregation!
test acc on this client before 1680 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.419960
Client Index = 2	Epoch: 1	Loss: 0.415685
Client Index = 2	Epoch: 2	Loss: 0.410060
Client Index = 2	Epoch: 3	Loss: 0.401286
Client Index = 2	Epoch: 4	Loss: 0.403462
test acc on this client after 1751 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 3
local mask changes: 1442.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3642.0, 3644.0, 3610.0, 1442.0, 3602.0]
Doing local aggregation!
test acc on this client before 1646 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.400120
Client Index = 3	Epoch: 1	Loss: 0.392274
Client Index = 3	Epoch: 2	Loss: 0.386149
Client Index = 3	Epoch: 3	Loss: 0.381931
Client Index = 3	Epoch: 4	Loss: 0.382097
test acc on this client after 1787 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 4
local mask changes: 1442.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3550.0, 3524.0, 3566.0, 3574.0, 1442.0]
Doing local aggregation!
test acc on this client before 1816 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.270822
Client Index = 4	Epoch: 1	Loss: 0.267233
Client Index = 4	Epoch: 2	Loss: 0.256609
Client Index = 4	Epoch: 3	Loss: 0.263691
Client Index = 4	Epoch: 4	Loss: 0.259456
test acc on this client after 1866 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26816556342897263}
################local_test_on_all_clients after local training in communication round: 75
{'test_acc_after': 0.9256487025948104, 'test_loss_after': 0.21590474357832218}
################local_test_on_all_clients before local training in communication round: 75
{'test_acc_before': 0.8894211576846306, 'test_loss_before': 0.30813816518126846}
################Communication round : 76
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 0
local mask changes: 1368.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1368.0, 3258.0, 3594.0, 3552.0, 3516.0]
Doing local aggregation!
test acc on this client before 1890 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.129471
Client Index = 0	Epoch: 1	Loss: 0.114787
Client Index = 0	Epoch: 2	Loss: 0.110195
Client Index = 0	Epoch: 3	Loss: 0.113774
Client Index = 0	Epoch: 4	Loss: 0.107214
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 1
local mask changes: 1358.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3260.0, 1358.0, 3544.0, 3646.0, 3512.0]
Doing local aggregation!
test acc on this client before 1899 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.175187
Client Index = 1	Epoch: 1	Loss: 0.165979
Client Index = 1	Epoch: 2	Loss: 0.160363
Client Index = 1	Epoch: 3	Loss: 0.158956
Client Index = 1	Epoch: 4	Loss: 0.159240
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 2
local mask changes: 1360.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3586.0, 3578.0, 1360.0, 3570.0, 3528.0]
Doing local aggregation!
test acc on this client before 1692 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.416626
Client Index = 2	Epoch: 1	Loss: 0.421068
Client Index = 2	Epoch: 2	Loss: 0.411884
Client Index = 2	Epoch: 3	Loss: 0.410243
Client Index = 2	Epoch: 4	Loss: 0.409443
test acc on this client after 1744 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 3
local mask changes: 1362.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3620.0, 3668.0, 3580.0, 1362.0, 3536.0]
Doing local aggregation!
test acc on this client before 1644 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.400537
Client Index = 3	Epoch: 1	Loss: 0.391996
Client Index = 3	Epoch: 2	Loss: 0.393363
Client Index = 3	Epoch: 3	Loss: 0.390286
Client Index = 3	Epoch: 4	Loss: 0.377390
test acc on this client after 1791 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 4
local mask changes: 1380.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3516.0, 3532.0, 3534.0, 3512.0, 1380.0]
Doing local aggregation!
test acc on this client before 1814 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.275295
Client Index = 4	Epoch: 1	Loss: 0.259571
Client Index = 4	Epoch: 2	Loss: 0.262457
Client Index = 4	Epoch: 3	Loss: 0.261760
Client Index = 4	Epoch: 4	Loss: 0.259729
test acc on this client after 1871 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2694724398581905}
################local_test_on_all_clients after local training in communication round: 76
{'test_acc_after': 0.9266467065868262, 'test_loss_after': 0.21075230504343373}
################local_test_on_all_clients before local training in communication round: 76
{'test_acc_before': 0.8921157684630738, 'test_loss_before': 0.3027374175196874}
################Communication round : 77
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 0
local mask changes: 1266.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1266.0, 3246.0, 3472.0, 3532.0, 3470.0]
Doing local aggregation!
test acc on this client before 1885 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.128240
Client Index = 0	Epoch: 1	Loss: 0.113201
Client Index = 0	Epoch: 2	Loss: 0.112274
Client Index = 0	Epoch: 3	Loss: 0.114453
Client Index = 0	Epoch: 4	Loss: 0.111789
test acc on this client after 1943 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 1
local mask changes: 1284.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3266.0, 1284.0, 3496.0, 3636.0, 3542.0]
Doing local aggregation!
test acc on this client before 1911 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.174240
Client Index = 1	Epoch: 1	Loss: 0.163537
Client Index = 1	Epoch: 2	Loss: 0.156222
Client Index = 1	Epoch: 3	Loss: 0.154714
Client Index = 1	Epoch: 4	Loss: 0.154144
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 2
local mask changes: 1282.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3562.0, 3506.0, 1282.0, 3562.0, 3518.0]
Doing local aggregation!
test acc on this client before 1696 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.418926
Client Index = 2	Epoch: 1	Loss: 0.403907
Client Index = 2	Epoch: 2	Loss: 0.412692
Client Index = 2	Epoch: 3	Loss: 0.402314
Client Index = 2	Epoch: 4	Loss: 0.409665
test acc on this client after 1749 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 3
local mask changes: 1276.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3580.0, 3604.0, 3542.0, 1276.0, 3504.0]
Doing local aggregation!
test acc on this client before 1661 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.401766
Client Index = 3	Epoch: 1	Loss: 0.394233
Client Index = 3	Epoch: 2	Loss: 0.388260
Client Index = 3	Epoch: 3	Loss: 0.388037
Client Index = 3	Epoch: 4	Loss: 0.386060
test acc on this client after 1788 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 4
local mask changes: 1270.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3446.0, 3448.0, 3474.0, 3488.0, 1270.0]
Doing local aggregation!
test acc on this client before 1829 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.272885
Client Index = 4	Epoch: 1	Loss: 0.257716
Client Index = 4	Epoch: 2	Loss: 0.257725
Client Index = 4	Epoch: 3	Loss: 0.255275
Client Index = 4	Epoch: 4	Loss: 0.254993
test acc on this client after 1873 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.267490781535335}
################local_test_on_all_clients after local training in communication round: 77
{'test_acc_after': 0.9260479041916169, 'test_loss_after': 0.21196257573461344}
################local_test_on_all_clients before local training in communication round: 77
{'test_acc_before': 0.8964071856287426, 'test_loss_before': 0.29081336590582263}
################Communication round : 78
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 0
local mask changes: 1178.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1178.0, 3260.0, 3514.0, 3490.0, 3392.0]
Doing local aggregation!
test acc on this client before 1883 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.126870
Client Index = 0	Epoch: 1	Loss: 0.115992
Client Index = 0	Epoch: 2	Loss: 0.117404
Client Index = 0	Epoch: 3	Loss: 0.115708
Client Index = 0	Epoch: 4	Loss: 0.105756
test acc on this client after 1947 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 1
local mask changes: 1170.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3218.0, 1170.0, 3454.0, 3556.0, 3390.0]
Doing local aggregation!
test acc on this client before 1901 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.171707
Client Index = 1	Epoch: 1	Loss: 0.159157
Client Index = 1	Epoch: 2	Loss: 0.161408
Client Index = 1	Epoch: 3	Loss: 0.160777
Client Index = 1	Epoch: 4	Loss: 0.153588
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 2
local mask changes: 1186.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3558.0, 3512.0, 1186.0, 3536.0, 3448.0]
Doing local aggregation!
test acc on this client before 1702 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.416223
Client Index = 2	Epoch: 1	Loss: 0.404446
Client Index = 2	Epoch: 2	Loss: 0.409448
Client Index = 2	Epoch: 3	Loss: 0.404427
Client Index = 2	Epoch: 4	Loss: 0.407241
test acc on this client after 1744 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 3
local mask changes: 1176.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3562.0, 3592.0, 3558.0, 1176.0, 3466.0]
Doing local aggregation!
test acc on this client before 1661 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.398740
Client Index = 3	Epoch: 1	Loss: 0.399896
Client Index = 3	Epoch: 2	Loss: 0.387761
Client Index = 3	Epoch: 3	Loss: 0.385202
Client Index = 3	Epoch: 4	Loss: 0.377153
test acc on this client after 1784 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 4
local mask changes: 1182.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3380.0, 3454.0, 3442.0, 3466.0, 1182.0]
Doing local aggregation!
test acc on this client before 1828 / 2004 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.267727
Client Index = 4	Epoch: 1	Loss: 0.268302
Client Index = 4	Epoch: 2	Loss: 0.262822
Client Index = 4	Epoch: 3	Loss: 0.262580
Client Index = 4	Epoch: 4	Loss: 0.256473
test acc on this client after 1877 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26787233143965616}
################local_test_on_all_clients after local training in communication round: 78
{'test_acc_after': 0.92624750499002, 'test_loss_after': 0.21022666463119064}
################local_test_on_all_clients before local training in communication round: 78
{'test_acc_before': 0.8957085828343315, 'test_loss_before': 0.2928194225369813}
################Communication round : 79
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 0
local mask changes: 1066.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1066.0, 3202.0, 3496.0, 3468.0, 3358.0]
Doing local aggregation!
test acc on this client before 1886 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.129083
Client Index = 0	Epoch: 1	Loss: 0.116352
Client Index = 0	Epoch: 2	Loss: 0.116641
Client Index = 0	Epoch: 3	Loss: 0.114766
Client Index = 0	Epoch: 4	Loss: 0.104791
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 1
local mask changes: 1092.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3212.0, 1092.0, 3430.0, 3550.0, 3384.0]
Doing local aggregation!
test acc on this client before 1913 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.171046
Client Index = 1	Epoch: 1	Loss: 0.166277
Client Index = 1	Epoch: 2	Loss: 0.162957
Client Index = 1	Epoch: 3	Loss: 0.158002
Client Index = 1	Epoch: 4	Loss: 0.156678
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 2
local mask changes: 1102.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3486.0, 3450.0, 1102.0, 3488.0, 3380.0]
Doing local aggregation!
test acc on this client before 1701 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.413721
Client Index = 2	Epoch: 1	Loss: 0.406316
Client Index = 2	Epoch: 2	Loss: 0.399324
Client Index = 2	Epoch: 3	Loss: 0.410078
Client Index = 2	Epoch: 4	Loss: 0.406201
test acc on this client after 1745 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 3
local mask changes: 1088.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3462.0, 3514.0, 3500.0, 1088.0, 3414.0]
Doing local aggregation!
test acc on this client before 1657 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.402719
Client Index = 3	Epoch: 1	Loss: 0.388486
Client Index = 3	Epoch: 2	Loss: 0.391269
Client Index = 3	Epoch: 3	Loss: 0.387214
Client Index = 3	Epoch: 4	Loss: 0.379760
test acc on this client after 1787 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 4
local mask changes: 1072.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3366.0, 3420.0, 3396.0, 3434.0, 1072.0]
Doing local aggregation!
test acc on this client before 1839 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.271963
Client Index = 4	Epoch: 1	Loss: 0.266142
Client Index = 4	Epoch: 2	Loss: 0.262266
Client Index = 4	Epoch: 3	Loss: 0.257837
Client Index = 4	Epoch: 4	Loss: 0.257030
test acc on this client after 1875 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2678767158772717}
################local_test_on_all_clients after local training in communication round: 79
{'test_acc_after': 0.9257485029940119, 'test_loss_after': 0.20969124146980675}
################local_test_on_all_clients before local training in communication round: 79
{'test_acc_before': 0.8978043912175648, 'test_loss_before': 0.29164726575334626}
################Communication round : 80
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 0
local mask changes: 1010.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1010.0, 3182.0, 3428.0, 3432.0, 3318.0]
Doing local aggregation!
test acc on this client before 1877 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.130797
Client Index = 0	Epoch: 1	Loss: 0.112308
Client Index = 0	Epoch: 2	Loss: 0.113076
Client Index = 0	Epoch: 3	Loss: 0.111253
Client Index = 0	Epoch: 4	Loss: 0.110371
test acc on this client after 1949 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 1
local mask changes: 998.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3198.0, 998.0, 3442.0, 3506.0, 3404.0]
Doing local aggregation!
test acc on this client before 1910 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.174339
Client Index = 1	Epoch: 1	Loss: 0.169236
Client Index = 1	Epoch: 2	Loss: 0.159553
Client Index = 1	Epoch: 3	Loss: 0.152544
Client Index = 1	Epoch: 4	Loss: 0.157443
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 2
local mask changes: 1008.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3462.0, 3406.0, 1008.0, 3468.0, 3372.0]
Doing local aggregation!
test acc on this client before 1695 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.416378
Client Index = 2	Epoch: 1	Loss: 0.407464
Client Index = 2	Epoch: 2	Loss: 0.405985
Client Index = 2	Epoch: 3	Loss: 0.406707
Client Index = 2	Epoch: 4	Loss: 0.401033
test acc on this client after 1750 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 3
local mask changes: 994.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3458.0, 3536.0, 3460.0, 994.0, 3404.0]
Doing local aggregation!
test acc on this client before 1653 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.396018
Client Index = 3	Epoch: 1	Loss: 0.389761
Client Index = 3	Epoch: 2	Loss: 0.384810
Client Index = 3	Epoch: 3	Loss: 0.385326
Client Index = 3	Epoch: 4	Loss: 0.378118
test acc on this client after 1787 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 4
local mask changes: 994.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3352.0, 3398.0, 3326.0, 3362.0, 994.0]
Doing local aggregation!
test acc on this client before 1839 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.263801
Client Index = 4	Epoch: 1	Loss: 0.265478
Client Index = 4	Epoch: 2	Loss: 0.259088
Client Index = 4	Epoch: 3	Loss: 0.260284
Client Index = 4	Epoch: 4	Loss: 0.258823
test acc on this client after 1862 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2667997600486938}
################local_test_on_all_clients after local training in communication round: 80
{'test_acc_after': 0.9256487025948104, 'test_loss_after': 0.21171650566800154}
################local_test_on_all_clients before local training in communication round: 80
{'test_acc_before': 0.8956087824351296, 'test_loss_before': 0.29277937910751906}
################Communication round : 81
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 0
local mask changes: 916.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [916.0, 3164.0, 3378.0, 3434.0, 3288.0]
Doing local aggregation!
test acc on this client before 1883 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.126714
Client Index = 0	Epoch: 1	Loss: 0.113956
Client Index = 0	Epoch: 2	Loss: 0.113160
Client Index = 0	Epoch: 3	Loss: 0.106993
Client Index = 0	Epoch: 4	Loss: 0.106878
test acc on this client after 1946 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 1
local mask changes: 916.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3134.0, 916.0, 3374.0, 3454.0, 3322.0]
Doing local aggregation!
test acc on this client before 1914 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.177743
Client Index = 1	Epoch: 1	Loss: 0.164843
Client Index = 1	Epoch: 2	Loss: 0.162592
Client Index = 1	Epoch: 3	Loss: 0.156258
Client Index = 1	Epoch: 4	Loss: 0.152012
test acc on this client after 1929 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 2
local mask changes: 914.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3428.0, 3382.0, 914.0, 3434.0, 3344.0]
Doing local aggregation!
test acc on this client before 1689 / 2004 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.414686
Client Index = 2	Epoch: 1	Loss: 0.403441
Client Index = 2	Epoch: 2	Loss: 0.408636
Client Index = 2	Epoch: 3	Loss: 0.402152
Client Index = 2	Epoch: 4	Loss: 0.394844
test acc on this client after 1740 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 3
local mask changes: 896.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3432.0, 3476.0, 3392.0, 896.0, 3294.0]
Doing local aggregation!
test acc on this client before 1653 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.391601
Client Index = 3	Epoch: 1	Loss: 0.387960
Client Index = 3	Epoch: 2	Loss: 0.394605
Client Index = 3	Epoch: 3	Loss: 0.384202
Client Index = 3	Epoch: 4	Loss: 0.385376
test acc on this client after 1779 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 4
local mask changes: 914.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3270.0, 3316.0, 3296.0, 3306.0, 914.0]
Doing local aggregation!
test acc on this client before 1844 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.267751
Client Index = 4	Epoch: 1	Loss: 0.267278
Client Index = 4	Epoch: 2	Loss: 0.259708
Client Index = 4	Epoch: 3	Loss: 0.262072
Client Index = 4	Epoch: 4	Loss: 0.252256
test acc on this client after 1860 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2663086751253998}
################local_test_on_all_clients after local training in communication round: 81
{'test_acc_after': 0.9235528942115769, 'test_loss_after': 0.21361158075565823}
################local_test_on_all_clients before local training in communication round: 81
{'test_acc_before': 0.896506986027944, 'test_loss_before': 0.29112403659287567}
################Communication round : 82
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 0
local mask changes: 842.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [842.0, 3110.0, 3358.0, 3404.0, 3264.0]
Doing local aggregation!
test acc on this client before 1888 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.119221
Client Index = 0	Epoch: 1	Loss: 0.110865
Client Index = 0	Epoch: 2	Loss: 0.118804
Client Index = 0	Epoch: 3	Loss: 0.107099
Client Index = 0	Epoch: 4	Loss: 0.103736
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 1
local mask changes: 828.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3120.0, 828.0, 3382.0, 3446.0, 3320.0]
Doing local aggregation!
test acc on this client before 1913 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.174426
Client Index = 1	Epoch: 1	Loss: 0.163510
Client Index = 1	Epoch: 2	Loss: 0.155775
Client Index = 1	Epoch: 3	Loss: 0.156146
Client Index = 1	Epoch: 4	Loss: 0.154258
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 2
local mask changes: 826.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3392.0, 3318.0, 826.0, 3352.0, 3298.0]
Doing local aggregation!
test acc on this client before 1705 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.413991
Client Index = 2	Epoch: 1	Loss: 0.411030
Client Index = 2	Epoch: 2	Loss: 0.402690
Client Index = 2	Epoch: 3	Loss: 0.396124
Client Index = 2	Epoch: 4	Loss: 0.397925
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 3
local mask changes: 840.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3390.0, 3436.0, 3378.0, 840.0, 3270.0]
Doing local aggregation!
test acc on this client before 1661 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.398067
Client Index = 3	Epoch: 1	Loss: 0.389939
Client Index = 3	Epoch: 2	Loss: 0.392204
Client Index = 3	Epoch: 3	Loss: 0.384360
Client Index = 3	Epoch: 4	Loss: 0.376518
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 4
local mask changes: 840.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3250.0, 3274.0, 3278.0, 3246.0, 840.0]
Doing local aggregation!
test acc on this client before 1855 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.263566
Client Index = 4	Epoch: 1	Loss: 0.257258
Client Index = 4	Epoch: 2	Loss: 0.263847
Client Index = 4	Epoch: 3	Loss: 0.245782
Client Index = 4	Epoch: 4	Loss: 0.257435
test acc on this client after 1871 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2645830173449631}
################local_test_on_all_clients after local training in communication round: 82
{'test_acc_after': 0.925449101796407, 'test_loss_after': 0.21322811129326352}
################local_test_on_all_clients before local training in communication round: 82
{'test_acc_before': 0.9003992015968064, 'test_loss_before': 0.28973616622760145}
################Communication round : 83
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 0
local mask changes: 734.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [734.0, 3090.0, 3358.0, 3386.0, 3230.0]
Doing local aggregation!
test acc on this client before 1887 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.129708
Client Index = 0	Epoch: 1	Loss: 0.112443
Client Index = 0	Epoch: 2	Loss: 0.115380
Client Index = 0	Epoch: 3	Loss: 0.110365
Client Index = 0	Epoch: 4	Loss: 0.104441
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 1
local mask changes: 748.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3100.0, 748.0, 3304.0, 3436.0, 3296.0]
Doing local aggregation!
test acc on this client before 1906 / 2004 : 0.95
Client Index = 1	Epoch: 0	Loss: 0.180674
Client Index = 1	Epoch: 1	Loss: 0.164720
Client Index = 1	Epoch: 2	Loss: 0.157238
Client Index = 1	Epoch: 3	Loss: 0.157972
Client Index = 1	Epoch: 4	Loss: 0.154557
test acc on this client after 1925 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 2
local mask changes: 748.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3374.0, 3362.0, 748.0, 3352.0, 3308.0]
Doing local aggregation!
test acc on this client before 1695 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.412259
Client Index = 2	Epoch: 1	Loss: 0.410334
Client Index = 2	Epoch: 2	Loss: 0.404064
Client Index = 2	Epoch: 3	Loss: 0.402946
Client Index = 2	Epoch: 4	Loss: 0.403011
test acc on this client after 1744 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 3
local mask changes: 740.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3392.0, 3474.0, 3346.0, 740.0, 3246.0]
Doing local aggregation!
test acc on this client before 1640 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.390729
Client Index = 3	Epoch: 1	Loss: 0.382656
Client Index = 3	Epoch: 2	Loss: 0.389296
Client Index = 3	Epoch: 3	Loss: 0.384113
Client Index = 3	Epoch: 4	Loss: 0.377292
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 4
local mask changes: 754.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3190.0, 3292.0, 3268.0, 3206.0, 754.0]
Doing local aggregation!
test acc on this client before 1850 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.265186
Client Index = 4	Epoch: 1	Loss: 0.253942
Client Index = 4	Epoch: 2	Loss: 0.253974
Client Index = 4	Epoch: 3	Loss: 0.256099
Client Index = 4	Epoch: 4	Loss: 0.256236
test acc on this client after 1873 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26518533156352475}
################local_test_on_all_clients after local training in communication round: 83
{'test_acc_after': 0.9260479041916169, 'test_loss_after': 0.2100970871820897}
################local_test_on_all_clients before local training in communication round: 83
{'test_acc_before': 0.8960079840319362, 'test_loss_before': 0.2928972768063793}
################Communication round : 84
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 0
local mask changes: 672.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [672.0, 3014.0, 3354.0, 3374.0, 3182.0]
Doing local aggregation!
test acc on this client before 1887 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.122586
Client Index = 0	Epoch: 1	Loss: 0.117644
Client Index = 0	Epoch: 2	Loss: 0.111189
Client Index = 0	Epoch: 3	Loss: 0.112219
Client Index = 0	Epoch: 4	Loss: 0.107063
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 1
local mask changes: 682.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3056.0, 682.0, 3306.0, 3452.0, 3260.0]
Doing local aggregation!
test acc on this client before 1917 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.174057
Client Index = 1	Epoch: 1	Loss: 0.163824
Client Index = 1	Epoch: 2	Loss: 0.162793
Client Index = 1	Epoch: 3	Loss: 0.158368
Client Index = 1	Epoch: 4	Loss: 0.149861
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 2
local mask changes: 678.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3372.0, 3322.0, 678.0, 3360.0, 3300.0]
Doing local aggregation!
test acc on this client before 1695 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.413622
Client Index = 2	Epoch: 1	Loss: 0.409258
Client Index = 2	Epoch: 2	Loss: 0.401171
Client Index = 2	Epoch: 3	Loss: 0.397494
Client Index = 2	Epoch: 4	Loss: 0.401474
test acc on this client after 1750 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 3
local mask changes: 672.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3380.0, 3422.0, 3380.0, 672.0, 3214.0]
Doing local aggregation!
test acc on this client before 1643 / 2004 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.394279
Client Index = 3	Epoch: 1	Loss: 0.380331
Client Index = 3	Epoch: 2	Loss: 0.374489
Client Index = 3	Epoch: 3	Loss: 0.379631
Client Index = 3	Epoch: 4	Loss: 0.377142
test acc on this client after 1794 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 4
local mask changes: 672.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3210.0, 3292.0, 3292.0, 3218.0, 672.0]
Doing local aggregation!
test acc on this client before 1854 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.261554
Client Index = 4	Epoch: 1	Loss: 0.268827
Client Index = 4	Epoch: 2	Loss: 0.251526
Client Index = 4	Epoch: 3	Loss: 0.252853
Client Index = 4	Epoch: 4	Loss: 0.252025
test acc on this client after 1877 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2638111601872964}
################local_test_on_all_clients after local training in communication round: 84
{'test_acc_after': 0.9273453093812376, 'test_loss_after': 0.2107703637101217}
################local_test_on_all_clients before local training in communication round: 84
{'test_acc_before': 0.8978043912175648, 'test_loss_before': 0.29355325529913223}
################Communication round : 85
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 0
local mask changes: 608.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [608.0, 3016.0, 3344.0, 3368.0, 3206.0]
Doing local aggregation!
test acc on this client before 1884 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.123130
Client Index = 0	Epoch: 1	Loss: 0.113463
Client Index = 0	Epoch: 2	Loss: 0.112530
Client Index = 0	Epoch: 3	Loss: 0.103914
Client Index = 0	Epoch: 4	Loss: 0.108297
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 1
local mask changes: 602.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2964.0, 602.0, 3280.0, 3380.0, 3282.0]
Doing local aggregation!
test acc on this client before 1916 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.169870
Client Index = 1	Epoch: 1	Loss: 0.161001
Client Index = 1	Epoch: 2	Loss: 0.163007
Client Index = 1	Epoch: 3	Loss: 0.152900
Client Index = 1	Epoch: 4	Loss: 0.151349
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 2
local mask changes: 608.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3366.0, 3334.0, 608.0, 3336.0, 3308.0]
Doing local aggregation!
test acc on this client before 1715 / 2004 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.404592
Client Index = 2	Epoch: 1	Loss: 0.404524
Client Index = 2	Epoch: 2	Loss: 0.405903
Client Index = 2	Epoch: 3	Loss: 0.410791
Client Index = 2	Epoch: 4	Loss: 0.395087
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 3
local mask changes: 610.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3378.0, 3426.0, 3334.0, 610.0, 3222.0]
Doing local aggregation!
test acc on this client before 1670 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.392054
Client Index = 3	Epoch: 1	Loss: 0.380119
Client Index = 3	Epoch: 2	Loss: 0.381505
Client Index = 3	Epoch: 3	Loss: 0.380437
Client Index = 3	Epoch: 4	Loss: 0.375742
test acc on this client after 1788 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 4
local mask changes: 610.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3186.0, 3268.0, 3260.0, 3222.0, 610.0]
Doing local aggregation!
test acc on this client before 1848 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.272178
Client Index = 4	Epoch: 1	Loss: 0.264288
Client Index = 4	Epoch: 2	Loss: 0.257451
Client Index = 4	Epoch: 3	Loss: 0.266040
Client Index = 4	Epoch: 4	Loss: 0.260494
test acc on this client after 1865 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2644267057754258}
################local_test_on_all_clients after local training in communication round: 85
{'test_acc_after': 0.9252495009980042, 'test_loss_after': 0.21228512438820926}
################local_test_on_all_clients before local training in communication round: 85
{'test_acc_before': 0.901497005988024, 'test_loss_before': 0.28370894692139237}
################Communication round : 86
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 0
local mask changes: 528.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [528.0, 3008.0, 3366.0, 3362.0, 3186.0]
Doing local aggregation!
test acc on this client before 1881 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.124968
Client Index = 0	Epoch: 1	Loss: 0.111712
Client Index = 0	Epoch: 2	Loss: 0.107148
Client Index = 0	Epoch: 3	Loss: 0.107247
Client Index = 0	Epoch: 4	Loss: 0.103424
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 1
local mask changes: 542.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2988.0, 542.0, 3302.0, 3384.0, 3262.0]
Doing local aggregation!
test acc on this client before 1916 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.171697
Client Index = 1	Epoch: 1	Loss: 0.160633
Client Index = 1	Epoch: 2	Loss: 0.157663
Client Index = 1	Epoch: 3	Loss: 0.150782
Client Index = 1	Epoch: 4	Loss: 0.154131
test acc on this client after 1921 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 2
local mask changes: 520.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3342.0, 3268.0, 520.0, 3278.0, 3242.0]
Doing local aggregation!
test acc on this client before 1709 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.402353
Client Index = 2	Epoch: 1	Loss: 0.401989
Client Index = 2	Epoch: 2	Loss: 0.405554
Client Index = 2	Epoch: 3	Loss: 0.398417
Client Index = 2	Epoch: 4	Loss: 0.394850
test acc on this client after 1746 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 3
local mask changes: 536.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3376.0, 3388.0, 3342.0, 536.0, 3206.0]
Doing local aggregation!
test acc on this client before 1689 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.394045
Client Index = 3	Epoch: 1	Loss: 0.384863
Client Index = 3	Epoch: 2	Loss: 0.388908
Client Index = 3	Epoch: 3	Loss: 0.384613
Client Index = 3	Epoch: 4	Loss: 0.378455
test acc on this client after 1796 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 4
local mask changes: 534.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3212.0, 3258.0, 3278.0, 3224.0, 534.0]
Doing local aggregation!
test acc on this client before 1866 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.266293
Client Index = 4	Epoch: 1	Loss: 0.258839
Client Index = 4	Epoch: 2	Loss: 0.253852
Client Index = 4	Epoch: 3	Loss: 0.262244
Client Index = 4	Epoch: 4	Loss: 0.259332
test acc on this client after 1868 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2633605244438699}
################local_test_on_all_clients after local training in communication round: 86
{'test_acc_after': 0.9260479041916166, 'test_loss_after': 0.21101143359543081}
################local_test_on_all_clients before local training in communication round: 86
{'test_acc_before': 0.9042914171656686, 'test_loss_before': 0.2774443386379116}
################Communication round : 87
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 0
local mask changes: 466.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [466.0, 2984.0, 3324.0, 3310.0, 3180.0]
Doing local aggregation!
test acc on this client before 1888 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.121941
Client Index = 0	Epoch: 1	Loss: 0.117834
Client Index = 0	Epoch: 2	Loss: 0.115102
Client Index = 0	Epoch: 3	Loss: 0.108986
Client Index = 0	Epoch: 4	Loss: 0.103443
test acc on this client after 1947 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 1
local mask changes: 476.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2990.0, 476.0, 3256.0, 3360.0, 3264.0]
Doing local aggregation!
test acc on this client before 1916 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.174184
Client Index = 1	Epoch: 1	Loss: 0.165020
Client Index = 1	Epoch: 2	Loss: 0.160013
Client Index = 1	Epoch: 3	Loss: 0.151673
Client Index = 1	Epoch: 4	Loss: 0.153516
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 2
local mask changes: 468.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3308.0, 3252.0, 468.0, 3336.0, 3264.0]
Doing local aggregation!
test acc on this client before 1711 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.417980
Client Index = 2	Epoch: 1	Loss: 0.404852
Client Index = 2	Epoch: 2	Loss: 0.405780
Client Index = 2	Epoch: 3	Loss: 0.401396
Client Index = 2	Epoch: 4	Loss: 0.399291
test acc on this client after 1756 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 3
local mask changes: 464.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3310.0, 3372.0, 3248.0, 464.0, 3168.0]
Doing local aggregation!
test acc on this client before 1691 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.390976
Client Index = 3	Epoch: 1	Loss: 0.378358
Client Index = 3	Epoch: 2	Loss: 0.386600
Client Index = 3	Epoch: 3	Loss: 0.375795
Client Index = 3	Epoch: 4	Loss: 0.381324
test acc on this client after 1779 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 4
local mask changes: 468.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3188.0, 3292.0, 3244.0, 3226.0, 468.0]
Doing local aggregation!
test acc on this client before 1855 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.264334
Client Index = 4	Epoch: 1	Loss: 0.261873
Client Index = 4	Epoch: 2	Loss: 0.260519
Client Index = 4	Epoch: 3	Loss: 0.253164
Client Index = 4	Epoch: 4	Loss: 0.256308
test acc on this client after 1872 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2644104250599729}
################local_test_on_all_clients after local training in communication round: 87
{'test_acc_after': 0.9266467065868262, 'test_loss_after': 0.2130355050002862}
################local_test_on_all_clients before local training in communication round: 87
{'test_acc_before': 0.9042914171656686, 'test_loss_before': 0.2792869521442526}
################Communication round : 88
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 0
local mask changes: 408.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [408.0, 2948.0, 3272.0, 3252.0, 3162.0]
Doing local aggregation!
test acc on this client before 1892 / 2004 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.119526
Client Index = 0	Epoch: 1	Loss: 0.110127
Client Index = 0	Epoch: 2	Loss: 0.108298
Client Index = 0	Epoch: 3	Loss: 0.108072
Client Index = 0	Epoch: 4	Loss: 0.110024
test acc on this client after 1951 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 1
local mask changes: 408.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2980.0, 408.0, 3230.0, 3318.0, 3280.0]
Doing local aggregation!
test acc on this client before 1919 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.172057
Client Index = 1	Epoch: 1	Loss: 0.162551
Client Index = 1	Epoch: 2	Loss: 0.155727
Client Index = 1	Epoch: 3	Loss: 0.156130
Client Index = 1	Epoch: 4	Loss: 0.157844
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 2
local mask changes: 412.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3332.0, 3264.0, 412.0, 3282.0, 3274.0]
Doing local aggregation!
test acc on this client before 1695 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.407733
Client Index = 2	Epoch: 1	Loss: 0.402492
Client Index = 2	Epoch: 2	Loss: 0.403601
Client Index = 2	Epoch: 3	Loss: 0.394967
Client Index = 2	Epoch: 4	Loss: 0.397396
test acc on this client after 1740 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 3
local mask changes: 410.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3290.0, 3302.0, 3264.0, 410.0, 3194.0]
Doing local aggregation!
test acc on this client before 1659 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.396762
Client Index = 3	Epoch: 1	Loss: 0.384505
Client Index = 3	Epoch: 2	Loss: 0.384864
Client Index = 3	Epoch: 3	Loss: 0.377904
Client Index = 3	Epoch: 4	Loss: 0.380024
test acc on this client after 1803 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 4
local mask changes: 408.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3156.0, 3240.0, 3248.0, 3166.0, 408.0]
Doing local aggregation!
test acc on this client before 1847 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.263888
Client Index = 4	Epoch: 1	Loss: 0.263567
Client Index = 4	Epoch: 2	Loss: 0.252054
Client Index = 4	Epoch: 3	Loss: 0.254792
Client Index = 4	Epoch: 4	Loss: 0.254034
test acc on this client after 1875 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26315753023516625}
################local_test_on_all_clients after local training in communication round: 88
{'test_acc_after': 0.9273453093812375, 'test_loss_after': 0.20726406183874535}
################local_test_on_all_clients before local training in communication round: 88
{'test_acc_before': 0.8994011976047904, 'test_loss_before': 0.28194706486370746}
################Communication round : 89
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 0
local mask changes: 350.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [350.0, 2952.0, 3320.0, 3236.0, 3138.0]
Doing local aggregation!
test acc on this client before 1902 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.114625
Client Index = 0	Epoch: 1	Loss: 0.110972
Client Index = 0	Epoch: 2	Loss: 0.113402
Client Index = 0	Epoch: 3	Loss: 0.112735
Client Index = 0	Epoch: 4	Loss: 0.104597
test acc on this client after 1942 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 1
local mask changes: 344.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2986.0, 344.0, 3260.0, 3302.0, 3262.0]
Doing local aggregation!
test acc on this client before 1920 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.169875
Client Index = 1	Epoch: 1	Loss: 0.162599
Client Index = 1	Epoch: 2	Loss: 0.151118
Client Index = 1	Epoch: 3	Loss: 0.157583
Client Index = 1	Epoch: 4	Loss: 0.154157
test acc on this client after 1934 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 2
local mask changes: 344.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3308.0, 3250.0, 344.0, 3260.0, 3262.0]
Doing local aggregation!
test acc on this client before 1698 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.406023
Client Index = 2	Epoch: 1	Loss: 0.398674
Client Index = 2	Epoch: 2	Loss: 0.397673
Client Index = 2	Epoch: 3	Loss: 0.395523
Client Index = 2	Epoch: 4	Loss: 0.397967
test acc on this client after 1748 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 3
local mask changes: 346.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3262.0, 3302.0, 3254.0, 346.0, 3164.0]
Doing local aggregation!
test acc on this client before 1658 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.390263
Client Index = 3	Epoch: 1	Loss: 0.383624
Client Index = 3	Epoch: 2	Loss: 0.376197
Client Index = 3	Epoch: 3	Loss: 0.377330
Client Index = 3	Epoch: 4	Loss: 0.375475
test acc on this client after 1801 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 4
local mask changes: 354.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3158.0, 3236.0, 3240.0, 3168.0, 354.0]
Doing local aggregation!
test acc on this client before 1840 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.262648
Client Index = 4	Epoch: 1	Loss: 0.257862
Client Index = 4	Epoch: 2	Loss: 0.252550
Client Index = 4	Epoch: 3	Loss: 0.250943
Client Index = 4	Epoch: 4	Loss: 0.247850
test acc on this client after 1875 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2608905277203055}
################local_test_on_all_clients after local training in communication round: 89
{'test_acc_after': 0.9281437125748504, 'test_loss_after': 0.2071224378693306}
################local_test_on_all_clients before local training in communication round: 89
{'test_acc_before': 0.9, 'test_loss_before': 0.2807903468311428}
################Communication round : 90
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 0
local mask changes: 292.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [292.0, 2952.0, 3304.0, 3232.0, 3148.0]
Doing local aggregation!
test acc on this client before 1898 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.119780
Client Index = 0	Epoch: 1	Loss: 0.112755
Client Index = 0	Epoch: 2	Loss: 0.111144
Client Index = 0	Epoch: 3	Loss: 0.108002
Client Index = 0	Epoch: 4	Loss: 0.106350
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 1
local mask changes: 296.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2972.0, 296.0, 3268.0, 3288.0, 3254.0]
Doing local aggregation!
test acc on this client before 1916 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.166729
Client Index = 1	Epoch: 1	Loss: 0.162307
Client Index = 1	Epoch: 2	Loss: 0.158304
Client Index = 1	Epoch: 3	Loss: 0.154390
Client Index = 1	Epoch: 4	Loss: 0.152167
test acc on this client after 1928 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 2
local mask changes: 300.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3318.0, 3266.0, 300.0, 3276.0, 3260.0]
Doing local aggregation!
test acc on this client before 1718 / 2004 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.400754
Client Index = 2	Epoch: 1	Loss: 0.414739
Client Index = 2	Epoch: 2	Loss: 0.397486
Client Index = 2	Epoch: 3	Loss: 0.398957
Client Index = 2	Epoch: 4	Loss: 0.398062
test acc on this client after 1743 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 3
local mask changes: 300.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3258.0, 3322.0, 3274.0, 300.0, 3182.0]
Doing local aggregation!
test acc on this client before 1690 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.390924
Client Index = 3	Epoch: 1	Loss: 0.379974
Client Index = 3	Epoch: 2	Loss: 0.377348
Client Index = 3	Epoch: 3	Loss: 0.383213
Client Index = 3	Epoch: 4	Loss: 0.375626
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 4
local mask changes: 294.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3152.0, 3250.0, 3236.0, 3154.0, 294.0]
Doing local aggregation!
test acc on this client before 1861 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.259394
Client Index = 4	Epoch: 1	Loss: 0.253648
Client Index = 4	Epoch: 2	Loss: 0.256451
Client Index = 4	Epoch: 3	Loss: 0.250691
Client Index = 4	Epoch: 4	Loss: 0.251676
test acc on this client after 1874 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2616348550436979}
################local_test_on_all_clients after local training in communication round: 90
{'test_acc_after': 0.9260479041916166, 'test_loss_after': 0.20659920158619416}
################local_test_on_all_clients before local training in communication round: 90
{'test_acc_before': 0.9064870259481038, 'test_loss_before': 0.2722677196898384}
################Communication round : 91
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 0
local mask changes: 246.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [246.0, 2944.0, 3304.0, 3242.0, 3142.0]
Doing local aggregation!
test acc on this client before 1901 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.125643
Client Index = 0	Epoch: 1	Loss: 0.106620
Client Index = 0	Epoch: 2	Loss: 0.109265
Client Index = 0	Epoch: 3	Loss: 0.104545
Client Index = 0	Epoch: 4	Loss: 0.102472
test acc on this client after 1950 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 1
local mask changes: 238.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2934.0, 238.0, 3274.0, 3294.0, 3264.0]
Doing local aggregation!
test acc on this client before 1916 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.168732
Client Index = 1	Epoch: 1	Loss: 0.154677
Client Index = 1	Epoch: 2	Loss: 0.153129
Client Index = 1	Epoch: 3	Loss: 0.156485
Client Index = 1	Epoch: 4	Loss: 0.148296
test acc on this client after 1927 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 2
local mask changes: 240.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3278.0, 3252.0, 240.0, 3262.0, 3232.0]
Doing local aggregation!
test acc on this client before 1712 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.413298
Client Index = 2	Epoch: 1	Loss: 0.404866
Client Index = 2	Epoch: 2	Loss: 0.402110
Client Index = 2	Epoch: 3	Loss: 0.397921
Client Index = 2	Epoch: 4	Loss: 0.395851
test acc on this client after 1747 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 3
local mask changes: 250.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3230.0, 3288.0, 3286.0, 250.0, 3170.0]
Doing local aggregation!
test acc on this client before 1688 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.389179
Client Index = 3	Epoch: 1	Loss: 0.382135
Client Index = 3	Epoch: 2	Loss: 0.376760
Client Index = 3	Epoch: 3	Loss: 0.382212
Client Index = 3	Epoch: 4	Loss: 0.372891
test acc on this client after 1786 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 4
local mask changes: 244.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3140.0, 3254.0, 3232.0, 3184.0, 244.0]
Doing local aggregation!
test acc on this client before 1860 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.261450
Client Index = 4	Epoch: 1	Loss: 0.261547
Client Index = 4	Epoch: 2	Loss: 0.258134
Client Index = 4	Epoch: 3	Loss: 0.261996
Client Index = 4	Epoch: 4	Loss: 0.251367
test acc on this client after 1879 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26166313277200814}
################local_test_on_all_clients after local training in communication round: 91
{'test_acc_after': 0.9270459081836326, 'test_loss_after': 0.21202668146696874}
################local_test_on_all_clients before local training in communication round: 91
{'test_acc_before': 0.9058882235528942, 'test_loss_before': 0.2700123529412789}
################Communication round : 92
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 0
local mask changes: 198.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [198.0, 2928.0, 3284.0, 3244.0, 3130.0]
Doing local aggregation!
test acc on this client before 1900 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.122360
Client Index = 0	Epoch: 1	Loss: 0.114534
Client Index = 0	Epoch: 2	Loss: 0.110369
Client Index = 0	Epoch: 3	Loss: 0.097390
Client Index = 0	Epoch: 4	Loss: 0.103949
test acc on this client after 1950 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 1
local mask changes: 200.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2946.0, 200.0, 3244.0, 3276.0, 3244.0]
Doing local aggregation!
test acc on this client before 1923 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.173875
Client Index = 1	Epoch: 1	Loss: 0.163904
Client Index = 1	Epoch: 2	Loss: 0.155693
Client Index = 1	Epoch: 3	Loss: 0.162272
Client Index = 1	Epoch: 4	Loss: 0.155290
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 2
local mask changes: 200.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3278.0, 3254.0, 200.0, 3270.0, 3220.0]
Doing local aggregation!
test acc on this client before 1711 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.409875
Client Index = 2	Epoch: 1	Loss: 0.399566
Client Index = 2	Epoch: 2	Loss: 0.399644
Client Index = 2	Epoch: 3	Loss: 0.395139
Client Index = 2	Epoch: 4	Loss: 0.396032
test acc on this client after 1762 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 3
local mask changes: 200.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3232.0, 3288.0, 3266.0, 200.0, 3166.0]
Doing local aggregation!
test acc on this client before 1699 / 2004 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.386289
Client Index = 3	Epoch: 1	Loss: 0.381721
Client Index = 3	Epoch: 2	Loss: 0.389429
Client Index = 3	Epoch: 3	Loss: 0.380713
Client Index = 3	Epoch: 4	Loss: 0.376219
test acc on this client after 1793 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 4
local mask changes: 202.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3130.0, 3270.0, 3214.0, 3160.0, 202.0]
Doing local aggregation!
test acc on this client before 1864 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.259603
Client Index = 4	Epoch: 1	Loss: 0.256315
Client Index = 4	Epoch: 2	Loss: 0.248158
Client Index = 4	Epoch: 3	Loss: 0.253854
Client Index = 4	Epoch: 4	Loss: 0.253772
test acc on this client after 1880 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.261838604451177}
################local_test_on_all_clients after local training in communication round: 92
{'test_acc_after': 0.9296407185628743, 'test_loss_after': 0.20831092855411612}
################local_test_on_all_clients before local training in communication round: 92
{'test_acc_before': 0.9078842315369261, 'test_loss_before': 0.26828876415828984}
################Communication round : 93
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 0
local mask changes: 160.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [160.0, 2948.0, 3282.0, 3236.0, 3114.0]
Doing local aggregation!
test acc on this client before 1903 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.116959
Client Index = 0	Epoch: 1	Loss: 0.113010
Client Index = 0	Epoch: 2	Loss: 0.102695
Client Index = 0	Epoch: 3	Loss: 0.110389
Client Index = 0	Epoch: 4	Loss: 0.110673
test acc on this client after 1945 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 1
local mask changes: 158.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2944.0, 158.0, 3224.0, 3296.0, 3268.0]
Doing local aggregation!
test acc on this client before 1920 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.167341
Client Index = 1	Epoch: 1	Loss: 0.153284
Client Index = 1	Epoch: 2	Loss: 0.158913
Client Index = 1	Epoch: 3	Loss: 0.154770
Client Index = 1	Epoch: 4	Loss: 0.145440
test acc on this client after 1931 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 2
local mask changes: 158.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3300.0, 3246.0, 158.0, 3282.0, 3234.0]
Doing local aggregation!
test acc on this client before 1709 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.406126
Client Index = 2	Epoch: 1	Loss: 0.401752
Client Index = 2	Epoch: 2	Loss: 0.390843
Client Index = 2	Epoch: 3	Loss: 0.392431
Client Index = 2	Epoch: 4	Loss: 0.396050
test acc on this client after 1757 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 3
local mask changes: 158.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3258.0, 3300.0, 3290.0, 158.0, 3168.0]
Doing local aggregation!
test acc on this client before 1689 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.397539
Client Index = 3	Epoch: 1	Loss: 0.383538
Client Index = 3	Epoch: 2	Loss: 0.386324
Client Index = 3	Epoch: 3	Loss: 0.373763
Client Index = 3	Epoch: 4	Loss: 0.379872
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 4
local mask changes: 160.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3102.0, 3242.0, 3224.0, 3160.0, 160.0]
Doing local aggregation!
test acc on this client before 1846 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.261719
Client Index = 4	Epoch: 1	Loss: 0.262399
Client Index = 4	Epoch: 2	Loss: 0.255474
Client Index = 4	Epoch: 3	Loss: 0.254514
Client Index = 4	Epoch: 4	Loss: 0.243051
test acc on this client after 1872 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26075467917988904}
################local_test_on_all_clients after local training in communication round: 93
{'test_acc_after': 0.9275449101796408, 'test_loss_after': 0.20879928291795738}
################local_test_on_all_clients before local training in communication round: 93
{'test_acc_before': 0.9048902195608782, 'test_loss_before': 0.2719240092975413}
################Communication round : 94
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 0
local mask changes: 122.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [122.0, 2944.0, 3288.0, 3248.0, 3094.0]
Doing local aggregation!
test acc on this client before 1897 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.124642
Client Index = 0	Epoch: 1	Loss: 0.109461
Client Index = 0	Epoch: 2	Loss: 0.111285
Client Index = 0	Epoch: 3	Loss: 0.112370
Client Index = 0	Epoch: 4	Loss: 0.105013
test acc on this client after 1937 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 1
local mask changes: 120.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2952.0, 120.0, 3248.0, 3338.0, 3268.0]
Doing local aggregation!
test acc on this client before 1917 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.169982
Client Index = 1	Epoch: 1	Loss: 0.154217
Client Index = 1	Epoch: 2	Loss: 0.154446
Client Index = 1	Epoch: 3	Loss: 0.153432
Client Index = 1	Epoch: 4	Loss: 0.151907
test acc on this client after 1930 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 2
local mask changes: 122.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3302.0, 3240.0, 122.0, 3304.0, 3216.0]
Doing local aggregation!
test acc on this client before 1705 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.403363
Client Index = 2	Epoch: 1	Loss: 0.399059
Client Index = 2	Epoch: 2	Loss: 0.401045
Client Index = 2	Epoch: 3	Loss: 0.394260
Client Index = 2	Epoch: 4	Loss: 0.391896
test acc on this client after 1741 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 3
local mask changes: 122.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3264.0, 3324.0, 3308.0, 122.0, 3178.0]
Doing local aggregation!
test acc on this client before 1693 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.391619
Client Index = 3	Epoch: 1	Loss: 0.377668
Client Index = 3	Epoch: 2	Loss: 0.376262
Client Index = 3	Epoch: 3	Loss: 0.374726
Client Index = 3	Epoch: 4	Loss: 0.385285
test acc on this client after 1794 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 4
local mask changes: 120.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3104.0, 3252.0, 3230.0, 3162.0, 120.0]
Doing local aggregation!
test acc on this client before 1854 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.262957
Client Index = 4	Epoch: 1	Loss: 0.259396
Client Index = 4	Epoch: 2	Loss: 0.253978
Client Index = 4	Epoch: 3	Loss: 0.249428
Client Index = 4	Epoch: 4	Loss: 0.251206
test acc on this client after 1869 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26075625850482187}
################local_test_on_all_clients after local training in communication round: 94
{'test_acc_after': 0.925249500998004, 'test_loss_after': 0.21339271991716294}
################local_test_on_all_clients before local training in communication round: 94
{'test_acc_before': 0.9047904191616766, 'test_loss_before': 0.2708428189292283}
################Communication round : 95
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 0
local mask changes: 92.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [92.0, 2956.0, 3286.0, 3254.0, 3086.0]
Doing local aggregation!
test acc on this client before 1899 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.120423
Client Index = 0	Epoch: 1	Loss: 0.113539
Client Index = 0	Epoch: 2	Loss: 0.109982
Client Index = 0	Epoch: 3	Loss: 0.111730
Client Index = 0	Epoch: 4	Loss: 0.106616
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 1
local mask changes: 90.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2962.0, 90.0, 3246.0, 3330.0, 3258.0]
Doing local aggregation!
test acc on this client before 1918 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.160417
Client Index = 1	Epoch: 1	Loss: 0.159147
Client Index = 1	Epoch: 2	Loss: 0.155868
Client Index = 1	Epoch: 3	Loss: 0.153354
Client Index = 1	Epoch: 4	Loss: 0.155506
test acc on this client after 1923 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 2
local mask changes: 90.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3316.0, 3272.0, 90.0, 3328.0, 3232.0]
Doing local aggregation!
test acc on this client before 1704 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.411175
Client Index = 2	Epoch: 1	Loss: 0.409021
Client Index = 2	Epoch: 2	Loss: 0.398437
Client Index = 2	Epoch: 3	Loss: 0.395342
Client Index = 2	Epoch: 4	Loss: 0.393834
test acc on this client after 1753 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 3
local mask changes: 92.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3256.0, 3356.0, 3322.0, 92.0, 3186.0]
Doing local aggregation!
test acc on this client before 1687 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.388635
Client Index = 3	Epoch: 1	Loss: 0.379964
Client Index = 3	Epoch: 2	Loss: 0.374844
Client Index = 3	Epoch: 3	Loss: 0.374907
Client Index = 3	Epoch: 4	Loss: 0.380658
test acc on this client after 1800 / 2004 : 0.90
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 4
local mask changes: 92.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3114.0, 3292.0, 3224.0, 3182.0, 92.0]
Doing local aggregation!
test acc on this client before 1847 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.262957
Client Index = 4	Epoch: 1	Loss: 0.251463
Client Index = 4	Epoch: 2	Loss: 0.249500
Client Index = 4	Epoch: 3	Loss: 0.254541
Client Index = 4	Epoch: 4	Loss: 0.254074
test acc on this client after 1872 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2610373458757679}
################local_test_on_all_clients after local training in communication round: 95
{'test_acc_after': 0.9277445109780439, 'test_loss_after': 0.2103421678562126}
################local_test_on_all_clients before local training in communication round: 95
{'test_acc_before': 0.9036926147704591, 'test_loss_before': 0.27374323645156773}
################Communication round : 96
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 0
local mask changes: 62.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [62.0, 2962.0, 3308.0, 3250.0, 3110.0]
Doing local aggregation!
test acc on this client before 1899 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.117663
Client Index = 0	Epoch: 1	Loss: 0.103372
Client Index = 0	Epoch: 2	Loss: 0.110342
Client Index = 0	Epoch: 3	Loss: 0.105339
Client Index = 0	Epoch: 4	Loss: 0.106026
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 1
local mask changes: 64.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2966.0, 64.0, 3264.0, 3340.0, 3286.0]
Doing local aggregation!
test acc on this client before 1919 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.166790
Client Index = 1	Epoch: 1	Loss: 0.159577
Client Index = 1	Epoch: 2	Loss: 0.156420
Client Index = 1	Epoch: 3	Loss: 0.154779
Client Index = 1	Epoch: 4	Loss: 0.157298
test acc on this client after 1919 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 2
local mask changes: 64.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3312.0, 3276.0, 64.0, 3340.0, 3248.0]
Doing local aggregation!
test acc on this client before 1708 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.403103
Client Index = 2	Epoch: 1	Loss: 0.402811
Client Index = 2	Epoch: 2	Loss: 0.403302
Client Index = 2	Epoch: 3	Loss: 0.397967
Client Index = 2	Epoch: 4	Loss: 0.391230
test acc on this client after 1747 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 3
local mask changes: 64.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3252.0, 3352.0, 3332.0, 64.0, 3200.0]
Doing local aggregation!
test acc on this client before 1688 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.382911
Client Index = 3	Epoch: 1	Loss: 0.380087
Client Index = 3	Epoch: 2	Loss: 0.374926
Client Index = 3	Epoch: 3	Loss: 0.377350
Client Index = 3	Epoch: 4	Loss: 0.373825
test acc on this client after 1790 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 4
local mask changes: 64.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3110.0, 3284.0, 3242.0, 3194.0, 64.0]
Doing local aggregation!
test acc on this client before 1848 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.264324
Client Index = 4	Epoch: 1	Loss: 0.252809
Client Index = 4	Epoch: 2	Loss: 0.249668
Client Index = 4	Epoch: 3	Loss: 0.255460
Client Index = 4	Epoch: 4	Loss: 0.254750
test acc on this client after 1878 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.26008520123330836}
################local_test_on_all_clients after local training in communication round: 96
{'test_acc_after': 0.9259481037924152, 'test_loss_after': 0.21113264345956181}
################local_test_on_all_clients before local training in communication round: 96
{'test_acc_before': 0.9043912175648703, 'test_loss_before': 0.2753833281660746}
################Communication round : 97
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 0
local mask changes: 40.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [40.0, 2972.0, 3324.0, 3262.0, 3126.0]
Doing local aggregation!
test acc on this client before 1906 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.120326
Client Index = 0	Epoch: 1	Loss: 0.116047
Client Index = 0	Epoch: 2	Loss: 0.104827
Client Index = 0	Epoch: 3	Loss: 0.108336
Client Index = 0	Epoch: 4	Loss: 0.105634
test acc on this client after 1948 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 1
local mask changes: 40.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2974.0, 40.0, 3276.0, 3362.0, 3298.0]
Doing local aggregation!
test acc on this client before 1920 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.171037
Client Index = 1	Epoch: 1	Loss: 0.157690
Client Index = 1	Epoch: 2	Loss: 0.153243
Client Index = 1	Epoch: 3	Loss: 0.157350
Client Index = 1	Epoch: 4	Loss: 0.152796
test acc on this client after 1926 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 2
local mask changes: 40.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3322.0, 3278.0, 40.0, 3344.0, 3254.0]
Doing local aggregation!
test acc on this client before 1707 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.399321
Client Index = 2	Epoch: 1	Loss: 0.403759
Client Index = 2	Epoch: 2	Loss: 0.401248
Client Index = 2	Epoch: 3	Loss: 0.398190
Client Index = 2	Epoch: 4	Loss: 0.394810
test acc on this client after 1746 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 3
local mask changes: 40.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3258.0, 3352.0, 3338.0, 40.0, 3204.0]
Doing local aggregation!
test acc on this client before 1690 / 2004 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.389778
Client Index = 3	Epoch: 1	Loss: 0.383328
Client Index = 3	Epoch: 2	Loss: 0.378065
Client Index = 3	Epoch: 3	Loss: 0.380270
Client Index = 3	Epoch: 4	Loss: 0.376058
test acc on this client after 1789 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 4
local mask changes: 40.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3118.0, 3280.0, 3250.0, 3202.0, 40.0]
Doing local aggregation!
test acc on this client before 1851 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.257686
Client Index = 4	Epoch: 1	Loss: 0.256460
Client Index = 4	Epoch: 2	Loss: 0.254208
Client Index = 4	Epoch: 3	Loss: 0.251485
Client Index = 4	Epoch: 4	Loss: 0.247684
test acc on this client after 1881 / 2004 : 0.94
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2607853372482226}
################local_test_on_all_clients after local training in communication round: 97
{'test_acc_after': 0.9271457085828343, 'test_loss_after': 0.21012430720165104}
################local_test_on_all_clients before local training in communication round: 97
{'test_acc_before': 0.9055888223552895, 'test_loss_before': 0.26829937777357427}
################Communication round : 98
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 0
local mask changes: 26.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [26.0, 2992.0, 3340.0, 3276.0, 3140.0]
Doing local aggregation!
test acc on this client before 1894 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.123588
Client Index = 0	Epoch: 1	Loss: 0.110037
Client Index = 0	Epoch: 2	Loss: 0.110851
Client Index = 0	Epoch: 3	Loss: 0.104743
Client Index = 0	Epoch: 4	Loss: 0.106924
test acc on this client after 1950 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 1
local mask changes: 26.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2976.0, 26.0, 3284.0, 3370.0, 3298.0]
Doing local aggregation!
test acc on this client before 1919 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.165568
Client Index = 1	Epoch: 1	Loss: 0.158367
Client Index = 1	Epoch: 2	Loss: 0.158301
Client Index = 1	Epoch: 3	Loss: 0.155614
Client Index = 1	Epoch: 4	Loss: 0.152377
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 2
local mask changes: 26.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3340.0, 3288.0, 26.0, 3350.0, 3258.0]
Doing local aggregation!
test acc on this client before 1704 / 2004 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.411841
Client Index = 2	Epoch: 1	Loss: 0.394246
Client Index = 2	Epoch: 2	Loss: 0.405707
Client Index = 2	Epoch: 3	Loss: 0.394694
Client Index = 2	Epoch: 4	Loss: 0.395884
test acc on this client after 1749 / 2004 : 0.87
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 3
local mask changes: 26.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3276.0, 3366.0, 3342.0, 26.0, 3208.0]
Doing local aggregation!
test acc on this client before 1673 / 2004 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.393908
Client Index = 3	Epoch: 1	Loss: 0.374620
Client Index = 3	Epoch: 2	Loss: 0.378044
Client Index = 3	Epoch: 3	Loss: 0.375742
Client Index = 3	Epoch: 4	Loss: 0.371858
test acc on this client after 1792 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 4
local mask changes: 26.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3134.0, 3298.0, 3262.0, 3206.0, 26.0]
Doing local aggregation!
test acc on this client before 1837 / 2004 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.258165
Client Index = 4	Epoch: 1	Loss: 0.253210
Client Index = 4	Epoch: 2	Loss: 0.255814
Client Index = 4	Epoch: 3	Loss: 0.254837
Client Index = 4	Epoch: 4	Loss: 0.252431
test acc on this client after 1871 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.2606948705187978}
################local_test_on_all_clients after local training in communication round: 98
{'test_acc_after': 0.9267465069860279, 'test_loss_after': 0.20822219287682914}
################local_test_on_all_clients before local training in communication round: 98
{'test_acc_before': 0.9008982035928144, 'test_loss_before': 0.27785117758248384}
################Communication round : 99
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 0
local mask changes: 12.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [12.0, 2988.0, 3342.0, 3284.0, 3146.0]
Doing local aggregation!
test acc on this client before 1903 / 2004 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.125170
Client Index = 0	Epoch: 1	Loss: 0.106067
Client Index = 0	Epoch: 2	Loss: 0.108451
Client Index = 0	Epoch: 3	Loss: 0.103485
Client Index = 0	Epoch: 4	Loss: 0.101121
test acc on this client after 1944 / 2004 : 0.97
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 1
local mask changes: 12.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2984.0, 12.0, 3286.0, 3368.0, 3308.0]
Doing local aggregation!
test acc on this client before 1919 / 2004 : 0.96
Client Index = 1	Epoch: 0	Loss: 0.167260
Client Index = 1	Epoch: 1	Loss: 0.160543
Client Index = 1	Epoch: 2	Loss: 0.151818
Client Index = 1	Epoch: 3	Loss: 0.155394
Client Index = 1	Epoch: 4	Loss: 0.154834
test acc on this client after 1924 / 2004 : 0.96
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 2
local mask changes: 12.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3342.0, 3288.0, 12.0, 3344.0, 3266.0]
Doing local aggregation!
test acc on this client before 1720 / 2004 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.411067
Client Index = 2	Epoch: 1	Loss: 0.398333
Client Index = 2	Epoch: 2	Loss: 0.402924
Client Index = 2	Epoch: 3	Loss: 0.395445
Client Index = 2	Epoch: 4	Loss: 0.392915
test acc on this client after 1756 / 2004 : 0.88
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 3
local mask changes: 12.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3284.0, 3372.0, 3348.0, 12.0, 3208.0]
Doing local aggregation!
test acc on this client before 1718 / 2004 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.390917
Client Index = 3	Epoch: 1	Loss: 0.374405
Client Index = 3	Epoch: 2	Loss: 0.375489
Client Index = 3	Epoch: 3	Loss: 0.374286
Client Index = 3	Epoch: 4	Loss: 0.377087
test acc on this client after 1779 / 2004 : 0.89
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 4
local mask changes: 12.0 / 21840
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3148.0, 3308.0, 3268.0, 3214.0, 12.0]
Doing local aggregation!
test acc on this client before 1863 / 2004 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.256017
Client Index = 4	Epoch: 1	Loss: 0.250550
Client Index = 4	Epoch: 2	Loss: 0.256382
Client Index = 4	Epoch: 3	Loss: 0.254034
Client Index = 4	Epoch: 4	Loss: 0.247201
test acc on this client after 1870 / 2004 : 0.93
-----------------------------------
training flops per data 1320348.0
full flops for search 2904300
{'training_loss': 0.25964785242334326}
################local_test_on_all_clients after local training in communication round: 99
{'test_acc_after': 0.925449101796407, 'test_loss_after': 0.21076999620316986}
################local_test_on_all_clients before local training in communication round: 99
{'test_acc_before': 0.9104790419161677, 'test_loss_before': 0.26077434923537}
