Namespace(active=1.0, anneal_factor=0.5, batch_size=128, ci=0, client_num_in_total=5, client_num_per_round=5, client_optimizer='sgd', comm_round=100, cs='random', data_dir='/Date/FL/DisPFL-master/data/', dataset='cifar100', dense_ratio=0.5, diff_spa=False, different_initial=True, dis_gradient_check=True, epochs=5, erk_power_scale=1, frac=1.0, frequency_of_the_test=1, global_test=False, gpu=0, identity='DisPFL-cifar100-dir0.3-mdlresnet18-csrandom-ERK_init-diff_init-DST-cm100-total_clnt5-neighbor5-dr0.5-active1.0-seed1118', lr=0.1, lr_decay=0.998, model='resnet18', momentum=0, partition_alpha=0.3, partition_method='dir', public_portion=0, record_mask_diff=False, save_masks=False, seed=1118, static=False, strict_avg=False, tag='test', uniform=False, wd=0.0005)
cuda:0
*********partition data***************
train_num25000  test_num2050
client_idx = 0, local_sample_number = 25000
train_num25000  test_num2045
client_idx = 1, local_sample_number = 25000
train_num25000  test_num2051
client_idx = 2, local_sample_number = 25000
train_num25000  test_num2049
client_idx = 3, local_sample_number = 25000
train_num25000  test_num2051
client_idx = 4, local_sample_number = 25000
DATA Partition: Train [277, 247, 253, 234, 269, 252, 248, 244, 235, 245, 234, 250, 265, 226, 264, 253, 239, 246, 264, 249, 251, 241, 243, 252, 248, 245, 242, 249, 248, 271, 256, 261, 229, 254, 256, 249, 256, 242, 267, 253, 238, 236, 249, 266, 251, 266, 261, 268, 256, 239, 254, 240, 245, 243, 239, 238, 244, 255, 260, 246, 249, 246, 277, 249, 260, 260, 239, 255, 258, 262, 248, 248, 251, 244, 265, 258, 257, 232, 251, 252, 250, 248, 246, 259, 242, 244, 253, 211, 257, 254, 247, 238, 258, 250, 254, 255, 244, 258, 232, 238]; Test [23, 20, 21, 19, 22, 21, 20, 20, 19, 20, 19, 20, 22, 19, 22, 21, 20, 20, 22, 20, 21, 20, 20, 21, 20, 20, 20, 20, 20, 22, 21, 21, 19, 21, 21, 20, 21, 20, 22, 21, 20, 19, 20, 22, 21, 22, 21, 22, 21, 20, 21, 20, 20, 20, 20, 20, 20, 21, 21, 20, 20, 20, 23, 20, 21, 21, 20, 21, 21, 21, 20, 20, 21, 20, 22, 21, 21, 19, 21, 21, 20, 20, 20, 21, 20, 20, 21, 17, 21, 21, 20, 20, 21, 20, 21, 21, 20, 21, 19, 20]
DATA Partition: Train [267, 244, 254, 237, 242, 248, 240, 243, 263, 243, 251, 251, 268, 276, 236, 247, 258, 250, 255, 250, 248, 232, 243, 237, 233, 249, 259, 246, 233, 247, 253, 248, 245, 244, 234, 261, 240, 250, 259, 259, 240, 242, 244, 249, 255, 254, 262, 259, 253, 242, 254, 249, 249, 266, 274, 242, 256, 236, 256, 260, 269, 260, 256, 249, 248, 255, 256, 235, 263, 250, 242, 235, 254, 255, 255, 259, 242, 247, 264, 260, 251, 242, 244, 249, 241, 241, 246, 268, 257, 241, 241, 239, 256, 236, 254, 257, 252, 240, 247, 259]; Test [22, 20, 21, 19, 20, 20, 20, 20, 22, 20, 21, 21, 22, 23, 19, 20, 21, 20, 21, 20, 20, 19, 20, 19, 19, 20, 21, 20, 19, 20, 21, 20, 20, 20, 19, 21, 20, 20, 21, 21, 20, 20, 20, 20, 21, 21, 21, 21, 21, 20, 21, 20, 20, 22, 22, 20, 21, 19, 21, 21, 22, 21, 21, 20, 20, 21, 21, 19, 22, 20, 20, 19, 21, 21, 21, 21, 20, 20, 22, 21, 21, 20, 20, 20, 20, 20, 20, 22, 21, 20, 20, 20, 21, 19, 21, 21, 21, 20, 20, 21]
DATA Partition: Train [260, 253, 253, 233, 261, 253, 249, 245, 242, 238, 250, 258, 242, 258, 277, 265, 238, 255, 248, 254, 267, 256, 261, 232, 260, 247, 242, 255, 266, 231, 238, 282, 237, 253, 249, 257, 253, 236, 244, 262, 242, 242, 230, 259, 243, 267, 269, 247, 240, 268, 234, 255, 272, 243, 226, 238, 250, 272, 257, 249, 253, 259, 261, 257, 256, 233, 240, 251, 267, 255, 265, 229, 255, 249, 233, 228, 257, 263, 243, 247, 242, 273, 251, 228, 247, 248, 238, 259, 258, 244, 244, 252, 228, 244, 252, 253, 234, 257, 254, 230]; Test [21, 21, 21, 19, 21, 21, 20, 20, 20, 20, 20, 21, 20, 21, 23, 22, 20, 21, 20, 21, 22, 21, 21, 19, 21, 20, 20, 21, 22, 19, 20, 23, 19, 21, 20, 21, 21, 19, 20, 21, 20, 20, 19, 21, 20, 22, 22, 20, 20, 22, 19, 21, 22, 20, 19, 20, 20, 22, 21, 20, 21, 21, 21, 21, 21, 19, 20, 21, 22, 21, 22, 19, 21, 20, 19, 19, 21, 22, 20, 20, 20, 22, 21, 19, 20, 20, 20, 21, 21, 20, 20, 21, 19, 20, 21, 21, 19, 21, 21, 19]
DATA Partition: Train [257, 243, 229, 252, 242, 271, 241, 263, 241, 252, 247, 259, 259, 244, 235, 245, 257, 236, 256, 236, 256, 264, 259, 269, 259, 252, 234, 261, 256, 246, 259, 225, 252, 245, 268, 265, 234, 260, 237, 255, 243, 238, 241, 261, 249, 259, 246, 236, 242, 255, 224, 264, 252, 241, 240, 245, 249, 259, 249, 262, 267, 270, 252, 260, 256, 226, 236, 246, 254, 254, 269, 222, 252, 245, 270, 223, 253, 258, 251, 244, 231, 245, 253, 245, 253, 270, 253, 239, 238, 257, 268, 239, 271, 231, 244, 259, 248, 251, 267, 254]; Test [21, 20, 19, 21, 20, 22, 20, 22, 20, 21, 20, 21, 21, 20, 19, 20, 21, 19, 21, 19, 21, 22, 21, 22, 21, 21, 19, 21, 21, 20, 21, 18, 21, 20, 22, 22, 19, 21, 19, 21, 20, 20, 20, 21, 20, 21, 20, 19, 20, 21, 18, 22, 21, 20, 20, 20, 20, 21, 20, 21, 22, 22, 21, 21, 21, 19, 19, 20, 21, 21, 22, 18, 21, 20, 22, 18, 21, 21, 21, 20, 19, 20, 21, 20, 21, 22, 21, 20, 20, 21, 22, 20, 22, 19, 20, 21, 20, 21, 22, 21]
DATA Partition: Train [253, 261, 238, 234, 277, 244, 258, 250, 245, 236, 251, 251, 245, 252, 246, 244, 244, 251, 236, 247, 242, 261, 251, 253, 263, 253, 254, 238, 261, 239, 251, 251, 253, 233, 269, 241, 250, 276, 273, 271, 234, 247, 279, 244, 212, 252, 254, 252, 243, 237, 257, 261, 240, 262, 251, 262, 265, 224, 219, 257, 255, 257, 254, 252, 244, 240, 234, 245, 239, 247, 244, 247, 250, 251, 257, 248, 248, 259, 282, 250, 257, 245, 227, 256, 233, 263, 263, 262, 238, 263, 263, 244, 232, 244, 249, 256, 251, 256, 247, 250]; Test [21, 21, 20, 19, 23, 20, 21, 20, 20, 19, 21, 21, 20, 21, 20, 20, 20, 21, 19, 20, 20, 21, 21, 21, 22, 21, 21, 20, 21, 20, 21, 21, 21, 19, 22, 20, 20, 23, 22, 22, 19, 20, 23, 20, 17, 21, 21, 21, 20, 19, 21, 21, 20, 21, 21, 21, 22, 18, 18, 21, 21, 21, 21, 21, 20, 20, 19, 20, 20, 20, 20, 20, 20, 21, 21, 20, 20, 21, 23, 20, 21, 20, 19, 21, 19, 22, 22, 21, 20, 22, 22, 20, 19, 20, 20, 21, 21, 21, 20, 20]
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 128, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 256, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 512, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=100, bias=True)
)
############setup_clients (START)#############
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
############setup_clients (END)#############
initialize by ERK
################Communication round : 0
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 0
local mask changes: 0.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [0.0, 4550344.0, 4552330.0, 4549080.0, 4549430.0]
Doing local aggregation!
test acc on this client before 26 / 2050 : 0.01
Client Index = 0	Epoch: 0	Loss: 4.571741
Client Index = 0	Epoch: 1	Loss: 4.262349
Client Index = 0	Epoch: 2	Loss: 4.068590
Client Index = 0	Epoch: 3	Loss: 3.944855
Client Index = 0	Epoch: 4	Loss: 3.834684
test acc on this client after 127 / 2050 : 0.06
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 1
local mask changes: 0.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4550344.0, 0.0, 4550446.0, 4552402.0, 4550314.0]
Doing local aggregation!
test acc on this client before 20 / 2045 : 0.01
Client Index = 1	Epoch: 0	Loss: 4.567645
Client Index = 1	Epoch: 1	Loss: 4.258515
Client Index = 1	Epoch: 2	Loss: 4.052867
Client Index = 1	Epoch: 3	Loss: 3.913257
Client Index = 1	Epoch: 4	Loss: 3.806173
test acc on this client after 169 / 2045 : 0.08
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 2
local mask changes: 0.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4552330.0, 4550446.0, 0.0, 4549810.0, 4549710.0]
Doing local aggregation!
test acc on this client before 16 / 2051 : 0.01
Client Index = 2	Epoch: 0	Loss: 4.552942
Client Index = 2	Epoch: 1	Loss: 4.239168
Client Index = 2	Epoch: 2	Loss: 4.053154
Client Index = 2	Epoch: 3	Loss: 3.930344
Client Index = 2	Epoch: 4	Loss: 3.815757
test acc on this client after 142 / 2051 : 0.07
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 3
local mask changes: 0.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4549080.0, 4552402.0, 4549810.0, 0.0, 4551860.0]
Doing local aggregation!
test acc on this client before 18 / 2049 : 0.01
Client Index = 3	Epoch: 0	Loss: 4.544354
Client Index = 3	Epoch: 1	Loss: 4.250290
Client Index = 3	Epoch: 2	Loss: 4.060532
Client Index = 3	Epoch: 3	Loss: 3.918612
Client Index = 3	Epoch: 4	Loss: 3.808857
test acc on this client after 186 / 2049 : 0.09
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 4
local mask changes: 0.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4549430.0, 4550314.0, 4549710.0, 4551860.0, 0.0]
Doing local aggregation!
test acc on this client before 23 / 2051 : 0.01
Client Index = 4	Epoch: 0	Loss: 4.563756
Client Index = 4	Epoch: 1	Loss: 4.251832
Client Index = 4	Epoch: 2	Loss: 4.047114
Client Index = 4	Epoch: 3	Loss: 3.923103
Client Index = 4	Epoch: 4	Loss: 3.837831
test acc on this client after 159 / 2051 : 0.08
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 4.123132780668687}
################local_test_on_all_clients after local training in communication round: 0
{'test_acc_after': 0.07642509475542356, 'test_loss_after': 4.022961853538893}
################local_test_on_all_clients before local training in communication round: 0
{'test_acc_before': 0.010052553113559317, 'test_loss_before': 4.774440810841336}
################Communication round : 1
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 0
local mask changes: 2935950.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2935950.0, 4551156.0, 4550626.0, 4552380.0, 4549674.0]
Doing local aggregation!
test acc on this client before 131 / 2050 : 0.06
Client Index = 0	Epoch: 0	Loss: 3.918274
Client Index = 0	Epoch: 1	Loss: 3.730351
Client Index = 0	Epoch: 2	Loss: 3.596327
Client Index = 0	Epoch: 3	Loss: 3.492365
Client Index = 0	Epoch: 4	Loss: 3.403695
test acc on this client after 354 / 2050 : 0.17
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 1
local mask changes: 2935126.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4552692.0, 2935126.0, 4551300.0, 4552576.0, 4552502.0]
Doing local aggregation!
test acc on this client before 105 / 2045 : 0.05
Client Index = 1	Epoch: 0	Loss: 3.888833
Client Index = 1	Epoch: 1	Loss: 3.717725
Client Index = 1	Epoch: 2	Loss: 3.595389
Client Index = 1	Epoch: 3	Loss: 3.491651
Client Index = 1	Epoch: 4	Loss: 3.392733
test acc on this client after 324 / 2045 : 0.16
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 2
local mask changes: 2936860.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4552540.0, 4550456.0, 2936860.0, 4552516.0, 4547144.0]
Doing local aggregation!
test acc on this client before 94 / 2051 : 0.05
Client Index = 2	Epoch: 0	Loss: 3.912107
Client Index = 2	Epoch: 1	Loss: 3.714115
Client Index = 2	Epoch: 2	Loss: 3.595895
Client Index = 2	Epoch: 3	Loss: 3.486390
Client Index = 2	Epoch: 4	Loss: 3.390169
test acc on this client after 249 / 2051 : 0.12
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 3
local mask changes: 2933454.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4549430.0, 4552584.0, 4551616.0, 2933454.0, 4552016.0]
Doing local aggregation!
test acc on this client before 130 / 2049 : 0.06
Client Index = 3	Epoch: 0	Loss: 3.925250
Client Index = 3	Epoch: 1	Loss: 3.735710
Client Index = 3	Epoch: 2	Loss: 3.605300
Client Index = 3	Epoch: 3	Loss: 3.494360
Client Index = 3	Epoch: 4	Loss: 3.408345
test acc on this client after 265 / 2049 : 0.13
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 4
local mask changes: 2934060.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4553014.0, 4551744.0, 4549128.0, 4552446.0, 2934060.0]
Doing local aggregation!
test acc on this client before 97 / 2051 : 0.05
Client Index = 4	Epoch: 0	Loss: 3.917146
Client Index = 4	Epoch: 1	Loss: 3.734029
Client Index = 4	Epoch: 2	Loss: 3.608541
Client Index = 4	Epoch: 3	Loss: 3.507341
Client Index = 4	Epoch: 4	Loss: 3.411544
test acc on this client after 253 / 2051 : 0.12
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 3.6269434374692495}
################local_test_on_all_clients after local training in communication round: 1
{'test_acc_after': 0.14104163402594794, 'test_loss_after': 3.685637536228249}
################local_test_on_all_clients before local training in communication round: 1
{'test_acc_before': 0.05436361404827935, 'test_loss_before': 4.131172227193549}
################Communication round : 2
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 0
local mask changes: 2934530.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2934530.0, 4159652.0, 4160766.0, 4162454.0, 4160268.0]
Doing local aggregation!
test acc on this client before 386 / 2050 : 0.19
Client Index = 0	Epoch: 0	Loss: 3.411102
Client Index = 0	Epoch: 1	Loss: 3.305421
Client Index = 0	Epoch: 2	Loss: 3.203622
Client Index = 0	Epoch: 3	Loss: 3.114169
Client Index = 0	Epoch: 4	Loss: 3.049540
test acc on this client after 366 / 2050 : 0.18
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 1
local mask changes: 2936668.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4163062.0, 2936668.0, 4161858.0, 4162756.0, 4161326.0]
Doing local aggregation!
test acc on this client before 367 / 2045 : 0.18
Client Index = 1	Epoch: 0	Loss: 3.409431
Client Index = 1	Epoch: 1	Loss: 3.281278
Client Index = 1	Epoch: 2	Loss: 3.187812
Client Index = 1	Epoch: 3	Loss: 3.109991
Client Index = 1	Epoch: 4	Loss: 3.046991
test acc on this client after 388 / 2045 : 0.19
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 2
local mask changes: 2934918.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4162678.0, 4162284.0, 2934918.0, 4164266.0, 4162214.0]
Doing local aggregation!
test acc on this client before 371 / 2051 : 0.18
Client Index = 2	Epoch: 0	Loss: 3.403694
Client Index = 2	Epoch: 1	Loss: 3.280523
Client Index = 2	Epoch: 2	Loss: 3.198641
Client Index = 2	Epoch: 3	Loss: 3.100223
Client Index = 2	Epoch: 4	Loss: 3.036341
test acc on this client after 269 / 2051 : 0.13
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 3
local mask changes: 2934908.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4162374.0, 4160850.0, 4164230.0, 2934908.0, 4160828.0]
Doing local aggregation!
test acc on this client before 357 / 2049 : 0.17
Client Index = 3	Epoch: 0	Loss: 3.418532
Client Index = 3	Epoch: 1	Loss: 3.281833
Client Index = 3	Epoch: 2	Loss: 3.206091
Client Index = 3	Epoch: 3	Loss: 3.139378
Client Index = 3	Epoch: 4	Loss: 3.027880
test acc on this client after 353 / 2049 : 0.17
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 4
local mask changes: 2934940.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4165096.0, 4162140.0, 4163184.0, 4162084.0, 2934940.0]
Doing local aggregation!
test acc on this client before 362 / 2051 : 0.18
Client Index = 4	Epoch: 0	Loss: 3.421850
Client Index = 4	Epoch: 1	Loss: 3.298367
Client Index = 4	Epoch: 2	Loss: 3.202737
Client Index = 4	Epoch: 3	Loss: 3.125271
Client Index = 4	Epoch: 4	Loss: 3.039242
test acc on this client after 229 / 2051 : 0.11
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 3.211998369645099}
################local_test_on_all_clients after local training in communication round: 2
{'test_acc_after': 0.15667103668596455, 'test_loss_after': 3.602668361235505}
################local_test_on_all_clients before local training in communication round: 2
{'test_acc_before': 0.17987455172733088, 'test_loss_before': 3.438161121754174}
################Communication round : 3
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 0
local mask changes: 2933362.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2933362.0, 3957466.0, 3960062.0, 3960098.0, 3960128.0]
Doing local aggregation!
test acc on this client before 481 / 2050 : 0.23
Client Index = 0	Epoch: 0	Loss: 3.014222
Client Index = 0	Epoch: 1	Loss: 2.941772
Client Index = 0	Epoch: 2	Loss: 2.857625
Client Index = 0	Epoch: 3	Loss: 2.793490
Client Index = 0	Epoch: 4	Loss: 2.755908
test acc on this client after 492 / 2050 : 0.24
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 1
local mask changes: 2934198.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3955630.0, 2934198.0, 3958608.0, 3960058.0, 3960336.0]
Doing local aggregation!
test acc on this client before 474 / 2045 : 0.23
Client Index = 1	Epoch: 0	Loss: 2.992769
Client Index = 1	Epoch: 1	Loss: 2.937284
Client Index = 1	Epoch: 2	Loss: 2.857658
Client Index = 1	Epoch: 3	Loss: 2.790776
Client Index = 1	Epoch: 4	Loss: 2.747830
test acc on this client after 424 / 2045 : 0.21
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 2
local mask changes: 2932904.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3960456.0, 3960792.0, 2932904.0, 3962196.0, 3961816.0]
Doing local aggregation!
test acc on this client before 486 / 2051 : 0.24
Client Index = 2	Epoch: 0	Loss: 2.988751
Client Index = 2	Epoch: 1	Loss: 2.914780
Client Index = 2	Epoch: 2	Loss: 2.846814
Client Index = 2	Epoch: 3	Loss: 2.804883
Client Index = 2	Epoch: 4	Loss: 2.728958
test acc on this client after 392 / 2051 : 0.19
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 3
local mask changes: 2932802.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3958654.0, 3957978.0, 3959636.0, 2932802.0, 3960896.0]
Doing local aggregation!
test acc on this client before 499 / 2049 : 0.24
Client Index = 3	Epoch: 0	Loss: 2.998634
Client Index = 3	Epoch: 1	Loss: 2.938749
Client Index = 3	Epoch: 2	Loss: 2.862185
Client Index = 3	Epoch: 3	Loss: 2.811198
Client Index = 3	Epoch: 4	Loss: 2.734241
test acc on this client after 422 / 2049 : 0.21
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 4
local mask changes: 2932678.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3960112.0, 3959058.0, 3957324.0, 3957198.0, 2932678.0]
Doing local aggregation!
test acc on this client before 492 / 2051 : 0.24
Client Index = 4	Epoch: 0	Loss: 3.003202
Client Index = 4	Epoch: 1	Loss: 2.936581
Client Index = 4	Epoch: 2	Loss: 2.862162
Client Index = 4	Epoch: 3	Loss: 2.829613
Client Index = 4	Epoch: 4	Loss: 2.768331
test acc on this client after 391 / 2051 : 0.19
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 2.8687366789214463}
################local_test_on_all_clients after local training in communication round: 3
{'test_acc_after': 0.20701081599491727, 'test_loss_after': 3.3644533516266693}
################local_test_on_all_clients before local training in communication round: 3
{'test_acc_before': 0.2373585967873896, 'test_loss_before': 3.1040614544820193}
################Communication round : 4
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 0
local mask changes: 2930054.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2930054.0, 3804048.0, 3806096.0, 3808404.0, 3805712.0]
Doing local aggregation!
test acc on this client before 601 / 2050 : 0.29
Client Index = 0	Epoch: 0	Loss: 2.686534
Client Index = 0	Epoch: 1	Loss: 2.648168
Client Index = 0	Epoch: 2	Loss: 2.589181
Client Index = 0	Epoch: 3	Loss: 2.546219
Client Index = 0	Epoch: 4	Loss: 2.486678
test acc on this client after 481 / 2050 : 0.23
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 1
local mask changes: 2930270.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3802748.0, 2930270.0, 3804616.0, 3807350.0, 3807574.0]
Doing local aggregation!
test acc on this client before 582 / 2045 : 0.28
Client Index = 1	Epoch: 0	Loss: 2.679628
Client Index = 1	Epoch: 1	Loss: 2.639596
Client Index = 1	Epoch: 2	Loss: 2.566631
Client Index = 1	Epoch: 3	Loss: 2.531736
Client Index = 1	Epoch: 4	Loss: 2.473738
test acc on this client after 445 / 2045 : 0.22
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 2
local mask changes: 2931578.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3807424.0, 3806114.0, 2931578.0, 3808360.0, 3804190.0]
Doing local aggregation!
test acc on this client before 587 / 2051 : 0.29
Client Index = 2	Epoch: 0	Loss: 2.672556
Client Index = 2	Epoch: 1	Loss: 2.626708
Client Index = 2	Epoch: 2	Loss: 2.563193
Client Index = 2	Epoch: 3	Loss: 2.519474
Client Index = 2	Epoch: 4	Loss: 2.468921
test acc on this client after 527 / 2051 : 0.26
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 3
local mask changes: 2927624.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3805218.0, 3806558.0, 3807120.0, 2927624.0, 3802896.0]
Doing local aggregation!
test acc on this client before 581 / 2049 : 0.28
Client Index = 3	Epoch: 0	Loss: 2.695202
Client Index = 3	Epoch: 1	Loss: 2.632053
Client Index = 3	Epoch: 2	Loss: 2.589268
Client Index = 3	Epoch: 3	Loss: 2.526397
Client Index = 3	Epoch: 4	Loss: 2.479381
test acc on this client after 537 / 2049 : 0.26
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 4
local mask changes: 2931320.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3806934.0, 3804570.0, 3804918.0, 3806222.0, 2931320.0]
Doing local aggregation!
test acc on this client before 592 / 2051 : 0.29
Client Index = 4	Epoch: 0	Loss: 2.697698
Client Index = 4	Epoch: 1	Loss: 2.632326
Client Index = 4	Epoch: 2	Loss: 2.607626
Client Index = 4	Epoch: 3	Loss: 2.540742
Client Index = 4	Epoch: 4	Loss: 2.509934
test acc on this client after 508 / 2051 : 0.25
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 2.5843835074074417}
################local_test_on_all_clients after local training in communication round: 4
{'test_acc_after': 0.24378980163277805, 'test_loss_after': 3.1304946057034124}
################local_test_on_all_clients before local training in communication round: 4
{'test_acc_before': 0.2872323604192228, 'test_loss_before': 2.8543805605097914}
################Communication round : 5
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 0
local mask changes: 2925530.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2925530.0, 3683808.0, 3683364.0, 3682704.0, 3682162.0]
Doing local aggregation!
test acc on this client before 680 / 2050 : 0.33
Client Index = 0	Epoch: 0	Loss: 2.429622
Client Index = 0	Epoch: 1	Loss: 2.385933
Client Index = 0	Epoch: 2	Loss: 2.328428
Client Index = 0	Epoch: 3	Loss: 2.291964
Client Index = 0	Epoch: 4	Loss: 2.242935
test acc on this client after 537 / 2050 : 0.26
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 1
local mask changes: 2926604.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3681982.0, 2926604.0, 3683978.0, 3682614.0, 3684238.0]
Doing local aggregation!
test acc on this client before 686 / 2045 : 0.34
Client Index = 1	Epoch: 0	Loss: 2.421553
Client Index = 1	Epoch: 1	Loss: 2.376641
Client Index = 1	Epoch: 2	Loss: 2.336926
Client Index = 1	Epoch: 3	Loss: 2.280691
Client Index = 1	Epoch: 4	Loss: 2.237287
test acc on this client after 491 / 2045 : 0.24
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 2
local mask changes: 2926486.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3683532.0, 3683444.0, 2926486.0, 3681214.0, 3683176.0]
Doing local aggregation!
test acc on this client before 695 / 2051 : 0.34
Client Index = 2	Epoch: 0	Loss: 2.404303
Client Index = 2	Epoch: 1	Loss: 2.373238
Client Index = 2	Epoch: 2	Loss: 2.318832
Client Index = 2	Epoch: 3	Loss: 2.262705
Client Index = 2	Epoch: 4	Loss: 2.217561
test acc on this client after 678 / 2051 : 0.33
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 3
local mask changes: 2925694.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3682042.0, 3682912.0, 3680414.0, 2925694.0, 3683654.0]
Doing local aggregation!
test acc on this client before 685 / 2049 : 0.33
Client Index = 3	Epoch: 0	Loss: 2.408607
Client Index = 3	Epoch: 1	Loss: 2.385669
Client Index = 3	Epoch: 2	Loss: 2.330898
Client Index = 3	Epoch: 3	Loss: 2.282610
Client Index = 3	Epoch: 4	Loss: 2.228064
test acc on this client after 576 / 2049 : 0.28
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 4
local mask changes: 2926588.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3682268.0, 3683762.0, 3683392.0, 3681232.0, 2926588.0]
Doing local aggregation!
test acc on this client before 681 / 2051 : 0.33
Client Index = 4	Epoch: 0	Loss: 2.436460
Client Index = 4	Epoch: 1	Loss: 2.376818
Client Index = 4	Epoch: 2	Loss: 2.345938
Client Index = 4	Epoch: 3	Loss: 2.286515
Client Index = 4	Epoch: 4	Loss: 2.245676
test acc on this client after 472 / 2051 : 0.23
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 2.329434951616794}
################local_test_on_all_clients after local training in communication round: 5
{'test_acc_after': 0.2687727706964817, 'test_loss_after': 3.021407615969456}
################local_test_on_all_clients before local training in communication round: 5
{'test_acc_before': 0.3344722613449012, 'test_loss_before': 2.6059108888653832}
################Communication round : 6
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 0
local mask changes: 2921566.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2921566.0, 3589862.0, 3589666.0, 3588824.0, 3589470.0]
Doing local aggregation!
test acc on this client before 788 / 2050 : 0.38
Client Index = 0	Epoch: 0	Loss: 2.181589
Client Index = 0	Epoch: 1	Loss: 2.155935
Client Index = 0	Epoch: 2	Loss: 2.104061
Client Index = 0	Epoch: 3	Loss: 2.058544
Client Index = 0	Epoch: 4	Loss: 2.029797
test acc on this client after 714 / 2050 : 0.35
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 1
local mask changes: 2921922.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3590830.0, 2921922.0, 3589376.0, 3589602.0, 3591458.0]
Doing local aggregation!
test acc on this client before 772 / 2045 : 0.38
Client Index = 1	Epoch: 0	Loss: 2.177321
Client Index = 1	Epoch: 1	Loss: 2.150113
Client Index = 1	Epoch: 2	Loss: 2.096583
Client Index = 1	Epoch: 3	Loss: 2.048283
Client Index = 1	Epoch: 4	Loss: 2.002422
test acc on this client after 676 / 2045 : 0.33
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 2
local mask changes: 2921394.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3591320.0, 3590392.0, 2921394.0, 3589794.0, 3590454.0]
Doing local aggregation!
test acc on this client before 786 / 2051 : 0.38
Client Index = 2	Epoch: 0	Loss: 2.160434
Client Index = 2	Epoch: 1	Loss: 2.127439
Client Index = 2	Epoch: 2	Loss: 2.083428
Client Index = 2	Epoch: 3	Loss: 2.038079
Client Index = 2	Epoch: 4	Loss: 1.989111
test acc on this client after 649 / 2051 : 0.32
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 3
local mask changes: 2922628.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3586764.0, 3589932.0, 3591262.0, 2922628.0, 3588996.0]
Doing local aggregation!
test acc on this client before 783 / 2049 : 0.38
Client Index = 3	Epoch: 0	Loss: 2.174492
Client Index = 3	Epoch: 1	Loss: 2.149952
Client Index = 3	Epoch: 2	Loss: 2.098770
Client Index = 3	Epoch: 3	Loss: 2.061158
Client Index = 3	Epoch: 4	Loss: 2.015122
test acc on this client after 741 / 2049 : 0.36
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 4
local mask changes: 2921466.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3591946.0, 3591204.0, 3590060.0, 3589744.0, 2921466.0]
Doing local aggregation!
test acc on this client before 760 / 2051 : 0.37
Client Index = 4	Epoch: 0	Loss: 2.194174
Client Index = 4	Epoch: 1	Loss: 2.151985
Client Index = 4	Epoch: 2	Loss: 2.101685
Client Index = 4	Epoch: 3	Loss: 2.072854
Client Index = 4	Epoch: 4	Loss: 2.006072
test acc on this client after 641 / 2051 : 0.31
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 2.0971761392817205}
################local_test_on_all_clients after local training in communication round: 6
{'test_acc_after': 0.33389126732468705, 'test_loss_after': 2.6558103086943143}
################local_test_on_all_clients before local training in communication round: 6
{'test_acc_before': 0.3795625258093556, 'test_loss_before': 2.3907472588550447}
################Communication round : 7
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 0
local mask changes: 2916008.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2916008.0, 3519734.0, 3521276.0, 3517720.0, 3522158.0]
Doing local aggregation!
test acc on this client before 881 / 2050 : 0.43
Client Index = 0	Epoch: 0	Loss: 1.977084
Client Index = 0	Epoch: 1	Loss: 1.946034
Client Index = 0	Epoch: 2	Loss: 1.892061
Client Index = 0	Epoch: 3	Loss: 1.850349
Client Index = 0	Epoch: 4	Loss: 1.806106
test acc on this client after 720 / 2050 : 0.35
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 1
local mask changes: 2916608.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3520834.0, 2916608.0, 3521104.0, 3521532.0, 3519868.0]
Doing local aggregation!
test acc on this client before 853 / 2045 : 0.42
Client Index = 1	Epoch: 0	Loss: 1.941862
Client Index = 1	Epoch: 1	Loss: 1.949171
Client Index = 1	Epoch: 2	Loss: 1.885773
Client Index = 1	Epoch: 3	Loss: 1.812623
Client Index = 1	Epoch: 4	Loss: 1.797709
test acc on this client after 754 / 2045 : 0.37
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 2
local mask changes: 2916314.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3520030.0, 3524048.0, 2916314.0, 3519210.0, 3522078.0]
Doing local aggregation!
test acc on this client before 870 / 2051 : 0.42
Client Index = 2	Epoch: 0	Loss: 1.964075
Client Index = 2	Epoch: 1	Loss: 1.913236
Client Index = 2	Epoch: 2	Loss: 1.860186
Client Index = 2	Epoch: 3	Loss: 1.821807
Client Index = 2	Epoch: 4	Loss: 1.796964
test acc on this client after 596 / 2051 : 0.29
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 3
local mask changes: 2915656.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3520422.0, 3521316.0, 3521396.0, 2915656.0, 3520166.0]
Doing local aggregation!
test acc on this client before 878 / 2049 : 0.43
Client Index = 3	Epoch: 0	Loss: 1.965900
Client Index = 3	Epoch: 1	Loss: 1.943689
Client Index = 3	Epoch: 2	Loss: 1.866217
Client Index = 3	Epoch: 3	Loss: 1.835143
Client Index = 3	Epoch: 4	Loss: 1.819770
test acc on this client after 817 / 2049 : 0.40
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 4
local mask changes: 2916954.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3522000.0, 3520980.0, 3520610.0, 3519860.0, 2916954.0]
Doing local aggregation!
test acc on this client before 874 / 2051 : 0.43
Client Index = 4	Epoch: 0	Loss: 1.987005
Client Index = 4	Epoch: 1	Loss: 1.950368
Client Index = 4	Epoch: 2	Loss: 1.892908
Client Index = 4	Epoch: 3	Loss: 1.862117
Client Index = 4	Epoch: 4	Loss: 1.816630
test acc on this client after 572 / 2051 : 0.28
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.886191440601738}
################local_test_on_all_clients after local training in communication round: 7
{'test_acc_after': 0.3376266120553625, 'test_loss_after': 2.6332598390892223}
################local_test_on_all_clients before local training in communication round: 7
{'test_acc_before': 0.425137927742605, 'test_loss_before': 2.1807544538898207}
################Communication round : 8
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 0
local mask changes: 2912842.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2912842.0, 3467730.0, 3469264.0, 3468148.0, 3469908.0]
Doing local aggregation!
test acc on this client before 909 / 2050 : 0.44
Client Index = 0	Epoch: 0	Loss: 1.765078
Client Index = 0	Epoch: 1	Loss: 1.736035
Client Index = 0	Epoch: 2	Loss: 1.706212
Client Index = 0	Epoch: 3	Loss: 1.653322
Client Index = 0	Epoch: 4	Loss: 1.612249
test acc on this client after 629 / 2050 : 0.31
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 1
local mask changes: 2909360.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3466556.0, 2909360.0, 3468394.0, 3468924.0, 3469220.0]
Doing local aggregation!
test acc on this client before 909 / 2045 : 0.44
Client Index = 1	Epoch: 0	Loss: 1.771436
Client Index = 1	Epoch: 1	Loss: 1.712977
Client Index = 1	Epoch: 2	Loss: 1.686596
Client Index = 1	Epoch: 3	Loss: 1.625773
Client Index = 1	Epoch: 4	Loss: 1.613168
test acc on this client after 818 / 2045 : 0.40
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 2
local mask changes: 2910386.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3469062.0, 3471756.0, 2910386.0, 3465740.0, 3469096.0]
Doing local aggregation!
test acc on this client before 900 / 2051 : 0.44
Client Index = 2	Epoch: 0	Loss: 1.741213
Client Index = 2	Epoch: 1	Loss: 1.713115
Client Index = 2	Epoch: 2	Loss: 1.675345
Client Index = 2	Epoch: 3	Loss: 1.637602
Client Index = 2	Epoch: 4	Loss: 1.593870
test acc on this client after 773 / 2051 : 0.38
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 3
local mask changes: 2909072.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3468644.0, 3468448.0, 3469140.0, 2909072.0, 3465376.0]
Doing local aggregation!
test acc on this client before 924 / 2049 : 0.45
Client Index = 3	Epoch: 0	Loss: 1.754034
Client Index = 3	Epoch: 1	Loss: 1.755011
Client Index = 3	Epoch: 2	Loss: 1.692458
Client Index = 3	Epoch: 3	Loss: 1.644449
Client Index = 3	Epoch: 4	Loss: 1.608881
test acc on this client after 879 / 2049 : 0.43
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 4
local mask changes: 2909528.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3467130.0, 3467822.0, 3467222.0, 3465380.0, 2909528.0]
Doing local aggregation!
test acc on this client before 902 / 2051 : 0.44
Client Index = 4	Epoch: 0	Loss: 1.771181
Client Index = 4	Epoch: 1	Loss: 1.744198
Client Index = 4	Epoch: 2	Loss: 1.700741
Client Index = 4	Epoch: 3	Loss: 1.673138
Client Index = 4	Epoch: 4	Loss: 1.622738
test acc on this client after 711 / 2051 : 0.35
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.688432768315685}
################local_test_on_all_clients after local training in communication round: 8
{'test_acc_after': 0.3718737014890774, 'test_loss_after': 2.5548361367285177}
################local_test_on_all_clients before local training in communication round: 8
{'test_acc_before': 0.4434921804648152, 'test_loss_before': 2.053368954561878}
################Communication round : 9
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 0
local mask changes: 2902062.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2902062.0, 3429076.0, 3430528.0, 3428186.0, 3429102.0]
Doing local aggregation!
test acc on this client before 974 / 2050 : 0.48
Client Index = 0	Epoch: 0	Loss: 1.578574
Client Index = 0	Epoch: 1	Loss: 1.576661
Client Index = 0	Epoch: 2	Loss: 1.503683
Client Index = 0	Epoch: 3	Loss: 1.478179
Client Index = 0	Epoch: 4	Loss: 1.447705
test acc on this client after 746 / 2050 : 0.36
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 1
local mask changes: 2900758.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3429764.0, 2900758.0, 3427826.0, 3430256.0, 3428546.0]
Doing local aggregation!
test acc on this client before 982 / 2045 : 0.48
Client Index = 1	Epoch: 0	Loss: 1.580883
Client Index = 1	Epoch: 1	Loss: 1.544178
Client Index = 1	Epoch: 2	Loss: 1.513557
Client Index = 1	Epoch: 3	Loss: 1.453628
Client Index = 1	Epoch: 4	Loss: 1.427594
test acc on this client after 889 / 2045 : 0.43
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 2
local mask changes: 2901314.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3428144.0, 3426346.0, 2901314.0, 3429002.0, 3427674.0]
Doing local aggregation!
test acc on this client before 992 / 2051 : 0.48
Client Index = 2	Epoch: 0	Loss: 1.561414
Client Index = 2	Epoch: 1	Loss: 1.528859
Client Index = 2	Epoch: 2	Loss: 1.491881
Client Index = 2	Epoch: 3	Loss: 1.459028
Client Index = 2	Epoch: 4	Loss: 1.433231
test acc on this client after 595 / 2051 : 0.29
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 3
local mask changes: 2902358.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3428730.0, 3429076.0, 3428288.0, 2902358.0, 3427120.0]
Doing local aggregation!
test acc on this client before 988 / 2049 : 0.48
Client Index = 3	Epoch: 0	Loss: 1.573647
Client Index = 3	Epoch: 1	Loss: 1.557560
Client Index = 3	Epoch: 2	Loss: 1.506536
Client Index = 3	Epoch: 3	Loss: 1.471515
Client Index = 3	Epoch: 4	Loss: 1.450871
test acc on this client after 890 / 2049 : 0.43
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 4
local mask changes: 2902830.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3428912.0, 3427796.0, 3428006.0, 3429906.0, 2902830.0]
Doing local aggregation!
test acc on this client before 954 / 2051 : 0.47
Client Index = 4	Epoch: 0	Loss: 1.582267
Client Index = 4	Epoch: 1	Loss: 1.564749
Client Index = 4	Epoch: 2	Loss: 1.532398
Client Index = 4	Epoch: 3	Loss: 1.479053
Client Index = 4	Epoch: 4	Loss: 1.434691
test acc on this client after 839 / 2051 : 0.41
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.5092936961991446}
################local_test_on_all_clients after local training in communication round: 9
{'test_acc_after': 0.3864301249970265, 'test_loss_after': 2.418632465420722}
################local_test_on_all_clients before local training in communication round: 9
{'test_acc_before': 0.47726188867968433, 'test_loss_before': 1.9391647013391964}
################Communication round : 10
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 0
local mask changes: 2892776.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2892776.0, 3399834.0, 3400502.0, 3401618.0, 3397640.0]
Doing local aggregation!
test acc on this client before 1029 / 2050 : 0.50
Client Index = 0	Epoch: 0	Loss: 1.423391
Client Index = 0	Epoch: 1	Loss: 1.381495
Client Index = 0	Epoch: 2	Loss: 1.362046
Client Index = 0	Epoch: 3	Loss: 1.323118
Client Index = 0	Epoch: 4	Loss: 1.293801
test acc on this client after 885 / 2050 : 0.43
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 1
local mask changes: 2893160.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3399712.0, 2893160.0, 3397404.0, 3398800.0, 3400486.0]
Doing local aggregation!
test acc on this client before 1043 / 2045 : 0.51
Client Index = 1	Epoch: 0	Loss: 1.411872
Client Index = 1	Epoch: 1	Loss: 1.393779
Client Index = 1	Epoch: 2	Loss: 1.344801
Client Index = 1	Epoch: 3	Loss: 1.310176
Client Index = 1	Epoch: 4	Loss: 1.264559
test acc on this client after 899 / 2045 : 0.44
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 2
local mask changes: 2893004.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3398318.0, 3398028.0, 2893004.0, 3399580.0, 3396402.0]
Doing local aggregation!
test acc on this client before 1039 / 2051 : 0.51
Client Index = 2	Epoch: 0	Loss: 1.396862
Client Index = 2	Epoch: 1	Loss: 1.389863
Client Index = 2	Epoch: 2	Loss: 1.329039
Client Index = 2	Epoch: 3	Loss: 1.300651
Client Index = 2	Epoch: 4	Loss: 1.262509
test acc on this client after 882 / 2051 : 0.43
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 3
local mask changes: 2894528.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3399912.0, 3397420.0, 3398398.0, 2894528.0, 3399612.0]
Doing local aggregation!
test acc on this client before 1078 / 2049 : 0.53
Client Index = 3	Epoch: 0	Loss: 1.409860
Client Index = 3	Epoch: 1	Loss: 1.388116
Client Index = 3	Epoch: 2	Loss: 1.365366
Client Index = 3	Epoch: 3	Loss: 1.297486
Client Index = 3	Epoch: 4	Loss: 1.264957
test acc on this client after 852 / 2049 : 0.42
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 4
local mask changes: 2897528.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3400176.0, 3398680.0, 3398030.0, 3400448.0, 2897528.0]
Doing local aggregation!
test acc on this client before 1027 / 2051 : 0.50
Client Index = 4	Epoch: 0	Loss: 1.429631
Client Index = 4	Epoch: 1	Loss: 1.388913
Client Index = 4	Epoch: 2	Loss: 1.350280
Client Index = 4	Epoch: 3	Loss: 1.329393
Client Index = 4	Epoch: 4	Loss: 1.271975
test acc on this client after 896 / 2051 : 0.44
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.3473575740079489}
################local_test_on_all_clients after local training in communication round: 10
{'test_acc_after': 0.4308045816978864, 'test_loss_after': 2.2489035687143533}
################local_test_on_all_clients before local training in communication round: 10
{'test_acc_before': 0.5090798945406328, 'test_loss_before': 1.804193774154378}
################Communication round : 11
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 0
local mask changes: 2886022.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2886022.0, 3376052.0, 3375374.0, 3376402.0, 3377752.0]
Doing local aggregation!
test acc on this client before 1097 / 2050 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.286477
Client Index = 0	Epoch: 1	Loss: 1.251421
Client Index = 0	Epoch: 2	Loss: 1.196545
Client Index = 0	Epoch: 3	Loss: 1.162964
Client Index = 0	Epoch: 4	Loss: 1.133000
test acc on this client after 849 / 2050 : 0.41
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 1
local mask changes: 2884270.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3377656.0, 2884270.0, 3375386.0, 3377968.0, 3378488.0]
Doing local aggregation!
test acc on this client before 1109 / 2045 : 0.54
Client Index = 1	Epoch: 0	Loss: 1.269373
Client Index = 1	Epoch: 1	Loss: 1.230607
Client Index = 1	Epoch: 2	Loss: 1.207446
Client Index = 1	Epoch: 3	Loss: 1.168136
Client Index = 1	Epoch: 4	Loss: 1.123522
test acc on this client after 802 / 2045 : 0.39
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 2
local mask changes: 2884210.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3376170.0, 3376760.0, 2884210.0, 3375168.0, 3378740.0]
Doing local aggregation!
test acc on this client before 1130 / 2051 : 0.55
Client Index = 2	Epoch: 0	Loss: 1.254786
Client Index = 2	Epoch: 1	Loss: 1.218710
Client Index = 2	Epoch: 2	Loss: 1.185645
Client Index = 2	Epoch: 3	Loss: 1.136384
Client Index = 2	Epoch: 4	Loss: 1.112210
test acc on this client after 953 / 2051 : 0.46
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 3
local mask changes: 2883776.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3375448.0, 3377198.0, 3377970.0, 2883776.0, 3377302.0]
Doing local aggregation!
test acc on this client before 1127 / 2049 : 0.55
Client Index = 3	Epoch: 0	Loss: 1.258294
Client Index = 3	Epoch: 1	Loss: 1.243972
Client Index = 3	Epoch: 2	Loss: 1.203171
Client Index = 3	Epoch: 3	Loss: 1.161573
Client Index = 3	Epoch: 4	Loss: 1.114110
test acc on this client after 864 / 2049 : 0.42
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 4
local mask changes: 2883604.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3377390.0, 3377682.0, 3373640.0, 3375724.0, 2883604.0]
Doing local aggregation!
test acc on this client before 1116 / 2051 : 0.54
Client Index = 4	Epoch: 0	Loss: 1.269156
Client Index = 4	Epoch: 1	Loss: 1.233816
Client Index = 4	Epoch: 2	Loss: 1.202931
Client Index = 4	Epoch: 3	Loss: 1.176559
Client Index = 4	Epoch: 4	Loss: 1.135301
test acc on this client after 638 / 2051 : 0.31
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.1974443412070372}
################local_test_on_all_clients after local training in communication round: 11
{'test_acc_after': 0.400742129769863, 'test_loss_after': 2.482327293222609}
################local_test_on_all_clients before local training in communication round: 11
{'test_acc_before': 0.5445040429533463, 'test_loss_before': 1.6716419958713424}
################Communication round : 12
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 0
local mask changes: 2874694.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2874694.0, 3360514.0, 3361842.0, 3361710.0, 3361956.0]
Doing local aggregation!
test acc on this client before 1112 / 2050 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.132077
Client Index = 0	Epoch: 1	Loss: 1.110718
Client Index = 0	Epoch: 2	Loss: 1.071231
Client Index = 0	Epoch: 3	Loss: 1.029044
Client Index = 0	Epoch: 4	Loss: 0.995644
test acc on this client after 974 / 2050 : 0.48
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 1
local mask changes: 2875672.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3361064.0, 2875672.0, 3362218.0, 3359914.0, 3360026.0]
Doing local aggregation!
test acc on this client before 1145 / 2045 : 0.56
Client Index = 1	Epoch: 0	Loss: 1.116037
Client Index = 1	Epoch: 1	Loss: 1.106608
Client Index = 1	Epoch: 2	Loss: 1.044940
Client Index = 1	Epoch: 3	Loss: 1.001677
Client Index = 1	Epoch: 4	Loss: 0.992861
test acc on this client after 1005 / 2045 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 2
local mask changes: 2875072.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3361276.0, 3359302.0, 2875072.0, 3360194.0, 3359570.0]
Doing local aggregation!
test acc on this client before 1161 / 2051 : 0.57
Client Index = 2	Epoch: 0	Loss: 1.118377
Client Index = 2	Epoch: 1	Loss: 1.089845
Client Index = 2	Epoch: 2	Loss: 1.046452
Client Index = 2	Epoch: 3	Loss: 1.007628
Client Index = 2	Epoch: 4	Loss: 0.982042
test acc on this client after 922 / 2051 : 0.45
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 3
local mask changes: 2874522.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3359320.0, 3360610.0, 3359574.0, 2874522.0, 3359142.0]
Doing local aggregation!
test acc on this client before 1169 / 2049 : 0.57
Client Index = 3	Epoch: 0	Loss: 1.117110
Client Index = 3	Epoch: 1	Loss: 1.098291
Client Index = 3	Epoch: 2	Loss: 1.056856
Client Index = 3	Epoch: 3	Loss: 1.020418
Client Index = 3	Epoch: 4	Loss: 0.982557
test acc on this client after 971 / 2049 : 0.47
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 4
local mask changes: 2876286.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3361462.0, 3361480.0, 3358372.0, 3361164.0, 2876286.0]
Doing local aggregation!
test acc on this client before 1148 / 2051 : 0.56
Client Index = 4	Epoch: 0	Loss: 1.136863
Client Index = 4	Epoch: 1	Loss: 1.096992
Client Index = 4	Epoch: 2	Loss: 1.056016
Client Index = 4	Epoch: 3	Loss: 1.035567
Client Index = 4	Epoch: 4	Loss: 0.999810
test acc on this client after 972 / 2051 : 0.47
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 1.057826374550255}
################local_test_on_all_clients after local training in communication round: 12
{'test_acc_after': 0.47278123418942275, 'test_loss_after': 2.0797158722769185}
################local_test_on_all_clients before local training in communication round: 12
{'test_acc_before': 0.5597311454548252, 'test_loss_before': 1.5975526021596356}
################Communication round : 13
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 0
local mask changes: 2860876.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2860876.0, 3350710.0, 3349724.0, 3349770.0, 3349180.0]
Doing local aggregation!
test acc on this client before 1192 / 2050 : 0.58
Client Index = 0	Epoch: 0	Loss: 1.008916
Client Index = 0	Epoch: 1	Loss: 0.988805
Client Index = 0	Epoch: 2	Loss: 0.940533
Client Index = 0	Epoch: 3	Loss: 0.874570
Client Index = 0	Epoch: 4	Loss: 0.883432
test acc on this client after 845 / 2050 : 0.41
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 1
local mask changes: 2861404.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3346104.0, 2861404.0, 3349130.0, 3345052.0, 3348756.0]
Doing local aggregation!
test acc on this client before 1181 / 2045 : 0.58
Client Index = 1	Epoch: 0	Loss: 0.978638
Client Index = 1	Epoch: 1	Loss: 0.970758
Client Index = 1	Epoch: 2	Loss: 0.931276
Client Index = 1	Epoch: 3	Loss: 0.869136
Client Index = 1	Epoch: 4	Loss: 0.869449
test acc on this client after 929 / 2045 : 0.45
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 2
local mask changes: 2863578.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3347700.0, 3350546.0, 2863578.0, 3350310.0, 3347894.0]
Doing local aggregation!
test acc on this client before 1207 / 2051 : 0.59
Client Index = 2	Epoch: 0	Loss: 0.983620
Client Index = 2	Epoch: 1	Loss: 0.939044
Client Index = 2	Epoch: 2	Loss: 0.920520
Client Index = 2	Epoch: 3	Loss: 0.866834
Client Index = 2	Epoch: 4	Loss: 0.822234
test acc on this client after 952 / 2051 : 0.46
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 3
local mask changes: 2862804.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3351254.0, 3349018.0, 3349018.0, 2862804.0, 3350778.0]
Doing local aggregation!
test acc on this client before 1207 / 2049 : 0.59
Client Index = 3	Epoch: 0	Loss: 0.968058
Client Index = 3	Epoch: 1	Loss: 0.967504
Client Index = 3	Epoch: 2	Loss: 0.927273
Client Index = 3	Epoch: 3	Loss: 0.916260
Client Index = 3	Epoch: 4	Loss: 0.860781
test acc on this client after 1019 / 2049 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 4
local mask changes: 2861894.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3351734.0, 3350266.0, 3352550.0, 3349350.0, 2861894.0]
Doing local aggregation!
test acc on this client before 1209 / 2051 : 0.59
Client Index = 4	Epoch: 0	Loss: 1.003416
Client Index = 4	Epoch: 1	Loss: 0.975581
Client Index = 4	Epoch: 2	Loss: 0.930502
Client Index = 4	Epoch: 3	Loss: 0.895601
Client Index = 4	Epoch: 4	Loss: 0.867518
test acc on this client after 1033 / 2051 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.9264103454412245}
################local_test_on_all_clients after local training in communication round: 13
{'test_acc_after': 0.4663220379347795, 'test_loss_after': 2.139348597167497}
################local_test_on_all_clients before local training in communication round: 13
{'test_acc_before': 0.5851998669688336, 'test_loss_before': 1.5024137306170546}
################Communication round : 14
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 0
local mask changes: 2849246.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2849246.0, 3342936.0, 3343118.0, 3342928.0, 3344194.0]
Doing local aggregation!
test acc on this client before 1194 / 2050 : 0.58
Client Index = 0	Epoch: 0	Loss: 0.879872
Client Index = 0	Epoch: 1	Loss: 0.863353
Client Index = 0	Epoch: 2	Loss: 0.801078
Client Index = 0	Epoch: 3	Loss: 0.766429
Client Index = 0	Epoch: 4	Loss: 0.755485
test acc on this client after 1058 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 1
local mask changes: 2851124.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3342100.0, 2851124.0, 3344350.0, 3343210.0, 3343186.0]
Doing local aggregation!
test acc on this client before 1184 / 2045 : 0.58
Client Index = 1	Epoch: 0	Loss: 0.860563
Client Index = 1	Epoch: 1	Loss: 0.845591
Client Index = 1	Epoch: 2	Loss: 0.825657
Client Index = 1	Epoch: 3	Loss: 0.753774
Client Index = 1	Epoch: 4	Loss: 0.729111
test acc on this client after 1009 / 2045 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 2
local mask changes: 2848082.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3343820.0, 3343650.0, 2848082.0, 3342182.0, 3343206.0]
Doing local aggregation!
test acc on this client before 1212 / 2051 : 0.59
Client Index = 2	Epoch: 0	Loss: 0.851233
Client Index = 2	Epoch: 1	Loss: 0.846137
Client Index = 2	Epoch: 2	Loss: 0.785139
Client Index = 2	Epoch: 3	Loss: 0.754846
Client Index = 2	Epoch: 4	Loss: 0.733806
test acc on this client after 1049 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 3
local mask changes: 2851210.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3342482.0, 3340264.0, 3342122.0, 2851210.0, 3343994.0]
Doing local aggregation!
test acc on this client before 1248 / 2049 : 0.61
Client Index = 3	Epoch: 0	Loss: 0.869913
Client Index = 3	Epoch: 1	Loss: 0.826943
Client Index = 3	Epoch: 2	Loss: 0.795433
Client Index = 3	Epoch: 3	Loss: 0.775964
Client Index = 3	Epoch: 4	Loss: 0.747945
test acc on this client after 1067 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 4
local mask changes: 2850262.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3344044.0, 3344026.0, 3343174.0, 3343370.0, 2850262.0]
Doing local aggregation!
test acc on this client before 1238 / 2051 : 0.60
Client Index = 4	Epoch: 0	Loss: 0.883206
Client Index = 4	Epoch: 1	Loss: 0.870121
Client Index = 4	Epoch: 2	Loss: 0.815199
Client Index = 4	Epoch: 3	Loss: 0.797677
Client Index = 4	Epoch: 4	Loss: 0.720701
test acc on this client after 1046 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.8062070352447275}
################local_test_on_all_clients after local training in communication round: 14
{'test_acc_after': 0.5103381738088328, 'test_loss_after': 1.952038970827239}
################local_test_on_all_clients before local training in communication round: 14
{'test_acc_before': 0.5930057955000345, 'test_loss_before': 1.5030030867828885}
################Communication round : 15
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 0
local mask changes: 2836400.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2836400.0, 3342492.0, 3340980.0, 3339264.0, 3340984.0]
Doing local aggregation!
test acc on this client before 1213 / 2050 : 0.59
Client Index = 0	Epoch: 0	Loss: 0.757611
Client Index = 0	Epoch: 1	Loss: 0.751198
Client Index = 0	Epoch: 2	Loss: 0.678669
Client Index = 0	Epoch: 3	Loss: 0.664776
Client Index = 0	Epoch: 4	Loss: 0.637425
test acc on this client after 1030 / 2050 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 1
local mask changes: 2837718.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3341280.0, 2837718.0, 3338416.0, 3338642.0, 3337682.0]
Doing local aggregation!
test acc on this client before 1227 / 2045 : 0.60
Client Index = 1	Epoch: 0	Loss: 0.757355
Client Index = 1	Epoch: 1	Loss: 0.722529
Client Index = 1	Epoch: 2	Loss: 0.683658
Client Index = 1	Epoch: 3	Loss: 0.641690
Client Index = 1	Epoch: 4	Loss: 0.604184
test acc on this client after 1012 / 2045 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 2
local mask changes: 2837216.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3340300.0, 3340028.0, 2837216.0, 3337916.0, 3337458.0]
Doing local aggregation!
test acc on this client before 1244 / 2051 : 0.61
Client Index = 2	Epoch: 0	Loss: 0.752353
Client Index = 2	Epoch: 1	Loss: 0.735028
Client Index = 2	Epoch: 2	Loss: 0.686987
Client Index = 2	Epoch: 3	Loss: 0.664437
Client Index = 2	Epoch: 4	Loss: 0.593910
test acc on this client after 1114 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 3
local mask changes: 2836618.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3339624.0, 3337986.0, 3337662.0, 2836618.0, 3340766.0]
Doing local aggregation!
test acc on this client before 1237 / 2049 : 0.60
Client Index = 3	Epoch: 0	Loss: 0.734003
Client Index = 3	Epoch: 1	Loss: 0.727414
Client Index = 3	Epoch: 2	Loss: 0.702931
Client Index = 3	Epoch: 3	Loss: 0.650056
Client Index = 3	Epoch: 4	Loss: 0.599300
test acc on this client after 925 / 2049 : 0.45
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 4
local mask changes: 2838292.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3342328.0, 3339536.0, 3339924.0, 3341050.0, 2838292.0]
Doing local aggregation!
test acc on this client before 1234 / 2051 : 0.60
Client Index = 4	Epoch: 0	Loss: 0.759043
Client Index = 4	Epoch: 1	Loss: 0.747523
Client Index = 4	Epoch: 2	Loss: 0.677779
Client Index = 4	Epoch: 3	Loss: 0.648084
Client Index = 4	Epoch: 4	Loss: 0.661534
test acc on this client after 990 / 2051 : 0.48
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.6895792037005327}
################local_test_on_all_clients after local training in communication round: 15
{'test_acc_after': 0.4949170659806745, 'test_loss_after': 2.0680457945968205}
################local_test_on_all_clients before local training in communication round: 15
{'test_acc_before': 0.6007215139512315, 'test_loss_before': 1.4837472835685563}
################Communication round : 16
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 0
local mask changes: 2822006.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2822006.0, 3339608.0, 3339718.0, 3337146.0, 3339872.0]
Doing local aggregation!
test acc on this client before 1232 / 2050 : 0.60
Client Index = 0	Epoch: 0	Loss: 0.646215
Client Index = 0	Epoch: 1	Loss: 0.641964
Client Index = 0	Epoch: 2	Loss: 0.571179
Client Index = 0	Epoch: 3	Loss: 0.528141
Client Index = 0	Epoch: 4	Loss: 0.547500
test acc on this client after 965 / 2050 : 0.47
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 1
local mask changes: 2818690.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3339216.0, 2818690.0, 3338672.0, 3336470.0, 3338236.0]
Doing local aggregation!
test acc on this client before 1223 / 2045 : 0.60
Client Index = 1	Epoch: 0	Loss: 0.650781
Client Index = 1	Epoch: 1	Loss: 0.606847
Client Index = 1	Epoch: 2	Loss: 0.575993
Client Index = 1	Epoch: 3	Loss: 0.545700
Client Index = 1	Epoch: 4	Loss: 0.475712
test acc on this client after 935 / 2045 : 0.46
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 2
local mask changes: 2821210.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3337898.0, 3337532.0, 2821210.0, 3335250.0, 3337418.0]
Doing local aggregation!
test acc on this client before 1243 / 2051 : 0.61
Client Index = 2	Epoch: 0	Loss: 0.629679
Client Index = 2	Epoch: 1	Loss: 0.638465
Client Index = 2	Epoch: 2	Loss: 0.579859
Client Index = 2	Epoch: 3	Loss: 0.518340
Client Index = 2	Epoch: 4	Loss: 0.510592
test acc on this client after 1059 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 3
local mask changes: 2821706.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3339924.0, 3338678.0, 3338846.0, 2821706.0, 3339094.0]
Doing local aggregation!
test acc on this client before 1230 / 2049 : 0.60
Client Index = 3	Epoch: 0	Loss: 0.612937
Client Index = 3	Epoch: 1	Loss: 0.642119
Client Index = 3	Epoch: 2	Loss: 0.598581
Client Index = 3	Epoch: 3	Loss: 0.543277
Client Index = 3	Epoch: 4	Loss: 0.491639
test acc on this client after 1085 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 4
local mask changes: 2818602.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3339070.0, 3341038.0, 3339478.0, 3339974.0, 2818602.0]
Doing local aggregation!
test acc on this client before 1254 / 2051 : 0.61
Client Index = 4	Epoch: 0	Loss: 0.640150
Client Index = 4	Epoch: 1	Loss: 0.600374
Client Index = 4	Epoch: 2	Loss: 0.586949
Client Index = 4	Epoch: 3	Loss: 0.555983
Client Index = 4	Epoch: 4	Loss: 0.546429
test acc on this client after 1120 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.5794162234359858}
################local_test_on_all_clients after local training in communication round: 16
{'test_acc_after': 0.503975920154814, 'test_loss_after': 2.097143577273134}
################local_test_on_all_clients before local training in communication round: 16
{'test_acc_before': 0.6033534690706945, 'test_loss_before': 1.4986555357765803}
################Communication round : 17
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 0
local mask changes: 2807834.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2807834.0, 3337998.0, 3338994.0, 3337604.0, 3339308.0]
Doing local aggregation!
test acc on this client before 1239 / 2050 : 0.60
Client Index = 0	Epoch: 0	Loss: 0.567317
Client Index = 0	Epoch: 1	Loss: 0.528948
Client Index = 0	Epoch: 2	Loss: 0.503325
Client Index = 0	Epoch: 3	Loss: 0.482093
Client Index = 0	Epoch: 4	Loss: 0.430904
test acc on this client after 1107 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 1
local mask changes: 2805538.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3336414.0, 2805538.0, 3337900.0, 3335668.0, 3337178.0]
Doing local aggregation!
test acc on this client before 1239 / 2045 : 0.61
Client Index = 1	Epoch: 0	Loss: 0.570750
Client Index = 1	Epoch: 1	Loss: 0.543519
Client Index = 1	Epoch: 2	Loss: 0.487340
Client Index = 1	Epoch: 3	Loss: 0.440287
Client Index = 1	Epoch: 4	Loss: 0.422278
test acc on this client after 1040 / 2045 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 2
local mask changes: 2806070.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3334530.0, 3336972.0, 2806070.0, 3338574.0, 3336268.0]
Doing local aggregation!
test acc on this client before 1264 / 2051 : 0.62
Client Index = 2	Epoch: 0	Loss: 0.556510
Client Index = 2	Epoch: 1	Loss: 0.532822
Client Index = 2	Epoch: 2	Loss: 0.481733
Client Index = 2	Epoch: 3	Loss: 0.441761
Client Index = 2	Epoch: 4	Loss: 0.425710
test acc on this client after 1123 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 3
local mask changes: 2805774.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3335454.0, 3336438.0, 3335354.0, 2805774.0, 3338792.0]
Doing local aggregation!
test acc on this client before 1264 / 2049 : 0.62
Client Index = 3	Epoch: 0	Loss: 0.553353
Client Index = 3	Epoch: 1	Loss: 0.568325
Client Index = 3	Epoch: 2	Loss: 0.492388
Client Index = 3	Epoch: 3	Loss: 0.449378
Client Index = 3	Epoch: 4	Loss: 0.429635
test acc on this client after 1009 / 2049 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 4
local mask changes: 2806092.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3337798.0, 3340094.0, 3337098.0, 3339054.0, 2806092.0]
Doing local aggregation!
test acc on this client before 1282 / 2051 : 0.63
Client Index = 4	Epoch: 0	Loss: 0.570258
Client Index = 4	Epoch: 1	Loss: 0.505784
Client Index = 4	Epoch: 2	Loss: 0.483930
Client Index = 4	Epoch: 3	Loss: 0.466832
Client Index = 4	Epoch: 4	Loss: 0.441499
test acc on this client after 1087 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.49506714290806225}
################local_test_on_all_clients after local training in communication round: 17
{'test_acc_after': 0.5237031901913112, 'test_loss_after': 2.03874010094851}
################local_test_on_all_clients before local training in communication round: 17
{'test_acc_before': 0.613698037117489, 'test_loss_before': 1.5011695410816306}
################Communication round : 18
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 0
local mask changes: 2787492.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2787492.0, 3335602.0, 3334968.0, 3336000.0, 3336264.0]
Doing local aggregation!
test acc on this client before 1257 / 2050 : 0.61
Client Index = 0	Epoch: 0	Loss: 0.445601
Client Index = 0	Epoch: 1	Loss: 0.504674
Client Index = 0	Epoch: 2	Loss: 0.376554
Client Index = 0	Epoch: 3	Loss: 0.421703
Client Index = 0	Epoch: 4	Loss: 0.334974
test acc on this client after 1097 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 1
local mask changes: 2788978.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3334052.0, 2788978.0, 3336386.0, 3332648.0, 3334964.0]
Doing local aggregation!
test acc on this client before 1270 / 2045 : 0.62
Client Index = 1	Epoch: 0	Loss: 0.458757
Client Index = 1	Epoch: 1	Loss: 0.441003
Client Index = 1	Epoch: 2	Loss: 0.438529
Client Index = 1	Epoch: 3	Loss: 0.348304
Client Index = 1	Epoch: 4	Loss: 0.332592
test acc on this client after 1082 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 2
local mask changes: 2788244.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3334652.0, 3332970.0, 2788244.0, 3334560.0, 3333996.0]
Doing local aggregation!
test acc on this client before 1290 / 2051 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.461981
Client Index = 2	Epoch: 1	Loss: 0.463441
Client Index = 2	Epoch: 2	Loss: 0.391785
Client Index = 2	Epoch: 3	Loss: 0.344817
Client Index = 2	Epoch: 4	Loss: 0.314237
test acc on this client after 1161 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 3
local mask changes: 2790146.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3334278.0, 3332730.0, 3333054.0, 2790146.0, 3335436.0]
Doing local aggregation!
test acc on this client before 1299 / 2049 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.480555
Client Index = 3	Epoch: 1	Loss: 0.440214
Client Index = 3	Epoch: 2	Loss: 0.482000
Client Index = 3	Epoch: 3	Loss: 0.358851
Client Index = 3	Epoch: 4	Loss: 0.366734
test acc on this client after 1089 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 4
local mask changes: 2790334.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3335650.0, 3336234.0, 3336790.0, 3335712.0, 2790334.0]
Doing local aggregation!
test acc on this client before 1306 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.483395
Client Index = 4	Epoch: 1	Loss: 0.440730
Client Index = 4	Epoch: 2	Loss: 0.421457
Client Index = 4	Epoch: 3	Loss: 0.413301
Client Index = 4	Epoch: 4	Loss: 0.333529
test acc on this client after 1118 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.4119887089333972}
################local_test_on_all_clients after local training in communication round: 18
{'test_acc_after': 0.541372272220246, 'test_loss_after': 1.9619427706825079}
################local_test_on_all_clients before local training in communication round: 18
{'test_acc_before': 0.6267778905586769, 'test_loss_before': 1.497290558160446}
################Communication round : 19
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 0
local mask changes: 2772862.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2772862.0, 3326888.0, 3326040.0, 3327688.0, 3329320.0]
Doing local aggregation!
test acc on this client before 1276 / 2050 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.382883
Client Index = 0	Epoch: 1	Loss: 0.443739
Client Index = 0	Epoch: 2	Loss: 0.346510
Client Index = 0	Epoch: 3	Loss: 0.330088
Client Index = 0	Epoch: 4	Loss: 0.283124
test acc on this client after 1137 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 1
local mask changes: 2771742.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3326644.0, 2771742.0, 3326512.0, 3325418.0, 3330020.0]
Doing local aggregation!
test acc on this client before 1275 / 2045 : 0.62
Client Index = 1	Epoch: 0	Loss: 0.360886
Client Index = 1	Epoch: 1	Loss: 0.443967
Client Index = 1	Epoch: 2	Loss: 0.342525
Client Index = 1	Epoch: 3	Loss: 0.305483
Client Index = 1	Epoch: 4	Loss: 0.295206
test acc on this client after 1077 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 2
local mask changes: 2770798.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3321440.0, 3325414.0, 2770798.0, 3324618.0, 3327384.0]
Doing local aggregation!
test acc on this client before 1296 / 2051 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.344516
Client Index = 2	Epoch: 1	Loss: 0.410810
Client Index = 2	Epoch: 2	Loss: 0.386392
Client Index = 2	Epoch: 3	Loss: 0.336135
Client Index = 2	Epoch: 4	Loss: 0.256136
test acc on this client after 980 / 2051 : 0.48
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 3
local mask changes: 2772656.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3327012.0, 3327936.0, 3328120.0, 2772656.0, 3328022.0]
Doing local aggregation!
test acc on this client before 1277 / 2049 : 0.62
Client Index = 3	Epoch: 0	Loss: 0.404277
Client Index = 3	Epoch: 1	Loss: 0.397563
Client Index = 3	Epoch: 2	Loss: 0.338091
Client Index = 3	Epoch: 3	Loss: 0.325212
Client Index = 3	Epoch: 4	Loss: 0.329936
test acc on this client after 1045 / 2049 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 4
local mask changes: 2770130.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3331490.0, 3330482.0, 3329776.0, 3331136.0, 2770130.0]
Doing local aggregation!
test acc on this client before 1294 / 2051 : 0.63
Client Index = 4	Epoch: 0	Loss: 0.396798
Client Index = 4	Epoch: 1	Loss: 0.403418
Client Index = 4	Epoch: 2	Loss: 0.358204
Client Index = 4	Epoch: 3	Loss: 0.301503
Client Index = 4	Epoch: 4	Loss: 0.240344
test acc on this client after 1190 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.350549902654424}
################local_test_on_all_clients after local training in communication round: 19
{'test_acc_after': 0.5298619742669614, 'test_loss_after': 2.051976873054806}
################local_test_on_all_clients before local training in communication round: 19
{'test_acc_before': 0.6263880772314834, 'test_loss_before': 1.516452114242999}
################Communication round : 20
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 0
local mask changes: 2752920.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2752920.0, 3315654.0, 3312892.0, 3314652.0, 3318746.0]
Doing local aggregation!
test acc on this client before 1272 / 2050 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.276284
Client Index = 0	Epoch: 1	Loss: 0.420448
Client Index = 0	Epoch: 2	Loss: 0.305354
Client Index = 0	Epoch: 3	Loss: 0.310987
Client Index = 0	Epoch: 4	Loss: 0.235643
test acc on this client after 1040 / 2050 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 1
local mask changes: 2753734.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3313298.0, 2753734.0, 3312938.0, 3313664.0, 3316908.0]
Doing local aggregation!
test acc on this client before 1282 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.354310
Client Index = 1	Epoch: 1	Loss: 0.392030
Client Index = 1	Epoch: 2	Loss: 0.270976
Client Index = 1	Epoch: 3	Loss: 0.245201
Client Index = 1	Epoch: 4	Loss: 0.188325
test acc on this client after 1084 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 2
local mask changes: 2753018.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3313010.0, 3315460.0, 2753018.0, 3315202.0, 3314924.0]
Doing local aggregation!
test acc on this client before 1294 / 2051 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.303359
Client Index = 2	Epoch: 1	Loss: 0.391030
Client Index = 2	Epoch: 2	Loss: 0.275160
Client Index = 2	Epoch: 3	Loss: 0.240652
Client Index = 2	Epoch: 4	Loss: 0.240084
test acc on this client after 1200 / 2051 : 0.59
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 3
local mask changes: 2753490.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3314984.0, 3315734.0, 3317170.0, 2753490.0, 3317490.0]
Doing local aggregation!
test acc on this client before 1301 / 2049 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.331619
Client Index = 3	Epoch: 1	Loss: 0.362007
Client Index = 3	Epoch: 2	Loss: 0.264681
Client Index = 3	Epoch: 3	Loss: 0.251026
Client Index = 3	Epoch: 4	Loss: 0.293927
test acc on this client after 895 / 2049 : 0.44
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 4
local mask changes: 2753272.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3314946.0, 3312232.0, 3311854.0, 3313036.0, 2753272.0]
Doing local aggregation!
test acc on this client before 1307 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.371858
Client Index = 4	Epoch: 1	Loss: 0.382707
Client Index = 4	Epoch: 2	Loss: 0.307998
Client Index = 4	Epoch: 3	Loss: 0.244119
Client Index = 4	Epoch: 4	Loss: 0.206008
test acc on this client after 1062 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.298631784029457}
################local_test_on_all_clients after local training in communication round: 20
{'test_acc_after': 0.5154131013210626, 'test_loss_after': 2.2587703725140367}
################local_test_on_all_clients before local training in communication round: 20
{'test_acc_before': 0.6300976835444324, 'test_loss_before': 1.5269298246221699}
################Communication round : 21
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 0
local mask changes: 2733790.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2733790.0, 3301908.0, 3298770.0, 3299864.0, 3299852.0]
Doing local aggregation!
test acc on this client before 1247 / 2050 : 0.61
Client Index = 0	Epoch: 0	Loss: 0.289377
Client Index = 0	Epoch: 1	Loss: 0.352312
Client Index = 0	Epoch: 2	Loss: 0.292334
Client Index = 0	Epoch: 3	Loss: 0.260266
Client Index = 0	Epoch: 4	Loss: 0.241387
test acc on this client after 1057 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 1
local mask changes: 2733146.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3295018.0, 2733146.0, 3295430.0, 3294586.0, 3292778.0]
Doing local aggregation!
test acc on this client before 1279 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.270333
Client Index = 1	Epoch: 1	Loss: 0.341516
Client Index = 1	Epoch: 2	Loss: 0.308801
Client Index = 1	Epoch: 3	Loss: 0.255172
Client Index = 1	Epoch: 4	Loss: 0.212957
test acc on this client after 1104 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 2
local mask changes: 2732254.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3293332.0, 3297874.0, 2732254.0, 3297386.0, 3295190.0]
Doing local aggregation!
test acc on this client before 1295 / 2051 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.251198
Client Index = 2	Epoch: 1	Loss: 0.353481
Client Index = 2	Epoch: 2	Loss: 0.292619
Client Index = 2	Epoch: 3	Loss: 0.236080
Client Index = 2	Epoch: 4	Loss: 0.187909
test acc on this client after 1085 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 3
local mask changes: 2734050.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3298982.0, 3300240.0, 3300748.0, 2734050.0, 3298488.0]
Doing local aggregation!
test acc on this client before 1261 / 2049 : 0.62
Client Index = 3	Epoch: 0	Loss: 0.245225
Client Index = 3	Epoch: 1	Loss: 0.403501
Client Index = 3	Epoch: 2	Loss: 0.251170
Client Index = 3	Epoch: 3	Loss: 0.268468
Client Index = 3	Epoch: 4	Loss: 0.194720
test acc on this client after 1030 / 2049 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 4
local mask changes: 2733430.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3296762.0, 3295682.0, 3298280.0, 3295594.0, 2733430.0]
Doing local aggregation!
test acc on this client before 1285 / 2051 : 0.63
Client Index = 4	Epoch: 0	Loss: 0.273345
Client Index = 4	Epoch: 1	Loss: 0.352281
Client Index = 4	Epoch: 2	Loss: 0.359306
Client Index = 4	Epoch: 3	Loss: 0.250321
Client Index = 4	Epoch: 4	Loss: 0.195340
test acc on this client after 1253 / 2051 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2775768410262405}
################local_test_on_all_clients after local training in communication round: 21
{'test_acc_after': 0.5396158067316357, 'test_loss_after': 2.1062992521029744}
################local_test_on_all_clients before local training in communication round: 21
{'test_acc_before': 0.62141313546898, 'test_loss_before': 1.6138721675384633}
################Communication round : 22
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 0
local mask changes: 2712986.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2712986.0, 3280880.0, 3278930.0, 3283212.0, 3282718.0]
Doing local aggregation!
test acc on this client before 1274 / 2050 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.174129
Client Index = 0	Epoch: 1	Loss: 0.362834
Client Index = 0	Epoch: 2	Loss: 0.302533
Client Index = 0	Epoch: 3	Loss: 0.177210
Client Index = 0	Epoch: 4	Loss: 0.209516
test acc on this client after 1182 / 2050 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 1
local mask changes: 2713162.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3278498.0, 2713162.0, 3276410.0, 3279890.0, 3274904.0]
Doing local aggregation!
test acc on this client before 1285 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.242672
Client Index = 1	Epoch: 1	Loss: 0.271445
Client Index = 1	Epoch: 2	Loss: 0.300574
Client Index = 1	Epoch: 3	Loss: 0.248444
Client Index = 1	Epoch: 4	Loss: 0.191850
test acc on this client after 992 / 2045 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 2
local mask changes: 2712502.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3277180.0, 3277344.0, 2712502.0, 3279488.0, 3273990.0]
Doing local aggregation!
test acc on this client before 1319 / 2051 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.229765
Client Index = 2	Epoch: 1	Loss: 0.338294
Client Index = 2	Epoch: 2	Loss: 0.256691
Client Index = 2	Epoch: 3	Loss: 0.200774
Client Index = 2	Epoch: 4	Loss: 0.135730
test acc on this client after 1148 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 3
local mask changes: 2714154.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3279000.0, 3276684.0, 3279618.0, 2714154.0, 3279312.0]
Doing local aggregation!
test acc on this client before 1313 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.204111
Client Index = 3	Epoch: 1	Loss: 0.265958
Client Index = 3	Epoch: 2	Loss: 0.354049
Client Index = 3	Epoch: 3	Loss: 0.220354
Client Index = 3	Epoch: 4	Loss: 0.164499
test acc on this client after 1167 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 4
local mask changes: 2713076.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3279946.0, 3278164.0, 3279152.0, 3282248.0, 2713076.0]
Doing local aggregation!
test acc on this client before 1315 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.168190
Client Index = 4	Epoch: 1	Loss: 0.253397
Client Index = 4	Epoch: 2	Loss: 0.355693
Client Index = 4	Epoch: 3	Loss: 0.225314
Client Index = 4	Epoch: 4	Loss: 0.135883
test acc on this client after 1234 / 2051 : 0.60
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2395963070442786}
################local_test_on_all_clients after local training in communication round: 22
{'test_acc_after': 0.558520350175856, 'test_loss_after': 2.004405506937359}
################local_test_on_all_clients before local training in communication round: 22
{'test_acc_before': 0.634975449570419, 'test_loss_before': 1.5224424484681118}
################Communication round : 23
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 0
local mask changes: 2692552.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2692552.0, 3259912.0, 3254296.0, 3258348.0, 3260988.0]
Doing local aggregation!
test acc on this client before 1301 / 2050 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.150400
Client Index = 0	Epoch: 1	Loss: 0.250265
Client Index = 0	Epoch: 2	Loss: 0.288920
Client Index = 0	Epoch: 3	Loss: 0.325630
Client Index = 0	Epoch: 4	Loss: 0.201293
test acc on this client after 1128 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 1
local mask changes: 2691756.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3261198.0, 2691756.0, 3260138.0, 3258684.0, 3260784.0]
Doing local aggregation!
test acc on this client before 1287 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.150694
Client Index = 1	Epoch: 1	Loss: 0.275539
Client Index = 1	Epoch: 2	Loss: 0.342615
Client Index = 1	Epoch: 3	Loss: 0.186959
Client Index = 1	Epoch: 4	Loss: 0.139218
test acc on this client after 1154 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 2
local mask changes: 2692116.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3255216.0, 3254666.0, 2692116.0, 3256160.0, 3253192.0]
Doing local aggregation!
test acc on this client before 1326 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.148332
Client Index = 2	Epoch: 1	Loss: 0.250565
Client Index = 2	Epoch: 2	Loss: 0.168322
Client Index = 2	Epoch: 3	Loss: 0.304324
Client Index = 2	Epoch: 4	Loss: 0.202842
test acc on this client after 1178 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 3
local mask changes: 2693024.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3260002.0, 3255250.0, 3258508.0, 2693024.0, 3259162.0]
Doing local aggregation!
test acc on this client before 1326 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.182039
Client Index = 3	Epoch: 1	Loss: 0.343330
Client Index = 3	Epoch: 2	Loss: 0.243740
Client Index = 3	Epoch: 3	Loss: 0.197466
Client Index = 3	Epoch: 4	Loss: 0.209886
test acc on this client after 1043 / 2049 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 4
local mask changes: 2692270.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3256626.0, 3254276.0, 3250882.0, 3255286.0, 2692270.0]
Doing local aggregation!
test acc on this client before 1330 / 2051 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.199193
Client Index = 4	Epoch: 1	Loss: 0.335120
Client Index = 4	Epoch: 2	Loss: 0.246505
Client Index = 4	Epoch: 3	Loss: 0.184780
Client Index = 4	Epoch: 4	Loss: 0.159550
test acc on this client after 958 / 2051 : 0.47
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.22750107024853325}
################local_test_on_all_clients after local training in communication round: 23
{'test_acc_after': 0.5330038147793673, 'test_loss_after': 2.151239884216846}
################local_test_on_all_clients before local training in communication round: 23
{'test_acc_before': 0.6412194015761733, 'test_loss_before': 1.5521123191178212}
################Communication round : 24
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 0
local mask changes: 2669724.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2669724.0, 3241376.0, 3236636.0, 3240034.0, 3238182.0]
Doing local aggregation!
test acc on this client before 1285 / 2050 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.102480
Client Index = 0	Epoch: 1	Loss: 0.106378
Client Index = 0	Epoch: 2	Loss: 0.225603
Client Index = 0	Epoch: 3	Loss: 0.307612
Client Index = 0	Epoch: 4	Loss: 0.261994
test acc on this client after 1155 / 2050 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 1
local mask changes: 2671472.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3234202.0, 2671472.0, 3231314.0, 3235460.0, 3231612.0]
Doing local aggregation!
test acc on this client before 1300 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.128445
Client Index = 1	Epoch: 1	Loss: 0.366523
Client Index = 1	Epoch: 2	Loss: 0.189587
Client Index = 1	Epoch: 3	Loss: 0.155658
Client Index = 1	Epoch: 4	Loss: 0.200206
test acc on this client after 1067 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 2
local mask changes: 2669736.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3232874.0, 3233754.0, 2669736.0, 3231814.0, 3227668.0]
Doing local aggregation!
test acc on this client before 1330 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.117525
Client Index = 2	Epoch: 1	Loss: 0.117058
Client Index = 2	Epoch: 2	Loss: 0.174853
Client Index = 2	Epoch: 3	Loss: 0.402374
Client Index = 2	Epoch: 4	Loss: 0.176475
test acc on this client after 1199 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 3
local mask changes: 2668602.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3234538.0, 3238406.0, 3233346.0, 2668602.0, 3234498.0]
Doing local aggregation!
test acc on this client before 1295 / 2049 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.121838
Client Index = 3	Epoch: 1	Loss: 0.215586
Client Index = 3	Epoch: 2	Loss: 0.337151
Client Index = 3	Epoch: 3	Loss: 0.159053
Client Index = 3	Epoch: 4	Loss: 0.133006
test acc on this client after 1256 / 2049 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 4
local mask changes: 2669204.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3231728.0, 3231442.0, 3229282.0, 3232426.0, 2669204.0]
Doing local aggregation!
test acc on this client before 1313 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.139341
Client Index = 4	Epoch: 1	Loss: 0.221471
Client Index = 4	Epoch: 2	Loss: 0.307341
Client Index = 4	Epoch: 3	Loss: 0.193315
Client Index = 4	Epoch: 4	Loss: 0.210502
test acc on this client after 1115 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.20285501030862943}
################local_test_on_all_clients after local training in communication round: 24
{'test_acc_after': 0.5652774198796836, 'test_loss_after': 1.9819213758986371}
################local_test_on_all_clients before local training in communication round: 24
{'test_acc_before': 0.6366362790279997, 'test_loss_before': 1.5663484960821306}
################Communication round : 25
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 0
local mask changes: 2645682.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2645682.0, 3213148.0, 3213192.0, 3215918.0, 3209820.0]
Doing local aggregation!
test acc on this client before 1301 / 2050 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.128216
Client Index = 0	Epoch: 1	Loss: 0.237259
Client Index = 0	Epoch: 2	Loss: 0.240111
Client Index = 0	Epoch: 3	Loss: 0.189790
Client Index = 0	Epoch: 4	Loss: 0.285430
test acc on this client after 1102 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 1
local mask changes: 2644910.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3212032.0, 2644910.0, 3209574.0, 3211252.0, 3210220.0]
Doing local aggregation!
test acc on this client before 1291 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.091219
Client Index = 1	Epoch: 1	Loss: 0.094344
Client Index = 1	Epoch: 2	Loss: 0.143808
Client Index = 1	Epoch: 3	Loss: 0.344617
Client Index = 1	Epoch: 4	Loss: 0.279477
test acc on this client after 1104 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 2
local mask changes: 2645586.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3210846.0, 3207334.0, 2645586.0, 3208282.0, 3203542.0]
Doing local aggregation!
test acc on this client before 1325 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.089668
Client Index = 2	Epoch: 1	Loss: 0.134183
Client Index = 2	Epoch: 2	Loss: 0.106718
Client Index = 2	Epoch: 3	Loss: 0.355632
Client Index = 2	Epoch: 4	Loss: 0.326515
test acc on this client after 1163 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 3
local mask changes: 2645440.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3211010.0, 3208476.0, 3205676.0, 2645440.0, 3206494.0]
Doing local aggregation!
test acc on this client before 1340 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.099512
Client Index = 3	Epoch: 1	Loss: 0.157468
Client Index = 3	Epoch: 2	Loss: 0.325219
Client Index = 3	Epoch: 3	Loss: 0.220239
Client Index = 3	Epoch: 4	Loss: 0.125328
test acc on this client after 1100 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 4
local mask changes: 2645274.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3213708.0, 3210740.0, 3210626.0, 3214320.0, 2645274.0]
Doing local aggregation!
test acc on this client before 1306 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.096534
Client Index = 4	Epoch: 1	Loss: 0.114194
Client Index = 4	Epoch: 2	Loss: 0.395415
Client Index = 4	Epoch: 3	Loss: 0.364493
Client Index = 4	Epoch: 4	Loss: 0.186335
test acc on this client after 1172 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2052689777592159}
################local_test_on_all_clients after local training in communication round: 25
{'test_acc_after': 0.5505461116787055, 'test_loss_after': 2.086168288003805}
################local_test_on_all_clients before local training in communication round: 25
{'test_acc_before': 0.6405392846716251, 'test_loss_before': 1.5650306421769706}
################Communication round : 26
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 0
local mask changes: 2623308.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2623308.0, 3191830.0, 3190284.0, 3191174.0, 3192568.0]
Doing local aggregation!
test acc on this client before 1313 / 2050 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.080660
Client Index = 0	Epoch: 1	Loss: 0.079340
Client Index = 0	Epoch: 2	Loss: 0.071792
Client Index = 0	Epoch: 3	Loss: 0.056817
Client Index = 0	Epoch: 4	Loss: 0.061764
test acc on this client after 1297 / 2050 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 1
local mask changes: 2621852.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3186480.0, 2621852.0, 3182798.0, 3185770.0, 3184874.0]
Doing local aggregation!
test acc on this client before 1284 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.088387
Client Index = 1	Epoch: 1	Loss: 0.089429
Client Index = 1	Epoch: 2	Loss: 0.069740
Client Index = 1	Epoch: 3	Loss: 0.077676
Client Index = 1	Epoch: 4	Loss: 0.083567
test acc on this client after 982 / 2045 : 0.48
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 2
local mask changes: 2623032.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3186966.0, 3186198.0, 2623032.0, 3184950.0, 3184762.0]
Doing local aggregation!
test acc on this client before 1310 / 2051 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.088067
Client Index = 2	Epoch: 1	Loss: 0.097150
Client Index = 2	Epoch: 2	Loss: 0.155920
Client Index = 2	Epoch: 3	Loss: 0.403834
Client Index = 2	Epoch: 4	Loss: 0.240416
test acc on this client after 1094 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 3
local mask changes: 2621302.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3180484.0, 3179604.0, 3180482.0, 2621302.0, 3180706.0]
Doing local aggregation!
test acc on this client before 1302 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.078930
Client Index = 3	Epoch: 1	Loss: 0.095258
Client Index = 3	Epoch: 2	Loss: 0.222482
Client Index = 3	Epoch: 3	Loss: 0.360663
Client Index = 3	Epoch: 4	Loss: 0.211791
test acc on this client after 989 / 2049 : 0.48
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 4
local mask changes: 2622730.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3191220.0, 3189638.0, 3186968.0, 3187600.0, 2622730.0]
Doing local aggregation!
test acc on this client before 1331 / 2051 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.080136
Client Index = 4	Epoch: 1	Loss: 0.075737
Client Index = 4	Epoch: 2	Loss: 0.062381
Client Index = 4	Epoch: 3	Loss: 0.084190
Client Index = 4	Epoch: 4	Loss: 0.068392
test acc on this client after 1246 / 2051 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.12338079496761974}
################local_test_on_all_clients after local training in communication round: 26
{'test_acc_after': 0.5472919751800751, 'test_loss_after': 2.208243348074704}
################local_test_on_all_clients before local training in communication round: 26
{'test_acc_before': 0.6382914274797377, 'test_loss_before': 1.5586267608329283}
################Communication round : 27
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 0
local mask changes: 2596690.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2596690.0, 3129776.0, 3130946.0, 3125456.0, 3130850.0]
Doing local aggregation!
test acc on this client before 1312 / 2050 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.092843
Client Index = 0	Epoch: 1	Loss: 0.537607
Client Index = 0	Epoch: 2	Loss: 0.343376
Client Index = 0	Epoch: 3	Loss: 0.214933
Client Index = 0	Epoch: 4	Loss: 0.131994
test acc on this client after 1223 / 2050 : 0.60
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 1
local mask changes: 2597122.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3136460.0, 2597122.0, 3132248.0, 3128670.0, 3135436.0]
Doing local aggregation!
test acc on this client before 1267 / 2045 : 0.62
Client Index = 1	Epoch: 0	Loss: 0.070577
Client Index = 1	Epoch: 1	Loss: 0.147722
Client Index = 1	Epoch: 2	Loss: 0.588252
Client Index = 1	Epoch: 3	Loss: 0.231816
Client Index = 1	Epoch: 4	Loss: 0.156562
test acc on this client after 1109 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 2
local mask changes: 2596788.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3169922.0, 3165660.0, 2596788.0, 3162142.0, 3167704.0]
Doing local aggregation!
test acc on this client before 1326 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.060573
Client Index = 2	Epoch: 1	Loss: 0.071239
Client Index = 2	Epoch: 2	Loss: 0.326381
Client Index = 2	Epoch: 3	Loss: 0.519327
Client Index = 2	Epoch: 4	Loss: 0.279113
test acc on this client after 1135 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 3
local mask changes: 2597824.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3167264.0, 3160244.0, 3163072.0, 2597824.0, 3165014.0]
Doing local aggregation!
test acc on this client before 1308 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.075738
Client Index = 3	Epoch: 1	Loss: 0.121583
Client Index = 3	Epoch: 2	Loss: 0.524562
Client Index = 3	Epoch: 3	Loss: 0.293847
Client Index = 3	Epoch: 4	Loss: 0.249104
test acc on this client after 1136 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 4
local mask changes: 2595644.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3134998.0, 3131418.0, 3134112.0, 3128734.0, 2595644.0]
Doing local aggregation!
test acc on this client before 1318 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.067370
Client Index = 4	Epoch: 1	Loss: 0.232642
Client Index = 4	Epoch: 2	Loss: 0.555997
Client Index = 4	Epoch: 3	Loss: 0.271477
Client Index = 4	Epoch: 4	Loss: 0.213312
test acc on this client after 1247 / 2051 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.25511791217768065}
################local_test_on_all_clients after local training in communication round: 27
{'test_acc_after': 0.5709370266869097, 'test_loss_after': 1.9292337454172876}
################local_test_on_all_clients before local training in communication round: 27
{'test_acc_before': 0.6374094665787025, 'test_loss_before': 1.603772269446009}
################Communication round : 28
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 0
local mask changes: 2571236.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2571236.0, 3111920.0, 3133188.0, 3130756.0, 3109298.0]
Doing local aggregation!
test acc on this client before 1335 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.067777
Client Index = 0	Epoch: 1	Loss: 0.059962
Client Index = 0	Epoch: 2	Loss: 0.050086
Client Index = 0	Epoch: 3	Loss: 0.046715
Client Index = 0	Epoch: 4	Loss: 0.055435
test acc on this client after 1216 / 2050 : 0.59
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 1
local mask changes: 2570740.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3101502.0, 2570740.0, 3130120.0, 3127510.0, 3104498.0]
Doing local aggregation!
test acc on this client before 1305 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.067806
Client Index = 1	Epoch: 1	Loss: 0.070138
Client Index = 1	Epoch: 2	Loss: 0.055913
Client Index = 1	Epoch: 3	Loss: 0.045361
Client Index = 1	Epoch: 4	Loss: 0.044943
test acc on this client after 1238 / 2045 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 2
local mask changes: 2569986.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3126900.0, 3131368.0, 2569986.0, 3147772.0, 3127614.0]
Doing local aggregation!
test acc on this client before 1335 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.069563
Client Index = 2	Epoch: 1	Loss: 0.050504
Client Index = 2	Epoch: 2	Loss: 0.049301
Client Index = 2	Epoch: 3	Loss: 0.032934
Client Index = 2	Epoch: 4	Loss: 0.029866
test acc on this client after 1280 / 2051 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 3
local mask changes: 2572144.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3127368.0, 3127350.0, 3146944.0, 2572144.0, 3126822.0]
Doing local aggregation!
test acc on this client before 1318 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.064600
Client Index = 3	Epoch: 1	Loss: 0.061007
Client Index = 3	Epoch: 2	Loss: 0.050230
Client Index = 3	Epoch: 3	Loss: 0.037097
Client Index = 3	Epoch: 4	Loss: 0.029641
test acc on this client after 1308 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 4
local mask changes: 2571468.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3111380.0, 3113200.0, 3135460.0, 3131638.0, 2571468.0]
Doing local aggregation!
test acc on this client before 1350 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.065214
Client Index = 4	Epoch: 1	Loss: 0.058391
Client Index = 4	Epoch: 2	Loss: 0.083469
Client Index = 4	Epoch: 3	Loss: 0.343981
Client Index = 4	Epoch: 4	Loss: 0.443112
test acc on this client after 1107 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.08132193828286718}
################local_test_on_all_clients after local training in communication round: 28
{'test_acc_after': 0.6001464812210364, 'test_loss_after': 1.8029967456058116}
################local_test_on_all_clients before local training in communication round: 28
{'test_acc_before': 0.6483438860632168, 'test_loss_before': 1.5230971773662225}
################Communication round : 29
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 0
local mask changes: 2542876.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2542876.0, 3072758.0, 3083048.0, 3081930.0, 3074186.0]
Doing local aggregation!
test acc on this client before 1340 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.051514
Client Index = 0	Epoch: 1	Loss: 0.344275
Client Index = 0	Epoch: 2	Loss: 0.518836
Client Index = 0	Epoch: 3	Loss: 0.287255
Client Index = 0	Epoch: 4	Loss: 0.144191
test acc on this client after 1233 / 2050 : 0.60
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 1
local mask changes: 2542296.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3070346.0, 2542296.0, 3079542.0, 3077960.0, 3071952.0]
Doing local aggregation!
test acc on this client before 1315 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.046302
Client Index = 1	Epoch: 1	Loss: 0.053070
Client Index = 1	Epoch: 2	Loss: 0.078693
Client Index = 1	Epoch: 3	Loss: 0.632363
Client Index = 1	Epoch: 4	Loss: 0.406931
test acc on this client after 1074 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 2
local mask changes: 2542216.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3074534.0, 3072846.0, 2542216.0, 3082220.0, 3077652.0]
Doing local aggregation!
test acc on this client before 1366 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.040755
Client Index = 2	Epoch: 1	Loss: 0.054909
Client Index = 2	Epoch: 2	Loss: 0.064649
Client Index = 2	Epoch: 3	Loss: 0.041532
Client Index = 2	Epoch: 4	Loss: 0.354135
test acc on this client after 1053 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 3
local mask changes: 2543056.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3077594.0, 3073642.0, 3084416.0, 2543056.0, 3079674.0]
Doing local aggregation!
test acc on this client before 1342 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.070848
Client Index = 3	Epoch: 1	Loss: 0.456387
Client Index = 3	Epoch: 2	Loss: 0.297876
Client Index = 3	Epoch: 3	Loss: 0.377071
Client Index = 3	Epoch: 4	Loss: 0.172867
test acc on this client after 1163 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 4
local mask changes: 2543632.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3117520.0, 3116366.0, 3126736.0, 3126130.0, 2543632.0]
Doing local aggregation!
test acc on this client before 1356 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.069747
Client Index = 4	Epoch: 1	Loss: 0.135499
Client Index = 4	Epoch: 2	Loss: 0.499890
Client Index = 4	Epoch: 3	Loss: 0.405483
Client Index = 4	Epoch: 4	Loss: 0.152550
test acc on this client after 1220 / 2051 : 0.59
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2303050704420145}
################local_test_on_all_clients after local training in communication round: 29
{'test_acc_after': 0.5604961239937267, 'test_loss_after': 1.9827266601930051}
################local_test_on_all_clients before local training in communication round: 29
{'test_acc_before': 0.6557602883000948, 'test_loss_before': 1.517244046855605}
################Communication round : 30
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 0
local mask changes: 2515754.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2515754.0, 3051036.0, 3053320.0, 3051638.0, 3082666.0]
Doing local aggregation!
test acc on this client before 1329 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.061902
Client Index = 0	Epoch: 1	Loss: 0.049165
Client Index = 0	Epoch: 2	Loss: 0.040187
Client Index = 0	Epoch: 3	Loss: 0.040269
Client Index = 0	Epoch: 4	Loss: 0.035039
test acc on this client after 1242 / 2050 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 1
local mask changes: 2515812.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3044294.0, 2515812.0, 3044370.0, 3045870.0, 3074904.0]
Doing local aggregation!
test acc on this client before 1309 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.076057
Client Index = 1	Epoch: 1	Loss: 0.147923
Client Index = 1	Epoch: 2	Loss: 0.443979
Client Index = 1	Epoch: 3	Loss: 0.282034
Client Index = 1	Epoch: 4	Loss: 0.153125
test acc on this client after 1127 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 2
local mask changes: 2514962.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3011834.0, 3010552.0, 2514962.0, 3013222.0, 3046862.0]
Doing local aggregation!
test acc on this client before 1319 / 2051 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.091522
Client Index = 2	Epoch: 1	Loss: 0.167225
Client Index = 2	Epoch: 2	Loss: 0.395223
Client Index = 2	Epoch: 3	Loss: 0.300596
Client Index = 2	Epoch: 4	Loss: 0.176792
test acc on this client after 1101 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 3
local mask changes: 2515366.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3058142.0, 3056574.0, 3056692.0, 2515366.0, 3088586.0]
Doing local aggregation!
test acc on this client before 1332 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.058040
Client Index = 3	Epoch: 1	Loss: 0.044789
Client Index = 3	Epoch: 2	Loss: 0.037472
Client Index = 3	Epoch: 3	Loss: 0.035335
Client Index = 3	Epoch: 4	Loss: 0.027435
test acc on this client after 1262 / 2049 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 4
local mask changes: 2515360.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3072112.0, 3073524.0, 3072714.0, 3074498.0, 2515360.0]
Doing local aggregation!
test acc on this client before 1348 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.062015
Client Index = 4	Epoch: 1	Loss: 0.115936
Client Index = 4	Epoch: 2	Loss: 0.063891
Client Index = 4	Epoch: 3	Loss: 0.260361
Client Index = 4	Epoch: 4	Loss: 0.362590
test acc on this client after 1139 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1411560516952708}
################local_test_on_all_clients after local training in communication round: 30
{'test_acc_after': 0.5730028547562871, 'test_loss_after': 1.9246556551932037}
################local_test_on_all_clients before local training in communication round: 30
{'test_acc_before': 0.6477609971616652, 'test_loss_before': 1.5196432862325917}
################Communication round : 31
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 0
local mask changes: 2486874.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2486874.0, 3012528.0, 2989206.0, 3019996.0, 3026228.0]
Doing local aggregation!
test acc on this client before 1331 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.048477
Client Index = 0	Epoch: 1	Loss: 0.061997
Client Index = 0	Epoch: 2	Loss: 0.063383
Client Index = 0	Epoch: 3	Loss: 0.550275
Client Index = 0	Epoch: 4	Loss: 0.481401
test acc on this client after 1079 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 1
local mask changes: 2487862.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3070140.0, 2487862.0, 3048054.0, 3074850.0, 3075958.0]
Doing local aggregation!
test acc on this client before 1310 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.050462
Client Index = 1	Epoch: 1	Loss: 0.052389
Client Index = 1	Epoch: 2	Loss: 0.045515
Client Index = 1	Epoch: 3	Loss: 0.056428
Client Index = 1	Epoch: 4	Loss: 0.597636
test acc on this client after 1108 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 2
local mask changes: 2486988.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3060928.0, 3055974.0, 2486988.0, 3063594.0, 3068224.0]
Doing local aggregation!
test acc on this client before 1343 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.044516
Client Index = 2	Epoch: 1	Loss: 0.048468
Client Index = 2	Epoch: 2	Loss: 0.046892
Client Index = 2	Epoch: 3	Loss: 0.052997
Client Index = 2	Epoch: 4	Loss: 0.598677
test acc on this client after 1141 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 3
local mask changes: 2486326.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3016356.0, 3011428.0, 2991310.0, 2486326.0, 3027844.0]
Doing local aggregation!
test acc on this client before 1335 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.052105
Client Index = 3	Epoch: 1	Loss: 0.059680
Client Index = 3	Epoch: 2	Loss: 0.264229
Client Index = 3	Epoch: 3	Loss: 0.518294
Client Index = 3	Epoch: 4	Loss: 0.344046
test acc on this client after 1067 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 4
local mask changes: 2487118.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3071132.0, 3068490.0, 3049646.0, 3076802.0, 2487118.0]
Doing local aggregation!
test acc on this client before 1345 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.053614
Client Index = 4	Epoch: 1	Loss: 0.054088
Client Index = 4	Epoch: 2	Loss: 0.040659
Client Index = 4	Epoch: 3	Loss: 0.030230
Client Index = 4	Epoch: 4	Loss: 0.035645
test acc on this client after 1273 / 2051 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.17008415301368401}
################local_test_on_all_clients after local training in communication round: 31
{'test_acc_after': 0.5531758830677422, 'test_loss_after': 2.0344386718777723}
################local_test_on_all_clients before local training in communication round: 31
{'test_acc_before': 0.6503945259625208, 'test_loss_before': 1.5260248357382795}
################Communication round : 32
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 0
local mask changes: 2457236.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2457236.0, 3036490.0, 3030004.0, 2999382.0, 3036800.0]
Doing local aggregation!
test acc on this client before 1324 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.056735
Client Index = 0	Epoch: 1	Loss: 0.070931
Client Index = 0	Epoch: 2	Loss: 0.050784
Client Index = 0	Epoch: 3	Loss: 0.046333
Client Index = 0	Epoch: 4	Loss: 0.042416
test acc on this client after 1275 / 2050 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 1
local mask changes: 2455918.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3000536.0, 2455918.0, 3031284.0, 3001878.0, 3036540.0]
Doing local aggregation!
test acc on this client before 1314 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.060588
Client Index = 1	Epoch: 1	Loss: 0.045469
Client Index = 1	Epoch: 2	Loss: 0.041018
Client Index = 1	Epoch: 3	Loss: 0.032613
Client Index = 1	Epoch: 4	Loss: 0.030617
test acc on this client after 1295 / 2045 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 2
local mask changes: 2455558.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2994994.0, 3034230.0, 2455558.0, 2995422.0, 3031164.0]
Doing local aggregation!
test acc on this client before 1348 / 2051 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.058938
Client Index = 2	Epoch: 1	Loss: 0.049865
Client Index = 2	Epoch: 2	Loss: 0.070044
Client Index = 2	Epoch: 3	Loss: 0.289375
Client Index = 2	Epoch: 4	Loss: 0.573802
test acc on this client after 1020 / 2051 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 3
local mask changes: 2455766.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3003754.0, 3038988.0, 3035740.0, 2455766.0, 3039416.0]
Doing local aggregation!
test acc on this client before 1354 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.056970
Client Index = 3	Epoch: 1	Loss: 0.048048
Client Index = 3	Epoch: 2	Loss: 0.051764
Client Index = 3	Epoch: 3	Loss: 0.039072
Client Index = 3	Epoch: 4	Loss: 0.033183
test acc on this client after 1261 / 2049 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 4
local mask changes: 2455898.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2959266.0, 3003166.0, 2994754.0, 2960560.0, 2455898.0]
Doing local aggregation!
test acc on this client before 1379 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.047552
Client Index = 4	Epoch: 1	Loss: 0.060714
Client Index = 4	Epoch: 2	Loss: 0.537257
Client Index = 4	Epoch: 3	Loss: 0.379109
Client Index = 4	Epoch: 4	Loss: 0.182048
test acc on this client after 1183 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.11820978291256694}
################local_test_on_all_clients after local training in communication round: 32
{'test_acc_after': 0.5889470801108002, 'test_loss_after': 1.844047606358091}
################local_test_on_all_clients before local training in communication round: 32
{'test_acc_before': 0.655760383294475, 'test_loss_before': 1.4976960743821879}
################Communication round : 33
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 0
local mask changes: 2425402.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2425402.0, 2966546.0, 2960442.0, 2973876.0, 2939372.0]
Doing local aggregation!
test acc on this client before 1357 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.042341
Client Index = 0	Epoch: 1	Loss: 0.075942
Client Index = 0	Epoch: 2	Loss: 0.485812
Client Index = 0	Epoch: 3	Loss: 0.524285
Client Index = 0	Epoch: 4	Loss: 0.355490
test acc on this client after 1059 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 1
local mask changes: 2427044.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2964344.0, 2427044.0, 2955022.0, 2964646.0, 2929676.0]
Doing local aggregation!
test acc on this client before 1317 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.035314
Client Index = 1	Epoch: 1	Loss: 0.057339
Client Index = 1	Epoch: 2	Loss: 0.594847
Client Index = 1	Epoch: 3	Loss: 0.451895
Client Index = 1	Epoch: 4	Loss: 0.367259
test acc on this client after 1087 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 2
local mask changes: 2426256.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3013668.0, 3013894.0, 2426256.0, 3021062.0, 2989648.0]
Doing local aggregation!
test acc on this client before 1339 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.048120
Client Index = 2	Epoch: 1	Loss: 0.043201
Client Index = 2	Epoch: 2	Loss: 0.051993
Client Index = 2	Epoch: 3	Loss: 0.603933
Client Index = 2	Epoch: 4	Loss: 0.458242
test acc on this client after 1072 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 3
local mask changes: 2425510.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2967922.0, 2965190.0, 2961918.0, 2425510.0, 2934728.0]
Doing local aggregation!
test acc on this client before 1321 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.053608
Client Index = 3	Epoch: 1	Loss: 0.062579
Client Index = 3	Epoch: 2	Loss: 0.211856
Client Index = 3	Epoch: 3	Loss: 0.615210
Client Index = 3	Epoch: 4	Loss: 0.375710
test acc on this client after 1059 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 4
local mask changes: 2425416.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3010694.0, 3006264.0, 3003100.0, 3013616.0, 2425416.0]
Doing local aggregation!
test acc on this client before 1352 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.036636
Client Index = 4	Epoch: 1	Loss: 0.036857
Client Index = 4	Epoch: 2	Loss: 0.045716
Client Index = 4	Epoch: 3	Loss: 0.038972
Client Index = 4	Epoch: 4	Loss: 0.273771
test acc on this client after 1033 / 2051 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2378771273303321}
################local_test_on_all_clients after local training in communication round: 33
{'test_acc_after': 0.5182583620071224, 'test_loss_after': 2.180884093046218}
################local_test_on_all_clients before local training in communication round: 33
{'test_acc_before': 0.6525417278758899, 'test_loss_before': 1.5123852709652161}
################Communication round : 34
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 0
local mask changes: 2395260.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2395260.0, 2963290.0, 3001076.0, 2966324.0, 2999654.0]
Doing local aggregation!
test acc on this client before 1333 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.063201
Client Index = 0	Epoch: 1	Loss: 0.046501
Client Index = 0	Epoch: 2	Loss: 0.039103
Client Index = 0	Epoch: 3	Loss: 0.041811
Client Index = 0	Epoch: 4	Loss: 0.025603
test acc on this client after 1325 / 2050 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 1
local mask changes: 2393996.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2962438.0, 2393996.0, 2999956.0, 2963260.0, 2998288.0]
Doing local aggregation!
test acc on this client before 1312 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.065252
Client Index = 1	Epoch: 1	Loss: 0.047263
Client Index = 1	Epoch: 2	Loss: 0.043754
Client Index = 1	Epoch: 3	Loss: 0.060018
Client Index = 1	Epoch: 4	Loss: 0.035184
test acc on this client after 1151 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 2
local mask changes: 2394412.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2975666.0, 2976016.0, 2394412.0, 2976870.0, 3006644.0]
Doing local aggregation!
test acc on this client before 1344 / 2051 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.058192
Client Index = 2	Epoch: 1	Loss: 0.051016
Client Index = 2	Epoch: 2	Loss: 0.045374
Client Index = 2	Epoch: 3	Loss: 0.039961
Client Index = 2	Epoch: 4	Loss: 0.030022
test acc on this client after 1341 / 2051 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 3
local mask changes: 2395068.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2960548.0, 2953948.0, 2991970.0, 2395068.0, 2988578.0]
Doing local aggregation!
test acc on this client before 1318 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.066943
Client Index = 3	Epoch: 1	Loss: 0.049457
Client Index = 3	Epoch: 2	Loss: 0.041656
Client Index = 3	Epoch: 3	Loss: 0.031988
Client Index = 3	Epoch: 4	Loss: 0.024358
test acc on this client after 1321 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 4
local mask changes: 2395534.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2925480.0, 2922244.0, 2960044.0, 2924500.0, 2395534.0]
Doing local aggregation!
test acc on this client before 1341 / 2051 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.083120
Client Index = 4	Epoch: 1	Loss: 0.204225
Client Index = 4	Epoch: 2	Loss: 0.363637
Client Index = 4	Epoch: 3	Loss: 0.374356
Client Index = 4	Epoch: 4	Loss: 0.193125
test acc on this client after 1186 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.08500483886262744}
################local_test_on_all_clients after local training in communication round: 34
{'test_acc_after': 0.6171928589026193, 'test_loss_after': 1.7280676986825534}
################local_test_on_all_clients before local training in communication round: 34
{'test_acc_before': 0.6488333606890143, 'test_loss_before': 1.5121373092986257}
################Communication round : 35
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 0
local mask changes: 2363498.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2363498.0, 2937172.0, 2940590.0, 2933886.0, 2907596.0]
Doing local aggregation!
test acc on this client before 1357 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.030194
Client Index = 0	Epoch: 1	Loss: 0.042777
Client Index = 0	Epoch: 2	Loss: 0.542198
Client Index = 0	Epoch: 3	Loss: 0.517430
Client Index = 0	Epoch: 4	Loss: 0.353192
test acc on this client after 1136 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 1
local mask changes: 2361072.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2944126.0, 2361072.0, 2945044.0, 2936162.0, 2909770.0]
Doing local aggregation!
test acc on this client before 1345 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.058314
Client Index = 1	Epoch: 1	Loss: 0.564416
Client Index = 1	Epoch: 2	Loss: 0.443522
Client Index = 1	Epoch: 3	Loss: 0.326842
Client Index = 1	Epoch: 4	Loss: 0.216340
test acc on this client after 1122 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 2
local mask changes: 2361552.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2943024.0, 2942570.0, 2361552.0, 2937566.0, 2909856.0]
Doing local aggregation!
test acc on this client before 1363 / 2051 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.030452
Client Index = 2	Epoch: 1	Loss: 0.032042
Client Index = 2	Epoch: 2	Loss: 0.029021
Client Index = 2	Epoch: 3	Loss: 0.046826
Client Index = 2	Epoch: 4	Loss: 0.152699
test acc on this client after 1090 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 3
local mask changes: 2362992.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2933880.0, 2932912.0, 2936146.0, 2362992.0, 2902480.0]
Doing local aggregation!
test acc on this client before 1355 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.029728
Client Index = 3	Epoch: 1	Loss: 0.035096
Client Index = 3	Epoch: 2	Loss: 0.052985
Client Index = 3	Epoch: 3	Loss: 0.545417
Client Index = 3	Epoch: 4	Loss: 0.577958
test acc on this client after 1088 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 4
local mask changes: 2361868.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2990616.0, 2991058.0, 2993582.0, 2985834.0, 2361868.0]
Doing local aggregation!
test acc on this client before 1358 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.037701
Client Index = 4	Epoch: 1	Loss: 0.042844
Client Index = 4	Epoch: 2	Loss: 0.263276
Client Index = 4	Epoch: 3	Loss: 0.590160
Client Index = 4	Epoch: 4	Loss: 0.450127
test acc on this client after 1083 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.240462305439275}
################local_test_on_all_clients after local training in communication round: 35
{'test_acc_after': 0.5386551008616455, 'test_loss_after': 2.0839209009666573}
################local_test_on_all_clients before local training in communication round: 35
{'test_acc_before': 0.6615242084716668, 'test_loss_before': 1.4993771010979633}
################Communication round : 36
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 0
local mask changes: 2330752.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2330752.0, 2926250.0, 2925190.0, 2922990.0, 2964848.0]
Doing local aggregation!
test acc on this client before 1328 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.057594
Client Index = 0	Epoch: 1	Loss: 0.060169
Client Index = 0	Epoch: 2	Loss: 0.064923
Client Index = 0	Epoch: 3	Loss: 0.522485
Client Index = 0	Epoch: 4	Loss: 0.449018
test acc on this client after 1054 / 2050 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 1
local mask changes: 2328800.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2936802.0, 2328800.0, 2939006.0, 2934990.0, 2975898.0]
Doing local aggregation!
test acc on this client before 1298 / 2045 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.048498
Client Index = 1	Epoch: 1	Loss: 0.034485
Client Index = 1	Epoch: 2	Loss: 0.027191
Client Index = 1	Epoch: 3	Loss: 0.040831
Client Index = 1	Epoch: 4	Loss: 0.026180
test acc on this client after 1298 / 2045 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 2
local mask changes: 2329870.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2851650.0, 2857272.0, 2329870.0, 2847166.0, 2897276.0]
Doing local aggregation!
test acc on this client before 1322 / 2051 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.064847
Client Index = 2	Epoch: 1	Loss: 0.057675
Client Index = 2	Epoch: 2	Loss: 0.505665
Client Index = 2	Epoch: 3	Loss: 0.405727
Client Index = 2	Epoch: 4	Loss: 0.223704
test acc on this client after 1089 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 3
local mask changes: 2329756.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2909130.0, 2911468.0, 2910294.0, 2329756.0, 2950198.0]
Doing local aggregation!
test acc on this client before 1301 / 2049 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.082224
Client Index = 3	Epoch: 1	Loss: 0.171012
Client Index = 3	Epoch: 2	Loss: 0.521553
Client Index = 3	Epoch: 3	Loss: 0.372239
Client Index = 3	Epoch: 4	Loss: 0.197052
test acc on this client after 1080 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 4
local mask changes: 2328268.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2951982.0, 2954640.0, 2954006.0, 2950806.0, 2328268.0]
Doing local aggregation!
test acc on this client before 1316 / 2051 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.059134
Client Index = 4	Epoch: 1	Loss: 0.039790
Client Index = 4	Epoch: 2	Loss: 0.028156
Client Index = 4	Epoch: 3	Loss: 0.032050
Client Index = 4	Epoch: 4	Loss: 0.546127
test acc on this client after 1040 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1855331112450103}
################local_test_on_all_clients after local training in communication round: 36
{'test_acc_after': 0.5427963561255097, 'test_loss_after': 2.1025544282292397}
################local_test_on_all_clients before local training in communication round: 36
{'test_acc_before': 0.6407338864540815, 'test_loss_before': 1.554343150884923}
################Communication round : 37
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 0
local mask changes: 2295482.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2295482.0, 2971696.0, 2922532.0, 2957140.0, 2975590.0]
Doing local aggregation!
test acc on this client before 1320 / 2050 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.051071
Client Index = 0	Epoch: 1	Loss: 0.037405
Client Index = 0	Epoch: 2	Loss: 0.043496
Client Index = 0	Epoch: 3	Loss: 0.038532
Client Index = 0	Epoch: 4	Loss: 0.032054
test acc on this client after 1343 / 2050 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 1
local mask changes: 2294374.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2900280.0, 2294374.0, 2852518.0, 2891478.0, 2912818.0]
Doing local aggregation!
test acc on this client before 1334 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.033629
Client Index = 1	Epoch: 1	Loss: 0.026068
Client Index = 1	Epoch: 2	Loss: 0.027601
Client Index = 1	Epoch: 3	Loss: 0.037348
Client Index = 1	Epoch: 4	Loss: 0.040698
test acc on this client after 1260 / 2045 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 2
local mask changes: 2295426.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2938692.0, 2947512.0, 2295426.0, 2929700.0, 2951672.0]
Doing local aggregation!
test acc on this client before 1342 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.044786
Client Index = 2	Epoch: 1	Loss: 0.033625
Client Index = 2	Epoch: 2	Loss: 0.037294
Client Index = 2	Epoch: 3	Loss: 0.029491
Client Index = 2	Epoch: 4	Loss: 0.186157
test acc on this client after 1069 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 3
local mask changes: 2295904.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2972934.0, 2979008.0, 2930104.0, 2295904.0, 2982522.0]
Doing local aggregation!
test acc on this client before 1324 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.041579
Client Index = 3	Epoch: 1	Loss: 0.042244
Client Index = 3	Epoch: 2	Loss: 0.032110
Client Index = 3	Epoch: 3	Loss: 0.020451
Client Index = 3	Epoch: 4	Loss: 0.022300
test acc on this client after 1330 / 2049 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 4
local mask changes: 2294638.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2944604.0, 2953086.0, 2903486.0, 2938980.0, 2294638.0]
Doing local aggregation!
test acc on this client before 1362 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.055281
Client Index = 4	Epoch: 1	Loss: 0.040912
Client Index = 4	Epoch: 2	Loss: 0.030873
Client Index = 4	Epoch: 3	Loss: 0.022613
Client Index = 4	Epoch: 4	Loss: 0.024310
test acc on this client after 1343 / 2051 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.04127712261539941}
################local_test_on_all_clients after local training in communication round: 37
{'test_acc_after': 0.619273538538099, 'test_loss_after': 1.6807600367678528}
################local_test_on_all_clients before local training in communication round: 37
{'test_acc_before': 0.6521550635392552, 'test_loss_before': 1.5059437433770353}
################Communication round : 38
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 0
local mask changes: 2260228.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2260228.0, 2843648.0, 2878758.0, 2901786.0, 2877946.0]
Doing local aggregation!
test acc on this client before 1364 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.019166
Client Index = 0	Epoch: 1	Loss: 0.020479
Client Index = 0	Epoch: 2	Loss: 0.033086
Client Index = 0	Epoch: 3	Loss: 0.038633
Client Index = 0	Epoch: 4	Loss: 0.635410
test acc on this client after 1109 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 1
local mask changes: 2260796.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2857850.0, 2260796.0, 2841384.0, 2863336.0, 2838944.0]
Doing local aggregation!
test acc on this client before 1336 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.042050
Client Index = 1	Epoch: 1	Loss: 0.583074
Client Index = 1	Epoch: 2	Loss: 0.584684
Client Index = 1	Epoch: 3	Loss: 0.265080
Client Index = 1	Epoch: 4	Loss: 0.200238
test acc on this client after 1073 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 2
local mask changes: 2260774.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2894478.0, 2848218.0, 2260774.0, 2901684.0, 2878218.0]
Doing local aggregation!
test acc on this client before 1367 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.030643
Client Index = 2	Epoch: 1	Loss: 0.045668
Client Index = 2	Epoch: 2	Loss: 0.612463
Client Index = 2	Epoch: 3	Loss: 0.600518
Client Index = 2	Epoch: 4	Loss: 0.385638
test acc on this client after 1133 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 3
local mask changes: 2260472.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2894100.0, 2839404.0, 2876920.0, 2260472.0, 2876700.0]
Doing local aggregation!
test acc on this client before 1351 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.021001
Client Index = 3	Epoch: 1	Loss: 0.021383
Client Index = 3	Epoch: 2	Loss: 0.017284
Client Index = 3	Epoch: 3	Loss: 0.031466
Client Index = 3	Epoch: 4	Loss: 0.631677
test acc on this client after 1084 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 4
local mask changes: 2260324.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2877598.0, 2827200.0, 2864422.0, 2883760.0, 2260324.0]
Doing local aggregation!
test acc on this client before 1398 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.022265
Client Index = 4	Epoch: 1	Loss: 0.024508
Client Index = 4	Epoch: 2	Loss: 0.032190
Client Index = 4	Epoch: 3	Loss: 0.191730
Client Index = 4	Epoch: 4	Loss: 0.658781
test acc on this client after 1149 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.22996460560414636}
################local_test_on_all_clients after local training in communication round: 38
{'test_acc_after': 0.5414673056050424, 'test_loss_after': 2.043979163540813}
################local_test_on_all_clients before local training in communication round: 38
{'test_acc_before': 0.6652270952998085, 'test_loss_before': 1.4500288133240458}
################Communication round : 39
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 0
local mask changes: 2223200.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2223200.0, 2799012.0, 2823028.0, 2817654.0, 2813178.0]
Doing local aggregation!
test acc on this client before 1342 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.075765
Client Index = 0	Epoch: 1	Loss: 0.187673
Client Index = 0	Epoch: 2	Loss: 0.516307
Client Index = 0	Epoch: 3	Loss: 0.371005
Client Index = 0	Epoch: 4	Loss: 0.280703
test acc on this client after 1002 / 2050 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 1
local mask changes: 2222760.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2862978.0, 2222760.0, 2866686.0, 2860354.0, 2852820.0]
Doing local aggregation!
test acc on this client before 1335 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.047440
Client Index = 1	Epoch: 1	Loss: 0.043075
Client Index = 1	Epoch: 2	Loss: 0.027019
Client Index = 1	Epoch: 3	Loss: 0.023182
Client Index = 1	Epoch: 4	Loss: 0.029131
test acc on this client after 1316 / 2045 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 2
local mask changes: 2223358.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2883052.0, 2862304.0, 2223358.0, 2880594.0, 2873590.0]
Doing local aggregation!
test acc on this client before 1384 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.056600
Client Index = 2	Epoch: 1	Loss: 0.039931
Client Index = 2	Epoch: 2	Loss: 0.050891
Client Index = 2	Epoch: 3	Loss: 0.031603
Client Index = 2	Epoch: 4	Loss: 0.053393
test acc on this client after 1091 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 3
local mask changes: 2225554.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2815262.0, 2793886.0, 2820034.0, 2225554.0, 2807184.0]
Doing local aggregation!
test acc on this client before 1314 / 2049 : 0.64
Client Index = 3	Epoch: 0	Loss: 0.075721
Client Index = 3	Epoch: 1	Loss: 0.066794
Client Index = 3	Epoch: 2	Loss: 0.308924
Client Index = 3	Epoch: 3	Loss: 0.470558
Client Index = 3	Epoch: 4	Loss: 0.402394
test acc on this client after 1067 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 4
local mask changes: 2224216.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2827170.0, 2804740.0, 2829622.0, 2823276.0, 2224216.0]
Doing local aggregation!
test acc on this client before 1338 / 2051 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.052625
Client Index = 4	Epoch: 1	Loss: 0.069216
Client Index = 4	Epoch: 2	Loss: 0.208854
Client Index = 4	Epoch: 3	Loss: 0.567932
Client Index = 4	Epoch: 4	Loss: 0.414731
test acc on this client after 1179 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1788586288369356}
################local_test_on_all_clients after local training in communication round: 39
{'test_acc_after': 0.5519640554688194, 'test_loss_after': 2.0706333518286852}
################local_test_on_all_clients before local training in communication round: 39
{'test_acc_before': 0.6551783599637985, 'test_loss_before': 1.468961511842639}
################Communication round : 40
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 0
local mask changes: 2188148.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2188148.0, 2903446.0, 2913222.0, 2873674.0, 2880716.0]
Doing local aggregation!
test acc on this client before 1345 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.038275
Client Index = 0	Epoch: 1	Loss: 0.047168
Client Index = 0	Epoch: 2	Loss: 0.028984
Client Index = 0	Epoch: 3	Loss: 0.029980
Client Index = 0	Epoch: 4	Loss: 0.036338
test acc on this client after 1299 / 2050 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 1
local mask changes: 2188306.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2796554.0, 2188306.0, 2840552.0, 2793048.0, 2802130.0]
Doing local aggregation!
test acc on this client before 1353 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.037824
Client Index = 1	Epoch: 1	Loss: 0.044437
Client Index = 1	Epoch: 2	Loss: 0.045500
Client Index = 1	Epoch: 3	Loss: 0.047343
Client Index = 1	Epoch: 4	Loss: 0.416504
test acc on this client after 1032 / 2045 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 2
local mask changes: 2187540.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2814450.0, 2844690.0, 2187540.0, 2813126.0, 2819642.0]
Doing local aggregation!
test acc on this client before 1348 / 2051 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.038046
Client Index = 2	Epoch: 1	Loss: 0.029749
Client Index = 2	Epoch: 2	Loss: 0.029963
Client Index = 2	Epoch: 3	Loss: 0.047477
Client Index = 2	Epoch: 4	Loss: 0.567165
test acc on this client after 1103 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 3
local mask changes: 2187832.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2869986.0, 2897056.0, 2907118.0, 2187832.0, 2873856.0]
Doing local aggregation!
test acc on this client before 1342 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.049397
Client Index = 3	Epoch: 1	Loss: 0.041870
Client Index = 3	Epoch: 2	Loss: 0.035732
Client Index = 3	Epoch: 3	Loss: 0.030866
Client Index = 3	Epoch: 4	Loss: 0.024194
test acc on this client after 1308 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 4
local mask changes: 2187888.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2869758.0, 2896860.0, 2905428.0, 2868678.0, 2187888.0]
Doing local aggregation!
test acc on this client before 1369 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.041234
Client Index = 4	Epoch: 1	Loss: 0.034949
Client Index = 4	Epoch: 2	Loss: 0.035420
Client Index = 4	Epoch: 3	Loss: 0.033359
Client Index = 4	Epoch: 4	Loss: 0.020480
test acc on this client after 1306 / 2051 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07329021067425076}
################local_test_on_all_clients after local training in communication round: 40
{'test_acc_after': 0.5902426379082021, 'test_loss_after': 1.8838420843128656}
################local_test_on_all_clients before local training in communication round: 40
{'test_acc_before': 0.6594769075557684, 'test_loss_before': 1.4769083283028217}
################Communication round : 41
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 0
local mask changes: 2150394.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2150394.0, 2773184.0, 2785810.0, 2831042.0, 2830140.0]
Doing local aggregation!
test acc on this client before 1362 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.030481
Client Index = 0	Epoch: 1	Loss: 0.038821
Client Index = 0	Epoch: 2	Loss: 0.054735
Client Index = 0	Epoch: 3	Loss: 0.604290
Client Index = 0	Epoch: 4	Loss: 0.579754
test acc on this client after 1072 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 1
local mask changes: 2150294.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2827936.0, 2150294.0, 2781128.0, 2826126.0, 2823040.0]
Doing local aggregation!
test acc on this client before 1322 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.039425
Client Index = 1	Epoch: 1	Loss: 0.328250
Client Index = 1	Epoch: 2	Loss: 0.605176
Client Index = 1	Epoch: 3	Loss: 0.497359
Client Index = 1	Epoch: 4	Loss: 0.275235
test acc on this client after 1079 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 2
local mask changes: 2148894.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2844026.0, 2785208.0, 2148894.0, 2839224.0, 2840932.0]
Doing local aggregation!
test acc on this client before 1367 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.036783
Client Index = 2	Epoch: 1	Loss: 0.044365
Client Index = 2	Epoch: 2	Loss: 0.532456
Client Index = 2	Epoch: 3	Loss: 0.554004
Client Index = 2	Epoch: 4	Loss: 0.370966
test acc on this client after 1120 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 3
local mask changes: 2150498.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2829572.0, 2768532.0, 2780754.0, 2150498.0, 2825670.0]
Doing local aggregation!
test acc on this client before 1345 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.028373
Client Index = 3	Epoch: 1	Loss: 0.025659
Client Index = 3	Epoch: 2	Loss: 0.225517
Client Index = 3	Epoch: 3	Loss: 0.613417
Client Index = 3	Epoch: 4	Loss: 0.505096
test acc on this client after 1089 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 4
local mask changes: 2149502.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2827118.0, 2763692.0, 2778980.0, 2824604.0, 2149502.0]
Doing local aggregation!
test acc on this client before 1374 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.027235
Client Index = 4	Epoch: 1	Loss: 0.050553
Client Index = 4	Epoch: 2	Loss: 0.569058
Client Index = 4	Epoch: 3	Loss: 0.561336
Client Index = 4	Epoch: 4	Loss: 0.468686
test acc on this client after 1140 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.30668128210443013}
################local_test_on_all_clients after local training in communication round: 41
{'test_acc_after': 0.536787094543216, 'test_loss_after': 2.064669317575068}
################local_test_on_all_clients before local training in communication round: 41
{'test_acc_before': 0.6607368068629728, 'test_loss_before': 1.4956621677643487}
################Communication round : 42
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 0
local mask changes: 2113118.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2113118.0, 2805790.0, 2815348.0, 2800122.0, 2796592.0]
Doing local aggregation!
test acc on this client before 1335 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.056062
Client Index = 0	Epoch: 1	Loss: 0.060010
Client Index = 0	Epoch: 2	Loss: 0.040438
Client Index = 0	Epoch: 3	Loss: 0.053396
Client Index = 0	Epoch: 4	Loss: 0.055708
test acc on this client after 1103 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 1
local mask changes: 2113510.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2828870.0, 2113510.0, 2843002.0, 2825858.0, 2825146.0]
Doing local aggregation!
test acc on this client before 1312 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.045213
Client Index = 1	Epoch: 1	Loss: 0.035129
Client Index = 1	Epoch: 2	Loss: 0.032323
Client Index = 1	Epoch: 3	Loss: 0.028088
Client Index = 1	Epoch: 4	Loss: 0.029358
test acc on this client after 1337 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 2
local mask changes: 2112932.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2829054.0, 2832684.0, 2112932.0, 2824562.0, 2824482.0]
Doing local aggregation!
test acc on this client before 1338 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.048281
Client Index = 2	Epoch: 1	Loss: 0.040519
Client Index = 2	Epoch: 2	Loss: 0.036151
Client Index = 2	Epoch: 3	Loss: 0.025677
Client Index = 2	Epoch: 4	Loss: 0.019857
test acc on this client after 1397 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 3
local mask changes: 2113322.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2802174.0, 2808340.0, 2817160.0, 2113322.0, 2798160.0]
Doing local aggregation!
test acc on this client before 1356 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.053910
Client Index = 3	Epoch: 1	Loss: 0.057590
Client Index = 3	Epoch: 2	Loss: 0.358982
Client Index = 3	Epoch: 3	Loss: 0.326805
Client Index = 3	Epoch: 4	Loss: 0.272658
test acc on this client after 1061 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 4
local mask changes: 2113596.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2824236.0, 2825398.0, 2836622.0, 2819052.0, 2113596.0]
Doing local aggregation!
test acc on this client before 1356 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.060550
Client Index = 4	Epoch: 1	Loss: 0.048314
Client Index = 4	Epoch: 2	Loss: 0.034710
Client Index = 4	Epoch: 3	Loss: 0.028770
Client Index = 4	Epoch: 4	Loss: 0.022810
test acc on this client after 1312 / 2051 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07485227250094925}
################local_test_on_all_clients after local training in communication round: 42
{'test_acc_after': 0.6060942383522169, 'test_loss_after': 1.8331505137445903}
################local_test_on_all_clients before local training in communication round: 42
{'test_acc_before': 0.6536152297161999, 'test_loss_before': 1.4829657776277425}
################Communication round : 43
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 0
local mask changes: 2072614.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2072614.0, 2802958.0, 2800742.0, 2786312.0, 2798652.0]
Doing local aggregation!
test acc on this client before 1343 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.028113
Client Index = 0	Epoch: 1	Loss: 0.119644
Client Index = 0	Epoch: 2	Loss: 0.555924
Client Index = 0	Epoch: 3	Loss: 0.362695
Client Index = 0	Epoch: 4	Loss: 0.359752
test acc on this client after 1146 / 2050 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 1
local mask changes: 2074276.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2784234.0, 2074276.0, 2799998.0, 2785622.0, 2799166.0]
Doing local aggregation!
test acc on this client before 1345 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.027173
Client Index = 1	Epoch: 1	Loss: 0.029667
Client Index = 1	Epoch: 2	Loss: 0.020427
Client Index = 1	Epoch: 3	Loss: 0.029974
Client Index = 1	Epoch: 4	Loss: 0.076624
test acc on this client after 1058 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 2
local mask changes: 2074110.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2785548.0, 2800168.0, 2074110.0, 2784808.0, 2797694.0]
Doing local aggregation!
test acc on this client before 1413 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.020663
Client Index = 2	Epoch: 1	Loss: 0.023983
Client Index = 2	Epoch: 2	Loss: 0.029813
Client Index = 2	Epoch: 3	Loss: 0.400201
Client Index = 2	Epoch: 4	Loss: 0.573915
test acc on this client after 1129 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 3
local mask changes: 2074310.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2855490.0, 2871164.0, 2868964.0, 2074310.0, 2869544.0]
Doing local aggregation!
test acc on this client before 1342 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.035667
Client Index = 3	Epoch: 1	Loss: 0.041206
Client Index = 3	Epoch: 2	Loss: 0.503368
Client Index = 3	Epoch: 3	Loss: 0.468783
Client Index = 3	Epoch: 4	Loss: 0.365359
test acc on this client after 1162 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 4
local mask changes: 2073864.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2785474.0, 2802314.0, 2801030.0, 2787532.0, 2073864.0]
Doing local aggregation!
test acc on this client before 1380 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.031088
Client Index = 4	Epoch: 1	Loss: 0.031634
Client Index = 4	Epoch: 2	Loss: 0.023425
Client Index = 4	Epoch: 3	Loss: 0.032510
Client Index = 4	Epoch: 4	Loss: 0.391561
test acc on this client after 1037 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.18332683206592895}
################local_test_on_all_clients after local training in communication round: 43
{'test_acc_after': 0.5399119836840663, 'test_loss_after': 2.071052571823842}
################local_test_on_all_clients before local training in communication round: 43
{'test_acc_before': 0.665910408531644, 'test_loss_before': 1.481350883520913}
################Communication round : 44
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 0
local mask changes: 2034096.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2034096.0, 2786676.0, 2785928.0, 2839734.0, 2789744.0]
Doing local aggregation!
test acc on this client before 1326 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.044078
Client Index = 0	Epoch: 1	Loss: 0.055786
Client Index = 0	Epoch: 2	Loss: 0.408941
Client Index = 0	Epoch: 3	Loss: 0.465679
Client Index = 0	Epoch: 4	Loss: 0.342418
test acc on this client after 1115 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 1
local mask changes: 2033790.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2680362.0, 2033790.0, 2677012.0, 2737948.0, 2680078.0]
Doing local aggregation!
test acc on this client before 1318 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.043681
Client Index = 1	Epoch: 1	Loss: 0.091013
Client Index = 1	Epoch: 2	Loss: 0.523627
Client Index = 1	Epoch: 3	Loss: 0.482649
Client Index = 1	Epoch: 4	Loss: 0.269575
test acc on this client after 1034 / 2045 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 2
local mask changes: 2035162.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2756978.0, 2752870.0, 2035162.0, 2806648.0, 2754690.0]
Doing local aggregation!
test acc on this client before 1354 / 2051 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.043984
Client Index = 2	Epoch: 1	Loss: 0.042084
Client Index = 2	Epoch: 2	Loss: 0.221078
Client Index = 2	Epoch: 3	Loss: 0.486343
Client Index = 2	Epoch: 4	Loss: 0.393345
test acc on this client after 1062 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 3
local mask changes: 2035034.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2828690.0, 2824418.0, 2825652.0, 2035034.0, 2828476.0]
Doing local aggregation!
test acc on this client before 1343 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.039199
Client Index = 3	Epoch: 1	Loss: 0.031611
Client Index = 3	Epoch: 2	Loss: 0.023995
Client Index = 3	Epoch: 3	Loss: 0.025316
Client Index = 3	Epoch: 4	Loss: 0.019549
test acc on this client after 1341 / 2049 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 4
local mask changes: 2033688.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2715328.0, 2710544.0, 2711424.0, 2771374.0, 2033688.0]
Doing local aggregation!
test acc on this client before 1354 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.055618
Client Index = 4	Epoch: 1	Loss: 0.181976
Client Index = 4	Epoch: 2	Loss: 0.479680
Client Index = 4	Epoch: 3	Loss: 0.407096
Client Index = 4	Epoch: 4	Loss: 0.196728
test acc on this client after 1157 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2150018282859035}
################local_test_on_all_clients after local training in communication round: 44
{'test_acc_after': 0.5571805533355694, 'test_loss_after': 2.0033699864776495}
################local_test_on_all_clients before local training in communication round: 44
{'test_acc_before': 0.6534202540508108, 'test_loss_before': 1.5072482037817576}
################Communication round : 45
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 0
local mask changes: 1994158.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1994158.0, 2788484.0, 2828918.0, 2866922.0, 2806302.0]
Doing local aggregation!
test acc on this client before 1342 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.031400
Client Index = 0	Epoch: 1	Loss: 0.028571
Client Index = 0	Epoch: 2	Loss: 0.022469
Client Index = 0	Epoch: 3	Loss: 0.017901
Client Index = 0	Epoch: 4	Loss: 0.014965
test acc on this client after 1357 / 2050 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 1
local mask changes: 1994114.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2806092.0, 1994114.0, 2783248.0, 2821470.0, 2754810.0]
Doing local aggregation!
test acc on this client before 1333 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.031667
Client Index = 1	Epoch: 1	Loss: 0.028321
Client Index = 1	Epoch: 2	Loss: 0.024438
Client Index = 1	Epoch: 3	Loss: 0.016964
Client Index = 1	Epoch: 4	Loss: 0.017966
test acc on this client after 1333 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 2
local mask changes: 1995052.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2822216.0, 2756926.0, 1995052.0, 2839914.0, 2777612.0]
Doing local aggregation!
test acc on this client before 1365 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.040099
Client Index = 2	Epoch: 1	Loss: 0.033094
Client Index = 2	Epoch: 2	Loss: 0.027648
Client Index = 2	Epoch: 3	Loss: 0.027350
Client Index = 2	Epoch: 4	Loss: 0.019916
test acc on this client after 1351 / 2051 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 3
local mask changes: 1993880.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2767426.0, 2693882.0, 2742872.0, 1993880.0, 2715834.0]
Doing local aggregation!
test acc on this client before 1362 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.033127
Client Index = 3	Epoch: 1	Loss: 0.026155
Client Index = 3	Epoch: 2	Loss: 0.025224
Client Index = 3	Epoch: 3	Loss: 0.030538
Client Index = 3	Epoch: 4	Loss: 0.024540
test acc on this client after 1320 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 4
local mask changes: 1993836.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2814850.0, 2744548.0, 2794182.0, 2831622.0, 1993836.0]
Doing local aggregation!
test acc on this client before 1368 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.035997
Client Index = 4	Epoch: 1	Loss: 0.028214
Client Index = 4	Epoch: 2	Loss: 0.023507
Client Index = 4	Epoch: 3	Loss: 0.017858
Client Index = 4	Epoch: 4	Loss: 0.019194
test acc on this client after 1332 / 2051 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.02588496261570907}
################local_test_on_all_clients after local training in communication round: 45
{'test_acc_after': 0.6532288041976244, 'test_loss_after': 1.5245612191366775}
################local_test_on_all_clients before local training in communication round: 45
{'test_acc_before': 0.6607406207295056, 'test_loss_before': 1.4869424775706492}
################Communication round : 46
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 0
local mask changes: 1953830.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1953830.0, 2738774.0, 2748762.0, 2699950.0, 2743272.0]
Doing local aggregation!
test acc on this client before 1374 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.012379
Client Index = 0	Epoch: 1	Loss: 0.012129
Client Index = 0	Epoch: 2	Loss: 0.013737
Client Index = 0	Epoch: 3	Loss: 0.012597
Client Index = 0	Epoch: 4	Loss: 0.030171
test acc on this client after 1331 / 2050 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 1
local mask changes: 1953226.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2742334.0, 1953226.0, 2724484.0, 2673478.0, 2719516.0]
Doing local aggregation!
test acc on this client before 1387 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.020603
Client Index = 1	Epoch: 1	Loss: 0.415262
Client Index = 1	Epoch: 2	Loss: 0.519038
Client Index = 1	Epoch: 3	Loss: 0.372161
Client Index = 1	Epoch: 4	Loss: 0.335126
test acc on this client after 1096 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 2
local mask changes: 1953190.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2755076.0, 2728044.0, 1953190.0, 2688694.0, 2732988.0]
Doing local aggregation!
test acc on this client before 1399 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.018218
Client Index = 2	Epoch: 1	Loss: 0.039604
Client Index = 2	Epoch: 2	Loss: 0.092136
Client Index = 2	Epoch: 3	Loss: 0.580363
Client Index = 2	Epoch: 4	Loss: 0.493381
test acc on this client after 1111 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 3
local mask changes: 1954020.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2724242.0, 2694024.0, 2707010.0, 1954020.0, 2702124.0]
Doing local aggregation!
test acc on this client before 1393 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.019822
Client Index = 3	Epoch: 1	Loss: 0.039330
Client Index = 3	Epoch: 2	Loss: 0.381932
Client Index = 3	Epoch: 3	Loss: 0.555949
Client Index = 3	Epoch: 4	Loss: 0.500511
test acc on this client after 1154 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 4
local mask changes: 1954168.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2748332.0, 2718038.0, 2732098.0, 2679984.0, 1954168.0]
Doing local aggregation!
test acc on this client before 1393 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.014903
Client Index = 4	Epoch: 1	Loss: 0.016997
Client Index = 4	Epoch: 2	Loss: 0.018549
Client Index = 4	Epoch: 3	Loss: 0.021452
Client Index = 4	Epoch: 4	Loss: 0.473590
test acc on this client after 1014 / 2051 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.20039761156475705}
################local_test_on_all_clients after local training in communication round: 46
{'test_acc_after': 0.556898227141679, 'test_loss_after': 2.010664161936485}
################local_test_on_all_clients before local training in communication round: 46
{'test_acc_before': 0.6779229028969054, 'test_loss_before': 1.4314998504234722}
################Communication round : 47
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 0
local mask changes: 1912172.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1912172.0, 2578418.0, 2589236.0, 2566092.0, 2582828.0]
Doing local aggregation!
test acc on this client before 1355 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.036688
Client Index = 0	Epoch: 1	Loss: 0.027910
Client Index = 0	Epoch: 2	Loss: 0.053010
Client Index = 0	Epoch: 3	Loss: 0.480332
Client Index = 0	Epoch: 4	Loss: 0.493337
test acc on this client after 1132 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 1
local mask changes: 1911920.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2727872.0, 1911920.0, 2723628.0, 2702746.0, 2714394.0]
Doing local aggregation!
test acc on this client before 1317 / 2045 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.036074
Client Index = 1	Epoch: 1	Loss: 0.031132
Client Index = 1	Epoch: 2	Loss: 0.023815
Client Index = 1	Epoch: 3	Loss: 0.020906
Client Index = 1	Epoch: 4	Loss: 0.015078
test acc on this client after 1330 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 2
local mask changes: 1911728.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2704906.0, 2690888.0, 1911728.0, 2680804.0, 2694118.0]
Doing local aggregation!
test acc on this client before 1336 / 2051 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.034882
Client Index = 2	Epoch: 1	Loss: 0.025489
Client Index = 2	Epoch: 2	Loss: 0.020258
Client Index = 2	Epoch: 3	Loss: 0.016478
Client Index = 2	Epoch: 4	Loss: 0.015337
test acc on this client after 1371 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 3
local mask changes: 1913114.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2704614.0, 2688604.0, 2698594.0, 1913114.0, 2694494.0]
Doing local aggregation!
test acc on this client before 1351 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.041797
Client Index = 3	Epoch: 1	Loss: 0.030505
Client Index = 3	Epoch: 2	Loss: 0.180693
Client Index = 3	Epoch: 3	Loss: 0.503611
Client Index = 3	Epoch: 4	Loss: 0.448510
test acc on this client after 1107 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 4
local mask changes: 1913130.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2639950.0, 2622170.0, 2635372.0, 2613562.0, 1913130.0]
Doing local aggregation!
test acc on this client before 1355 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.047774
Client Index = 4	Epoch: 1	Loss: 0.078894
Client Index = 4	Epoch: 2	Loss: 0.503785
Client Index = 4	Epoch: 3	Loss: 0.451279
Client Index = 4	Epoch: 4	Loss: 0.382467
test acc on this client after 1085 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.16000152472178547}
################local_test_on_all_clients after local training in communication round: 47
{'test_acc_after': 0.5880580129397692, 'test_loss_after': 1.8574466715273026}
################local_test_on_all_clients before local training in communication round: 47
{'test_acc_before': 0.655274863611347, 'test_loss_before': 1.4859919545259603}
################Communication round : 48
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 0
local mask changes: 1869998.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1869998.0, 2711000.0, 2695016.0, 2697098.0, 2651554.0]
Doing local aggregation!
test acc on this client before 1343 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.050311
Client Index = 0	Epoch: 1	Loss: 0.048044
Client Index = 0	Epoch: 2	Loss: 0.052146
Client Index = 0	Epoch: 3	Loss: 0.247419
Client Index = 0	Epoch: 4	Loss: 0.504112
test acc on this client after 1083 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 1
local mask changes: 1870306.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2593504.0, 1870306.0, 2670704.0, 2671056.0, 2621062.0]
Doing local aggregation!
test acc on this client before 1347 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.024378
Client Index = 1	Epoch: 1	Loss: 0.026117
Client Index = 1	Epoch: 2	Loss: 0.026484
Client Index = 1	Epoch: 3	Loss: 0.055560
Client Index = 1	Epoch: 4	Loss: 0.526586
test acc on this client after 1154 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 2
local mask changes: 1870036.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2576578.0, 2670926.0, 1870036.0, 2654162.0, 2605686.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.023711
Client Index = 2	Epoch: 1	Loss: 0.023765
Client Index = 2	Epoch: 2	Loss: 0.025574
Client Index = 2	Epoch: 3	Loss: 0.015411
Client Index = 2	Epoch: 4	Loss: 0.021672
test acc on this client after 1367 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 3
local mask changes: 1869990.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2693782.0, 2770542.0, 2757360.0, 1869990.0, 2718668.0]
Doing local aggregation!
test acc on this client before 1351 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.028045
Client Index = 3	Epoch: 1	Loss: 0.020391
Client Index = 3	Epoch: 2	Loss: 0.019218
Client Index = 3	Epoch: 3	Loss: 0.020992
Client Index = 3	Epoch: 4	Loss: 0.024619
test acc on this client after 1244 / 2049 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 4
local mask changes: 1871026.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2675372.0, 2756522.0, 2741472.0, 2742506.0, 1871026.0]
Doing local aggregation!
test acc on this client before 1358 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.033257
Client Index = 4	Epoch: 1	Loss: 0.023304
Client Index = 4	Epoch: 2	Loss: 0.020904
Client Index = 4	Epoch: 3	Loss: 0.026605
Client Index = 4	Epoch: 4	Loss: 0.029827
test acc on this client after 1302 / 2051 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07673809651427958}
################local_test_on_all_clients after local training in communication round: 48
{'test_acc_after': 0.6002075438915561, 'test_loss_after': 1.8146579614208966}
################local_test_on_all_clients before local training in communication round: 48
{'test_acc_before': 0.6635715155763753, 'test_loss_before': 1.4624706522308792}
################Communication round : 49
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 0
local mask changes: 1827504.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1827504.0, 2655382.0, 2648136.0, 2718564.0, 2712580.0]
Doing local aggregation!
test acc on this client before 1368 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.029409
Client Index = 0	Epoch: 1	Loss: 0.026895
Client Index = 0	Epoch: 2	Loss: 0.025853
Client Index = 0	Epoch: 3	Loss: 0.229836
Client Index = 0	Epoch: 4	Loss: 0.569269
test acc on this client after 1096 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 1
local mask changes: 1828620.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2643538.0, 1828620.0, 2601676.0, 2681538.0, 2672106.0]
Doing local aggregation!
test acc on this client before 1348 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.029148
Client Index = 1	Epoch: 1	Loss: 0.032765
Client Index = 1	Epoch: 2	Loss: 0.172219
Client Index = 1	Epoch: 3	Loss: 0.575831
Client Index = 1	Epoch: 4	Loss: 0.463588
test acc on this client after 1062 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 2
local mask changes: 1828168.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2571670.0, 2535864.0, 1828168.0, 2615482.0, 2607566.0]
Doing local aggregation!
test acc on this client before 1398 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.022696
Client Index = 2	Epoch: 1	Loss: 0.027043
Client Index = 2	Epoch: 2	Loss: 0.104607
Client Index = 2	Epoch: 3	Loss: 0.597173
Client Index = 2	Epoch: 4	Loss: 0.528501
test acc on this client after 1080 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 3
local mask changes: 1827370.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2634850.0, 2599312.0, 2592468.0, 1827370.0, 2667184.0]
Doing local aggregation!
test acc on this client before 1375 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.018197
Client Index = 3	Epoch: 1	Loss: 0.019000
Client Index = 3	Epoch: 2	Loss: 0.019062
Client Index = 3	Epoch: 3	Loss: 0.274373
Client Index = 3	Epoch: 4	Loss: 0.557287
test acc on this client after 1167 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 4
local mask changes: 1826928.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2630472.0, 2597052.0, 2588468.0, 2670100.0, 1826928.0]
Doing local aggregation!
test acc on this client before 1385 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.020080
Client Index = 4	Epoch: 1	Loss: 0.024127
Client Index = 4	Epoch: 2	Loss: 0.031684
Client Index = 4	Epoch: 3	Loss: 0.253945
Client Index = 4	Epoch: 4	Loss: 0.572031
test acc on this client after 1046 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.20898478529064404}
################local_test_on_all_clients after local training in communication round: 49
{'test_acc_after': 0.5320126395716234, 'test_loss_after': 2.0720956125248575}
################local_test_on_all_clients before local training in communication round: 49
{'test_acc_before': 0.670888780829303, 'test_loss_before': 1.4482600185162053}
################Communication round : 50
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 0
local mask changes: 1783514.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1783514.0, 2644544.0, 2598374.0, 2631938.0, 2629676.0]
Doing local aggregation!
test acc on this client before 1318 / 2050 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.049084
Client Index = 0	Epoch: 1	Loss: 0.118397
Client Index = 0	Epoch: 2	Loss: 0.434982
Client Index = 0	Epoch: 3	Loss: 0.442879
Client Index = 0	Epoch: 4	Loss: 0.243225
test acc on this client after 1119 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 1
local mask changes: 1783294.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2681484.0, 1783294.0, 2612446.0, 2643980.0, 2641712.0]
Doing local aggregation!
test acc on this client before 1327 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.039339
Client Index = 1	Epoch: 1	Loss: 0.034099
Client Index = 1	Epoch: 2	Loss: 0.040364
Client Index = 1	Epoch: 3	Loss: 0.038236
Client Index = 1	Epoch: 4	Loss: 0.481191
test acc on this client after 1134 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 2
local mask changes: 1783094.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2642368.0, 2617490.0, 1783094.0, 2598454.0, 2598076.0]
Doing local aggregation!
test acc on this client before 1368 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.046692
Client Index = 2	Epoch: 1	Loss: 0.031410
Client Index = 2	Epoch: 2	Loss: 0.058321
Client Index = 2	Epoch: 3	Loss: 0.409231
Client Index = 2	Epoch: 4	Loss: 0.489457
test acc on this client after 1155 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 3
local mask changes: 1782894.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2643562.0, 2616028.0, 2564796.0, 1782894.0, 2598232.0]
Doing local aggregation!
test acc on this client before 1343 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.046222
Client Index = 3	Epoch: 1	Loss: 0.055373
Client Index = 3	Epoch: 2	Loss: 0.067617
Client Index = 3	Epoch: 3	Loss: 0.469994
Client Index = 3	Epoch: 4	Loss: 0.451212
test acc on this client after 1126 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 4
local mask changes: 1784792.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2641902.0, 2616310.0, 2565898.0, 2602218.0, 1784792.0]
Doing local aggregation!
test acc on this client before 1370 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.043646
Client Index = 4	Epoch: 1	Loss: 0.038869
Client Index = 4	Epoch: 2	Loss: 0.043701
Client Index = 4	Epoch: 3	Loss: 0.045199
Client Index = 4	Epoch: 4	Loss: 0.505731
test acc on this client after 1127 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.18897877395837281}
################local_test_on_all_clients after local training in communication round: 50
{'test_acc_after': 0.5525082462936362, 'test_loss_after': 2.0016368548383583}
################local_test_on_all_clients before local training in communication round: 50
{'test_acc_before': 0.6564453640877632, 'test_loss_before': 1.4464136481262468}
################Communication round : 51
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 0
local mask changes: 1738776.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1738776.0, 2706564.0, 2685590.0, 2683022.0, 2683420.0]
Doing local aggregation!
test acc on this client before 1363 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.037861
Client Index = 0	Epoch: 1	Loss: 0.037356
Client Index = 0	Epoch: 2	Loss: 0.060171
Client Index = 0	Epoch: 3	Loss: 0.131741
Client Index = 0	Epoch: 4	Loss: 0.483762
test acc on this client after 1065 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 1
local mask changes: 1740292.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2644978.0, 1740292.0, 2638210.0, 2633266.0, 2632240.0]
Doing local aggregation!
test acc on this client before 1357 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.038910
Client Index = 1	Epoch: 1	Loss: 0.034987
Client Index = 1	Epoch: 2	Loss: 0.023042
Client Index = 1	Epoch: 3	Loss: 0.020812
Client Index = 1	Epoch: 4	Loss: 0.012799
test acc on this client after 1338 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 2
local mask changes: 1739634.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2661430.0, 2671970.0, 1739634.0, 2647312.0, 2646890.0]
Doing local aggregation!
test acc on this client before 1386 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.036726
Client Index = 2	Epoch: 1	Loss: 0.024428
Client Index = 2	Epoch: 2	Loss: 0.020862
Client Index = 2	Epoch: 3	Loss: 0.015373
Client Index = 2	Epoch: 4	Loss: 0.024868
test acc on this client after 1294 / 2051 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 3
local mask changes: 1740150.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2670566.0, 2680064.0, 2658924.0, 1740150.0, 2656154.0]
Doing local aggregation!
test acc on this client before 1354 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.047450
Client Index = 3	Epoch: 1	Loss: 0.034557
Client Index = 3	Epoch: 2	Loss: 0.031081
Client Index = 3	Epoch: 3	Loss: 0.021452
Client Index = 3	Epoch: 4	Loss: 0.018179
test acc on this client after 1342 / 2049 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 4
local mask changes: 1741702.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2629722.0, 2642128.0, 2620088.0, 2617762.0, 1741702.0]
Doing local aggregation!
test acc on this client before 1366 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.039786
Client Index = 4	Epoch: 1	Loss: 0.031892
Client Index = 4	Epoch: 2	Loss: 0.032235
Client Index = 4	Epoch: 3	Loss: 0.049283
Client Index = 4	Epoch: 4	Loss: 0.330080
test acc on this client after 1129 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.06558776289604756}
################local_test_on_all_clients after local training in communication round: 51
{'test_acc_after': 0.6020238997404779, 'test_loss_after': 1.7649905121667637}
################local_test_on_all_clients before local training in communication round: 51
{'test_acc_before': 0.6662084755187008, 'test_loss_before': 1.4544803875647148}
################Communication round : 52
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 0
local mask changes: 1695330.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1695330.0, 2661902.0, 2673406.0, 2682650.0, 2654210.0]
Doing local aggregation!
test acc on this client before 1339 / 2050 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.022615
Client Index = 0	Epoch: 1	Loss: 0.018685
Client Index = 0	Epoch: 2	Loss: 0.019869
Client Index = 0	Epoch: 3	Loss: 0.025466
Client Index = 0	Epoch: 4	Loss: 0.017421
test acc on this client after 1313 / 2050 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 1
local mask changes: 1696322.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2597634.0, 1696322.0, 2573604.0, 2577060.0, 2548148.0]
Doing local aggregation!
test acc on this client before 1358 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.021793
Client Index = 1	Epoch: 1	Loss: 0.025612
Client Index = 1	Epoch: 2	Loss: 0.024988
Client Index = 1	Epoch: 3	Loss: 0.427321
Client Index = 1	Epoch: 4	Loss: 0.549259
test acc on this client after 1113 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 2
local mask changes: 1695972.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2606758.0, 2569500.0, 1695972.0, 2588516.0, 2557922.0]
Doing local aggregation!
test acc on this client before 1413 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.022427
Client Index = 2	Epoch: 1	Loss: 0.015768
Client Index = 2	Epoch: 2	Loss: 0.033887
Client Index = 2	Epoch: 3	Loss: 0.314111
Client Index = 2	Epoch: 4	Loss: 0.557953
test acc on this client after 1170 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 3
local mask changes: 1696524.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2617180.0, 2576804.0, 2591474.0, 1696524.0, 2568624.0]
Doing local aggregation!
test acc on this client before 1353 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.015787
Client Index = 3	Epoch: 1	Loss: 0.014838
Client Index = 3	Epoch: 2	Loss: 0.012109
Client Index = 3	Epoch: 3	Loss: 0.358547
Client Index = 3	Epoch: 4	Loss: 0.505847
test acc on this client after 1070 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 4
local mask changes: 1697336.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2635670.0, 2597764.0, 2609618.0, 2618600.0, 1697336.0]
Doing local aggregation!
test acc on this client before 1380 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.029660
Client Index = 4	Epoch: 1	Loss: 0.109292
Client Index = 4	Epoch: 2	Loss: 0.515990
Client Index = 4	Epoch: 3	Loss: 0.483297
Client Index = 4	Epoch: 4	Loss: 0.294665
test acc on this client after 1040 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.17748840559292964}
################local_test_on_all_clients after local training in communication round: 52
{'test_acc_after': 0.5568942394330081, 'test_loss_after': 1.959156404037413}
################local_test_on_all_clients before local training in communication round: 52
{'test_acc_before': 0.6678652527573513, 'test_loss_before': 1.483049396077827}
################Communication round : 53
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 0
local mask changes: 1651532.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1651532.0, 2494446.0, 2501026.0, 2508056.0, 2525840.0]
Doing local aggregation!
test acc on this client before 1353 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.024043
Client Index = 0	Epoch: 1	Loss: 0.026350
Client Index = 0	Epoch: 2	Loss: 0.019954
Client Index = 0	Epoch: 3	Loss: 0.013919
Client Index = 0	Epoch: 4	Loss: 0.014399
test acc on this client after 1361 / 2050 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 1
local mask changes: 1650494.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2608968.0, 1650494.0, 2541632.0, 2547068.0, 2566518.0]
Doing local aggregation!
test acc on this client before 1337 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.042507
Client Index = 1	Epoch: 1	Loss: 0.170452
Client Index = 1	Epoch: 2	Loss: 0.475964
Client Index = 1	Epoch: 3	Loss: 0.393880
Client Index = 1	Epoch: 4	Loss: 0.317382
test acc on this client after 1090 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 2
local mask changes: 1650430.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2602582.0, 2530140.0, 1650430.0, 2539224.0, 2557836.0]
Doing local aggregation!
test acc on this client before 1373 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.041459
Client Index = 2	Epoch: 1	Loss: 0.163365
Client Index = 2	Epoch: 2	Loss: 0.478566
Client Index = 2	Epoch: 3	Loss: 0.393423
Client Index = 2	Epoch: 4	Loss: 0.345978
test acc on this client after 1137 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 3
local mask changes: 1652858.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2606030.0, 2532836.0, 2537426.0, 1652858.0, 2565806.0]
Doing local aggregation!
test acc on this client before 1342 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.035495
Client Index = 3	Epoch: 1	Loss: 0.031561
Client Index = 3	Epoch: 2	Loss: 0.024566
Client Index = 3	Epoch: 3	Loss: 0.035867
Client Index = 3	Epoch: 4	Loss: 0.456313
test acc on this client after 1039 / 2049 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 4
local mask changes: 1652070.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2661418.0, 2594198.0, 2598834.0, 2603704.0, 1652070.0]
Doing local aggregation!
test acc on this client before 1349 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.028812
Client Index = 4	Epoch: 1	Loss: 0.025869
Client Index = 4	Epoch: 2	Loss: 0.020045
Client Index = 4	Epoch: 3	Loss: 0.024499
Client Index = 4	Epoch: 4	Loss: 0.017557
test acc on this client after 1371 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.14488900282163628}
################local_test_on_all_clients after local training in communication round: 53
{'test_acc_after': 0.5853609068448845, 'test_loss_after': 1.8884264649807263}
################local_test_on_all_clients before local training in communication round: 53
{'test_acc_before': 0.6591801702250754, 'test_loss_before': 1.4731911252018506}
################Communication round : 54
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 0
local mask changes: 1606704.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1606704.0, 2469440.0, 2464546.0, 2467568.0, 2510978.0]
Doing local aggregation!
test acc on this client before 1391 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.024944
Client Index = 0	Epoch: 1	Loss: 0.023002
Client Index = 0	Epoch: 2	Loss: 0.105856
Client Index = 0	Epoch: 3	Loss: 0.473158
Client Index = 0	Epoch: 4	Loss: 0.474995
test acc on this client after 1080 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 1
local mask changes: 1605432.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2599534.0, 1605432.0, 2626146.0, 2627224.0, 2662554.0]
Doing local aggregation!
test acc on this client before 1364 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.027885
Client Index = 1	Epoch: 1	Loss: 0.028865
Client Index = 1	Epoch: 2	Loss: 0.046872
Client Index = 1	Epoch: 3	Loss: 0.405899
Client Index = 1	Epoch: 4	Loss: 0.475729
test acc on this client after 1091 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 2
local mask changes: 1605922.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2596538.0, 2628118.0, 1605922.0, 2624540.0, 2660298.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.024163
Client Index = 2	Epoch: 1	Loss: 0.021901
Client Index = 2	Epoch: 2	Loss: 0.017889
Client Index = 2	Epoch: 3	Loss: 0.015918
Client Index = 2	Epoch: 4	Loss: 0.017174
test acc on this client after 1387 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 3
local mask changes: 1606310.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2521212.0, 2553720.0, 2549534.0, 1606310.0, 2589952.0]
Doing local aggregation!
test acc on this client before 1357 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.022614
Client Index = 3	Epoch: 1	Loss: 0.030650
Client Index = 3	Epoch: 2	Loss: 0.084121
Client Index = 3	Epoch: 3	Loss: 0.471525
Client Index = 3	Epoch: 4	Loss: 0.485202
test acc on this client after 1151 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 4
local mask changes: 1606778.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2495220.0, 2532204.0, 2526110.0, 2528904.0, 1606778.0]
Doing local aggregation!
test acc on this client before 1379 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.020993
Client Index = 4	Epoch: 1	Loss: 0.014819
Client Index = 4	Epoch: 2	Loss: 0.014066
Client Index = 4	Epoch: 3	Loss: 0.010799
Client Index = 4	Epoch: 4	Loss: 0.015241
test acc on this client after 1372 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.13417121957436356}
################local_test_on_all_clients after local training in communication round: 54
{'test_acc_after': 0.593452099671301, 'test_loss_after': 1.8112469464522143}
################local_test_on_all_clients before local training in communication round: 54
{'test_acc_before': 0.6725504671999862, 'test_loss_before': 1.480961614317374}
################Communication round : 55
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 0
local mask changes: 1560152.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1560152.0, 2580550.0, 2580974.0, 2523890.0, 2500850.0]
Doing local aggregation!
test acc on this client before 1360 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.024234
Client Index = 0	Epoch: 1	Loss: 0.019769
Client Index = 0	Epoch: 2	Loss: 0.035324
Client Index = 0	Epoch: 3	Loss: 0.202400
Client Index = 0	Epoch: 4	Loss: 0.492430
test acc on this client after 1133 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 1
local mask changes: 1561752.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2557326.0, 1561752.0, 2653880.0, 2603862.0, 2588492.0]
Doing local aggregation!
test acc on this client before 1351 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.019776
Client Index = 1	Epoch: 1	Loss: 0.014285
Client Index = 1	Epoch: 2	Loss: 0.012336
Client Index = 1	Epoch: 3	Loss: 0.009756
Client Index = 1	Epoch: 4	Loss: 0.008634
test acc on this client after 1368 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 2
local mask changes: 1559678.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2447456.0, 2564130.0, 1559678.0, 2504582.0, 2483424.0]
Doing local aggregation!
test acc on this client before 1408 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.018154
Client Index = 2	Epoch: 1	Loss: 0.015051
Client Index = 2	Epoch: 2	Loss: 0.016770
Client Index = 2	Epoch: 3	Loss: 0.016460
Client Index = 2	Epoch: 4	Loss: 0.014173
test acc on this client after 1400 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 3
local mask changes: 1560528.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2513814.0, 2619708.0, 2618522.0, 1560528.0, 2547426.0]
Doing local aggregation!
test acc on this client before 1359 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.022537
Client Index = 3	Epoch: 1	Loss: 0.017419
Client Index = 3	Epoch: 2	Loss: 0.017525
Client Index = 3	Epoch: 3	Loss: 0.026546
Client Index = 3	Epoch: 4	Loss: 0.014196
test acc on this client after 1339 / 2049 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 4
local mask changes: 1560896.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2367968.0, 2502066.0, 2499976.0, 2436550.0, 1560896.0]
Doing local aggregation!
test acc on this client before 1397 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.020745
Client Index = 4	Epoch: 1	Loss: 0.026035
Client Index = 4	Epoch: 2	Loss: 0.034596
Client Index = 4	Epoch: 3	Loss: 0.370264
Client Index = 4	Epoch: 4	Loss: 0.503947
test acc on this client after 1097 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.0789345257923159}
################local_test_on_all_clients after local training in communication round: 55
{'test_acc_after': 0.6185151978422743, 'test_loss_after': 1.7093634961371387}
################local_test_on_all_clients before local training in communication round: 55
{'test_acc_before': 0.6709852491025978, 'test_loss_before': 1.4344937449704283}
################Communication round : 56
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 0
local mask changes: 1515730.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1515730.0, 2575792.0, 2506670.0, 2552750.0, 2465184.0]
Doing local aggregation!
test acc on this client before 1393 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.020916
Client Index = 0	Epoch: 1	Loss: 0.061249
Client Index = 0	Epoch: 2	Loss: 0.467363
Client Index = 0	Epoch: 3	Loss: 0.465934
Client Index = 0	Epoch: 4	Loss: 0.372305
test acc on this client after 1172 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 1
local mask changes: 1513458.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2487752.0, 1513458.0, 2457774.0, 2511240.0, 2414874.0]
Doing local aggregation!
test acc on this client before 1371 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.014882
Client Index = 1	Epoch: 1	Loss: 0.023828
Client Index = 1	Epoch: 2	Loss: 0.061009
Client Index = 1	Epoch: 3	Loss: 0.498019
Client Index = 1	Epoch: 4	Loss: 0.465888
test acc on this client after 1030 / 2045 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 2
local mask changes: 1514874.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2428462.0, 2482946.0, 1514874.0, 2456826.0, 2350178.0]
Doing local aggregation!
test acc on this client before 1428 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.015430
Client Index = 2	Epoch: 1	Loss: 0.011538
Client Index = 2	Epoch: 2	Loss: 0.009467
Client Index = 2	Epoch: 3	Loss: 0.013563
Client Index = 2	Epoch: 4	Loss: 0.012750
test acc on this client after 1393 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 3
local mask changes: 1514126.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2469498.0, 2520600.0, 2441980.0, 1514126.0, 2400722.0]
Doing local aggregation!
test acc on this client before 1383 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.022666
Client Index = 3	Epoch: 1	Loss: 0.020379
Client Index = 3	Epoch: 2	Loss: 0.023840
Client Index = 3	Epoch: 3	Loss: 0.431889
Client Index = 3	Epoch: 4	Loss: 0.534529
test acc on this client after 1100 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 4
local mask changes: 1515494.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2494248.0, 2543924.0, 2464862.0, 2521604.0, 1515494.0]
Doing local aggregation!
test acc on this client before 1384 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.022230
Client Index = 4	Epoch: 1	Loss: 0.024278
Client Index = 4	Epoch: 2	Loss: 0.067690
Client Index = 4	Epoch: 3	Loss: 0.534091
Client Index = 4	Epoch: 4	Loss: 0.495921
test acc on this client after 1160 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1876660344472193}
################local_test_on_all_clients after local training in communication round: 56
{'test_acc_after': 0.5713961391216152, 'test_loss_after': 1.9310447017332302}
################local_test_on_all_clients before local training in communication round: 56
{'test_acc_before': 0.679185951523765, 'test_loss_before': 1.4169956825094863}
################Communication round : 57
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 0
local mask changes: 1469104.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1469104.0, 2534714.0, 2504020.0, 2523222.0, 2547648.0]
Doing local aggregation!
test acc on this client before 1367 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.025173
Client Index = 0	Epoch: 1	Loss: 0.026287
Client Index = 0	Epoch: 2	Loss: 0.020168
Client Index = 0	Epoch: 3	Loss: 0.014096
Client Index = 0	Epoch: 4	Loss: 0.010697
test acc on this client after 1369 / 2050 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 1
local mask changes: 1468734.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2517516.0, 1468734.0, 2446148.0, 2470606.0, 2500646.0]
Doing local aggregation!
test acc on this client before 1337 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.027503
Client Index = 1	Epoch: 1	Loss: 0.018576
Client Index = 1	Epoch: 2	Loss: 0.027769
Client Index = 1	Epoch: 3	Loss: 0.019534
Client Index = 1	Epoch: 4	Loss: 0.028820
test acc on this client after 1329 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 2
local mask changes: 1467624.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2370694.0, 2323424.0, 1467624.0, 2310382.0, 2346536.0]
Doing local aggregation!
test acc on this client before 1413 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.024618
Client Index = 2	Epoch: 1	Loss: 0.032481
Client Index = 2	Epoch: 2	Loss: 0.233445
Client Index = 2	Epoch: 3	Loss: 0.502318
Client Index = 2	Epoch: 4	Loss: 0.406312
test acc on this client after 1093 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 3
local mask changes: 1468060.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2497046.0, 2462580.0, 2427994.0, 1468060.0, 2483376.0]
Doing local aggregation!
test acc on this client before 1355 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.040395
Client Index = 3	Epoch: 1	Loss: 0.045852
Client Index = 3	Epoch: 2	Loss: 0.022684
Client Index = 3	Epoch: 3	Loss: 0.041057
Client Index = 3	Epoch: 4	Loss: 0.420871
test acc on this client after 1087 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 4
local mask changes: 1467708.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2523942.0, 2492412.0, 2461262.0, 2482526.0, 1467708.0]
Doing local aggregation!
test acc on this client before 1363 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.030748
Client Index = 4	Epoch: 1	Loss: 0.022720
Client Index = 4	Epoch: 2	Loss: 0.016110
Client Index = 4	Epoch: 3	Loss: 0.013470
Client Index = 4	Epoch: 4	Loss: 0.010289
test acc on this client after 1394 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.08327968545761719}
################local_test_on_all_clients after local training in communication round: 57
{'test_acc_after': 0.6121529085080633, 'test_loss_after': 1.7693016045931056}
################local_test_on_all_clients before local training in communication round: 57
{'test_acc_before': 0.6670806595848935, 'test_loss_before': 1.463566010640959}
################Communication round : 58
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 0
local mask changes: 1422252.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1422252.0, 2463740.0, 2356608.0, 2451262.0, 2466150.0]
Doing local aggregation!
test acc on this client before 1387 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.014338
Client Index = 0	Epoch: 1	Loss: 0.011270
Client Index = 0	Epoch: 2	Loss: 0.010948
Client Index = 0	Epoch: 3	Loss: 0.012474
Client Index = 0	Epoch: 4	Loss: 0.009492
test acc on this client after 1378 / 2050 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 1
local mask changes: 1422384.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2476354.0, 1422384.0, 2333084.0, 2430614.0, 2445664.0]
Doing local aggregation!
test acc on this client before 1370 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.016738
Client Index = 1	Epoch: 1	Loss: 0.017050
Client Index = 1	Epoch: 2	Loss: 0.015905
Client Index = 1	Epoch: 3	Loss: 0.015573
Client Index = 1	Epoch: 4	Loss: 0.483897
test acc on this client after 1184 / 2045 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 2
local mask changes: 1422634.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2502840.0, 2473232.0, 1422634.0, 2458480.0, 2473230.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.028370
Client Index = 2	Epoch: 1	Loss: 0.028990
Client Index = 2	Epoch: 2	Loss: 0.448980
Client Index = 2	Epoch: 3	Loss: 0.512141
Client Index = 2	Epoch: 4	Loss: 0.422940
test acc on this client after 1119 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 3
local mask changes: 1421996.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2522430.0, 2492500.0, 2391016.0, 1421996.0, 2494724.0]
Doing local aggregation!
test acc on this client before 1378 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.018786
Client Index = 3	Epoch: 1	Loss: 0.023786
Client Index = 3	Epoch: 2	Loss: 0.340525
Client Index = 3	Epoch: 3	Loss: 0.516047
Client Index = 3	Epoch: 4	Loss: 0.448038
test acc on this client after 1050 / 2049 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 4
local mask changes: 1422572.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2469290.0, 2437252.0, 2324844.0, 2423290.0, 1422572.0]
Doing local aggregation!
test acc on this client before 1405 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.016800
Client Index = 4	Epoch: 1	Loss: 0.018385
Client Index = 4	Epoch: 2	Loss: 0.152672
Client Index = 4	Epoch: 3	Loss: 0.520106
Client Index = 4	Epoch: 4	Loss: 0.490130
test acc on this client after 1091 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.18377527104681168}
################local_test_on_all_clients after local training in communication round: 58
{'test_acc_after': 0.5682272963376982, 'test_loss_after': 1.925645541778503}
################local_test_on_all_clients before local training in communication round: 58
{'test_acc_before': 0.6773321493546695, 'test_loss_before': 1.4203387260258147}
################Communication round : 59
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 0
local mask changes: 1375178.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1375178.0, 2302042.0, 2343138.0, 2351180.0, 2294720.0]
Doing local aggregation!
test acc on this client before 1376 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.025340
Client Index = 0	Epoch: 1	Loss: 0.020587
Client Index = 0	Epoch: 2	Loss: 0.023469
Client Index = 0	Epoch: 3	Loss: 0.020979
Client Index = 0	Epoch: 4	Loss: 0.236438
test acc on this client after 1082 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 1
local mask changes: 1374850.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2376892.0, 1374850.0, 2401122.0, 2407200.0, 2359144.0]
Doing local aggregation!
test acc on this client before 1367 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.029988
Client Index = 1	Epoch: 1	Loss: 0.034248
Client Index = 1	Epoch: 2	Loss: 0.042507
Client Index = 1	Epoch: 3	Loss: 0.338348
Client Index = 1	Epoch: 4	Loss: 0.449726
test acc on this client after 1115 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 2
local mask changes: 1375130.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2484782.0, 2475096.0, 1375130.0, 2505682.0, 2467310.0]
Doing local aggregation!
test acc on this client before 1375 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.029184
Client Index = 2	Epoch: 1	Loss: 0.054283
Client Index = 2	Epoch: 2	Loss: 0.069002
Client Index = 2	Epoch: 3	Loss: 0.445542
Client Index = 2	Epoch: 4	Loss: 0.434071
test acc on this client after 1176 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 3
local mask changes: 1375494.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2487322.0, 2476018.0, 2502048.0, 1375494.0, 2469580.0]
Doing local aggregation!
test acc on this client before 1362 / 2049 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.025427
Client Index = 3	Epoch: 1	Loss: 0.021733
Client Index = 3	Epoch: 2	Loss: 0.015792
Client Index = 3	Epoch: 3	Loss: 0.014903
Client Index = 3	Epoch: 4	Loss: 0.011393
test acc on this client after 1368 / 2049 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 4
local mask changes: 1375844.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2432336.0, 2420004.0, 2453472.0, 2460812.0, 1375844.0]
Doing local aggregation!
test acc on this client before 1369 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.026900
Client Index = 4	Epoch: 1	Loss: 0.022392
Client Index = 4	Epoch: 2	Loss: 0.016066
Client Index = 4	Epoch: 3	Loss: 0.013291
Client Index = 4	Epoch: 4	Loss: 0.012844
test acc on this client after 1374 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.09737813698298928}
################local_test_on_all_clients after local training in communication round: 59
{'test_acc_after': 0.5967951715286401, 'test_loss_after': 1.822364384131193}
################local_test_on_all_clients before local training in communication round: 59
{'test_acc_before': 0.6684555247633502, 'test_loss_before': 1.4306624626718454}
################Communication round : 60
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 0
local mask changes: 1328746.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1328746.0, 2310740.0, 2387022.0, 2392494.0, 2356098.0]
Doing local aggregation!
test acc on this client before 1364 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.029262
Client Index = 0	Epoch: 1	Loss: 0.183178
Client Index = 0	Epoch: 2	Loss: 0.466659
Client Index = 0	Epoch: 3	Loss: 0.447899
Client Index = 0	Epoch: 4	Loss: 0.392736
test acc on this client after 1165 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 1
local mask changes: 1327392.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2370142.0, 1327392.0, 2478880.0, 2482428.0, 2451782.0]
Doing local aggregation!
test acc on this client before 1368 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.022267
Client Index = 1	Epoch: 1	Loss: 0.021807
Client Index = 1	Epoch: 2	Loss: 0.024798
Client Index = 1	Epoch: 3	Loss: 0.020289
Client Index = 1	Epoch: 4	Loss: 0.406658
test acc on this client after 1109 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 2
local mask changes: 1327632.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2450032.0, 2484656.0, 1327632.0, 2548076.0, 2518582.0]
Doing local aggregation!
test acc on this client before 1381 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.018954
Client Index = 2	Epoch: 1	Loss: 0.014775
Client Index = 2	Epoch: 2	Loss: 0.016339
Client Index = 2	Epoch: 3	Loss: 0.012499
Client Index = 2	Epoch: 4	Loss: 0.011414
test acc on this client after 1403 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 3
local mask changes: 1328724.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2330386.0, 2374230.0, 2446198.0, 1328724.0, 2414472.0]
Doing local aggregation!
test acc on this client before 1383 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.017255
Client Index = 3	Epoch: 1	Loss: 0.013245
Client Index = 3	Epoch: 2	Loss: 0.023912
Client Index = 3	Epoch: 3	Loss: 0.021119
Client Index = 3	Epoch: 4	Loss: 0.464780
test acc on this client after 1062 / 2049 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 4
local mask changes: 1328362.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2295000.0, 2340480.0, 2416990.0, 2419510.0, 1328362.0]
Doing local aggregation!
test acc on this client before 1392 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.018736
Client Index = 4	Epoch: 1	Loss: 0.018944
Client Index = 4	Epoch: 2	Loss: 0.158961
Client Index = 4	Epoch: 3	Loss: 0.480527
Client Index = 4	Epoch: 4	Loss: 0.458827
test acc on this client after 1115 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.15063362491497656}
################local_test_on_all_clients after local training in communication round: 60
{'test_acc_after': 0.57131727797514, 'test_loss_after': 1.9277049846090606}
################local_test_on_all_clients before local training in communication round: 60
{'test_acc_before': 0.6722602617824239, 'test_loss_before': 1.4386868370769712}
################Communication round : 61
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 0
local mask changes: 1281308.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1281308.0, 2443018.0, 2486848.0, 2409850.0, 2389142.0]
Doing local aggregation!
test acc on this client before 1358 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.033101
Client Index = 0	Epoch: 1	Loss: 0.045012
Client Index = 0	Epoch: 2	Loss: 0.361235
Client Index = 0	Epoch: 3	Loss: 0.409623
Client Index = 0	Epoch: 4	Loss: 0.417021
test acc on this client after 1159 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 1
local mask changes: 1281118.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2337846.0, 1281118.0, 2451552.0, 2372886.0, 2353378.0]
Doing local aggregation!
test acc on this client before 1341 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.026308
Client Index = 1	Epoch: 1	Loss: 0.023262
Client Index = 1	Epoch: 2	Loss: 0.032258
Client Index = 1	Epoch: 3	Loss: 0.071039
Client Index = 1	Epoch: 4	Loss: 0.496793
test acc on this client after 1119 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 2
local mask changes: 1281844.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2319628.0, 2392188.0, 1281844.0, 2354252.0, 2332094.0]
Doing local aggregation!
test acc on this client before 1406 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.019057
Client Index = 2	Epoch: 1	Loss: 0.012463
Client Index = 2	Epoch: 2	Loss: 0.016922
Client Index = 2	Epoch: 3	Loss: 0.015435
Client Index = 2	Epoch: 4	Loss: 0.009521
test acc on this client after 1395 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 3
local mask changes: 1281812.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2316684.0, 2386774.0, 2435380.0, 1281812.0, 2327988.0]
Doing local aggregation!
test acc on this client before 1373 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.023128
Client Index = 3	Epoch: 1	Loss: 0.018755
Client Index = 3	Epoch: 2	Loss: 0.015455
Client Index = 3	Epoch: 3	Loss: 0.019331
Client Index = 3	Epoch: 4	Loss: 0.016144
test acc on this client after 1344 / 2049 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 4
local mask changes: 1281164.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2357154.0, 2426378.0, 2470334.0, 2388732.0, 1281164.0]
Doing local aggregation!
test acc on this client before 1375 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.037278
Client Index = 4	Epoch: 1	Loss: 0.043985
Client Index = 4	Epoch: 2	Loss: 0.204689
Client Index = 4	Epoch: 3	Loss: 0.476828
Client Index = 4	Epoch: 4	Loss: 0.432497
test acc on this client after 1104 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1310855061253913}
################local_test_on_all_clients after local training in communication round: 61
{'test_acc_after': 0.5973827747324858, 'test_loss_after': 1.8032769916036042}
################local_test_on_all_clients before local training in communication round: 61
{'test_acc_before': 0.6688383305008895, 'test_loss_before': 1.4472956135558204}
################Communication round : 62
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 0
local mask changes: 1234234.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1234234.0, 2464842.0, 2455606.0, 2457772.0, 2484112.0]
Doing local aggregation!
test acc on this client before 1363 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.020914
Client Index = 0	Epoch: 1	Loss: 0.015452
Client Index = 0	Epoch: 2	Loss: 0.011943
Client Index = 0	Epoch: 3	Loss: 0.022937
Client Index = 0	Epoch: 4	Loss: 0.364823
test acc on this client after 1024 / 2050 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 1
local mask changes: 1234304.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2411684.0, 1234304.0, 2362604.0, 2366648.0, 2400978.0]
Doing local aggregation!
test acc on this client before 1356 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.029083
Client Index = 1	Epoch: 1	Loss: 0.020643
Client Index = 1	Epoch: 2	Loss: 0.022856
Client Index = 1	Epoch: 3	Loss: 0.353345
Client Index = 1	Epoch: 4	Loss: 0.474654
test acc on this client after 1055 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 2
local mask changes: 1234230.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2330524.0, 2290036.0, 1234230.0, 2278640.0, 2312980.0]
Doing local aggregation!
test acc on this client before 1408 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.016307
Client Index = 2	Epoch: 1	Loss: 0.016579
Client Index = 2	Epoch: 2	Loss: 0.093842
Client Index = 2	Epoch: 3	Loss: 0.471088
Client Index = 2	Epoch: 4	Loss: 0.462662
test acc on this client after 1142 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 3
local mask changes: 1235412.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2334814.0, 2292348.0, 2275488.0, 1235412.0, 2317674.0]
Doing local aggregation!
test acc on this client before 1380 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.023002
Client Index = 3	Epoch: 1	Loss: 0.022532
Client Index = 3	Epoch: 2	Loss: 0.039698
Client Index = 3	Epoch: 3	Loss: 0.355551
Client Index = 3	Epoch: 4	Loss: 0.491691
test acc on this client after 1115 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 4
local mask changes: 1233832.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2476050.0, 2446026.0, 2433628.0, 2436990.0, 1233832.0]
Doing local aggregation!
test acc on this client before 1405 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.022360
Client Index = 4	Epoch: 1	Loss: 0.013176
Client Index = 4	Epoch: 2	Loss: 0.048352
Client Index = 4	Epoch: 3	Loss: 0.448649
Client Index = 4	Epoch: 4	Loss: 0.448511
test acc on this client after 1020 / 2051 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1724260618100513}
################local_test_on_all_clients after local training in communication round: 62
{'test_acc_after': 0.522738488785168, 'test_loss_after': 2.2120898785520966}
################local_test_on_all_clients before local training in communication round: 62
{'test_acc_before': 0.6745968172298615, 'test_loss_before': 1.4451683782644713}
################Communication round : 63
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 0
local mask changes: 1186230.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1186230.0, 2405270.0, 2351988.0, 2352418.0, 2452080.0]
Doing local aggregation!
test acc on this client before 1316 / 2050 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.026986
Client Index = 0	Epoch: 1	Loss: 0.025546
Client Index = 0	Epoch: 2	Loss: 0.021097
Client Index = 0	Epoch: 3	Loss: 0.077557
Client Index = 0	Epoch: 4	Loss: 0.430931
test acc on this client after 1123 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 1
local mask changes: 1187454.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2453820.0, 1187454.0, 2339716.0, 2338276.0, 2443042.0]
Doing local aggregation!
test acc on this client before 1331 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.030252
Client Index = 1	Epoch: 1	Loss: 0.018800
Client Index = 1	Epoch: 2	Loss: 0.010830
Client Index = 1	Epoch: 3	Loss: 0.012832
Client Index = 1	Epoch: 4	Loss: 0.023965
test acc on this client after 1334 / 2045 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 2
local mask changes: 1186922.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2423932.0, 2359680.0, 1186922.0, 2292824.0, 2410112.0]
Doing local aggregation!
test acc on this client before 1374 / 2051 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.030693
Client Index = 2	Epoch: 1	Loss: 0.040298
Client Index = 2	Epoch: 2	Loss: 0.156614
Client Index = 2	Epoch: 3	Loss: 0.413682
Client Index = 2	Epoch: 4	Loss: 0.407507
test acc on this client after 1192 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 3
local mask changes: 1186500.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2414702.0, 2346912.0, 2280482.0, 1186500.0, 2398716.0]
Doing local aggregation!
test acc on this client before 1341 / 2049 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.039463
Client Index = 3	Epoch: 1	Loss: 0.044355
Client Index = 3	Epoch: 2	Loss: 0.232731
Client Index = 3	Epoch: 3	Loss: 0.435349
Client Index = 3	Epoch: 4	Loss: 0.357803
test acc on this client after 1123 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 4
local mask changes: 1186080.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2500224.0, 2444740.0, 2391026.0, 2391334.0, 1186080.0]
Doing local aggregation!
test acc on this client before 1368 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.035220
Client Index = 4	Epoch: 1	Loss: 0.028356
Client Index = 4	Epoch: 2	Loss: 0.034261
Client Index = 4	Epoch: 3	Loss: 0.030413
Client Index = 4	Epoch: 4	Loss: 0.228702
test acc on this client after 1141 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.12776963452219353}
################local_test_on_all_clients after local training in communication round: 63
{'test_acc_after': 0.5771387504406709, 'test_loss_after': 1.9016942180177197}
################local_test_on_all_clients before local training in communication round: 63
{'test_acc_before': 0.6568362766338162, 'test_loss_before': 1.4908411383789415}
################Communication round : 64
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 0
local mask changes: 1139632.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1139632.0, 2396364.0, 2380632.0, 2373420.0, 2428924.0]
Doing local aggregation!
test acc on this client before 1365 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.019503
Client Index = 0	Epoch: 1	Loss: 0.013989
Client Index = 0	Epoch: 2	Loss: 0.022298
Client Index = 0	Epoch: 3	Loss: 0.014640
Client Index = 0	Epoch: 4	Loss: 0.017239
test acc on this client after 1372 / 2050 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 1
local mask changes: 1140518.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2325048.0, 1140518.0, 2307478.0, 2297102.0, 2361210.0]
Doing local aggregation!
test acc on this client before 1354 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.017733
Client Index = 1	Epoch: 1	Loss: 0.013863
Client Index = 1	Epoch: 2	Loss: 0.013794
Client Index = 1	Epoch: 3	Loss: 0.030212
Client Index = 1	Epoch: 4	Loss: 0.423114
test acc on this client after 1044 / 2045 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 2
local mask changes: 1139032.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2422624.0, 2423080.0, 1139032.0, 2394082.0, 2453158.0]
Doing local aggregation!
test acc on this client before 1397 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.031441
Client Index = 2	Epoch: 1	Loss: 0.030943
Client Index = 2	Epoch: 2	Loss: 0.023811
Client Index = 2	Epoch: 3	Loss: 0.029666
Client Index = 2	Epoch: 4	Loss: 0.028666
test acc on this client after 1344 / 2051 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 3
local mask changes: 1140222.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2421730.0, 2421176.0, 2401718.0, 1140222.0, 2451084.0]
Doing local aggregation!
test acc on this client before 1367 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.023268
Client Index = 3	Epoch: 1	Loss: 0.019221
Client Index = 3	Epoch: 2	Loss: 0.023789
Client Index = 3	Epoch: 3	Loss: 0.019791
Client Index = 3	Epoch: 4	Loss: 0.020442
test acc on this client after 1313 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 4
local mask changes: 1140576.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2399624.0, 2399872.0, 2382342.0, 2371680.0, 1140576.0]
Doing local aggregation!
test acc on this client before 1373 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.020941
Client Index = 4	Epoch: 1	Loss: 0.012856
Client Index = 4	Epoch: 2	Loss: 0.011470
Client Index = 4	Epoch: 3	Loss: 0.009025
Client Index = 4	Epoch: 4	Loss: 0.011708
test acc on this client after 1375 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.03613691894209241}
################local_test_on_all_clients after local training in communication round: 64
{'test_acc_after': 0.629255382716543, 'test_loss_after': 1.6902931960435237}
################local_test_on_all_clients before local training in communication round: 64
{'test_acc_before': 0.6691343519468245, 'test_loss_before': 1.4629592006856122}
################Communication round : 65
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 0
local mask changes: 1092526.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1092526.0, 2241058.0, 2328676.0, 2327850.0, 2300086.0]
Doing local aggregation!
test acc on this client before 1386 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.010361
Client Index = 0	Epoch: 1	Loss: 0.010648
Client Index = 0	Epoch: 2	Loss: 0.010324
Client Index = 0	Epoch: 3	Loss: 0.010352
Client Index = 0	Epoch: 4	Loss: 0.009249
test acc on this client after 1369 / 2050 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 1
local mask changes: 1092498.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2313866.0, 1092498.0, 2337956.0, 2337130.0, 2313138.0]
Doing local aggregation!
test acc on this client before 1357 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.017567
Client Index = 1	Epoch: 1	Loss: 0.032964
Client Index = 1	Epoch: 2	Loss: 0.471929
Client Index = 1	Epoch: 3	Loss: 0.468057
Client Index = 1	Epoch: 4	Loss: 0.475402
test acc on this client after 1065 / 2045 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 2
local mask changes: 1093568.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2333704.0, 2278390.0, 1093568.0, 2357610.0, 2331250.0]
Doing local aggregation!
test acc on this client before 1417 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.008836
Client Index = 2	Epoch: 1	Loss: 0.007063
Client Index = 2	Epoch: 2	Loss: 0.008628
Client Index = 2	Epoch: 3	Loss: 0.008162
Client Index = 2	Epoch: 4	Loss: 0.005794
test acc on this client after 1422 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 3
local mask changes: 1093072.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2325410.0, 2266770.0, 2349448.0, 1093072.0, 2323308.0]
Doing local aggregation!
test acc on this client before 1389 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.008381
Client Index = 3	Epoch: 1	Loss: 0.008310
Client Index = 3	Epoch: 2	Loss: 0.013609
Client Index = 3	Epoch: 3	Loss: 0.026077
Client Index = 3	Epoch: 4	Loss: 0.397450
test acc on this client after 1132 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 4
local mask changes: 1092408.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2297592.0, 2236596.0, 2321488.0, 2320856.0, 1092408.0]
Doing local aggregation!
test acc on this client before 1407 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.011741
Client Index = 4	Epoch: 1	Loss: 0.015562
Client Index = 4	Epoch: 2	Loss: 0.014897
Client Index = 4	Epoch: 3	Loss: 0.016125
Client Index = 4	Epoch: 4	Loss: 0.114889
test acc on this client after 1109 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.08729511682086682}
################local_test_on_all_clients after local training in communication round: 65
{'test_acc_after': 0.5950168140895513, 'test_loss_after': 1.809581564869656}
################local_test_on_all_clients before local training in communication round: 65
{'test_acc_before': 0.6788896439749212, 'test_loss_before': 1.4383062999954157}
################Communication round : 66
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 0
local mask changes: 1045790.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1045790.0, 2168222.0, 2175900.0, 2167810.0, 2143054.0]
Doing local aggregation!
test acc on this client before 1355 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.024233
Client Index = 0	Epoch: 1	Loss: 0.022116
Client Index = 0	Epoch: 2	Loss: 0.137421
Client Index = 0	Epoch: 3	Loss: 0.534709
Client Index = 0	Epoch: 4	Loss: 0.497350
test acc on this client after 1035 / 2050 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 1
local mask changes: 1046000.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2322918.0, 1046000.0, 2342988.0, 2336738.0, 2320394.0]
Doing local aggregation!
test acc on this client before 1334 / 2045 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.016709
Client Index = 1	Epoch: 1	Loss: 0.015828
Client Index = 1	Epoch: 2	Loss: 0.011845
Client Index = 1	Epoch: 3	Loss: 0.017796
Client Index = 1	Epoch: 4	Loss: 0.109354
test acc on this client after 1036 / 2045 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 2
local mask changes: 1045696.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2163338.0, 2186112.0, 1045696.0, 2184452.0, 2161622.0]
Doing local aggregation!
test acc on this client before 1407 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.016062
Client Index = 2	Epoch: 1	Loss: 0.014128
Client Index = 2	Epoch: 2	Loss: 0.020064
Client Index = 2	Epoch: 3	Loss: 0.231758
Client Index = 2	Epoch: 4	Loss: 0.522259
test acc on this client after 1161 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 3
local mask changes: 1045472.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2229182.0, 2245970.0, 2253170.0, 1045472.0, 2225072.0]
Doing local aggregation!
test acc on this client before 1377 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.016486
Client Index = 3	Epoch: 1	Loss: 0.010501
Client Index = 3	Epoch: 2	Loss: 0.010190
Client Index = 3	Epoch: 3	Loss: 0.008195
Client Index = 3	Epoch: 4	Loss: 0.015347
test acc on this client after 1376 / 2049 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 4
local mask changes: 1046146.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2176064.0, 2193230.0, 2201018.0, 2192018.0, 1046146.0]
Doing local aggregation!
test acc on this client before 1391 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.017911
Client Index = 4	Epoch: 1	Loss: 0.011640
Client Index = 4	Epoch: 2	Loss: 0.011437
Client Index = 4	Epoch: 3	Loss: 0.127516
Client Index = 4	Epoch: 4	Loss: 0.541075
test acc on this client after 1102 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.11847710189067436}
################local_test_on_all_clients after local training in communication round: 66
{'test_acc_after': 0.5572781648993688, 'test_loss_after': 2.008258871663686}
################local_test_on_all_clients before local training in communication round: 66
{'test_acc_before': 0.669909213292858, 'test_loss_before': 1.458038587323419}
################Communication round : 67
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 0
local mask changes: 998792.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [998792.0, 2314416.0, 2191720.0, 2244192.0, 2206152.0]
Doing local aggregation!
test acc on this client before 1350 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.024504
Client Index = 0	Epoch: 1	Loss: 0.028895
Client Index = 0	Epoch: 2	Loss: 0.369502
Client Index = 0	Epoch: 3	Loss: 0.481942
Client Index = 0	Epoch: 4	Loss: 0.435810
test acc on this client after 1173 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 1
local mask changes: 998834.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2191442.0, 998834.0, 2201682.0, 2244754.0, 2209676.0]
Doing local aggregation!
test acc on this client before 1343 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.018463
Client Index = 1	Epoch: 1	Loss: 0.018027
Client Index = 1	Epoch: 2	Loss: 0.182656
Client Index = 1	Epoch: 3	Loss: 0.498911
Client Index = 1	Epoch: 4	Loss: 0.491782
test acc on this client after 1092 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 2
local mask changes: 998726.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2155422.0, 2290316.0, 998726.0, 2219142.0, 2180478.0]
Doing local aggregation!
test acc on this client before 1399 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.020087
Client Index = 2	Epoch: 1	Loss: 0.411212
Client Index = 2	Epoch: 2	Loss: 0.491290
Client Index = 2	Epoch: 3	Loss: 0.454886
Client Index = 2	Epoch: 4	Loss: 0.390023
test acc on this client after 1122 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 3
local mask changes: 998374.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2095882.0, 2238926.0, 2105360.0, 998374.0, 2115618.0]
Doing local aggregation!
test acc on this client before 1365 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.018000
Client Index = 3	Epoch: 1	Loss: 0.021685
Client Index = 3	Epoch: 2	Loss: 0.484384
Client Index = 3	Epoch: 3	Loss: 0.529962
Client Index = 3	Epoch: 4	Loss: 0.428603
test acc on this client after 1135 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 4
local mask changes: 999514.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2155402.0, 2283834.0, 2166192.0, 2212608.0, 999514.0]
Doing local aggregation!
test acc on this client before 1361 / 2051 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.023470
Client Index = 4	Epoch: 1	Loss: 0.044263
Client Index = 4	Epoch: 2	Loss: 0.479995
Client Index = 4	Epoch: 3	Loss: 0.475723
Client Index = 4	Epoch: 4	Loss: 0.437714
test acc on this client after 1143 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2904715948790426}
################local_test_on_all_clients after local training in communication round: 67
{'test_acc_after': 0.5528897088828718, 'test_loss_after': 1.9905167791263938}
################local_test_on_all_clients before local training in communication round: 67
{'test_acc_before': 0.6654247914316034, 'test_loss_before': 1.4626099495948313}
################Communication round : 68
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 0
local mask changes: 951846.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [951846.0, 2313088.0, 2302332.0, 2259384.0, 2299140.0]
Doing local aggregation!
test acc on this client before 1365 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.029198
Client Index = 0	Epoch: 1	Loss: 0.032588
Client Index = 0	Epoch: 2	Loss: 0.024302
Client Index = 0	Epoch: 3	Loss: 0.042617
Client Index = 0	Epoch: 4	Loss: 0.232028
test acc on this client after 1090 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 1
local mask changes: 952616.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2306094.0, 952616.0, 2284700.0, 2237802.0, 2279210.0]
Doing local aggregation!
test acc on this client before 1352 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.029375
Client Index = 1	Epoch: 1	Loss: 0.024253
Client Index = 1	Epoch: 2	Loss: 0.012316
Client Index = 1	Epoch: 3	Loss: 0.009234
Client Index = 1	Epoch: 4	Loss: 0.009068
test acc on this client after 1356 / 2045 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 2
local mask changes: 952404.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2327188.0, 2318760.0, 952404.0, 2264566.0, 2304688.0]
Doing local aggregation!
test acc on this client before 1385 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.026709
Client Index = 2	Epoch: 1	Loss: 0.027851
Client Index = 2	Epoch: 2	Loss: 0.043377
Client Index = 2	Epoch: 3	Loss: 0.047260
Client Index = 2	Epoch: 4	Loss: 0.152450
test acc on this client after 1173 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 3
local mask changes: 951448.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2271010.0, 2256702.0, 2249442.0, 951448.0, 2243558.0]
Doing local aggregation!
test acc on this client before 1377 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.040115
Client Index = 3	Epoch: 1	Loss: 0.032225
Client Index = 3	Epoch: 2	Loss: 0.044831
Client Index = 3	Epoch: 3	Loss: 0.296854
Client Index = 3	Epoch: 4	Loss: 0.383589
test acc on this client after 1153 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 4
local mask changes: 952398.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2308808.0, 2294420.0, 2286742.0, 2241664.0, 952398.0]
Doing local aggregation!
test acc on this client before 1369 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.033023
Client Index = 4	Epoch: 1	Loss: 0.026594
Client Index = 4	Epoch: 2	Loss: 0.023617
Client Index = 4	Epoch: 3	Loss: 0.021924
Client Index = 4	Epoch: 4	Loss: 0.178500
test acc on this client after 1127 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07295600779554141}
################local_test_on_all_clients after local training in communication round: 68
{'test_acc_after': 0.5757811427071899, 'test_loss_after': 1.9257107306821797}
################local_test_on_all_clients before local training in communication round: 68
{'test_acc_before': 0.6683546242908806, 'test_loss_before': 1.4082721724133802}
################Communication round : 69
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 0
local mask changes: 906426.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [906426.0, 2323444.0, 2343618.0, 2305630.0, 2329152.0]
Doing local aggregation!
test acc on this client before 1368 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.018284
Client Index = 0	Epoch: 1	Loss: 0.013459
Client Index = 0	Epoch: 2	Loss: 0.008911
Client Index = 0	Epoch: 3	Loss: 0.008262
Client Index = 0	Epoch: 4	Loss: 0.009136
test acc on this client after 1392 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 1
local mask changes: 906034.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2282260.0, 906034.0, 2292676.0, 2247044.0, 2271916.0]
Doing local aggregation!
test acc on this client before 1388 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.013877
Client Index = 1	Epoch: 1	Loss: 0.013511
Client Index = 1	Epoch: 2	Loss: 0.011661
Client Index = 1	Epoch: 3	Loss: 0.010046
Client Index = 1	Epoch: 4	Loss: 0.007777
test acc on this client after 1370 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 2
local mask changes: 906022.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2337274.0, 2325968.0, 906022.0, 2306802.0, 2328246.0]
Doing local aggregation!
test acc on this client before 1420 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.017827
Client Index = 2	Epoch: 1	Loss: 0.026561
Client Index = 2	Epoch: 2	Loss: 0.027282
Client Index = 2	Epoch: 3	Loss: 0.313730
Client Index = 2	Epoch: 4	Loss: 0.431453
test acc on this client after 1101 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 3
local mask changes: 906056.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2351700.0, 2337354.0, 2358146.0, 906056.0, 2341840.0]
Doing local aggregation!
test acc on this client before 1377 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.019840
Client Index = 3	Epoch: 1	Loss: 0.014148
Client Index = 3	Epoch: 2	Loss: 0.018676
Client Index = 3	Epoch: 3	Loss: 0.040809
Client Index = 3	Epoch: 4	Loss: 0.413983
test acc on this client after 1101 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 4
local mask changes: 906238.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2319818.0, 2304686.0, 2325910.0, 2283746.0, 906238.0]
Doing local aggregation!
test acc on this client before 1396 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.025739
Client Index = 4	Epoch: 1	Loss: 0.033143
Client Index = 4	Epoch: 2	Loss: 0.170008
Client Index = 4	Epoch: 3	Loss: 0.424719
Client Index = 4	Epoch: 4	Loss: 0.387992
test acc on this client after 1083 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.09923334902988709}
################local_test_on_all_clients after local training in communication round: 69
{'test_acc_after': 0.5902265484996055, 'test_loss_after': 1.852583514728655}
################local_test_on_all_clients before local training in communication round: 69
{'test_acc_before': 0.6782139209156018, 'test_loss_before': 1.447775374091759}
################Communication round : 70
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 0
local mask changes: 860136.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [860136.0, 2163346.0, 2212826.0, 2237572.0, 2198164.0]
Doing local aggregation!
test acc on this client before 1398 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.015327
Client Index = 0	Epoch: 1	Loss: 0.023843
Client Index = 0	Epoch: 2	Loss: 0.027362
Client Index = 0	Epoch: 3	Loss: 0.146610
Client Index = 0	Epoch: 4	Loss: 0.464028
test acc on this client after 1125 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 1
local mask changes: 860266.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2176498.0, 860266.0, 2177206.0, 2200464.0, 2158708.0]
Doing local aggregation!
test acc on this client before 1368 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.012436
Client Index = 1	Epoch: 1	Loss: 0.009860
Client Index = 1	Epoch: 2	Loss: 0.007889
Client Index = 1	Epoch: 3	Loss: 0.005867
Client Index = 1	Epoch: 4	Loss: 0.006434
test acc on this client after 1373 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 2
local mask changes: 860172.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2314036.0, 2274666.0, 860172.0, 2330934.0, 2299468.0]
Doing local aggregation!
test acc on this client before 1388 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.017000
Client Index = 2	Epoch: 1	Loss: 0.011724
Client Index = 2	Epoch: 2	Loss: 0.007537
Client Index = 2	Epoch: 3	Loss: 0.008995
Client Index = 2	Epoch: 4	Loss: 0.011384
test acc on this client after 1408 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 3
local mask changes: 860496.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2296270.0, 2254448.0, 2297582.0, 860496.0, 2280982.0]
Doing local aggregation!
test acc on this client before 1398 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.011801
Client Index = 3	Epoch: 1	Loss: 0.009594
Client Index = 3	Epoch: 2	Loss: 0.021588
Client Index = 3	Epoch: 3	Loss: 0.019840
Client Index = 3	Epoch: 4	Loss: 0.025076
test acc on this client after 1314 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 4
local mask changes: 859904.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2320094.0, 2279362.0, 2319298.0, 2335894.0, 859904.0]
Doing local aggregation!
test acc on this client before 1383 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.015349
Client Index = 4	Epoch: 1	Loss: 0.016326
Client Index = 4	Epoch: 2	Loss: 0.011095
Client Index = 4	Epoch: 3	Loss: 0.007002
Client Index = 4	Epoch: 4	Loss: 0.008860
test acc on this client after 1379 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.03691309044798076}
################local_test_on_all_clients after local training in communication round: 70
{'test_acc_after': 0.6440623812006592, 'test_loss_after': 1.610071186764823}
################local_test_on_all_clients before local training in communication round: 70
{'test_acc_before': 0.6768464369803066, 'test_loss_before': 1.4345306419239947}
################Communication round : 71
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 0
local mask changes: 815130.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [815130.0, 2142896.0, 2254770.0, 2236726.0, 2263088.0]
Doing local aggregation!
test acc on this client before 1399 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.028838
Client Index = 0	Epoch: 1	Loss: 0.029218
Client Index = 0	Epoch: 2	Loss: 0.043718
Client Index = 0	Epoch: 3	Loss: 0.490605
Client Index = 0	Epoch: 4	Loss: 0.471939
test acc on this client after 1107 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 1
local mask changes: 814840.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2044836.0, 814840.0, 2148496.0, 2125662.0, 2158574.0]
Doing local aggregation!
test acc on this client before 1375 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.007828
Client Index = 1	Epoch: 1	Loss: 0.006726
Client Index = 1	Epoch: 2	Loss: 0.015678
Client Index = 1	Epoch: 3	Loss: 0.464027
Client Index = 1	Epoch: 4	Loss: 0.504043
test acc on this client after 1091 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 2
local mask changes: 815270.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2157980.0, 2132664.0, 815270.0, 2225692.0, 2254232.0]
Doing local aggregation!
test acc on this client before 1403 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.008082
Client Index = 2	Epoch: 1	Loss: 0.006019
Client Index = 2	Epoch: 2	Loss: 0.007460
Client Index = 2	Epoch: 3	Loss: 0.011321
Client Index = 2	Epoch: 4	Loss: 0.009309
test acc on this client after 1392 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 3
local mask changes: 815430.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2149002.0, 2121770.0, 2235832.0, 815430.0, 2244064.0]
Doing local aggregation!
test acc on this client before 1410 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.009698
Client Index = 3	Epoch: 1	Loss: 0.010701
Client Index = 3	Epoch: 2	Loss: 0.033401
Client Index = 3	Epoch: 3	Loss: 0.466766
Client Index = 3	Epoch: 4	Loss: 0.486260
test acc on this client after 1129 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 4
local mask changes: 814592.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2164970.0, 2139314.0, 2251460.0, 2230594.0, 814592.0]
Doing local aggregation!
test acc on this client before 1396 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.007047
Client Index = 4	Epoch: 1	Loss: 0.007691
Client Index = 4	Epoch: 2	Loss: 0.008401
Client Index = 4	Epoch: 3	Loss: 0.006762
Client Index = 4	Epoch: 4	Loss: 0.013949
test acc on this client after 1374 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1262194011512935}
################local_test_on_all_clients after local training in communication round: 71
{'test_acc_after': 0.5946214508991903, 'test_loss_after': 1.8202100848255838}
################local_test_on_all_clients before local training in communication round: 71
{'test_acc_before': 0.6815302730342252, 'test_loss_before': 1.4323172773151651}
################Communication round : 72
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 0
local mask changes: 770522.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [770522.0, 2156332.0, 2224696.0, 2216720.0, 2230204.0]
Doing local aggregation!
test acc on this client before 1376 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.014396
Client Index = 0	Epoch: 1	Loss: 0.011482
Client Index = 0	Epoch: 2	Loss: 0.010083
Client Index = 0	Epoch: 3	Loss: 0.009076
Client Index = 0	Epoch: 4	Loss: 0.009789
test acc on this client after 1362 / 2050 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 1
local mask changes: 770320.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2151624.0, 770320.0, 2128750.0, 2122240.0, 2134054.0]
Doing local aggregation!
test acc on this client before 1366 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.016813
Client Index = 1	Epoch: 1	Loss: 0.070248
Client Index = 1	Epoch: 2	Loss: 0.466352
Client Index = 1	Epoch: 3	Loss: 0.457646
Client Index = 1	Epoch: 4	Loss: 0.443899
test acc on this client after 1049 / 2045 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 2
local mask changes: 770108.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2111164.0, 2001908.0, 770108.0, 2078810.0, 2091690.0]
Doing local aggregation!
test acc on this client before 1387 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.012585
Client Index = 2	Epoch: 1	Loss: 0.007660
Client Index = 2	Epoch: 2	Loss: 0.007293
Client Index = 2	Epoch: 3	Loss: 0.010027
Client Index = 2	Epoch: 4	Loss: 0.006831
test acc on this client after 1418 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 3
local mask changes: 769696.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2215166.0, 2123540.0, 2196756.0, 769696.0, 2200204.0]
Doing local aggregation!
test acc on this client before 1394 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.015338
Client Index = 3	Epoch: 1	Loss: 0.012152
Client Index = 3	Epoch: 2	Loss: 0.049161
Client Index = 3	Epoch: 3	Loss: 0.462522
Client Index = 3	Epoch: 4	Loss: 0.460611
test acc on this client after 1109 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 4
local mask changes: 770054.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2116102.0, 2006094.0, 2090628.0, 2083474.0, 770054.0]
Doing local aggregation!
test acc on this client before 1383 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.021826
Client Index = 4	Epoch: 1	Loss: 0.017228
Client Index = 4	Epoch: 2	Loss: 0.166816
Client Index = 4	Epoch: 3	Loss: 0.497219
Client Index = 4	Epoch: 4	Loss: 0.485023
test acc on this client after 1142 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.14968321408301932}
################local_test_on_all_clients after local training in communication round: 72
{'test_acc_after': 0.5933519863591734, 'test_loss_after': 1.8127567058541056}
################local_test_on_all_clients before local training in communication round: 72
{'test_acc_before': 0.6740165487285699, 'test_loss_before': 1.432251256671193}
################Communication round : 73
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 0
local mask changes: 725180.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [725180.0, 2130282.0, 2086322.0, 2175282.0, 2090412.0]
Doing local aggregation!
test acc on this client before 1380 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.014493
Client Index = 0	Epoch: 1	Loss: 0.013432
Client Index = 0	Epoch: 2	Loss: 0.018723
Client Index = 0	Epoch: 3	Loss: 0.013974
Client Index = 0	Epoch: 4	Loss: 0.124124
test acc on this client after 1171 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 1
local mask changes: 724900.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2264926.0, 724900.0, 2167210.0, 2244252.0, 2170394.0]
Doing local aggregation!
test acc on this client before 1364 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.015576
Client Index = 1	Epoch: 1	Loss: 0.020604
Client Index = 1	Epoch: 2	Loss: 0.078693
Client Index = 1	Epoch: 3	Loss: 0.442919
Client Index = 1	Epoch: 4	Loss: 0.465011
test acc on this client after 1136 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 2
local mask changes: 725324.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2105420.0, 2025988.0, 725324.0, 2081406.0, 1979116.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.028616
Client Index = 2	Epoch: 1	Loss: 0.347755
Client Index = 2	Epoch: 2	Loss: 0.445026
Client Index = 2	Epoch: 3	Loss: 0.414652
Client Index = 2	Epoch: 4	Loss: 0.363712
test acc on this client after 1202 / 2051 : 0.59
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 3
local mask changes: 725754.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2274936.0, 2215878.0, 2183550.0, 725754.0, 2187204.0]
Doing local aggregation!
test acc on this client before 1363 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.020177
Client Index = 3	Epoch: 1	Loss: 0.013488
Client Index = 3	Epoch: 2	Loss: 0.015392
Client Index = 3	Epoch: 3	Loss: 0.011608
Client Index = 3	Epoch: 4	Loss: 0.018823
test acc on this client after 1319 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 4
local mask changes: 725728.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2224014.0, 2156314.0, 2112774.0, 2203348.0, 725728.0]
Doing local aggregation!
test acc on this client before 1369 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.021450
Client Index = 4	Epoch: 1	Loss: 0.013877
Client Index = 4	Epoch: 2	Loss: 0.014096
Client Index = 4	Epoch: 3	Loss: 0.010673
Client Index = 4	Epoch: 4	Loss: 0.008703
test acc on this client after 1374 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.11822376522154794}
################local_test_on_all_clients after local training in communication round: 73
{'test_acc_after': 0.6052844158111557, 'test_loss_after': 1.7690974768193448}
################local_test_on_all_clients before local training in communication round: 73
{'test_acc_before': 0.6710878139246781, 'test_loss_before': 1.4394403277504875}
################Communication round : 74
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 0
local mask changes: 681384.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [681384.0, 2164168.0, 2010540.0, 2166186.0, 2127234.0]
Doing local aggregation!
test acc on this client before 1395 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.017996
Client Index = 0	Epoch: 1	Loss: 0.017092
Client Index = 0	Epoch: 2	Loss: 0.021845
Client Index = 0	Epoch: 3	Loss: 0.384328
Client Index = 0	Epoch: 4	Loss: 0.482047
test acc on this client after 1159 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 1
local mask changes: 681100.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2234528.0, 681100.0, 2168736.0, 2293276.0, 2260742.0]
Doing local aggregation!
test acc on this client before 1340 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.014908
Client Index = 1	Epoch: 1	Loss: 0.014345
Client Index = 1	Epoch: 2	Loss: 0.011712
Client Index = 1	Epoch: 3	Loss: 0.011830
Client Index = 1	Epoch: 4	Loss: 0.025272
test acc on this client after 1310 / 2045 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 2
local mask changes: 681638.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2137026.0, 2211558.0, 681638.0, 2219874.0, 2175386.0]
Doing local aggregation!
test acc on this client before 1396 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.018735
Client Index = 2	Epoch: 1	Loss: 0.036492
Client Index = 2	Epoch: 2	Loss: 0.386357
Client Index = 2	Epoch: 3	Loss: 0.441159
Client Index = 2	Epoch: 4	Loss: 0.440152
test acc on this client after 1078 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 3
local mask changes: 681700.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2135692.0, 2208822.0, 2067442.0, 681700.0, 2174498.0]
Doing local aggregation!
test acc on this client before 1401 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.011201
Client Index = 3	Epoch: 1	Loss: 0.011251
Client Index = 3	Epoch: 2	Loss: 0.008042
Client Index = 3	Epoch: 3	Loss: 0.014763
Client Index = 3	Epoch: 4	Loss: 0.046819
test acc on this client after 1145 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 4
local mask changes: 681544.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2091200.0, 2169936.0, 2016266.0, 2173760.0, 681544.0]
Doing local aggregation!
test acc on this client before 1384 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.012235
Client Index = 4	Epoch: 1	Loss: 0.011801
Client Index = 4	Epoch: 2	Loss: 0.012715
Client Index = 4	Epoch: 3	Loss: 0.135378
Client Index = 4	Epoch: 4	Loss: 0.482377
test acc on this client after 1115 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.1228340797359599}
################local_test_on_all_clients after local training in communication round: 74
{'test_acc_after': 0.5667992691356869, 'test_loss_after': 1.9477561644366912}
################local_test_on_all_clients before local training in communication round: 74
{'test_acc_before': 0.6749858141869189, 'test_loss_before': 1.448456647158416}
################Communication round : 75
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 0
local mask changes: 638662.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [638662.0, 2229468.0, 2168228.0, 2145926.0, 2115792.0]
Doing local aggregation!
test acc on this client before 1353 / 2050 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.020106
Client Index = 0	Epoch: 1	Loss: 0.014084
Client Index = 0	Epoch: 2	Loss: 0.015034
Client Index = 0	Epoch: 3	Loss: 0.176439
Client Index = 0	Epoch: 4	Loss: 0.469057
test acc on this client after 1194 / 2050 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 1
local mask changes: 639328.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2130774.0, 639328.0, 2190482.0, 2161394.0, 2134052.0]
Doing local aggregation!
test acc on this client before 1367 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.015437
Client Index = 1	Epoch: 1	Loss: 0.013471
Client Index = 1	Epoch: 2	Loss: 0.008402
Client Index = 1	Epoch: 3	Loss: 0.048437
Client Index = 1	Epoch: 4	Loss: 0.452941
test acc on this client after 1109 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 2
local mask changes: 638676.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2192334.0, 2294078.0, 638676.0, 2225714.0, 2194478.0]
Doing local aggregation!
test acc on this client before 1386 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.014590
Client Index = 2	Epoch: 1	Loss: 0.030724
Client Index = 2	Epoch: 2	Loss: 0.024832
Client Index = 2	Epoch: 3	Loss: 0.107171
Client Index = 2	Epoch: 4	Loss: 0.439851
test acc on this client after 1083 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 3
local mask changes: 638802.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2053954.0, 2178116.0, 2123442.0, 638802.0, 2056638.0]
Doing local aggregation!
test acc on this client before 1382 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.015797
Client Index = 3	Epoch: 1	Loss: 0.010713
Client Index = 3	Epoch: 2	Loss: 0.013552
Client Index = 3	Epoch: 3	Loss: 0.048223
Client Index = 3	Epoch: 4	Loss: 0.469203
test acc on this client after 1141 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 4
local mask changes: 638694.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2095020.0, 2211140.0, 2152296.0, 2128908.0, 638694.0]
Doing local aggregation!
test acc on this client before 1367 / 2051 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.017934
Client Index = 4	Epoch: 1	Loss: 0.013036
Client Index = 4	Epoch: 2	Loss: 0.013120
Client Index = 4	Epoch: 3	Loss: 0.027276
Client Index = 4	Epoch: 4	Loss: 0.398733
test acc on this client after 1185 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.115126439836684}
################local_test_on_all_clients after local training in communication round: 75
{'test_acc_after': 0.5574792728193343, 'test_loss_after': 2.013145957588123}
################local_test_on_all_clients before local training in communication round: 75
{'test_acc_before': 0.6690414147882858, 'test_loss_before': 1.4477060073856016}
################Communication round : 76
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 0
local mask changes: 596724.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [596724.0, 2184604.0, 2234080.0, 2131582.0, 2163288.0]
Doing local aggregation!
test acc on this client before 1378 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.015287
Client Index = 0	Epoch: 1	Loss: 0.017667
Client Index = 0	Epoch: 2	Loss: 0.024307
Client Index = 0	Epoch: 3	Loss: 0.026122
Client Index = 0	Epoch: 4	Loss: 0.292069
test acc on this client after 1131 / 2050 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 1
local mask changes: 596196.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2175486.0, 596196.0, 2235624.0, 2123038.0, 2158554.0]
Doing local aggregation!
test acc on this client before 1366 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.017803
Client Index = 1	Epoch: 1	Loss: 0.042991
Client Index = 1	Epoch: 2	Loss: 0.396965
Client Index = 1	Epoch: 3	Loss: 0.430974
Client Index = 1	Epoch: 4	Loss: 0.418617
test acc on this client after 1081 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 2
local mask changes: 596536.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2230308.0, 2238694.0, 596536.0, 2192744.0, 2215500.0]
Doing local aggregation!
test acc on this client before 1407 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.016495
Client Index = 2	Epoch: 1	Loss: 0.027481
Client Index = 2	Epoch: 2	Loss: 0.024888
Client Index = 2	Epoch: 3	Loss: 0.189974
Client Index = 2	Epoch: 4	Loss: 0.451587
test acc on this client after 1132 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 3
local mask changes: 596284.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2124652.0, 2126196.0, 2191884.0, 596284.0, 2109016.0]
Doing local aggregation!
test acc on this client before 1406 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.058593
Client Index = 3	Epoch: 1	Loss: 0.393099
Client Index = 3	Epoch: 2	Loss: 0.433096
Client Index = 3	Epoch: 3	Loss: 0.416753
Client Index = 3	Epoch: 4	Loss: 0.310919
test acc on this client after 1133 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 4
local mask changes: 595874.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2144384.0, 2149376.0, 2204906.0, 2097052.0, 595874.0]
Doing local aggregation!
test acc on this client before 1387 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.025269
Client Index = 4	Epoch: 1	Loss: 0.055829
Client Index = 4	Epoch: 2	Loss: 0.425727
Client Index = 4	Epoch: 3	Loss: 0.439693
Client Index = 4	Epoch: 4	Loss: 0.401036
test acc on this client after 1114 / 2051 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.21412959658597805}
################local_test_on_all_clients after local training in communication round: 76
{'test_acc_after': 0.5456683813533448, 'test_loss_after': 2.0724618595712436}
################local_test_on_all_clients before local training in communication round: 76
{'test_acc_before': 0.6777232955487067, 'test_loss_before': 1.429549271622464}
################Communication round : 77
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 0
local mask changes: 555008.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [555008.0, 2173364.0, 2214058.0, 2136320.0, 2147854.0]
Doing local aggregation!
test acc on this client before 1380 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.025343
Client Index = 0	Epoch: 1	Loss: 0.037029
Client Index = 0	Epoch: 2	Loss: 0.097123
Client Index = 0	Epoch: 3	Loss: 0.335147
Client Index = 0	Epoch: 4	Loss: 0.349755
test acc on this client after 1147 / 2050 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 1
local mask changes: 554620.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2238526.0, 554620.0, 2275060.0, 2199146.0, 2213010.0]
Doing local aggregation!
test acc on this client before 1341 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.020116
Client Index = 1	Epoch: 1	Loss: 0.024265
Client Index = 1	Epoch: 2	Loss: 0.022063
Client Index = 1	Epoch: 3	Loss: 0.163462
Client Index = 1	Epoch: 4	Loss: 0.371298
test acc on this client after 1176 / 2045 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 2
local mask changes: 555042.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2241292.0, 2241018.0, 555042.0, 2209674.0, 2215790.0]
Doing local aggregation!
test acc on this client before 1388 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.018480
Client Index = 2	Epoch: 1	Loss: 0.019198
Client Index = 2	Epoch: 2	Loss: 0.013539
Client Index = 2	Epoch: 3	Loss: 0.013385
Client Index = 2	Epoch: 4	Loss: 0.015054
test acc on this client after 1363 / 2051 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 3
local mask changes: 555002.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2216602.0, 2213708.0, 2259480.0, 555002.0, 2191506.0]
Doing local aggregation!
test acc on this client before 1383 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.018883
Client Index = 3	Epoch: 1	Loss: 0.017488
Client Index = 3	Epoch: 2	Loss: 0.016835
Client Index = 3	Epoch: 3	Loss: 0.015617
Client Index = 3	Epoch: 4	Loss: 0.028643
test acc on this client after 1230 / 2049 : 0.60
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 4
local mask changes: 555164.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2217196.0, 2215368.0, 2254280.0, 2177728.0, 555164.0]
Doing local aggregation!
test acc on this client before 1393 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.025338
Client Index = 4	Epoch: 1	Loss: 0.019485
Client Index = 4	Epoch: 2	Loss: 0.019088
Client Index = 4	Epoch: 3	Loss: 0.012467
Client Index = 4	Epoch: 4	Loss: 0.018483
test acc on this client after 1360 / 2051 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.06870339978837922}
################local_test_on_all_clients after local training in communication round: 77
{'test_acc_after': 0.612502239355907, 'test_loss_after': 1.7663544334840018}
################local_test_on_all_clients before local training in communication round: 77
{'test_acc_before': 0.6719607578598629, 'test_loss_before': 1.4533229432133417}
################Communication round : 78
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 0
local mask changes: 514506.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [514506.0, 2253652.0, 2248848.0, 2237044.0, 2236360.0]
Doing local aggregation!
test acc on this client before 1379 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.014668
Client Index = 0	Epoch: 1	Loss: 0.009649
Client Index = 0	Epoch: 2	Loss: 0.008231
Client Index = 0	Epoch: 3	Loss: 0.013793
Client Index = 0	Epoch: 4	Loss: 0.012777
test acc on this client after 1332 / 2050 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 1
local mask changes: 514320.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2235578.0, 514320.0, 2286278.0, 2273156.0, 2272752.0]
Doing local aggregation!
test acc on this client before 1370 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.012475
Client Index = 1	Epoch: 1	Loss: 0.008956
Client Index = 1	Epoch: 2	Loss: 0.008576
Client Index = 1	Epoch: 3	Loss: 0.006725
Client Index = 1	Epoch: 4	Loss: 0.005686
test acc on this client after 1371 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 2
local mask changes: 514652.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2170244.0, 2233712.0, 514652.0, 2224202.0, 2215000.0]
Doing local aggregation!
test acc on this client before 1406 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.008544
Client Index = 2	Epoch: 1	Loss: 0.009299
Client Index = 2	Epoch: 2	Loss: 0.039027
Client Index = 2	Epoch: 3	Loss: 0.358761
Client Index = 2	Epoch: 4	Loss: 0.431486
test acc on this client after 1138 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 3
local mask changes: 514428.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2164662.0, 2225370.0, 2224716.0, 514428.0, 2207868.0]
Doing local aggregation!
test acc on this client before 1416 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.012842
Client Index = 3	Epoch: 1	Loss: 0.007167
Client Index = 3	Epoch: 2	Loss: 0.006776
Client Index = 3	Epoch: 3	Loss: 0.005372
Client Index = 3	Epoch: 4	Loss: 0.006538
test acc on this client after 1390 / 2049 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 4
local mask changes: 514478.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2159022.0, 2221446.0, 2214370.0, 2207196.0, 514478.0]
Doing local aggregation!
test acc on this client before 1391 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.008229
Client Index = 4	Epoch: 1	Loss: 0.010892
Client Index = 4	Epoch: 2	Loss: 0.011105
Client Index = 4	Epoch: 3	Loss: 0.009960
Client Index = 4	Epoch: 4	Loss: 0.012453
test acc on this client after 1375 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.04159944632128642}
################local_test_on_all_clients after local training in communication round: 78
{'test_acc_after': 0.6447614831184708, 'test_loss_after': 1.6047099610683453}
################local_test_on_all_clients before local training in communication round: 78
{'test_acc_before': 0.6794806806881659, 'test_loss_before': 1.4451572717506693}
################Communication round : 79
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 0
local mask changes: 474784.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [474784.0, 2208498.0, 2144430.0, 2141818.0, 2137634.0]
Doing local aggregation!
test acc on this client before 1377 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.008927
Client Index = 0	Epoch: 1	Loss: 0.007166
Client Index = 0	Epoch: 2	Loss: 0.006739
Client Index = 0	Epoch: 3	Loss: 0.009089
Client Index = 0	Epoch: 4	Loss: 0.011090
test acc on this client after 1391 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 1
local mask changes: 474888.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2206094.0, 474888.0, 2173016.0, 2167476.0, 2165102.0]
Doing local aggregation!
test acc on this client before 1371 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.007660
Client Index = 1	Epoch: 1	Loss: 0.006244
Client Index = 1	Epoch: 2	Loss: 0.005130
Client Index = 1	Epoch: 3	Loss: 0.006270
Client Index = 1	Epoch: 4	Loss: 0.006790
test acc on this client after 1370 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 2
local mask changes: 475192.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2227164.0, 2258532.0, 475192.0, 2198474.0, 2189852.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.007376
Client Index = 2	Epoch: 1	Loss: 0.005855
Client Index = 2	Epoch: 2	Loss: 0.005632
Client Index = 2	Epoch: 3	Loss: 0.005413
Client Index = 2	Epoch: 4	Loss: 0.005528
test acc on this client after 1417 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 3
local mask changes: 475256.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2146808.0, 2176420.0, 2108758.0, 475256.0, 2097834.0]
Doing local aggregation!
test acc on this client before 1406 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.008524
Client Index = 3	Epoch: 1	Loss: 0.020140
Client Index = 3	Epoch: 2	Loss: 0.021069
Client Index = 3	Epoch: 3	Loss: 0.268533
Client Index = 3	Epoch: 4	Loss: 0.463338
test acc on this client after 1129 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 4
local mask changes: 474938.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2145078.0, 2176054.0, 2103160.0, 2102510.0, 474938.0]
Doing local aggregation!
test acc on this client before 1395 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.007203
Client Index = 4	Epoch: 1	Loss: 0.005547
Client Index = 4	Epoch: 2	Loss: 0.006011
Client Index = 4	Epoch: 3	Loss: 0.006389
Client Index = 4	Epoch: 4	Loss: 0.005879
test acc on this client after 1409 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.03670161504930418}
################local_test_on_all_clients after local training in communication round: 79
{'test_acc_after': 0.6554656360276598, 'test_loss_after': 1.550995675903229}
################local_test_on_all_clients before local training in communication round: 79
{'test_acc_before': 0.6782122455362029, 'test_loss_before': 1.424986388346432}
################Communication round : 80
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 0
local mask changes: 436460.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [436460.0, 2086732.0, 2127770.0, 2031270.0, 2030568.0]
Doing local aggregation!
test acc on this client before 1386 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.008723
Client Index = 0	Epoch: 1	Loss: 0.007231
Client Index = 0	Epoch: 2	Loss: 0.006131
Client Index = 0	Epoch: 3	Loss: 0.005457
Client Index = 0	Epoch: 4	Loss: 0.006689
test acc on this client after 1399 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 1
local mask changes: 436828.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2085504.0, 436828.0, 2151274.0, 2051024.0, 2052768.0]
Doing local aggregation!
test acc on this client before 1386 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.006477
Client Index = 1	Epoch: 1	Loss: 0.006892
Client Index = 1	Epoch: 2	Loss: 0.008516
Client Index = 1	Epoch: 3	Loss: 0.005930
Client Index = 1	Epoch: 4	Loss: 0.006519
test acc on this client after 1367 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 2
local mask changes: 436496.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2115058.0, 2140438.0, 436496.0, 2088928.0, 2085168.0]
Doing local aggregation!
test acc on this client before 1406 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.006125
Client Index = 2	Epoch: 1	Loss: 0.005862
Client Index = 2	Epoch: 2	Loss: 0.007690
Client Index = 2	Epoch: 3	Loss: 0.016321
Client Index = 2	Epoch: 4	Loss: 0.250534
test acc on this client after 1145 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 3
local mask changes: 436126.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2119222.0, 2140160.0, 2175974.0, 436126.0, 2087230.0]
Doing local aggregation!
test acc on this client before 1413 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.008157
Client Index = 3	Epoch: 1	Loss: 0.006193
Client Index = 3	Epoch: 2	Loss: 0.005353
Client Index = 3	Epoch: 3	Loss: 0.005563
Client Index = 3	Epoch: 4	Loss: 0.005448
test acc on this client after 1400 / 2049 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 4
local mask changes: 436622.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2031902.0, 2056526.0, 2099520.0, 1995748.0, 436622.0]
Doing local aggregation!
test acc on this client before 1405 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.006985
Client Index = 4	Epoch: 1	Loss: 0.006029
Client Index = 4	Epoch: 2	Loss: 0.005959
Client Index = 4	Epoch: 3	Loss: 0.005754
Client Index = 4	Epoch: 4	Loss: 0.006344
test acc on this client after 1406 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.016675260811901595}
################local_test_on_all_clients after local training in communication round: 80
{'test_acc_after': 0.6555884658434309, 'test_loss_after': 1.5487060401559596}
################local_test_on_all_clients before local training in communication round: 80
{'test_acc_before': 0.6828007616381162, 'test_loss_before': 1.4077538968611285}
################Communication round : 81
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 0
local mask changes: 399286.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [399286.0, 1985058.0, 2013310.0, 2034152.0, 1934908.0]
Doing local aggregation!
test acc on this client before 1400 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.007040
Client Index = 0	Epoch: 1	Loss: 0.008124
Client Index = 0	Epoch: 2	Loss: 0.006713
Client Index = 0	Epoch: 3	Loss: 0.006709
Client Index = 0	Epoch: 4	Loss: 0.007312
test acc on this client after 1390 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 1
local mask changes: 399354.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1986710.0, 399354.0, 2036304.0, 2054152.0, 1958284.0]
Doing local aggregation!
test acc on this client before 1373 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.006197
Client Index = 1	Epoch: 1	Loss: 0.008167
Client Index = 1	Epoch: 2	Loss: 0.006134
Client Index = 1	Epoch: 3	Loss: 0.005447
Client Index = 1	Epoch: 4	Loss: 0.005514
test acc on this client after 1385 / 2045 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 2
local mask changes: 399228.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2053134.0, 2075400.0, 399228.0, 2110020.0, 2028566.0]
Doing local aggregation!
test acc on this client before 1424 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.008323
Client Index = 2	Epoch: 1	Loss: 0.473129
Client Index = 2	Epoch: 2	Loss: 0.526566
Client Index = 2	Epoch: 3	Loss: 0.481596
Client Index = 2	Epoch: 4	Loss: 0.453503
test acc on this client after 1132 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 3
local mask changes: 399348.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2020892.0, 2037880.0, 2066854.0, 399348.0, 1992184.0]
Doing local aggregation!
test acc on this client before 1417 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.006849
Client Index = 3	Epoch: 1	Loss: 0.006429
Client Index = 3	Epoch: 2	Loss: 0.005864
Client Index = 3	Epoch: 3	Loss: 0.005731
Client Index = 3	Epoch: 4	Loss: 0.007627
test acc on this client after 1379 / 2049 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 4
local mask changes: 399208.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1938736.0, 1959406.0, 1990460.0, 2009910.0, 399208.0]
Doing local aggregation!
test acc on this client before 1411 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.007057
Client Index = 4	Epoch: 1	Loss: 0.008016
Client Index = 4	Epoch: 2	Loss: 0.009019
Client Index = 4	Epoch: 3	Loss: 0.014857
Client Index = 4	Epoch: 4	Loss: 0.566258
test acc on this client after 1126 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.10592723402014118}
################local_test_on_all_clients after local training in communication round: 81
{'test_acc_after': 0.625849599308885, 'test_loss_after': 1.6752771340568775}
################local_test_on_all_clients before local training in communication round: 81
{'test_acc_before': 0.6856259778060912, 'test_loss_before': 1.4017246069316696}
################Communication round : 82
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 0
local mask changes: 363424.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [363424.0, 1903540.0, 1969480.0, 1935104.0, 1857120.0]
Doing local aggregation!
test acc on this client before 1383 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.009874
Client Index = 0	Epoch: 1	Loss: 0.195619
Client Index = 0	Epoch: 2	Loss: 0.541469
Client Index = 0	Epoch: 3	Loss: 0.569426
Client Index = 0	Epoch: 4	Loss: 0.499197
test acc on this client after 1018 / 2050 : 0.50
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 1
local mask changes: 363400.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1901036.0, 363400.0, 1990452.0, 1952928.0, 1877378.0]
Doing local aggregation!
test acc on this client before 1382 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.008693
Client Index = 1	Epoch: 1	Loss: 0.015412
Client Index = 1	Epoch: 2	Loss: 0.261698
Client Index = 1	Epoch: 3	Loss: 0.571620
Client Index = 1	Epoch: 4	Loss: 0.535527
test acc on this client after 1006 / 2045 : 0.49
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 2
local mask changes: 363478.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2084774.0, 2106018.0, 363478.0, 2124900.0, 2067942.0]
Doing local aggregation!
test acc on this client before 1396 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.011852
Client Index = 2	Epoch: 1	Loss: 0.010153
Client Index = 2	Epoch: 2	Loss: 0.007911
Client Index = 2	Epoch: 3	Loss: 0.062168
Client Index = 2	Epoch: 4	Loss: 0.545831
test acc on this client after 1163 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 3
local mask changes: 363644.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1926314.0, 1945300.0, 2008854.0, 363644.0, 1902788.0]
Doing local aggregation!
test acc on this client before 1401 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.011933
Client Index = 3	Epoch: 1	Loss: 0.310364
Client Index = 3	Epoch: 2	Loss: 0.562149
Client Index = 3	Epoch: 3	Loss: 0.531071
Client Index = 3	Epoch: 4	Loss: 0.473793
test acc on this client after 1142 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 4
local mask changes: 363532.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1928838.0, 1950514.0, 2011892.0, 1977182.0, 363532.0]
Doing local aggregation!
test acc on this client before 1408 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.012769
Client Index = 4	Epoch: 1	Loss: 0.521717
Client Index = 4	Epoch: 2	Loss: 0.537911
Client Index = 4	Epoch: 3	Loss: 0.517081
Client Index = 4	Epoch: 4	Loss: 0.455048
test acc on this client after 1131 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.31121145133565803}
################local_test_on_all_clients after local training in communication round: 82
{'test_acc_after': 0.5328681486787553, 'test_loss_after': 2.126876688594875}
################local_test_on_all_clients before local training in communication round: 82
{'test_acc_before': 0.6802629837359515, 'test_loss_before': 1.3993484829902827}
################Communication round : 83
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 0
local mask changes: 328786.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [328786.0, 1950922.0, 2110684.0, 1971126.0, 1978198.0]
Doing local aggregation!
test acc on this client before 1369 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.032392
Client Index = 0	Epoch: 1	Loss: 0.210889
Client Index = 0	Epoch: 2	Loss: 0.416702
Client Index = 0	Epoch: 3	Loss: 0.418961
Client Index = 0	Epoch: 4	Loss: 0.389827
test acc on this client after 1177 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 1
local mask changes: 328750.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1940860.0, 328750.0, 2119972.0, 1976276.0, 1986496.0]
Doing local aggregation!
test acc on this client before 1367 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.020268
Client Index = 1	Epoch: 1	Loss: 0.038616
Client Index = 1	Epoch: 2	Loss: 0.241965
Client Index = 1	Epoch: 3	Loss: 0.453858
Client Index = 1	Epoch: 4	Loss: 0.424378
test acc on this client after 1086 / 2045 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 2
local mask changes: 328900.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2069688.0, 2087786.0, 328900.0, 2099548.0, 2102682.0]
Doing local aggregation!
test acc on this client before 1389 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.020449
Client Index = 2	Epoch: 1	Loss: 0.025409
Client Index = 2	Epoch: 2	Loss: 0.032018
Client Index = 2	Epoch: 3	Loss: 0.383547
Client Index = 2	Epoch: 4	Loss: 0.418199
test acc on this client after 1140 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 3
local mask changes: 328674.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1973280.0, 1989178.0, 2143100.0, 328674.0, 2014380.0]
Doing local aggregation!
test acc on this client before 1368 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.033656
Client Index = 3	Epoch: 1	Loss: 0.045905
Client Index = 3	Epoch: 2	Loss: 0.390660
Client Index = 3	Epoch: 3	Loss: 0.438015
Client Index = 3	Epoch: 4	Loss: 0.373652
test acc on this client after 1110 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 4
local mask changes: 328840.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1982616.0, 2000520.0, 2146168.0, 2016532.0, 328840.0]
Doing local aggregation!
test acc on this client before 1390 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.025933
Client Index = 4	Epoch: 1	Loss: 0.075180
Client Index = 4	Epoch: 2	Loss: 0.372713
Client Index = 4	Epoch: 3	Loss: 0.424588
Client Index = 4	Epoch: 4	Loss: 0.380255
test acc on this client after 1173 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.24352134042153403}
################local_test_on_all_clients after local training in communication round: 83
{'test_acc_after': 0.5549335845688926, 'test_loss_after': 2.0049972712054034}
################local_test_on_all_clients before local training in communication round: 83
{'test_acc_before': 0.6717712187546937, 'test_loss_before': 1.4158271133008256}
################Communication round : 84
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 0
local mask changes: 295242.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [295242.0, 2081456.0, 2175986.0, 2105308.0, 2110718.0]
Doing local aggregation!
test acc on this client before 1398 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.020783
Client Index = 0	Epoch: 1	Loss: 0.016150
Client Index = 0	Epoch: 2	Loss: 0.021070
Client Index = 0	Epoch: 3	Loss: 0.019920
Client Index = 0	Epoch: 4	Loss: 0.015472
test acc on this client after 1373 / 2050 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 1
local mask changes: 295482.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2073700.0, 295482.0, 2174530.0, 2103150.0, 2111268.0]
Doing local aggregation!
test acc on this client before 1374 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.024899
Client Index = 1	Epoch: 1	Loss: 0.021225
Client Index = 1	Epoch: 2	Loss: 0.052260
Client Index = 1	Epoch: 3	Loss: 0.321782
Client Index = 1	Epoch: 4	Loss: 0.383666
test acc on this client after 1162 / 2045 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 2
local mask changes: 295570.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2161482.0, 2167784.0, 295570.0, 2187308.0, 2189454.0]
Doing local aggregation!
test acc on this client before 1394 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.023284
Client Index = 2	Epoch: 1	Loss: 0.018754
Client Index = 2	Epoch: 2	Loss: 0.010930
Client Index = 2	Epoch: 3	Loss: 0.007336
Client Index = 2	Epoch: 4	Loss: 0.006677
test acc on this client after 1423 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 3
local mask changes: 295706.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2102558.0, 2107308.0, 2198234.0, 295706.0, 2137006.0]
Doing local aggregation!
test acc on this client before 1408 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.019577
Client Index = 3	Epoch: 1	Loss: 0.014473
Client Index = 3	Epoch: 2	Loss: 0.014563
Client Index = 3	Epoch: 3	Loss: 0.010953
Client Index = 3	Epoch: 4	Loss: 0.009922
test acc on this client after 1396 / 2049 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 4
local mask changes: 295110.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2107280.0, 2114182.0, 2199928.0, 2136428.0, 295110.0]
Doing local aggregation!
test acc on this client before 1398 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.019956
Client Index = 4	Epoch: 1	Loss: 0.019709
Client Index = 4	Epoch: 2	Loss: 0.025672
Client Index = 4	Epoch: 3	Loss: 0.289206
Client Index = 4	Epoch: 4	Loss: 0.374086
test acc on this client after 1183 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07049299882482547}
################local_test_on_all_clients after local training in communication round: 84
{'test_acc_after': 0.6379757838090011, 'test_loss_after': 1.6390513758592935}
################local_test_on_all_clients before local training in communication round: 84
{'test_acc_before': 0.6804571015118459, 'test_loss_before': 1.4040624341225174}
################Communication round : 85
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 0
local mask changes: 263630.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [263630.0, 2125206.0, 2193770.0, 2149192.0, 2152532.0]
Doing local aggregation!
test acc on this client before 1397 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.008989
Client Index = 0	Epoch: 1	Loss: 0.009500
Client Index = 0	Epoch: 2	Loss: 0.019162
Client Index = 0	Epoch: 3	Loss: 0.038460
Client Index = 0	Epoch: 4	Loss: 0.293123
test acc on this client after 1111 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 1
local mask changes: 263626.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2162778.0, 263626.0, 2229100.0, 2182728.0, 2188454.0]
Doing local aggregation!
test acc on this client before 1380 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.013190
Client Index = 1	Epoch: 1	Loss: 0.019194
Client Index = 1	Epoch: 2	Loss: 0.019736
Client Index = 1	Epoch: 3	Loss: 0.016199
Client Index = 1	Epoch: 4	Loss: 0.023667
test acc on this client after 1292 / 2045 : 0.63
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 2
local mask changes: 263568.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2191008.0, 2187778.0, 263568.0, 2209712.0, 2209468.0]
Doing local aggregation!
test acc on this client before 1435 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.011226
Client Index = 2	Epoch: 1	Loss: 0.008998
Client Index = 2	Epoch: 2	Loss: 0.010475
Client Index = 2	Epoch: 3	Loss: 0.008284
Client Index = 2	Epoch: 4	Loss: 0.005724
test acc on this client after 1420 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 3
local mask changes: 263702.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2145716.0, 2142876.0, 2208408.0, 263702.0, 2169528.0]
Doing local aggregation!
test acc on this client before 1406 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.008357
Client Index = 3	Epoch: 1	Loss: 0.014661
Client Index = 3	Epoch: 2	Loss: 0.016240
Client Index = 3	Epoch: 3	Loss: 0.014679
Client Index = 3	Epoch: 4	Loss: 0.031805
test acc on this client after 1309 / 2049 : 0.64
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 4
local mask changes: 263632.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2186620.0, 2186472.0, 2247794.0, 2206794.0, 263632.0]
Doing local aggregation!
test acc on this client before 1401 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.009210
Client Index = 4	Epoch: 1	Loss: 0.009916
Client Index = 4	Epoch: 2	Loss: 0.009513
Client Index = 4	Epoch: 3	Loss: 0.008604
Client Index = 4	Epoch: 4	Loss: 0.007156
test acc on this client after 1388 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.025442735979675633}
################local_test_on_all_clients after local training in communication round: 85
{'test_acc_after': 0.6363345057731109, 'test_loss_after': 1.685345933962854}
################local_test_on_all_clients before local training in communication round: 85
{'test_acc_before': 0.685041710379258, 'test_loss_before': 1.4331411512851733}
################Communication round : 86
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 0
local mask changes: 233404.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [233404.0, 2165912.0, 2175292.0, 2139156.0, 2185544.0]
Doing local aggregation!
test acc on this client before 1395 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.007396
Client Index = 0	Epoch: 1	Loss: 0.006931
Client Index = 0	Epoch: 2	Loss: 0.007908
Client Index = 0	Epoch: 3	Loss: 0.007074
Client Index = 0	Epoch: 4	Loss: 0.005243
test acc on this client after 1393 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 1
local mask changes: 233184.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2144710.0, 233184.0, 2196022.0, 2159340.0, 2203464.0]
Doing local aggregation!
test acc on this client before 1373 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.006752
Client Index = 1	Epoch: 1	Loss: 0.004889
Client Index = 1	Epoch: 2	Loss: 0.004446
Client Index = 1	Epoch: 3	Loss: 0.004412
Client Index = 1	Epoch: 4	Loss: 0.005513
test acc on this client after 1385 / 2045 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 2
local mask changes: 233200.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2142548.0, 2192868.0, 233200.0, 2154420.0, 2209430.0]
Doing local aggregation!
test acc on this client before 1427 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.006535
Client Index = 2	Epoch: 1	Loss: 0.005483
Client Index = 2	Epoch: 2	Loss: 0.006725
Client Index = 2	Epoch: 3	Loss: 0.006356
Client Index = 2	Epoch: 4	Loss: 0.038146
test acc on this client after 1270 / 2051 : 0.62
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 3
local mask changes: 233232.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2114396.0, 2161058.0, 2163748.0, 233232.0, 2181438.0]
Doing local aggregation!
test acc on this client before 1421 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.006652
Client Index = 3	Epoch: 1	Loss: 0.008362
Client Index = 3	Epoch: 2	Loss: 0.326705
Client Index = 3	Epoch: 3	Loss: 0.450088
Client Index = 3	Epoch: 4	Loss: 0.421431
test acc on this client after 1088 / 2049 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 4
local mask changes: 233022.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2155292.0, 2196110.0, 2203100.0, 2169576.0, 233022.0]
Doing local aggregation!
test acc on this client before 1424 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.005893
Client Index = 4	Epoch: 1	Loss: 0.006277
Client Index = 4	Epoch: 2	Loss: 0.006541
Client Index = 4	Epoch: 3	Loss: 0.014860
Client Index = 4	Epoch: 4	Loss: 0.016124
test acc on this client after 1356 / 2051 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.05546971907012392}
################local_test_on_all_clients after local training in communication round: 86
{'test_acc_after': 0.6336231168534024, 'test_loss_after': 1.6746368356578052}
################local_test_on_all_clients before local training in communication round: 86
{'test_acc_before': 0.6870888218157638, 'test_loss_before': 1.4195159028456037}
################Communication round : 87
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 0
local mask changes: 204368.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [204368.0, 2129264.0, 2122938.0, 2100464.0, 2136736.0]
Doing local aggregation!
test acc on this client before 1417 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.007247
Client Index = 0	Epoch: 1	Loss: 0.006722
Client Index = 0	Epoch: 2	Loss: 0.009536
Client Index = 0	Epoch: 3	Loss: 0.006522
Client Index = 0	Epoch: 4	Loss: 0.006294
test acc on this client after 1411 / 2050 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 1
local mask changes: 204266.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2129174.0, 204266.0, 2138764.0, 2113808.0, 2147774.0]
Doing local aggregation!
test acc on this client before 1387 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.007095
Client Index = 1	Epoch: 1	Loss: 0.006970
Client Index = 1	Epoch: 2	Loss: 0.006613
Client Index = 1	Epoch: 3	Loss: 0.013980
Client Index = 1	Epoch: 4	Loss: 0.011126
test acc on this client after 1364 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 2
local mask changes: 204432.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2133838.0, 2151240.0, 204432.0, 2116546.0, 2154288.0]
Doing local aggregation!
test acc on this client before 1418 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.006265
Client Index = 2	Epoch: 1	Loss: 0.005084
Client Index = 2	Epoch: 2	Loss: 0.005432
Client Index = 2	Epoch: 3	Loss: 0.005093
Client Index = 2	Epoch: 4	Loss: 0.004839
test acc on this client after 1439 / 2051 : 0.70
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 3
local mask changes: 204562.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2157344.0, 2174122.0, 2167940.0, 204562.0, 2181194.0]
Doing local aggregation!
test acc on this client before 1417 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.008579
Client Index = 3	Epoch: 1	Loss: 0.005744
Client Index = 3	Epoch: 2	Loss: 0.008420
Client Index = 3	Epoch: 3	Loss: 0.007272
Client Index = 3	Epoch: 4	Loss: 0.005896
test acc on this client after 1409 / 2049 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 4
local mask changes: 204480.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2141604.0, 2153518.0, 2147068.0, 2126656.0, 204480.0]
Doing local aggregation!
test acc on this client before 1420 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.006755
Client Index = 4	Epoch: 1	Loss: 0.010758
Client Index = 4	Epoch: 2	Loss: 0.008874
Client Index = 4	Epoch: 3	Loss: 0.169856
Client Index = 4	Epoch: 4	Loss: 0.475199
test acc on this client after 1161 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.032646877405290695}
################local_test_on_all_clients after local training in communication round: 87
{'test_acc_after': 0.6621224333203305, 'test_loss_after': 1.5238412690378254}
################local_test_on_all_clients before local training in communication round: 87
{'test_acc_before': 0.6889462477697721, 'test_loss_before': 1.4014653562966788}
################Communication round : 88
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 0
local mask changes: 177312.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [177312.0, 2073602.0, 2079144.0, 2122544.0, 2086600.0]
Doing local aggregation!
test acc on this client before 1406 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.006102
Client Index = 0	Epoch: 1	Loss: 0.005151
Client Index = 0	Epoch: 2	Loss: 0.006298
Client Index = 0	Epoch: 3	Loss: 0.006120
Client Index = 0	Epoch: 4	Loss: 0.005185
test acc on this client after 1410 / 2050 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 1
local mask changes: 177216.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2077838.0, 177216.0, 2097340.0, 2136834.0, 2101450.0]
Doing local aggregation!
test acc on this client before 1383 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.005058
Client Index = 1	Epoch: 1	Loss: 0.004821
Client Index = 1	Epoch: 2	Loss: 0.004543
Client Index = 1	Epoch: 3	Loss: 0.004384
Client Index = 1	Epoch: 4	Loss: 0.004668
test acc on this client after 1380 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 2
local mask changes: 177334.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2077840.0, 2092050.0, 177334.0, 2139968.0, 2100774.0]
Doing local aggregation!
test acc on this client before 1441 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.005804
Client Index = 2	Epoch: 1	Loss: 0.005047
Client Index = 2	Epoch: 2	Loss: 0.004825
Client Index = 2	Epoch: 3	Loss: 0.004331
Client Index = 2	Epoch: 4	Loss: 0.004582
test acc on this client after 1457 / 2051 : 0.71
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 3
local mask changes: 177262.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2117138.0, 2129090.0, 2132550.0, 177262.0, 2139806.0]
Doing local aggregation!
test acc on this client before 1418 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.005815
Client Index = 3	Epoch: 1	Loss: 0.005590
Client Index = 3	Epoch: 2	Loss: 0.005865
Client Index = 3	Epoch: 3	Loss: 0.011087
Client Index = 3	Epoch: 4	Loss: 0.477835
test acc on this client after 1161 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 4
local mask changes: 177384.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2128426.0, 2139212.0, 2145648.0, 2174640.0, 177384.0]
Doing local aggregation!
test acc on this client before 1414 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.009275
Client Index = 4	Epoch: 1	Loss: 0.389016
Client Index = 4	Epoch: 2	Loss: 0.491422
Client Index = 4	Epoch: 3	Loss: 0.466539
Client Index = 4	Epoch: 4	Loss: 0.442504
test acc on this client after 1038 / 2051 : 0.51
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.09527465086416056}
################local_test_on_all_clients after local training in communication round: 88
{'test_acc_after': 0.6291438264610719, 'test_loss_after': 1.6724659822372536}
################local_test_on_all_clients before local training in communication round: 88
{'test_acc_before': 0.6892372155212024, 'test_loss_before': 1.3774693103144315}
################Communication round : 89
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 0
local mask changes: 151920.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [151920.0, 2031504.0, 2028596.0, 2074522.0, 2094410.0]
Doing local aggregation!
test acc on this client before 1404 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.008653
Client Index = 0	Epoch: 1	Loss: 0.064357
Client Index = 0	Epoch: 2	Loss: 0.493799
Client Index = 0	Epoch: 3	Loss: 0.502216
Client Index = 0	Epoch: 4	Loss: 0.488509
test acc on this client after 1158 / 2050 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 1
local mask changes: 151924.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2030212.0, 151924.0, 2046254.0, 2088344.0, 2109340.0]
Doing local aggregation!
test acc on this client before 1387 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.007344
Client Index = 1	Epoch: 1	Loss: 0.018288
Client Index = 1	Epoch: 2	Loss: 0.375440
Client Index = 1	Epoch: 3	Loss: 0.513876
Client Index = 1	Epoch: 4	Loss: 0.511160
test acc on this client after 1135 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 2
local mask changes: 151996.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2029198.0, 2047776.0, 151996.0, 2089320.0, 2110296.0]
Doing local aggregation!
test acc on this client before 1430 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.020957
Client Index = 2	Epoch: 1	Loss: 0.408351
Client Index = 2	Epoch: 2	Loss: 0.518485
Client Index = 2	Epoch: 3	Loss: 0.477189
Client Index = 2	Epoch: 4	Loss: 0.437792
test acc on this client after 1187 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 3
local mask changes: 151960.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2108592.0, 2122992.0, 2123370.0, 151960.0, 2165438.0]
Doing local aggregation!
test acc on this client before 1401 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.009588
Client Index = 3	Epoch: 1	Loss: 0.007849
Client Index = 3	Epoch: 2	Loss: 0.013937
Client Index = 3	Epoch: 3	Loss: 0.464722
Client Index = 3	Epoch: 4	Loss: 0.521925
test acc on this client after 1141 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 4
local mask changes: 151998.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2138892.0, 2153648.0, 2154576.0, 2186338.0, 151998.0]
Doing local aggregation!
test acc on this client before 1393 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.008869
Client Index = 4	Epoch: 1	Loss: 0.007696
Client Index = 4	Epoch: 2	Loss: 0.006202
Client Index = 4	Epoch: 3	Loss: 0.005834
Client Index = 4	Epoch: 4	Loss: 0.005159
test acc on this client after 1414 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2359279278376881}
################local_test_on_all_clients after local training in communication round: 89
{'test_acc_after': 0.5889818298786198, 'test_loss_after': 1.778446115034411}
################local_test_on_all_clients before local training in communication round: 89
{'test_acc_before': 0.6846535165325471, 'test_loss_before': 1.3713012683612553}
################Communication round : 90
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 0
local mask changes: 128230.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [128230.0, 2038416.0, 2037880.0, 2116320.0, 2152162.0]
Doing local aggregation!
test acc on this client before 1408 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.016907
Client Index = 0	Epoch: 1	Loss: 0.021891
Client Index = 0	Epoch: 2	Loss: 0.056986
Client Index = 0	Epoch: 3	Loss: 0.424710
Client Index = 0	Epoch: 4	Loss: 0.437153
test acc on this client after 1062 / 2050 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 1
local mask changes: 128240.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2037114.0, 128240.0, 2052612.0, 2126808.0, 2164938.0]
Doing local aggregation!
test acc on this client before 1383 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.020830
Client Index = 1	Epoch: 1	Loss: 0.020378
Client Index = 1	Epoch: 2	Loss: 0.020354
Client Index = 1	Epoch: 3	Loss: 0.410662
Client Index = 1	Epoch: 4	Loss: 0.453501
test acc on this client after 1110 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 2
local mask changes: 128394.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2040326.0, 2056698.0, 128394.0, 2132996.0, 2170514.0]
Doing local aggregation!
test acc on this client before 1414 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.021960
Client Index = 2	Epoch: 1	Loss: 0.016892
Client Index = 2	Epoch: 2	Loss: 0.014894
Client Index = 2	Epoch: 3	Loss: 0.054773
Client Index = 2	Epoch: 4	Loss: 0.429779
test acc on this client after 1149 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 3
local mask changes: 128324.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2110694.0, 2123906.0, 2125498.0, 128324.0, 2211124.0]
Doing local aggregation!
test acc on this client before 1392 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.016994
Client Index = 3	Epoch: 1	Loss: 0.047425
Client Index = 3	Epoch: 2	Loss: 0.395090
Client Index = 3	Epoch: 3	Loss: 0.430318
Client Index = 3	Epoch: 4	Loss: 0.383810
test acc on this client after 1110 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 4
local mask changes: 128330.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2115804.0, 2129758.0, 2131474.0, 2182676.0, 128330.0]
Doing local aggregation!
test acc on this client before 1425 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.019352
Client Index = 4	Epoch: 1	Loss: 0.020165
Client Index = 4	Epoch: 2	Loss: 0.025719
Client Index = 4	Epoch: 3	Loss: 0.360502
Client Index = 4	Epoch: 4	Loss: 0.455163
test acc on this client after 1139 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.18304841556125415}
################local_test_on_all_clients after local training in communication round: 90
{'test_acc_after': 0.543623425435489, 'test_loss_after': 2.020142305852551}
################local_test_on_all_clients before local training in communication round: 90
{'test_acc_before': 0.6853342996144711, 'test_loss_before': 1.3590017939984538}
################Communication round : 91
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 0
local mask changes: 106474.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [106474.0, 2090716.0, 2095202.0, 2155014.0, 2158818.0]
Doing local aggregation!
test acc on this client before 1368 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.021828
Client Index = 0	Epoch: 1	Loss: 0.041470
Client Index = 0	Epoch: 2	Loss: 0.353189
Client Index = 0	Epoch: 3	Loss: 0.394312
Client Index = 0	Epoch: 4	Loss: 0.395019
test acc on this client after 1161 / 2050 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 1
local mask changes: 106540.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2089812.0, 106540.0, 2108708.0, 2165194.0, 2170050.0]
Doing local aggregation!
test acc on this client before 1369 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.015350
Client Index = 1	Epoch: 1	Loss: 0.014383
Client Index = 1	Epoch: 2	Loss: 0.016835
Client Index = 1	Epoch: 3	Loss: 0.129133
Client Index = 1	Epoch: 4	Loss: 0.355705
test acc on this client after 1114 / 2045 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 2
local mask changes: 106596.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2090738.0, 2104876.0, 106596.0, 2167150.0, 2171690.0]
Doing local aggregation!
test acc on this client before 1395 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.017143
Client Index = 2	Epoch: 1	Loss: 0.011391
Client Index = 2	Epoch: 2	Loss: 0.123756
Client Index = 2	Epoch: 3	Loss: 0.383010
Client Index = 2	Epoch: 4	Loss: 0.385309
test acc on this client after 1155 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 3
local mask changes: 106532.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2158530.0, 2169272.0, 2175150.0, 106532.0, 2217858.0]
Doing local aggregation!
test acc on this client before 1385 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.016277
Client Index = 3	Epoch: 1	Loss: 0.019011
Client Index = 3	Epoch: 2	Loss: 0.011777
Client Index = 3	Epoch: 3	Loss: 0.009623
Client Index = 3	Epoch: 4	Loss: 0.015061
test acc on this client after 1342 / 2049 : 0.65
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 4
local mask changes: 106492.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2158016.0, 2170108.0, 2176202.0, 2213796.0, 106492.0]
Doing local aggregation!
test acc on this client before 1392 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.019289
Client Index = 4	Epoch: 1	Loss: 0.016898
Client Index = 4	Epoch: 2	Loss: 0.033180
Client Index = 4	Epoch: 3	Loss: 0.267934
Client Index = 4	Epoch: 4	Loss: 0.411136
test acc on this client after 1127 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.13912084534773794}
################local_test_on_all_clients after local training in communication round: 91
{'test_acc_after': 0.5757332723932673, 'test_loss_after': 1.8832816621990875}
################local_test_on_all_clients before local training in communication round: 91
{'test_acc_before': 0.6743087100882877, 'test_loss_before': 1.407210068607737}
################Communication round : 92
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 0
local mask changes: 86648.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [86648.0, 2130352.0, 2131888.0, 2192478.0, 2192198.0]
Doing local aggregation!
test acc on this client before 1392 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.013937
Client Index = 0	Epoch: 1	Loss: 0.015710
Client Index = 0	Epoch: 2	Loss: 0.028989
Client Index = 0	Epoch: 3	Loss: 0.147251
Client Index = 0	Epoch: 4	Loss: 0.391792
test acc on this client after 1112 / 2050 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 1
local mask changes: 86732.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2125192.0, 86732.0, 2139772.0, 2197744.0, 2197674.0]
Doing local aggregation!
test acc on this client before 1380 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.011704
Client Index = 1	Epoch: 1	Loss: 0.009648
Client Index = 1	Epoch: 2	Loss: 0.008330
Client Index = 1	Epoch: 3	Loss: 0.274107
Client Index = 1	Epoch: 4	Loss: 0.393127
test acc on this client after 1134 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 2
local mask changes: 86666.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2129950.0, 2143178.0, 86666.0, 2203296.0, 2202924.0]
Doing local aggregation!
test acc on this client before 1410 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.013609
Client Index = 2	Epoch: 1	Loss: 0.009497
Client Index = 2	Epoch: 2	Loss: 0.007015
Client Index = 2	Epoch: 3	Loss: 0.009885
Client Index = 2	Epoch: 4	Loss: 0.010458
test acc on this client after 1369 / 2051 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 3
local mask changes: 86680.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2178046.0, 2188180.0, 2190490.0, 86680.0, 2232604.0]
Doing local aggregation!
test acc on this client before 1406 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.014416
Client Index = 3	Epoch: 1	Loss: 0.012332
Client Index = 3	Epoch: 2	Loss: 0.007786
Client Index = 3	Epoch: 3	Loss: 0.006301
Client Index = 3	Epoch: 4	Loss: 0.007818
test acc on this client after 1389 / 2049 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 4
local mask changes: 86666.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2189030.0, 2200526.0, 2202490.0, 2243900.0, 86666.0]
Doing local aggregation!
test acc on this client before 1391 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.012688
Client Index = 4	Epoch: 1	Loss: 0.008139
Client Index = 4	Epoch: 2	Loss: 0.007093
Client Index = 4	Epoch: 3	Loss: 0.008004
Client Index = 4	Epoch: 4	Loss: 0.011527
test acc on this client after 1390 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.05764656312887234}
################local_test_on_all_clients after local training in communication round: 92
{'test_acc_after': 0.6240102741782179, 'test_loss_after': 1.7090322238590232}
################local_test_on_all_clients before local training in communication round: 92
{'test_acc_before': 0.6811409362179328, 'test_loss_before': 1.4080825932278656}
################Communication round : 93
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 0
local mask changes: 68722.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [68722.0, 2155864.0, 2160890.0, 2204716.0, 2215438.0]
Doing local aggregation!
test acc on this client before 1389 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.008146
Client Index = 0	Epoch: 1	Loss: 0.007236
Client Index = 0	Epoch: 2	Loss: 0.009001
Client Index = 0	Epoch: 3	Loss: 0.010809
Client Index = 0	Epoch: 4	Loss: 0.009495
test acc on this client after 1260 / 2050 : 0.61
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 1
local mask changes: 68780.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2156444.0, 68780.0, 2168852.0, 2209078.0, 2221302.0]
Doing local aggregation!
test acc on this client before 1359 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.007296
Client Index = 1	Epoch: 1	Loss: 0.009186
Client Index = 1	Epoch: 2	Loss: 0.007848
Client Index = 1	Epoch: 3	Loss: 0.005698
Client Index = 1	Epoch: 4	Loss: 0.013538
test acc on this client after 1360 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 2
local mask changes: 68756.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2153342.0, 2160580.0, 68756.0, 2206108.0, 2218006.0]
Doing local aggregation!
test acc on this client before 1417 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.006300
Client Index = 2	Epoch: 1	Loss: 0.005962
Client Index = 2	Epoch: 2	Loss: 0.005043
Client Index = 2	Epoch: 3	Loss: 0.004565
Client Index = 2	Epoch: 4	Loss: 0.004907
test acc on this client after 1423 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 3
local mask changes: 68694.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2195808.0, 2199980.0, 2206638.0, 68694.0, 2243872.0]
Doing local aggregation!
test acc on this client before 1416 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.006787
Client Index = 3	Epoch: 1	Loss: 0.009570
Client Index = 3	Epoch: 2	Loss: 0.008414
Client Index = 3	Epoch: 3	Loss: 0.011405
Client Index = 3	Epoch: 4	Loss: 0.344953
test acc on this client after 1178 / 2049 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 4
local mask changes: 68672.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2207246.0, 2212204.0, 2218000.0, 2243534.0, 68672.0]
Doing local aggregation!
test acc on this client before 1416 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.006795
Client Index = 4	Epoch: 1	Loss: 0.005842
Client Index = 4	Epoch: 2	Loss: 0.005311
Client Index = 4	Epoch: 3	Loss: 0.005640
Client Index = 4	Epoch: 4	Loss: 0.005439
test acc on this client after 1415 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.021007436948153664}
################local_test_on_all_clients after local training in communication round: 93
{'test_acc_after': 0.6476601348981189, 'test_loss_after': 1.599880942314371}
################local_test_on_all_clients before local training in communication round: 93
{'test_acc_before': 0.6828909785146067, 'test_loss_before': 1.4218467819954004}
################Communication round : 94
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 0
local mask changes: 52872.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [52872.0, 2170234.0, 2166518.0, 2206108.0, 2217084.0]
Doing local aggregation!
test acc on this client before 1386 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.006455
Client Index = 0	Epoch: 1	Loss: 0.005997
Client Index = 0	Epoch: 2	Loss: 0.005611
Client Index = 0	Epoch: 3	Loss: 0.005421
Client Index = 0	Epoch: 4	Loss: 0.005529
test acc on this client after 1418 / 2050 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 1
local mask changes: 52868.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2170254.0, 52868.0, 2173572.0, 2209654.0, 2222222.0]
Doing local aggregation!
test acc on this client before 1369 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.005693
Client Index = 1	Epoch: 1	Loss: 0.004989
Client Index = 1	Epoch: 2	Loss: 0.005048
Client Index = 1	Epoch: 3	Loss: 0.004837
Client Index = 1	Epoch: 4	Loss: 0.007432
test acc on this client after 1359 / 2045 : 0.66
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 2
local mask changes: 52838.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2165940.0, 2172928.0, 52838.0, 2203084.0, 2214746.0]
Doing local aggregation!
test acc on this client before 1421 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.006171
Client Index = 2	Epoch: 1	Loss: 0.005748
Client Index = 2	Epoch: 2	Loss: 0.005071
Client Index = 2	Epoch: 3	Loss: 0.004913
Client Index = 2	Epoch: 4	Loss: 0.004686
test acc on this client after 1424 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 3
local mask changes: 52792.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2210776.0, 2214898.0, 2211008.0, 52792.0, 2245442.0]
Doing local aggregation!
test acc on this client before 1409 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.005801
Client Index = 3	Epoch: 1	Loss: 0.005538
Client Index = 3	Epoch: 2	Loss: 0.004649
Client Index = 3	Epoch: 3	Loss: 0.006737
Client Index = 3	Epoch: 4	Loss: 0.006650
test acc on this client after 1404 / 2049 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 4
local mask changes: 52808.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2216948.0, 2222170.0, 2215664.0, 2238102.0, 52808.0]
Doing local aggregation!
test acc on this client before 1425 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.005995
Client Index = 4	Epoch: 1	Loss: 0.005588
Client Index = 4	Epoch: 2	Loss: 0.004810
Client Index = 4	Epoch: 3	Loss: 0.004830
Client Index = 4	Epoch: 4	Loss: 0.007016
test acc on this client after 1422 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.005648650292269125}
################local_test_on_all_clients after local training in communication round: 94
{'test_acc_after': 0.6858166180378359, 'test_loss_after': 1.395102532395185}
################local_test_on_all_clients before local training in communication round: 94
{'test_acc_before': 0.6841607048761276, 'test_loss_before': 1.4113190627144125}
################Communication round : 95
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 0
local mask changes: 38932.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [38932.0, 2170064.0, 2164562.0, 2210212.0, 2213126.0]
Doing local aggregation!
test acc on this client before 1418 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.005613
Client Index = 0	Epoch: 1	Loss: 0.005473
Client Index = 0	Epoch: 2	Loss: 0.005030
Client Index = 0	Epoch: 3	Loss: 0.006078
Client Index = 0	Epoch: 4	Loss: 0.006114
test acc on this client after 1412 / 2050 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 1
local mask changes: 38892.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2170702.0, 38892.0, 2171440.0, 2214064.0, 2218658.0]
Doing local aggregation!
test acc on this client before 1389 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.005495
Client Index = 1	Epoch: 1	Loss: 0.008767
Client Index = 1	Epoch: 2	Loss: 0.012316
Client Index = 1	Epoch: 3	Loss: 0.006790
Client Index = 1	Epoch: 4	Loss: 0.005461
test acc on this client after 1374 / 2045 : 0.67
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 2
local mask changes: 38914.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2164632.0, 2171086.0, 38914.0, 2207544.0, 2208696.0]
Doing local aggregation!
test acc on this client before 1426 / 2051 : 0.70
Client Index = 2	Epoch: 0	Loss: 0.005306
Client Index = 2	Epoch: 1	Loss: 0.005112
Client Index = 2	Epoch: 2	Loss: 0.006378
Client Index = 2	Epoch: 3	Loss: 0.119150
Client Index = 2	Epoch: 4	Loss: 0.525348
test acc on this client after 1122 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 3
local mask changes: 38884.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2210484.0, 2214002.0, 2207732.0, 38884.0, 2240882.0]
Doing local aggregation!
test acc on this client before 1426 / 2049 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.004811
Client Index = 3	Epoch: 1	Loss: 0.004851
Client Index = 3	Epoch: 2	Loss: 0.004620
Client Index = 3	Epoch: 3	Loss: 0.005460
Client Index = 3	Epoch: 4	Loss: 0.006958
test acc on this client after 1425 / 2049 : 0.70
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 4
local mask changes: 38912.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2213644.0, 2218716.0, 2208584.0, 2241270.0, 38912.0]
Doing local aggregation!
test acc on this client before 1418 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.005048
Client Index = 4	Epoch: 1	Loss: 0.004825
Client Index = 4	Epoch: 2	Loss: 0.004659
Client Index = 4	Epoch: 3	Loss: 0.004883
Client Index = 4	Epoch: 4	Loss: 0.004800
test acc on this client after 1417 / 2051 : 0.69
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.031173954097630113}
################local_test_on_all_clients after local training in communication round: 95
{'test_acc_after': 0.6588114089451483, 'test_loss_after': 1.5039883014805835}
################local_test_on_all_clients before local training in communication round: 95
{'test_acc_before': 0.6907029655219514, 'test_loss_before': 1.3773127917950585}
################Communication round : 96
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 0
local mask changes: 27094.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [27094.0, 2166954.0, 2160642.0, 2206788.0, 2208232.0]
Doing local aggregation!
test acc on this client before 1422 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.007420
Client Index = 0	Epoch: 1	Loss: 0.008906
Client Index = 0	Epoch: 2	Loss: 0.330199
Client Index = 0	Epoch: 3	Loss: 0.558506
Client Index = 0	Epoch: 4	Loss: 0.529839
test acc on this client after 1079 / 2050 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 1
local mask changes: 27082.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2168342.0, 27082.0, 2168232.0, 2211322.0, 2214730.0]
Doing local aggregation!
test acc on this client before 1393 / 2045 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.006128
Client Index = 1	Epoch: 1	Loss: 0.005682
Client Index = 1	Epoch: 2	Loss: 0.005054
Client Index = 1	Epoch: 3	Loss: 0.005867
Client Index = 1	Epoch: 4	Loss: 0.194360
test acc on this client after 1129 / 2045 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 2
local mask changes: 27092.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2166480.0, 2173260.0, 27092.0, 2209668.0, 2209576.0]
Doing local aggregation!
test acc on this client before 1418 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.006817
Client Index = 2	Epoch: 1	Loss: 0.007085
Client Index = 2	Epoch: 2	Loss: 0.007204
Client Index = 2	Epoch: 3	Loss: 0.006646
Client Index = 2	Epoch: 4	Loss: 0.010021
test acc on this client after 1394 / 2051 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 3
local mask changes: 27088.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2206754.0, 2210386.0, 2203426.0, 27088.0, 2236390.0]
Doing local aggregation!
test acc on this client before 1422 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.005607
Client Index = 3	Epoch: 1	Loss: 0.005206
Client Index = 3	Epoch: 2	Loss: 0.004879
Client Index = 3	Epoch: 3	Loss: 0.004925
Client Index = 3	Epoch: 4	Loss: 0.004776
test acc on this client after 1425 / 2049 : 0.70
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 4
local mask changes: 27106.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2207936.0, 2213370.0, 2202552.0, 2236300.0, 27106.0]
Doing local aggregation!
test acc on this client before 1410 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.005932
Client Index = 4	Epoch: 1	Loss: 0.005535
Client Index = 4	Epoch: 2	Loss: 0.005780
Client Index = 4	Epoch: 3	Loss: 0.005104
Client Index = 4	Epoch: 4	Loss: 0.154007
test acc on this client after 1144 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.07565946146993119}
################local_test_on_all_clients after local training in communication round: 96
{'test_acc_after': 0.602265210463407, 'test_loss_after': 1.7852022572852864}
################local_test_on_all_clients before local training in communication round: 96
{'test_acc_before': 0.6895337585806789, 'test_loss_before': 1.3771192116452802}
################Communication round : 97
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 0
local mask changes: 17384.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [17384.0, 2170530.0, 2168988.0, 2208174.0, 2209216.0]
Doing local aggregation!
test acc on this client before 1392 / 2050 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.010652
Client Index = 0	Epoch: 1	Loss: 0.007161
Client Index = 0	Epoch: 2	Loss: 0.006475
Client Index = 0	Epoch: 3	Loss: 0.006389
Client Index = 0	Epoch: 4	Loss: 0.006844
test acc on this client after 1394 / 2050 : 0.68
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 1
local mask changes: 17388.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2168060.0, 17388.0, 2174592.0, 2210420.0, 2213442.0]
Doing local aggregation!
test acc on this client before 1370 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.072926
Client Index = 1	Epoch: 1	Loss: 0.543128
Client Index = 1	Epoch: 2	Loss: 0.549503
Client Index = 1	Epoch: 3	Loss: 0.496925
Client Index = 1	Epoch: 4	Loss: 0.493950
test acc on this client after 1139 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 2
local mask changes: 17368.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2165828.0, 2173364.0, 17368.0, 2207952.0, 2207318.0]
Doing local aggregation!
test acc on this client before 1421 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.009882
Client Index = 2	Epoch: 1	Loss: 0.007681
Client Index = 2	Epoch: 2	Loss: 0.373137
Client Index = 2	Epoch: 3	Loss: 0.575903
Client Index = 2	Epoch: 4	Loss: 0.524865
test acc on this client after 1157 / 2051 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 3
local mask changes: 17376.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2203312.0, 2208272.0, 2207790.0, 17376.0, 2232190.0]
Doing local aggregation!
test acc on this client before 1421 / 2049 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.007830
Client Index = 3	Epoch: 1	Loss: 0.011030
Client Index = 3	Epoch: 2	Loss: 0.409877
Client Index = 3	Epoch: 3	Loss: 0.602114
Client Index = 3	Epoch: 4	Loss: 0.533637
test acc on this client after 1119 / 2049 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 4
local mask changes: 17380.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2206548.0, 2213160.0, 2208420.0, 2234536.0, 17380.0]
Doing local aggregation!
test acc on this client before 1421 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.046194
Client Index = 4	Epoch: 1	Loss: 0.526964
Client Index = 4	Epoch: 2	Loss: 0.569538
Client Index = 4	Epoch: 3	Loss: 0.516838
Client Index = 4	Epoch: 4	Loss: 0.481166
test acc on this client after 1080 / 2051 : 0.53
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.2956243183018108}
################local_test_on_all_clients after local training in communication round: 97
{'test_acc_after': 0.5747551486502276, 'test_loss_after': 1.854633238466264}
################local_test_on_all_clients before local training in communication round: 97
{'test_acc_before': 0.6856251196830847, 'test_loss_before': 1.3717523069649278}
################Communication round : 98
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 0
local mask changes: 9798.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9798.0, 2172902.0, 2170664.0, 2207638.0, 2210892.0]
Doing local aggregation!
test acc on this client before 1405 / 2050 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.043760
Client Index = 0	Epoch: 1	Loss: 0.409295
Client Index = 0	Epoch: 2	Loss: 0.443564
Client Index = 0	Epoch: 3	Loss: 0.429971
Client Index = 0	Epoch: 4	Loss: 0.398590
test acc on this client after 1192 / 2050 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 1
local mask changes: 9798.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2174782.0, 9798.0, 2177860.0, 2212000.0, 2217158.0]
Doing local aggregation!
test acc on this client before 1369 / 2045 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.017357
Client Index = 1	Epoch: 1	Loss: 0.067932
Client Index = 1	Epoch: 2	Loss: 0.428320
Client Index = 1	Epoch: 3	Loss: 0.458656
Client Index = 1	Epoch: 4	Loss: 0.439302
test acc on this client after 1157 / 2045 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 2
local mask changes: 9806.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2172060.0, 2177436.0, 9806.0, 2209784.0, 2210788.0]
Doing local aggregation!
test acc on this client before 1409 / 2051 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.016455
Client Index = 2	Epoch: 1	Loss: 0.114330
Client Index = 2	Epoch: 2	Loss: 0.460570
Client Index = 2	Epoch: 3	Loss: 0.465350
Client Index = 2	Epoch: 4	Loss: 0.442784
test acc on this client after 1127 / 2051 : 0.55
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 3
local mask changes: 9798.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2209352.0, 2211766.0, 2210036.0, 9798.0, 2235486.0]
Doing local aggregation!
test acc on this client before 1383 / 2049 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.024297
Client Index = 3	Epoch: 1	Loss: 0.302183
Client Index = 3	Epoch: 2	Loss: 0.454099
Client Index = 3	Epoch: 3	Loss: 0.451145
Client Index = 3	Epoch: 4	Loss: 0.407345
test acc on this client after 1145 / 2049 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 4
local mask changes: 9798.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2212832.0, 2217104.0, 2211282.0, 2235632.0, 9798.0]
Doing local aggregation!
test acc on this client before 1408 / 2051 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.027785
Client Index = 4	Epoch: 1	Loss: 0.404097
Client Index = 4	Epoch: 2	Loss: 0.449667
Client Index = 4	Epoch: 3	Loss: 0.437567
Client Index = 4	Epoch: 4	Loss: 0.439978
test acc on this client after 1181 / 2051 : 0.58
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.32137593455356067}
################local_test_on_all_clients after local training in communication round: 98
{'test_acc_after': 0.5662694980782004, 'test_loss_after': 1.904455543343007}
################local_test_on_all_clients before local training in communication round: 98
{'test_acc_before': 0.6806486512495453, 'test_loss_before': 1.3884455992181715}
################Communication round : 99
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 0
local mask changes: 4364.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4364.0, 2176644.0, 2174078.0, 2211006.0, 2214414.0]
Doing local aggregation!
test acc on this client before 1380 / 2050 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.022268
Client Index = 0	Epoch: 1	Loss: 0.019025
Client Index = 0	Epoch: 2	Loss: 0.045431
Client Index = 0	Epoch: 3	Loss: 0.301032
Client Index = 0	Epoch: 4	Loss: 0.359599
test acc on this client after 1151 / 2050 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 1
local mask changes: 4362.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2176718.0, 4362.0, 2181254.0, 2215412.0, 2220824.0]
Doing local aggregation!
test acc on this client before 1352 / 2045 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.017931
Client Index = 1	Epoch: 1	Loss: 0.013613
Client Index = 1	Epoch: 2	Loss: 0.109023
Client Index = 1	Epoch: 3	Loss: 0.347718
Client Index = 1	Epoch: 4	Loss: 0.339430
test acc on this client after 1135 / 2045 : 0.56
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 2
local mask changes: 4366.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2174250.0, 2181260.0, 4366.0, 2213306.0, 2214568.0]
Doing local aggregation!
test acc on this client before 1400 / 2051 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.018587
Client Index = 2	Epoch: 1	Loss: 0.013091
Client Index = 2	Epoch: 2	Loss: 0.021033
Client Index = 2	Epoch: 3	Loss: 0.073298
Client Index = 2	Epoch: 4	Loss: 0.318884
test acc on this client after 1166 / 2051 : 0.57
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 3
local mask changes: 4362.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2211070.0, 2215438.0, 2213388.0, 4362.0, 2239098.0]
Doing local aggregation!
test acc on this client before 1392 / 2049 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.021636
Client Index = 3	Epoch: 1	Loss: 0.018653
Client Index = 3	Epoch: 2	Loss: 0.028733
Client Index = 3	Epoch: 3	Loss: 0.023610
Client Index = 3	Epoch: 4	Loss: 0.175365
test acc on this client after 1102 / 2049 : 0.54
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 4
local mask changes: 4366.0 / 11220132
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2214538.0, 2220812.0, 2214684.0, 2239006.0, 4366.0]
Doing local aggregation!
test acc on this client before 1391 / 2051 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.018495
Client Index = 4	Epoch: 1	Loss: 0.019435
Client Index = 4	Epoch: 2	Loss: 0.086789
Client Index = 4	Epoch: 3	Loss: 0.308688
Client Index = 4	Epoch: 4	Loss: 0.351078
test acc on this client after 1058 / 2051 : 0.52
-----------------------------------
training flops per data 2649498112.0
full flops for search 3332813100
{'training_loss': 0.12289783126717357}
################local_test_on_all_clients after local training in communication round: 99
{'test_acc_after': 0.54772961320538, 'test_loss_after': 2.048526035186873}
################local_test_on_all_clients before local training in communication round: 99
{'test_acc_before': 0.6748901638678289, 'test_loss_before': 1.3941622267551965}
