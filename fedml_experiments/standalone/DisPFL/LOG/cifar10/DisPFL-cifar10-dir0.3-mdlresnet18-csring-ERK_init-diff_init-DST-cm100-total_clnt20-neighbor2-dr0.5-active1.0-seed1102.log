Namespace(active=1.0, anneal_factor=0.5, batch_size=128, ci=0, client_num_in_total=20, client_num_per_round=2, client_optimizer='sgd', comm_round=100, cs='ring', data_dir='/Date/FL/DisPFL-master/data/', dataset='cifar10', dense_ratio=0.5, diff_spa=False, different_initial=True, dis_gradient_check=True, epochs=5, erk_power_scale=1, frac=0.1, frequency_of_the_test=1, global_test=False, gpu=0, identity='DisPFL-cifar10-dir0.3-mdlresnet18-csring-ERK_init-diff_init-DST-cm100-total_clnt20-neighbor2-dr0.5-active1.0-seed1102', lr=0.1, lr_decay=0.998, model='resnet18', momentum=0, partition_alpha=0.3, partition_method='dir', public_portion=0, record_mask_diff=False, save_masks=False, seed=1102, static=False, strict_avg=False, tag='test', uniform=False, wd=0.0005)
cuda:0
*********partition data***************
train_num2500  test_num503
client_idx = 0, local_sample_number = 2500
train_num2500  test_num503
client_idx = 1, local_sample_number = 2500
train_num2500  test_num504
client_idx = 2, local_sample_number = 2500
train_num2500  test_num504
client_idx = 3, local_sample_number = 2500
train_num2500  test_num504
client_idx = 4, local_sample_number = 2500
train_num2500  test_num503
client_idx = 5, local_sample_number = 2500
train_num2500  test_num505
client_idx = 6, local_sample_number = 2500
train_num2500  test_num504
client_idx = 7, local_sample_number = 2500
train_num2500  test_num504
client_idx = 8, local_sample_number = 2500
train_num2500  test_num506
client_idx = 9, local_sample_number = 2500
train_num2500  test_num503
client_idx = 10, local_sample_number = 2500
train_num2500  test_num505
client_idx = 11, local_sample_number = 2500
train_num2500  test_num504
client_idx = 12, local_sample_number = 2500
train_num2500  test_num505
client_idx = 13, local_sample_number = 2500
train_num2500  test_num503
client_idx = 14, local_sample_number = 2500
train_num2500  test_num503
client_idx = 15, local_sample_number = 2500
train_num2500  test_num504
client_idx = 16, local_sample_number = 2500
train_num2500  test_num503
client_idx = 17, local_sample_number = 2500
train_num2500  test_num503
client_idx = 18, local_sample_number = 2500
train_num2500  test_num503
client_idx = 19, local_sample_number = 2500
DATA Partition: Train [462, 495, 64, 124, 444, 9, 33, 831, 0, 38]; Test [93, 99, 13, 25, 89, 2, 7, 167, 0, 8]
DATA Partition: Train [45, 186, 119, 12, 0, 595, 40, 56, 35, 1412]; Test [9, 38, 24, 3, 0, 119, 8, 12, 7, 283]
DATA Partition: Train [126, 1582, 51, 74, 125, 8, 73, 422, 0, 39]; Test [26, 317, 11, 15, 25, 2, 15, 85, 0, 8]
DATA Partition: Train [713, 819, 31, 15, 50, 488, 22, 1, 282, 79]; Test [143, 164, 7, 3, 10, 98, 5, 1, 57, 16]
DATA Partition: Train [501, 131, 390, 43, 0, 0, 577, 527, 255, 76]; Test [101, 27, 78, 9, 0, 0, 116, 106, 51, 16]
DATA Partition: Train [57, 72, 187, 889, 114, 54, 177, 0, 900, 50]; Test [12, 15, 38, 178, 23, 11, 36, 0, 180, 10]
DATA Partition: Train [682, 447, 57, 141, 141, 145, 380, 432, 29, 46]; Test [137, 90, 12, 29, 29, 29, 76, 87, 6, 10]
DATA Partition: Train [54, 1, 286, 287, 59, 629, 33, 780, 72, 299]; Test [11, 1, 58, 58, 12, 126, 7, 156, 15, 60]
DATA Partition: Train [34, 73, 21, 22, 9, 7, 1125, 1193, 1, 15]; Test [7, 15, 5, 5, 2, 2, 225, 239, 1, 3]
DATA Partition: Train [142, 16, 167, 508, 912, 44, 67, 1, 602, 41]; Test [29, 4, 34, 102, 183, 9, 14, 1, 121, 9]
DATA Partition: Train [954, 9, 459, 368, 100, 1, 198, 0, 318, 93]; Test [191, 2, 92, 74, 20, 1, 40, 0, 64, 19]
DATA Partition: Train [138, 16, 0, 16, 26, 562, 18, 48, 467, 1209]; Test [28, 4, 0, 4, 6, 113, 4, 10, 94, 242]
DATA Partition: Train [112, 8, 332, 101, 1095, 0, 270, 148, 408, 26]; Test [23, 2, 67, 21, 219, 0, 54, 30, 82, 6]
DATA Partition: Train [396, 86, 1297, 47, 42, 0, 248, 27, 177, 180]; Test [80, 18, 260, 10, 9, 0, 50, 6, 36, 36]
DATA Partition: Train [107, 134, 895, 0, 86, 599, 448, 3, 39, 189]; Test [22, 27, 179, 0, 18, 120, 90, 1, 8, 38]
DATA Partition: Train [56, 186, 0, 260, 205, 1443, 68, 0, 282, 0]; Test [12, 38, 0, 52, 41, 289, 14, 0, 57, 0]
DATA Partition: Train [107, 48, 0, 709, 891, 14, 433, 100, 196, 2]; Test [22, 10, 0, 142, 179, 3, 87, 20, 40, 1]
DATA Partition: Train [285, 273, 593, 58, 474, 269, 503, 43, 0, 2]; Test [57, 55, 119, 12, 95, 54, 101, 9, 0, 1]
DATA Partition: Train [27, 340, 24, 927, 214, 19, 98, 58, 49, 744]; Test [6, 68, 5, 186, 43, 4, 20, 12, 10, 149]
DATA Partition: Train [2, 78, 27, 399, 13, 114, 189, 330, 888, 460]; Test [1, 16, 6, 80, 3, 23, 38, 66, 178, 92]
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 128, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 256, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 512, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
############setup_clients (START)#############
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
############setup_clients (END)#############
initialize by ERK
################Communication round : 0
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 0
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [0.0, 4553678.0, 4552166.0]
Doing local aggregation!
test acc on this client before 99 / 503 : 0.20
Client Index = 0	Epoch: 0	Loss: 4.650994
Client Index = 0	Epoch: 1	Loss: 1.829694
Client Index = 0	Epoch: 2	Loss: 1.730170
Client Index = 0	Epoch: 3	Loss: 1.712180
Client Index = 0	Epoch: 4	Loss: 1.680023
test acc on this client after 124 / 503 : 0.25
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 1
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [4553678.0, 0.0, 4552336.0]
Doing local aggregation!
test acc on this client before 38 / 503 : 0.08
Client Index = 1	Epoch: 0	Loss: 4.065814
Client Index = 1	Epoch: 1	Loss: 1.429703
Client Index = 1	Epoch: 2	Loss: 1.320245
Client Index = 1	Epoch: 3	Loss: 1.324547
Client Index = 1	Epoch: 4	Loss: 1.232563
test acc on this client after 283 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 2
local mask changes: 0.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [4552336.0, 0.0, 4555114.0]
Doing local aggregation!
test acc on this client before 235 / 504 : 0.47
Client Index = 2	Epoch: 0	Loss: 3.643885
Client Index = 2	Epoch: 1	Loss: 1.396655
Client Index = 2	Epoch: 2	Loss: 1.284610
Client Index = 2	Epoch: 3	Loss: 1.355714
Client Index = 2	Epoch: 4	Loss: 1.254308
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 3
local mask changes: 0.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [4555114.0, 0.0, 4553168.0]
Doing local aggregation!
test acc on this client before 164 / 504 : 0.33
Client Index = 3	Epoch: 0	Loss: 4.924479
Client Index = 3	Epoch: 1	Loss: 1.781044
Client Index = 3	Epoch: 2	Loss: 1.634996
Client Index = 3	Epoch: 3	Loss: 1.587934
Client Index = 3	Epoch: 4	Loss: 1.572647
test acc on this client after 173 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 4
local mask changes: 0.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [4553168.0, 0.0, 4551074.0]
Doing local aggregation!
test acc on this client before 27 / 504 : 0.05
Client Index = 4	Epoch: 0	Loss: 4.636829
Client Index = 4	Epoch: 1	Loss: 1.931387
Client Index = 4	Epoch: 2	Loss: 1.864887
Client Index = 4	Epoch: 3	Loss: 1.830878
Client Index = 4	Epoch: 4	Loss: 1.760197
test acc on this client after 195 / 504 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 5
local mask changes: 0.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [4551074.0, 0.0, 4553700.0]
Doing local aggregation!
test acc on this client before 15 / 503 : 0.03
Client Index = 5	Epoch: 0	Loss: 4.806303
Client Index = 5	Epoch: 1	Loss: 1.759641
Client Index = 5	Epoch: 2	Loss: 1.692713
Client Index = 5	Epoch: 3	Loss: 1.645258
Client Index = 5	Epoch: 4	Loss: 1.580856
test acc on this client after 178 / 503 : 0.35
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 6
local mask changes: 0.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [4553700.0, 0.0, 4553726.0]
Doing local aggregation!
test acc on this client before 33 / 505 : 0.07
Client Index = 6	Epoch: 0	Loss: 4.369246
Client Index = 6	Epoch: 1	Loss: 2.032645
Client Index = 6	Epoch: 2	Loss: 1.984540
Client Index = 6	Epoch: 3	Loss: 1.945613
Client Index = 6	Epoch: 4	Loss: 1.937011
test acc on this client after 162 / 505 : 0.32
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 7
local mask changes: 0.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [4553726.0, 0.0, 4552046.0]
Doing local aggregation!
test acc on this client before 1 / 504 : 0.00
Client Index = 7	Epoch: 0	Loss: 5.009803
Client Index = 7	Epoch: 1	Loss: 1.834008
Client Index = 7	Epoch: 2	Loss: 1.812885
Client Index = 7	Epoch: 3	Loss: 1.779365
Client Index = 7	Epoch: 4	Loss: 1.755189
test acc on this client after 156 / 504 : 0.31
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 8
local mask changes: 0.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [4552046.0, 0.0, 4552030.0]
Doing local aggregation!
test acc on this client before 5 / 504 : 0.01
Client Index = 8	Epoch: 0	Loss: 3.887973
Client Index = 8	Epoch: 1	Loss: 1.175173
Client Index = 8	Epoch: 2	Loss: 1.095925
Client Index = 8	Epoch: 3	Loss: 1.001233
Client Index = 8	Epoch: 4	Loss: 1.030206
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 9
local mask changes: 0.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [4552030.0, 0.0, 4554304.0]
Doing local aggregation!
test acc on this client before 4 / 506 : 0.01
Client Index = 9	Epoch: 0	Loss: 4.498218
Client Index = 9	Epoch: 1	Loss: 1.741150
Client Index = 9	Epoch: 2	Loss: 1.675500
Client Index = 9	Epoch: 3	Loss: 1.660220
Client Index = 9	Epoch: 4	Loss: 1.604778
test acc on this client after 202 / 506 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 10
local mask changes: 0.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [4554304.0, 0.0, 4552950.0]
Doing local aggregation!
test acc on this client before 10 / 503 : 0.02
Client Index = 10	Epoch: 0	Loss: 4.645523
Client Index = 10	Epoch: 1	Loss: 1.873662
Client Index = 10	Epoch: 2	Loss: 1.722958
Client Index = 10	Epoch: 3	Loss: 1.715658
Client Index = 10	Epoch: 4	Loss: 1.706261
test acc on this client after 208 / 503 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 11
local mask changes: 0.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [4552950.0, 0.0, 4553400.0]
Doing local aggregation!
test acc on this client before 4 / 505 : 0.01
Client Index = 11	Epoch: 0	Loss: 4.094512
Client Index = 11	Epoch: 1	Loss: 1.541791
Client Index = 11	Epoch: 2	Loss: 1.366657
Client Index = 11	Epoch: 3	Loss: 1.394210
Client Index = 11	Epoch: 4	Loss: 1.310016
test acc on this client after 278 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 12
local mask changes: 0.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [4553400.0, 0.0, 4554806.0]
Doing local aggregation!
test acc on this client before 2 / 504 : 0.00
Client Index = 12	Epoch: 0	Loss: 4.560619
Client Index = 12	Epoch: 1	Loss: 1.778105
Client Index = 12	Epoch: 2	Loss: 1.731890
Client Index = 12	Epoch: 3	Loss: 1.685902
Client Index = 12	Epoch: 4	Loss: 1.644494
test acc on this client after 233 / 504 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 13
local mask changes: 0.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [4554806.0, 0.0, 4554256.0]
Doing local aggregation!
test acc on this client before 18 / 505 : 0.04
Client Index = 13	Epoch: 0	Loss: 4.353346
Client Index = 13	Epoch: 1	Loss: 1.639484
Client Index = 13	Epoch: 2	Loss: 1.578048
Client Index = 13	Epoch: 3	Loss: 1.590687
Client Index = 13	Epoch: 4	Loss: 1.477745
test acc on this client after 260 / 505 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 14
local mask changes: 0.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [4554256.0, 0.0, 4551766.0]
Doing local aggregation!
test acc on this client before 27 / 503 : 0.05
Client Index = 14	Epoch: 0	Loss: 4.553940
Client Index = 14	Epoch: 1	Loss: 1.822020
Client Index = 14	Epoch: 2	Loss: 1.702411
Client Index = 14	Epoch: 3	Loss: 1.718459
Client Index = 14	Epoch: 4	Loss: 1.681124
test acc on this client after 179 / 503 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 15
local mask changes: 0.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [4551766.0, 0.0, 4552148.0]
Doing local aggregation!
test acc on this client before 38 / 503 : 0.08
Client Index = 15	Epoch: 0	Loss: 3.861519
Client Index = 15	Epoch: 1	Loss: 1.526818
Client Index = 15	Epoch: 2	Loss: 1.407552
Client Index = 15	Epoch: 3	Loss: 1.410588
Client Index = 15	Epoch: 4	Loss: 1.318668
test acc on this client after 147 / 503 : 0.29
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 16
local mask changes: 0.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [4552148.0, 0.0, 4551844.0]
Doing local aggregation!
test acc on this client before 10 / 504 : 0.02
Client Index = 16	Epoch: 0	Loss: 4.339104
Client Index = 16	Epoch: 1	Loss: 1.771933
Client Index = 16	Epoch: 2	Loss: 1.620481
Client Index = 16	Epoch: 3	Loss: 1.595959
Client Index = 16	Epoch: 4	Loss: 1.562478
test acc on this client after 171 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 17
local mask changes: 0.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [4551844.0, 0.0, 4551980.0]
Doing local aggregation!
test acc on this client before 55 / 503 : 0.11
Client Index = 17	Epoch: 0	Loss: 4.181835
Client Index = 17	Epoch: 1	Loss: 1.954081
Client Index = 17	Epoch: 2	Loss: 1.934907
Client Index = 17	Epoch: 3	Loss: 1.907407
Client Index = 17	Epoch: 4	Loss: 1.881893
test acc on this client after 112 / 503 : 0.22
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 18
local mask changes: 0.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [4551980.0, 0.0, 4552542.0]
Doing local aggregation!
test acc on this client before 68 / 503 : 0.14
Client Index = 18	Epoch: 0	Loss: 4.536531
Client Index = 18	Epoch: 1	Loss: 1.735949
Client Index = 18	Epoch: 2	Loss: 1.624147
Client Index = 18	Epoch: 3	Loss: 1.593449
Client Index = 18	Epoch: 4	Loss: 1.573481
test acc on this client after 147 / 503 : 0.29
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 19
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [4552166.0, 4552542.0, 0.0]
Doing local aggregation!
test acc on this client before 17 / 503 : 0.03
Client Index = 19	Epoch: 0	Loss: 4.635176
Client Index = 19	Epoch: 1	Loss: 1.858397
Client Index = 19	Epoch: 2	Loss: 1.780863
Client Index = 19	Epoch: 3	Loss: 1.780827
Client Index = 19	Epoch: 4	Loss: 1.644920
test acc on this client after 179 / 503 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 2.1868031585514545}
################local_test_on_all_clients after local training in communication round: 0
{'test_acc_after': 0.40405861804059473, 'test_loss_after': 1.6334536836195515}
################local_test_on_all_clients before local training in communication round: 0
{'test_acc_before': 0.08636953383915005, 'test_loss_before': 2.5440627979220425}
################Communication round : 1
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 0
local mask changes: 2937580.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2937580.0, 4554902.0, 4555794.0]
Doing local aggregation!
test acc on this client before 8 / 503 : 0.02
Client Index = 0	Epoch: 0	Loss: 1.909917
Client Index = 0	Epoch: 1	Loss: 1.643178
Client Index = 0	Epoch: 2	Loss: 1.613625
Client Index = 0	Epoch: 3	Loss: 1.643871
Client Index = 0	Epoch: 4	Loss: 1.563280
test acc on this client after 162 / 503 : 0.32
-----------------------------------
training flops per data 2653342464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 1
local mask changes: 2937338.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [4551952.0, 2937338.0, 4552532.0]
Doing local aggregation!
test acc on this client before 38 / 503 : 0.08
Client Index = 1	Epoch: 0	Loss: 1.680290
Client Index = 1	Epoch: 1	Loss: 1.300829
Client Index = 1	Epoch: 2	Loss: 1.218567
Client Index = 1	Epoch: 3	Loss: 1.178683
Client Index = 1	Epoch: 4	Loss: 1.129648
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 2
local mask changes: 2939870.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [4552498.0, 2939870.0, 4552210.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 2	Epoch: 0	Loss: 1.470625
Client Index = 2	Epoch: 1	Loss: 1.272075
Client Index = 2	Epoch: 2	Loss: 1.260911
Client Index = 2	Epoch: 3	Loss: 1.198283
Client Index = 2	Epoch: 4	Loss: 1.144788
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653255424.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 3
local mask changes: 2940526.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [4555116.0, 2940526.0, 4554030.0]
Doing local aggregation!
test acc on this client before 164 / 504 : 0.33
Client Index = 3	Epoch: 0	Loss: 1.691699
Client Index = 3	Epoch: 1	Loss: 1.578812
Client Index = 3	Epoch: 2	Loss: 1.576307
Client Index = 3	Epoch: 3	Loss: 1.503692
Client Index = 3	Epoch: 4	Loss: 1.523965
test acc on this client after 218 / 504 : 0.43
-----------------------------------
training flops per data 2653244416.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 4
local mask changes: 2938050.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [4552792.0, 2938050.0, 4553554.0]
Doing local aggregation!
test acc on this client before 116 / 504 : 0.23
Client Index = 4	Epoch: 0	Loss: 2.101652
Client Index = 4	Epoch: 1	Loss: 1.825042
Client Index = 4	Epoch: 2	Loss: 1.715318
Client Index = 4	Epoch: 3	Loss: 1.725079
Client Index = 4	Epoch: 4	Loss: 1.628350
test acc on this client after 234 / 504 : 0.46
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 5
local mask changes: 2939346.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [4552332.0, 2939346.0, 4554828.0]
Doing local aggregation!
test acc on this client before 178 / 503 : 0.35
Client Index = 5	Epoch: 0	Loss: 1.980836
Client Index = 5	Epoch: 1	Loss: 1.588594
Client Index = 5	Epoch: 2	Loss: 1.571900
Client Index = 5	Epoch: 3	Loss: 1.455417
Client Index = 5	Epoch: 4	Loss: 1.417230
test acc on this client after 285 / 503 : 0.57
-----------------------------------
training flops per data 2653263872.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 6
local mask changes: 2940622.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [4551828.0, 2940622.0, 4553690.0]
Doing local aggregation!
test acc on this client before 29 / 505 : 0.06
Client Index = 6	Epoch: 0	Loss: 2.135597
Client Index = 6	Epoch: 1	Loss: 1.922152
Client Index = 6	Epoch: 2	Loss: 1.881752
Client Index = 6	Epoch: 3	Loss: 1.811190
Client Index = 6	Epoch: 4	Loss: 1.804242
test acc on this client after 182 / 505 : 0.36
-----------------------------------
training flops per data 2653287936.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 7
local mask changes: 2939972.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [4554938.0, 2939972.0, 4551018.0]
Doing local aggregation!
test acc on this client before 156 / 504 : 0.31
Client Index = 7	Epoch: 0	Loss: 1.889356
Client Index = 7	Epoch: 1	Loss: 1.747430
Client Index = 7	Epoch: 2	Loss: 1.725334
Client Index = 7	Epoch: 3	Loss: 1.746052
Client Index = 7	Epoch: 4	Loss: 1.681096
test acc on this client after 126 / 504 : 0.25
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 8
local mask changes: 2938788.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [4550816.0, 2938788.0, 4552978.0]
Doing local aggregation!
test acc on this client before 236 / 504 : 0.47
Client Index = 8	Epoch: 0	Loss: 1.518529
Client Index = 8	Epoch: 1	Loss: 0.935746
Client Index = 8	Epoch: 2	Loss: 0.805344
Client Index = 8	Epoch: 3	Loss: 0.840242
Client Index = 8	Epoch: 4	Loss: 0.854388
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653308416.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 9
local mask changes: 2938324.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [4553090.0, 2938324.0, 4554004.0]
Doing local aggregation!
test acc on this client before 14 / 506 : 0.03
Client Index = 9	Epoch: 0	Loss: 1.820038
Client Index = 9	Epoch: 1	Loss: 1.561904
Client Index = 9	Epoch: 2	Loss: 1.543297
Client Index = 9	Epoch: 3	Loss: 1.475921
Client Index = 9	Epoch: 4	Loss: 1.460168
test acc on this client after 245 / 506 : 0.48
-----------------------------------
training flops per data 2653330432.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 10
local mask changes: 2938308.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [4552680.0, 2938308.0, 4551632.0]
Doing local aggregation!
test acc on this client before 173 / 503 : 0.34
Client Index = 10	Epoch: 0	Loss: 1.920210
Client Index = 10	Epoch: 1	Loss: 1.680689
Client Index = 10	Epoch: 2	Loss: 1.627173
Client Index = 10	Epoch: 3	Loss: 1.639003
Client Index = 10	Epoch: 4	Loss: 1.581621
test acc on this client after 208 / 503 : 0.41
-----------------------------------
training flops per data 2653302272.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 11
local mask changes: 2940660.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [4552242.0, 2940660.0, 4554306.0]
Doing local aggregation!
test acc on this client before 94 / 505 : 0.19
Client Index = 11	Epoch: 0	Loss: 1.734183
Client Index = 11	Epoch: 1	Loss: 1.342926
Client Index = 11	Epoch: 2	Loss: 1.312835
Client Index = 11	Epoch: 3	Loss: 1.244286
Client Index = 11	Epoch: 4	Loss: 1.238003
test acc on this client after 285 / 505 : 0.56
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 12
local mask changes: 2939180.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [4552130.0, 2939180.0, 4553970.0]
Doing local aggregation!
test acc on this client before 86 / 504 : 0.17
Client Index = 12	Epoch: 0	Loss: 1.822254
Client Index = 12	Epoch: 1	Loss: 1.601296
Client Index = 12	Epoch: 2	Loss: 1.561308
Client Index = 12	Epoch: 3	Loss: 1.536826
Client Index = 12	Epoch: 4	Loss: 1.505322
test acc on this client after 262 / 504 : 0.52
-----------------------------------
training flops per data 2653302272.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 13
local mask changes: 2940818.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [4554322.0, 2940818.0, 4553040.0]
Doing local aggregation!
test acc on this client before 260 / 505 : 0.51
Client Index = 13	Epoch: 0	Loss: 1.764234
Client Index = 13	Epoch: 1	Loss: 1.435620
Client Index = 13	Epoch: 2	Loss: 1.417994
Client Index = 13	Epoch: 3	Loss: 1.408173
Client Index = 13	Epoch: 4	Loss: 1.395657
test acc on this client after 244 / 505 : 0.48
-----------------------------------
training flops per data 2653310976.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 14
local mask changes: 2939828.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [4554656.0, 2939828.0, 4551510.0]
Doing local aggregation!
test acc on this client before 179 / 503 : 0.36
Client Index = 14	Epoch: 0	Loss: 1.740938
Client Index = 14	Epoch: 1	Loss: 1.693120
Client Index = 14	Epoch: 2	Loss: 1.599046
Client Index = 14	Epoch: 3	Loss: 1.599170
Client Index = 14	Epoch: 4	Loss: 1.569688
test acc on this client after 194 / 503 : 0.39
-----------------------------------
training flops per data 2653288704.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 15
local mask changes: 2938828.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [4551718.0, 2938828.0, 4549972.0]
Doing local aggregation!
test acc on this client before 40 / 503 : 0.08
Client Index = 15	Epoch: 0	Loss: 1.596951
Client Index = 15	Epoch: 1	Loss: 1.371808
Client Index = 15	Epoch: 2	Loss: 1.340788
Client Index = 15	Epoch: 3	Loss: 1.276325
Client Index = 15	Epoch: 4	Loss: 1.259697
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 16
local mask changes: 2939384.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [4550020.0, 2939384.0, 4554794.0]
Doing local aggregation!
test acc on this client before 179 / 504 : 0.36
Client Index = 16	Epoch: 0	Loss: 1.762298
Client Index = 16	Epoch: 1	Loss: 1.545512
Client Index = 16	Epoch: 2	Loss: 1.495609
Client Index = 16	Epoch: 3	Loss: 1.512574
Client Index = 16	Epoch: 4	Loss: 1.481947
test acc on this client after 215 / 504 : 0.43
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 17
local mask changes: 2938972.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [4551514.0, 2938972.0, 4552900.0]
Doing local aggregation!
test acc on this client before 95 / 503 : 0.19
Client Index = 17	Epoch: 0	Loss: 2.054049
Client Index = 17	Epoch: 1	Loss: 1.850359
Client Index = 17	Epoch: 2	Loss: 1.823455
Client Index = 17	Epoch: 3	Loss: 1.789476
Client Index = 17	Epoch: 4	Loss: 1.745349
test acc on this client after 150 / 503 : 0.30
-----------------------------------
training flops per data 2653304320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 18
local mask changes: 2940734.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [4553766.0, 2940734.0, 4553432.0]
Doing local aggregation!
test acc on this client before 160 / 503 : 0.32
Client Index = 18	Epoch: 0	Loss: 1.727360
Client Index = 18	Epoch: 1	Loss: 1.563669
Client Index = 18	Epoch: 2	Loss: 1.536274
Client Index = 18	Epoch: 3	Loss: 1.497804
Client Index = 18	Epoch: 4	Loss: 1.466387
test acc on this client after 262 / 503 : 0.52
-----------------------------------
training flops per data 2653293056.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 19
local mask changes: 2937216.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [4551468.0, 4552944.0, 2937216.0]
Doing local aggregation!
test acc on this client before 89 / 503 : 0.18
Client Index = 19	Epoch: 0	Loss: 1.888225
Client Index = 19	Epoch: 1	Loss: 1.643826
Client Index = 19	Epoch: 2	Loss: 1.679362
Client Index = 19	Epoch: 3	Loss: 1.586399
Client Index = 19	Epoch: 4	Loss: 1.534487
test acc on this client after 211 / 503 : 0.42
-----------------------------------
training flops per data 2653315840.0
full flops for search 3332536350
{'training_loss': 1.5627380079627038}
################local_test_on_all_clients after local training in communication round: 1
{'test_acc_after': 0.4766671244319646, 'test_loss_after': 1.513776340522254}
################local_test_on_all_clients before local training in communication round: 1
{'test_acc_before': 0.2591363885811299, 'test_loss_before': 2.029546258560091}
################Communication round : 2
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 0
local mask changes: 2937320.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2937320.0, 4042566.0, 4043984.0]
Doing local aggregation!
test acc on this client before 105 / 503 : 0.21
Client Index = 0	Epoch: 0	Loss: 1.708744
Client Index = 0	Epoch: 1	Loss: 1.589651
Client Index = 0	Epoch: 2	Loss: 1.495525
Client Index = 0	Epoch: 3	Loss: 1.461090
Client Index = 0	Epoch: 4	Loss: 1.373390
test acc on this client after 237 / 503 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 1
local mask changes: 2940124.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [4043978.0, 2940124.0, 4043356.0]
Doing local aggregation!
test acc on this client before 38 / 503 : 0.08
Client Index = 1	Epoch: 0	Loss: 1.372664
Client Index = 1	Epoch: 1	Loss: 1.127428
Client Index = 1	Epoch: 2	Loss: 1.117643
Client Index = 1	Epoch: 3	Loss: 1.130823
Client Index = 1	Epoch: 4	Loss: 1.055129
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653277440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 2
local mask changes: 2938414.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [4042794.0, 2938414.0, 4041864.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 2	Epoch: 0	Loss: 1.276627
Client Index = 2	Epoch: 1	Loss: 1.119699
Client Index = 2	Epoch: 2	Loss: 1.107618
Client Index = 2	Epoch: 3	Loss: 1.108144
Client Index = 2	Epoch: 4	Loss: 0.981003
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653267200.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 3
local mask changes: 2940734.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [4042354.0, 2940734.0, 4043414.0]
Doing local aggregation!
test acc on this client before 164 / 504 : 0.33
Client Index = 3	Epoch: 0	Loss: 1.585887
Client Index = 3	Epoch: 1	Loss: 1.495121
Client Index = 3	Epoch: 2	Loss: 1.493791
Client Index = 3	Epoch: 3	Loss: 1.446713
Client Index = 3	Epoch: 4	Loss: 1.379203
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653284352.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 4
local mask changes: 2937878.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [4044338.0, 2937878.0, 4043370.0]
Doing local aggregation!
test acc on this client before 148 / 504 : 0.29
Client Index = 4	Epoch: 0	Loss: 1.840394
Client Index = 4	Epoch: 1	Loss: 1.634718
Client Index = 4	Epoch: 2	Loss: 1.619388
Client Index = 4	Epoch: 3	Loss: 1.579117
Client Index = 4	Epoch: 4	Loss: 1.595108
test acc on this client after 236 / 504 : 0.47
-----------------------------------
training flops per data 2653341440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 5
local mask changes: 2940160.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [4042022.0, 2940160.0, 4042748.0]
Doing local aggregation!
test acc on this client before 196 / 503 : 0.39
Client Index = 5	Epoch: 0	Loss: 1.573759
Client Index = 5	Epoch: 1	Loss: 1.389362
Client Index = 5	Epoch: 2	Loss: 1.358943
Client Index = 5	Epoch: 3	Loss: 1.290523
Client Index = 5	Epoch: 4	Loss: 1.302381
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653207552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 6
local mask changes: 2937202.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [4042642.0, 2937202.0, 4044646.0]
Doing local aggregation!
test acc on this client before 87 / 505 : 0.17
Client Index = 6	Epoch: 0	Loss: 1.924768
Client Index = 6	Epoch: 1	Loss: 1.824037
Client Index = 6	Epoch: 2	Loss: 1.738241
Client Index = 6	Epoch: 3	Loss: 1.711549
Client Index = 6	Epoch: 4	Loss: 1.694164
test acc on this client after 190 / 505 : 0.38
-----------------------------------
training flops per data 2653331456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 7
local mask changes: 2939126.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [4040844.0, 2939126.0, 4039880.0]
Doing local aggregation!
test acc on this client before 156 / 504 : 0.31
Client Index = 7	Epoch: 0	Loss: 1.830646
Client Index = 7	Epoch: 1	Loss: 1.754664
Client Index = 7	Epoch: 2	Loss: 1.671507
Client Index = 7	Epoch: 3	Loss: 1.673314
Client Index = 7	Epoch: 4	Loss: 1.634503
test acc on this client after 229 / 504 : 0.45
-----------------------------------
training flops per data 2653254144.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 8
local mask changes: 2938344.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [4042900.0, 2938344.0, 4043668.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 1.156078
Client Index = 8	Epoch: 1	Loss: 0.820097
Client Index = 8	Epoch: 2	Loss: 0.789662
Client Index = 8	Epoch: 3	Loss: 0.767849
Client Index = 8	Epoch: 4	Loss: 0.726097
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653286912.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 9
local mask changes: 2938820.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [4043802.0, 2938820.0, 4044750.0]
Doing local aggregation!
test acc on this client before 78 / 506 : 0.15
Client Index = 9	Epoch: 0	Loss: 1.567066
Client Index = 9	Epoch: 1	Loss: 1.467565
Client Index = 9	Epoch: 2	Loss: 1.399215
Client Index = 9	Epoch: 3	Loss: 1.389010
Client Index = 9	Epoch: 4	Loss: 1.342228
test acc on this client after 192 / 506 : 0.38
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 10
local mask changes: 2937172.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [4045340.0, 2937172.0, 4042048.0]
Doing local aggregation!
test acc on this client before 70 / 503 : 0.14
Client Index = 10	Epoch: 0	Loss: 1.637981
Client Index = 10	Epoch: 1	Loss: 1.525235
Client Index = 10	Epoch: 2	Loss: 1.520447
Client Index = 10	Epoch: 3	Loss: 1.429790
Client Index = 10	Epoch: 4	Loss: 1.477770
test acc on this client after 236 / 503 : 0.47
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 11
local mask changes: 2940360.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [4045340.0, 2940360.0, 4043028.0]
Doing local aggregation!
test acc on this client before 222 / 505 : 0.44
Client Index = 11	Epoch: 0	Loss: 1.472545
Client Index = 11	Epoch: 1	Loss: 1.211119
Client Index = 11	Epoch: 2	Loss: 1.201772
Client Index = 11	Epoch: 3	Loss: 1.166500
Client Index = 11	Epoch: 4	Loss: 1.209978
test acc on this client after 299 / 505 : 0.59
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 12
local mask changes: 2939266.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [4042768.0, 2939266.0, 4043082.0]
Doing local aggregation!
test acc on this client before 96 / 504 : 0.19
Client Index = 12	Epoch: 0	Loss: 1.625090
Client Index = 12	Epoch: 1	Loss: 1.488191
Client Index = 12	Epoch: 2	Loss: 1.454463
Client Index = 12	Epoch: 3	Loss: 1.443827
Client Index = 12	Epoch: 4	Loss: 1.404528
test acc on this client after 258 / 504 : 0.51
-----------------------------------
training flops per data 2653273088.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 13
local mask changes: 2937352.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [4043530.0, 2937352.0, 4043698.0]
Doing local aggregation!
test acc on this client before 280 / 505 : 0.55
Client Index = 13	Epoch: 0	Loss: 1.468007
Client Index = 13	Epoch: 1	Loss: 1.382683
Client Index = 13	Epoch: 2	Loss: 1.371057
Client Index = 13	Epoch: 3	Loss: 1.352598
Client Index = 13	Epoch: 4	Loss: 1.317234
test acc on this client after 267 / 505 : 0.53
-----------------------------------
training flops per data 2653306112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 14
local mask changes: 2938854.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [4041722.0, 2938854.0, 4042424.0]
Doing local aggregation!
test acc on this client before 152 / 503 : 0.30
Client Index = 14	Epoch: 0	Loss: 1.643784
Client Index = 14	Epoch: 1	Loss: 1.545628
Client Index = 14	Epoch: 2	Loss: 1.525444
Client Index = 14	Epoch: 3	Loss: 1.531381
Client Index = 14	Epoch: 4	Loss: 1.529373
test acc on this client after 209 / 503 : 0.42
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 15
local mask changes: 2938072.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [4041576.0, 2938072.0, 4040628.0]
Doing local aggregation!
test acc on this client before 312 / 503 : 0.62
Client Index = 15	Epoch: 0	Loss: 1.338501
Client Index = 15	Epoch: 1	Loss: 1.329705
Client Index = 15	Epoch: 2	Loss: 1.192058
Client Index = 15	Epoch: 3	Loss: 1.239739
Client Index = 15	Epoch: 4	Loss: 1.166095
test acc on this client after 314 / 503 : 0.62
-----------------------------------
training flops per data 2653265408.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 16
local mask changes: 2938970.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [4042140.0, 2938970.0, 4042346.0]
Doing local aggregation!
test acc on this client before 214 / 504 : 0.42
Client Index = 16	Epoch: 0	Loss: 1.586169
Client Index = 16	Epoch: 1	Loss: 1.455095
Client Index = 16	Epoch: 2	Loss: 1.457767
Client Index = 16	Epoch: 3	Loss: 1.474413
Client Index = 16	Epoch: 4	Loss: 1.389447
test acc on this client after 190 / 504 : 0.38
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 17
local mask changes: 2939774.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [4042070.0, 2939774.0, 4040652.0]
Doing local aggregation!
test acc on this client before 12 / 503 : 0.02
Client Index = 17	Epoch: 0	Loss: 1.848058
Client Index = 17	Epoch: 1	Loss: 1.760105
Client Index = 17	Epoch: 2	Loss: 1.756155
Client Index = 17	Epoch: 3	Loss: 1.682516
Client Index = 17	Epoch: 4	Loss: 1.697073
test acc on this client after 165 / 503 : 0.33
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 18
local mask changes: 2937874.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [4042572.0, 2937874.0, 4042844.0]
Doing local aggregation!
test acc on this client before 239 / 503 : 0.48
Client Index = 18	Epoch: 0	Loss: 1.557402
Client Index = 18	Epoch: 1	Loss: 1.473266
Client Index = 18	Epoch: 2	Loss: 1.435665
Client Index = 18	Epoch: 3	Loss: 1.423369
Client Index = 18	Epoch: 4	Loss: 1.353470
test acc on this client after 281 / 503 : 0.56
-----------------------------------
training flops per data 2653268736.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 19
local mask changes: 2938698.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [4043794.0, 4042094.0, 2938698.0]
Doing local aggregation!
test acc on this client before 112 / 503 : 0.22
Client Index = 19	Epoch: 0	Loss: 1.704438
Client Index = 19	Epoch: 1	Loss: 1.551664
Client Index = 19	Epoch: 2	Loss: 1.515979
Client Index = 19	Epoch: 3	Loss: 1.589321
Client Index = 19	Epoch: 4	Loss: 1.473738
test acc on this client after 230 / 503 : 0.46
-----------------------------------
training flops per data 2653273600.0
full flops for search 3332536350
{'training_loss': 1.4387947953939437}
################local_test_on_all_clients after local training in communication round: 2
{'test_acc_after': 0.5198780078929691, 'test_loss_after': 1.3811541447033902}
################local_test_on_all_clients before local training in communication round: 2
{'test_acc_before': 0.3339268471659041, 'test_loss_before': 1.889343183322253}
################Communication round : 3
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 0
local mask changes: 2936110.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2936110.0, 3764290.0, 3763238.0]
Doing local aggregation!
test acc on this client before 173 / 503 : 0.34
Client Index = 0	Epoch: 0	Loss: 1.574806
Client Index = 0	Epoch: 1	Loss: 1.435939
Client Index = 0	Epoch: 2	Loss: 1.439822
Client Index = 0	Epoch: 3	Loss: 1.338089
Client Index = 0	Epoch: 4	Loss: 1.339803
test acc on this client after 264 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 1
local mask changes: 2937028.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3760602.0, 2937028.0, 3761696.0]
Doing local aggregation!
test acc on this client before 44 / 503 : 0.09
Client Index = 1	Epoch: 0	Loss: 1.210283
Client Index = 1	Epoch: 1	Loss: 1.042725
Client Index = 1	Epoch: 2	Loss: 1.008453
Client Index = 1	Epoch: 3	Loss: 1.024194
Client Index = 1	Epoch: 4	Loss: 1.028152
test acc on this client after 356 / 503 : 0.71
-----------------------------------
training flops per data 2653273344.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 2
local mask changes: 2936100.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3758594.0, 2936100.0, 3758294.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 2	Epoch: 0	Loss: 1.177003
Client Index = 2	Epoch: 1	Loss: 1.063565
Client Index = 2	Epoch: 2	Loss: 0.985352
Client Index = 2	Epoch: 3	Loss: 0.985749
Client Index = 2	Epoch: 4	Loss: 0.966802
test acc on this client after 363 / 504 : 0.72
-----------------------------------
training flops per data 2653246464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 3
local mask changes: 2937694.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3763596.0, 2937694.0, 3761858.0]
Doing local aggregation!
test acc on this client before 179 / 504 : 0.36
Client Index = 3	Epoch: 0	Loss: 1.587638
Client Index = 3	Epoch: 1	Loss: 1.407881
Client Index = 3	Epoch: 2	Loss: 1.423161
Client Index = 3	Epoch: 3	Loss: 1.328690
Client Index = 3	Epoch: 4	Loss: 1.329683
test acc on this client after 290 / 504 : 0.58
-----------------------------------
training flops per data 2653204992.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 4
local mask changes: 2939256.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3764920.0, 2939256.0, 3762798.0]
Doing local aggregation!
test acc on this client before 154 / 504 : 0.31
Client Index = 4	Epoch: 0	Loss: 1.700978
Client Index = 4	Epoch: 1	Loss: 1.572456
Client Index = 4	Epoch: 2	Loss: 1.494443
Client Index = 4	Epoch: 3	Loss: 1.505715
Client Index = 4	Epoch: 4	Loss: 1.543195
test acc on this client after 234 / 504 : 0.46
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 5
local mask changes: 2937330.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3761370.0, 2937330.0, 3760004.0]
Doing local aggregation!
test acc on this client before 207 / 503 : 0.41
Client Index = 5	Epoch: 0	Loss: 1.386251
Client Index = 5	Epoch: 1	Loss: 1.310722
Client Index = 5	Epoch: 2	Loss: 1.239208
Client Index = 5	Epoch: 3	Loss: 1.264354
Client Index = 5	Epoch: 4	Loss: 1.237568
test acc on this client after 279 / 503 : 0.55
-----------------------------------
training flops per data 2653145856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 6
local mask changes: 2937690.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3763396.0, 2937690.0, 3763542.0]
Doing local aggregation!
test acc on this client before 164 / 505 : 0.32
Client Index = 6	Epoch: 0	Loss: 1.810099
Client Index = 6	Epoch: 1	Loss: 1.636890
Client Index = 6	Epoch: 2	Loss: 1.623716
Client Index = 6	Epoch: 3	Loss: 1.653443
Client Index = 6	Epoch: 4	Loss: 1.579107
test acc on this client after 221 / 505 : 0.44
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 7
local mask changes: 2936118.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3762546.0, 2936118.0, 3763320.0]
Doing local aggregation!
test acc on this client before 158 / 504 : 0.31
Client Index = 7	Epoch: 0	Loss: 1.729244
Client Index = 7	Epoch: 1	Loss: 1.700508
Client Index = 7	Epoch: 2	Loss: 1.638582
Client Index = 7	Epoch: 3	Loss: 1.613050
Client Index = 7	Epoch: 4	Loss: 1.595483
test acc on this client after 226 / 504 : 0.45
-----------------------------------
training flops per data 2653168128.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 8
local mask changes: 2937782.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3764516.0, 2937782.0, 3761658.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 8	Epoch: 0	Loss: 0.968054
Client Index = 8	Epoch: 1	Loss: 0.761189
Client Index = 8	Epoch: 2	Loss: 0.748873
Client Index = 8	Epoch: 3	Loss: 0.719993
Client Index = 8	Epoch: 4	Loss: 0.737443
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653266176.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 9
local mask changes: 2936670.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3764004.0, 2936670.0, 3762276.0]
Doing local aggregation!
test acc on this client before 173 / 506 : 0.34
Client Index = 9	Epoch: 0	Loss: 1.428263
Client Index = 9	Epoch: 1	Loss: 1.425679
Client Index = 9	Epoch: 2	Loss: 1.323680
Client Index = 9	Epoch: 3	Loss: 1.322007
Client Index = 9	Epoch: 4	Loss: 1.326786
test acc on this client after 268 / 506 : 0.53
-----------------------------------
training flops per data 2653270528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 10
local mask changes: 2935992.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3760540.0, 2935992.0, 3760900.0]
Doing local aggregation!
test acc on this client before 121 / 503 : 0.24
Client Index = 10	Epoch: 0	Loss: 1.564184
Client Index = 10	Epoch: 1	Loss: 1.450457
Client Index = 10	Epoch: 2	Loss: 1.444957
Client Index = 10	Epoch: 3	Loss: 1.414260
Client Index = 10	Epoch: 4	Loss: 1.377516
test acc on this client after 226 / 503 : 0.45
-----------------------------------
training flops per data 2653311744.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 11
local mask changes: 2937978.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3761888.0, 2937978.0, 3763758.0]
Doing local aggregation!
test acc on this client before 123 / 505 : 0.24
Client Index = 11	Epoch: 0	Loss: 1.316555
Client Index = 11	Epoch: 1	Loss: 1.215447
Client Index = 11	Epoch: 2	Loss: 1.101828
Client Index = 11	Epoch: 3	Loss: 1.135318
Client Index = 11	Epoch: 4	Loss: 1.148730
test acc on this client after 305 / 505 : 0.60
-----------------------------------
training flops per data 2653320704.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 12
local mask changes: 2937364.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3761696.0, 2937364.0, 3760826.0]
Doing local aggregation!
test acc on this client before 227 / 504 : 0.45
Client Index = 12	Epoch: 0	Loss: 1.574416
Client Index = 12	Epoch: 1	Loss: 1.403067
Client Index = 12	Epoch: 2	Loss: 1.407102
Client Index = 12	Epoch: 3	Loss: 1.418924
Client Index = 12	Epoch: 4	Loss: 1.380332
test acc on this client after 244 / 504 : 0.48
-----------------------------------
training flops per data 2653262080.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 13
local mask changes: 2937890.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3761242.0, 2937890.0, 3762646.0]
Doing local aggregation!
test acc on this client before 273 / 505 : 0.54
Client Index = 13	Epoch: 0	Loss: 1.397219
Client Index = 13	Epoch: 1	Loss: 1.368396
Client Index = 13	Epoch: 2	Loss: 1.293611
Client Index = 13	Epoch: 3	Loss: 1.292738
Client Index = 13	Epoch: 4	Loss: 1.283197
test acc on this client after 261 / 505 : 0.52
-----------------------------------
training flops per data 2653245952.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 14
local mask changes: 2937804.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3762002.0, 2937804.0, 3761928.0]
Doing local aggregation!
test acc on this client before 169 / 503 : 0.34
Client Index = 14	Epoch: 0	Loss: 1.555492
Client Index = 14	Epoch: 1	Loss: 1.518958
Client Index = 14	Epoch: 2	Loss: 1.492955
Client Index = 14	Epoch: 3	Loss: 1.472914
Client Index = 14	Epoch: 4	Loss: 1.449098
test acc on this client after 208 / 503 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 15
local mask changes: 2938132.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3757542.0, 2938132.0, 3757228.0]
Doing local aggregation!
test acc on this client before 96 / 503 : 0.19
Client Index = 15	Epoch: 0	Loss: 1.279178
Client Index = 15	Epoch: 1	Loss: 1.286431
Client Index = 15	Epoch: 2	Loss: 1.200701
Client Index = 15	Epoch: 3	Loss: 1.183972
Client Index = 15	Epoch: 4	Loss: 1.100146
test acc on this client after 294 / 503 : 0.58
-----------------------------------
training flops per data 2653285376.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 16
local mask changes: 2937944.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3762378.0, 2937944.0, 3761308.0]
Doing local aggregation!
test acc on this client before 196 / 504 : 0.39
Client Index = 16	Epoch: 0	Loss: 1.460768
Client Index = 16	Epoch: 1	Loss: 1.427633
Client Index = 16	Epoch: 2	Loss: 1.392187
Client Index = 16	Epoch: 3	Loss: 1.397421
Client Index = 16	Epoch: 4	Loss: 1.350345
test acc on this client after 230 / 504 : 0.46
-----------------------------------
training flops per data 2653319424.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 17
local mask changes: 2938330.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3762474.0, 2938330.0, 3762196.0]
Doing local aggregation!
test acc on this client before 105 / 503 : 0.21
Client Index = 17	Epoch: 0	Loss: 1.740248
Client Index = 17	Epoch: 1	Loss: 1.648886
Client Index = 17	Epoch: 2	Loss: 1.668038
Client Index = 17	Epoch: 3	Loss: 1.655130
Client Index = 17	Epoch: 4	Loss: 1.635195
test acc on this client after 179 / 503 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 18
local mask changes: 2936174.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3760678.0, 2936174.0, 3760374.0]
Doing local aggregation!
test acc on this client before 261 / 503 : 0.52
Client Index = 18	Epoch: 0	Loss: 1.412191
Client Index = 18	Epoch: 1	Loss: 1.412324
Client Index = 18	Epoch: 2	Loss: 1.369933
Client Index = 18	Epoch: 3	Loss: 1.346791
Client Index = 18	Epoch: 4	Loss: 1.281546
test acc on this client after 294 / 503 : 0.58
-----------------------------------
training flops per data 2653340160.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 19
local mask changes: 2936716.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3763192.0, 3761138.0, 2936716.0]
Doing local aggregation!
test acc on this client before 148 / 503 : 0.29
Client Index = 19	Epoch: 0	Loss: 1.581043
Client Index = 19	Epoch: 1	Loss: 1.481619
Client Index = 19	Epoch: 2	Loss: 1.447298
Client Index = 19	Epoch: 3	Loss: 1.376332
Client Index = 19	Epoch: 4	Loss: 1.429548
test acc on this client after 238 / 503 : 0.47
-----------------------------------
training flops per data 2653332992.0
full flops for search 3332536350
{'training_loss': 1.36337342441082}
################local_test_on_all_clients after local training in communication round: 3
{'test_acc_after': 0.5342292070389757, 'test_loss_after': 1.3430292063010718}
################local_test_on_all_clients before local training in communication round: 3
{'test_acc_before': 0.3631785219644793, 'test_loss_before': 1.7428764276124085}
################Communication round : 4
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 0
local mask changes: 2933602.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2933602.0, 3593216.0, 3596222.0]
Doing local aggregation!
test acc on this client before 186 / 503 : 0.37
Client Index = 0	Epoch: 0	Loss: 1.504645
Client Index = 0	Epoch: 1	Loss: 1.341258
Client Index = 0	Epoch: 2	Loss: 1.360154
Client Index = 0	Epoch: 3	Loss: 1.365519
Client Index = 0	Epoch: 4	Loss: 1.346947
test acc on this client after 289 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 1
local mask changes: 2937876.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3590356.0, 2937876.0, 3589568.0]
Doing local aggregation!
test acc on this client before 75 / 503 : 0.15
Client Index = 1	Epoch: 0	Loss: 1.126462
Client Index = 1	Epoch: 1	Loss: 1.013031
Client Index = 1	Epoch: 2	Loss: 1.000781
Client Index = 1	Epoch: 3	Loss: 0.977782
Client Index = 1	Epoch: 4	Loss: 0.945354
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653267456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 2
local mask changes: 2936184.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3590048.0, 2936184.0, 3591980.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 2	Epoch: 0	Loss: 1.105878
Client Index = 2	Epoch: 1	Loss: 0.954360
Client Index = 2	Epoch: 2	Loss: 0.947782
Client Index = 2	Epoch: 3	Loss: 0.891595
Client Index = 2	Epoch: 4	Loss: 0.871403
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653286912.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 3
local mask changes: 2934904.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3595646.0, 2934904.0, 3596428.0]
Doing local aggregation!
test acc on this client before 191 / 504 : 0.38
Client Index = 3	Epoch: 0	Loss: 1.426320
Client Index = 3	Epoch: 1	Loss: 1.337134
Client Index = 3	Epoch: 2	Loss: 1.334965
Client Index = 3	Epoch: 3	Loss: 1.221345
Client Index = 3	Epoch: 4	Loss: 1.267873
test acc on this client after 290 / 504 : 0.58
-----------------------------------
training flops per data 2653177600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 4
local mask changes: 2932984.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3600604.0, 2932984.0, 3594000.0]
Doing local aggregation!
test acc on this client before 146 / 504 : 0.29
Client Index = 4	Epoch: 0	Loss: 1.582382
Client Index = 4	Epoch: 1	Loss: 1.538357
Client Index = 4	Epoch: 2	Loss: 1.464150
Client Index = 4	Epoch: 3	Loss: 1.431032
Client Index = 4	Epoch: 4	Loss: 1.443600
test acc on this client after 211 / 504 : 0.42
-----------------------------------
training flops per data 2653268992.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 5
local mask changes: 2933072.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3591814.0, 2933072.0, 3594890.0]
Doing local aggregation!
test acc on this client before 252 / 503 : 0.50
Client Index = 5	Epoch: 0	Loss: 1.295849
Client Index = 5	Epoch: 1	Loss: 1.278068
Client Index = 5	Epoch: 2	Loss: 1.179447
Client Index = 5	Epoch: 3	Loss: 1.213818
Client Index = 5	Epoch: 4	Loss: 1.159960
test acc on this client after 321 / 503 : 0.64
-----------------------------------
training flops per data 2653191168.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 6
local mask changes: 2935472.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3595952.0, 2935472.0, 3595778.0]
Doing local aggregation!
test acc on this client before 181 / 505 : 0.36
Client Index = 6	Epoch: 0	Loss: 1.681551
Client Index = 6	Epoch: 1	Loss: 1.548398
Client Index = 6	Epoch: 2	Loss: 1.575009
Client Index = 6	Epoch: 3	Loss: 1.588590
Client Index = 6	Epoch: 4	Loss: 1.514264
test acc on this client after 238 / 505 : 0.47
-----------------------------------
training flops per data 2653331712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 7
local mask changes: 2934144.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3596102.0, 2934144.0, 3593988.0]
Doing local aggregation!
test acc on this client before 160 / 504 : 0.32
Client Index = 7	Epoch: 0	Loss: 1.635914
Client Index = 7	Epoch: 1	Loss: 1.574948
Client Index = 7	Epoch: 2	Loss: 1.586420
Client Index = 7	Epoch: 3	Loss: 1.537637
Client Index = 7	Epoch: 4	Loss: 1.492244
test acc on this client after 234 / 504 : 0.46
-----------------------------------
training flops per data 2653211648.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 8
local mask changes: 2933202.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3594300.0, 2933202.0, 3593794.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 0.921131
Client Index = 8	Epoch: 1	Loss: 0.691847
Client Index = 8	Epoch: 2	Loss: 0.740365
Client Index = 8	Epoch: 3	Loss: 0.683359
Client Index = 8	Epoch: 4	Loss: 0.654704
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653328640.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 9
local mask changes: 2936622.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3592832.0, 2936622.0, 3591494.0]
Doing local aggregation!
test acc on this client before 154 / 506 : 0.30
Client Index = 9	Epoch: 0	Loss: 1.347269
Client Index = 9	Epoch: 1	Loss: 1.364416
Client Index = 9	Epoch: 2	Loss: 1.334438
Client Index = 9	Epoch: 3	Loss: 1.297459
Client Index = 9	Epoch: 4	Loss: 1.255060
test acc on this client after 265 / 506 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 10
local mask changes: 2933780.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3589426.0, 2933780.0, 3593992.0]
Doing local aggregation!
test acc on this client before 221 / 503 : 0.44
Client Index = 10	Epoch: 0	Loss: 1.444530
Client Index = 10	Epoch: 1	Loss: 1.476443
Client Index = 10	Epoch: 2	Loss: 1.378103
Client Index = 10	Epoch: 3	Loss: 1.386408
Client Index = 10	Epoch: 4	Loss: 1.340192
test acc on this client after 250 / 503 : 0.50
-----------------------------------
training flops per data 2653300736.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 11
local mask changes: 2935706.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3596430.0, 2935706.0, 3594876.0]
Doing local aggregation!
test acc on this client before 243 / 505 : 0.48
Client Index = 11	Epoch: 0	Loss: 1.245621
Client Index = 11	Epoch: 1	Loss: 1.224530
Client Index = 11	Epoch: 2	Loss: 1.054858
Client Index = 11	Epoch: 3	Loss: 1.078764
Client Index = 11	Epoch: 4	Loss: 1.036498
test acc on this client after 303 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 12
local mask changes: 2934976.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3594016.0, 2934976.0, 3592204.0]
Doing local aggregation!
test acc on this client before 124 / 504 : 0.25
Client Index = 12	Epoch: 0	Loss: 1.416296
Client Index = 12	Epoch: 1	Loss: 1.385471
Client Index = 12	Epoch: 2	Loss: 1.415494
Client Index = 12	Epoch: 3	Loss: 1.330796
Client Index = 12	Epoch: 4	Loss: 1.367562
test acc on this client after 279 / 504 : 0.55
-----------------------------------
training flops per data 2653292032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 13
local mask changes: 2935188.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3593402.0, 2935188.0, 3591532.0]
Doing local aggregation!
test acc on this client before 288 / 505 : 0.57
Client Index = 13	Epoch: 0	Loss: 1.379222
Client Index = 13	Epoch: 1	Loss: 1.307579
Client Index = 13	Epoch: 2	Loss: 1.313894
Client Index = 13	Epoch: 3	Loss: 1.241893
Client Index = 13	Epoch: 4	Loss: 1.225049
test acc on this client after 297 / 505 : 0.59
-----------------------------------
training flops per data 2653305856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 14
local mask changes: 2933790.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3593046.0, 2933790.0, 3590524.0]
Doing local aggregation!
test acc on this client before 193 / 503 : 0.38
Client Index = 14	Epoch: 0	Loss: 1.562870
Client Index = 14	Epoch: 1	Loss: 1.504480
Client Index = 14	Epoch: 2	Loss: 1.440106
Client Index = 14	Epoch: 3	Loss: 1.461221
Client Index = 14	Epoch: 4	Loss: 1.428840
test acc on this client after 186 / 503 : 0.37
-----------------------------------
training flops per data 2653320704.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 15
local mask changes: 2935536.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3590424.0, 2935536.0, 3593472.0]
Doing local aggregation!
test acc on this client before 289 / 503 : 0.57
Client Index = 15	Epoch: 0	Loss: 1.319840
Client Index = 15	Epoch: 1	Loss: 1.131037
Client Index = 15	Epoch: 2	Loss: 1.129899
Client Index = 15	Epoch: 3	Loss: 1.120606
Client Index = 15	Epoch: 4	Loss: 1.103636
test acc on this client after 314 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 16
local mask changes: 2936106.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3591190.0, 2936106.0, 3592968.0]
Doing local aggregation!
test acc on this client before 200 / 504 : 0.40
Client Index = 16	Epoch: 0	Loss: 1.466955
Client Index = 16	Epoch: 1	Loss: 1.374975
Client Index = 16	Epoch: 2	Loss: 1.365559
Client Index = 16	Epoch: 3	Loss: 1.316319
Client Index = 16	Epoch: 4	Loss: 1.390183
test acc on this client after 233 / 504 : 0.46
-----------------------------------
training flops per data 2653277440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 17
local mask changes: 2935140.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3594710.0, 2935140.0, 3593904.0]
Doing local aggregation!
test acc on this client before 120 / 503 : 0.24
Client Index = 17	Epoch: 0	Loss: 1.665796
Client Index = 17	Epoch: 1	Loss: 1.617047
Client Index = 17	Epoch: 2	Loss: 1.591215
Client Index = 17	Epoch: 3	Loss: 1.612653
Client Index = 17	Epoch: 4	Loss: 1.539089
test acc on this client after 212 / 503 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 18
local mask changes: 2934088.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3594860.0, 2934088.0, 3591752.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 18	Epoch: 0	Loss: 1.417333
Client Index = 18	Epoch: 1	Loss: 1.290968
Client Index = 18	Epoch: 2	Loss: 1.306666
Client Index = 18	Epoch: 3	Loss: 1.261214
Client Index = 18	Epoch: 4	Loss: 1.252170
test acc on this client after 260 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 19
local mask changes: 2935306.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3595942.0, 3594906.0, 2935306.0]
Doing local aggregation!
test acc on this client before 155 / 503 : 0.31
Client Index = 19	Epoch: 0	Loss: 1.443353
Client Index = 19	Epoch: 1	Loss: 1.414573
Client Index = 19	Epoch: 2	Loss: 1.317705
Client Index = 19	Epoch: 3	Loss: 1.380657
Client Index = 19	Epoch: 4	Loss: 1.274107
test acc on this client after 266 / 503 : 0.53
-----------------------------------
training flops per data 2653306880.0
full flops for search 3332536350
{'training_loss': 1.3050254788696762}
################local_test_on_all_clients after local training in communication round: 4
{'test_acc_after': 0.5530904771972078, 'test_loss_after': 1.278483578818253}
################local_test_on_all_clients before local training in communication round: 4
{'test_acc_before': 0.41473355223597635, 'test_loss_before': 1.6370323465695804}
################Communication round : 5
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 0
local mask changes: 2928798.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2928798.0, 3477780.0, 3478636.0]
Doing local aggregation!
test acc on this client before 196 / 503 : 0.39
Client Index = 0	Epoch: 0	Loss: 1.397890
Client Index = 0	Epoch: 1	Loss: 1.347038
Client Index = 0	Epoch: 2	Loss: 1.309622
Client Index = 0	Epoch: 3	Loss: 1.295314
Client Index = 0	Epoch: 4	Loss: 1.258478
test acc on this client after 297 / 503 : 0.59
-----------------------------------
training flops per data 2653339904.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 1
local mask changes: 2932004.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3473488.0, 2932004.0, 3473018.0]
Doing local aggregation!
test acc on this client before 50 / 503 : 0.10
Client Index = 1	Epoch: 0	Loss: 1.024411
Client Index = 1	Epoch: 1	Loss: 0.965192
Client Index = 1	Epoch: 2	Loss: 0.997656
Client Index = 1	Epoch: 3	Loss: 0.922643
Client Index = 1	Epoch: 4	Loss: 0.957747
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653328896.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 2
local mask changes: 2932718.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3471866.0, 2932718.0, 3477640.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 2	Epoch: 0	Loss: 1.094284
Client Index = 2	Epoch: 1	Loss: 0.883564
Client Index = 2	Epoch: 2	Loss: 0.910441
Client Index = 2	Epoch: 3	Loss: 0.882466
Client Index = 2	Epoch: 4	Loss: 0.825920
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653307392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 3
local mask changes: 2930276.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3479862.0, 2930276.0, 3481454.0]
Doing local aggregation!
test acc on this client before 219 / 504 : 0.43
Client Index = 3	Epoch: 0	Loss: 1.448597
Client Index = 3	Epoch: 1	Loss: 1.261983
Client Index = 3	Epoch: 2	Loss: 1.325065
Client Index = 3	Epoch: 3	Loss: 1.169822
Client Index = 3	Epoch: 4	Loss: 1.228638
test acc on this client after 255 / 504 : 0.51
-----------------------------------
training flops per data 2653249024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 4
local mask changes: 2931258.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3481308.0, 2931258.0, 3477562.0]
Doing local aggregation!
test acc on this client before 187 / 504 : 0.37
Client Index = 4	Epoch: 0	Loss: 1.584272
Client Index = 4	Epoch: 1	Loss: 1.478538
Client Index = 4	Epoch: 2	Loss: 1.437994
Client Index = 4	Epoch: 3	Loss: 1.400389
Client Index = 4	Epoch: 4	Loss: 1.393932
test acc on this client after 247 / 504 : 0.49
-----------------------------------
training flops per data 2653287424.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 5
local mask changes: 2930706.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3476480.0, 2930706.0, 3476272.0]
Doing local aggregation!
test acc on this client before 222 / 503 : 0.44
Client Index = 5	Epoch: 0	Loss: 1.367648
Client Index = 5	Epoch: 1	Loss: 1.217687
Client Index = 5	Epoch: 2	Loss: 1.177042
Client Index = 5	Epoch: 3	Loss: 1.164072
Client Index = 5	Epoch: 4	Loss: 1.181442
test acc on this client after 319 / 503 : 0.63
-----------------------------------
training flops per data 2653274112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 6
local mask changes: 2929914.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3480376.0, 2929914.0, 3478984.0]
Doing local aggregation!
test acc on this client before 221 / 505 : 0.44
Client Index = 6	Epoch: 0	Loss: 1.612343
Client Index = 6	Epoch: 1	Loss: 1.527177
Client Index = 6	Epoch: 2	Loss: 1.483068
Client Index = 6	Epoch: 3	Loss: 1.492633
Client Index = 6	Epoch: 4	Loss: 1.425793
test acc on this client after 229 / 505 : 0.45
-----------------------------------
training flops per data 2653331712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 7
local mask changes: 2930886.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3479234.0, 2930886.0, 3479458.0]
Doing local aggregation!
test acc on this client before 166 / 504 : 0.33
Client Index = 7	Epoch: 0	Loss: 1.617194
Client Index = 7	Epoch: 1	Loss: 1.551392
Client Index = 7	Epoch: 2	Loss: 1.515612
Client Index = 7	Epoch: 3	Loss: 1.460335
Client Index = 7	Epoch: 4	Loss: 1.473663
test acc on this client after 155 / 504 : 0.31
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 8
local mask changes: 2930556.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3473754.0, 2930556.0, 3472764.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 8	Epoch: 0	Loss: 0.884664
Client Index = 8	Epoch: 1	Loss: 0.698359
Client Index = 8	Epoch: 2	Loss: 0.674124
Client Index = 8	Epoch: 3	Loss: 0.705011
Client Index = 8	Epoch: 4	Loss: 0.612663
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 9
local mask changes: 2932824.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3475434.0, 2932824.0, 3472956.0]
Doing local aggregation!
test acc on this client before 165 / 506 : 0.33
Client Index = 9	Epoch: 0	Loss: 1.340634
Client Index = 9	Epoch: 1	Loss: 1.302823
Client Index = 9	Epoch: 2	Loss: 1.293034
Client Index = 9	Epoch: 3	Loss: 1.255829
Client Index = 9	Epoch: 4	Loss: 1.243902
test acc on this client after 272 / 506 : 0.54
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 10
local mask changes: 2928730.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3473030.0, 2928730.0, 3477634.0]
Doing local aggregation!
test acc on this client before 135 / 503 : 0.27
Client Index = 10	Epoch: 0	Loss: 1.462800
Client Index = 10	Epoch: 1	Loss: 1.355248
Client Index = 10	Epoch: 2	Loss: 1.354984
Client Index = 10	Epoch: 3	Loss: 1.401443
Client Index = 10	Epoch: 4	Loss: 1.342846
test acc on this client after 229 / 503 : 0.46
-----------------------------------
training flops per data 2653307136.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 11
local mask changes: 2932748.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3476522.0, 2932748.0, 3476384.0]
Doing local aggregation!
test acc on this client before 226 / 505 : 0.45
Client Index = 11	Epoch: 0	Loss: 1.209189
Client Index = 11	Epoch: 1	Loss: 1.115096
Client Index = 11	Epoch: 2	Loss: 1.059973
Client Index = 11	Epoch: 3	Loss: 1.020508
Client Index = 11	Epoch: 4	Loss: 1.004613
test acc on this client after 322 / 505 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 12
local mask changes: 2932012.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3476718.0, 2932012.0, 3474216.0]
Doing local aggregation!
test acc on this client before 130 / 504 : 0.26
Client Index = 12	Epoch: 0	Loss: 1.404941
Client Index = 12	Epoch: 1	Loss: 1.366612
Client Index = 12	Epoch: 2	Loss: 1.342265
Client Index = 12	Epoch: 3	Loss: 1.327332
Client Index = 12	Epoch: 4	Loss: 1.298387
test acc on this client after 264 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 13
local mask changes: 2933422.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3472688.0, 2933422.0, 3474904.0]
Doing local aggregation!
test acc on this client before 303 / 505 : 0.60
Client Index = 13	Epoch: 0	Loss: 1.320100
Client Index = 13	Epoch: 1	Loss: 1.264873
Client Index = 13	Epoch: 2	Loss: 1.266952
Client Index = 13	Epoch: 3	Loss: 1.235272
Client Index = 13	Epoch: 4	Loss: 1.273947
test acc on this client after 301 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 14
local mask changes: 2932844.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3473258.0, 2932844.0, 3474096.0]
Doing local aggregation!
test acc on this client before 175 / 503 : 0.35
Client Index = 14	Epoch: 0	Loss: 1.452335
Client Index = 14	Epoch: 1	Loss: 1.441198
Client Index = 14	Epoch: 2	Loss: 1.457128
Client Index = 14	Epoch: 3	Loss: 1.433355
Client Index = 14	Epoch: 4	Loss: 1.427326
test acc on this client after 204 / 503 : 0.41
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 15
local mask changes: 2932694.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3472484.0, 2932694.0, 3474312.0]
Doing local aggregation!
test acc on this client before 276 / 503 : 0.55
Client Index = 15	Epoch: 0	Loss: 1.226837
Client Index = 15	Epoch: 1	Loss: 1.080590
Client Index = 15	Epoch: 2	Loss: 1.090413
Client Index = 15	Epoch: 3	Loss: 1.089621
Client Index = 15	Epoch: 4	Loss: 1.060856
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 16
local mask changes: 2929280.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3474808.0, 2929280.0, 3473768.0]
Doing local aggregation!
test acc on this client before 226 / 504 : 0.45
Client Index = 16	Epoch: 0	Loss: 1.418511
Client Index = 16	Epoch: 1	Loss: 1.311964
Client Index = 16	Epoch: 2	Loss: 1.374605
Client Index = 16	Epoch: 3	Loss: 1.300118
Client Index = 16	Epoch: 4	Loss: 1.271796
test acc on this client after 217 / 504 : 0.43
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 17
local mask changes: 2932266.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3478652.0, 2932266.0, 3479924.0]
Doing local aggregation!
test acc on this client before 167 / 503 : 0.33
Client Index = 17	Epoch: 0	Loss: 1.634309
Client Index = 17	Epoch: 1	Loss: 1.601121
Client Index = 17	Epoch: 2	Loss: 1.544534
Client Index = 17	Epoch: 3	Loss: 1.519619
Client Index = 17	Epoch: 4	Loss: 1.529744
test acc on this client after 193 / 503 : 0.38
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 18
local mask changes: 2932372.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3475934.0, 2932372.0, 3477346.0]
Doing local aggregation!
test acc on this client before 213 / 503 : 0.42
Client Index = 18	Epoch: 0	Loss: 1.325819
Client Index = 18	Epoch: 1	Loss: 1.248196
Client Index = 18	Epoch: 2	Loss: 1.258830
Client Index = 18	Epoch: 3	Loss: 1.258193
Client Index = 18	Epoch: 4	Loss: 1.167055
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 19
local mask changes: 2930608.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3476290.0, 3476360.0, 2930608.0]
Doing local aggregation!
test acc on this client before 163 / 503 : 0.32
Client Index = 19	Epoch: 0	Loss: 1.404146
Client Index = 19	Epoch: 1	Loss: 1.400025
Client Index = 19	Epoch: 2	Loss: 1.315011
Client Index = 19	Epoch: 3	Loss: 1.308570
Client Index = 19	Epoch: 4	Loss: 1.278471
test acc on this client after 240 / 503 : 0.48
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
{'training_loss': 1.2673772025555372}
################local_test_on_all_clients after local training in communication round: 5
{'test_acc_after': 0.544753818271693, 'test_loss_after': 1.327658015747378}
################local_test_on_all_clients before local training in communication round: 5
{'test_acc_before': 0.41399182816173774, 'test_loss_before': 1.5862278267141223}
################Communication round : 6
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 0
local mask changes: 2927622.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2927622.0, 3389912.0, 3391388.0]
Doing local aggregation!
test acc on this client before 265 / 503 : 0.53
Client Index = 0	Epoch: 0	Loss: 1.374263
Client Index = 0	Epoch: 1	Loss: 1.269132
Client Index = 0	Epoch: 2	Loss: 1.296137
Client Index = 0	Epoch: 3	Loss: 1.225850
Client Index = 0	Epoch: 4	Loss: 1.155454
test acc on this client after 296 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 1
local mask changes: 2925938.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3386896.0, 2925938.0, 3383984.0]
Doing local aggregation!
test acc on this client before 54 / 503 : 0.11
Client Index = 1	Epoch: 0	Loss: 1.057336
Client Index = 1	Epoch: 1	Loss: 0.987545
Client Index = 1	Epoch: 2	Loss: 0.898325
Client Index = 1	Epoch: 3	Loss: 0.963829
Client Index = 1	Epoch: 4	Loss: 0.884224
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653318144.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 2
local mask changes: 2926938.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3387366.0, 2926938.0, 3392074.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 2	Epoch: 0	Loss: 0.950862
Client Index = 2	Epoch: 1	Loss: 0.882783
Client Index = 2	Epoch: 2	Loss: 0.855359
Client Index = 2	Epoch: 3	Loss: 0.839013
Client Index = 2	Epoch: 4	Loss: 0.821620
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653340160.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 3
local mask changes: 2926798.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3393560.0, 2926798.0, 3395780.0]
Doing local aggregation!
test acc on this client before 223 / 504 : 0.44
Client Index = 3	Epoch: 0	Loss: 1.359151
Client Index = 3	Epoch: 1	Loss: 1.253052
Client Index = 3	Epoch: 2	Loss: 1.171560
Client Index = 3	Epoch: 3	Loss: 1.097139
Client Index = 3	Epoch: 4	Loss: 1.159514
test acc on this client after 289 / 504 : 0.57
-----------------------------------
training flops per data 2653252608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 4
local mask changes: 2926130.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3395776.0, 2926130.0, 3389770.0]
Doing local aggregation!
test acc on this client before 204 / 504 : 0.40
Client Index = 4	Epoch: 0	Loss: 1.506105
Client Index = 4	Epoch: 1	Loss: 1.475559
Client Index = 4	Epoch: 2	Loss: 1.372195
Client Index = 4	Epoch: 3	Loss: 1.366589
Client Index = 4	Epoch: 4	Loss: 1.335502
test acc on this client after 261 / 504 : 0.52
-----------------------------------
training flops per data 2653282560.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 5
local mask changes: 2926672.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3388260.0, 2926672.0, 3389920.0]
Doing local aggregation!
test acc on this client before 233 / 503 : 0.46
Client Index = 5	Epoch: 0	Loss: 1.246741
Client Index = 5	Epoch: 1	Loss: 1.228049
Client Index = 5	Epoch: 2	Loss: 1.140457
Client Index = 5	Epoch: 3	Loss: 1.102531
Client Index = 5	Epoch: 4	Loss: 1.129648
test acc on this client after 332 / 503 : 0.66
-----------------------------------
training flops per data 2653281280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 6
local mask changes: 2927140.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3393196.0, 2927140.0, 3393176.0]
Doing local aggregation!
test acc on this client before 212 / 505 : 0.42
Client Index = 6	Epoch: 0	Loss: 1.610562
Client Index = 6	Epoch: 1	Loss: 1.492842
Client Index = 6	Epoch: 2	Loss: 1.432547
Client Index = 6	Epoch: 3	Loss: 1.437421
Client Index = 6	Epoch: 4	Loss: 1.386153
test acc on this client after 265 / 505 : 0.52
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 7
local mask changes: 2926754.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3392106.0, 2926754.0, 3392394.0]
Doing local aggregation!
test acc on this client before 185 / 504 : 0.37
Client Index = 7	Epoch: 0	Loss: 1.588219
Client Index = 7	Epoch: 1	Loss: 1.523342
Client Index = 7	Epoch: 2	Loss: 1.525606
Client Index = 7	Epoch: 3	Loss: 1.453936
Client Index = 7	Epoch: 4	Loss: 1.433310
test acc on this client after 197 / 504 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 8
local mask changes: 2928414.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3387984.0, 2928414.0, 3386928.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 0.818375
Client Index = 8	Epoch: 1	Loss: 0.672928
Client Index = 8	Epoch: 2	Loss: 0.637054
Client Index = 8	Epoch: 3	Loss: 0.700834
Client Index = 8	Epoch: 4	Loss: 0.615858
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 9
local mask changes: 2926488.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3387952.0, 2926488.0, 3386290.0]
Doing local aggregation!
test acc on this client before 119 / 506 : 0.24
Client Index = 9	Epoch: 0	Loss: 1.325964
Client Index = 9	Epoch: 1	Loss: 1.294427
Client Index = 9	Epoch: 2	Loss: 1.243912
Client Index = 9	Epoch: 3	Loss: 1.209389
Client Index = 9	Epoch: 4	Loss: 1.233478
test acc on this client after 228 / 506 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 10
local mask changes: 2925788.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3388874.0, 2925788.0, 3389342.0]
Doing local aggregation!
test acc on this client before 239 / 503 : 0.48
Client Index = 10	Epoch: 0	Loss: 1.414766
Client Index = 10	Epoch: 1	Loss: 1.321168
Client Index = 10	Epoch: 2	Loss: 1.313435
Client Index = 10	Epoch: 3	Loss: 1.319411
Client Index = 10	Epoch: 4	Loss: 1.290511
test acc on this client after 226 / 503 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 11
local mask changes: 2924622.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3389492.0, 2924622.0, 3391526.0]
Doing local aggregation!
test acc on this client before 263 / 505 : 0.52
Client Index = 11	Epoch: 0	Loss: 1.167050
Client Index = 11	Epoch: 1	Loss: 1.008729
Client Index = 11	Epoch: 2	Loss: 1.029625
Client Index = 11	Epoch: 3	Loss: 0.956480
Client Index = 11	Epoch: 4	Loss: 1.021275
test acc on this client after 308 / 505 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 12
local mask changes: 2928084.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3389246.0, 2928084.0, 3387314.0]
Doing local aggregation!
test acc on this client before 189 / 504 : 0.38
Client Index = 12	Epoch: 0	Loss: 1.437790
Client Index = 12	Epoch: 1	Loss: 1.329810
Client Index = 12	Epoch: 2	Loss: 1.255269
Client Index = 12	Epoch: 3	Loss: 1.292541
Client Index = 12	Epoch: 4	Loss: 1.314671
test acc on this client after 267 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 13
local mask changes: 2926030.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3385666.0, 2926030.0, 3389226.0]
Doing local aggregation!
test acc on this client before 292 / 505 : 0.58
Client Index = 13	Epoch: 0	Loss: 1.290568
Client Index = 13	Epoch: 1	Loss: 1.222211
Client Index = 13	Epoch: 2	Loss: 1.242271
Client Index = 13	Epoch: 3	Loss: 1.198661
Client Index = 13	Epoch: 4	Loss: 1.240194
test acc on this client after 276 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 14
local mask changes: 2928462.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3390514.0, 2928462.0, 3389058.0]
Doing local aggregation!
test acc on this client before 206 / 503 : 0.41
Client Index = 14	Epoch: 0	Loss: 1.414620
Client Index = 14	Epoch: 1	Loss: 1.408112
Client Index = 14	Epoch: 2	Loss: 1.385948
Client Index = 14	Epoch: 3	Loss: 1.428705
Client Index = 14	Epoch: 4	Loss: 1.373048
test acc on this client after 218 / 503 : 0.43
-----------------------------------
training flops per data 2653339648.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 15
local mask changes: 2925726.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3388192.0, 2925726.0, 3386740.0]
Doing local aggregation!
test acc on this client before 202 / 503 : 0.40
Client Index = 15	Epoch: 0	Loss: 1.140730
Client Index = 15	Epoch: 1	Loss: 1.092504
Client Index = 15	Epoch: 2	Loss: 1.021372
Client Index = 15	Epoch: 3	Loss: 1.064946
Client Index = 15	Epoch: 4	Loss: 1.077549
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 16
local mask changes: 2926042.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3385690.0, 2926042.0, 3388358.0]
Doing local aggregation!
test acc on this client before 249 / 504 : 0.49
Client Index = 16	Epoch: 0	Loss: 1.354673
Client Index = 16	Epoch: 1	Loss: 1.307349
Client Index = 16	Epoch: 2	Loss: 1.284700
Client Index = 16	Epoch: 3	Loss: 1.281743
Client Index = 16	Epoch: 4	Loss: 1.275335
test acc on this client after 266 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 17
local mask changes: 2927476.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3393946.0, 2927476.0, 3391322.0]
Doing local aggregation!
test acc on this client before 156 / 503 : 0.31
Client Index = 17	Epoch: 0	Loss: 1.605804
Client Index = 17	Epoch: 1	Loss: 1.523566
Client Index = 17	Epoch: 2	Loss: 1.544858
Client Index = 17	Epoch: 3	Loss: 1.527541
Client Index = 17	Epoch: 4	Loss: 1.490309
test acc on this client after 202 / 503 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 18
local mask changes: 2925268.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3389018.0, 2925268.0, 3389858.0]
Doing local aggregation!
test acc on this client before 235 / 503 : 0.47
Client Index = 18	Epoch: 0	Loss: 1.291351
Client Index = 18	Epoch: 1	Loss: 1.215421
Client Index = 18	Epoch: 2	Loss: 1.222470
Client Index = 18	Epoch: 3	Loss: 1.164044
Client Index = 18	Epoch: 4	Loss: 1.170757
test acc on this client after 307 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 19
local mask changes: 2927676.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3391968.0, 3388768.0, 2927676.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 19	Epoch: 0	Loss: 1.397468
Client Index = 19	Epoch: 1	Loss: 1.308063
Client Index = 19	Epoch: 2	Loss: 1.213626
Client Index = 19	Epoch: 3	Loss: 1.287491
Client Index = 19	Epoch: 4	Loss: 1.331732
test acc on this client after 289 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.2291395166516303}
################local_test_on_all_clients after local training in communication round: 6
{'test_acc_after': 0.5612620045468362, 'test_loss_after': 1.2743926279627185}
################local_test_on_all_clients before local training in communication round: 6
{'test_acc_before': 0.4472873963936532, 'test_loss_before': 1.5471295434243733}
################Communication round : 7
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 0
local mask changes: 2921612.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2921612.0, 3321982.0, 3324798.0]
Doing local aggregation!
test acc on this client before 265 / 503 : 0.53
Client Index = 0	Epoch: 0	Loss: 1.357462
Client Index = 0	Epoch: 1	Loss: 1.243201
Client Index = 0	Epoch: 2	Loss: 1.188042
Client Index = 0	Epoch: 3	Loss: 1.219824
Client Index = 0	Epoch: 4	Loss: 1.187281
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 1
local mask changes: 2920814.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3319432.0, 2920814.0, 3317192.0]
Doing local aggregation!
test acc on this client before 135 / 503 : 0.27
Client Index = 1	Epoch: 0	Loss: 1.057520
Client Index = 1	Epoch: 1	Loss: 0.926619
Client Index = 1	Epoch: 2	Loss: 0.895213
Client Index = 1	Epoch: 3	Loss: 0.900506
Client Index = 1	Epoch: 4	Loss: 0.874188
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653335040.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 2
local mask changes: 2920572.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3320084.0, 2920572.0, 3326064.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.912869
Client Index = 2	Epoch: 1	Loss: 0.905392
Client Index = 2	Epoch: 2	Loss: 0.861841
Client Index = 2	Epoch: 3	Loss: 0.803416
Client Index = 2	Epoch: 4	Loss: 0.815791
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 3
local mask changes: 2920828.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3329746.0, 2920828.0, 3330958.0]
Doing local aggregation!
test acc on this client before 232 / 504 : 0.46
Client Index = 3	Epoch: 0	Loss: 1.320710
Client Index = 3	Epoch: 1	Loss: 1.191262
Client Index = 3	Epoch: 2	Loss: 1.109466
Client Index = 3	Epoch: 3	Loss: 1.105317
Client Index = 3	Epoch: 4	Loss: 1.040755
test acc on this client after 314 / 504 : 0.62
-----------------------------------
training flops per data 2653292544.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 4
local mask changes: 2922038.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3331168.0, 2922038.0, 3324884.0]
Doing local aggregation!
test acc on this client before 212 / 504 : 0.42
Client Index = 4	Epoch: 0	Loss: 1.517582
Client Index = 4	Epoch: 1	Loss: 1.383452
Client Index = 4	Epoch: 2	Loss: 1.372668
Client Index = 4	Epoch: 3	Loss: 1.318878
Client Index = 4	Epoch: 4	Loss: 1.362394
test acc on this client after 228 / 504 : 0.45
-----------------------------------
training flops per data 2653281792.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 5
local mask changes: 2921690.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3322240.0, 2921690.0, 3322964.0]
Doing local aggregation!
test acc on this client before 202 / 503 : 0.40
Client Index = 5	Epoch: 0	Loss: 1.244214
Client Index = 5	Epoch: 1	Loss: 1.156263
Client Index = 5	Epoch: 2	Loss: 1.107958
Client Index = 5	Epoch: 3	Loss: 1.159908
Client Index = 5	Epoch: 4	Loss: 1.113933
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 6
local mask changes: 2921676.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3323422.0, 2921676.0, 3325976.0]
Doing local aggregation!
test acc on this client before 252 / 505 : 0.50
Client Index = 6	Epoch: 0	Loss: 1.445524
Client Index = 6	Epoch: 1	Loss: 1.460934
Client Index = 6	Epoch: 2	Loss: 1.372307
Client Index = 6	Epoch: 3	Loss: 1.396031
Client Index = 6	Epoch: 4	Loss: 1.377460
test acc on this client after 260 / 505 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 7
local mask changes: 2921264.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3325430.0, 2921264.0, 3324650.0]
Doing local aggregation!
test acc on this client before 175 / 504 : 0.35
Client Index = 7	Epoch: 0	Loss: 1.587563
Client Index = 7	Epoch: 1	Loss: 1.449623
Client Index = 7	Epoch: 2	Loss: 1.500121
Client Index = 7	Epoch: 3	Loss: 1.442127
Client Index = 7	Epoch: 4	Loss: 1.416033
test acc on this client after 225 / 504 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 8
local mask changes: 2922040.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3321144.0, 2922040.0, 3320428.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.800618
Client Index = 8	Epoch: 1	Loss: 0.666923
Client Index = 8	Epoch: 2	Loss: 0.651114
Client Index = 8	Epoch: 3	Loss: 0.626682
Client Index = 8	Epoch: 4	Loss: 0.633285
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 9
local mask changes: 2920572.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3321046.0, 2920572.0, 3318484.0]
Doing local aggregation!
test acc on this client before 179 / 506 : 0.35
Client Index = 9	Epoch: 0	Loss: 1.272095
Client Index = 9	Epoch: 1	Loss: 1.271127
Client Index = 9	Epoch: 2	Loss: 1.235834
Client Index = 9	Epoch: 3	Loss: 1.197144
Client Index = 9	Epoch: 4	Loss: 1.212464
test acc on this client after 254 / 506 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 10
local mask changes: 2919242.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3320174.0, 2919242.0, 3323692.0]
Doing local aggregation!
test acc on this client before 209 / 503 : 0.42
Client Index = 10	Epoch: 0	Loss: 1.328999
Client Index = 10	Epoch: 1	Loss: 1.308765
Client Index = 10	Epoch: 2	Loss: 1.316347
Client Index = 10	Epoch: 3	Loss: 1.269288
Client Index = 10	Epoch: 4	Loss: 1.192461
test acc on this client after 229 / 503 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 11
local mask changes: 2920338.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3324158.0, 2920338.0, 3325828.0]
Doing local aggregation!
test acc on this client before 276 / 505 : 0.55
Client Index = 11	Epoch: 0	Loss: 1.048249
Client Index = 11	Epoch: 1	Loss: 1.073787
Client Index = 11	Epoch: 2	Loss: 0.950626
Client Index = 11	Epoch: 3	Loss: 0.946587
Client Index = 11	Epoch: 4	Loss: 0.929511
test acc on this client after 288 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 12
local mask changes: 2922224.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3325302.0, 2922224.0, 3320236.0]
Doing local aggregation!
test acc on this client before 209 / 504 : 0.41
Client Index = 12	Epoch: 0	Loss: 1.380823
Client Index = 12	Epoch: 1	Loss: 1.342946
Client Index = 12	Epoch: 2	Loss: 1.246235
Client Index = 12	Epoch: 3	Loss: 1.249864
Client Index = 12	Epoch: 4	Loss: 1.270438
test acc on this client after 278 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 13
local mask changes: 2924982.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3321970.0, 2924982.0, 3322140.0]
Doing local aggregation!
test acc on this client before 302 / 505 : 0.60
Client Index = 13	Epoch: 0	Loss: 1.242440
Client Index = 13	Epoch: 1	Loss: 1.242984
Client Index = 13	Epoch: 2	Loss: 1.190039
Client Index = 13	Epoch: 3	Loss: 1.159632
Client Index = 13	Epoch: 4	Loss: 1.180924
test acc on this client after 234 / 505 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 14
local mask changes: 2922948.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3322478.0, 2922948.0, 3322896.0]
Doing local aggregation!
test acc on this client before 212 / 503 : 0.42
Client Index = 14	Epoch: 0	Loss: 1.401011
Client Index = 14	Epoch: 1	Loss: 1.354500
Client Index = 14	Epoch: 2	Loss: 1.350622
Client Index = 14	Epoch: 3	Loss: 1.309258
Client Index = 14	Epoch: 4	Loss: 1.302281
test acc on this client after 258 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 15
local mask changes: 2919996.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3323268.0, 2919996.0, 3319066.0]
Doing local aggregation!
test acc on this client before 299 / 503 : 0.59
Client Index = 15	Epoch: 0	Loss: 1.095098
Client Index = 15	Epoch: 1	Loss: 1.025345
Client Index = 15	Epoch: 2	Loss: 1.012598
Client Index = 15	Epoch: 3	Loss: 1.069122
Client Index = 15	Epoch: 4	Loss: 0.995472
test acc on this client after 321 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 16
local mask changes: 2921746.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3320708.0, 2921746.0, 3319180.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 16	Epoch: 0	Loss: 1.315845
Client Index = 16	Epoch: 1	Loss: 1.279118
Client Index = 16	Epoch: 2	Loss: 1.239771
Client Index = 16	Epoch: 3	Loss: 1.216746
Client Index = 16	Epoch: 4	Loss: 1.245812
test acc on this client after 248 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 17
local mask changes: 2921002.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3324978.0, 2921002.0, 3325042.0]
Doing local aggregation!
test acc on this client before 148 / 503 : 0.29
Client Index = 17	Epoch: 0	Loss: 1.520208
Client Index = 17	Epoch: 1	Loss: 1.516211
Client Index = 17	Epoch: 2	Loss: 1.495740
Client Index = 17	Epoch: 3	Loss: 1.467424
Client Index = 17	Epoch: 4	Loss: 1.477649
test acc on this client after 185 / 503 : 0.37
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 18
local mask changes: 2921248.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3325298.0, 2921248.0, 3325402.0]
Doing local aggregation!
test acc on this client before 283 / 503 : 0.56
Client Index = 18	Epoch: 0	Loss: 1.272951
Client Index = 18	Epoch: 1	Loss: 1.183489
Client Index = 18	Epoch: 2	Loss: 1.138722
Client Index = 18	Epoch: 3	Loss: 1.166511
Client Index = 18	Epoch: 4	Loss: 1.124537
test acc on this client after 295 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 19
local mask changes: 2921540.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3323130.0, 3323780.0, 2921540.0]
Doing local aggregation!
test acc on this client before 178 / 503 : 0.35
Client Index = 19	Epoch: 0	Loss: 1.323381
Client Index = 19	Epoch: 1	Loss: 1.296999
Client Index = 19	Epoch: 2	Loss: 1.281767
Client Index = 19	Epoch: 3	Loss: 1.242627
Client Index = 19	Epoch: 4	Loss: 1.197662
test acc on this client after 181 / 503 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.1945835463255643}
################local_test_on_all_clients after local training in communication round: 7
{'test_acc_after': 0.5545980286707158, 'test_loss_after': 1.28524412110986}
################local_test_on_all_clients before local training in communication round: 7
{'test_acc_before': 0.4716753861076314, 'test_loss_before': 1.5027089689298823}
################Communication round : 8
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 0
local mask changes: 2915190.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2915190.0, 3271106.0, 3270762.0]
Doing local aggregation!
test acc on this client before 269 / 503 : 0.53
Client Index = 0	Epoch: 0	Loss: 1.265229
Client Index = 0	Epoch: 1	Loss: 1.216106
Client Index = 0	Epoch: 2	Loss: 1.178026
Client Index = 0	Epoch: 3	Loss: 1.198250
Client Index = 0	Epoch: 4	Loss: 1.123048
test acc on this client after 309 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 1
local mask changes: 2913496.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3269190.0, 2913496.0, 3269354.0]
Doing local aggregation!
test acc on this client before 98 / 503 : 0.19
Client Index = 1	Epoch: 0	Loss: 0.954604
Client Index = 1	Epoch: 1	Loss: 0.853730
Client Index = 1	Epoch: 2	Loss: 0.846833
Client Index = 1	Epoch: 3	Loss: 0.884624
Client Index = 1	Epoch: 4	Loss: 0.870585
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653336576.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 2
local mask changes: 2913540.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3267972.0, 2913540.0, 3275356.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.858617
Client Index = 2	Epoch: 1	Loss: 0.818447
Client Index = 2	Epoch: 2	Loss: 0.751711
Client Index = 2	Epoch: 3	Loss: 0.809986
Client Index = 2	Epoch: 4	Loss: 0.750185
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 3
local mask changes: 2914914.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3279060.0, 2914914.0, 3281656.0]
Doing local aggregation!
test acc on this client before 245 / 504 : 0.49
Client Index = 3	Epoch: 0	Loss: 1.391738
Client Index = 3	Epoch: 1	Loss: 1.107478
Client Index = 3	Epoch: 2	Loss: 1.137452
Client Index = 3	Epoch: 3	Loss: 1.069135
Client Index = 3	Epoch: 4	Loss: 0.978386
test acc on this client after 253 / 504 : 0.50
-----------------------------------
training flops per data 2653292288.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 4
local mask changes: 2913412.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3279694.0, 2913412.0, 3272688.0]
Doing local aggregation!
test acc on this client before 278 / 504 : 0.55
Client Index = 4	Epoch: 0	Loss: 1.427905
Client Index = 4	Epoch: 1	Loss: 1.354174
Client Index = 4	Epoch: 2	Loss: 1.359032
Client Index = 4	Epoch: 3	Loss: 1.298532
Client Index = 4	Epoch: 4	Loss: 1.245865
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 5
local mask changes: 2914230.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3270080.0, 2914230.0, 3271920.0]
Doing local aggregation!
test acc on this client before 314 / 503 : 0.62
Client Index = 5	Epoch: 0	Loss: 1.183406
Client Index = 5	Epoch: 1	Loss: 1.101431
Client Index = 5	Epoch: 2	Loss: 1.110602
Client Index = 5	Epoch: 3	Loss: 1.071985
Client Index = 5	Epoch: 4	Loss: 1.160582
test acc on this client after 323 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 6
local mask changes: 2913866.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3273396.0, 2913866.0, 3275594.0]
Doing local aggregation!
test acc on this client before 212 / 505 : 0.42
Client Index = 6	Epoch: 0	Loss: 1.454731
Client Index = 6	Epoch: 1	Loss: 1.406703
Client Index = 6	Epoch: 2	Loss: 1.360802
Client Index = 6	Epoch: 3	Loss: 1.357337
Client Index = 6	Epoch: 4	Loss: 1.325135
test acc on this client after 197 / 505 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 7
local mask changes: 2914196.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3276496.0, 2914196.0, 3274420.0]
Doing local aggregation!
test acc on this client before 207 / 504 : 0.41
Client Index = 7	Epoch: 0	Loss: 1.481671
Client Index = 7	Epoch: 1	Loss: 1.400246
Client Index = 7	Epoch: 2	Loss: 1.454454
Client Index = 7	Epoch: 3	Loss: 1.396515
Client Index = 7	Epoch: 4	Loss: 1.443428
test acc on this client after 173 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 8
local mask changes: 2916338.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3270906.0, 2916338.0, 3268230.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 8	Epoch: 0	Loss: 0.754941
Client Index = 8	Epoch: 1	Loss: 0.693487
Client Index = 8	Epoch: 2	Loss: 0.595993
Client Index = 8	Epoch: 3	Loss: 0.620411
Client Index = 8	Epoch: 4	Loss: 0.596591
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 9
local mask changes: 2914076.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3270966.0, 2914076.0, 3265560.0]
Doing local aggregation!
test acc on this client before 125 / 506 : 0.25
Client Index = 9	Epoch: 0	Loss: 1.257861
Client Index = 9	Epoch: 1	Loss: 1.173442
Client Index = 9	Epoch: 2	Loss: 1.201567
Client Index = 9	Epoch: 3	Loss: 1.183003
Client Index = 9	Epoch: 4	Loss: 1.197478
test acc on this client after 280 / 506 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 10
local mask changes: 2916038.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3268768.0, 2916038.0, 3271218.0]
Doing local aggregation!
test acc on this client before 241 / 503 : 0.48
Client Index = 10	Epoch: 0	Loss: 1.366857
Client Index = 10	Epoch: 1	Loss: 1.284763
Client Index = 10	Epoch: 2	Loss: 1.247430
Client Index = 10	Epoch: 3	Loss: 1.225792
Client Index = 10	Epoch: 4	Loss: 1.255363
test acc on this client after 247 / 503 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 11
local mask changes: 2915474.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3273866.0, 2915474.0, 3273956.0]
Doing local aggregation!
test acc on this client before 247 / 505 : 0.49
Client Index = 11	Epoch: 0	Loss: 1.138774
Client Index = 11	Epoch: 1	Loss: 0.966490
Client Index = 11	Epoch: 2	Loss: 0.883606
Client Index = 11	Epoch: 3	Loss: 0.923296
Client Index = 11	Epoch: 4	Loss: 1.054003
test acc on this client after 352 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 12
local mask changes: 2916216.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3276440.0, 2916216.0, 3270576.0]
Doing local aggregation!
test acc on this client before 199 / 504 : 0.39
Client Index = 12	Epoch: 0	Loss: 1.322638
Client Index = 12	Epoch: 1	Loss: 1.257671
Client Index = 12	Epoch: 2	Loss: 1.284754
Client Index = 12	Epoch: 3	Loss: 1.230883
Client Index = 12	Epoch: 4	Loss: 1.220357
test acc on this client after 220 / 504 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 13
local mask changes: 2914572.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3268214.0, 2914572.0, 3266996.0]
Doing local aggregation!
test acc on this client before 269 / 505 : 0.53
Client Index = 13	Epoch: 0	Loss: 1.238536
Client Index = 13	Epoch: 1	Loss: 1.209933
Client Index = 13	Epoch: 2	Loss: 1.179234
Client Index = 13	Epoch: 3	Loss: 1.127725
Client Index = 13	Epoch: 4	Loss: 1.151759
test acc on this client after 306 / 505 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 14
local mask changes: 2914404.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3269176.0, 2914404.0, 3269492.0]
Doing local aggregation!
test acc on this client before 167 / 503 : 0.33
Client Index = 14	Epoch: 0	Loss: 1.394306
Client Index = 14	Epoch: 1	Loss: 1.364424
Client Index = 14	Epoch: 2	Loss: 1.311965
Client Index = 14	Epoch: 3	Loss: 1.312148
Client Index = 14	Epoch: 4	Loss: 1.264931
test acc on this client after 184 / 503 : 0.37
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 15
local mask changes: 2915296.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3268538.0, 2915296.0, 3268276.0]
Doing local aggregation!
test acc on this client before 309 / 503 : 0.61
Client Index = 15	Epoch: 0	Loss: 1.028636
Client Index = 15	Epoch: 1	Loss: 1.021078
Client Index = 15	Epoch: 2	Loss: 1.009333
Client Index = 15	Epoch: 3	Loss: 1.011276
Client Index = 15	Epoch: 4	Loss: 0.962298
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 16
local mask changes: 2913864.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3267686.0, 2913864.0, 3271490.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 16	Epoch: 0	Loss: 1.284318
Client Index = 16	Epoch: 1	Loss: 1.244850
Client Index = 16	Epoch: 2	Loss: 1.186553
Client Index = 16	Epoch: 3	Loss: 1.222678
Client Index = 16	Epoch: 4	Loss: 1.132948
test acc on this client after 259 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 17
local mask changes: 2914248.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3271404.0, 2914248.0, 3274660.0]
Doing local aggregation!
test acc on this client before 156 / 503 : 0.31
Client Index = 17	Epoch: 0	Loss: 1.519406
Client Index = 17	Epoch: 1	Loss: 1.462471
Client Index = 17	Epoch: 2	Loss: 1.465419
Client Index = 17	Epoch: 3	Loss: 1.433192
Client Index = 17	Epoch: 4	Loss: 1.399607
test acc on this client after 233 / 503 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 18
local mask changes: 2911074.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3274684.0, 2911074.0, 3271938.0]
Doing local aggregation!
test acc on this client before 283 / 503 : 0.56
Client Index = 18	Epoch: 0	Loss: 1.184846
Client Index = 18	Epoch: 1	Loss: 1.149249
Client Index = 18	Epoch: 2	Loss: 1.145992
Client Index = 18	Epoch: 3	Loss: 1.077879
Client Index = 18	Epoch: 4	Loss: 1.170664
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 19
local mask changes: 2912986.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3275114.0, 3272584.0, 2912986.0]
Doing local aggregation!
test acc on this client before 176 / 503 : 0.35
Client Index = 19	Epoch: 0	Loss: 1.333494
Client Index = 19	Epoch: 1	Loss: 1.148679
Client Index = 19	Epoch: 2	Loss: 1.299284
Client Index = 19	Epoch: 3	Loss: 1.163498
Client Index = 19	Epoch: 4	Loss: 1.212195
test acc on this client after 296 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.1622095951139926}
################local_test_on_all_clients after local training in communication round: 8
{'test_acc_after': 0.5669052562199652, 'test_loss_after': 1.246031365555257}
################local_test_on_all_clients before local training in communication round: 8
{'test_acc_before': 0.47887562825068547, 'test_loss_before': 1.4488715974777882}
################Communication round : 9
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 0
local mask changes: 2904362.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2904362.0, 3226972.0, 3228100.0]
Doing local aggregation!
test acc on this client before 274 / 503 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.193899
Client Index = 0	Epoch: 1	Loss: 1.210585
Client Index = 0	Epoch: 2	Loss: 1.146079
Client Index = 0	Epoch: 3	Loss: 1.139595
Client Index = 0	Epoch: 4	Loss: 1.161448
test acc on this client after 323 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 1
local mask changes: 2908878.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3228032.0, 2908878.0, 3230032.0]
Doing local aggregation!
test acc on this client before 273 / 503 : 0.54
Client Index = 1	Epoch: 0	Loss: 0.878458
Client Index = 1	Epoch: 1	Loss: 0.923786
Client Index = 1	Epoch: 2	Loss: 0.858126
Client Index = 1	Epoch: 3	Loss: 0.822973
Client Index = 1	Epoch: 4	Loss: 0.795091
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 2
local mask changes: 2907522.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3228018.0, 2907522.0, 3232052.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.870602
Client Index = 2	Epoch: 1	Loss: 0.746931
Client Index = 2	Epoch: 2	Loss: 0.736075
Client Index = 2	Epoch: 3	Loss: 0.768449
Client Index = 2	Epoch: 4	Loss: 0.707191
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 3
local mask changes: 2905450.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3239640.0, 2905450.0, 3242160.0]
Doing local aggregation!
test acc on this client before 230 / 504 : 0.46
Client Index = 3	Epoch: 0	Loss: 1.232254
Client Index = 3	Epoch: 1	Loss: 1.164207
Client Index = 3	Epoch: 2	Loss: 1.076010
Client Index = 3	Epoch: 3	Loss: 0.965207
Client Index = 3	Epoch: 4	Loss: 1.104073
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653297664.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 4
local mask changes: 2907656.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3242012.0, 2907656.0, 3230410.0]
Doing local aggregation!
test acc on this client before 257 / 504 : 0.51
Client Index = 4	Epoch: 0	Loss: 1.406456
Client Index = 4	Epoch: 1	Loss: 1.429070
Client Index = 4	Epoch: 2	Loss: 1.243199
Client Index = 4	Epoch: 3	Loss: 1.268719
Client Index = 4	Epoch: 4	Loss: 1.273960
test acc on this client after 249 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 5
local mask changes: 2906198.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3228482.0, 2906198.0, 3229486.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 5	Epoch: 0	Loss: 1.135131
Client Index = 5	Epoch: 1	Loss: 1.112223
Client Index = 5	Epoch: 2	Loss: 1.062254
Client Index = 5	Epoch: 3	Loss: 1.074997
Client Index = 5	Epoch: 4	Loss: 1.076025
test acc on this client after 223 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 6
local mask changes: 2907456.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3232204.0, 2907456.0, 3231444.0]
Doing local aggregation!
test acc on this client before 233 / 505 : 0.46
Client Index = 6	Epoch: 0	Loss: 1.519024
Client Index = 6	Epoch: 1	Loss: 1.309982
Client Index = 6	Epoch: 2	Loss: 1.283674
Client Index = 6	Epoch: 3	Loss: 1.334023
Client Index = 6	Epoch: 4	Loss: 1.259966
test acc on this client after 259 / 505 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 7
local mask changes: 2906758.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3233952.0, 2906758.0, 3233636.0]
Doing local aggregation!
test acc on this client before 161 / 504 : 0.32
Client Index = 7	Epoch: 0	Loss: 1.480850
Client Index = 7	Epoch: 1	Loss: 1.341756
Client Index = 7	Epoch: 2	Loss: 1.396308
Client Index = 7	Epoch: 3	Loss: 1.348189
Client Index = 7	Epoch: 4	Loss: 1.389983
test acc on this client after 224 / 504 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 8
local mask changes: 2905440.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3229554.0, 2905440.0, 3229144.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.749160
Client Index = 8	Epoch: 1	Loss: 0.572710
Client Index = 8	Epoch: 2	Loss: 0.618632
Client Index = 8	Epoch: 3	Loss: 0.612654
Client Index = 8	Epoch: 4	Loss: 0.551965
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 9
local mask changes: 2907492.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3226252.0, 2907492.0, 3222922.0]
Doing local aggregation!
test acc on this client before 238 / 506 : 0.47
Client Index = 9	Epoch: 0	Loss: 1.232879
Client Index = 9	Epoch: 1	Loss: 1.222671
Client Index = 9	Epoch: 2	Loss: 1.136561
Client Index = 9	Epoch: 3	Loss: 1.136232
Client Index = 9	Epoch: 4	Loss: 1.176123
test acc on this client after 246 / 506 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 10
local mask changes: 2906674.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3225310.0, 2906674.0, 3228318.0]
Doing local aggregation!
test acc on this client before 216 / 503 : 0.43
Client Index = 10	Epoch: 0	Loss: 1.259807
Client Index = 10	Epoch: 1	Loss: 1.253649
Client Index = 10	Epoch: 2	Loss: 1.195293
Client Index = 10	Epoch: 3	Loss: 1.192691
Client Index = 10	Epoch: 4	Loss: 1.275138
test acc on this client after 230 / 503 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 11
local mask changes: 2907548.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3231870.0, 2907548.0, 3234206.0]
Doing local aggregation!
test acc on this client before 287 / 505 : 0.57
Client Index = 11	Epoch: 0	Loss: 0.929581
Client Index = 11	Epoch: 1	Loss: 0.995500
Client Index = 11	Epoch: 2	Loss: 0.902753
Client Index = 11	Epoch: 3	Loss: 0.925196
Client Index = 11	Epoch: 4	Loss: 0.928652
test acc on this client after 351 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 12
local mask changes: 2905314.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3231532.0, 2905314.0, 3226334.0]
Doing local aggregation!
test acc on this client before 174 / 504 : 0.35
Client Index = 12	Epoch: 0	Loss: 1.253858
Client Index = 12	Epoch: 1	Loss: 1.276347
Client Index = 12	Epoch: 2	Loss: 1.215894
Client Index = 12	Epoch: 3	Loss: 1.253774
Client Index = 12	Epoch: 4	Loss: 1.206786
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 13
local mask changes: 2906566.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3228278.0, 2906566.0, 3228170.0]
Doing local aggregation!
test acc on this client before 311 / 505 : 0.62
Client Index = 13	Epoch: 0	Loss: 1.188138
Client Index = 13	Epoch: 1	Loss: 1.132937
Client Index = 13	Epoch: 2	Loss: 1.132226
Client Index = 13	Epoch: 3	Loss: 1.128158
Client Index = 13	Epoch: 4	Loss: 1.078515
test acc on this client after 315 / 505 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 14
local mask changes: 2907624.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3226990.0, 2907624.0, 3228610.0]
Doing local aggregation!
test acc on this client before 192 / 503 : 0.38
Client Index = 14	Epoch: 0	Loss: 1.334509
Client Index = 14	Epoch: 1	Loss: 1.300020
Client Index = 14	Epoch: 2	Loss: 1.324809
Client Index = 14	Epoch: 3	Loss: 1.206883
Client Index = 14	Epoch: 4	Loss: 1.327165
test acc on this client after 244 / 503 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 15
local mask changes: 2906806.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3225472.0, 2906806.0, 3225846.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 15	Epoch: 0	Loss: 1.063501
Client Index = 15	Epoch: 1	Loss: 0.960911
Client Index = 15	Epoch: 2	Loss: 0.970162
Client Index = 15	Epoch: 3	Loss: 0.949871
Client Index = 15	Epoch: 4	Loss: 0.916280
test acc on this client after 351 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 16
local mask changes: 2908738.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3228562.0, 2908738.0, 3228672.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 16	Epoch: 0	Loss: 1.288749
Client Index = 16	Epoch: 1	Loss: 1.164228
Client Index = 16	Epoch: 2	Loss: 1.228925
Client Index = 16	Epoch: 3	Loss: 1.132002
Client Index = 16	Epoch: 4	Loss: 1.118976
test acc on this client after 252 / 504 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 17
local mask changes: 2907586.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3229178.0, 2907586.0, 3231146.0]
Doing local aggregation!
test acc on this client before 189 / 503 : 0.38
Client Index = 17	Epoch: 0	Loss: 1.471548
Client Index = 17	Epoch: 1	Loss: 1.416737
Client Index = 17	Epoch: 2	Loss: 1.447785
Client Index = 17	Epoch: 3	Loss: 1.389062
Client Index = 17	Epoch: 4	Loss: 1.380942
test acc on this client after 219 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 18
local mask changes: 2907116.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3231086.0, 2907116.0, 3230724.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 18	Epoch: 0	Loss: 1.163708
Client Index = 18	Epoch: 1	Loss: 1.146742
Client Index = 18	Epoch: 2	Loss: 1.129704
Client Index = 18	Epoch: 3	Loss: 1.037250
Client Index = 18	Epoch: 4	Loss: 1.082961
test acc on this client after 306 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 19
local mask changes: 2907368.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3230098.0, 3231778.0, 2907368.0]
Doing local aggregation!
test acc on this client before 192 / 503 : 0.38
Client Index = 19	Epoch: 0	Loss: 1.259617
Client Index = 19	Epoch: 1	Loss: 1.239423
Client Index = 19	Epoch: 2	Loss: 1.226624
Client Index = 19	Epoch: 3	Loss: 1.113977
Client Index = 19	Epoch: 4	Loss: 1.122247
test acc on this client after 223 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.1289662781804801}
################local_test_on_all_clients after local training in communication round: 9
{'test_acc_after': 0.5787827756402821, 'test_loss_after': 1.2124714125030285}
################local_test_on_all_clients before local training in communication round: 9
{'test_acc_before': 0.5139768754977074, 'test_loss_before': 1.404482184602608}
################Communication round : 10
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 0
local mask changes: 2897632.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2897632.0, 3191514.0, 3196052.0]
Doing local aggregation!
test acc on this client before 308 / 503 : 0.61
Client Index = 0	Epoch: 0	Loss: 1.194976
Client Index = 0	Epoch: 1	Loss: 1.113056
Client Index = 0	Epoch: 2	Loss: 1.126916
Client Index = 0	Epoch: 3	Loss: 1.131000
Client Index = 0	Epoch: 4	Loss: 1.056354
test acc on this client after 280 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 1
local mask changes: 2897488.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3194864.0, 2897488.0, 3192588.0]
Doing local aggregation!
test acc on this client before 232 / 503 : 0.46
Client Index = 1	Epoch: 0	Loss: 0.969165
Client Index = 1	Epoch: 1	Loss: 0.794184
Client Index = 1	Epoch: 2	Loss: 0.781556
Client Index = 1	Epoch: 3	Loss: 0.937689
Client Index = 1	Epoch: 4	Loss: 0.747428
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 2
local mask changes: 2897468.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3193272.0, 2897468.0, 3198678.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.949570
Client Index = 2	Epoch: 1	Loss: 0.772179
Client Index = 2	Epoch: 2	Loss: 0.710822
Client Index = 2	Epoch: 3	Loss: 0.728459
Client Index = 2	Epoch: 4	Loss: 0.685613
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 3
local mask changes: 2899726.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3203994.0, 2899726.0, 3208536.0]
Doing local aggregation!
test acc on this client before 259 / 504 : 0.51
Client Index = 3	Epoch: 0	Loss: 1.064756
Client Index = 3	Epoch: 1	Loss: 1.104956
Client Index = 3	Epoch: 2	Loss: 1.045228
Client Index = 3	Epoch: 3	Loss: 1.073662
Client Index = 3	Epoch: 4	Loss: 0.968538
test acc on this client after 318 / 504 : 0.63
-----------------------------------
training flops per data 2653302016.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 4
local mask changes: 2897816.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3207364.0, 2897816.0, 3197020.0]
Doing local aggregation!
test acc on this client before 288 / 504 : 0.57
Client Index = 4	Epoch: 0	Loss: 1.331639
Client Index = 4	Epoch: 1	Loss: 1.309475
Client Index = 4	Epoch: 2	Loss: 1.312465
Client Index = 4	Epoch: 3	Loss: 1.229939
Client Index = 4	Epoch: 4	Loss: 1.287962
test acc on this client after 250 / 504 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 5
local mask changes: 2900298.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3193900.0, 2900298.0, 3197310.0]
Doing local aggregation!
test acc on this client before 171 / 503 : 0.34
Client Index = 5	Epoch: 0	Loss: 1.149607
Client Index = 5	Epoch: 1	Loss: 1.071352
Client Index = 5	Epoch: 2	Loss: 1.054481
Client Index = 5	Epoch: 3	Loss: 1.039022
Client Index = 5	Epoch: 4	Loss: 1.025308
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 6
local mask changes: 2897526.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3196420.0, 2897526.0, 3198978.0]
Doing local aggregation!
test acc on this client before 248 / 505 : 0.49
Client Index = 6	Epoch: 0	Loss: 1.339666
Client Index = 6	Epoch: 1	Loss: 1.337646
Client Index = 6	Epoch: 2	Loss: 1.342900
Client Index = 6	Epoch: 3	Loss: 1.258276
Client Index = 6	Epoch: 4	Loss: 1.267992
test acc on this client after 271 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 7
local mask changes: 2899354.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3196578.0, 2899354.0, 3197720.0]
Doing local aggregation!
test acc on this client before 194 / 504 : 0.38
Client Index = 7	Epoch: 0	Loss: 1.439339
Client Index = 7	Epoch: 1	Loss: 1.362432
Client Index = 7	Epoch: 2	Loss: 1.354750
Client Index = 7	Epoch: 3	Loss: 1.387614
Client Index = 7	Epoch: 4	Loss: 1.302655
test acc on this client after 229 / 504 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 8
local mask changes: 2896566.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3193062.0, 2896566.0, 3195420.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 8	Epoch: 0	Loss: 0.722362
Client Index = 8	Epoch: 1	Loss: 0.632164
Client Index = 8	Epoch: 2	Loss: 0.568367
Client Index = 8	Epoch: 3	Loss: 0.570407
Client Index = 8	Epoch: 4	Loss: 0.569556
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 9
local mask changes: 2898514.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3193172.0, 2898514.0, 3185750.0]
Doing local aggregation!
test acc on this client before 166 / 506 : 0.33
Client Index = 9	Epoch: 0	Loss: 1.210532
Client Index = 9	Epoch: 1	Loss: 1.176080
Client Index = 9	Epoch: 2	Loss: 1.115805
Client Index = 9	Epoch: 3	Loss: 1.129983
Client Index = 9	Epoch: 4	Loss: 1.110657
test acc on this client after 301 / 506 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 10
local mask changes: 2899064.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3188734.0, 2899064.0, 3194204.0]
Doing local aggregation!
test acc on this client before 242 / 503 : 0.48
Client Index = 10	Epoch: 0	Loss: 1.231168
Client Index = 10	Epoch: 1	Loss: 1.224192
Client Index = 10	Epoch: 2	Loss: 1.169597
Client Index = 10	Epoch: 3	Loss: 1.181826
Client Index = 10	Epoch: 4	Loss: 1.195318
test acc on this client after 268 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 11
local mask changes: 2897540.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3195200.0, 2897540.0, 3195798.0]
Doing local aggregation!
test acc on this client before 240 / 505 : 0.48
Client Index = 11	Epoch: 0	Loss: 0.970589
Client Index = 11	Epoch: 1	Loss: 0.937632
Client Index = 11	Epoch: 2	Loss: 0.808770
Client Index = 11	Epoch: 3	Loss: 0.920298
Client Index = 11	Epoch: 4	Loss: 0.905623
test acc on this client after 365 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 12
local mask changes: 2899672.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3197292.0, 2899672.0, 3190570.0]
Doing local aggregation!
test acc on this client before 250 / 504 : 0.50
Client Index = 12	Epoch: 0	Loss: 1.241169
Client Index = 12	Epoch: 1	Loss: 1.273282
Client Index = 12	Epoch: 2	Loss: 1.176566
Client Index = 12	Epoch: 3	Loss: 1.236363
Client Index = 12	Epoch: 4	Loss: 1.147749
test acc on this client after 297 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 13
local mask changes: 2899496.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3189006.0, 2899496.0, 3190372.0]
Doing local aggregation!
test acc on this client before 327 / 505 : 0.65
Client Index = 13	Epoch: 0	Loss: 1.203852
Client Index = 13	Epoch: 1	Loss: 1.156261
Client Index = 13	Epoch: 2	Loss: 1.108830
Client Index = 13	Epoch: 3	Loss: 1.076567
Client Index = 13	Epoch: 4	Loss: 1.082689
test acc on this client after 319 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 14
local mask changes: 2896864.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3192116.0, 2896864.0, 3191788.0]
Doing local aggregation!
test acc on this client before 230 / 503 : 0.46
Client Index = 14	Epoch: 0	Loss: 1.248491
Client Index = 14	Epoch: 1	Loss: 1.256758
Client Index = 14	Epoch: 2	Loss: 1.256455
Client Index = 14	Epoch: 3	Loss: 1.302353
Client Index = 14	Epoch: 4	Loss: 1.214314
test acc on this client after 258 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 15
local mask changes: 2897152.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3192258.0, 2897152.0, 3191550.0]
Doing local aggregation!
test acc on this client before 334 / 503 : 0.66
Client Index = 15	Epoch: 0	Loss: 0.980554
Client Index = 15	Epoch: 1	Loss: 0.936228
Client Index = 15	Epoch: 2	Loss: 0.959389
Client Index = 15	Epoch: 3	Loss: 0.895059
Client Index = 15	Epoch: 4	Loss: 0.947096
test acc on this client after 319 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 16
local mask changes: 2900354.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3191166.0, 2900354.0, 3191878.0]
Doing local aggregation!
test acc on this client before 264 / 504 : 0.52
Client Index = 16	Epoch: 0	Loss: 1.247864
Client Index = 16	Epoch: 1	Loss: 1.145001
Client Index = 16	Epoch: 2	Loss: 1.203864
Client Index = 16	Epoch: 3	Loss: 1.112656
Client Index = 16	Epoch: 4	Loss: 1.099177
test acc on this client after 243 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 17
local mask changes: 2898096.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3194830.0, 2898096.0, 3195306.0]
Doing local aggregation!
test acc on this client before 195 / 503 : 0.39
Client Index = 17	Epoch: 0	Loss: 1.490016
Client Index = 17	Epoch: 1	Loss: 1.463299
Client Index = 17	Epoch: 2	Loss: 1.377562
Client Index = 17	Epoch: 3	Loss: 1.400405
Client Index = 17	Epoch: 4	Loss: 1.373811
test acc on this client after 219 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 18
local mask changes: 2896972.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3196490.0, 2896972.0, 3195466.0]
Doing local aggregation!
test acc on this client before 259 / 503 : 0.51
Client Index = 18	Epoch: 0	Loss: 1.160550
Client Index = 18	Epoch: 1	Loss: 1.052800
Client Index = 18	Epoch: 2	Loss: 1.068348
Client Index = 18	Epoch: 3	Loss: 1.032931
Client Index = 18	Epoch: 4	Loss: 1.032929
test acc on this client after 271 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 19
local mask changes: 2897790.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3196390.0, 3195902.0, 2897790.0]
Doing local aggregation!
test acc on this client before 194 / 503 : 0.39
Client Index = 19	Epoch: 0	Loss: 1.223209
Client Index = 19	Epoch: 1	Loss: 1.196167
Client Index = 19	Epoch: 2	Loss: 1.229008
Client Index = 19	Epoch: 3	Loss: 1.110040
Client Index = 19	Epoch: 4	Loss: 1.094033
test acc on this client after 282 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.1032524891346696}
################local_test_on_all_clients after local training in communication round: 10
{'test_acc_after': 0.5933621192188492, 'test_loss_after': 1.2012596112894283}
################local_test_on_all_clients before local training in communication round: 10
{'test_acc_before': 0.5157772010993994, 'test_loss_before': 1.356909968417853}
################Communication round : 11
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 0
local mask changes: 2888810.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2888810.0, 3162124.0, 3164228.0]
Doing local aggregation!
test acc on this client before 305 / 503 : 0.61
Client Index = 0	Epoch: 0	Loss: 1.205324
Client Index = 0	Epoch: 1	Loss: 1.089434
Client Index = 0	Epoch: 2	Loss: 1.098544
Client Index = 0	Epoch: 3	Loss: 1.086919
Client Index = 0	Epoch: 4	Loss: 1.077626
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 1
local mask changes: 2887200.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3162600.0, 2887200.0, 3163986.0]
Doing local aggregation!
test acc on this client before 202 / 503 : 0.40
Client Index = 1	Epoch: 0	Loss: 0.914659
Client Index = 1	Epoch: 1	Loss: 0.824091
Client Index = 1	Epoch: 2	Loss: 0.783081
Client Index = 1	Epoch: 3	Loss: 0.768673
Client Index = 1	Epoch: 4	Loss: 0.881028
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 2
local mask changes: 2889290.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3162740.0, 2889290.0, 3168718.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.733340
Client Index = 2	Epoch: 1	Loss: 0.824677
Client Index = 2	Epoch: 2	Loss: 0.686214
Client Index = 2	Epoch: 3	Loss: 0.649929
Client Index = 2	Epoch: 4	Loss: 0.630058
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 3
local mask changes: 2891586.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3172890.0, 2891586.0, 3177284.0]
Doing local aggregation!
test acc on this client before 264 / 504 : 0.52
Client Index = 3	Epoch: 0	Loss: 1.134423
Client Index = 3	Epoch: 1	Loss: 0.967207
Client Index = 3	Epoch: 2	Loss: 1.055275
Client Index = 3	Epoch: 3	Loss: 0.995382
Client Index = 3	Epoch: 4	Loss: 0.954765
test acc on this client after 344 / 504 : 0.68
-----------------------------------
training flops per data 2653299456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 4
local mask changes: 2889362.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3175700.0, 2889362.0, 3166938.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 4	Epoch: 0	Loss: 1.343643
Client Index = 4	Epoch: 1	Loss: 1.287090
Client Index = 4	Epoch: 2	Loss: 1.230677
Client Index = 4	Epoch: 3	Loss: 1.220867
Client Index = 4	Epoch: 4	Loss: 1.223819
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 5
local mask changes: 2889740.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3165894.0, 2889740.0, 3165148.0]
Doing local aggregation!
test acc on this client before 245 / 503 : 0.49
Client Index = 5	Epoch: 0	Loss: 1.141266
Client Index = 5	Epoch: 1	Loss: 1.099714
Client Index = 5	Epoch: 2	Loss: 1.032722
Client Index = 5	Epoch: 3	Loss: 0.987148
Client Index = 5	Epoch: 4	Loss: 1.021940
test acc on this client after 302 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 6
local mask changes: 2889048.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3166806.0, 2889048.0, 3166830.0]
Doing local aggregation!
test acc on this client before 238 / 505 : 0.47
Client Index = 6	Epoch: 0	Loss: 1.353912
Client Index = 6	Epoch: 1	Loss: 1.286339
Client Index = 6	Epoch: 2	Loss: 1.276707
Client Index = 6	Epoch: 3	Loss: 1.235830
Client Index = 6	Epoch: 4	Loss: 1.268407
test acc on this client after 280 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 7
local mask changes: 2888034.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3165810.0, 2888034.0, 3166372.0]
Doing local aggregation!
test acc on this client before 200 / 504 : 0.40
Client Index = 7	Epoch: 0	Loss: 1.377826
Client Index = 7	Epoch: 1	Loss: 1.346787
Client Index = 7	Epoch: 2	Loss: 1.294326
Client Index = 7	Epoch: 3	Loss: 1.317586
Client Index = 7	Epoch: 4	Loss: 1.311122
test acc on this client after 242 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 8
local mask changes: 2886376.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3163506.0, 2886376.0, 3166776.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.651819
Client Index = 8	Epoch: 1	Loss: 0.591559
Client Index = 8	Epoch: 2	Loss: 0.517743
Client Index = 8	Epoch: 3	Loss: 0.553420
Client Index = 8	Epoch: 4	Loss: 0.490706
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 9
local mask changes: 2888744.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3162194.0, 2888744.0, 3156492.0]
Doing local aggregation!
test acc on this client before 264 / 506 : 0.52
Client Index = 9	Epoch: 0	Loss: 1.151810
Client Index = 9	Epoch: 1	Loss: 1.165829
Client Index = 9	Epoch: 2	Loss: 1.130259
Client Index = 9	Epoch: 3	Loss: 1.098645
Client Index = 9	Epoch: 4	Loss: 1.106791
test acc on this client after 299 / 506 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 10
local mask changes: 2887722.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3155598.0, 2887722.0, 3162712.0]
Doing local aggregation!
test acc on this client before 248 / 503 : 0.49
Client Index = 10	Epoch: 0	Loss: 1.194432
Client Index = 10	Epoch: 1	Loss: 1.244598
Client Index = 10	Epoch: 2	Loss: 1.136591
Client Index = 10	Epoch: 3	Loss: 1.135867
Client Index = 10	Epoch: 4	Loss: 1.121739
test acc on this client after 225 / 503 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 11
local mask changes: 2888572.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3164144.0, 2888572.0, 3166808.0]
Doing local aggregation!
test acc on this client before 277 / 505 : 0.55
Client Index = 11	Epoch: 0	Loss: 0.920823
Client Index = 11	Epoch: 1	Loss: 0.873621
Client Index = 11	Epoch: 2	Loss: 0.890188
Client Index = 11	Epoch: 3	Loss: 0.786570
Client Index = 11	Epoch: 4	Loss: 0.806791
test acc on this client after 376 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 12
local mask changes: 2888508.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3165354.0, 2888508.0, 3159164.0]
Doing local aggregation!
test acc on this client before 224 / 504 : 0.44
Client Index = 12	Epoch: 0	Loss: 1.237037
Client Index = 12	Epoch: 1	Loss: 1.194556
Client Index = 12	Epoch: 2	Loss: 1.206329
Client Index = 12	Epoch: 3	Loss: 1.130175
Client Index = 12	Epoch: 4	Loss: 1.140963
test acc on this client after 257 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 13
local mask changes: 2887158.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3157632.0, 2887158.0, 3161060.0]
Doing local aggregation!
test acc on this client before 323 / 505 : 0.64
Client Index = 13	Epoch: 0	Loss: 1.121671
Client Index = 13	Epoch: 1	Loss: 1.157067
Client Index = 13	Epoch: 2	Loss: 1.066792
Client Index = 13	Epoch: 3	Loss: 1.023191
Client Index = 13	Epoch: 4	Loss: 1.085423
test acc on this client after 303 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 14
local mask changes: 2889044.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3160892.0, 2889044.0, 3162292.0]
Doing local aggregation!
test acc on this client before 251 / 503 : 0.50
Client Index = 14	Epoch: 0	Loss: 1.307889
Client Index = 14	Epoch: 1	Loss: 1.205004
Client Index = 14	Epoch: 2	Loss: 1.242321
Client Index = 14	Epoch: 3	Loss: 1.231446
Client Index = 14	Epoch: 4	Loss: 1.192450
test acc on this client after 278 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 15
local mask changes: 2888890.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3158970.0, 2888890.0, 3159722.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 15	Epoch: 0	Loss: 0.984056
Client Index = 15	Epoch: 1	Loss: 0.927711
Client Index = 15	Epoch: 2	Loss: 0.919076
Client Index = 15	Epoch: 3	Loss: 0.954533
Client Index = 15	Epoch: 4	Loss: 0.880759
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 16
local mask changes: 2887924.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3161584.0, 2887924.0, 3161368.0]
Doing local aggregation!
test acc on this client before 243 / 504 : 0.48
Client Index = 16	Epoch: 0	Loss: 1.219776
Client Index = 16	Epoch: 1	Loss: 1.125154
Client Index = 16	Epoch: 2	Loss: 1.083949
Client Index = 16	Epoch: 3	Loss: 1.082007
Client Index = 16	Epoch: 4	Loss: 1.122851
test acc on this client after 265 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 17
local mask changes: 2890882.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3164248.0, 2890882.0, 3166490.0]
Doing local aggregation!
test acc on this client before 208 / 503 : 0.41
Client Index = 17	Epoch: 0	Loss: 1.397553
Client Index = 17	Epoch: 1	Loss: 1.390821
Client Index = 17	Epoch: 2	Loss: 1.425599
Client Index = 17	Epoch: 3	Loss: 1.345012
Client Index = 17	Epoch: 4	Loss: 1.291475
test acc on this client after 241 / 503 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 18
local mask changes: 2889414.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3167418.0, 2889414.0, 3164528.0]
Doing local aggregation!
test acc on this client before 236 / 503 : 0.47
Client Index = 18	Epoch: 0	Loss: 1.068188
Client Index = 18	Epoch: 1	Loss: 1.017080
Client Index = 18	Epoch: 2	Loss: 1.066131
Client Index = 18	Epoch: 3	Loss: 1.068099
Client Index = 18	Epoch: 4	Loss: 1.007700
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 19
local mask changes: 2890350.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3165360.0, 3164812.0, 2890350.0]
Doing local aggregation!
test acc on this client before 210 / 503 : 0.42
Client Index = 19	Epoch: 0	Loss: 1.209465
Client Index = 19	Epoch: 1	Loss: 1.105449
Client Index = 19	Epoch: 2	Loss: 1.122246
Client Index = 19	Epoch: 3	Loss: 1.066263
Client Index = 19	Epoch: 4	Loss: 1.109694
test acc on this client after 278 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.0712113550454379}
################local_test_on_all_clients after local training in communication round: 11
{'test_acc_after': 0.6060723641236602, 'test_loss_after': 1.1408745267599552}
################local_test_on_all_clients before local training in communication round: 11
{'test_acc_before': 0.529641880709131, 'test_loss_before': 1.3440868778232862}
################Communication round : 12
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 0
local mask changes: 2877120.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2877120.0, 3137174.0, 3136634.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 0	Epoch: 0	Loss: 1.114473
Client Index = 0	Epoch: 1	Loss: 1.087710
Client Index = 0	Epoch: 2	Loss: 1.018022
Client Index = 0	Epoch: 3	Loss: 1.062505
Client Index = 0	Epoch: 4	Loss: 0.991082
test acc on this client after 285 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 1
local mask changes: 2877594.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3135138.0, 2877594.0, 3135084.0]
Doing local aggregation!
test acc on this client before 283 / 503 : 0.56
Client Index = 1	Epoch: 0	Loss: 0.887848
Client Index = 1	Epoch: 1	Loss: 0.773658
Client Index = 1	Epoch: 2	Loss: 0.808532
Client Index = 1	Epoch: 3	Loss: 0.790291
Client Index = 1	Epoch: 4	Loss: 0.717179
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 2
local mask changes: 2878122.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3137830.0, 2878122.0, 3142988.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.699238
Client Index = 2	Epoch: 1	Loss: 0.758128
Client Index = 2	Epoch: 2	Loss: 0.661724
Client Index = 2	Epoch: 3	Loss: 0.659053
Client Index = 2	Epoch: 4	Loss: 0.749908
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 3
local mask changes: 2879532.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3144334.0, 2879532.0, 3148106.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 3	Epoch: 0	Loss: 1.111680
Client Index = 3	Epoch: 1	Loss: 1.024049
Client Index = 3	Epoch: 2	Loss: 0.870096
Client Index = 3	Epoch: 3	Loss: 1.015451
Client Index = 3	Epoch: 4	Loss: 0.873242
test acc on this client after 340 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 4
local mask changes: 2879248.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3150178.0, 2879248.0, 3137842.0]
Doing local aggregation!
test acc on this client before 288 / 504 : 0.57
Client Index = 4	Epoch: 0	Loss: 1.296176
Client Index = 4	Epoch: 1	Loss: 1.221213
Client Index = 4	Epoch: 2	Loss: 1.174448
Client Index = 4	Epoch: 3	Loss: 1.137205
Client Index = 4	Epoch: 4	Loss: 1.125210
test acc on this client after 283 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 5
local mask changes: 2879360.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3140320.0, 2879360.0, 3137474.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 5	Epoch: 0	Loss: 1.077998
Client Index = 5	Epoch: 1	Loss: 1.011981
Client Index = 5	Epoch: 2	Loss: 1.050979
Client Index = 5	Epoch: 3	Loss: 0.994871
Client Index = 5	Epoch: 4	Loss: 0.961455
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 6
local mask changes: 2878294.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3139680.0, 2878294.0, 3138234.0]
Doing local aggregation!
test acc on this client before 256 / 505 : 0.51
Client Index = 6	Epoch: 0	Loss: 1.314551
Client Index = 6	Epoch: 1	Loss: 1.261821
Client Index = 6	Epoch: 2	Loss: 1.197538
Client Index = 6	Epoch: 3	Loss: 1.138209
Client Index = 6	Epoch: 4	Loss: 1.221581
test acc on this client after 302 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 7
local mask changes: 2878638.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3137360.0, 2878638.0, 3138804.0]
Doing local aggregation!
test acc on this client before 221 / 504 : 0.44
Client Index = 7	Epoch: 0	Loss: 1.307759
Client Index = 7	Epoch: 1	Loss: 1.408396
Client Index = 7	Epoch: 2	Loss: 1.300906
Client Index = 7	Epoch: 3	Loss: 1.260623
Client Index = 7	Epoch: 4	Loss: 1.251473
test acc on this client after 241 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 8
local mask changes: 2876836.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3135278.0, 2876836.0, 3137788.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 8	Epoch: 0	Loss: 0.631321
Client Index = 8	Epoch: 1	Loss: 0.612631
Client Index = 8	Epoch: 2	Loss: 0.481674
Client Index = 8	Epoch: 3	Loss: 0.481240
Client Index = 8	Epoch: 4	Loss: 0.500761
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 9
local mask changes: 2878126.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3136000.0, 2878126.0, 3127970.0]
Doing local aggregation!
test acc on this client before 214 / 506 : 0.42
Client Index = 9	Epoch: 0	Loss: 1.176586
Client Index = 9	Epoch: 1	Loss: 1.122359
Client Index = 9	Epoch: 2	Loss: 1.040292
Client Index = 9	Epoch: 3	Loss: 1.158512
Client Index = 9	Epoch: 4	Loss: 1.081940
test acc on this client after 274 / 506 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 10
local mask changes: 2880128.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3128932.0, 2880128.0, 3134632.0]
Doing local aggregation!
test acc on this client before 240 / 503 : 0.48
Client Index = 10	Epoch: 0	Loss: 1.229473
Client Index = 10	Epoch: 1	Loss: 1.140930
Client Index = 10	Epoch: 2	Loss: 1.174003
Client Index = 10	Epoch: 3	Loss: 1.164063
Client Index = 10	Epoch: 4	Loss: 1.088815
test acc on this client after 253 / 503 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 11
local mask changes: 2877152.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3135626.0, 2877152.0, 3138822.0]
Doing local aggregation!
test acc on this client before 260 / 505 : 0.51
Client Index = 11	Epoch: 0	Loss: 0.913916
Client Index = 11	Epoch: 1	Loss: 0.840825
Client Index = 11	Epoch: 2	Loss: 0.835647
Client Index = 11	Epoch: 3	Loss: 0.820862
Client Index = 11	Epoch: 4	Loss: 0.725415
test acc on this client after 372 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 12
local mask changes: 2877228.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3138428.0, 2877228.0, 3131476.0]
Doing local aggregation!
test acc on this client before 200 / 504 : 0.40
Client Index = 12	Epoch: 0	Loss: 1.229537
Client Index = 12	Epoch: 1	Loss: 1.161462
Client Index = 12	Epoch: 2	Loss: 1.178602
Client Index = 12	Epoch: 3	Loss: 1.181485
Client Index = 12	Epoch: 4	Loss: 1.137265
test acc on this client after 207 / 504 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 13
local mask changes: 2877926.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3130506.0, 2877926.0, 3132892.0]
Doing local aggregation!
test acc on this client before 320 / 505 : 0.63
Client Index = 13	Epoch: 0	Loss: 1.091194
Client Index = 13	Epoch: 1	Loss: 1.076505
Client Index = 13	Epoch: 2	Loss: 1.067115
Client Index = 13	Epoch: 3	Loss: 1.053764
Client Index = 13	Epoch: 4	Loss: 0.996543
test acc on this client after 302 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 14
local mask changes: 2877850.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3130906.0, 2877850.0, 3133278.0]
Doing local aggregation!
test acc on this client before 262 / 503 : 0.52
Client Index = 14	Epoch: 0	Loss: 1.216960
Client Index = 14	Epoch: 1	Loss: 1.232964
Client Index = 14	Epoch: 2	Loss: 1.147468
Client Index = 14	Epoch: 3	Loss: 1.183575
Client Index = 14	Epoch: 4	Loss: 1.164234
test acc on this client after 243 / 503 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 15
local mask changes: 2879342.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3131834.0, 2879342.0, 3131484.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 15	Epoch: 0	Loss: 0.960773
Client Index = 15	Epoch: 1	Loss: 0.916235
Client Index = 15	Epoch: 2	Loss: 0.876690
Client Index = 15	Epoch: 3	Loss: 0.854601
Client Index = 15	Epoch: 4	Loss: 0.865861
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 16
local mask changes: 2879762.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3134148.0, 2879762.0, 3136860.0]
Doing local aggregation!
test acc on this client before 286 / 504 : 0.57
Client Index = 16	Epoch: 0	Loss: 1.165432
Client Index = 16	Epoch: 1	Loss: 1.105913
Client Index = 16	Epoch: 2	Loss: 1.076638
Client Index = 16	Epoch: 3	Loss: 1.093510
Client Index = 16	Epoch: 4	Loss: 0.997358
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 17
local mask changes: 2877040.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3135562.0, 2877040.0, 3141532.0]
Doing local aggregation!
test acc on this client before 200 / 503 : 0.40
Client Index = 17	Epoch: 0	Loss: 1.404866
Client Index = 17	Epoch: 1	Loss: 1.416399
Client Index = 17	Epoch: 2	Loss: 1.296121
Client Index = 17	Epoch: 3	Loss: 1.302177
Client Index = 17	Epoch: 4	Loss: 1.335624
test acc on this client after 231 / 503 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 18
local mask changes: 2876942.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3140218.0, 2876942.0, 3136432.0]
Doing local aggregation!
test acc on this client before 252 / 503 : 0.50
Client Index = 18	Epoch: 0	Loss: 1.085701
Client Index = 18	Epoch: 1	Loss: 1.001474
Client Index = 18	Epoch: 2	Loss: 1.091269
Client Index = 18	Epoch: 3	Loss: 0.985374
Client Index = 18	Epoch: 4	Loss: 0.978951
test acc on this client after 322 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 19
local mask changes: 2879352.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3138656.0, 3137584.0, 2879352.0]
Doing local aggregation!
test acc on this client before 311 / 503 : 0.62
Client Index = 19	Epoch: 0	Loss: 1.178859
Client Index = 19	Epoch: 1	Loss: 1.087168
Client Index = 19	Epoch: 2	Loss: 1.089720
Client Index = 19	Epoch: 3	Loss: 1.035942
Client Index = 19	Epoch: 4	Loss: 1.020417
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.0395127992480995}
################local_test_on_all_clients after local training in communication round: 12
{'test_acc_after': 0.6054851672422592, 'test_loss_after': 1.1660878313783694}
################local_test_on_all_clients before local training in communication round: 12
{'test_acc_before': 0.5491390641154061, 'test_loss_before': 1.290782894821816}
################Communication round : 13
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 0
local mask changes: 2866448.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2866448.0, 3112388.0, 3111854.0]
Doing local aggregation!
test acc on this client before 274 / 503 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.091144
Client Index = 0	Epoch: 1	Loss: 1.018653
Client Index = 0	Epoch: 2	Loss: 0.976977
Client Index = 0	Epoch: 3	Loss: 1.054431
Client Index = 0	Epoch: 4	Loss: 1.007250
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 1
local mask changes: 2866856.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3108494.0, 2866856.0, 3109576.0]
Doing local aggregation!
test acc on this client before 315 / 503 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.791782
Client Index = 1	Epoch: 1	Loss: 0.780362
Client Index = 1	Epoch: 2	Loss: 0.810376
Client Index = 1	Epoch: 3	Loss: 0.708751
Client Index = 1	Epoch: 4	Loss: 0.795060
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 2
local mask changes: 2866834.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3110986.0, 2866834.0, 3114724.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.654013
Client Index = 2	Epoch: 1	Loss: 0.626303
Client Index = 2	Epoch: 2	Loss: 0.683011
Client Index = 2	Epoch: 3	Loss: 0.592892
Client Index = 2	Epoch: 4	Loss: 0.706957
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 3
local mask changes: 2865820.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3118526.0, 2865820.0, 3121578.0]
Doing local aggregation!
test acc on this client before 274 / 504 : 0.54
Client Index = 3	Epoch: 0	Loss: 1.155411
Client Index = 3	Epoch: 1	Loss: 0.960751
Client Index = 3	Epoch: 2	Loss: 0.984343
Client Index = 3	Epoch: 3	Loss: 0.832579
Client Index = 3	Epoch: 4	Loss: 0.882912
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 4
local mask changes: 2867154.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3125264.0, 2867154.0, 3118046.0]
Doing local aggregation!
test acc on this client before 293 / 504 : 0.58
Client Index = 4	Epoch: 0	Loss: 1.262544
Client Index = 4	Epoch: 1	Loss: 1.199557
Client Index = 4	Epoch: 2	Loss: 1.178175
Client Index = 4	Epoch: 3	Loss: 1.124191
Client Index = 4	Epoch: 4	Loss: 1.112855
test acc on this client after 275 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 5
local mask changes: 2866416.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3113276.0, 2866416.0, 3109714.0]
Doing local aggregation!
test acc on this client before 276 / 503 : 0.55
Client Index = 5	Epoch: 0	Loss: 1.045965
Client Index = 5	Epoch: 1	Loss: 1.047741
Client Index = 5	Epoch: 2	Loss: 1.033540
Client Index = 5	Epoch: 3	Loss: 0.976057
Client Index = 5	Epoch: 4	Loss: 0.919836
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 6
local mask changes: 2864922.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3113488.0, 2864922.0, 3112622.0]
Doing local aggregation!
test acc on this client before 238 / 505 : 0.47
Client Index = 6	Epoch: 0	Loss: 1.301032
Client Index = 6	Epoch: 1	Loss: 1.179500
Client Index = 6	Epoch: 2	Loss: 1.226863
Client Index = 6	Epoch: 3	Loss: 1.184141
Client Index = 6	Epoch: 4	Loss: 1.143667
test acc on this client after 203 / 505 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 7
local mask changes: 2865638.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3110120.0, 2865638.0, 3113034.0]
Doing local aggregation!
test acc on this client before 247 / 504 : 0.49
Client Index = 7	Epoch: 0	Loss: 1.326688
Client Index = 7	Epoch: 1	Loss: 1.288100
Client Index = 7	Epoch: 2	Loss: 1.273110
Client Index = 7	Epoch: 3	Loss: 1.205414
Client Index = 7	Epoch: 4	Loss: 1.214873
test acc on this client after 249 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 8
local mask changes: 2867114.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3112098.0, 2867114.0, 3109938.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.667823
Client Index = 8	Epoch: 1	Loss: 0.485227
Client Index = 8	Epoch: 2	Loss: 0.521750
Client Index = 8	Epoch: 3	Loss: 0.491482
Client Index = 8	Epoch: 4	Loss: 0.477490
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 9
local mask changes: 2865166.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3111916.0, 2865166.0, 3103894.0]
Doing local aggregation!
test acc on this client before 161 / 506 : 0.32
Client Index = 9	Epoch: 0	Loss: 1.162901
Client Index = 9	Epoch: 1	Loss: 1.101881
Client Index = 9	Epoch: 2	Loss: 1.054983
Client Index = 9	Epoch: 3	Loss: 1.073405
Client Index = 9	Epoch: 4	Loss: 1.042139
test acc on this client after 297 / 506 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 10
local mask changes: 2867252.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3105182.0, 2867252.0, 3109926.0]
Doing local aggregation!
test acc on this client before 279 / 503 : 0.55
Client Index = 10	Epoch: 0	Loss: 1.182258
Client Index = 10	Epoch: 1	Loss: 1.157902
Client Index = 10	Epoch: 2	Loss: 1.086592
Client Index = 10	Epoch: 3	Loss: 1.145209
Client Index = 10	Epoch: 4	Loss: 1.130356
test acc on this client after 269 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 11
local mask changes: 2866690.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3110062.0, 2866690.0, 3115484.0]
Doing local aggregation!
test acc on this client before 248 / 505 : 0.49
Client Index = 11	Epoch: 0	Loss: 0.943151
Client Index = 11	Epoch: 1	Loss: 0.851278
Client Index = 11	Epoch: 2	Loss: 0.832651
Client Index = 11	Epoch: 3	Loss: 0.741004
Client Index = 11	Epoch: 4	Loss: 0.740066
test acc on this client after 369 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 12
local mask changes: 2865342.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3114616.0, 2865342.0, 3105186.0]
Doing local aggregation!
test acc on this client before 176 / 504 : 0.35
Client Index = 12	Epoch: 0	Loss: 1.197021
Client Index = 12	Epoch: 1	Loss: 1.135758
Client Index = 12	Epoch: 2	Loss: 1.173142
Client Index = 12	Epoch: 3	Loss: 1.105519
Client Index = 12	Epoch: 4	Loss: 1.095521
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 13
local mask changes: 2866226.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3104748.0, 2866226.0, 3106798.0]
Doing local aggregation!
test acc on this client before 328 / 505 : 0.65
Client Index = 13	Epoch: 0	Loss: 1.061731
Client Index = 13	Epoch: 1	Loss: 1.086937
Client Index = 13	Epoch: 2	Loss: 0.978335
Client Index = 13	Epoch: 3	Loss: 1.017571
Client Index = 13	Epoch: 4	Loss: 0.967661
test acc on this client after 329 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 14
local mask changes: 2864472.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3106900.0, 2864472.0, 3107422.0]
Doing local aggregation!
test acc on this client before 258 / 503 : 0.51
Client Index = 14	Epoch: 0	Loss: 1.207690
Client Index = 14	Epoch: 1	Loss: 1.202643
Client Index = 14	Epoch: 2	Loss: 1.148573
Client Index = 14	Epoch: 3	Loss: 1.086108
Client Index = 14	Epoch: 4	Loss: 1.143240
test acc on this client after 282 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 15
local mask changes: 2868598.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3103400.0, 2868598.0, 3105538.0]
Doing local aggregation!
test acc on this client before 312 / 503 : 0.62
Client Index = 15	Epoch: 0	Loss: 0.915932
Client Index = 15	Epoch: 1	Loss: 0.886417
Client Index = 15	Epoch: 2	Loss: 0.907323
Client Index = 15	Epoch: 3	Loss: 0.832645
Client Index = 15	Epoch: 4	Loss: 0.856182
test acc on this client after 314 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 16
local mask changes: 2865884.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3108976.0, 2865884.0, 3109510.0]
Doing local aggregation!
test acc on this client before 295 / 504 : 0.59
Client Index = 16	Epoch: 0	Loss: 1.154118
Client Index = 16	Epoch: 1	Loss: 1.097548
Client Index = 16	Epoch: 2	Loss: 1.068695
Client Index = 16	Epoch: 3	Loss: 1.095353
Client Index = 16	Epoch: 4	Loss: 1.026805
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 17
local mask changes: 2867700.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3111696.0, 2867700.0, 3113238.0]
Doing local aggregation!
test acc on this client before 202 / 503 : 0.40
Client Index = 17	Epoch: 0	Loss: 1.343210
Client Index = 17	Epoch: 1	Loss: 1.273739
Client Index = 17	Epoch: 2	Loss: 1.339474
Client Index = 17	Epoch: 3	Loss: 1.240953
Client Index = 17	Epoch: 4	Loss: 1.267563
test acc on this client after 270 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 18
local mask changes: 2867016.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3113988.0, 2867016.0, 3110570.0]
Doing local aggregation!
test acc on this client before 289 / 503 : 0.57
Client Index = 18	Epoch: 0	Loss: 1.076891
Client Index = 18	Epoch: 1	Loss: 1.006002
Client Index = 18	Epoch: 2	Loss: 1.006470
Client Index = 18	Epoch: 3	Loss: 0.986367
Client Index = 18	Epoch: 4	Loss: 0.944877
test acc on this client after 323 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 19
local mask changes: 2866020.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3111938.0, 3112322.0, 2866020.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 19	Epoch: 0	Loss: 1.139447
Client Index = 19	Epoch: 1	Loss: 1.009185
Client Index = 19	Epoch: 2	Loss: 1.117672
Client Index = 19	Epoch: 3	Loss: 0.989059
Client Index = 19	Epoch: 4	Loss: 0.969753
test acc on this client after 313 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.0140648630410432}
################local_test_on_all_clients after local training in communication round: 13
{'test_acc_after': 0.6246655168307538, 'test_loss_after': 1.1336468753867186}
################local_test_on_all_clients before local training in communication round: 13
{'test_acc_before': 0.5450020379416527, 'test_loss_before': 1.3081055090143714}
################Communication round : 14
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 0
local mask changes: 2852176.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2852176.0, 3088432.0, 3087108.0]
Doing local aggregation!
test acc on this client before 309 / 503 : 0.61
Client Index = 0	Epoch: 0	Loss: 1.122888
Client Index = 0	Epoch: 1	Loss: 1.005456
Client Index = 0	Epoch: 2	Loss: 1.031258
Client Index = 0	Epoch: 3	Loss: 0.999737
Client Index = 0	Epoch: 4	Loss: 0.983861
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 1
local mask changes: 2854558.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3087700.0, 2854558.0, 3087928.0]
Doing local aggregation!
test acc on this client before 325 / 503 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.759652
Client Index = 1	Epoch: 1	Loss: 0.748555
Client Index = 1	Epoch: 2	Loss: 0.714076
Client Index = 1	Epoch: 3	Loss: 0.706772
Client Index = 1	Epoch: 4	Loss: 0.780018
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 2
local mask changes: 2854764.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3087944.0, 2854764.0, 3094018.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.684692
Client Index = 2	Epoch: 1	Loss: 0.627963
Client Index = 2	Epoch: 2	Loss: 0.587331
Client Index = 2	Epoch: 3	Loss: 0.614238
Client Index = 2	Epoch: 4	Loss: 0.567695
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 3
local mask changes: 2852666.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3096576.0, 2852666.0, 3098432.0]
Doing local aggregation!
test acc on this client before 333 / 504 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.952348
Client Index = 3	Epoch: 1	Loss: 0.974404
Client Index = 3	Epoch: 2	Loss: 0.963235
Client Index = 3	Epoch: 3	Loss: 0.894231
Client Index = 3	Epoch: 4	Loss: 0.770646
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 4
local mask changes: 2855394.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3099422.0, 2855394.0, 3093148.0]
Doing local aggregation!
test acc on this client before 288 / 504 : 0.57
Client Index = 4	Epoch: 0	Loss: 1.179240
Client Index = 4	Epoch: 1	Loss: 1.160161
Client Index = 4	Epoch: 2	Loss: 1.115519
Client Index = 4	Epoch: 3	Loss: 1.170806
Client Index = 4	Epoch: 4	Loss: 1.097300
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 5
local mask changes: 2852818.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3091128.0, 2852818.0, 3087376.0]
Doing local aggregation!
test acc on this client before 245 / 503 : 0.49
Client Index = 5	Epoch: 0	Loss: 1.088495
Client Index = 5	Epoch: 1	Loss: 1.010481
Client Index = 5	Epoch: 2	Loss: 0.929229
Client Index = 5	Epoch: 3	Loss: 0.984987
Client Index = 5	Epoch: 4	Loss: 0.956306
test acc on this client after 337 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 6
local mask changes: 2856216.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3091446.0, 2856216.0, 3087728.0]
Doing local aggregation!
test acc on this client before 284 / 505 : 0.56
Client Index = 6	Epoch: 0	Loss: 1.204559
Client Index = 6	Epoch: 1	Loss: 1.216329
Client Index = 6	Epoch: 2	Loss: 1.134318
Client Index = 6	Epoch: 3	Loss: 1.131515
Client Index = 6	Epoch: 4	Loss: 1.111527
test acc on this client after 303 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 7
local mask changes: 2854822.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3086170.0, 2854822.0, 3089408.0]
Doing local aggregation!
test acc on this client before 257 / 504 : 0.51
Client Index = 7	Epoch: 0	Loss: 1.325560
Client Index = 7	Epoch: 1	Loss: 1.271178
Client Index = 7	Epoch: 2	Loss: 1.239646
Client Index = 7	Epoch: 3	Loss: 1.197427
Client Index = 7	Epoch: 4	Loss: 1.224964
test acc on this client after 263 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 8
local mask changes: 2854640.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3087602.0, 2854640.0, 3088752.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.706401
Client Index = 8	Epoch: 1	Loss: 0.464117
Client Index = 8	Epoch: 2	Loss: 0.452178
Client Index = 8	Epoch: 3	Loss: 0.437645
Client Index = 8	Epoch: 4	Loss: 0.426832
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 9
local mask changes: 2853736.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3088836.0, 2853736.0, 3079810.0]
Doing local aggregation!
test acc on this client before 210 / 506 : 0.42
Client Index = 9	Epoch: 0	Loss: 1.153308
Client Index = 9	Epoch: 1	Loss: 1.082432
Client Index = 9	Epoch: 2	Loss: 1.052042
Client Index = 9	Epoch: 3	Loss: 1.085210
Client Index = 9	Epoch: 4	Loss: 1.042860
test acc on this client after 325 / 506 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 10
local mask changes: 2854598.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3079822.0, 2854598.0, 3086110.0]
Doing local aggregation!
test acc on this client before 255 / 503 : 0.51
Client Index = 10	Epoch: 0	Loss: 1.173621
Client Index = 10	Epoch: 1	Loss: 1.126672
Client Index = 10	Epoch: 2	Loss: 1.100727
Client Index = 10	Epoch: 3	Loss: 1.055137
Client Index = 10	Epoch: 4	Loss: 1.079887
test acc on this client after 277 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 11
local mask changes: 2855348.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3087122.0, 2855348.0, 3090396.0]
Doing local aggregation!
test acc on this client before 274 / 505 : 0.54
Client Index = 11	Epoch: 0	Loss: 0.881325
Client Index = 11	Epoch: 1	Loss: 0.793111
Client Index = 11	Epoch: 2	Loss: 0.826678
Client Index = 11	Epoch: 3	Loss: 0.732535
Client Index = 11	Epoch: 4	Loss: 0.629680
test acc on this client after 315 / 505 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 12
local mask changes: 2854192.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3089188.0, 2854192.0, 3081506.0]
Doing local aggregation!
test acc on this client before 243 / 504 : 0.48
Client Index = 12	Epoch: 0	Loss: 1.170139
Client Index = 12	Epoch: 1	Loss: 1.116688
Client Index = 12	Epoch: 2	Loss: 1.169470
Client Index = 12	Epoch: 3	Loss: 1.064015
Client Index = 12	Epoch: 4	Loss: 1.135837
test acc on this client after 276 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 13
local mask changes: 2853296.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3081236.0, 2853296.0, 3081142.0]
Doing local aggregation!
test acc on this client before 334 / 505 : 0.66
Client Index = 13	Epoch: 0	Loss: 1.082394
Client Index = 13	Epoch: 1	Loss: 1.015263
Client Index = 13	Epoch: 2	Loss: 0.989304
Client Index = 13	Epoch: 3	Loss: 0.965504
Client Index = 13	Epoch: 4	Loss: 0.996443
test acc on this client after 327 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 14
local mask changes: 2855102.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3086596.0, 2855102.0, 3085696.0]
Doing local aggregation!
test acc on this client before 259 / 503 : 0.51
Client Index = 14	Epoch: 0	Loss: 1.198677
Client Index = 14	Epoch: 1	Loss: 1.143941
Client Index = 14	Epoch: 2	Loss: 1.187579
Client Index = 14	Epoch: 3	Loss: 1.129774
Client Index = 14	Epoch: 4	Loss: 1.131204
test acc on this client after 258 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 15
local mask changes: 2852744.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3081350.0, 2852744.0, 3081436.0]
Doing local aggregation!
test acc on this client before 307 / 503 : 0.61
Client Index = 15	Epoch: 0	Loss: 0.897529
Client Index = 15	Epoch: 1	Loss: 0.837959
Client Index = 15	Epoch: 2	Loss: 0.857245
Client Index = 15	Epoch: 3	Loss: 0.823953
Client Index = 15	Epoch: 4	Loss: 0.774028
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 16
local mask changes: 2857058.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3083814.0, 2857058.0, 3085386.0]
Doing local aggregation!
test acc on this client before 298 / 504 : 0.59
Client Index = 16	Epoch: 0	Loss: 1.082386
Client Index = 16	Epoch: 1	Loss: 1.067977
Client Index = 16	Epoch: 2	Loss: 1.026846
Client Index = 16	Epoch: 3	Loss: 1.038308
Client Index = 16	Epoch: 4	Loss: 0.997121
test acc on this client after 226 / 504 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 17
local mask changes: 2854144.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3086060.0, 2854144.0, 3089864.0]
Doing local aggregation!
test acc on this client before 208 / 503 : 0.41
Client Index = 17	Epoch: 0	Loss: 1.367230
Client Index = 17	Epoch: 1	Loss: 1.267005
Client Index = 17	Epoch: 2	Loss: 1.286213
Client Index = 17	Epoch: 3	Loss: 1.285346
Client Index = 17	Epoch: 4	Loss: 1.204554
test acc on this client after 254 / 503 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 18
local mask changes: 2855176.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3090538.0, 2855176.0, 3087442.0]
Doing local aggregation!
test acc on this client before 275 / 503 : 0.55
Client Index = 18	Epoch: 0	Loss: 1.062384
Client Index = 18	Epoch: 1	Loss: 0.981799
Client Index = 18	Epoch: 2	Loss: 0.937155
Client Index = 18	Epoch: 3	Loss: 1.004703
Client Index = 18	Epoch: 4	Loss: 0.912623
test acc on this client after 313 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 19
local mask changes: 2853524.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3088076.0, 3084370.0, 2853524.0]
Doing local aggregation!
test acc on this client before 324 / 503 : 0.64
Client Index = 19	Epoch: 0	Loss: 1.075587
Client Index = 19	Epoch: 1	Loss: 1.114141
Client Index = 19	Epoch: 2	Loss: 0.985132
Client Index = 19	Epoch: 3	Loss: 0.970497
Client Index = 19	Epoch: 4	Loss: 1.006932
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.9890188252925874}
################local_test_on_all_clients after local training in communication round: 14
{'test_acc_after': 0.6247415499718352, 'test_loss_after': 1.127980825734073}
################local_test_on_all_clients before local training in communication round: 14
{'test_acc_before': 0.5768241784988175, 'test_loss_before': 1.2452608496517663}
################Communication round : 15
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 0
local mask changes: 2839758.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2839758.0, 3063684.0, 3063284.0]
Doing local aggregation!
test acc on this client before 316 / 503 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.971749
Client Index = 0	Epoch: 1	Loss: 1.031656
Client Index = 0	Epoch: 2	Loss: 0.968876
Client Index = 0	Epoch: 3	Loss: 0.929613
Client Index = 0	Epoch: 4	Loss: 0.940767
test acc on this client after 324 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 1
local mask changes: 2841028.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3065050.0, 2841028.0, 3065490.0]
Doing local aggregation!
test acc on this client before 266 / 503 : 0.53
Client Index = 1	Epoch: 0	Loss: 0.797417
Client Index = 1	Epoch: 1	Loss: 0.686461
Client Index = 1	Epoch: 2	Loss: 0.739172
Client Index = 1	Epoch: 3	Loss: 0.729079
Client Index = 1	Epoch: 4	Loss: 0.666320
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 2
local mask changes: 2840424.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3066982.0, 2840424.0, 3070086.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.581025
Client Index = 2	Epoch: 1	Loss: 0.756798
Client Index = 2	Epoch: 2	Loss: 0.556995
Client Index = 2	Epoch: 3	Loss: 0.526272
Client Index = 2	Epoch: 4	Loss: 0.544075
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 3
local mask changes: 2842156.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3073284.0, 2842156.0, 3073202.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 3	Epoch: 0	Loss: 1.141188
Client Index = 3	Epoch: 1	Loss: 0.840198
Client Index = 3	Epoch: 2	Loss: 0.914119
Client Index = 3	Epoch: 3	Loss: 0.816719
Client Index = 3	Epoch: 4	Loss: 0.799646
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 4
local mask changes: 2839886.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3075692.0, 2839886.0, 3069500.0]
Doing local aggregation!
test acc on this client before 298 / 504 : 0.59
Client Index = 4	Epoch: 0	Loss: 1.168878
Client Index = 4	Epoch: 1	Loss: 1.132407
Client Index = 4	Epoch: 2	Loss: 1.160995
Client Index = 4	Epoch: 3	Loss: 1.144886
Client Index = 4	Epoch: 4	Loss: 1.095506
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 5
local mask changes: 2838950.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3067960.0, 2838950.0, 3064904.0]
Doing local aggregation!
test acc on this client before 219 / 503 : 0.44
Client Index = 5	Epoch: 0	Loss: 1.031947
Client Index = 5	Epoch: 1	Loss: 0.986421
Client Index = 5	Epoch: 2	Loss: 0.962119
Client Index = 5	Epoch: 3	Loss: 0.909947
Client Index = 5	Epoch: 4	Loss: 0.951094
test acc on this client after 325 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 6
local mask changes: 2840790.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3066004.0, 2840790.0, 3064404.0]
Doing local aggregation!
test acc on this client before 307 / 505 : 0.61
Client Index = 6	Epoch: 0	Loss: 1.199550
Client Index = 6	Epoch: 1	Loss: 1.174549
Client Index = 6	Epoch: 2	Loss: 1.147113
Client Index = 6	Epoch: 3	Loss: 1.086573
Client Index = 6	Epoch: 4	Loss: 1.113991
test acc on this client after 286 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 7
local mask changes: 2838982.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3066248.0, 2838982.0, 3065110.0]
Doing local aggregation!
test acc on this client before 233 / 504 : 0.46
Client Index = 7	Epoch: 0	Loss: 1.270960
Client Index = 7	Epoch: 1	Loss: 1.203880
Client Index = 7	Epoch: 2	Loss: 1.282227
Client Index = 7	Epoch: 3	Loss: 1.195179
Client Index = 7	Epoch: 4	Loss: 1.176461
test acc on this client after 255 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 8
local mask changes: 2841582.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3063044.0, 2841582.0, 3065190.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.610436
Client Index = 8	Epoch: 1	Loss: 0.501023
Client Index = 8	Epoch: 2	Loss: 0.444125
Client Index = 8	Epoch: 3	Loss: 0.410788
Client Index = 8	Epoch: 4	Loss: 0.517412
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 9
local mask changes: 2839852.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3064944.0, 2839852.0, 3055244.0]
Doing local aggregation!
test acc on this client before 213 / 506 : 0.42
Client Index = 9	Epoch: 0	Loss: 1.154994
Client Index = 9	Epoch: 1	Loss: 1.041002
Client Index = 9	Epoch: 2	Loss: 1.087941
Client Index = 9	Epoch: 3	Loss: 1.035858
Client Index = 9	Epoch: 4	Loss: 1.014670
test acc on this client after 306 / 506 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 10
local mask changes: 2840756.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3057218.0, 2840756.0, 3061630.0]
Doing local aggregation!
test acc on this client before 276 / 503 : 0.55
Client Index = 10	Epoch: 0	Loss: 1.127187
Client Index = 10	Epoch: 1	Loss: 1.067007
Client Index = 10	Epoch: 2	Loss: 1.137824
Client Index = 10	Epoch: 3	Loss: 1.065547
Client Index = 10	Epoch: 4	Loss: 1.031086
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 11
local mask changes: 2841544.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3063086.0, 2841544.0, 3067204.0]
Doing local aggregation!
test acc on this client before 286 / 505 : 0.57
Client Index = 11	Epoch: 0	Loss: 0.899852
Client Index = 11	Epoch: 1	Loss: 0.715524
Client Index = 11	Epoch: 2	Loss: 0.697547
Client Index = 11	Epoch: 3	Loss: 0.762062
Client Index = 11	Epoch: 4	Loss: 0.680095
test acc on this client after 367 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 12
local mask changes: 2837332.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3067526.0, 2837332.0, 3058126.0]
Doing local aggregation!
test acc on this client before 235 / 504 : 0.47
Client Index = 12	Epoch: 0	Loss: 1.131861
Client Index = 12	Epoch: 1	Loss: 1.122542
Client Index = 12	Epoch: 2	Loss: 1.128598
Client Index = 12	Epoch: 3	Loss: 1.081695
Client Index = 12	Epoch: 4	Loss: 1.033253
test acc on this client after 299 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 13
local mask changes: 2839756.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3059390.0, 2839756.0, 3058928.0]
Doing local aggregation!
test acc on this client before 333 / 505 : 0.66
Client Index = 13	Epoch: 0	Loss: 1.048119
Client Index = 13	Epoch: 1	Loss: 0.961503
Client Index = 13	Epoch: 2	Loss: 0.976726
Client Index = 13	Epoch: 3	Loss: 0.956685
Client Index = 13	Epoch: 4	Loss: 1.008239
test acc on this client after 294 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 14
local mask changes: 2840930.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3059770.0, 2840930.0, 3059134.0]
Doing local aggregation!
test acc on this client before 268 / 503 : 0.53
Client Index = 14	Epoch: 0	Loss: 1.161364
Client Index = 14	Epoch: 1	Loss: 1.139174
Client Index = 14	Epoch: 2	Loss: 1.080688
Client Index = 14	Epoch: 3	Loss: 1.080942
Client Index = 14	Epoch: 4	Loss: 1.096587
test acc on this client after 277 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 15
local mask changes: 2841504.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3061642.0, 2841504.0, 3057906.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 15	Epoch: 0	Loss: 0.889456
Client Index = 15	Epoch: 1	Loss: 0.830306
Client Index = 15	Epoch: 2	Loss: 0.857106
Client Index = 15	Epoch: 3	Loss: 0.799965
Client Index = 15	Epoch: 4	Loss: 0.781948
test acc on this client after 329 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 16
local mask changes: 2840408.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3060688.0, 2840408.0, 3061840.0]
Doing local aggregation!
test acc on this client before 284 / 504 : 0.56
Client Index = 16	Epoch: 0	Loss: 1.142965
Client Index = 16	Epoch: 1	Loss: 1.066135
Client Index = 16	Epoch: 2	Loss: 1.014543
Client Index = 16	Epoch: 3	Loss: 1.001549
Client Index = 16	Epoch: 4	Loss: 1.008431
test acc on this client after 262 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 17
local mask changes: 2840470.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3063056.0, 2840470.0, 3067884.0]
Doing local aggregation!
test acc on this client before 213 / 503 : 0.42
Client Index = 17	Epoch: 0	Loss: 1.297792
Client Index = 17	Epoch: 1	Loss: 1.295808
Client Index = 17	Epoch: 2	Loss: 1.204933
Client Index = 17	Epoch: 3	Loss: 1.205824
Client Index = 17	Epoch: 4	Loss: 1.183531
test acc on this client after 258 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 18
local mask changes: 2840440.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3065568.0, 2840440.0, 3063034.0]
Doing local aggregation!
test acc on this client before 272 / 503 : 0.54
Client Index = 18	Epoch: 0	Loss: 0.989341
Client Index = 18	Epoch: 1	Loss: 0.943665
Client Index = 18	Epoch: 2	Loss: 0.933648
Client Index = 18	Epoch: 3	Loss: 0.966196
Client Index = 18	Epoch: 4	Loss: 0.935424
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 19
local mask changes: 2840458.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3062870.0, 3063876.0, 2840458.0]
Doing local aggregation!
test acc on this client before 319 / 503 : 0.63
Client Index = 19	Epoch: 0	Loss: 1.087895
Client Index = 19	Epoch: 1	Loss: 1.055677
Client Index = 19	Epoch: 2	Loss: 0.966769
Client Index = 19	Epoch: 3	Loss: 0.925531
Client Index = 19	Epoch: 4	Loss: 0.980280
test acc on this client after 282 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.9670750137791038}
################local_test_on_all_clients after local training in communication round: 15
{'test_acc_after': 0.6290117191599506, 'test_loss_after': 1.1180933103055106}
################local_test_on_all_clients before local training in communication round: 15
{'test_acc_before': 0.5727437346197483, 'test_loss_before': 1.2543861988133969}
################Communication round : 16
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 0
local mask changes: 2826712.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2826712.0, 3040988.0, 3039932.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 0	Epoch: 0	Loss: 0.983934
Client Index = 0	Epoch: 1	Loss: 0.932908
Client Index = 0	Epoch: 2	Loss: 1.050696
Client Index = 0	Epoch: 3	Loss: 0.880132
Client Index = 0	Epoch: 4	Loss: 0.982939
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 1
local mask changes: 2827000.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3041330.0, 2827000.0, 3043938.0]
Doing local aggregation!
test acc on this client before 273 / 503 : 0.54
Client Index = 1	Epoch: 0	Loss: 0.789690
Client Index = 1	Epoch: 1	Loss: 0.706292
Client Index = 1	Epoch: 2	Loss: 0.726598
Client Index = 1	Epoch: 3	Loss: 0.681228
Client Index = 1	Epoch: 4	Loss: 0.685613
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 2
local mask changes: 2826822.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3042826.0, 2826822.0, 3047644.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.646971
Client Index = 2	Epoch: 1	Loss: 0.558326
Client Index = 2	Epoch: 2	Loss: 0.518032
Client Index = 2	Epoch: 3	Loss: 0.570937
Client Index = 2	Epoch: 4	Loss: 0.526778
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 3
local mask changes: 2826420.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3048776.0, 2826420.0, 3050990.0]
Doing local aggregation!
test acc on this client before 326 / 504 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.947576
Client Index = 3	Epoch: 1	Loss: 0.842149
Client Index = 3	Epoch: 2	Loss: 0.894321
Client Index = 3	Epoch: 3	Loss: 0.822168
Client Index = 3	Epoch: 4	Loss: 0.754946
test acc on this client after 359 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 4
local mask changes: 2825862.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3052892.0, 2825862.0, 3047714.0]
Doing local aggregation!
test acc on this client before 301 / 504 : 0.60
Client Index = 4	Epoch: 0	Loss: 1.155889
Client Index = 4	Epoch: 1	Loss: 1.090486
Client Index = 4	Epoch: 2	Loss: 1.041967
Client Index = 4	Epoch: 3	Loss: 1.064051
Client Index = 4	Epoch: 4	Loss: 1.016693
test acc on this client after 264 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 5
local mask changes: 2826312.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3044734.0, 2826312.0, 3042204.0]
Doing local aggregation!
test acc on this client before 238 / 503 : 0.47
Client Index = 5	Epoch: 0	Loss: 0.982345
Client Index = 5	Epoch: 1	Loss: 0.931733
Client Index = 5	Epoch: 2	Loss: 0.955555
Client Index = 5	Epoch: 3	Loss: 0.899905
Client Index = 5	Epoch: 4	Loss: 0.932269
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 6
local mask changes: 2824578.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3042298.0, 2824578.0, 3040744.0]
Doing local aggregation!
test acc on this client before 293 / 505 : 0.58
Client Index = 6	Epoch: 0	Loss: 1.128116
Client Index = 6	Epoch: 1	Loss: 1.087770
Client Index = 6	Epoch: 2	Loss: 1.083919
Client Index = 6	Epoch: 3	Loss: 1.167788
Client Index = 6	Epoch: 4	Loss: 1.058269
test acc on this client after 301 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 7
local mask changes: 2825418.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3039354.0, 2825418.0, 3042572.0]
Doing local aggregation!
test acc on this client before 243 / 504 : 0.48
Client Index = 7	Epoch: 0	Loss: 1.262355
Client Index = 7	Epoch: 1	Loss: 1.189698
Client Index = 7	Epoch: 2	Loss: 1.216048
Client Index = 7	Epoch: 3	Loss: 1.122968
Client Index = 7	Epoch: 4	Loss: 1.184765
test acc on this client after 198 / 504 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 8
local mask changes: 2825970.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3040648.0, 2825970.0, 3041480.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 8	Epoch: 0	Loss: 0.532583
Client Index = 8	Epoch: 1	Loss: 0.483888
Client Index = 8	Epoch: 2	Loss: 0.441176
Client Index = 8	Epoch: 3	Loss: 0.473075
Client Index = 8	Epoch: 4	Loss: 0.385105
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 9
local mask changes: 2825946.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3041650.0, 2825946.0, 3034638.0]
Doing local aggregation!
test acc on this client before 224 / 506 : 0.44
Client Index = 9	Epoch: 0	Loss: 1.116728
Client Index = 9	Epoch: 1	Loss: 1.007683
Client Index = 9	Epoch: 2	Loss: 1.050238
Client Index = 9	Epoch: 3	Loss: 1.028603
Client Index = 9	Epoch: 4	Loss: 1.028003
test acc on this client after 314 / 506 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 10
local mask changes: 2826848.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3034204.0, 2826848.0, 3043310.0]
Doing local aggregation!
test acc on this client before 288 / 503 : 0.57
Client Index = 10	Epoch: 0	Loss: 1.118765
Client Index = 10	Epoch: 1	Loss: 1.025715
Client Index = 10	Epoch: 2	Loss: 1.106589
Client Index = 10	Epoch: 3	Loss: 1.032397
Client Index = 10	Epoch: 4	Loss: 1.051442
test acc on this client after 290 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 11
local mask changes: 2826064.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3039594.0, 2826064.0, 3042140.0]
Doing local aggregation!
test acc on this client before 251 / 505 : 0.50
Client Index = 11	Epoch: 0	Loss: 0.818025
Client Index = 11	Epoch: 1	Loss: 0.692344
Client Index = 11	Epoch: 2	Loss: 0.648376
Client Index = 11	Epoch: 3	Loss: 0.688512
Client Index = 11	Epoch: 4	Loss: 0.659128
test acc on this client after 371 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 12
local mask changes: 2826272.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3041426.0, 2826272.0, 3034250.0]
Doing local aggregation!
test acc on this client before 245 / 504 : 0.49
Client Index = 12	Epoch: 0	Loss: 1.132855
Client Index = 12	Epoch: 1	Loss: 1.064759
Client Index = 12	Epoch: 2	Loss: 1.082766
Client Index = 12	Epoch: 3	Loss: 1.052459
Client Index = 12	Epoch: 4	Loss: 1.071569
test acc on this client after 304 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 13
local mask changes: 2826324.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3034704.0, 2826324.0, 3035526.0]
Doing local aggregation!
test acc on this client before 310 / 505 : 0.61
Client Index = 13	Epoch: 0	Loss: 1.002375
Client Index = 13	Epoch: 1	Loss: 1.021138
Client Index = 13	Epoch: 2	Loss: 0.913201
Client Index = 13	Epoch: 3	Loss: 0.913890
Client Index = 13	Epoch: 4	Loss: 0.943021
test acc on this client after 331 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 14
local mask changes: 2826550.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3035986.0, 2826550.0, 3039172.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 14	Epoch: 0	Loss: 1.137838
Client Index = 14	Epoch: 1	Loss: 1.068114
Client Index = 14	Epoch: 2	Loss: 1.074803
Client Index = 14	Epoch: 3	Loss: 1.085410
Client Index = 14	Epoch: 4	Loss: 1.021026
test acc on this client after 249 / 503 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 15
local mask changes: 2826930.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3037984.0, 2826930.0, 3036484.0]
Doing local aggregation!
test acc on this client before 340 / 503 : 0.68
Client Index = 15	Epoch: 0	Loss: 0.912019
Client Index = 15	Epoch: 1	Loss: 0.873888
Client Index = 15	Epoch: 2	Loss: 0.829193
Client Index = 15	Epoch: 3	Loss: 0.794520
Client Index = 15	Epoch: 4	Loss: 0.747292
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 16
local mask changes: 2826436.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3037524.0, 2826436.0, 3037108.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 16	Epoch: 0	Loss: 1.039390
Client Index = 16	Epoch: 1	Loss: 1.021801
Client Index = 16	Epoch: 2	Loss: 0.976723
Client Index = 16	Epoch: 3	Loss: 0.926115
Client Index = 16	Epoch: 4	Loss: 0.924248
test acc on this client after 285 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 17
local mask changes: 2826930.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3040478.0, 2826930.0, 3044790.0]
Doing local aggregation!
test acc on this client before 202 / 503 : 0.40
Client Index = 17	Epoch: 0	Loss: 1.298329
Client Index = 17	Epoch: 1	Loss: 1.238478
Client Index = 17	Epoch: 2	Loss: 1.177048
Client Index = 17	Epoch: 3	Loss: 1.178468
Client Index = 17	Epoch: 4	Loss: 1.211191
test acc on this client after 245 / 503 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 18
local mask changes: 2825392.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3044198.0, 2825392.0, 3040890.0]
Doing local aggregation!
test acc on this client before 290 / 503 : 0.58
Client Index = 18	Epoch: 0	Loss: 0.912341
Client Index = 18	Epoch: 1	Loss: 0.977676
Client Index = 18	Epoch: 2	Loss: 0.884608
Client Index = 18	Epoch: 3	Loss: 1.070353
Client Index = 18	Epoch: 4	Loss: 0.934559
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 19
local mask changes: 2824518.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3039332.0, 3040274.0, 2824518.0]
Doing local aggregation!
test acc on this client before 281 / 503 : 0.56
Client Index = 19	Epoch: 0	Loss: 1.043429
Client Index = 19	Epoch: 1	Loss: 0.975479
Client Index = 19	Epoch: 2	Loss: 1.000494
Client Index = 19	Epoch: 3	Loss: 0.910815
Client Index = 19	Epoch: 4	Loss: 0.919717
test acc on this client after 288 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.9382659715935588}
################local_test_on_all_clients after local training in communication round: 16
{'test_acc_after': 0.6247228327647973, 'test_loss_after': 1.1292242303368454}
################local_test_on_all_clients before local training in communication round: 16
{'test_acc_before': 0.5673918864402276, 'test_loss_before': 1.2299401321079755}
################Communication round : 17
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 0
local mask changes: 2810992.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2810992.0, 3017486.0, 3016898.0]
Doing local aggregation!
test acc on this client before 250 / 503 : 0.50
Client Index = 0	Epoch: 0	Loss: 0.933940
Client Index = 0	Epoch: 1	Loss: 0.976106
Client Index = 0	Epoch: 2	Loss: 0.930846
Client Index = 0	Epoch: 3	Loss: 0.898825
Client Index = 0	Epoch: 4	Loss: 0.903764
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 1
local mask changes: 2810638.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [3017766.0, 2810638.0, 3018980.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.711652
Client Index = 1	Epoch: 1	Loss: 0.697951
Client Index = 1	Epoch: 2	Loss: 0.660399
Client Index = 1	Epoch: 3	Loss: 0.680564
Client Index = 1	Epoch: 4	Loss: 0.659034
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 2
local mask changes: 2809844.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [3018060.0, 2809844.0, 3026402.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.555887
Client Index = 2	Epoch: 1	Loss: 0.534621
Client Index = 2	Epoch: 2	Loss: 0.696907
Client Index = 2	Epoch: 3	Loss: 0.534572
Client Index = 2	Epoch: 4	Loss: 0.467578
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 3
local mask changes: 2810276.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3026050.0, 2810276.0, 3028558.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.879344
Client Index = 3	Epoch: 1	Loss: 0.864022
Client Index = 3	Epoch: 2	Loss: 0.736992
Client Index = 3	Epoch: 3	Loss: 0.840594
Client Index = 3	Epoch: 4	Loss: 0.717251
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 4
local mask changes: 2808648.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3028914.0, 2808648.0, 3025654.0]
Doing local aggregation!
test acc on this client before 313 / 504 : 0.62
Client Index = 4	Epoch: 0	Loss: 1.207981
Client Index = 4	Epoch: 1	Loss: 1.030639
Client Index = 4	Epoch: 2	Loss: 1.048126
Client Index = 4	Epoch: 3	Loss: 1.032698
Client Index = 4	Epoch: 4	Loss: 0.969654
test acc on this client after 265 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 5
local mask changes: 2812052.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3020568.0, 2812052.0, 3019420.0]
Doing local aggregation!
test acc on this client before 259 / 503 : 0.51
Client Index = 5	Epoch: 0	Loss: 1.011941
Client Index = 5	Epoch: 1	Loss: 0.928440
Client Index = 5	Epoch: 2	Loss: 0.850328
Client Index = 5	Epoch: 3	Loss: 0.881695
Client Index = 5	Epoch: 4	Loss: 0.872285
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 6
local mask changes: 2810050.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [3017296.0, 2810050.0, 3018262.0]
Doing local aggregation!
test acc on this client before 283 / 505 : 0.56
Client Index = 6	Epoch: 0	Loss: 1.168590
Client Index = 6	Epoch: 1	Loss: 1.052090
Client Index = 6	Epoch: 2	Loss: 1.109026
Client Index = 6	Epoch: 3	Loss: 1.124814
Client Index = 6	Epoch: 4	Loss: 1.028997
test acc on this client after 208 / 505 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 7
local mask changes: 2811660.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [3019558.0, 2811660.0, 3018226.0]
Doing local aggregation!
test acc on this client before 251 / 504 : 0.50
Client Index = 7	Epoch: 0	Loss: 1.215313
Client Index = 7	Epoch: 1	Loss: 1.172769
Client Index = 7	Epoch: 2	Loss: 1.177419
Client Index = 7	Epoch: 3	Loss: 1.144633
Client Index = 7	Epoch: 4	Loss: 1.080130
test acc on this client after 242 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 8
local mask changes: 2809758.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [3017132.0, 2809758.0, 3018380.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.546170
Client Index = 8	Epoch: 1	Loss: 0.493841
Client Index = 8	Epoch: 2	Loss: 0.396155
Client Index = 8	Epoch: 3	Loss: 0.390908
Client Index = 8	Epoch: 4	Loss: 0.502841
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 9
local mask changes: 2809932.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [3020350.0, 2809932.0, 3012712.0]
Doing local aggregation!
test acc on this client before 230 / 506 : 0.45
Client Index = 9	Epoch: 0	Loss: 1.107401
Client Index = 9	Epoch: 1	Loss: 1.008629
Client Index = 9	Epoch: 2	Loss: 0.994414
Client Index = 9	Epoch: 3	Loss: 1.055009
Client Index = 9	Epoch: 4	Loss: 0.991006
test acc on this client after 281 / 506 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 10
local mask changes: 2810854.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [3012974.0, 2810854.0, 3016496.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 10	Epoch: 0	Loss: 1.120644
Client Index = 10	Epoch: 1	Loss: 1.036378
Client Index = 10	Epoch: 2	Loss: 1.049249
Client Index = 10	Epoch: 3	Loss: 1.025190
Client Index = 10	Epoch: 4	Loss: 1.006378
test acc on this client after 309 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 11
local mask changes: 2810220.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [3018520.0, 2810220.0, 3020644.0]
Doing local aggregation!
test acc on this client before 280 / 505 : 0.55
Client Index = 11	Epoch: 0	Loss: 0.792774
Client Index = 11	Epoch: 1	Loss: 0.741027
Client Index = 11	Epoch: 2	Loss: 0.732774
Client Index = 11	Epoch: 3	Loss: 0.626160
Client Index = 11	Epoch: 4	Loss: 0.663579
test acc on this client after 367 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 12
local mask changes: 2811020.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [3020556.0, 2811020.0, 3011438.0]
Doing local aggregation!
test acc on this client before 266 / 504 : 0.53
Client Index = 12	Epoch: 0	Loss: 1.132358
Client Index = 12	Epoch: 1	Loss: 1.083548
Client Index = 12	Epoch: 2	Loss: 1.020010
Client Index = 12	Epoch: 3	Loss: 1.026782
Client Index = 12	Epoch: 4	Loss: 1.087614
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 13
local mask changes: 2811454.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [3011840.0, 2811454.0, 3014088.0]
Doing local aggregation!
test acc on this client before 342 / 505 : 0.68
Client Index = 13	Epoch: 0	Loss: 0.987324
Client Index = 13	Epoch: 1	Loss: 0.950868
Client Index = 13	Epoch: 2	Loss: 0.878001
Client Index = 13	Epoch: 3	Loss: 0.901032
Client Index = 13	Epoch: 4	Loss: 0.925898
test acc on this client after 327 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 14
local mask changes: 2811982.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [3013392.0, 2811982.0, 3014418.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 14	Epoch: 0	Loss: 1.125909
Client Index = 14	Epoch: 1	Loss: 1.016242
Client Index = 14	Epoch: 2	Loss: 1.054386
Client Index = 14	Epoch: 3	Loss: 1.037459
Client Index = 14	Epoch: 4	Loss: 1.031271
test acc on this client after 253 / 503 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 15
local mask changes: 2809482.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [3012916.0, 2809482.0, 3013170.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 15	Epoch: 0	Loss: 0.847047
Client Index = 15	Epoch: 1	Loss: 0.871019
Client Index = 15	Epoch: 2	Loss: 0.764227
Client Index = 15	Epoch: 3	Loss: 0.777691
Client Index = 15	Epoch: 4	Loss: 0.783658
test acc on this client after 356 / 503 : 0.71
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 16
local mask changes: 2810618.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [3013782.0, 2810618.0, 3016156.0]
Doing local aggregation!
test acc on this client before 289 / 504 : 0.57
Client Index = 16	Epoch: 0	Loss: 1.079481
Client Index = 16	Epoch: 1	Loss: 1.066493
Client Index = 16	Epoch: 2	Loss: 0.918529
Client Index = 16	Epoch: 3	Loss: 0.935542
Client Index = 16	Epoch: 4	Loss: 0.923797
test acc on this client after 276 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 17
local mask changes: 2810970.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [3016792.0, 2810970.0, 3020082.0]
Doing local aggregation!
test acc on this client before 218 / 503 : 0.43
Client Index = 17	Epoch: 0	Loss: 1.220734
Client Index = 17	Epoch: 1	Loss: 1.178090
Client Index = 17	Epoch: 2	Loss: 1.192906
Client Index = 17	Epoch: 3	Loss: 1.191507
Client Index = 17	Epoch: 4	Loss: 1.103527
test acc on this client after 288 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 18
local mask changes: 2812778.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [3023258.0, 2812778.0, 3018588.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 18	Epoch: 0	Loss: 0.981549
Client Index = 18	Epoch: 1	Loss: 0.893606
Client Index = 18	Epoch: 2	Loss: 0.851152
Client Index = 18	Epoch: 3	Loss: 0.873374
Client Index = 18	Epoch: 4	Loss: 0.861561
test acc on this client after 318 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 19
local mask changes: 2810246.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [3017344.0, 3015854.0, 2810246.0]
Doing local aggregation!
test acc on this client before 284 / 503 : 0.56
Client Index = 19	Epoch: 0	Loss: 1.033849
Client Index = 19	Epoch: 1	Loss: 0.933305
Client Index = 19	Epoch: 2	Loss: 0.922934
Client Index = 19	Epoch: 3	Loss: 0.846171
Client Index = 19	Epoch: 4	Loss: 0.998995
test acc on this client after 343 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.9157839210256935}
################local_test_on_all_clients after local training in communication round: 17
{'test_acc_after': 0.6339163243343584, 'test_loss_after': 1.123145565904986}
################local_test_on_all_clients before local training in communication round: 17
{'test_acc_before': 0.5911097524833426, 'test_loss_before': 1.193417143591595}
################Communication round : 18
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 0
local mask changes: 2792744.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2792744.0, 2997578.0, 2994976.0]
Doing local aggregation!
test acc on this client before 330 / 503 : 0.66
Client Index = 0	Epoch: 0	Loss: 1.004526
Client Index = 0	Epoch: 1	Loss: 0.913815
Client Index = 0	Epoch: 2	Loss: 0.973185
Client Index = 0	Epoch: 3	Loss: 0.852402
Client Index = 0	Epoch: 4	Loss: 0.872178
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 1
local mask changes: 2793832.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2995324.0, 2793832.0, 2995480.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 1	Epoch: 0	Loss: 0.705132
Client Index = 1	Epoch: 1	Loss: 0.823851
Client Index = 1	Epoch: 2	Loss: 0.612024
Client Index = 1	Epoch: 3	Loss: 0.659651
Client Index = 1	Epoch: 4	Loss: 0.638248
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 2
local mask changes: 2793326.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2996272.0, 2793326.0, 3001310.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.705090
Client Index = 2	Epoch: 1	Loss: 0.535456
Client Index = 2	Epoch: 2	Loss: 0.483465
Client Index = 2	Epoch: 3	Loss: 0.487876
Client Index = 2	Epoch: 4	Loss: 0.480138
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 3
local mask changes: 2794242.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [3001706.0, 2794242.0, 3003088.0]
Doing local aggregation!
test acc on this client before 333 / 504 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.829728
Client Index = 3	Epoch: 1	Loss: 0.829290
Client Index = 3	Epoch: 2	Loss: 0.688779
Client Index = 3	Epoch: 3	Loss: 0.763194
Client Index = 3	Epoch: 4	Loss: 0.745160
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 4
local mask changes: 2792674.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [3006986.0, 2792674.0, 2999116.0]
Doing local aggregation!
test acc on this client before 305 / 504 : 0.61
Client Index = 4	Epoch: 0	Loss: 1.081122
Client Index = 4	Epoch: 1	Loss: 1.025481
Client Index = 4	Epoch: 2	Loss: 1.107491
Client Index = 4	Epoch: 3	Loss: 0.987790
Client Index = 4	Epoch: 4	Loss: 0.957552
test acc on this client after 325 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 5
local mask changes: 2792236.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [3000120.0, 2792236.0, 2996174.0]
Doing local aggregation!
test acc on this client before 232 / 503 : 0.46
Client Index = 5	Epoch: 0	Loss: 0.995262
Client Index = 5	Epoch: 1	Loss: 0.903743
Client Index = 5	Epoch: 2	Loss: 0.870787
Client Index = 5	Epoch: 3	Loss: 0.836569
Client Index = 5	Epoch: 4	Loss: 0.887513
test acc on this client after 329 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 6
local mask changes: 2792938.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2998384.0, 2792938.0, 2997548.0]
Doing local aggregation!
test acc on this client before 273 / 505 : 0.54
Client Index = 6	Epoch: 0	Loss: 1.169157
Client Index = 6	Epoch: 1	Loss: 1.010039
Client Index = 6	Epoch: 2	Loss: 1.001371
Client Index = 6	Epoch: 3	Loss: 1.039715
Client Index = 6	Epoch: 4	Loss: 1.075657
test acc on this client after 290 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 7
local mask changes: 2793226.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2995242.0, 2793226.0, 2996592.0]
Doing local aggregation!
test acc on this client before 225 / 504 : 0.45
Client Index = 7	Epoch: 0	Loss: 1.214344
Client Index = 7	Epoch: 1	Loss: 1.166171
Client Index = 7	Epoch: 2	Loss: 1.127650
Client Index = 7	Epoch: 3	Loss: 1.131975
Client Index = 7	Epoch: 4	Loss: 1.088043
test acc on this client after 241 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 8
local mask changes: 2794314.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2994306.0, 2794314.0, 2999106.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.497417
Client Index = 8	Epoch: 1	Loss: 0.456481
Client Index = 8	Epoch: 2	Loss: 0.397614
Client Index = 8	Epoch: 3	Loss: 0.559197
Client Index = 8	Epoch: 4	Loss: 0.397277
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 9
local mask changes: 2794328.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2998024.0, 2794328.0, 2992054.0]
Doing local aggregation!
test acc on this client before 222 / 506 : 0.44
Client Index = 9	Epoch: 0	Loss: 1.076990
Client Index = 9	Epoch: 1	Loss: 1.009643
Client Index = 9	Epoch: 2	Loss: 0.997715
Client Index = 9	Epoch: 3	Loss: 0.947846
Client Index = 9	Epoch: 4	Loss: 0.949066
test acc on this client after 320 / 506 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 10
local mask changes: 2794532.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2989652.0, 2794532.0, 2993728.0]
Doing local aggregation!
test acc on this client before 262 / 503 : 0.52
Client Index = 10	Epoch: 0	Loss: 1.106024
Client Index = 10	Epoch: 1	Loss: 1.015245
Client Index = 10	Epoch: 2	Loss: 0.999138
Client Index = 10	Epoch: 3	Loss: 1.008903
Client Index = 10	Epoch: 4	Loss: 0.984132
test acc on this client after 246 / 503 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 11
local mask changes: 2794742.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2993416.0, 2794742.0, 2998352.0]
Doing local aggregation!
test acc on this client before 321 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.886991
Client Index = 11	Epoch: 1	Loss: 0.643097
Client Index = 11	Epoch: 2	Loss: 0.644161
Client Index = 11	Epoch: 3	Loss: 0.666648
Client Index = 11	Epoch: 4	Loss: 0.597713
test acc on this client after 357 / 505 : 0.71
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 12
local mask changes: 2791784.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2999306.0, 2791784.0, 2990720.0]
Doing local aggregation!
test acc on this client before 259 / 504 : 0.51
Client Index = 12	Epoch: 0	Loss: 1.074851
Client Index = 12	Epoch: 1	Loss: 1.058862
Client Index = 12	Epoch: 2	Loss: 1.061351
Client Index = 12	Epoch: 3	Loss: 1.003490
Client Index = 12	Epoch: 4	Loss: 0.986178
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 13
local mask changes: 2792986.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2990142.0, 2792986.0, 2991154.0]
Doing local aggregation!
test acc on this client before 332 / 505 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.995968
Client Index = 13	Epoch: 1	Loss: 0.950056
Client Index = 13	Epoch: 2	Loss: 0.908111
Client Index = 13	Epoch: 3	Loss: 0.929430
Client Index = 13	Epoch: 4	Loss: 0.874404
test acc on this client after 316 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 14
local mask changes: 2794718.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2991478.0, 2794718.0, 2990322.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 14	Epoch: 0	Loss: 1.071200
Client Index = 14	Epoch: 1	Loss: 1.112334
Client Index = 14	Epoch: 2	Loss: 0.980783
Client Index = 14	Epoch: 3	Loss: 1.032876
Client Index = 14	Epoch: 4	Loss: 0.962797
test acc on this client after 259 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 15
local mask changes: 2793732.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2990036.0, 2793732.0, 2991870.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 15	Epoch: 0	Loss: 0.912150
Client Index = 15	Epoch: 1	Loss: 0.756936
Client Index = 15	Epoch: 2	Loss: 0.793530
Client Index = 15	Epoch: 3	Loss: 0.754900
Client Index = 15	Epoch: 4	Loss: 0.747850
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 16
local mask changes: 2793022.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2992708.0, 2793022.0, 2992788.0]
Doing local aggregation!
test acc on this client before 305 / 504 : 0.61
Client Index = 16	Epoch: 0	Loss: 0.977947
Client Index = 16	Epoch: 1	Loss: 1.012736
Client Index = 16	Epoch: 2	Loss: 0.938367
Client Index = 16	Epoch: 3	Loss: 0.918483
Client Index = 16	Epoch: 4	Loss: 0.906077
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 17
local mask changes: 2793522.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2993830.0, 2793522.0, 2998754.0]
Doing local aggregation!
test acc on this client before 232 / 503 : 0.46
Client Index = 17	Epoch: 0	Loss: 1.230103
Client Index = 17	Epoch: 1	Loss: 1.171236
Client Index = 17	Epoch: 2	Loss: 1.170917
Client Index = 17	Epoch: 3	Loss: 1.136670
Client Index = 17	Epoch: 4	Loss: 1.155541
test acc on this client after 268 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 18
local mask changes: 2794998.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2997474.0, 2794998.0, 2994968.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 18	Epoch: 0	Loss: 0.976865
Client Index = 18	Epoch: 1	Loss: 0.847715
Client Index = 18	Epoch: 2	Loss: 0.914795
Client Index = 18	Epoch: 3	Loss: 0.860216
Client Index = 18	Epoch: 4	Loss: 0.793291
test acc on this client after 337 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 19
local mask changes: 2794744.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2995274.0, 2995256.0, 2794744.0]
Doing local aggregation!
test acc on this client before 316 / 503 : 0.63
Client Index = 19	Epoch: 0	Loss: 0.974483
Client Index = 19	Epoch: 1	Loss: 0.937187
Client Index = 19	Epoch: 2	Loss: 0.952461
Client Index = 19	Epoch: 3	Loss: 0.883462
Client Index = 19	Epoch: 4	Loss: 0.918449
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.8976697731390596}
################local_test_on_all_clients after local training in communication round: 18
{'test_acc_after': 0.6442926978462142, 'test_loss_after': 1.0622269737552545}
################local_test_on_all_clients before local training in communication round: 18
{'test_acc_before': 0.5924023911565921, 'test_loss_before': 1.1596359148636757}
################Communication round : 19
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 0
local mask changes: 2776186.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2776186.0, 2973988.0, 2972188.0]
Doing local aggregation!
test acc on this client before 331 / 503 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.920827
Client Index = 0	Epoch: 1	Loss: 0.870639
Client Index = 0	Epoch: 2	Loss: 0.878731
Client Index = 0	Epoch: 3	Loss: 0.831101
Client Index = 0	Epoch: 4	Loss: 0.852962
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 1
local mask changes: 2778104.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2972336.0, 2778104.0, 2973392.0]
Doing local aggregation!
test acc on this client before 265 / 503 : 0.53
Client Index = 1	Epoch: 0	Loss: 0.777087
Client Index = 1	Epoch: 1	Loss: 0.654935
Client Index = 1	Epoch: 2	Loss: 0.646417
Client Index = 1	Epoch: 3	Loss: 0.604137
Client Index = 1	Epoch: 4	Loss: 0.654842
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 2
local mask changes: 2778372.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2973812.0, 2778372.0, 2978308.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.708548
Client Index = 2	Epoch: 1	Loss: 0.506678
Client Index = 2	Epoch: 2	Loss: 0.474523
Client Index = 2	Epoch: 3	Loss: 0.459005
Client Index = 2	Epoch: 4	Loss: 0.516884
test acc on this client after 321 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 3
local mask changes: 2775286.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2977254.0, 2775286.0, 2982422.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.857713
Client Index = 3	Epoch: 1	Loss: 0.743860
Client Index = 3	Epoch: 2	Loss: 0.698869
Client Index = 3	Epoch: 3	Loss: 0.824058
Client Index = 3	Epoch: 4	Loss: 0.677311
test acc on this client after 340 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 4
local mask changes: 2777012.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2981658.0, 2777012.0, 2976946.0]
Doing local aggregation!
test acc on this client before 308 / 504 : 0.61
Client Index = 4	Epoch: 0	Loss: 1.046319
Client Index = 4	Epoch: 1	Loss: 1.010864
Client Index = 4	Epoch: 2	Loss: 0.951693
Client Index = 4	Epoch: 3	Loss: 1.030100
Client Index = 4	Epoch: 4	Loss: 0.954285
test acc on this client after 322 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 5
local mask changes: 2777042.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2976574.0, 2777042.0, 2973932.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 5	Epoch: 0	Loss: 0.966910
Client Index = 5	Epoch: 1	Loss: 0.869976
Client Index = 5	Epoch: 2	Loss: 0.880336
Client Index = 5	Epoch: 3	Loss: 0.889440
Client Index = 5	Epoch: 4	Loss: 0.823715
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 6
local mask changes: 2776978.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2970800.0, 2776978.0, 2972652.0]
Doing local aggregation!
test acc on this client before 281 / 505 : 0.56
Client Index = 6	Epoch: 0	Loss: 1.042936
Client Index = 6	Epoch: 1	Loss: 1.080884
Client Index = 6	Epoch: 2	Loss: 0.970541
Client Index = 6	Epoch: 3	Loss: 1.033212
Client Index = 6	Epoch: 4	Loss: 0.984527
test acc on this client after 286 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 7
local mask changes: 2776582.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2973160.0, 2776582.0, 2974610.0]
Doing local aggregation!
test acc on this client before 234 / 504 : 0.46
Client Index = 7	Epoch: 0	Loss: 1.227445
Client Index = 7	Epoch: 1	Loss: 1.116098
Client Index = 7	Epoch: 2	Loss: 1.137924
Client Index = 7	Epoch: 3	Loss: 1.122390
Client Index = 7	Epoch: 4	Loss: 1.131848
test acc on this client after 272 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 8
local mask changes: 2775570.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2972934.0, 2775570.0, 2976642.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.480461
Client Index = 8	Epoch: 1	Loss: 0.427737
Client Index = 8	Epoch: 2	Loss: 0.420713
Client Index = 8	Epoch: 3	Loss: 0.339697
Client Index = 8	Epoch: 4	Loss: 0.341242
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 9
local mask changes: 2776752.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2974392.0, 2776752.0, 2968548.0]
Doing local aggregation!
test acc on this client before 260 / 506 : 0.51
Client Index = 9	Epoch: 0	Loss: 1.030388
Client Index = 9	Epoch: 1	Loss: 0.981605
Client Index = 9	Epoch: 2	Loss: 0.997988
Client Index = 9	Epoch: 3	Loss: 0.997567
Client Index = 9	Epoch: 4	Loss: 0.918168
test acc on this client after 282 / 506 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 10
local mask changes: 2776082.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2967318.0, 2776082.0, 2972908.0]
Doing local aggregation!
test acc on this client before 289 / 503 : 0.57
Client Index = 10	Epoch: 0	Loss: 1.073839
Client Index = 10	Epoch: 1	Loss: 1.015931
Client Index = 10	Epoch: 2	Loss: 0.969101
Client Index = 10	Epoch: 3	Loss: 0.980857
Client Index = 10	Epoch: 4	Loss: 0.986979
test acc on this client after 314 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 11
local mask changes: 2775242.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2970378.0, 2775242.0, 2973434.0]
Doing local aggregation!
test acc on this client before 305 / 505 : 0.60
Client Index = 11	Epoch: 0	Loss: 0.718423
Client Index = 11	Epoch: 1	Loss: 0.622116
Client Index = 11	Epoch: 2	Loss: 0.656733
Client Index = 11	Epoch: 3	Loss: 0.576732
Client Index = 11	Epoch: 4	Loss: 0.575747
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653341696.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 12
local mask changes: 2774894.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2974554.0, 2774894.0, 2966562.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 12	Epoch: 0	Loss: 1.050616
Client Index = 12	Epoch: 1	Loss: 1.098195
Client Index = 12	Epoch: 2	Loss: 0.986250
Client Index = 12	Epoch: 3	Loss: 1.045573
Client Index = 12	Epoch: 4	Loss: 0.981431
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 13
local mask changes: 2774636.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2965494.0, 2774636.0, 2967588.0]
Doing local aggregation!
test acc on this client before 339 / 505 : 0.67
Client Index = 13	Epoch: 0	Loss: 0.986928
Client Index = 13	Epoch: 1	Loss: 0.882383
Client Index = 13	Epoch: 2	Loss: 0.867694
Client Index = 13	Epoch: 3	Loss: 0.914772
Client Index = 13	Epoch: 4	Loss: 0.939329
test acc on this client after 283 / 505 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 14
local mask changes: 2774254.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2967508.0, 2774254.0, 2967450.0]
Doing local aggregation!
test acc on this client before 275 / 503 : 0.55
Client Index = 14	Epoch: 0	Loss: 1.045647
Client Index = 14	Epoch: 1	Loss: 0.989448
Client Index = 14	Epoch: 2	Loss: 1.084454
Client Index = 14	Epoch: 3	Loss: 0.936046
Client Index = 14	Epoch: 4	Loss: 1.001917
test acc on this client after 213 / 503 : 0.42
-----------------------------------
training flops per data 2653335552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 15
local mask changes: 2775192.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2968774.0, 2775192.0, 2968358.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 15	Epoch: 0	Loss: 0.868344
Client Index = 15	Epoch: 1	Loss: 0.750683
Client Index = 15	Epoch: 2	Loss: 0.746652
Client Index = 15	Epoch: 3	Loss: 0.749501
Client Index = 15	Epoch: 4	Loss: 0.759868
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653332480.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 16
local mask changes: 2776978.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2968138.0, 2776978.0, 2970918.0]
Doing local aggregation!
test acc on this client before 306 / 504 : 0.61
Client Index = 16	Epoch: 0	Loss: 0.991934
Client Index = 16	Epoch: 1	Loss: 0.954304
Client Index = 16	Epoch: 2	Loss: 0.870239
Client Index = 16	Epoch: 3	Loss: 0.951349
Client Index = 16	Epoch: 4	Loss: 0.912760
test acc on this client after 274 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 17
local mask changes: 2776142.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2969880.0, 2776142.0, 2975950.0]
Doing local aggregation!
test acc on this client before 215 / 503 : 0.43
Client Index = 17	Epoch: 0	Loss: 1.195353
Client Index = 17	Epoch: 1	Loss: 1.110224
Client Index = 17	Epoch: 2	Loss: 1.081362
Client Index = 17	Epoch: 3	Loss: 1.084505
Client Index = 17	Epoch: 4	Loss: 1.057496
test acc on this client after 277 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 18
local mask changes: 2775094.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2975972.0, 2775094.0, 2969382.0]
Doing local aggregation!
test acc on this client before 294 / 503 : 0.58
Client Index = 18	Epoch: 0	Loss: 0.844009
Client Index = 18	Epoch: 1	Loss: 0.839695
Client Index = 18	Epoch: 2	Loss: 0.802468
Client Index = 18	Epoch: 3	Loss: 0.916225
Client Index = 18	Epoch: 4	Loss: 0.826719
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 19
local mask changes: 2777216.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2973982.0, 2971370.0, 2777216.0]
Doing local aggregation!
test acc on this client before 333 / 503 : 0.66
Client Index = 19	Epoch: 0	Loss: 0.963622
Client Index = 19	Epoch: 1	Loss: 0.904884
Client Index = 19	Epoch: 2	Loss: 0.820565
Client Index = 19	Epoch: 3	Loss: 0.929540
Client Index = 19	Epoch: 4	Loss: 0.820553
test acc on this client after 232 / 503 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.8710613180696963}
################local_test_on_all_clients after local training in communication round: 19
{'test_acc_after': 0.6234701084144694, 'test_loss_after': 1.133155631774221}
################local_test_on_all_clients before local training in communication round: 19
{'test_acc_before': 0.6049034653922278, 'test_loss_before': 1.1406068850702729}
################Communication round : 20
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 0
local mask changes: 2760084.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2760084.0, 2949432.0, 2948528.0]
Doing local aggregation!
test acc on this client before 312 / 503 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.902629
Client Index = 0	Epoch: 1	Loss: 0.882848
Client Index = 0	Epoch: 2	Loss: 0.863034
Client Index = 0	Epoch: 3	Loss: 0.857976
Client Index = 0	Epoch: 4	Loss: 0.767013
test acc on this client after 322 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 1
local mask changes: 2758144.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2948366.0, 2758144.0, 2949376.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.728234
Client Index = 1	Epoch: 1	Loss: 0.582743
Client Index = 1	Epoch: 2	Loss: 0.704577
Client Index = 1	Epoch: 3	Loss: 0.603997
Client Index = 1	Epoch: 4	Loss: 0.554933
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 2
local mask changes: 2756966.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2949834.0, 2756966.0, 2955338.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 2	Epoch: 0	Loss: 0.518613
Client Index = 2	Epoch: 1	Loss: 0.534258
Client Index = 2	Epoch: 2	Loss: 0.491365
Client Index = 2	Epoch: 3	Loss: 0.424918
Client Index = 2	Epoch: 4	Loss: 0.457104
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 3
local mask changes: 2757728.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2956156.0, 2757728.0, 2958108.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.860156
Client Index = 3	Epoch: 1	Loss: 0.722183
Client Index = 3	Epoch: 2	Loss: 0.671518
Client Index = 3	Epoch: 3	Loss: 0.625877
Client Index = 3	Epoch: 4	Loss: 0.715617
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 4
local mask changes: 2758428.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2959204.0, 2758428.0, 2953544.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 4	Epoch: 0	Loss: 1.015127
Client Index = 4	Epoch: 1	Loss: 0.959750
Client Index = 4	Epoch: 2	Loss: 0.936118
Client Index = 4	Epoch: 3	Loss: 0.939672
Client Index = 4	Epoch: 4	Loss: 0.883443
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 5
local mask changes: 2757218.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2952502.0, 2757218.0, 2949812.0]
Doing local aggregation!
test acc on this client before 299 / 503 : 0.59
Client Index = 5	Epoch: 0	Loss: 0.898733
Client Index = 5	Epoch: 1	Loss: 0.875063
Client Index = 5	Epoch: 2	Loss: 0.851577
Client Index = 5	Epoch: 3	Loss: 0.812900
Client Index = 5	Epoch: 4	Loss: 0.879241
test acc on this client after 300 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 6
local mask changes: 2760538.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2948648.0, 2760538.0, 2950896.0]
Doing local aggregation!
test acc on this client before 293 / 505 : 0.58
Client Index = 6	Epoch: 0	Loss: 1.027485
Client Index = 6	Epoch: 1	Loss: 1.048137
Client Index = 6	Epoch: 2	Loss: 0.983631
Client Index = 6	Epoch: 3	Loss: 0.993366
Client Index = 6	Epoch: 4	Loss: 0.979866
test acc on this client after 296 / 505 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 7
local mask changes: 2758524.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2947944.0, 2758524.0, 2950298.0]
Doing local aggregation!
test acc on this client before 262 / 504 : 0.52
Client Index = 7	Epoch: 0	Loss: 1.192331
Client Index = 7	Epoch: 1	Loss: 1.150124
Client Index = 7	Epoch: 2	Loss: 1.126202
Client Index = 7	Epoch: 3	Loss: 1.060041
Client Index = 7	Epoch: 4	Loss: 1.095875
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 8
local mask changes: 2757724.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2947048.0, 2757724.0, 2952070.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 8	Epoch: 0	Loss: 0.501512
Client Index = 8	Epoch: 1	Loss: 0.404159
Client Index = 8	Epoch: 2	Loss: 0.443629
Client Index = 8	Epoch: 3	Loss: 0.358740
Client Index = 8	Epoch: 4	Loss: 0.384136
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 9
local mask changes: 2757900.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2954392.0, 2757900.0, 2946952.0]
Doing local aggregation!
test acc on this client before 228 / 506 : 0.45
Client Index = 9	Epoch: 0	Loss: 1.029039
Client Index = 9	Epoch: 1	Loss: 0.988308
Client Index = 9	Epoch: 2	Loss: 0.909544
Client Index = 9	Epoch: 3	Loss: 0.911235
Client Index = 9	Epoch: 4	Loss: 0.981266
test acc on this client after 318 / 506 : 0.63
-----------------------------------
training flops per data 2653339648.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 10
local mask changes: 2757050.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2948206.0, 2757050.0, 2949236.0]
Doing local aggregation!
test acc on this client before 297 / 503 : 0.59
Client Index = 10	Epoch: 0	Loss: 1.027362
Client Index = 10	Epoch: 1	Loss: 0.994685
Client Index = 10	Epoch: 2	Loss: 0.981001
Client Index = 10	Epoch: 3	Loss: 0.946707
Client Index = 10	Epoch: 4	Loss: 0.974651
test acc on this client after 300 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 11
local mask changes: 2756764.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2947770.0, 2756764.0, 2949146.0]
Doing local aggregation!
test acc on this client before 297 / 505 : 0.59
Client Index = 11	Epoch: 0	Loss: 0.729263
Client Index = 11	Epoch: 1	Loss: 0.674056
Client Index = 11	Epoch: 2	Loss: 0.583797
Client Index = 11	Epoch: 3	Loss: 0.659995
Client Index = 11	Epoch: 4	Loss: 0.520352
test acc on this client after 358 / 505 : 0.71
-----------------------------------
training flops per data 2653334784.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 12
local mask changes: 2757658.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2950152.0, 2757658.0, 2944284.0]
Doing local aggregation!
test acc on this client before 255 / 504 : 0.51
Client Index = 12	Epoch: 0	Loss: 1.044027
Client Index = 12	Epoch: 1	Loss: 0.954241
Client Index = 12	Epoch: 2	Loss: 1.086621
Client Index = 12	Epoch: 3	Loss: 0.996266
Client Index = 12	Epoch: 4	Loss: 0.942555
test acc on this client after 251 / 504 : 0.50
-----------------------------------
training flops per data 2653331968.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 13
local mask changes: 2759130.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2941606.0, 2759130.0, 2944990.0]
Doing local aggregation!
test acc on this client before 320 / 505 : 0.63
Client Index = 13	Epoch: 0	Loss: 0.951034
Client Index = 13	Epoch: 1	Loss: 0.889051
Client Index = 13	Epoch: 2	Loss: 0.853490
Client Index = 13	Epoch: 3	Loss: 0.875146
Client Index = 13	Epoch: 4	Loss: 0.843924
test acc on this client after 312 / 505 : 0.62
-----------------------------------
training flops per data 2653340160.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 14
local mask changes: 2761322.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2946734.0, 2761322.0, 2944392.0]
Doing local aggregation!
test acc on this client before 249 / 503 : 0.50
Client Index = 14	Epoch: 0	Loss: 1.022972
Client Index = 14	Epoch: 1	Loss: 1.056934
Client Index = 14	Epoch: 2	Loss: 0.957108
Client Index = 14	Epoch: 3	Loss: 0.967024
Client Index = 14	Epoch: 4	Loss: 0.978690
test acc on this client after 283 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 15
local mask changes: 2757748.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2944826.0, 2757748.0, 2945380.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 15	Epoch: 0	Loss: 0.856002
Client Index = 15	Epoch: 1	Loss: 0.749869
Client Index = 15	Epoch: 2	Loss: 0.744169
Client Index = 15	Epoch: 3	Loss: 0.675808
Client Index = 15	Epoch: 4	Loss: 0.711770
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 16
local mask changes: 2757796.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2942712.0, 2757796.0, 2947724.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 16	Epoch: 0	Loss: 0.971371
Client Index = 16	Epoch: 1	Loss: 0.905305
Client Index = 16	Epoch: 2	Loss: 0.921532
Client Index = 16	Epoch: 3	Loss: 0.904746
Client Index = 16	Epoch: 4	Loss: 0.888286
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 17
local mask changes: 2758806.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2948440.0, 2758806.0, 2949800.0]
Doing local aggregation!
test acc on this client before 247 / 503 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.147368
Client Index = 17	Epoch: 1	Loss: 1.146777
Client Index = 17	Epoch: 2	Loss: 1.067002
Client Index = 17	Epoch: 3	Loss: 1.104858
Client Index = 17	Epoch: 4	Loss: 1.058474
test acc on this client after 281 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 18
local mask changes: 2757314.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2950950.0, 2757314.0, 2946426.0]
Doing local aggregation!
test acc on this client before 279 / 503 : 0.55
Client Index = 18	Epoch: 0	Loss: 0.847879
Client Index = 18	Epoch: 1	Loss: 0.898918
Client Index = 18	Epoch: 2	Loss: 0.813343
Client Index = 18	Epoch: 3	Loss: 0.752470
Client Index = 18	Epoch: 4	Loss: 0.789525
test acc on this client after 322 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 19
local mask changes: 2756974.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2947254.0, 2948070.0, 2756974.0]
Doing local aggregation!
test acc on this client before 291 / 503 : 0.58
Client Index = 19	Epoch: 0	Loss: 0.912140
Client Index = 19	Epoch: 1	Loss: 0.865486
Client Index = 19	Epoch: 2	Loss: 0.809101
Client Index = 19	Epoch: 3	Loss: 0.904116
Client Index = 19	Epoch: 4	Loss: 0.839256
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.8488636527359485}
################local_test_on_all_clients after local training in communication round: 20
{'test_acc_after': 0.649260310457407, 'test_loss_after': 1.0360175531320703}
################local_test_on_all_clients before local training in communication round: 20
{'test_acc_before': 0.5957915813684773, 'test_loss_before': 1.1632393199001343}
################Communication round : 21
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 0
local mask changes: 2739220.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2739220.0, 2925344.0, 2923488.0]
Doing local aggregation!
test acc on this client before 319 / 503 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.926497
Client Index = 0	Epoch: 1	Loss: 0.855096
Client Index = 0	Epoch: 2	Loss: 0.836013
Client Index = 0	Epoch: 3	Loss: 0.842159
Client Index = 0	Epoch: 4	Loss: 0.763615
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 1
local mask changes: 2738844.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2925408.0, 2738844.0, 2926608.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 1	Epoch: 0	Loss: 0.742167
Client Index = 1	Epoch: 1	Loss: 0.595958
Client Index = 1	Epoch: 2	Loss: 0.541918
Client Index = 1	Epoch: 3	Loss: 0.617530
Client Index = 1	Epoch: 4	Loss: 0.577624
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 2
local mask changes: 2737852.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2927602.0, 2737852.0, 2930862.0]
Doing local aggregation!
test acc on this client before 362 / 504 : 0.72
Client Index = 2	Epoch: 0	Loss: 0.537209
Client Index = 2	Epoch: 1	Loss: 0.460529
Client Index = 2	Epoch: 2	Loss: 0.483493
Client Index = 2	Epoch: 3	Loss: 0.420446
Client Index = 2	Epoch: 4	Loss: 0.473302
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 3
local mask changes: 2739224.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2933516.0, 2739224.0, 2931240.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.695766
Client Index = 3	Epoch: 1	Loss: 0.655599
Client Index = 3	Epoch: 2	Loss: 0.710557
Client Index = 3	Epoch: 3	Loss: 0.656856
Client Index = 3	Epoch: 4	Loss: 0.651304
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 4
local mask changes: 2736244.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2932928.0, 2736244.0, 2930590.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.930978
Client Index = 4	Epoch: 1	Loss: 0.939327
Client Index = 4	Epoch: 2	Loss: 1.015010
Client Index = 4	Epoch: 3	Loss: 0.940116
Client Index = 4	Epoch: 4	Loss: 0.842368
test acc on this client after 325 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 5
local mask changes: 2738298.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2928698.0, 2738298.0, 2925720.0]
Doing local aggregation!
test acc on this client before 271 / 503 : 0.54
Client Index = 5	Epoch: 0	Loss: 0.942928
Client Index = 5	Epoch: 1	Loss: 0.834000
Client Index = 5	Epoch: 2	Loss: 0.817213
Client Index = 5	Epoch: 3	Loss: 0.861120
Client Index = 5	Epoch: 4	Loss: 0.820456
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 6
local mask changes: 2738592.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2926510.0, 2738592.0, 2927572.0]
Doing local aggregation!
test acc on this client before 322 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 1.031116
Client Index = 6	Epoch: 1	Loss: 0.959631
Client Index = 6	Epoch: 2	Loss: 0.938247
Client Index = 6	Epoch: 3	Loss: 0.966878
Client Index = 6	Epoch: 4	Loss: 0.968717
test acc on this client after 303 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 7
local mask changes: 2738394.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2924548.0, 2738394.0, 2926014.0]
Doing local aggregation!
test acc on this client before 246 / 504 : 0.49
Client Index = 7	Epoch: 0	Loss: 1.173675
Client Index = 7	Epoch: 1	Loss: 1.102250
Client Index = 7	Epoch: 2	Loss: 1.058330
Client Index = 7	Epoch: 3	Loss: 1.030229
Client Index = 7	Epoch: 4	Loss: 1.068770
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 8
local mask changes: 2739704.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2924866.0, 2739704.0, 2930190.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 8	Epoch: 0	Loss: 0.591765
Client Index = 8	Epoch: 1	Loss: 0.378537
Client Index = 8	Epoch: 2	Loss: 0.368498
Client Index = 8	Epoch: 3	Loss: 0.343999
Client Index = 8	Epoch: 4	Loss: 0.380644
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 9
local mask changes: 2737366.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2927966.0, 2737366.0, 2925582.0]
Doing local aggregation!
test acc on this client before 279 / 506 : 0.55
Client Index = 9	Epoch: 0	Loss: 1.052801
Client Index = 9	Epoch: 1	Loss: 0.935016
Client Index = 9	Epoch: 2	Loss: 0.883637
Client Index = 9	Epoch: 3	Loss: 0.989984
Client Index = 9	Epoch: 4	Loss: 0.886762
test acc on this client after 278 / 506 : 0.55
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 10
local mask changes: 2739030.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2922894.0, 2739030.0, 2925046.0]
Doing local aggregation!
test acc on this client before 281 / 503 : 0.56
Client Index = 10	Epoch: 0	Loss: 1.036070
Client Index = 10	Epoch: 1	Loss: 0.995558
Client Index = 10	Epoch: 2	Loss: 0.919320
Client Index = 10	Epoch: 3	Loss: 0.940782
Client Index = 10	Epoch: 4	Loss: 0.883691
test acc on this client after 297 / 503 : 0.59
-----------------------------------
training flops per data 2653331968.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 11
local mask changes: 2739688.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2923808.0, 2739688.0, 2925770.0]
Doing local aggregation!
test acc on this client before 284 / 505 : 0.56
Client Index = 11	Epoch: 0	Loss: 0.726336
Client Index = 11	Epoch: 1	Loss: 0.604436
Client Index = 11	Epoch: 2	Loss: 0.567306
Client Index = 11	Epoch: 3	Loss: 0.592271
Client Index = 11	Epoch: 4	Loss: 0.568924
test acc on this client after 389 / 505 : 0.77
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 12
local mask changes: 2737406.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2927702.0, 2737406.0, 2921148.0]
Doing local aggregation!
test acc on this client before 248 / 504 : 0.49
Client Index = 12	Epoch: 0	Loss: 0.990932
Client Index = 12	Epoch: 1	Loss: 1.000233
Client Index = 12	Epoch: 2	Loss: 1.002584
Client Index = 12	Epoch: 3	Loss: 0.945797
Client Index = 12	Epoch: 4	Loss: 0.911575
test acc on this client after 222 / 504 : 0.44
-----------------------------------
training flops per data 2653331712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 13
local mask changes: 2737330.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2922130.0, 2737330.0, 2921820.0]
Doing local aggregation!
test acc on this client before 334 / 505 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.874631
Client Index = 13	Epoch: 1	Loss: 0.876271
Client Index = 13	Epoch: 2	Loss: 0.856307
Client Index = 13	Epoch: 3	Loss: 0.804369
Client Index = 13	Epoch: 4	Loss: 0.806060
test acc on this client after 358 / 505 : 0.71
-----------------------------------
training flops per data 2653330176.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 14
local mask changes: 2736882.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2921546.0, 2736882.0, 2922332.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 14	Epoch: 0	Loss: 1.020800
Client Index = 14	Epoch: 1	Loss: 0.962694
Client Index = 14	Epoch: 2	Loss: 0.993278
Client Index = 14	Epoch: 3	Loss: 0.945542
Client Index = 14	Epoch: 4	Loss: 0.989132
test acc on this client after 247 / 503 : 0.49
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 15
local mask changes: 2738356.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2920710.0, 2738356.0, 2921314.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.773481
Client Index = 15	Epoch: 1	Loss: 0.770735
Client Index = 15	Epoch: 2	Loss: 0.741429
Client Index = 15	Epoch: 3	Loss: 0.715414
Client Index = 15	Epoch: 4	Loss: 0.689952
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 16
local mask changes: 2738658.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2919088.0, 2738658.0, 2922370.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 16	Epoch: 0	Loss: 0.927746
Client Index = 16	Epoch: 1	Loss: 0.885800
Client Index = 16	Epoch: 2	Loss: 0.892071
Client Index = 16	Epoch: 3	Loss: 0.839845
Client Index = 16	Epoch: 4	Loss: 0.822573
test acc on this client after 300 / 504 : 0.60
-----------------------------------
training flops per data 2653335040.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 17
local mask changes: 2740322.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2922462.0, 2740322.0, 2928034.0]
Doing local aggregation!
test acc on this client before 245 / 503 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.118317
Client Index = 17	Epoch: 1	Loss: 1.133471
Client Index = 17	Epoch: 2	Loss: 1.062789
Client Index = 17	Epoch: 3	Loss: 1.039996
Client Index = 17	Epoch: 4	Loss: 0.985215
test acc on this client after 261 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 18
local mask changes: 2738922.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2926412.0, 2738922.0, 2923350.0]
Doing local aggregation!
test acc on this client before 329 / 503 : 0.65
Client Index = 18	Epoch: 0	Loss: 0.888744
Client Index = 18	Epoch: 1	Loss: 0.822665
Client Index = 18	Epoch: 2	Loss: 0.790440
Client Index = 18	Epoch: 3	Loss: 0.825803
Client Index = 18	Epoch: 4	Loss: 0.742000
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 19
local mask changes: 2738148.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2924944.0, 2925700.0, 2738148.0]
Doing local aggregation!
test acc on this client before 314 / 503 : 0.62
Client Index = 19	Epoch: 0	Loss: 0.926794
Client Index = 19	Epoch: 1	Loss: 0.771803
Client Index = 19	Epoch: 2	Loss: 0.969518
Client Index = 19	Epoch: 3	Loss: 0.784239
Client Index = 19	Epoch: 4	Loss: 0.812220
test acc on this client after 271 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.8264460025057196}
################local_test_on_all_clients after local training in communication round: 21
{'test_acc_after': 0.6496517827279437, 'test_loss_after': 1.0534817626496642}
################local_test_on_all_clients before local training in communication round: 21
{'test_acc_before': 0.6222760719557009, 'test_loss_before': 1.081577653003046}
################Communication round : 22
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 0
local mask changes: 2717162.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2717162.0, 2902296.0, 2901022.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.819510
Client Index = 0	Epoch: 1	Loss: 0.853301
Client Index = 0	Epoch: 2	Loss: 0.820470
Client Index = 0	Epoch: 3	Loss: 0.831984
Client Index = 0	Epoch: 4	Loss: 0.775175
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 1
local mask changes: 2718140.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2903206.0, 2718140.0, 2902742.0]
Doing local aggregation!
test acc on this client before 333 / 503 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.725617
Client Index = 1	Epoch: 1	Loss: 0.600779
Client Index = 1	Epoch: 2	Loss: 0.573071
Client Index = 1	Epoch: 3	Loss: 0.571191
Client Index = 1	Epoch: 4	Loss: 0.533377
test acc on this client after 322 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 2
local mask changes: 2720244.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2902900.0, 2720244.0, 2907148.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.465300
Client Index = 2	Epoch: 1	Loss: 0.435715
Client Index = 2	Epoch: 2	Loss: 0.737925
Client Index = 2	Epoch: 3	Loss: 0.432765
Client Index = 2	Epoch: 4	Loss: 0.398606
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 3
local mask changes: 2717518.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2908160.0, 2717518.0, 2909676.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.819725
Client Index = 3	Epoch: 1	Loss: 0.716740
Client Index = 3	Epoch: 2	Loss: 0.625539
Client Index = 3	Epoch: 3	Loss: 0.661167
Client Index = 3	Epoch: 4	Loss: 0.765975
test acc on this client after 341 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 4
local mask changes: 2719228.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2909542.0, 2719228.0, 2904958.0]
Doing local aggregation!
test acc on this client before 322 / 504 : 0.64
Client Index = 4	Epoch: 0	Loss: 1.024223
Client Index = 4	Epoch: 1	Loss: 0.906812
Client Index = 4	Epoch: 2	Loss: 0.873686
Client Index = 4	Epoch: 3	Loss: 0.885474
Client Index = 4	Epoch: 4	Loss: 0.785251
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 5
local mask changes: 2718566.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2904524.0, 2718566.0, 2902322.0]
Doing local aggregation!
test acc on this client before 263 / 503 : 0.52
Client Index = 5	Epoch: 0	Loss: 0.844941
Client Index = 5	Epoch: 1	Loss: 0.902547
Client Index = 5	Epoch: 2	Loss: 0.822375
Client Index = 5	Epoch: 3	Loss: 0.831130
Client Index = 5	Epoch: 4	Loss: 0.773176
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 6
local mask changes: 2719472.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2901436.0, 2719472.0, 2899594.0]
Doing local aggregation!
test acc on this client before 306 / 505 : 0.61
Client Index = 6	Epoch: 0	Loss: 0.966327
Client Index = 6	Epoch: 1	Loss: 1.011990
Client Index = 6	Epoch: 2	Loss: 0.905915
Client Index = 6	Epoch: 3	Loss: 0.954861
Client Index = 6	Epoch: 4	Loss: 0.934419
test acc on this client after 330 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 7
local mask changes: 2718388.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2902022.0, 2718388.0, 2903206.0]
Doing local aggregation!
test acc on this client before 234 / 504 : 0.46
Client Index = 7	Epoch: 0	Loss: 1.087913
Client Index = 7	Epoch: 1	Loss: 1.129225
Client Index = 7	Epoch: 2	Loss: 1.023210
Client Index = 7	Epoch: 3	Loss: 1.121281
Client Index = 7	Epoch: 4	Loss: 0.978217
test acc on this client after 279 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 8
local mask changes: 2719756.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2898456.0, 2719756.0, 2903512.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.511233
Client Index = 8	Epoch: 1	Loss: 0.352039
Client Index = 8	Epoch: 2	Loss: 0.399232
Client Index = 8	Epoch: 3	Loss: 0.320516
Client Index = 8	Epoch: 4	Loss: 0.373784
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 9
local mask changes: 2718392.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2905014.0, 2718392.0, 2900356.0]
Doing local aggregation!
test acc on this client before 205 / 506 : 0.41
Client Index = 9	Epoch: 0	Loss: 0.983226
Client Index = 9	Epoch: 1	Loss: 1.028674
Client Index = 9	Epoch: 2	Loss: 0.924988
Client Index = 9	Epoch: 3	Loss: 0.840802
Client Index = 9	Epoch: 4	Loss: 0.897305
test acc on this client after 290 / 506 : 0.57
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 10
local mask changes: 2718318.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2897614.0, 2718318.0, 2899556.0]
Doing local aggregation!
test acc on this client before 315 / 503 : 0.63
Client Index = 10	Epoch: 0	Loss: 1.053903
Client Index = 10	Epoch: 1	Loss: 0.968403
Client Index = 10	Epoch: 2	Loss: 0.945411
Client Index = 10	Epoch: 3	Loss: 0.945420
Client Index = 10	Epoch: 4	Loss: 0.905228
test acc on this client after 275 / 503 : 0.55
-----------------------------------
training flops per data 2653326336.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 11
local mask changes: 2717604.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2899438.0, 2717604.0, 2900104.0]
Doing local aggregation!
test acc on this client before 339 / 505 : 0.67
Client Index = 11	Epoch: 0	Loss: 0.755872
Client Index = 11	Epoch: 1	Loss: 0.574244
Client Index = 11	Epoch: 2	Loss: 0.565675
Client Index = 11	Epoch: 3	Loss: 0.495542
Client Index = 11	Epoch: 4	Loss: 0.663729
test acc on this client after 366 / 505 : 0.72
-----------------------------------
training flops per data 2653327872.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 12
local mask changes: 2718728.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2901686.0, 2718728.0, 2896662.0]
Doing local aggregation!
test acc on this client before 202 / 504 : 0.40
Client Index = 12	Epoch: 0	Loss: 1.035575
Client Index = 12	Epoch: 1	Loss: 0.946799
Client Index = 12	Epoch: 2	Loss: 0.967552
Client Index = 12	Epoch: 3	Loss: 0.929360
Client Index = 12	Epoch: 4	Loss: 0.926990
test acc on this client after 297 / 504 : 0.59
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 13
local mask changes: 2717858.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2898664.0, 2717858.0, 2896150.0]
Doing local aggregation!
test acc on this client before 335 / 505 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.865015
Client Index = 13	Epoch: 1	Loss: 0.825859
Client Index = 13	Epoch: 2	Loss: 0.920687
Client Index = 13	Epoch: 3	Loss: 0.799385
Client Index = 13	Epoch: 4	Loss: 0.795731
test acc on this client after 342 / 505 : 0.68
-----------------------------------
training flops per data 2653328896.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 14
local mask changes: 2719074.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2895336.0, 2719074.0, 2897336.0]
Doing local aggregation!
test acc on this client before 273 / 503 : 0.54
Client Index = 14	Epoch: 0	Loss: 0.965965
Client Index = 14	Epoch: 1	Loss: 1.030972
Client Index = 14	Epoch: 2	Loss: 0.931261
Client Index = 14	Epoch: 3	Loss: 0.885421
Client Index = 14	Epoch: 4	Loss: 0.887041
test acc on this client after 310 / 503 : 0.62
-----------------------------------
training flops per data 2653331712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 15
local mask changes: 2716954.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2894732.0, 2716954.0, 2896014.0]
Doing local aggregation!
test acc on this client before 329 / 503 : 0.65
Client Index = 15	Epoch: 0	Loss: 0.774325
Client Index = 15	Epoch: 1	Loss: 0.770012
Client Index = 15	Epoch: 2	Loss: 0.707968
Client Index = 15	Epoch: 3	Loss: 0.714179
Client Index = 15	Epoch: 4	Loss: 0.683570
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653328384.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 16
local mask changes: 2718964.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2894846.0, 2718964.0, 2899472.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 16	Epoch: 0	Loss: 0.962383
Client Index = 16	Epoch: 1	Loss: 0.802575
Client Index = 16	Epoch: 2	Loss: 0.861655
Client Index = 16	Epoch: 3	Loss: 0.795543
Client Index = 16	Epoch: 4	Loss: 0.880757
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653331456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 17
local mask changes: 2718718.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2897642.0, 2718718.0, 2904034.0]
Doing local aggregation!
test acc on this client before 246 / 503 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.147296
Client Index = 17	Epoch: 1	Loss: 1.055910
Client Index = 17	Epoch: 2	Loss: 1.015365
Client Index = 17	Epoch: 3	Loss: 1.029456
Client Index = 17	Epoch: 4	Loss: 0.972766
test acc on this client after 318 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 18
local mask changes: 2718732.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2902460.0, 2718732.0, 2897458.0]
Doing local aggregation!
test acc on this client before 306 / 503 : 0.61
Client Index = 18	Epoch: 0	Loss: 0.920099
Client Index = 18	Epoch: 1	Loss: 0.761489
Client Index = 18	Epoch: 2	Loss: 0.764850
Client Index = 18	Epoch: 3	Loss: 0.724490
Client Index = 18	Epoch: 4	Loss: 0.741428
test acc on this client after 343 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 19
local mask changes: 2717132.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2900872.0, 2901924.0, 2717132.0]
Doing local aggregation!
test acc on this client before 331 / 503 : 0.66
Client Index = 19	Epoch: 0	Loss: 0.945031
Client Index = 19	Epoch: 1	Loss: 0.791595
Client Index = 19	Epoch: 2	Loss: 0.764500
Client Index = 19	Epoch: 3	Loss: 0.768814
Client Index = 19	Epoch: 4	Loss: 0.759570
test acc on this client after 351 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.8126136890202759}
################local_test_on_all_clients after local training in communication round: 22
{'test_acc_after': 0.6696222564664132, 'test_loss_after': 1.0154783621424959}
################local_test_on_all_clients before local training in communication round: 22
{'test_acc_before': 0.613957586232241, 'test_loss_before': 1.1063656085112459}
################Communication round : 23
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 0
local mask changes: 2696600.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2696600.0, 2876744.0, 2876520.0]
Doing local aggregation!
test acc on this client before 328 / 503 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.888949
Client Index = 0	Epoch: 1	Loss: 0.817408
Client Index = 0	Epoch: 2	Loss: 0.758610
Client Index = 0	Epoch: 3	Loss: 0.785091
Client Index = 0	Epoch: 4	Loss: 0.667515
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 1
local mask changes: 2696534.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2876558.0, 2696534.0, 2876944.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 1	Epoch: 0	Loss: 0.813107
Client Index = 1	Epoch: 1	Loss: 0.581057
Client Index = 1	Epoch: 2	Loss: 0.580118
Client Index = 1	Epoch: 3	Loss: 0.501138
Client Index = 1	Epoch: 4	Loss: 0.508672
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 2
local mask changes: 2695638.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2877454.0, 2695638.0, 2880454.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.454775
Client Index = 2	Epoch: 1	Loss: 0.397409
Client Index = 2	Epoch: 2	Loss: 0.497257
Client Index = 2	Epoch: 3	Loss: 0.402119
Client Index = 2	Epoch: 4	Loss: 0.392288
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 3
local mask changes: 2697174.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2881276.0, 2697174.0, 2882198.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.646256
Client Index = 3	Epoch: 1	Loss: 0.615264
Client Index = 3	Epoch: 2	Loss: 0.668369
Client Index = 3	Epoch: 3	Loss: 0.541807
Client Index = 3	Epoch: 4	Loss: 0.629894
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 4
local mask changes: 2697298.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2882496.0, 2697298.0, 2879934.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.900573
Client Index = 4	Epoch: 1	Loss: 0.919557
Client Index = 4	Epoch: 2	Loss: 0.849093
Client Index = 4	Epoch: 3	Loss: 0.864851
Client Index = 4	Epoch: 4	Loss: 0.836521
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 5
local mask changes: 2695036.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2878322.0, 2695036.0, 2875764.0]
Doing local aggregation!
test acc on this client before 300 / 503 : 0.60
Client Index = 5	Epoch: 0	Loss: 0.889822
Client Index = 5	Epoch: 1	Loss: 0.835325
Client Index = 5	Epoch: 2	Loss: 0.761394
Client Index = 5	Epoch: 3	Loss: 0.811862
Client Index = 5	Epoch: 4	Loss: 0.734439
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 6
local mask changes: 2698108.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2877574.0, 2698108.0, 2876484.0]
Doing local aggregation!
test acc on this client before 318 / 505 : 0.63
Client Index = 6	Epoch: 0	Loss: 1.036550
Client Index = 6	Epoch: 1	Loss: 0.981106
Client Index = 6	Epoch: 2	Loss: 0.873286
Client Index = 6	Epoch: 3	Loss: 0.964374
Client Index = 6	Epoch: 4	Loss: 0.912312
test acc on this client after 279 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 7
local mask changes: 2697696.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2875068.0, 2697696.0, 2875322.0]
Doing local aggregation!
test acc on this client before 242 / 504 : 0.48
Client Index = 7	Epoch: 0	Loss: 1.131625
Client Index = 7	Epoch: 1	Loss: 1.073176
Client Index = 7	Epoch: 2	Loss: 1.059179
Client Index = 7	Epoch: 3	Loss: 1.099582
Client Index = 7	Epoch: 4	Loss: 0.968106
test acc on this client after 291 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 8
local mask changes: 2695730.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2875792.0, 2695730.0, 2878728.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.453431
Client Index = 8	Epoch: 1	Loss: 0.331931
Client Index = 8	Epoch: 2	Loss: 0.421986
Client Index = 8	Epoch: 3	Loss: 0.382171
Client Index = 8	Epoch: 4	Loss: 0.279038
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 9
local mask changes: 2695306.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2878804.0, 2695306.0, 2875278.0]
Doing local aggregation!
test acc on this client before 276 / 506 : 0.55
Client Index = 9	Epoch: 0	Loss: 0.941028
Client Index = 9	Epoch: 1	Loss: 0.940953
Client Index = 9	Epoch: 2	Loss: 0.861283
Client Index = 9	Epoch: 3	Loss: 0.797481
Client Index = 9	Epoch: 4	Loss: 0.854202
test acc on this client after 320 / 506 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 10
local mask changes: 2696362.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2875336.0, 2696362.0, 2877998.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 10	Epoch: 0	Loss: 0.959339
Client Index = 10	Epoch: 1	Loss: 0.984027
Client Index = 10	Epoch: 2	Loss: 0.946547
Client Index = 10	Epoch: 3	Loss: 0.948628
Client Index = 10	Epoch: 4	Loss: 0.877808
test acc on this client after 264 / 503 : 0.52
-----------------------------------
training flops per data 2653339136.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 11
local mask changes: 2697472.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2874122.0, 2697472.0, 2876452.0]
Doing local aggregation!
test acc on this client before 298 / 505 : 0.59
Client Index = 11	Epoch: 0	Loss: 0.722488
Client Index = 11	Epoch: 1	Loss: 0.603294
Client Index = 11	Epoch: 2	Loss: 0.605824
Client Index = 11	Epoch: 3	Loss: 0.516542
Client Index = 11	Epoch: 4	Loss: 0.516817
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 12
local mask changes: 2697386.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2877212.0, 2697386.0, 2871706.0]
Doing local aggregation!
test acc on this client before 283 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 0.981478
Client Index = 12	Epoch: 1	Loss: 0.918980
Client Index = 12	Epoch: 2	Loss: 0.968298
Client Index = 12	Epoch: 3	Loss: 0.864746
Client Index = 12	Epoch: 4	Loss: 0.871800
test acc on this client after 234 / 504 : 0.46
-----------------------------------
training flops per data 2653329408.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 13
local mask changes: 2697630.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2872660.0, 2697630.0, 2871462.0]
Doing local aggregation!
test acc on this client before 345 / 505 : 0.68
Client Index = 13	Epoch: 0	Loss: 0.929591
Client Index = 13	Epoch: 1	Loss: 0.815395
Client Index = 13	Epoch: 2	Loss: 0.870352
Client Index = 13	Epoch: 3	Loss: 0.748354
Client Index = 13	Epoch: 4	Loss: 0.720618
test acc on this client after 324 / 505 : 0.64
-----------------------------------
training flops per data 2653326336.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 14
local mask changes: 2697488.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2871392.0, 2697488.0, 2872170.0]
Doing local aggregation!
test acc on this client before 312 / 503 : 0.62
Client Index = 14	Epoch: 0	Loss: 0.937739
Client Index = 14	Epoch: 1	Loss: 0.973525
Client Index = 14	Epoch: 2	Loss: 0.933726
Client Index = 14	Epoch: 3	Loss: 0.893065
Client Index = 14	Epoch: 4	Loss: 0.877799
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653330432.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 15
local mask changes: 2697632.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2872486.0, 2697632.0, 2869970.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 15	Epoch: 0	Loss: 0.709465
Client Index = 15	Epoch: 1	Loss: 0.669108
Client Index = 15	Epoch: 2	Loss: 0.674051
Client Index = 15	Epoch: 3	Loss: 0.725777
Client Index = 15	Epoch: 4	Loss: 0.673071
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 16
local mask changes: 2697284.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2869664.0, 2697284.0, 2874162.0]
Doing local aggregation!
test acc on this client before 321 / 504 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.965326
Client Index = 16	Epoch: 1	Loss: 0.882077
Client Index = 16	Epoch: 2	Loss: 0.890790
Client Index = 16	Epoch: 3	Loss: 0.772522
Client Index = 16	Epoch: 4	Loss: 0.772395
test acc on this client after 299 / 504 : 0.59
-----------------------------------
training flops per data 2653328384.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 17
local mask changes: 2697460.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2874966.0, 2697460.0, 2877154.0]
Doing local aggregation!
test acc on this client before 247 / 503 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.045021
Client Index = 17	Epoch: 1	Loss: 1.010033
Client Index = 17	Epoch: 2	Loss: 1.028390
Client Index = 17	Epoch: 3	Loss: 1.022656
Client Index = 17	Epoch: 4	Loss: 0.919270
test acc on this client after 280 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 18
local mask changes: 2697096.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2877126.0, 2697096.0, 2872392.0]
Doing local aggregation!
test acc on this client before 311 / 503 : 0.62
Client Index = 18	Epoch: 0	Loss: 0.867579
Client Index = 18	Epoch: 1	Loss: 0.809921
Client Index = 18	Epoch: 2	Loss: 0.734870
Client Index = 18	Epoch: 3	Loss: 0.734921
Client Index = 18	Epoch: 4	Loss: 0.708344
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 19
local mask changes: 2699346.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2874646.0, 2873820.0, 2699346.0]
Doing local aggregation!
test acc on this client before 331 / 503 : 0.66
Client Index = 19	Epoch: 0	Loss: 0.875377
Client Index = 19	Epoch: 1	Loss: 0.826073
Client Index = 19	Epoch: 2	Loss: 0.792426
Client Index = 19	Epoch: 3	Loss: 0.812494
Client Index = 19	Epoch: 4	Loss: 0.730549
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.7855262948721649}
################local_test_on_all_clients after local training in communication round: 23
{'test_acc_after': 0.661586356529038, 'test_loss_after': 1.0113311160957459}
################local_test_on_all_clients before local training in communication round: 23
{'test_acc_before': 0.6301068743625287, 'test_loss_before': 1.0790509972976845}
################Communication round : 24
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 0
local mask changes: 2674012.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2674012.0, 2851342.0, 2851230.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.823821
Client Index = 0	Epoch: 1	Loss: 0.766096
Client Index = 0	Epoch: 2	Loss: 0.700230
Client Index = 0	Epoch: 3	Loss: 0.810622
Client Index = 0	Epoch: 4	Loss: 0.718790
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 1
local mask changes: 2671420.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2851768.0, 2671420.0, 2850590.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.667647
Client Index = 1	Epoch: 1	Loss: 0.552526
Client Index = 1	Epoch: 2	Loss: 0.568048
Client Index = 1	Epoch: 3	Loss: 0.538425
Client Index = 1	Epoch: 4	Loss: 0.532620
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 2
local mask changes: 2674560.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2850064.0, 2674560.0, 2855306.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.462814
Client Index = 2	Epoch: 1	Loss: 0.423018
Client Index = 2	Epoch: 2	Loss: 0.391209
Client Index = 2	Epoch: 3	Loss: 0.397433
Client Index = 2	Epoch: 4	Loss: 0.437327
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 3
local mask changes: 2675878.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2856864.0, 2675878.0, 2857362.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.730156
Client Index = 3	Epoch: 1	Loss: 0.628990
Client Index = 3	Epoch: 2	Loss: 0.602858
Client Index = 3	Epoch: 3	Loss: 0.646574
Client Index = 3	Epoch: 4	Loss: 0.532512
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 4
local mask changes: 2675652.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2858732.0, 2675652.0, 2853178.0]
Doing local aggregation!
test acc on this client before 341 / 504 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.919225
Client Index = 4	Epoch: 1	Loss: 0.826726
Client Index = 4	Epoch: 2	Loss: 0.862853
Client Index = 4	Epoch: 3	Loss: 0.753577
Client Index = 4	Epoch: 4	Loss: 0.773591
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 5
local mask changes: 2675588.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2851860.0, 2675588.0, 2851144.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 5	Epoch: 0	Loss: 0.849785
Client Index = 5	Epoch: 1	Loss: 0.781255
Client Index = 5	Epoch: 2	Loss: 0.817067
Client Index = 5	Epoch: 3	Loss: 0.753267
Client Index = 5	Epoch: 4	Loss: 0.721332
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 6
local mask changes: 2674318.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2849016.0, 2674318.0, 2849388.0]
Doing local aggregation!
test acc on this client before 299 / 505 : 0.59
Client Index = 6	Epoch: 0	Loss: 0.929846
Client Index = 6	Epoch: 1	Loss: 0.947137
Client Index = 6	Epoch: 2	Loss: 0.886687
Client Index = 6	Epoch: 3	Loss: 0.936017
Client Index = 6	Epoch: 4	Loss: 0.882764
test acc on this client after 304 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 7
local mask changes: 2673480.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2850458.0, 2673480.0, 2849432.0]
Doing local aggregation!
test acc on this client before 280 / 504 : 0.56
Client Index = 7	Epoch: 0	Loss: 1.102469
Client Index = 7	Epoch: 1	Loss: 1.065391
Client Index = 7	Epoch: 2	Loss: 0.998168
Client Index = 7	Epoch: 3	Loss: 1.007549
Client Index = 7	Epoch: 4	Loss: 1.011910
test acc on this client after 257 / 504 : 0.51
-----------------------------------
training flops per data 2653341184.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 8
local mask changes: 2674354.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2848440.0, 2674354.0, 2851960.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.599767
Client Index = 8	Epoch: 1	Loss: 0.342140
Client Index = 8	Epoch: 2	Loss: 0.318801
Client Index = 8	Epoch: 3	Loss: 0.340886
Client Index = 8	Epoch: 4	Loss: 0.277553
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 9
local mask changes: 2673922.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2854476.0, 2673922.0, 2849440.0]
Doing local aggregation!
test acc on this client before 288 / 506 : 0.57
Client Index = 9	Epoch: 0	Loss: 0.972459
Client Index = 9	Epoch: 1	Loss: 0.829339
Client Index = 9	Epoch: 2	Loss: 0.844285
Client Index = 9	Epoch: 3	Loss: 0.817031
Client Index = 9	Epoch: 4	Loss: 0.858089
test acc on this client after 348 / 506 : 0.69
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 10
local mask changes: 2675036.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2849218.0, 2675036.0, 2850644.0]
Doing local aggregation!
test acc on this client before 295 / 503 : 0.59
Client Index = 10	Epoch: 0	Loss: 1.048056
Client Index = 10	Epoch: 1	Loss: 0.931159
Client Index = 10	Epoch: 2	Loss: 0.862529
Client Index = 10	Epoch: 3	Loss: 0.953458
Client Index = 10	Epoch: 4	Loss: 0.820427
test acc on this client after 309 / 503 : 0.61
-----------------------------------
training flops per data 2653330432.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 11
local mask changes: 2673334.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2849146.0, 2673334.0, 2850042.0]
Doing local aggregation!
test acc on this client before 314 / 505 : 0.62
Client Index = 11	Epoch: 0	Loss: 0.636226
Client Index = 11	Epoch: 1	Loss: 0.584392
Client Index = 11	Epoch: 2	Loss: 0.544066
Client Index = 11	Epoch: 3	Loss: 0.510828
Client Index = 11	Epoch: 4	Loss: 0.485844
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653330432.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 12
local mask changes: 2673626.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2850508.0, 2673626.0, 2847134.0]
Doing local aggregation!
test acc on this client before 259 / 504 : 0.51
Client Index = 12	Epoch: 0	Loss: 0.958578
Client Index = 12	Epoch: 1	Loss: 0.920922
Client Index = 12	Epoch: 2	Loss: 0.927234
Client Index = 12	Epoch: 3	Loss: 0.875920
Client Index = 12	Epoch: 4	Loss: 0.885266
test acc on this client after 318 / 504 : 0.63
-----------------------------------
training flops per data 2653324032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 13
local mask changes: 2674038.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2845606.0, 2674038.0, 2846966.0]
Doing local aggregation!
test acc on this client before 329 / 505 : 0.65
Client Index = 13	Epoch: 0	Loss: 0.871871
Client Index = 13	Epoch: 1	Loss: 0.824499
Client Index = 13	Epoch: 2	Loss: 0.781738
Client Index = 13	Epoch: 3	Loss: 0.822411
Client Index = 13	Epoch: 4	Loss: 0.770767
test acc on this client after 343 / 505 : 0.68
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 14
local mask changes: 2673352.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2847412.0, 2673352.0, 2847902.0]
Doing local aggregation!
test acc on this client before 299 / 503 : 0.59
Client Index = 14	Epoch: 0	Loss: 0.929418
Client Index = 14	Epoch: 1	Loss: 0.953075
Client Index = 14	Epoch: 2	Loss: 0.885014
Client Index = 14	Epoch: 3	Loss: 0.819817
Client Index = 14	Epoch: 4	Loss: 0.953659
test acc on this client after 264 / 503 : 0.52
-----------------------------------
training flops per data 2653324288.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 15
local mask changes: 2672638.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2846492.0, 2672638.0, 2846508.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.715732
Client Index = 15	Epoch: 1	Loss: 0.714098
Client Index = 15	Epoch: 2	Loss: 0.658449
Client Index = 15	Epoch: 3	Loss: 0.667501
Client Index = 15	Epoch: 4	Loss: 0.691035
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653323264.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 16
local mask changes: 2674362.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2847184.0, 2674362.0, 2847370.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 16	Epoch: 0	Loss: 0.868902
Client Index = 16	Epoch: 1	Loss: 0.909731
Client Index = 16	Epoch: 2	Loss: 0.729354
Client Index = 16	Epoch: 3	Loss: 0.742960
Client Index = 16	Epoch: 4	Loss: 0.835655
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 17
local mask changes: 2675810.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2848780.0, 2675810.0, 2848794.0]
Doing local aggregation!
test acc on this client before 249 / 503 : 0.50
Client Index = 17	Epoch: 0	Loss: 1.038254
Client Index = 17	Epoch: 1	Loss: 1.009368
Client Index = 17	Epoch: 2	Loss: 0.991834
Client Index = 17	Epoch: 3	Loss: 0.977627
Client Index = 17	Epoch: 4	Loss: 0.875407
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 18
local mask changes: 2674186.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2851786.0, 2674186.0, 2849200.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 18	Epoch: 0	Loss: 0.865653
Client Index = 18	Epoch: 1	Loss: 0.669803
Client Index = 18	Epoch: 2	Loss: 0.757622
Client Index = 18	Epoch: 3	Loss: 0.716163
Client Index = 18	Epoch: 4	Loss: 0.747875
test acc on this client after 315 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 19
local mask changes: 2672354.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2850544.0, 2847974.0, 2672354.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.830264
Client Index = 19	Epoch: 1	Loss: 0.813984
Client Index = 19	Epoch: 2	Loss: 0.759779
Client Index = 19	Epoch: 3	Loss: 0.690665
Client Index = 19	Epoch: 4	Loss: 0.753967
test acc on this client after 334 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.765475438095629}
################local_test_on_all_clients after local training in communication round: 24
{'test_acc_after': 0.671292298415041, 'test_loss_after': 0.9930884658979128}
################local_test_on_all_clients before local training in communication round: 24
{'test_acc_before': 0.6442245624887246, 'test_loss_before': 1.0291232000906894}
################Communication round : 25
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 0
local mask changes: 2650870.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2650870.0, 2824656.0, 2825236.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.848421
Client Index = 0	Epoch: 1	Loss: 0.727618
Client Index = 0	Epoch: 2	Loss: 0.801237
Client Index = 0	Epoch: 3	Loss: 0.745000
Client Index = 0	Epoch: 4	Loss: 0.660549
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 1
local mask changes: 2650598.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2825314.0, 2650598.0, 2823822.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 1	Epoch: 0	Loss: 0.580893
Client Index = 1	Epoch: 1	Loss: 0.624316
Client Index = 1	Epoch: 2	Loss: 0.522292
Client Index = 1	Epoch: 3	Loss: 0.698704
Client Index = 1	Epoch: 4	Loss: 0.455597
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 2
local mask changes: 2651160.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2827612.0, 2651160.0, 2829108.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 2	Epoch: 0	Loss: 0.402916
Client Index = 2	Epoch: 1	Loss: 0.395587
Client Index = 2	Epoch: 2	Loss: 0.399292
Client Index = 2	Epoch: 3	Loss: 0.344190
Client Index = 2	Epoch: 4	Loss: 0.328676
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 3
local mask changes: 2649718.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2829360.0, 2649718.0, 2830836.0]
Doing local aggregation!
test acc on this client before 376 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.613650
Client Index = 3	Epoch: 1	Loss: 0.726328
Client Index = 3	Epoch: 2	Loss: 0.566366
Client Index = 3	Epoch: 3	Loss: 0.576501
Client Index = 3	Epoch: 4	Loss: 0.507089
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 4
local mask changes: 2651078.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2831798.0, 2651078.0, 2826446.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.924474
Client Index = 4	Epoch: 1	Loss: 0.815292
Client Index = 4	Epoch: 2	Loss: 0.791928
Client Index = 4	Epoch: 3	Loss: 0.954526
Client Index = 4	Epoch: 4	Loss: 0.755912
test acc on this client after 344 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 5
local mask changes: 2649994.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2828008.0, 2649994.0, 2822352.0]
Doing local aggregation!
test acc on this client before 310 / 503 : 0.62
Client Index = 5	Epoch: 0	Loss: 0.858073
Client Index = 5	Epoch: 1	Loss: 0.748843
Client Index = 5	Epoch: 2	Loss: 0.791374
Client Index = 5	Epoch: 3	Loss: 0.736939
Client Index = 5	Epoch: 4	Loss: 0.702990
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 6
local mask changes: 2651908.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2823394.0, 2651908.0, 2823918.0]
Doing local aggregation!
test acc on this client before 302 / 505 : 0.60
Client Index = 6	Epoch: 0	Loss: 1.011108
Client Index = 6	Epoch: 1	Loss: 0.839984
Client Index = 6	Epoch: 2	Loss: 0.893699
Client Index = 6	Epoch: 3	Loss: 0.877484
Client Index = 6	Epoch: 4	Loss: 0.836076
test acc on this client after 325 / 505 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 7
local mask changes: 2649866.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2822070.0, 2649866.0, 2824782.0]
Doing local aggregation!
test acc on this client before 248 / 504 : 0.49
Client Index = 7	Epoch: 0	Loss: 1.071842
Client Index = 7	Epoch: 1	Loss: 1.064413
Client Index = 7	Epoch: 2	Loss: 0.926214
Client Index = 7	Epoch: 3	Loss: 1.053122
Client Index = 7	Epoch: 4	Loss: 0.969089
test acc on this client after 259 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 8
local mask changes: 2652402.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2823148.0, 2652402.0, 2826548.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.512350
Client Index = 8	Epoch: 1	Loss: 0.362671
Client Index = 8	Epoch: 2	Loss: 0.314561
Client Index = 8	Epoch: 3	Loss: 0.262840
Client Index = 8	Epoch: 4	Loss: 0.401529
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 9
local mask changes: 2650874.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2825984.0, 2650874.0, 2822610.0]
Doing local aggregation!
test acc on this client before 278 / 506 : 0.55
Client Index = 9	Epoch: 0	Loss: 0.970051
Client Index = 9	Epoch: 1	Loss: 0.844621
Client Index = 9	Epoch: 2	Loss: 0.846785
Client Index = 9	Epoch: 3	Loss: 0.772679
Client Index = 9	Epoch: 4	Loss: 0.779423
test acc on this client after 306 / 506 : 0.60
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 10
local mask changes: 2649798.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2823574.0, 2649798.0, 2822412.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.974587
Client Index = 10	Epoch: 1	Loss: 0.941149
Client Index = 10	Epoch: 2	Loss: 0.885310
Client Index = 10	Epoch: 3	Loss: 0.886226
Client Index = 10	Epoch: 4	Loss: 0.875089
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 11
local mask changes: 2650558.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2824098.0, 2650558.0, 2827034.0]
Doing local aggregation!
test acc on this client before 302 / 505 : 0.60
Client Index = 11	Epoch: 0	Loss: 0.714147
Client Index = 11	Epoch: 1	Loss: 0.519968
Client Index = 11	Epoch: 2	Loss: 0.464610
Client Index = 11	Epoch: 3	Loss: 0.556390
Client Index = 11	Epoch: 4	Loss: 0.553556
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653325824.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 12
local mask changes: 2652490.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2824440.0, 2652490.0, 2820134.0]
Doing local aggregation!
test acc on this client before 281 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 0.979740
Client Index = 12	Epoch: 1	Loss: 0.930872
Client Index = 12	Epoch: 2	Loss: 0.856724
Client Index = 12	Epoch: 3	Loss: 0.820058
Client Index = 12	Epoch: 4	Loss: 0.897993
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 13
local mask changes: 2652380.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2821586.0, 2652380.0, 2820716.0]
Doing local aggregation!
test acc on this client before 344 / 505 : 0.68
Client Index = 13	Epoch: 0	Loss: 0.827880
Client Index = 13	Epoch: 1	Loss: 0.790307
Client Index = 13	Epoch: 2	Loss: 0.809385
Client Index = 13	Epoch: 3	Loss: 0.743265
Client Index = 13	Epoch: 4	Loss: 0.808379
test acc on this client after 344 / 505 : 0.68
-----------------------------------
training flops per data 2653318656.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 14
local mask changes: 2650016.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2820930.0, 2650016.0, 2819636.0]
Doing local aggregation!
test acc on this client before 285 / 503 : 0.57
Client Index = 14	Epoch: 0	Loss: 0.922133
Client Index = 14	Epoch: 1	Loss: 0.881472
Client Index = 14	Epoch: 2	Loss: 0.887959
Client Index = 14	Epoch: 3	Loss: 0.898331
Client Index = 14	Epoch: 4	Loss: 0.777699
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653323264.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 15
local mask changes: 2651986.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2819412.0, 2651986.0, 2820776.0]
Doing local aggregation!
test acc on this client before 358 / 503 : 0.71
Client Index = 15	Epoch: 0	Loss: 0.761997
Client Index = 15	Epoch: 1	Loss: 0.642597
Client Index = 15	Epoch: 2	Loss: 0.745754
Client Index = 15	Epoch: 3	Loss: 0.651756
Client Index = 15	Epoch: 4	Loss: 0.614904
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 16
local mask changes: 2650526.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2818004.0, 2650526.0, 2821006.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 16	Epoch: 0	Loss: 0.896204
Client Index = 16	Epoch: 1	Loss: 0.754367
Client Index = 16	Epoch: 2	Loss: 0.818615
Client Index = 16	Epoch: 3	Loss: 0.735610
Client Index = 16	Epoch: 4	Loss: 0.722778
test acc on this client after 337 / 504 : 0.67
-----------------------------------
training flops per data 2653332480.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 17
local mask changes: 2651148.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2822862.0, 2651148.0, 2825034.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.001802
Client Index = 17	Epoch: 1	Loss: 0.983749
Client Index = 17	Epoch: 2	Loss: 0.957210
Client Index = 17	Epoch: 3	Loss: 0.963682
Client Index = 17	Epoch: 4	Loss: 0.876818
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 18
local mask changes: 2651528.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2824664.0, 2651528.0, 2822994.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 18	Epoch: 0	Loss: 0.760975
Client Index = 18	Epoch: 1	Loss: 0.775109
Client Index = 18	Epoch: 2	Loss: 0.727581
Client Index = 18	Epoch: 3	Loss: 0.712641
Client Index = 18	Epoch: 4	Loss: 0.715508
test acc on this client after 283 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 19
local mask changes: 2652732.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2823462.0, 2823436.0, 2652732.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 19	Epoch: 0	Loss: 0.816396
Client Index = 19	Epoch: 1	Loss: 0.806100
Client Index = 19	Epoch: 2	Loss: 0.698875
Client Index = 19	Epoch: 3	Loss: 0.764842
Client Index = 19	Epoch: 4	Loss: 0.705326
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.7503053513243795}
################local_test_on_all_clients after local training in communication round: 25
{'test_acc_after': 0.6856866471966337, 'test_loss_after': 0.9494756273125781}
################local_test_on_all_clients before local training in communication round: 25
{'test_acc_before': 0.6430301230115603, 'test_loss_before': 1.0344673116991672}
################Communication round : 26
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 0
local mask changes: 2626014.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2626014.0, 2798498.0, 2798024.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.788307
Client Index = 0	Epoch: 1	Loss: 0.859477
Client Index = 0	Epoch: 2	Loss: 0.715538
Client Index = 0	Epoch: 3	Loss: 0.701496
Client Index = 0	Epoch: 4	Loss: 0.650016
test acc on this client after 271 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 1
local mask changes: 2626326.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2799088.0, 2626326.0, 2798910.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 1	Epoch: 0	Loss: 0.584267
Client Index = 1	Epoch: 1	Loss: 0.575352
Client Index = 1	Epoch: 2	Loss: 0.509728
Client Index = 1	Epoch: 3	Loss: 0.499767
Client Index = 1	Epoch: 4	Loss: 0.467819
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 2
local mask changes: 2626426.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2797170.0, 2626426.0, 2801840.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.439752
Client Index = 2	Epoch: 1	Loss: 0.365210
Client Index = 2	Epoch: 2	Loss: 0.391490
Client Index = 2	Epoch: 3	Loss: 0.324148
Client Index = 2	Epoch: 4	Loss: 0.345679
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 3
local mask changes: 2624792.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2803460.0, 2624792.0, 2803646.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.548983
Client Index = 3	Epoch: 1	Loss: 0.699796
Client Index = 3	Epoch: 2	Loss: 0.503189
Client Index = 3	Epoch: 3	Loss: 0.514897
Client Index = 3	Epoch: 4	Loss: 0.586725
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 4
local mask changes: 2626654.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2804488.0, 2626654.0, 2800950.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.828707
Client Index = 4	Epoch: 1	Loss: 0.886838
Client Index = 4	Epoch: 2	Loss: 0.812769
Client Index = 4	Epoch: 3	Loss: 0.770509
Client Index = 4	Epoch: 4	Loss: 0.706733
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 5
local mask changes: 2625280.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2799952.0, 2625280.0, 2797438.0]
Doing local aggregation!
test acc on this client before 315 / 503 : 0.63
Client Index = 5	Epoch: 0	Loss: 0.842256
Client Index = 5	Epoch: 1	Loss: 0.700894
Client Index = 5	Epoch: 2	Loss: 0.767967
Client Index = 5	Epoch: 3	Loss: 0.724948
Client Index = 5	Epoch: 4	Loss: 0.694666
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 6
local mask changes: 2626824.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2796284.0, 2626824.0, 2797230.0]
Doing local aggregation!
test acc on this client before 321 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.907497
Client Index = 6	Epoch: 1	Loss: 0.838781
Client Index = 6	Epoch: 2	Loss: 0.889077
Client Index = 6	Epoch: 3	Loss: 0.854587
Client Index = 6	Epoch: 4	Loss: 0.797707
test acc on this client after 343 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 7
local mask changes: 2624912.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2796664.0, 2624912.0, 2797266.0]
Doing local aggregation!
test acc on this client before 239 / 504 : 0.47
Client Index = 7	Epoch: 0	Loss: 1.070215
Client Index = 7	Epoch: 1	Loss: 1.073505
Client Index = 7	Epoch: 2	Loss: 0.918384
Client Index = 7	Epoch: 3	Loss: 1.031835
Client Index = 7	Epoch: 4	Loss: 0.908672
test acc on this client after 245 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 8
local mask changes: 2625736.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2796744.0, 2625736.0, 2800078.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.398454
Client Index = 8	Epoch: 1	Loss: 0.305245
Client Index = 8	Epoch: 2	Loss: 0.299967
Client Index = 8	Epoch: 3	Loss: 0.294241
Client Index = 8	Epoch: 4	Loss: 0.259836
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 9
local mask changes: 2627472.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2799636.0, 2627472.0, 2796500.0]
Doing local aggregation!
test acc on this client before 254 / 506 : 0.50
Client Index = 9	Epoch: 0	Loss: 0.907347
Client Index = 9	Epoch: 1	Loss: 0.845781
Client Index = 9	Epoch: 2	Loss: 0.818842
Client Index = 9	Epoch: 3	Loss: 0.832640
Client Index = 9	Epoch: 4	Loss: 0.747998
test acc on this client after 314 / 506 : 0.62
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 10
local mask changes: 2625944.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2795996.0, 2625944.0, 2798032.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 10	Epoch: 0	Loss: 0.925030
Client Index = 10	Epoch: 1	Loss: 0.904649
Client Index = 10	Epoch: 2	Loss: 0.827290
Client Index = 10	Epoch: 3	Loss: 0.835286
Client Index = 10	Epoch: 4	Loss: 0.873493
test acc on this client after 326 / 503 : 0.65
-----------------------------------
training flops per data 2653332480.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 11
local mask changes: 2626530.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2796570.0, 2626530.0, 2797256.0]
Doing local aggregation!
test acc on this client before 305 / 505 : 0.60
Client Index = 11	Epoch: 0	Loss: 0.599922
Client Index = 11	Epoch: 1	Loss: 0.518875
Client Index = 11	Epoch: 2	Loss: 0.596849
Client Index = 11	Epoch: 3	Loss: 0.550001
Client Index = 11	Epoch: 4	Loss: 0.406977
test acc on this client after 398 / 505 : 0.79
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 12
local mask changes: 2627290.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2800208.0, 2627290.0, 2793294.0]
Doing local aggregation!
test acc on this client before 273 / 504 : 0.54
Client Index = 12	Epoch: 0	Loss: 0.956203
Client Index = 12	Epoch: 1	Loss: 0.867417
Client Index = 12	Epoch: 2	Loss: 0.905863
Client Index = 12	Epoch: 3	Loss: 0.818845
Client Index = 12	Epoch: 4	Loss: 0.898816
test acc on this client after 341 / 504 : 0.68
-----------------------------------
training flops per data 2653321216.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 13
local mask changes: 2629076.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2793534.0, 2629076.0, 2793106.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 13	Epoch: 0	Loss: 0.846242
Client Index = 13	Epoch: 1	Loss: 0.761198
Client Index = 13	Epoch: 2	Loss: 0.748754
Client Index = 13	Epoch: 3	Loss: 0.721380
Client Index = 13	Epoch: 4	Loss: 0.735977
test acc on this client after 355 / 505 : 0.70
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 14
local mask changes: 2627624.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2793694.0, 2627624.0, 2793334.0]
Doing local aggregation!
test acc on this client before 307 / 503 : 0.61
Client Index = 14	Epoch: 0	Loss: 0.884247
Client Index = 14	Epoch: 1	Loss: 0.926974
Client Index = 14	Epoch: 2	Loss: 0.845982
Client Index = 14	Epoch: 3	Loss: 0.820345
Client Index = 14	Epoch: 4	Loss: 0.820926
test acc on this client after 274 / 503 : 0.54
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 15
local mask changes: 2626102.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2794678.0, 2626102.0, 2792426.0]
Doing local aggregation!
test acc on this client before 375 / 503 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.706201
Client Index = 15	Epoch: 1	Loss: 0.629214
Client Index = 15	Epoch: 2	Loss: 0.616927
Client Index = 15	Epoch: 3	Loss: 0.614890
Client Index = 15	Epoch: 4	Loss: 0.629015
test acc on this client after 296 / 503 : 0.59
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 16
local mask changes: 2626998.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2792122.0, 2626998.0, 2795832.0]
Doing local aggregation!
test acc on this client before 321 / 504 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.906174
Client Index = 16	Epoch: 1	Loss: 0.769251
Client Index = 16	Epoch: 2	Loss: 0.676794
Client Index = 16	Epoch: 3	Loss: 0.816067
Client Index = 16	Epoch: 4	Loss: 0.713512
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653326336.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 17
local mask changes: 2627152.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2794980.0, 2627152.0, 2797552.0]
Doing local aggregation!
test acc on this client before 269 / 503 : 0.53
Client Index = 17	Epoch: 0	Loss: 1.038440
Client Index = 17	Epoch: 1	Loss: 1.028706
Client Index = 17	Epoch: 2	Loss: 0.871459
Client Index = 17	Epoch: 3	Loss: 0.984251
Client Index = 17	Epoch: 4	Loss: 0.894882
test acc on this client after 290 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 18
local mask changes: 2627366.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2799482.0, 2627366.0, 2796472.0]
Doing local aggregation!
test acc on this client before 292 / 503 : 0.58
Client Index = 18	Epoch: 0	Loss: 0.714999
Client Index = 18	Epoch: 1	Loss: 0.736777
Client Index = 18	Epoch: 2	Loss: 0.683406
Client Index = 18	Epoch: 3	Loss: 0.706072
Client Index = 18	Epoch: 4	Loss: 0.701258
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 19
local mask changes: 2625366.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2793510.0, 2797364.0, 2625366.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 19	Epoch: 0	Loss: 0.791097
Client Index = 19	Epoch: 1	Loss: 0.773293
Client Index = 19	Epoch: 2	Loss: 0.681384
Client Index = 19	Epoch: 3	Loss: 0.655871
Client Index = 19	Epoch: 4	Loss: 0.681974
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.7242798454985023}
################local_test_on_all_clients after local training in communication round: 26
{'test_acc_after': 0.6696819211544656, 'test_loss_after': 1.0312411487593882}
################local_test_on_all_clients before local training in communication round: 26
{'test_acc_before': 0.6475004995128015, 'test_loss_before': 1.0077522907698058}
################Communication round : 27
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 0
local mask changes: 2601294.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2601294.0, 2771030.0, 2770264.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 0	Epoch: 0	Loss: 0.827283
Client Index = 0	Epoch: 1	Loss: 0.690793
Client Index = 0	Epoch: 2	Loss: 0.682612
Client Index = 0	Epoch: 3	Loss: 0.740581
Client Index = 0	Epoch: 4	Loss: 0.649089
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 1
local mask changes: 2601120.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2770026.0, 2601120.0, 2770148.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.715310
Client Index = 1	Epoch: 1	Loss: 0.515085
Client Index = 1	Epoch: 2	Loss: 0.476662
Client Index = 1	Epoch: 3	Loss: 0.460105
Client Index = 1	Epoch: 4	Loss: 0.582787
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 2
local mask changes: 2601106.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2770494.0, 2601106.0, 2775180.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.400240
Client Index = 2	Epoch: 1	Loss: 0.329180
Client Index = 2	Epoch: 2	Loss: 0.365781
Client Index = 2	Epoch: 3	Loss: 0.593594
Client Index = 2	Epoch: 4	Loss: 0.344869
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 3
local mask changes: 2602156.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2774000.0, 2602156.0, 2774566.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.626692
Client Index = 3	Epoch: 1	Loss: 0.805303
Client Index = 3	Epoch: 2	Loss: 0.544517
Client Index = 3	Epoch: 3	Loss: 0.592563
Client Index = 3	Epoch: 4	Loss: 0.449421
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 4
local mask changes: 2601332.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2774206.0, 2601332.0, 2773580.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.842042
Client Index = 4	Epoch: 1	Loss: 0.791261
Client Index = 4	Epoch: 2	Loss: 0.801237
Client Index = 4	Epoch: 3	Loss: 0.724191
Client Index = 4	Epoch: 4	Loss: 0.670732
test acc on this client after 324 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 5
local mask changes: 2600390.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2771214.0, 2600390.0, 2770906.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.831682
Client Index = 5	Epoch: 1	Loss: 0.707077
Client Index = 5	Epoch: 2	Loss: 0.740662
Client Index = 5	Epoch: 3	Loss: 0.668906
Client Index = 5	Epoch: 4	Loss: 0.784291
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 6
local mask changes: 2600210.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2770660.0, 2600210.0, 2771872.0]
Doing local aggregation!
test acc on this client before 295 / 505 : 0.58
Client Index = 6	Epoch: 0	Loss: 0.864214
Client Index = 6	Epoch: 1	Loss: 0.863608
Client Index = 6	Epoch: 2	Loss: 0.855125
Client Index = 6	Epoch: 3	Loss: 0.898375
Client Index = 6	Epoch: 4	Loss: 0.861551
test acc on this client after 317 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 7
local mask changes: 2602088.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2771118.0, 2602088.0, 2768126.0]
Doing local aggregation!
test acc on this client before 246 / 504 : 0.49
Client Index = 7	Epoch: 0	Loss: 1.050204
Client Index = 7	Epoch: 1	Loss: 0.996138
Client Index = 7	Epoch: 2	Loss: 1.027703
Client Index = 7	Epoch: 3	Loss: 0.895138
Client Index = 7	Epoch: 4	Loss: 0.919577
test acc on this client after 294 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 8
local mask changes: 2601450.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2768304.0, 2601450.0, 2771716.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 0.422216
Client Index = 8	Epoch: 1	Loss: 0.265250
Client Index = 8	Epoch: 2	Loss: 0.298006
Client Index = 8	Epoch: 3	Loss: 0.460616
Client Index = 8	Epoch: 4	Loss: 0.292703
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 9
local mask changes: 2600956.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2772058.0, 2600956.0, 2770382.0]
Doing local aggregation!
test acc on this client before 281 / 506 : 0.56
Client Index = 9	Epoch: 0	Loss: 0.890873
Client Index = 9	Epoch: 1	Loss: 0.840468
Client Index = 9	Epoch: 2	Loss: 0.793743
Client Index = 9	Epoch: 3	Loss: 0.777942
Client Index = 9	Epoch: 4	Loss: 0.718050
test acc on this client after 311 / 506 : 0.61
-----------------------------------
training flops per data 2653338112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 10
local mask changes: 2602152.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2769238.0, 2602152.0, 2770404.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.963122
Client Index = 10	Epoch: 1	Loss: 0.833139
Client Index = 10	Epoch: 2	Loss: 0.868704
Client Index = 10	Epoch: 3	Loss: 0.792008
Client Index = 10	Epoch: 4	Loss: 0.821217
test acc on this client after 324 / 503 : 0.64
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 11
local mask changes: 2602362.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2770798.0, 2602362.0, 2769586.0]
Doing local aggregation!
test acc on this client before 324 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.703842
Client Index = 11	Epoch: 1	Loss: 0.498631
Client Index = 11	Epoch: 2	Loss: 0.463741
Client Index = 11	Epoch: 3	Loss: 0.534150
Client Index = 11	Epoch: 4	Loss: 0.431647
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653326336.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 12
local mask changes: 2601858.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2771134.0, 2601858.0, 2767348.0]
Doing local aggregation!
test acc on this client before 280 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 0.912262
Client Index = 12	Epoch: 1	Loss: 0.794941
Client Index = 12	Epoch: 2	Loss: 0.852779
Client Index = 12	Epoch: 3	Loss: 0.847398
Client Index = 12	Epoch: 4	Loss: 0.749149
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653325568.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 13
local mask changes: 2602126.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2764680.0, 2602126.0, 2766922.0]
Doing local aggregation!
test acc on this client before 368 / 505 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.765513
Client Index = 13	Epoch: 1	Loss: 0.713562
Client Index = 13	Epoch: 2	Loss: 0.738281
Client Index = 13	Epoch: 3	Loss: 0.742666
Client Index = 13	Epoch: 4	Loss: 0.637714
test acc on this client after 361 / 505 : 0.71
-----------------------------------
training flops per data 2653324288.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 14
local mask changes: 2602664.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2767438.0, 2602664.0, 2766356.0]
Doing local aggregation!
test acc on this client before 310 / 503 : 0.62
Client Index = 14	Epoch: 0	Loss: 0.891458
Client Index = 14	Epoch: 1	Loss: 0.800846
Client Index = 14	Epoch: 2	Loss: 0.817606
Client Index = 14	Epoch: 3	Loss: 0.796789
Client Index = 14	Epoch: 4	Loss: 0.816469
test acc on this client after 247 / 503 : 0.49
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 15
local mask changes: 2601424.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2767972.0, 2601424.0, 2766034.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.661847
Client Index = 15	Epoch: 1	Loss: 0.713039
Client Index = 15	Epoch: 2	Loss: 0.609348
Client Index = 15	Epoch: 3	Loss: 0.618714
Client Index = 15	Epoch: 4	Loss: 0.614997
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653323776.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 16
local mask changes: 2602598.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2767190.0, 2602598.0, 2768032.0]
Doing local aggregation!
test acc on this client before 322 / 504 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.829814
Client Index = 16	Epoch: 1	Loss: 0.743065
Client Index = 16	Epoch: 2	Loss: 0.683635
Client Index = 16	Epoch: 3	Loss: 0.798055
Client Index = 16	Epoch: 4	Loss: 0.771655
test acc on this client after 285 / 504 : 0.57
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 17
local mask changes: 2600434.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2768274.0, 2600434.0, 2770608.0]
Doing local aggregation!
test acc on this client before 275 / 503 : 0.55
Client Index = 17	Epoch: 0	Loss: 0.967144
Client Index = 17	Epoch: 1	Loss: 0.923279
Client Index = 17	Epoch: 2	Loss: 0.931635
Client Index = 17	Epoch: 3	Loss: 0.861583
Client Index = 17	Epoch: 4	Loss: 0.885971
test acc on this client after 293 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 18
local mask changes: 2600084.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2773018.0, 2600084.0, 2769894.0]
Doing local aggregation!
test acc on this client before 323 / 503 : 0.64
Client Index = 18	Epoch: 0	Loss: 0.785269
Client Index = 18	Epoch: 1	Loss: 0.701634
Client Index = 18	Epoch: 2	Loss: 0.631627
Client Index = 18	Epoch: 3	Loss: 0.598842
Client Index = 18	Epoch: 4	Loss: 0.596711
test acc on this client after 315 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 19
local mask changes: 2601084.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2771092.0, 2769188.0, 2601084.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 19	Epoch: 0	Loss: 0.797847
Client Index = 19	Epoch: 1	Loss: 0.740095
Client Index = 19	Epoch: 2	Loss: 0.722097
Client Index = 19	Epoch: 3	Loss: 0.775899
Client Index = 19	Epoch: 4	Loss: 0.687659
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.7138513983674347}
################local_test_on_all_clients after local training in communication round: 27
{'test_acc_after': 0.6835037216244623, 'test_loss_after': 0.9837526501071814}
################local_test_on_all_clients before local training in communication round: 27
{'test_acc_before': 0.6524646251314931, 'test_loss_before': 1.0198516272209315}
################Communication round : 28
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 0
local mask changes: 2573438.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2573438.0, 2742672.0, 2743364.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.809634
Client Index = 0	Epoch: 1	Loss: 0.652688
Client Index = 0	Epoch: 2	Loss: 0.696592
Client Index = 0	Epoch: 3	Loss: 0.628299
Client Index = 0	Epoch: 4	Loss: 0.661957
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 1
local mask changes: 2576224.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2743924.0, 2576224.0, 2741426.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.606040
Client Index = 1	Epoch: 1	Loss: 0.476391
Client Index = 1	Epoch: 2	Loss: 0.527331
Client Index = 1	Epoch: 3	Loss: 0.446689
Client Index = 1	Epoch: 4	Loss: 0.436070
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 2
local mask changes: 2576780.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2743712.0, 2576780.0, 2745098.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.382926
Client Index = 2	Epoch: 1	Loss: 0.349482
Client Index = 2	Epoch: 2	Loss: 0.377481
Client Index = 2	Epoch: 3	Loss: 0.344954
Client Index = 2	Epoch: 4	Loss: 0.308297
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 3
local mask changes: 2576316.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2745656.0, 2576316.0, 2746456.0]
Doing local aggregation!
test acc on this client before 373 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.563851
Client Index = 3	Epoch: 1	Loss: 0.609386
Client Index = 3	Epoch: 2	Loss: 0.598417
Client Index = 3	Epoch: 3	Loss: 0.488230
Client Index = 3	Epoch: 4	Loss: 0.512871
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 4
local mask changes: 2574958.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2746602.0, 2574958.0, 2743966.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.855120
Client Index = 4	Epoch: 1	Loss: 0.692500
Client Index = 4	Epoch: 2	Loss: 0.780800
Client Index = 4	Epoch: 3	Loss: 0.723129
Client Index = 4	Epoch: 4	Loss: 0.676885
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 5
local mask changes: 2574992.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2743542.0, 2574992.0, 2743944.0]
Doing local aggregation!
test acc on this client before 320 / 503 : 0.64
Client Index = 5	Epoch: 0	Loss: 0.823724
Client Index = 5	Epoch: 1	Loss: 0.718932
Client Index = 5	Epoch: 2	Loss: 0.695689
Client Index = 5	Epoch: 3	Loss: 0.743693
Client Index = 5	Epoch: 4	Loss: 0.641272
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 6
local mask changes: 2575372.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2741302.0, 2575372.0, 2742416.0]
Doing local aggregation!
test acc on this client before 313 / 505 : 0.62
Client Index = 6	Epoch: 0	Loss: 0.785758
Client Index = 6	Epoch: 1	Loss: 0.917270
Client Index = 6	Epoch: 2	Loss: 0.817104
Client Index = 6	Epoch: 3	Loss: 0.732285
Client Index = 6	Epoch: 4	Loss: 0.988718
test acc on this client after 343 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 7
local mask changes: 2575148.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2741540.0, 2575148.0, 2740458.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 7	Epoch: 0	Loss: 1.067222
Client Index = 7	Epoch: 1	Loss: 0.945548
Client Index = 7	Epoch: 2	Loss: 0.961395
Client Index = 7	Epoch: 3	Loss: 0.968070
Client Index = 7	Epoch: 4	Loss: 0.924319
test acc on this client after 248 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 8
local mask changes: 2574052.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2739320.0, 2574052.0, 2744668.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.421816
Client Index = 8	Epoch: 1	Loss: 0.249762
Client Index = 8	Epoch: 2	Loss: 0.301226
Client Index = 8	Epoch: 3	Loss: 0.239652
Client Index = 8	Epoch: 4	Loss: 0.327374
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 9
local mask changes: 2576122.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2746010.0, 2576122.0, 2742418.0]
Doing local aggregation!
test acc on this client before 278 / 506 : 0.55
Client Index = 9	Epoch: 0	Loss: 0.854374
Client Index = 9	Epoch: 1	Loss: 0.828348
Client Index = 9	Epoch: 2	Loss: 0.773871
Client Index = 9	Epoch: 3	Loss: 0.761548
Client Index = 9	Epoch: 4	Loss: 0.744559
test acc on this client after 332 / 506 : 0.66
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 10
local mask changes: 2573956.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2740518.0, 2573956.0, 2741122.0]
Doing local aggregation!
test acc on this client before 328 / 503 : 0.65
Client Index = 10	Epoch: 0	Loss: 0.915938
Client Index = 10	Epoch: 1	Loss: 0.829502
Client Index = 10	Epoch: 2	Loss: 0.864859
Client Index = 10	Epoch: 3	Loss: 0.815945
Client Index = 10	Epoch: 4	Loss: 0.777227
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653329408.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 11
local mask changes: 2577112.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2742072.0, 2577112.0, 2743322.0]
Doing local aggregation!
test acc on this client before 321 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.712108
Client Index = 11	Epoch: 1	Loss: 0.428354
Client Index = 11	Epoch: 2	Loss: 0.487774
Client Index = 11	Epoch: 3	Loss: 0.474611
Client Index = 11	Epoch: 4	Loss: 0.392210
test acc on this client after 385 / 505 : 0.76
-----------------------------------
training flops per data 2653299456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 12
local mask changes: 2576664.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2741984.0, 2576664.0, 2739486.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.892683
Client Index = 12	Epoch: 1	Loss: 0.799806
Client Index = 12	Epoch: 2	Loss: 0.827348
Client Index = 12	Epoch: 3	Loss: 0.779264
Client Index = 12	Epoch: 4	Loss: 0.781302
test acc on this client after 323 / 504 : 0.64
-----------------------------------
training flops per data 2653319680.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 13
local mask changes: 2576818.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2739502.0, 2576818.0, 2735852.0]
Doing local aggregation!
test acc on this client before 362 / 505 : 0.72
Client Index = 13	Epoch: 0	Loss: 0.817362
Client Index = 13	Epoch: 1	Loss: 0.739644
Client Index = 13	Epoch: 2	Loss: 0.729716
Client Index = 13	Epoch: 3	Loss: 0.685545
Client Index = 13	Epoch: 4	Loss: 0.700916
test acc on this client after 326 / 505 : 0.65
-----------------------------------
training flops per data 2653317120.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 14
local mask changes: 2574886.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2739220.0, 2574886.0, 2738246.0]
Doing local aggregation!
test acc on this client before 297 / 503 : 0.59
Client Index = 14	Epoch: 0	Loss: 0.869535
Client Index = 14	Epoch: 1	Loss: 0.796604
Client Index = 14	Epoch: 2	Loss: 0.824966
Client Index = 14	Epoch: 3	Loss: 0.765866
Client Index = 14	Epoch: 4	Loss: 0.804565
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653319680.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 15
local mask changes: 2576568.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2738112.0, 2576568.0, 2738268.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.653012
Client Index = 15	Epoch: 1	Loss: 0.716228
Client Index = 15	Epoch: 2	Loss: 0.599958
Client Index = 15	Epoch: 3	Loss: 0.598437
Client Index = 15	Epoch: 4	Loss: 0.569575
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653319680.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 16
local mask changes: 2575298.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2737402.0, 2575298.0, 2738844.0]
Doing local aggregation!
test acc on this client before 322 / 504 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.784969
Client Index = 16	Epoch: 1	Loss: 0.706406
Client Index = 16	Epoch: 2	Loss: 0.781450
Client Index = 16	Epoch: 3	Loss: 0.688747
Client Index = 16	Epoch: 4	Loss: 0.720836
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653328896.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 17
local mask changes: 2575984.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2739670.0, 2575984.0, 2742994.0]
Doing local aggregation!
test acc on this client before 258 / 503 : 0.51
Client Index = 17	Epoch: 0	Loss: 1.031200
Client Index = 17	Epoch: 1	Loss: 0.947843
Client Index = 17	Epoch: 2	Loss: 0.883207
Client Index = 17	Epoch: 3	Loss: 0.868591
Client Index = 17	Epoch: 4	Loss: 0.822720
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 18
local mask changes: 2576310.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2742580.0, 2576310.0, 2737166.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 18	Epoch: 0	Loss: 0.709048
Client Index = 18	Epoch: 1	Loss: 0.633675
Client Index = 18	Epoch: 2	Loss: 0.794487
Client Index = 18	Epoch: 3	Loss: 0.610673
Client Index = 18	Epoch: 4	Loss: 0.671739
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 19
local mask changes: 2576104.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2741694.0, 2741542.0, 2576104.0]
Doing local aggregation!
test acc on this client before 318 / 503 : 0.63
Client Index = 19	Epoch: 0	Loss: 0.727360
Client Index = 19	Epoch: 1	Loss: 0.701458
Client Index = 19	Epoch: 2	Loss: 0.813772
Client Index = 19	Epoch: 3	Loss: 0.662027
Client Index = 19	Epoch: 4	Loss: 0.624111
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.6927472463846207}
################local_test_on_all_clients after local training in communication round: 28
{'test_acc_after': 0.6842088561914857, 'test_loss_after': 0.9516317850746517}
################local_test_on_all_clients before local training in communication round: 28
{'test_acc_before': 0.6576132966086701, 'test_loss_before': 0.9930040371701632}
################Communication round : 29
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 0
local mask changes: 2549696.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2549696.0, 2711894.0, 2711142.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.799072
Client Index = 0	Epoch: 1	Loss: 0.644269
Client Index = 0	Epoch: 2	Loss: 0.645456
Client Index = 0	Epoch: 3	Loss: 0.613777
Client Index = 0	Epoch: 4	Loss: 0.696285
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 1
local mask changes: 2546298.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2714096.0, 2546298.0, 2712856.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.582505
Client Index = 1	Epoch: 1	Loss: 0.451533
Client Index = 1	Epoch: 2	Loss: 0.516589
Client Index = 1	Epoch: 3	Loss: 0.389174
Client Index = 1	Epoch: 4	Loss: 0.588451
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 2
local mask changes: 2550272.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2714844.0, 2550272.0, 2715732.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.343144
Client Index = 2	Epoch: 1	Loss: 0.343169
Client Index = 2	Epoch: 2	Loss: 0.348800
Client Index = 2	Epoch: 3	Loss: 0.294150
Client Index = 2	Epoch: 4	Loss: 0.355926
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 3
local mask changes: 2548660.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2716210.0, 2548660.0, 2718364.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.659917
Client Index = 3	Epoch: 1	Loss: 0.476590
Client Index = 3	Epoch: 2	Loss: 0.505515
Client Index = 3	Epoch: 3	Loss: 0.484837
Client Index = 3	Epoch: 4	Loss: 0.447471
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 4
local mask changes: 2549272.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2719958.0, 2549272.0, 2716092.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.814648
Client Index = 4	Epoch: 1	Loss: 0.722532
Client Index = 4	Epoch: 2	Loss: 0.621966
Client Index = 4	Epoch: 3	Loss: 0.693004
Client Index = 4	Epoch: 4	Loss: 0.695732
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 5
local mask changes: 2548620.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2715276.0, 2548620.0, 2716434.0]
Doing local aggregation!
test acc on this client before 338 / 503 : 0.67
Client Index = 5	Epoch: 0	Loss: 0.799340
Client Index = 5	Epoch: 1	Loss: 0.666596
Client Index = 5	Epoch: 2	Loss: 0.625151
Client Index = 5	Epoch: 3	Loss: 0.640410
Client Index = 5	Epoch: 4	Loss: 0.639221
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 6
local mask changes: 2548342.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2714048.0, 2548342.0, 2713134.0]
Doing local aggregation!
test acc on this client before 322 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.871853
Client Index = 6	Epoch: 1	Loss: 0.895906
Client Index = 6	Epoch: 2	Loss: 0.792256
Client Index = 6	Epoch: 3	Loss: 0.745468
Client Index = 6	Epoch: 4	Loss: 0.713882
test acc on this client after 342 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 7
local mask changes: 2548690.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2714766.0, 2548690.0, 2712780.0]
Doing local aggregation!
test acc on this client before 250 / 504 : 0.50
Client Index = 7	Epoch: 0	Loss: 0.960195
Client Index = 7	Epoch: 1	Loss: 1.069504
Client Index = 7	Epoch: 2	Loss: 0.940806
Client Index = 7	Epoch: 3	Loss: 0.953836
Client Index = 7	Epoch: 4	Loss: 0.898258
test acc on this client after 289 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 8
local mask changes: 2546940.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2713662.0, 2546940.0, 2712726.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.399641
Client Index = 8	Epoch: 1	Loss: 0.282104
Client Index = 8	Epoch: 2	Loss: 0.255563
Client Index = 8	Epoch: 3	Loss: 0.254554
Client Index = 8	Epoch: 4	Loss: 0.419577
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 9
local mask changes: 2549958.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2714182.0, 2549958.0, 2713796.0]
Doing local aggregation!
test acc on this client before 276 / 506 : 0.55
Client Index = 9	Epoch: 0	Loss: 0.895535
Client Index = 9	Epoch: 1	Loss: 0.732481
Client Index = 9	Epoch: 2	Loss: 0.758220
Client Index = 9	Epoch: 3	Loss: 0.745635
Client Index = 9	Epoch: 4	Loss: 0.740709
test acc on this client after 323 / 506 : 0.64
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 10
local mask changes: 2548504.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2713298.0, 2548504.0, 2713138.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.872686
Client Index = 10	Epoch: 1	Loss: 0.908494
Client Index = 10	Epoch: 2	Loss: 0.775246
Client Index = 10	Epoch: 3	Loss: 0.794538
Client Index = 10	Epoch: 4	Loss: 0.773677
test acc on this client after 324 / 503 : 0.64
-----------------------------------
training flops per data 2653324288.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 11
local mask changes: 2548164.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2715094.0, 2548164.0, 2713354.0]
Doing local aggregation!
test acc on this client before 316 / 505 : 0.63
Client Index = 11	Epoch: 0	Loss: 0.636960
Client Index = 11	Epoch: 1	Loss: 0.499438
Client Index = 11	Epoch: 2	Loss: 0.413126
Client Index = 11	Epoch: 3	Loss: 0.424185
Client Index = 11	Epoch: 4	Loss: 0.380259
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653296640.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 12
local mask changes: 2548658.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2713172.0, 2548658.0, 2709642.0]
Doing local aggregation!
test acc on this client before 302 / 504 : 0.60
Client Index = 12	Epoch: 0	Loss: 0.932127
Client Index = 12	Epoch: 1	Loss: 0.825696
Client Index = 12	Epoch: 2	Loss: 0.766590
Client Index = 12	Epoch: 3	Loss: 0.726706
Client Index = 12	Epoch: 4	Loss: 0.791446
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653312000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 13
local mask changes: 2550814.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2709744.0, 2550814.0, 2711394.0]
Doing local aggregation!
test acc on this client before 348 / 505 : 0.69
Client Index = 13	Epoch: 0	Loss: 0.750078
Client Index = 13	Epoch: 1	Loss: 0.776978
Client Index = 13	Epoch: 2	Loss: 0.693352
Client Index = 13	Epoch: 3	Loss: 0.637841
Client Index = 13	Epoch: 4	Loss: 0.725746
test acc on this client after 349 / 505 : 0.69
-----------------------------------
training flops per data 2653320192.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 14
local mask changes: 2548326.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2712170.0, 2548326.0, 2710410.0]
Doing local aggregation!
test acc on this client before 306 / 503 : 0.61
Client Index = 14	Epoch: 0	Loss: 0.796394
Client Index = 14	Epoch: 1	Loss: 0.835226
Client Index = 14	Epoch: 2	Loss: 0.739428
Client Index = 14	Epoch: 3	Loss: 0.815963
Client Index = 14	Epoch: 4	Loss: 0.720649
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653315072.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 15
local mask changes: 2546850.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2710974.0, 2546850.0, 2709676.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 15	Epoch: 0	Loss: 0.685801
Client Index = 15	Epoch: 1	Loss: 0.575265
Client Index = 15	Epoch: 2	Loss: 0.589219
Client Index = 15	Epoch: 3	Loss: 0.594216
Client Index = 15	Epoch: 4	Loss: 0.568370
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653322240.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 16
local mask changes: 2546808.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2708504.0, 2546808.0, 2711350.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.772218
Client Index = 16	Epoch: 1	Loss: 0.736148
Client Index = 16	Epoch: 2	Loss: 0.682561
Client Index = 16	Epoch: 3	Loss: 0.725395
Client Index = 16	Epoch: 4	Loss: 0.649868
test acc on this client after 311 / 504 : 0.62
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 17
local mask changes: 2549826.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2710584.0, 2549826.0, 2715014.0]
Doing local aggregation!
test acc on this client before 257 / 503 : 0.51
Client Index = 17	Epoch: 0	Loss: 0.985020
Client Index = 17	Epoch: 1	Loss: 0.833079
Client Index = 17	Epoch: 2	Loss: 0.930994
Client Index = 17	Epoch: 3	Loss: 0.849558
Client Index = 17	Epoch: 4	Loss: 0.871277
test acc on this client after 334 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 18
local mask changes: 2546698.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2712884.0, 2546698.0, 2713606.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 18	Epoch: 0	Loss: 0.739485
Client Index = 18	Epoch: 1	Loss: 0.639060
Client Index = 18	Epoch: 2	Loss: 0.645708
Client Index = 18	Epoch: 3	Loss: 0.588739
Client Index = 18	Epoch: 4	Loss: 0.560482
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 19
local mask changes: 2548820.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2713518.0, 2710874.0, 2548820.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 19	Epoch: 0	Loss: 0.742304
Client Index = 19	Epoch: 1	Loss: 0.696327
Client Index = 19	Epoch: 2	Loss: 0.724812
Client Index = 19	Epoch: 3	Loss: 0.622481
Client Index = 19	Epoch: 4	Loss: 0.686840
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.6713926731944084}
################local_test_on_all_clients after local training in communication round: 29
{'test_acc_after': 0.7012772923085253, 'test_loss_after': 0.9131489596417696}
################local_test_on_all_clients before local training in communication round: 29
{'test_acc_before': 0.6649725018298479, 'test_loss_before': 0.9929702521968059}
################Communication round : 30
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 0
local mask changes: 2519654.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2519654.0, 2684448.0, 2685784.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.700228
Client Index = 0	Epoch: 1	Loss: 0.687023
Client Index = 0	Epoch: 2	Loss: 0.674207
Client Index = 0	Epoch: 3	Loss: 0.610112
Client Index = 0	Epoch: 4	Loss: 0.687670
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 1
local mask changes: 2520136.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2686174.0, 2520136.0, 2683690.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 1	Epoch: 0	Loss: 0.596741
Client Index = 1	Epoch: 1	Loss: 0.426277
Client Index = 1	Epoch: 2	Loss: 0.526442
Client Index = 1	Epoch: 3	Loss: 0.480634
Client Index = 1	Epoch: 4	Loss: 0.390616
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 2
local mask changes: 2520398.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2684452.0, 2520398.0, 2687316.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.334003
Client Index = 2	Epoch: 1	Loss: 0.288982
Client Index = 2	Epoch: 2	Loss: 0.384729
Client Index = 2	Epoch: 3	Loss: 0.341409
Client Index = 2	Epoch: 4	Loss: 0.268633
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 3
local mask changes: 2519458.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2687508.0, 2519458.0, 2688880.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.626802
Client Index = 3	Epoch: 1	Loss: 0.490406
Client Index = 3	Epoch: 2	Loss: 0.476253
Client Index = 3	Epoch: 3	Loss: 0.469655
Client Index = 3	Epoch: 4	Loss: 0.427650
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 4
local mask changes: 2521388.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2690864.0, 2521388.0, 2685934.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.722621
Client Index = 4	Epoch: 1	Loss: 0.743384
Client Index = 4	Epoch: 2	Loss: 0.671879
Client Index = 4	Epoch: 3	Loss: 0.612366
Client Index = 4	Epoch: 4	Loss: 0.705644
test acc on this client after 343 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 5
local mask changes: 2521460.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2686306.0, 2521460.0, 2684840.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.747111
Client Index = 5	Epoch: 1	Loss: 0.687865
Client Index = 5	Epoch: 2	Loss: 0.798944
Client Index = 5	Epoch: 3	Loss: 0.633981
Client Index = 5	Epoch: 4	Loss: 0.579116
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 6
local mask changes: 2519838.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2685238.0, 2519838.0, 2686746.0]
Doing local aggregation!
test acc on this client before 330 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 0.885228
Client Index = 6	Epoch: 1	Loss: 0.807558
Client Index = 6	Epoch: 2	Loss: 0.762195
Client Index = 6	Epoch: 3	Loss: 0.840861
Client Index = 6	Epoch: 4	Loss: 0.693260
test acc on this client after 309 / 505 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 7
local mask changes: 2521430.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2685536.0, 2521430.0, 2685740.0]
Doing local aggregation!
test acc on this client before 249 / 504 : 0.49
Client Index = 7	Epoch: 0	Loss: 0.962476
Client Index = 7	Epoch: 1	Loss: 1.004193
Client Index = 7	Epoch: 2	Loss: 0.887287
Client Index = 7	Epoch: 3	Loss: 0.921678
Client Index = 7	Epoch: 4	Loss: 0.895443
test acc on this client after 293 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 8
local mask changes: 2521472.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2684232.0, 2521472.0, 2685616.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.344807
Client Index = 8	Epoch: 1	Loss: 0.306833
Client Index = 8	Epoch: 2	Loss: 0.223128
Client Index = 8	Epoch: 3	Loss: 0.259624
Client Index = 8	Epoch: 4	Loss: 0.331787
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 9
local mask changes: 2520100.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2685306.0, 2520100.0, 2686346.0]
Doing local aggregation!
test acc on this client before 298 / 506 : 0.59
Client Index = 9	Epoch: 0	Loss: 0.773456
Client Index = 9	Epoch: 1	Loss: 0.924147
Client Index = 9	Epoch: 2	Loss: 0.755017
Client Index = 9	Epoch: 3	Loss: 0.690804
Client Index = 9	Epoch: 4	Loss: 0.680322
test acc on this client after 336 / 506 : 0.66
-----------------------------------
training flops per data 2653339648.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 10
local mask changes: 2519878.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2682106.0, 2519878.0, 2683872.0]
Doing local aggregation!
test acc on this client before 333 / 503 : 0.66
Client Index = 10	Epoch: 0	Loss: 0.821020
Client Index = 10	Epoch: 1	Loss: 0.755805
Client Index = 10	Epoch: 2	Loss: 0.843020
Client Index = 10	Epoch: 3	Loss: 0.840364
Client Index = 10	Epoch: 4	Loss: 0.736360
test acc on this client after 325 / 503 : 0.65
-----------------------------------
training flops per data 2653328384.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 11
local mask changes: 2519250.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2685134.0, 2519250.0, 2683266.0]
Doing local aggregation!
test acc on this client before 331 / 505 : 0.66
Client Index = 11	Epoch: 0	Loss: 0.620427
Client Index = 11	Epoch: 1	Loss: 0.431243
Client Index = 11	Epoch: 2	Loss: 0.506020
Client Index = 11	Epoch: 3	Loss: 0.460802
Client Index = 11	Epoch: 4	Loss: 0.345445
test acc on this client after 400 / 505 : 0.79
-----------------------------------
training flops per data 2653296128.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 12
local mask changes: 2520308.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2684526.0, 2520308.0, 2681898.0]
Doing local aggregation!
test acc on this client before 282 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 0.906140
Client Index = 12	Epoch: 1	Loss: 0.786328
Client Index = 12	Epoch: 2	Loss: 0.761013
Client Index = 12	Epoch: 3	Loss: 0.777066
Client Index = 12	Epoch: 4	Loss: 0.693721
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 13
local mask changes: 2521448.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2682312.0, 2521448.0, 2681478.0]
Doing local aggregation!
test acc on this client before 370 / 505 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.754152
Client Index = 13	Epoch: 1	Loss: 0.730531
Client Index = 13	Epoch: 2	Loss: 0.687855
Client Index = 13	Epoch: 3	Loss: 0.706199
Client Index = 13	Epoch: 4	Loss: 0.658804
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653309952.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 14
local mask changes: 2518020.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2682872.0, 2518020.0, 2681256.0]
Doing local aggregation!
test acc on this client before 335 / 503 : 0.67
Client Index = 14	Epoch: 0	Loss: 0.764331
Client Index = 14	Epoch: 1	Loss: 0.820517
Client Index = 14	Epoch: 2	Loss: 0.780992
Client Index = 14	Epoch: 3	Loss: 0.756176
Client Index = 14	Epoch: 4	Loss: 0.714391
test acc on this client after 294 / 503 : 0.58
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 15
local mask changes: 2521020.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2678332.0, 2521020.0, 2678830.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 15	Epoch: 0	Loss: 0.620367
Client Index = 15	Epoch: 1	Loss: 0.636842
Client Index = 15	Epoch: 2	Loss: 0.522235
Client Index = 15	Epoch: 3	Loss: 0.684176
Client Index = 15	Epoch: 4	Loss: 0.515719
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653320704.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 16
local mask changes: 2519700.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2681020.0, 2519700.0, 2680076.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 16	Epoch: 0	Loss: 0.770691
Client Index = 16	Epoch: 1	Loss: 0.701073
Client Index = 16	Epoch: 2	Loss: 0.742187
Client Index = 16	Epoch: 3	Loss: 0.693849
Client Index = 16	Epoch: 4	Loss: 0.641090
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653328896.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 17
local mask changes: 2521388.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2680204.0, 2521388.0, 2683906.0]
Doing local aggregation!
test acc on this client before 272 / 503 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.960136
Client Index = 17	Epoch: 1	Loss: 0.808556
Client Index = 17	Epoch: 2	Loss: 0.859121
Client Index = 17	Epoch: 3	Loss: 0.878889
Client Index = 17	Epoch: 4	Loss: 0.760845
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 18
local mask changes: 2520538.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2684030.0, 2520538.0, 2681492.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.720082
Client Index = 18	Epoch: 1	Loss: 0.582459
Client Index = 18	Epoch: 2	Loss: 0.659790
Client Index = 18	Epoch: 3	Loss: 0.612435
Client Index = 18	Epoch: 4	Loss: 0.569130
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 19
local mask changes: 2521016.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2684728.0, 2682238.0, 2521016.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 19	Epoch: 0	Loss: 0.741208
Client Index = 19	Epoch: 1	Loss: 0.629825
Client Index = 19	Epoch: 2	Loss: 0.618388
Client Index = 19	Epoch: 3	Loss: 0.616412
Client Index = 19	Epoch: 4	Loss: 0.566061
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.6551177702210845}
################local_test_on_all_clients after local training in communication round: 30
{'test_acc_after': 0.6986922059563921, 'test_loss_after': 0.9368067837731981}
################local_test_on_all_clients before local training in communication round: 30
{'test_acc_before': 0.6715071903430913, 'test_loss_before': 0.9611462720992889}
################Communication round : 31
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 0
local mask changes: 2492696.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2492696.0, 2655650.0, 2652650.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.865110
Client Index = 0	Epoch: 1	Loss: 0.658943
Client Index = 0	Epoch: 2	Loss: 0.640968
Client Index = 0	Epoch: 3	Loss: 0.624510
Client Index = 0	Epoch: 4	Loss: 0.530423
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 1
local mask changes: 2489456.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2655626.0, 2489456.0, 2655058.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 1	Epoch: 0	Loss: 0.541374
Client Index = 1	Epoch: 1	Loss: 0.459367
Client Index = 1	Epoch: 2	Loss: 0.403357
Client Index = 1	Epoch: 3	Loss: 0.419579
Client Index = 1	Epoch: 4	Loss: 0.446568
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 2
local mask changes: 2491488.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2655192.0, 2491488.0, 2657316.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.339749
Client Index = 2	Epoch: 1	Loss: 0.344044
Client Index = 2	Epoch: 2	Loss: 0.306608
Client Index = 2	Epoch: 3	Loss: 0.322282
Client Index = 2	Epoch: 4	Loss: 0.262976
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 3
local mask changes: 2490470.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2654756.0, 2490470.0, 2656544.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.553578
Client Index = 3	Epoch: 1	Loss: 0.576623
Client Index = 3	Epoch: 2	Loss: 0.451105
Client Index = 3	Epoch: 3	Loss: 0.465651
Client Index = 3	Epoch: 4	Loss: 0.453857
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 4
local mask changes: 2492218.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2658414.0, 2492218.0, 2655716.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.791992
Client Index = 4	Epoch: 1	Loss: 0.668981
Client Index = 4	Epoch: 2	Loss: 0.732555
Client Index = 4	Epoch: 3	Loss: 0.621201
Client Index = 4	Epoch: 4	Loss: 0.675082
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 5
local mask changes: 2492018.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2655102.0, 2492018.0, 2652628.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.804182
Client Index = 5	Epoch: 1	Loss: 0.642690
Client Index = 5	Epoch: 2	Loss: 0.638531
Client Index = 5	Epoch: 3	Loss: 0.571241
Client Index = 5	Epoch: 4	Loss: 0.577534
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 6
local mask changes: 2490892.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2651444.0, 2490892.0, 2656276.0]
Doing local aggregation!
test acc on this client before 299 / 505 : 0.59
Client Index = 6	Epoch: 0	Loss: 0.816990
Client Index = 6	Epoch: 1	Loss: 0.719065
Client Index = 6	Epoch: 2	Loss: 0.792080
Client Index = 6	Epoch: 3	Loss: 0.771426
Client Index = 6	Epoch: 4	Loss: 0.627327
test acc on this client after 287 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 7
local mask changes: 2492278.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2654944.0, 2492278.0, 2655274.0]
Doing local aggregation!
test acc on this client before 263 / 504 : 0.52
Client Index = 7	Epoch: 0	Loss: 0.961980
Client Index = 7	Epoch: 1	Loss: 0.986666
Client Index = 7	Epoch: 2	Loss: 0.892033
Client Index = 7	Epoch: 3	Loss: 0.916270
Client Index = 7	Epoch: 4	Loss: 0.809677
test acc on this client after 278 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 8
local mask changes: 2491544.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2653866.0, 2491544.0, 2656818.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 8	Epoch: 0	Loss: 0.348490
Client Index = 8	Epoch: 1	Loss: 0.230478
Client Index = 8	Epoch: 2	Loss: 0.270951
Client Index = 8	Epoch: 3	Loss: 0.272790
Client Index = 8	Epoch: 4	Loss: 0.220863
test acc on this client after 447 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 9
local mask changes: 2492804.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2657908.0, 2492804.0, 2655118.0]
Doing local aggregation!
test acc on this client before 325 / 506 : 0.64
Client Index = 9	Epoch: 0	Loss: 0.791737
Client Index = 9	Epoch: 1	Loss: 0.716930
Client Index = 9	Epoch: 2	Loss: 0.785746
Client Index = 9	Epoch: 3	Loss: 0.657360
Client Index = 9	Epoch: 4	Loss: 0.779749
test acc on this client after 336 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 10
local mask changes: 2492266.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2653288.0, 2492266.0, 2653310.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.863334
Client Index = 10	Epoch: 1	Loss: 0.784843
Client Index = 10	Epoch: 2	Loss: 0.843224
Client Index = 10	Epoch: 3	Loss: 0.717619
Client Index = 10	Epoch: 4	Loss: 0.690577
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653337856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 11
local mask changes: 2491324.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2653098.0, 2491324.0, 2652516.0]
Doing local aggregation!
test acc on this client before 325 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.592740
Client Index = 11	Epoch: 1	Loss: 0.419325
Client Index = 11	Epoch: 2	Loss: 0.392069
Client Index = 11	Epoch: 3	Loss: 0.450864
Client Index = 11	Epoch: 4	Loss: 0.424722
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653316352.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 12
local mask changes: 2491654.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2654590.0, 2491654.0, 2649642.0]
Doing local aggregation!
test acc on this client before 314 / 504 : 0.62
Client Index = 12	Epoch: 0	Loss: 0.867396
Client Index = 12	Epoch: 1	Loss: 0.903233
Client Index = 12	Epoch: 2	Loss: 0.745253
Client Index = 12	Epoch: 3	Loss: 0.680905
Client Index = 12	Epoch: 4	Loss: 0.827035
test acc on this client after 262 / 504 : 0.52
-----------------------------------
training flops per data 2653317120.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 13
local mask changes: 2491328.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2653320.0, 2491328.0, 2650892.0]
Doing local aggregation!
test acc on this client before 361 / 505 : 0.71
Client Index = 13	Epoch: 0	Loss: 0.693650
Client Index = 13	Epoch: 1	Loss: 0.728597
Client Index = 13	Epoch: 2	Loss: 0.654983
Client Index = 13	Epoch: 3	Loss: 0.633285
Client Index = 13	Epoch: 4	Loss: 0.604275
test acc on this client after 353 / 505 : 0.70
-----------------------------------
training flops per data 2653310208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 14
local mask changes: 2490820.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2653376.0, 2490820.0, 2650402.0]
Doing local aggregation!
test acc on this client before 325 / 503 : 0.65
Client Index = 14	Epoch: 0	Loss: 0.813303
Client Index = 14	Epoch: 1	Loss: 0.740216
Client Index = 14	Epoch: 2	Loss: 0.826811
Client Index = 14	Epoch: 3	Loss: 0.706245
Client Index = 14	Epoch: 4	Loss: 0.655229
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653319680.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 15
local mask changes: 2492656.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2651586.0, 2492656.0, 2649360.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.667392
Client Index = 15	Epoch: 1	Loss: 0.558358
Client Index = 15	Epoch: 2	Loss: 0.572430
Client Index = 15	Epoch: 3	Loss: 0.546309
Client Index = 15	Epoch: 4	Loss: 0.532846
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653321728.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 16
local mask changes: 2494138.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2649684.0, 2494138.0, 2651698.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 16	Epoch: 0	Loss: 0.751220
Client Index = 16	Epoch: 1	Loss: 0.701241
Client Index = 16	Epoch: 2	Loss: 0.659543
Client Index = 16	Epoch: 3	Loss: 0.590510
Client Index = 16	Epoch: 4	Loss: 0.617849
test acc on this client after 290 / 504 : 0.58
-----------------------------------
training flops per data 2653327104.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 17
local mask changes: 2490964.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2650080.0, 2490964.0, 2655596.0]
Doing local aggregation!
test acc on this client before 271 / 503 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.940038
Client Index = 17	Epoch: 1	Loss: 0.830297
Client Index = 17	Epoch: 2	Loss: 0.799917
Client Index = 17	Epoch: 3	Loss: 0.793989
Client Index = 17	Epoch: 4	Loss: 0.807023
test acc on this client after 332 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 18
local mask changes: 2492298.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2655438.0, 2492298.0, 2652516.0]
Doing local aggregation!
test acc on this client before 338 / 503 : 0.67
Client Index = 18	Epoch: 0	Loss: 0.679241
Client Index = 18	Epoch: 1	Loss: 0.647475
Client Index = 18	Epoch: 2	Loss: 0.588665
Client Index = 18	Epoch: 3	Loss: 0.580478
Client Index = 18	Epoch: 4	Loss: 0.497478
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653329920.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 19
local mask changes: 2492064.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2653628.0, 2652938.0, 2492064.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.762343
Client Index = 19	Epoch: 1	Loss: 0.605830
Client Index = 19	Epoch: 2	Loss: 0.613094
Client Index = 19	Epoch: 3	Loss: 0.742420
Client Index = 19	Epoch: 4	Loss: 0.550508
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.636554953109473}
################local_test_on_all_clients after local training in communication round: 31
{'test_acc_after': 0.6970254037677949, 'test_loss_after': 0.9454797377701112}
################local_test_on_all_clients before local training in communication round: 31
{'test_acc_before': 0.6804458476807882, 'test_loss_before': 0.9394934998186782}
################Communication round : 32
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 0
local mask changes: 2462446.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2462446.0, 2624446.0, 2622772.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.713408
Client Index = 0	Epoch: 1	Loss: 0.574190
Client Index = 0	Epoch: 2	Loss: 0.588613
Client Index = 0	Epoch: 3	Loss: 0.709101
Client Index = 0	Epoch: 4	Loss: 0.569135
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 1
local mask changes: 2460972.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2624384.0, 2460972.0, 2624306.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 1	Epoch: 0	Loss: 0.508777
Client Index = 1	Epoch: 1	Loss: 0.486263
Client Index = 1	Epoch: 2	Loss: 0.421075
Client Index = 1	Epoch: 3	Loss: 0.396535
Client Index = 1	Epoch: 4	Loss: 0.326536
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 2
local mask changes: 2460796.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2623588.0, 2460796.0, 2624980.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.326116
Client Index = 2	Epoch: 1	Loss: 0.266417
Client Index = 2	Epoch: 2	Loss: 0.574786
Client Index = 2	Epoch: 3	Loss: 0.282423
Client Index = 2	Epoch: 4	Loss: 0.299869
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 3
local mask changes: 2460568.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2627360.0, 2460568.0, 2626908.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.563425
Client Index = 3	Epoch: 1	Loss: 0.488974
Client Index = 3	Epoch: 2	Loss: 0.437370
Client Index = 3	Epoch: 3	Loss: 0.445609
Client Index = 3	Epoch: 4	Loss: 0.417580
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 4
local mask changes: 2460856.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2626150.0, 2460856.0, 2624916.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 4	Epoch: 0	Loss: 0.769670
Client Index = 4	Epoch: 1	Loss: 0.640674
Client Index = 4	Epoch: 2	Loss: 0.684705
Client Index = 4	Epoch: 3	Loss: 0.610831
Client Index = 4	Epoch: 4	Loss: 0.561402
test acc on this client after 321 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 5
local mask changes: 2462334.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2624376.0, 2462334.0, 2623852.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.830871
Client Index = 5	Epoch: 1	Loss: 0.652256
Client Index = 5	Epoch: 2	Loss: 0.642686
Client Index = 5	Epoch: 3	Loss: 0.591070
Client Index = 5	Epoch: 4	Loss: 0.622410
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 6
local mask changes: 2460722.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2623416.0, 2460722.0, 2626452.0]
Doing local aggregation!
test acc on this client before 295 / 505 : 0.58
Client Index = 6	Epoch: 0	Loss: 0.764679
Client Index = 6	Epoch: 1	Loss: 0.895322
Client Index = 6	Epoch: 2	Loss: 0.703265
Client Index = 6	Epoch: 3	Loss: 0.753982
Client Index = 6	Epoch: 4	Loss: 0.636088
test acc on this client after 314 / 505 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 7
local mask changes: 2461578.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2622622.0, 2461578.0, 2623000.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.964295
Client Index = 7	Epoch: 1	Loss: 0.883247
Client Index = 7	Epoch: 2	Loss: 0.901989
Client Index = 7	Epoch: 3	Loss: 0.870959
Client Index = 7	Epoch: 4	Loss: 0.916315
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 8
local mask changes: 2462642.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2623850.0, 2462642.0, 2625406.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.323654
Client Index = 8	Epoch: 1	Loss: 0.305897
Client Index = 8	Epoch: 2	Loss: 0.240370
Client Index = 8	Epoch: 3	Loss: 0.220883
Client Index = 8	Epoch: 4	Loss: 0.256791
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 9
local mask changes: 2462080.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2625782.0, 2462080.0, 2623336.0]
Doing local aggregation!
test acc on this client before 322 / 506 : 0.64
Client Index = 9	Epoch: 0	Loss: 0.798134
Client Index = 9	Epoch: 1	Loss: 0.614634
Client Index = 9	Epoch: 2	Loss: 0.839120
Client Index = 9	Epoch: 3	Loss: 0.684480
Client Index = 9	Epoch: 4	Loss: 0.630987
test acc on this client after 335 / 506 : 0.66
-----------------------------------
training flops per data 2653340160.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 10
local mask changes: 2461142.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2623876.0, 2461142.0, 2623222.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.818416
Client Index = 10	Epoch: 1	Loss: 0.791061
Client Index = 10	Epoch: 2	Loss: 0.780415
Client Index = 10	Epoch: 3	Loss: 0.783490
Client Index = 10	Epoch: 4	Loss: 0.723977
test acc on this client after 257 / 503 : 0.51
-----------------------------------
training flops per data 2653328896.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 11
local mask changes: 2462512.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2622250.0, 2462512.0, 2622916.0]
Doing local aggregation!
test acc on this client before 319 / 505 : 0.63
Client Index = 11	Epoch: 0	Loss: 0.516174
Client Index = 11	Epoch: 1	Loss: 0.438527
Client Index = 11	Epoch: 2	Loss: 0.410038
Client Index = 11	Epoch: 3	Loss: 0.489510
Client Index = 11	Epoch: 4	Loss: 0.357575
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653322752.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 12
local mask changes: 2460576.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2623070.0, 2460576.0, 2619976.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 12	Epoch: 0	Loss: 0.769560
Client Index = 12	Epoch: 1	Loss: 0.817102
Client Index = 12	Epoch: 2	Loss: 0.690301
Client Index = 12	Epoch: 3	Loss: 0.730450
Client Index = 12	Epoch: 4	Loss: 0.650465
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 13
local mask changes: 2461208.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2620508.0, 2461208.0, 2618772.0]
Doing local aggregation!
test acc on this client before 367 / 505 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.657182
Client Index = 13	Epoch: 1	Loss: 0.674990
Client Index = 13	Epoch: 2	Loss: 0.653514
Client Index = 13	Epoch: 3	Loss: 0.649193
Client Index = 13	Epoch: 4	Loss: 0.568136
test acc on this client after 352 / 505 : 0.70
-----------------------------------
training flops per data 2653313280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 14
local mask changes: 2462504.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2619954.0, 2462504.0, 2621946.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.778378
Client Index = 14	Epoch: 1	Loss: 0.751464
Client Index = 14	Epoch: 2	Loss: 0.757390
Client Index = 14	Epoch: 3	Loss: 0.650921
Client Index = 14	Epoch: 4	Loss: 0.729563
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653314816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 15
local mask changes: 2461914.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2621504.0, 2461914.0, 2619578.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.618682
Client Index = 15	Epoch: 1	Loss: 0.565143
Client Index = 15	Epoch: 2	Loss: 0.503135
Client Index = 15	Epoch: 3	Loss: 0.542998
Client Index = 15	Epoch: 4	Loss: 0.575297
test acc on this client after 325 / 503 : 0.65
-----------------------------------
training flops per data 2653319424.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 16
local mask changes: 2462242.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2620168.0, 2462242.0, 2620850.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 16	Epoch: 0	Loss: 0.724333
Client Index = 16	Epoch: 1	Loss: 0.679059
Client Index = 16	Epoch: 2	Loss: 0.695499
Client Index = 16	Epoch: 3	Loss: 0.631473
Client Index = 16	Epoch: 4	Loss: 0.532872
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 17
local mask changes: 2462626.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2620046.0, 2462626.0, 2625840.0]
Doing local aggregation!
test acc on this client before 282 / 503 : 0.56
Client Index = 17	Epoch: 0	Loss: 0.873444
Client Index = 17	Epoch: 1	Loss: 0.882456
Client Index = 17	Epoch: 2	Loss: 0.857919
Client Index = 17	Epoch: 3	Loss: 0.739436
Client Index = 17	Epoch: 4	Loss: 0.783409
test acc on this client after 340 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 18
local mask changes: 2462394.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2622662.0, 2462394.0, 2619942.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 18	Epoch: 0	Loss: 0.755198
Client Index = 18	Epoch: 1	Loss: 0.536263
Client Index = 18	Epoch: 2	Loss: 0.617687
Client Index = 18	Epoch: 3	Loss: 0.560439
Client Index = 18	Epoch: 4	Loss: 0.536572
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653308672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 19
local mask changes: 2461242.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2622868.0, 2622032.0, 2461242.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.733704
Client Index = 19	Epoch: 1	Loss: 0.673635
Client Index = 19	Epoch: 2	Loss: 0.558669
Client Index = 19	Epoch: 3	Loss: 0.589340
Client Index = 19	Epoch: 4	Loss: 0.753369
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.623656897109002}
################local_test_on_all_clients after local training in communication round: 32
{'test_acc_after': 0.6966092514642102, 'test_loss_after': 0.9549807094491773}
################local_test_on_all_clients before local training in communication round: 32
{'test_acc_before': 0.6876997347917125, 'test_loss_before': 0.9304016738580916}
################Communication round : 33
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 0
local mask changes: 2430642.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2430642.0, 2592346.0, 2591608.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.673066
Client Index = 0	Epoch: 1	Loss: 0.591581
Client Index = 0	Epoch: 2	Loss: 0.601320
Client Index = 0	Epoch: 3	Loss: 0.617822
Client Index = 0	Epoch: 4	Loss: 0.579900
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 1
local mask changes: 2431710.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2592860.0, 2431710.0, 2591224.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 1	Epoch: 0	Loss: 0.494765
Client Index = 1	Epoch: 1	Loss: 0.490374
Client Index = 1	Epoch: 2	Loss: 0.434178
Client Index = 1	Epoch: 3	Loss: 0.339300
Client Index = 1	Epoch: 4	Loss: 0.409426
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 2
local mask changes: 2432026.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2591422.0, 2432026.0, 2594762.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.319201
Client Index = 2	Epoch: 1	Loss: 0.279846
Client Index = 2	Epoch: 2	Loss: 0.327856
Client Index = 2	Epoch: 3	Loss: 0.274773
Client Index = 2	Epoch: 4	Loss: 0.259353
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 3
local mask changes: 2431678.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2593432.0, 2431678.0, 2596002.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.439485
Client Index = 3	Epoch: 1	Loss: 0.569648
Client Index = 3	Epoch: 2	Loss: 0.419842
Client Index = 3	Epoch: 3	Loss: 0.396365
Client Index = 3	Epoch: 4	Loss: 0.363504
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 4
local mask changes: 2431418.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2593314.0, 2431418.0, 2592698.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 4	Epoch: 0	Loss: 0.726428
Client Index = 4	Epoch: 1	Loss: 0.758857
Client Index = 4	Epoch: 2	Loss: 0.636138
Client Index = 4	Epoch: 3	Loss: 0.674991
Client Index = 4	Epoch: 4	Loss: 0.534747
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 5
local mask changes: 2432328.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2592714.0, 2432328.0, 2590978.0]
Doing local aggregation!
test acc on this client before 320 / 503 : 0.64
Client Index = 5	Epoch: 0	Loss: 0.696415
Client Index = 5	Epoch: 1	Loss: 0.694486
Client Index = 5	Epoch: 2	Loss: 0.590348
Client Index = 5	Epoch: 3	Loss: 0.591696
Client Index = 5	Epoch: 4	Loss: 0.546995
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 6
local mask changes: 2432476.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2591310.0, 2432476.0, 2592224.0]
Doing local aggregation!
test acc on this client before 296 / 505 : 0.59
Client Index = 6	Epoch: 0	Loss: 0.823358
Client Index = 6	Epoch: 1	Loss: 0.767392
Client Index = 6	Epoch: 2	Loss: 0.674418
Client Index = 6	Epoch: 3	Loss: 0.681622
Client Index = 6	Epoch: 4	Loss: 0.663360
test acc on this client after 344 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 7
local mask changes: 2430132.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2591828.0, 2430132.0, 2593024.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.879031
Client Index = 7	Epoch: 1	Loss: 0.926419
Client Index = 7	Epoch: 2	Loss: 0.942279
Client Index = 7	Epoch: 3	Loss: 0.900273
Client Index = 7	Epoch: 4	Loss: 0.810641
test acc on this client after 315 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 8
local mask changes: 2428760.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2592058.0, 2428760.0, 2592038.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.355537
Client Index = 8	Epoch: 1	Loss: 0.317988
Client Index = 8	Epoch: 2	Loss: 0.249559
Client Index = 8	Epoch: 3	Loss: 0.224502
Client Index = 8	Epoch: 4	Loss: 0.278163
test acc on this client after 448 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 9
local mask changes: 2429776.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2593626.0, 2429776.0, 2590674.0]
Doing local aggregation!
test acc on this client before 273 / 506 : 0.54
Client Index = 9	Epoch: 0	Loss: 0.701078
Client Index = 9	Epoch: 1	Loss: 0.781921
Client Index = 9	Epoch: 2	Loss: 0.623943
Client Index = 9	Epoch: 3	Loss: 0.670011
Client Index = 9	Epoch: 4	Loss: 0.602792
test acc on this client after 330 / 506 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 10
local mask changes: 2430564.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2592522.0, 2430564.0, 2593664.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.754751
Client Index = 10	Epoch: 1	Loss: 0.791956
Client Index = 10	Epoch: 2	Loss: 0.704832
Client Index = 10	Epoch: 3	Loss: 0.693340
Client Index = 10	Epoch: 4	Loss: 0.686708
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653324032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 11
local mask changes: 2429886.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2592228.0, 2429886.0, 2589262.0]
Doing local aggregation!
test acc on this client before 295 / 505 : 0.58
Client Index = 11	Epoch: 0	Loss: 0.586112
Client Index = 11	Epoch: 1	Loss: 0.513574
Client Index = 11	Epoch: 2	Loss: 0.369689
Client Index = 11	Epoch: 3	Loss: 0.389912
Client Index = 11	Epoch: 4	Loss: 0.341604
test acc on this client after 393 / 505 : 0.78
-----------------------------------
training flops per data 2653299712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 12
local mask changes: 2432386.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2591450.0, 2432386.0, 2588602.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 12	Epoch: 0	Loss: 0.786808
Client Index = 12	Epoch: 1	Loss: 0.770439
Client Index = 12	Epoch: 2	Loss: 0.693439
Client Index = 12	Epoch: 3	Loss: 0.874787
Client Index = 12	Epoch: 4	Loss: 0.660780
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 13
local mask changes: 2431888.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2589812.0, 2431888.0, 2588752.0]
Doing local aggregation!
test acc on this client before 376 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.753111
Client Index = 13	Epoch: 1	Loss: 0.615755
Client Index = 13	Epoch: 2	Loss: 0.635172
Client Index = 13	Epoch: 3	Loss: 0.685391
Client Index = 13	Epoch: 4	Loss: 0.645373
test acc on this client after 336 / 505 : 0.67
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 14
local mask changes: 2431612.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2589070.0, 2431612.0, 2586808.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 14	Epoch: 0	Loss: 0.803899
Client Index = 14	Epoch: 1	Loss: 0.717977
Client Index = 14	Epoch: 2	Loss: 0.741573
Client Index = 14	Epoch: 3	Loss: 0.681040
Client Index = 14	Epoch: 4	Loss: 0.702447
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 15
local mask changes: 2432306.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2587222.0, 2432306.0, 2587136.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.600793
Client Index = 15	Epoch: 1	Loss: 0.705387
Client Index = 15	Epoch: 2	Loss: 0.482178
Client Index = 15	Epoch: 3	Loss: 0.522058
Client Index = 15	Epoch: 4	Loss: 0.507796
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 16
local mask changes: 2431834.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2587280.0, 2431834.0, 2589214.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.744733
Client Index = 16	Epoch: 1	Loss: 0.614570
Client Index = 16	Epoch: 2	Loss: 0.627763
Client Index = 16	Epoch: 3	Loss: 0.597230
Client Index = 16	Epoch: 4	Loss: 0.611067
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653324032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 17
local mask changes: 2431100.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2590044.0, 2431100.0, 2592428.0]
Doing local aggregation!
test acc on this client before 263 / 503 : 0.52
Client Index = 17	Epoch: 0	Loss: 0.909909
Client Index = 17	Epoch: 1	Loss: 0.808467
Client Index = 17	Epoch: 2	Loss: 0.784551
Client Index = 17	Epoch: 3	Loss: 0.776616
Client Index = 17	Epoch: 4	Loss: 0.744372
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653327104.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 18
local mask changes: 2430356.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2592036.0, 2430356.0, 2589956.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.622912
Client Index = 18	Epoch: 1	Loss: 0.648265
Client Index = 18	Epoch: 2	Loss: 0.586230
Client Index = 18	Epoch: 3	Loss: 0.521485
Client Index = 18	Epoch: 4	Loss: 0.544899
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 19
local mask changes: 2430366.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2591772.0, 2589810.0, 2430366.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 19	Epoch: 0	Loss: 0.729296
Client Index = 19	Epoch: 1	Loss: 0.544872
Client Index = 19	Epoch: 2	Loss: 0.618011
Client Index = 19	Epoch: 3	Loss: 0.578185
Client Index = 19	Epoch: 4	Loss: 0.613282
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.6085238546319306}
################local_test_on_all_clients after local training in communication round: 33
{'test_acc_after': 0.7217366756895982, 'test_loss_after': 0.8775902539240313}
################local_test_on_all_clients before local training in communication round: 33
{'test_acc_before': 0.6778892255311623, 'test_loss_before': 0.9452443614444196}
################Communication round : 34
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 0
local mask changes: 2399680.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2399680.0, 2561700.0, 2561176.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.658758
Client Index = 0	Epoch: 1	Loss: 0.627017
Client Index = 0	Epoch: 2	Loss: 0.558818
Client Index = 0	Epoch: 3	Loss: 0.568150
Client Index = 0	Epoch: 4	Loss: 0.602355
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 1
local mask changes: 2398026.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2558398.0, 2398026.0, 2558276.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.547077
Client Index = 1	Epoch: 1	Loss: 0.423924
Client Index = 1	Epoch: 2	Loss: 0.460394
Client Index = 1	Epoch: 3	Loss: 0.410871
Client Index = 1	Epoch: 4	Loss: 0.357226
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 2
local mask changes: 2399714.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2559326.0, 2399714.0, 2562206.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.308689
Client Index = 2	Epoch: 1	Loss: 0.363191
Client Index = 2	Epoch: 2	Loss: 0.404069
Client Index = 2	Epoch: 3	Loss: 0.239346
Client Index = 2	Epoch: 4	Loss: 0.241251
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 3
local mask changes: 2398276.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2560230.0, 2398276.0, 2562656.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.459943
Client Index = 3	Epoch: 1	Loss: 0.672181
Client Index = 3	Epoch: 2	Loss: 0.398381
Client Index = 3	Epoch: 3	Loss: 0.484399
Client Index = 3	Epoch: 4	Loss: 0.380212
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 4
local mask changes: 2399084.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2564160.0, 2399084.0, 2560550.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.685842
Client Index = 4	Epoch: 1	Loss: 0.637305
Client Index = 4	Epoch: 2	Loss: 0.713028
Client Index = 4	Epoch: 3	Loss: 0.575109
Client Index = 4	Epoch: 4	Loss: 0.637443
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 5
local mask changes: 2398688.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2560938.0, 2398688.0, 2559196.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.716080
Client Index = 5	Epoch: 1	Loss: 0.592330
Client Index = 5	Epoch: 2	Loss: 0.718631
Client Index = 5	Epoch: 3	Loss: 0.529237
Client Index = 5	Epoch: 4	Loss: 0.597581
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 6
local mask changes: 2400522.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2557276.0, 2400522.0, 2560734.0]
Doing local aggregation!
test acc on this client before 323 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.736687
Client Index = 6	Epoch: 1	Loss: 0.702150
Client Index = 6	Epoch: 2	Loss: 0.771978
Client Index = 6	Epoch: 3	Loss: 0.662537
Client Index = 6	Epoch: 4	Loss: 0.690800
test acc on this client after 323 / 505 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 7
local mask changes: 2398922.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2559504.0, 2398922.0, 2559538.0]
Doing local aggregation!
test acc on this client before 286 / 504 : 0.57
Client Index = 7	Epoch: 0	Loss: 0.930765
Client Index = 7	Epoch: 1	Loss: 0.944512
Client Index = 7	Epoch: 2	Loss: 0.868693
Client Index = 7	Epoch: 3	Loss: 0.809247
Client Index = 7	Epoch: 4	Loss: 0.824628
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 8
local mask changes: 2400166.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2559572.0, 2400166.0, 2561592.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.444034
Client Index = 8	Epoch: 1	Loss: 0.232652
Client Index = 8	Epoch: 2	Loss: 0.245756
Client Index = 8	Epoch: 3	Loss: 0.196332
Client Index = 8	Epoch: 4	Loss: 0.210557
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 9
local mask changes: 2400182.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2560368.0, 2400182.0, 2560776.0]
Doing local aggregation!
test acc on this client before 335 / 506 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.699180
Client Index = 9	Epoch: 1	Loss: 0.711134
Client Index = 9	Epoch: 2	Loss: 0.662206
Client Index = 9	Epoch: 3	Loss: 0.704345
Client Index = 9	Epoch: 4	Loss: 0.584836
test acc on this client after 321 / 506 : 0.63
-----------------------------------
training flops per data 2653340160.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 10
local mask changes: 2400086.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2559552.0, 2400086.0, 2560002.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.759071
Client Index = 10	Epoch: 1	Loss: 0.721425
Client Index = 10	Epoch: 2	Loss: 0.748228
Client Index = 10	Epoch: 3	Loss: 0.686724
Client Index = 10	Epoch: 4	Loss: 0.767604
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653322496.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 11
local mask changes: 2398660.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2557622.0, 2398660.0, 2559622.0]
Doing local aggregation!
test acc on this client before 321 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.559486
Client Index = 11	Epoch: 1	Loss: 0.372322
Client Index = 11	Epoch: 2	Loss: 0.363874
Client Index = 11	Epoch: 3	Loss: 0.457825
Client Index = 11	Epoch: 4	Loss: 0.368166
test acc on this client after 411 / 505 : 0.81
-----------------------------------
training flops per data 2653294848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 12
local mask changes: 2400596.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2561540.0, 2400596.0, 2557448.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.754055
Client Index = 12	Epoch: 1	Loss: 0.697301
Client Index = 12	Epoch: 2	Loss: 0.718965
Client Index = 12	Epoch: 3	Loss: 0.662116
Client Index = 12	Epoch: 4	Loss: 0.619073
test acc on this client after 257 / 504 : 0.51
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 13
local mask changes: 2399758.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2556666.0, 2399758.0, 2555712.0]
Doing local aggregation!
test acc on this client before 373 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.694458
Client Index = 13	Epoch: 1	Loss: 0.594128
Client Index = 13	Epoch: 2	Loss: 0.633537
Client Index = 13	Epoch: 3	Loss: 0.590727
Client Index = 13	Epoch: 4	Loss: 0.567496
test acc on this client after 367 / 505 : 0.73
-----------------------------------
training flops per data 2653311488.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 14
local mask changes: 2401494.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2557202.0, 2401494.0, 2555982.0]
Doing local aggregation!
test acc on this client before 338 / 503 : 0.67
Client Index = 14	Epoch: 0	Loss: 0.735869
Client Index = 14	Epoch: 1	Loss: 0.727019
Client Index = 14	Epoch: 2	Loss: 0.675705
Client Index = 14	Epoch: 3	Loss: 0.620491
Client Index = 14	Epoch: 4	Loss: 0.655494
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653313536.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 15
local mask changes: 2399434.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2555812.0, 2399434.0, 2555560.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.615754
Client Index = 15	Epoch: 1	Loss: 0.552248
Client Index = 15	Epoch: 2	Loss: 0.581344
Client Index = 15	Epoch: 3	Loss: 0.505435
Client Index = 15	Epoch: 4	Loss: 0.453612
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 16
local mask changes: 2401386.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2555236.0, 2401386.0, 2557274.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.635666
Client Index = 16	Epoch: 1	Loss: 0.649763
Client Index = 16	Epoch: 2	Loss: 0.634582
Client Index = 16	Epoch: 3	Loss: 0.543482
Client Index = 16	Epoch: 4	Loss: 0.635684
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653322752.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 17
local mask changes: 2398546.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2559050.0, 2398546.0, 2559744.0]
Doing local aggregation!
test acc on this client before 271 / 503 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.847005
Client Index = 17	Epoch: 1	Loss: 0.836743
Client Index = 17	Epoch: 2	Loss: 0.723732
Client Index = 17	Epoch: 3	Loss: 0.786134
Client Index = 17	Epoch: 4	Loss: 0.746658
test acc on this client after 318 / 503 : 0.63
-----------------------------------
training flops per data 2653299200.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 18
local mask changes: 2400936.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2558466.0, 2400936.0, 2559174.0]
Doing local aggregation!
test acc on this client before 375 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.630655
Client Index = 18	Epoch: 1	Loss: 0.584925
Client Index = 18	Epoch: 2	Loss: 0.523847
Client Index = 18	Epoch: 3	Loss: 0.549652
Client Index = 18	Epoch: 4	Loss: 0.478133
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653329408.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 19
local mask changes: 2398892.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2560880.0, 2557428.0, 2398892.0]
Doing local aggregation!
test acc on this client before 358 / 503 : 0.71
Client Index = 19	Epoch: 0	Loss: 0.625151
Client Index = 19	Epoch: 1	Loss: 0.616027
Client Index = 19	Epoch: 2	Loss: 0.554097
Client Index = 19	Epoch: 3	Loss: 0.541753
Client Index = 19	Epoch: 4	Loss: 0.554653
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5935976053141057}
################local_test_on_all_clients after local training in communication round: 34
{'test_acc_after': 0.7044513014611045, 'test_loss_after': 0.9302029248805128}
################local_test_on_all_clients before local training in communication round: 34
{'test_acc_before': 0.6931429281562191, 'test_loss_before': 0.90083368762451}
################Communication round : 35
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 0
local mask changes: 2367858.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2367858.0, 2528478.0, 2526594.0]
Doing local aggregation!
test acc on this client before 334 / 503 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.674174
Client Index = 0	Epoch: 1	Loss: 0.606592
Client Index = 0	Epoch: 2	Loss: 0.515810
Client Index = 0	Epoch: 3	Loss: 0.546512
Client Index = 0	Epoch: 4	Loss: 0.581791
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 1
local mask changes: 2368678.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2529238.0, 2368678.0, 2527300.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 1	Epoch: 0	Loss: 0.507753
Client Index = 1	Epoch: 1	Loss: 0.363528
Client Index = 1	Epoch: 2	Loss: 0.377247
Client Index = 1	Epoch: 3	Loss: 0.444044
Client Index = 1	Epoch: 4	Loss: 0.347551
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 2
local mask changes: 2368062.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2524428.0, 2368062.0, 2526294.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.302085
Client Index = 2	Epoch: 1	Loss: 0.262372
Client Index = 2	Epoch: 2	Loss: 0.256660
Client Index = 2	Epoch: 3	Loss: 0.253530
Client Index = 2	Epoch: 4	Loss: 0.266099
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 3
local mask changes: 2367608.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2528900.0, 2367608.0, 2530536.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.499832
Client Index = 3	Epoch: 1	Loss: 0.404328
Client Index = 3	Epoch: 2	Loss: 0.398367
Client Index = 3	Epoch: 3	Loss: 0.660529
Client Index = 3	Epoch: 4	Loss: 0.355765
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 4
local mask changes: 2366072.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2528920.0, 2366072.0, 2527586.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.672114
Client Index = 4	Epoch: 1	Loss: 0.678655
Client Index = 4	Epoch: 2	Loss: 0.631652
Client Index = 4	Epoch: 3	Loss: 0.589799
Client Index = 4	Epoch: 4	Loss: 0.494310
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 5
local mask changes: 2365830.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2526858.0, 2365830.0, 2524518.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.656960
Client Index = 5	Epoch: 1	Loss: 0.570285
Client Index = 5	Epoch: 2	Loss: 0.607716
Client Index = 5	Epoch: 3	Loss: 0.663803
Client Index = 5	Epoch: 4	Loss: 0.524862
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 6
local mask changes: 2367384.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2526330.0, 2367384.0, 2528636.0]
Doing local aggregation!
test acc on this client before 328 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 0.717055
Client Index = 6	Epoch: 1	Loss: 0.815972
Client Index = 6	Epoch: 2	Loss: 0.657751
Client Index = 6	Epoch: 3	Loss: 0.684129
Client Index = 6	Epoch: 4	Loss: 0.579251
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 7
local mask changes: 2367216.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2528696.0, 2367216.0, 2526700.0]
Doing local aggregation!
test acc on this client before 265 / 504 : 0.53
Client Index = 7	Epoch: 0	Loss: 0.899743
Client Index = 7	Epoch: 1	Loss: 0.882009
Client Index = 7	Epoch: 2	Loss: 0.846539
Client Index = 7	Epoch: 3	Loss: 0.803404
Client Index = 7	Epoch: 4	Loss: 0.753753
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 8
local mask changes: 2367528.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2524630.0, 2367528.0, 2526894.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.280269
Client Index = 8	Epoch: 1	Loss: 0.255540
Client Index = 8	Epoch: 2	Loss: 0.200722
Client Index = 8	Epoch: 3	Loss: 0.363858
Client Index = 8	Epoch: 4	Loss: 0.180889
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 9
local mask changes: 2366918.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2526998.0, 2366918.0, 2525854.0]
Doing local aggregation!
test acc on this client before 293 / 506 : 0.58
Client Index = 9	Epoch: 0	Loss: 0.759817
Client Index = 9	Epoch: 1	Loss: 0.629075
Client Index = 9	Epoch: 2	Loss: 0.582444
Client Index = 9	Epoch: 3	Loss: 0.751140
Client Index = 9	Epoch: 4	Loss: 0.592913
test acc on this client after 341 / 506 : 0.67
-----------------------------------
training flops per data 2653341184.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 10
local mask changes: 2367874.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2525492.0, 2367874.0, 2526972.0]
Doing local aggregation!
test acc on this client before 346 / 503 : 0.69
Client Index = 10	Epoch: 0	Loss: 0.794226
Client Index = 10	Epoch: 1	Loss: 0.711578
Client Index = 10	Epoch: 2	Loss: 0.650778
Client Index = 10	Epoch: 3	Loss: 0.672370
Client Index = 10	Epoch: 4	Loss: 0.688165
test acc on this client after 332 / 503 : 0.66
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 11
local mask changes: 2367370.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2525806.0, 2367370.0, 2524274.0]
Doing local aggregation!
test acc on this client before 333 / 505 : 0.66
Client Index = 11	Epoch: 0	Loss: 0.479752
Client Index = 11	Epoch: 1	Loss: 0.383096
Client Index = 11	Epoch: 2	Loss: 0.474478
Client Index = 11	Epoch: 3	Loss: 0.296773
Client Index = 11	Epoch: 4	Loss: 0.363099
test acc on this client after 385 / 505 : 0.76
-----------------------------------
training flops per data 2653291520.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 12
local mask changes: 2367380.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2526934.0, 2367380.0, 2524512.0]
Doing local aggregation!
test acc on this client before 299 / 504 : 0.59
Client Index = 12	Epoch: 0	Loss: 0.811675
Client Index = 12	Epoch: 1	Loss: 0.692855
Client Index = 12	Epoch: 2	Loss: 0.616034
Client Index = 12	Epoch: 3	Loss: 0.691269
Client Index = 12	Epoch: 4	Loss: 0.598403
test acc on this client after 209 / 504 : 0.41
-----------------------------------
training flops per data 2653316352.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 13
local mask changes: 2366304.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2522860.0, 2366304.0, 2524876.0]
Doing local aggregation!
test acc on this client before 376 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.588969
Client Index = 13	Epoch: 1	Loss: 0.628695
Client Index = 13	Epoch: 2	Loss: 0.599418
Client Index = 13	Epoch: 3	Loss: 0.599856
Client Index = 13	Epoch: 4	Loss: 0.506689
test acc on this client after 292 / 505 : 0.58
-----------------------------------
training flops per data 2653313280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 14
local mask changes: 2367296.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2523522.0, 2367296.0, 2521662.0]
Doing local aggregation!
test acc on this client before 340 / 503 : 0.68
Client Index = 14	Epoch: 0	Loss: 0.682131
Client Index = 14	Epoch: 1	Loss: 0.718893
Client Index = 14	Epoch: 2	Loss: 0.611431
Client Index = 14	Epoch: 3	Loss: 0.620421
Client Index = 14	Epoch: 4	Loss: 0.666710
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653313536.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 15
local mask changes: 2366314.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2523994.0, 2366314.0, 2522676.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.550251
Client Index = 15	Epoch: 1	Loss: 0.598180
Client Index = 15	Epoch: 2	Loss: 0.490823
Client Index = 15	Epoch: 3	Loss: 0.479806
Client Index = 15	Epoch: 4	Loss: 0.545527
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653313280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 16
local mask changes: 2365364.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2521980.0, 2365364.0, 2521576.0]
Doing local aggregation!
test acc on this client before 325 / 504 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.696205
Client Index = 16	Epoch: 1	Loss: 0.610234
Client Index = 16	Epoch: 2	Loss: 0.605530
Client Index = 16	Epoch: 3	Loss: 0.548178
Client Index = 16	Epoch: 4	Loss: 0.566377
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653315072.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 17
local mask changes: 2366408.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2524684.0, 2366408.0, 2526106.0]
Doing local aggregation!
test acc on this client before 254 / 503 : 0.50
Client Index = 17	Epoch: 0	Loss: 0.863553
Client Index = 17	Epoch: 1	Loss: 0.754573
Client Index = 17	Epoch: 2	Loss: 0.736791
Client Index = 17	Epoch: 3	Loss: 0.661605
Client Index = 17	Epoch: 4	Loss: 0.681737
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653317120.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 18
local mask changes: 2368554.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2525838.0, 2368554.0, 2526820.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 18	Epoch: 0	Loss: 0.566557
Client Index = 18	Epoch: 1	Loss: 0.596948
Client Index = 18	Epoch: 2	Loss: 0.514893
Client Index = 18	Epoch: 3	Loss: 0.639992
Client Index = 18	Epoch: 4	Loss: 0.436320
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 19
local mask changes: 2367768.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2526346.0, 2524594.0, 2367768.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 19	Epoch: 0	Loss: 0.640007
Client Index = 19	Epoch: 1	Loss: 0.540502
Client Index = 19	Epoch: 2	Loss: 0.499543
Client Index = 19	Epoch: 3	Loss: 0.702924
Client Index = 19	Epoch: 4	Loss: 0.461993
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5708781149545685}
################local_test_on_all_clients after local training in communication round: 35
{'test_acc_after': 0.7026819438377288, 'test_loss_after': 0.9373977491751015}
################local_test_on_all_clients before local training in communication round: 35
{'test_acc_before': 0.6792494203901578, 'test_loss_before': 0.9493499932992924}
################Communication round : 36
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 0
local mask changes: 2333578.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2333578.0, 2492614.0, 2491404.0]
Doing local aggregation!
test acc on this client before 370 / 503 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.584272
Client Index = 0	Epoch: 1	Loss: 0.579892
Client Index = 0	Epoch: 2	Loss: 0.578973
Client Index = 0	Epoch: 3	Loss: 0.473978
Client Index = 0	Epoch: 4	Loss: 0.502776
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 1
local mask changes: 2334362.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2492228.0, 2334362.0, 2489674.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.496309
Client Index = 1	Epoch: 1	Loss: 0.384501
Client Index = 1	Epoch: 2	Loss: 0.527097
Client Index = 1	Epoch: 3	Loss: 0.339986
Client Index = 1	Epoch: 4	Loss: 0.342073
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 2
local mask changes: 2335916.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2491732.0, 2335916.0, 2493886.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.291389
Client Index = 2	Epoch: 1	Loss: 0.264312
Client Index = 2	Epoch: 2	Loss: 0.259597
Client Index = 2	Epoch: 3	Loss: 0.229267
Client Index = 2	Epoch: 4	Loss: 0.190840
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 3
local mask changes: 2332496.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2493620.0, 2332496.0, 2494442.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.428406
Client Index = 3	Epoch: 1	Loss: 0.452799
Client Index = 3	Epoch: 2	Loss: 0.330597
Client Index = 3	Epoch: 3	Loss: 0.526867
Client Index = 3	Epoch: 4	Loss: 0.366015
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 4
local mask changes: 2333926.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2494680.0, 2333926.0, 2494656.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 4	Epoch: 0	Loss: 0.602629
Client Index = 4	Epoch: 1	Loss: 0.633748
Client Index = 4	Epoch: 2	Loss: 0.539690
Client Index = 4	Epoch: 3	Loss: 0.592576
Client Index = 4	Epoch: 4	Loss: 0.510119
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 5
local mask changes: 2332252.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2492862.0, 2332252.0, 2493466.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.582461
Client Index = 5	Epoch: 1	Loss: 0.579725
Client Index = 5	Epoch: 2	Loss: 0.600243
Client Index = 5	Epoch: 3	Loss: 0.556449
Client Index = 5	Epoch: 4	Loss: 0.681803
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 6
local mask changes: 2335026.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2491080.0, 2335026.0, 2492806.0]
Doing local aggregation!
test acc on this client before 294 / 505 : 0.58
Client Index = 6	Epoch: 0	Loss: 0.674260
Client Index = 6	Epoch: 1	Loss: 0.720608
Client Index = 6	Epoch: 2	Loss: 0.630025
Client Index = 6	Epoch: 3	Loss: 0.564798
Client Index = 6	Epoch: 4	Loss: 0.619856
test acc on this client after 333 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 7
local mask changes: 2333928.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2492656.0, 2333928.0, 2492016.0]
Doing local aggregation!
test acc on this client before 303 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.988453
Client Index = 7	Epoch: 1	Loss: 0.805982
Client Index = 7	Epoch: 2	Loss: 0.845619
Client Index = 7	Epoch: 3	Loss: 0.838350
Client Index = 7	Epoch: 4	Loss: 0.762138
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 8
local mask changes: 2334890.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2490040.0, 2334890.0, 2493372.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.306525
Client Index = 8	Epoch: 1	Loss: 0.208028
Client Index = 8	Epoch: 2	Loss: 0.210698
Client Index = 8	Epoch: 3	Loss: 0.310809
Client Index = 8	Epoch: 4	Loss: 0.200197
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 9
local mask changes: 2333788.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2493302.0, 2333788.0, 2493968.0]
Doing local aggregation!
test acc on this client before 332 / 506 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.778960
Client Index = 9	Epoch: 1	Loss: 0.611914
Client Index = 9	Epoch: 2	Loss: 0.632951
Client Index = 9	Epoch: 3	Loss: 0.613703
Client Index = 9	Epoch: 4	Loss: 0.540201
test acc on this client after 316 / 506 : 0.62
-----------------------------------
training flops per data 2653335040.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 10
local mask changes: 2336594.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2493000.0, 2336594.0, 2493540.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.783318
Client Index = 10	Epoch: 1	Loss: 0.730682
Client Index = 10	Epoch: 2	Loss: 0.657015
Client Index = 10	Epoch: 3	Loss: 0.656249
Client Index = 10	Epoch: 4	Loss: 0.562871
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653320192.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 11
local mask changes: 2334490.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2491542.0, 2334490.0, 2491138.0]
Doing local aggregation!
test acc on this client before 316 / 505 : 0.63
Client Index = 11	Epoch: 0	Loss: 0.587857
Client Index = 11	Epoch: 1	Loss: 0.439136
Client Index = 11	Epoch: 2	Loss: 0.396382
Client Index = 11	Epoch: 3	Loss: 0.282210
Client Index = 11	Epoch: 4	Loss: 0.458840
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653282816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 12
local mask changes: 2332932.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2493408.0, 2332932.0, 2490760.0]
Doing local aggregation!
test acc on this client before 297 / 504 : 0.59
Client Index = 12	Epoch: 0	Loss: 0.749724
Client Index = 12	Epoch: 1	Loss: 0.619406
Client Index = 12	Epoch: 2	Loss: 0.649045
Client Index = 12	Epoch: 3	Loss: 0.555529
Client Index = 12	Epoch: 4	Loss: 0.810949
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653313536.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 13
local mask changes: 2333214.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2490984.0, 2333214.0, 2489150.0]
Doing local aggregation!
test acc on this client before 363 / 505 : 0.72
Client Index = 13	Epoch: 0	Loss: 0.629359
Client Index = 13	Epoch: 1	Loss: 0.648810
Client Index = 13	Epoch: 2	Loss: 0.531500
Client Index = 13	Epoch: 3	Loss: 0.492709
Client Index = 13	Epoch: 4	Loss: 0.561785
test acc on this client after 361 / 505 : 0.71
-----------------------------------
training flops per data 2653315584.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 14
local mask changes: 2334390.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2489774.0, 2334390.0, 2490340.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.703446
Client Index = 14	Epoch: 1	Loss: 0.704631
Client Index = 14	Epoch: 2	Loss: 0.741075
Client Index = 14	Epoch: 3	Loss: 0.605652
Client Index = 14	Epoch: 4	Loss: 0.630726
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653310208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 15
local mask changes: 2333796.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2488708.0, 2333796.0, 2489078.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.537378
Client Index = 15	Epoch: 1	Loss: 0.538838
Client Index = 15	Epoch: 2	Loss: 0.459561
Client Index = 15	Epoch: 3	Loss: 0.522564
Client Index = 15	Epoch: 4	Loss: 0.455180
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653311744.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 16
local mask changes: 2332980.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2488564.0, 2332980.0, 2490506.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 16	Epoch: 0	Loss: 0.691874
Client Index = 16	Epoch: 1	Loss: 0.566723
Client Index = 16	Epoch: 2	Loss: 0.624608
Client Index = 16	Epoch: 3	Loss: 0.482884
Client Index = 16	Epoch: 4	Loss: 0.528581
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653312512.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 17
local mask changes: 2334366.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2490090.0, 2334366.0, 2492800.0]
Doing local aggregation!
test acc on this client before 270 / 503 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.807126
Client Index = 17	Epoch: 1	Loss: 0.773184
Client Index = 17	Epoch: 2	Loss: 0.814282
Client Index = 17	Epoch: 3	Loss: 0.692937
Client Index = 17	Epoch: 4	Loss: 0.684650
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653298688.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 18
local mask changes: 2334468.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2491332.0, 2334468.0, 2491972.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.599027
Client Index = 18	Epoch: 1	Loss: 0.608251
Client Index = 18	Epoch: 2	Loss: 0.474223
Client Index = 18	Epoch: 3	Loss: 0.500463
Client Index = 18	Epoch: 4	Loss: 0.435344
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653304832.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 19
local mask changes: 2334270.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2493694.0, 2491752.0, 2334270.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 19	Epoch: 0	Loss: 0.696407
Client Index = 19	Epoch: 1	Loss: 0.640972
Client Index = 19	Epoch: 2	Loss: 0.483704
Client Index = 19	Epoch: 3	Loss: 0.492327
Client Index = 19	Epoch: 4	Loss: 0.557435
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5575089511759579}
################local_test_on_all_clients after local training in communication round: 36
{'test_acc_after': 0.7301835686544589, 'test_loss_after': 0.8400755538227804}
################local_test_on_all_clients before local training in communication round: 36
{'test_acc_before': 0.691470776575515, 'test_loss_before': 0.926229293750688}
################Communication round : 37
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 0
local mask changes: 2299062.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2299062.0, 2457790.0, 2457224.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.734556
Client Index = 0	Epoch: 1	Loss: 0.532216
Client Index = 0	Epoch: 2	Loss: 0.557931
Client Index = 0	Epoch: 3	Loss: 0.534102
Client Index = 0	Epoch: 4	Loss: 0.450831
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 1
local mask changes: 2299946.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2459768.0, 2299946.0, 2457356.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 1	Epoch: 0	Loss: 0.415020
Client Index = 1	Epoch: 1	Loss: 0.478651
Client Index = 1	Epoch: 2	Loss: 0.310043
Client Index = 1	Epoch: 3	Loss: 0.547882
Client Index = 1	Epoch: 4	Loss: 0.290341
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 2
local mask changes: 2298916.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2455896.0, 2298916.0, 2459440.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.318938
Client Index = 2	Epoch: 1	Loss: 0.237528
Client Index = 2	Epoch: 2	Loss: 0.200936
Client Index = 2	Epoch: 3	Loss: 0.266207
Client Index = 2	Epoch: 4	Loss: 0.225658
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 3
local mask changes: 2298960.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2458882.0, 2298960.0, 2460388.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.503546
Client Index = 3	Epoch: 1	Loss: 0.363094
Client Index = 3	Epoch: 2	Loss: 0.382632
Client Index = 3	Epoch: 3	Loss: 0.382841
Client Index = 3	Epoch: 4	Loss: 0.378163
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 4
local mask changes: 2298242.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2460106.0, 2298242.0, 2456036.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.605282
Client Index = 4	Epoch: 1	Loss: 0.599053
Client Index = 4	Epoch: 2	Loss: 0.642979
Client Index = 4	Epoch: 3	Loss: 0.553999
Client Index = 4	Epoch: 4	Loss: 0.491759
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 5
local mask changes: 2299498.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2458870.0, 2299498.0, 2457362.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 5	Epoch: 0	Loss: 0.646177
Client Index = 5	Epoch: 1	Loss: 0.554679
Client Index = 5	Epoch: 2	Loss: 0.541684
Client Index = 5	Epoch: 3	Loss: 0.519070
Client Index = 5	Epoch: 4	Loss: 0.711510
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 6
local mask changes: 2300708.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2456340.0, 2300708.0, 2460374.0]
Doing local aggregation!
test acc on this client before 306 / 505 : 0.61
Client Index = 6	Epoch: 0	Loss: 0.716414
Client Index = 6	Epoch: 1	Loss: 0.784608
Client Index = 6	Epoch: 2	Loss: 0.566321
Client Index = 6	Epoch: 3	Loss: 0.637152
Client Index = 6	Epoch: 4	Loss: 0.588959
test acc on this client after 350 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 7
local mask changes: 2299190.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2457494.0, 2299190.0, 2456708.0]
Doing local aggregation!
test acc on this client before 302 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.930219
Client Index = 7	Epoch: 1	Loss: 0.837455
Client Index = 7	Epoch: 2	Loss: 0.780097
Client Index = 7	Epoch: 3	Loss: 0.817868
Client Index = 7	Epoch: 4	Loss: 0.805155
test acc on this client after 300 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 8
local mask changes: 2299036.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2457066.0, 2299036.0, 2458616.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.242075
Client Index = 8	Epoch: 1	Loss: 0.222574
Client Index = 8	Epoch: 2	Loss: 0.387873
Client Index = 8	Epoch: 3	Loss: 0.183785
Client Index = 8	Epoch: 4	Loss: 0.194444
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 9
local mask changes: 2301900.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2458100.0, 2301900.0, 2459144.0]
Doing local aggregation!
test acc on this client before 315 / 506 : 0.62
Client Index = 9	Epoch: 0	Loss: 0.682063
Client Index = 9	Epoch: 1	Loss: 0.633241
Client Index = 9	Epoch: 2	Loss: 0.617556
Client Index = 9	Epoch: 3	Loss: 0.616153
Client Index = 9	Epoch: 4	Loss: 0.657779
test acc on this client after 324 / 506 : 0.64
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 10
local mask changes: 2300074.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2458962.0, 2300074.0, 2457830.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.724641
Client Index = 10	Epoch: 1	Loss: 0.761391
Client Index = 10	Epoch: 2	Loss: 0.617079
Client Index = 10	Epoch: 3	Loss: 0.664758
Client Index = 10	Epoch: 4	Loss: 0.609669
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 11
local mask changes: 2299584.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2458818.0, 2299584.0, 2458238.0]
Doing local aggregation!
test acc on this client before 316 / 505 : 0.63
Client Index = 11	Epoch: 0	Loss: 0.498700
Client Index = 11	Epoch: 1	Loss: 0.379710
Client Index = 11	Epoch: 2	Loss: 0.287098
Client Index = 11	Epoch: 3	Loss: 0.282878
Client Index = 11	Epoch: 4	Loss: 0.416831
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653314816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 12
local mask changes: 2298752.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2458386.0, 2298752.0, 2456894.0]
Doing local aggregation!
test acc on this client before 311 / 504 : 0.62
Client Index = 12	Epoch: 0	Loss: 0.707554
Client Index = 12	Epoch: 1	Loss: 0.662721
Client Index = 12	Epoch: 2	Loss: 0.591328
Client Index = 12	Epoch: 3	Loss: 0.590040
Client Index = 12	Epoch: 4	Loss: 0.599850
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 13
local mask changes: 2300440.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2455690.0, 2300440.0, 2454276.0]
Doing local aggregation!
test acc on this client before 372 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.588839
Client Index = 13	Epoch: 1	Loss: 0.560346
Client Index = 13	Epoch: 2	Loss: 0.553310
Client Index = 13	Epoch: 3	Loss: 0.540044
Client Index = 13	Epoch: 4	Loss: 0.549449
test acc on this client after 323 / 505 : 0.64
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 14
local mask changes: 2298814.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2455044.0, 2298814.0, 2454504.0]
Doing local aggregation!
test acc on this client before 345 / 503 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.696175
Client Index = 14	Epoch: 1	Loss: 0.635409
Client Index = 14	Epoch: 2	Loss: 0.687964
Client Index = 14	Epoch: 3	Loss: 0.507445
Client Index = 14	Epoch: 4	Loss: 0.591461
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653309952.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 15
local mask changes: 2298394.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2455382.0, 2298394.0, 2452834.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.549502
Client Index = 15	Epoch: 1	Loss: 0.495932
Client Index = 15	Epoch: 2	Loss: 0.473541
Client Index = 15	Epoch: 3	Loss: 0.551376
Client Index = 15	Epoch: 4	Loss: 0.420527
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 16
local mask changes: 2299248.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2454430.0, 2299248.0, 2454904.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.631164
Client Index = 16	Epoch: 1	Loss: 0.603039
Client Index = 16	Epoch: 2	Loss: 0.515011
Client Index = 16	Epoch: 3	Loss: 0.546502
Client Index = 16	Epoch: 4	Loss: 0.468103
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653314816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 17
local mask changes: 2299622.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2455816.0, 2299622.0, 2457530.0]
Doing local aggregation!
test acc on this client before 260 / 503 : 0.52
Client Index = 17	Epoch: 0	Loss: 0.799755
Client Index = 17	Epoch: 1	Loss: 0.692646
Client Index = 17	Epoch: 2	Loss: 0.749033
Client Index = 17	Epoch: 3	Loss: 0.757212
Client Index = 17	Epoch: 4	Loss: 0.614602
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 18
local mask changes: 2301130.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2456742.0, 2301130.0, 2455984.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.602426
Client Index = 18	Epoch: 1	Loss: 0.532498
Client Index = 18	Epoch: 2	Loss: 0.512550
Client Index = 18	Epoch: 3	Loss: 0.393626
Client Index = 18	Epoch: 4	Loss: 0.499714
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653299456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 19
local mask changes: 2299826.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2458998.0, 2456344.0, 2299826.0]
Doing local aggregation!
test acc on this client before 364 / 503 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.630133
Client Index = 19	Epoch: 1	Loss: 0.593603
Client Index = 19	Epoch: 2	Loss: 0.549764
Client Index = 19	Epoch: 3	Loss: 0.491574
Client Index = 19	Epoch: 4	Loss: 0.515210
test acc on this client after 267 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5437283076476305}
################local_test_on_all_clients after local training in communication round: 37
{'test_acc_after': 0.7106046333026917, 'test_loss_after': 0.9423483716984853}
################local_test_on_all_clients before local training in communication round: 37
{'test_acc_before': 0.6972270882268944, 'test_loss_before': 0.9087645536149733}
################Communication round : 38
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 0
local mask changes: 2266458.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2266458.0, 2423040.0, 2421880.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 0	Epoch: 0	Loss: 0.677338
Client Index = 0	Epoch: 1	Loss: 0.502858
Client Index = 0	Epoch: 2	Loss: 0.544532
Client Index = 0	Epoch: 3	Loss: 0.605214
Client Index = 0	Epoch: 4	Loss: 0.482607
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 1
local mask changes: 2264058.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2424034.0, 2264058.0, 2422582.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.427722
Client Index = 1	Epoch: 1	Loss: 0.346717
Client Index = 1	Epoch: 2	Loss: 0.311550
Client Index = 1	Epoch: 3	Loss: 0.463894
Client Index = 1	Epoch: 4	Loss: 0.302917
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 2
local mask changes: 2263750.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2422616.0, 2263750.0, 2422872.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.261455
Client Index = 2	Epoch: 1	Loss: 0.225675
Client Index = 2	Epoch: 2	Loss: 0.296181
Client Index = 2	Epoch: 3	Loss: 0.359191
Client Index = 2	Epoch: 4	Loss: 0.171931
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 3
local mask changes: 2264062.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2421564.0, 2264062.0, 2424532.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.459516
Client Index = 3	Epoch: 1	Loss: 0.357002
Client Index = 3	Epoch: 2	Loss: 0.398868
Client Index = 3	Epoch: 3	Loss: 0.362179
Client Index = 3	Epoch: 4	Loss: 0.343250
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 4
local mask changes: 2265074.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2424144.0, 2265074.0, 2423090.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.683736
Client Index = 4	Epoch: 1	Loss: 0.564447
Client Index = 4	Epoch: 2	Loss: 0.502213
Client Index = 4	Epoch: 3	Loss: 0.535972
Client Index = 4	Epoch: 4	Loss: 0.498974
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 5
local mask changes: 2265210.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2420980.0, 2265210.0, 2423324.0]
Doing local aggregation!
test acc on this client before 328 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.599802
Client Index = 5	Epoch: 1	Loss: 0.696605
Client Index = 5	Epoch: 2	Loss: 0.517901
Client Index = 5	Epoch: 3	Loss: 0.509171
Client Index = 5	Epoch: 4	Loss: 0.528339
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 6
local mask changes: 2265848.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2421722.0, 2265848.0, 2425230.0]
Doing local aggregation!
test acc on this client before 324 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.662593
Client Index = 6	Epoch: 1	Loss: 0.703890
Client Index = 6	Epoch: 2	Loss: 0.582979
Client Index = 6	Epoch: 3	Loss: 0.566950
Client Index = 6	Epoch: 4	Loss: 0.536913
test acc on this client after 274 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 7
local mask changes: 2264900.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2426088.0, 2264900.0, 2422714.0]
Doing local aggregation!
test acc on this client before 305 / 504 : 0.61
Client Index = 7	Epoch: 0	Loss: 0.962951
Client Index = 7	Epoch: 1	Loss: 0.750440
Client Index = 7	Epoch: 2	Loss: 0.750946
Client Index = 7	Epoch: 3	Loss: 0.796251
Client Index = 7	Epoch: 4	Loss: 0.735437
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 8
local mask changes: 2266986.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2420370.0, 2266986.0, 2422832.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 8	Epoch: 0	Loss: 0.260380
Client Index = 8	Epoch: 1	Loss: 0.257946
Client Index = 8	Epoch: 2	Loss: 0.171910
Client Index = 8	Epoch: 3	Loss: 0.169017
Client Index = 8	Epoch: 4	Loss: 0.380623
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 9
local mask changes: 2265442.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2426416.0, 2265442.0, 2423818.0]
Doing local aggregation!
test acc on this client before 319 / 506 : 0.63
Client Index = 9	Epoch: 0	Loss: 0.616104
Client Index = 9	Epoch: 1	Loss: 0.696825
Client Index = 9	Epoch: 2	Loss: 0.606514
Client Index = 9	Epoch: 3	Loss: 0.562052
Client Index = 9	Epoch: 4	Loss: 0.520981
test acc on this client after 370 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 10
local mask changes: 2264296.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2423758.0, 2264296.0, 2422748.0]
Doing local aggregation!
test acc on this client before 346 / 503 : 0.69
Client Index = 10	Epoch: 0	Loss: 0.691924
Client Index = 10	Epoch: 1	Loss: 0.679230
Client Index = 10	Epoch: 2	Loss: 0.661944
Client Index = 10	Epoch: 3	Loss: 0.568591
Client Index = 10	Epoch: 4	Loss: 0.661722
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653335552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 11
local mask changes: 2265830.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2421660.0, 2265830.0, 2422254.0]
Doing local aggregation!
test acc on this client before 324 / 505 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.460329
Client Index = 11	Epoch: 1	Loss: 0.362256
Client Index = 11	Epoch: 2	Loss: 0.340130
Client Index = 11	Epoch: 3	Loss: 0.320161
Client Index = 11	Epoch: 4	Loss: 0.302687
test acc on this client after 387 / 505 : 0.77
-----------------------------------
training flops per data 2653296128.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 12
local mask changes: 2265714.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2420608.0, 2265714.0, 2420348.0]
Doing local aggregation!
test acc on this client before 283 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 0.698451
Client Index = 12	Epoch: 1	Loss: 0.803348
Client Index = 12	Epoch: 2	Loss: 0.572553
Client Index = 12	Epoch: 3	Loss: 0.604671
Client Index = 12	Epoch: 4	Loss: 0.573346
test acc on this client after 296 / 504 : 0.59
-----------------------------------
training flops per data 2653306880.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 13
local mask changes: 2265008.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2419662.0, 2265008.0, 2420812.0]
Doing local aggregation!
test acc on this client before 372 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.572545
Client Index = 13	Epoch: 1	Loss: 0.537811
Client Index = 13	Epoch: 2	Loss: 0.709385
Client Index = 13	Epoch: 3	Loss: 0.513664
Client Index = 13	Epoch: 4	Loss: 0.554091
test acc on this client after 365 / 505 : 0.72
-----------------------------------
training flops per data 2653314816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 14
local mask changes: 2266826.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2419574.0, 2266826.0, 2419166.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 14	Epoch: 0	Loss: 0.628836
Client Index = 14	Epoch: 1	Loss: 0.642796
Client Index = 14	Epoch: 2	Loss: 0.627064
Client Index = 14	Epoch: 3	Loss: 0.556530
Client Index = 14	Epoch: 4	Loss: 0.616426
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653305344.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 15
local mask changes: 2266406.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2419492.0, 2266406.0, 2419852.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.626234
Client Index = 15	Epoch: 1	Loss: 0.495866
Client Index = 15	Epoch: 2	Loss: 0.458120
Client Index = 15	Epoch: 3	Loss: 0.389843
Client Index = 15	Epoch: 4	Loss: 0.568784
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653308672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 16
local mask changes: 2264434.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2420182.0, 2264434.0, 2421368.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 16	Epoch: 0	Loss: 0.691047
Client Index = 16	Epoch: 1	Loss: 0.537247
Client Index = 16	Epoch: 2	Loss: 0.529664
Client Index = 16	Epoch: 3	Loss: 0.557323
Client Index = 16	Epoch: 4	Loss: 0.445084
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653308416.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 17
local mask changes: 2264986.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2419726.0, 2264986.0, 2420312.0]
Doing local aggregation!
test acc on this client before 279 / 503 : 0.55
Client Index = 17	Epoch: 0	Loss: 0.879414
Client Index = 17	Epoch: 1	Loss: 0.697403
Client Index = 17	Epoch: 2	Loss: 0.709099
Client Index = 17	Epoch: 3	Loss: 0.658970
Client Index = 17	Epoch: 4	Loss: 0.708391
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653314560.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 18
local mask changes: 2263838.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2422312.0, 2263838.0, 2421982.0]
Doing local aggregation!
test acc on this client before 341 / 503 : 0.68
Client Index = 18	Epoch: 0	Loss: 0.629286
Client Index = 18	Epoch: 1	Loss: 0.466534
Client Index = 18	Epoch: 2	Loss: 0.474001
Client Index = 18	Epoch: 3	Loss: 0.459459
Client Index = 18	Epoch: 4	Loss: 0.413804
test acc on this client after 257 / 503 : 0.51
-----------------------------------
training flops per data 2653289472.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 19
local mask changes: 2265660.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2423318.0, 2422234.0, 2265660.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.701307
Client Index = 19	Epoch: 1	Loss: 0.533155
Client Index = 19	Epoch: 2	Loss: 0.520598
Client Index = 19	Epoch: 3	Loss: 0.481306
Client Index = 19	Epoch: 4	Loss: 0.478077
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5319996395595371}
################local_test_on_all_clients after local training in communication round: 38
{'test_acc_after': 0.7054392791501221, 'test_loss_after': 1.0017336414953624}
################local_test_on_all_clients before local training in communication round: 38
{'test_acc_before': 0.6911589633257315, 'test_loss_before': 0.9207037494262875}
################Communication round : 39
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 0
local mask changes: 2229132.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2229132.0, 2385672.0, 2385898.0]
Doing local aggregation!
test acc on this client before 364 / 503 : 0.72
Client Index = 0	Epoch: 0	Loss: 0.655732
Client Index = 0	Epoch: 1	Loss: 0.559455
Client Index = 0	Epoch: 2	Loss: 0.468346
Client Index = 0	Epoch: 3	Loss: 0.490104
Client Index = 0	Epoch: 4	Loss: 0.469925
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 1
local mask changes: 2228612.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2387460.0, 2228612.0, 2386688.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 1	Epoch: 0	Loss: 0.479683
Client Index = 1	Epoch: 1	Loss: 0.356579
Client Index = 1	Epoch: 2	Loss: 0.314796
Client Index = 1	Epoch: 3	Loss: 0.321305
Client Index = 1	Epoch: 4	Loss: 0.395760
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 2
local mask changes: 2229592.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2385872.0, 2229592.0, 2386486.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.282427
Client Index = 2	Epoch: 1	Loss: 0.212558
Client Index = 2	Epoch: 2	Loss: 0.213211
Client Index = 2	Epoch: 3	Loss: 0.450654
Client Index = 2	Epoch: 4	Loss: 0.198124
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 3
local mask changes: 2228516.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2386842.0, 2228516.0, 2387468.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.482526
Client Index = 3	Epoch: 1	Loss: 0.454274
Client Index = 3	Epoch: 2	Loss: 0.317095
Client Index = 3	Epoch: 3	Loss: 0.342055
Client Index = 3	Epoch: 4	Loss: 0.471909
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 4
local mask changes: 2228710.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2388876.0, 2228710.0, 2388092.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.579120
Client Index = 4	Epoch: 1	Loss: 0.602226
Client Index = 4	Epoch: 2	Loss: 0.505835
Client Index = 4	Epoch: 3	Loss: 0.567872
Client Index = 4	Epoch: 4	Loss: 0.504596
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 5
local mask changes: 2229326.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2386112.0, 2229326.0, 2386500.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 5	Epoch: 0	Loss: 0.625524
Client Index = 5	Epoch: 1	Loss: 0.542770
Client Index = 5	Epoch: 2	Loss: 0.586355
Client Index = 5	Epoch: 3	Loss: 0.489431
Client Index = 5	Epoch: 4	Loss: 0.504074
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 6
local mask changes: 2228522.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2388044.0, 2228522.0, 2387904.0]
Doing local aggregation!
test acc on this client before 325 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.726322
Client Index = 6	Epoch: 1	Loss: 0.575406
Client Index = 6	Epoch: 2	Loss: 0.637280
Client Index = 6	Epoch: 3	Loss: 0.543289
Client Index = 6	Epoch: 4	Loss: 0.672985
test acc on this client after 346 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 7
local mask changes: 2229550.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2386358.0, 2229550.0, 2386702.0]
Doing local aggregation!
test acc on this client before 311 / 504 : 0.62
Client Index = 7	Epoch: 0	Loss: 0.875793
Client Index = 7	Epoch: 1	Loss: 0.894108
Client Index = 7	Epoch: 2	Loss: 0.704712
Client Index = 7	Epoch: 3	Loss: 0.719629
Client Index = 7	Epoch: 4	Loss: 0.811850
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 8
local mask changes: 2228494.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2385756.0, 2228494.0, 2388448.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.396824
Client Index = 8	Epoch: 1	Loss: 0.173210
Client Index = 8	Epoch: 2	Loss: 0.154259
Client Index = 8	Epoch: 3	Loss: 0.171317
Client Index = 8	Epoch: 4	Loss: 0.174658
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 9
local mask changes: 2229490.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2388378.0, 2229490.0, 2386718.0]
Doing local aggregation!
test acc on this client before 316 / 506 : 0.62
Client Index = 9	Epoch: 0	Loss: 0.646585
Client Index = 9	Epoch: 1	Loss: 0.620228
Client Index = 9	Epoch: 2	Loss: 0.632870
Client Index = 9	Epoch: 3	Loss: 0.551939
Client Index = 9	Epoch: 4	Loss: 0.498361
test acc on this client after 360 / 506 : 0.71
-----------------------------------
training flops per data 2653336576.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 10
local mask changes: 2230148.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2386486.0, 2230148.0, 2387680.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.697438
Client Index = 10	Epoch: 1	Loss: 0.710293
Client Index = 10	Epoch: 2	Loss: 0.630829
Client Index = 10	Epoch: 3	Loss: 0.583462
Client Index = 10	Epoch: 4	Loss: 0.548916
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 11
local mask changes: 2230704.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2387196.0, 2230704.0, 2387042.0]
Doing local aggregation!
test acc on this client before 340 / 505 : 0.67
Client Index = 11	Epoch: 0	Loss: 0.470416
Client Index = 11	Epoch: 1	Loss: 0.274090
Client Index = 11	Epoch: 2	Loss: 0.420098
Client Index = 11	Epoch: 3	Loss: 0.229254
Client Index = 11	Epoch: 4	Loss: 0.383158
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 12
local mask changes: 2228986.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2385874.0, 2228986.0, 2384682.0]
Doing local aggregation!
test acc on this client before 299 / 504 : 0.59
Client Index = 12	Epoch: 0	Loss: 0.708180
Client Index = 12	Epoch: 1	Loss: 0.553353
Client Index = 12	Epoch: 2	Loss: 0.635798
Client Index = 12	Epoch: 3	Loss: 0.596106
Client Index = 12	Epoch: 4	Loss: 0.549681
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 13
local mask changes: 2229722.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2386210.0, 2229722.0, 2384652.0]
Doing local aggregation!
test acc on this client before 389 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.567464
Client Index = 13	Epoch: 1	Loss: 0.619416
Client Index = 13	Epoch: 2	Loss: 0.538682
Client Index = 13	Epoch: 3	Loss: 0.633531
Client Index = 13	Epoch: 4	Loss: 0.378491
test acc on this client after 352 / 505 : 0.70
-----------------------------------
training flops per data 2653310208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 14
local mask changes: 2229536.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2383638.0, 2229536.0, 2382886.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 14	Epoch: 0	Loss: 0.673027
Client Index = 14	Epoch: 1	Loss: 0.660802
Client Index = 14	Epoch: 2	Loss: 0.564385
Client Index = 14	Epoch: 3	Loss: 0.567529
Client Index = 14	Epoch: 4	Loss: 0.562173
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653303808.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 15
local mask changes: 2229288.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2383108.0, 2229288.0, 2381064.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.499858
Client Index = 15	Epoch: 1	Loss: 0.464209
Client Index = 15	Epoch: 2	Loss: 0.503090
Client Index = 15	Epoch: 3	Loss: 0.420870
Client Index = 15	Epoch: 4	Loss: 0.528415
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653306368.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 16
local mask changes: 2228974.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2382350.0, 2228974.0, 2383552.0]
Doing local aggregation!
test acc on this client before 308 / 504 : 0.61
Client Index = 16	Epoch: 0	Loss: 0.617154
Client Index = 16	Epoch: 1	Loss: 0.518470
Client Index = 16	Epoch: 2	Loss: 0.511692
Client Index = 16	Epoch: 3	Loss: 0.482493
Client Index = 16	Epoch: 4	Loss: 0.488233
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 17
local mask changes: 2229180.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2384148.0, 2229180.0, 2384878.0]
Doing local aggregation!
test acc on this client before 268 / 503 : 0.53
Client Index = 17	Epoch: 0	Loss: 0.757090
Client Index = 17	Epoch: 1	Loss: 0.707559
Client Index = 17	Epoch: 2	Loss: 0.637870
Client Index = 17	Epoch: 3	Loss: 0.609279
Client Index = 17	Epoch: 4	Loss: 0.661561
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 18
local mask changes: 2228486.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2386332.0, 2228486.0, 2385794.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 18	Epoch: 0	Loss: 0.497485
Client Index = 18	Epoch: 1	Loss: 0.541637
Client Index = 18	Epoch: 2	Loss: 0.413874
Client Index = 18	Epoch: 3	Loss: 0.634040
Client Index = 18	Epoch: 4	Loss: 0.439412
test acc on this client after 264 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 19
local mask changes: 2228872.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2387332.0, 2385032.0, 2228872.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.472412
Client Index = 19	Epoch: 1	Loss: 0.720088
Client Index = 19	Epoch: 2	Loss: 0.548756
Client Index = 19	Epoch: 3	Loss: 0.468085
Client Index = 19	Epoch: 4	Loss: 0.598844
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5212499777935446}
################local_test_on_all_clients after local training in communication round: 39
{'test_acc_after': 0.7301440651748887, 'test_loss_after': 0.8712846055277842}
################local_test_on_all_clients before local training in communication round: 39
{'test_acc_before': 0.6887709302307186, 'test_loss_before': 0.9246644163703663}
################Communication round : 40
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 0
local mask changes: 2192880.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2192880.0, 2351088.0, 2349544.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.645263
Client Index = 0	Epoch: 1	Loss: 0.481097
Client Index = 0	Epoch: 2	Loss: 0.492002
Client Index = 0	Epoch: 3	Loss: 0.475884
Client Index = 0	Epoch: 4	Loss: 0.438923
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 1
local mask changes: 2191814.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2349984.0, 2191814.0, 2348700.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.447788
Client Index = 1	Epoch: 1	Loss: 0.534814
Client Index = 1	Epoch: 2	Loss: 0.280745
Client Index = 1	Epoch: 3	Loss: 0.379618
Client Index = 1	Epoch: 4	Loss: 0.257029
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 2
local mask changes: 2193590.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2351008.0, 2193590.0, 2349982.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.249104
Client Index = 2	Epoch: 1	Loss: 0.212520
Client Index = 2	Epoch: 2	Loss: 0.204608
Client Index = 2	Epoch: 3	Loss: 0.179078
Client Index = 2	Epoch: 4	Loss: 0.198656
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 3
local mask changes: 2192050.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2350356.0, 2192050.0, 2351232.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.349397
Client Index = 3	Epoch: 1	Loss: 0.481607
Client Index = 3	Epoch: 2	Loss: 0.394371
Client Index = 3	Epoch: 3	Loss: 0.297674
Client Index = 3	Epoch: 4	Loss: 0.334462
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 4
local mask changes: 2194314.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2351082.0, 2194314.0, 2348848.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.646535
Client Index = 4	Epoch: 1	Loss: 0.524136
Client Index = 4	Epoch: 2	Loss: 0.511921
Client Index = 4	Epoch: 3	Loss: 0.502845
Client Index = 4	Epoch: 4	Loss: 0.480142
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 5
local mask changes: 2193220.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2348884.0, 2193220.0, 2348676.0]
Doing local aggregation!
test acc on this client before 345 / 503 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.644927
Client Index = 5	Epoch: 1	Loss: 0.525655
Client Index = 5	Epoch: 2	Loss: 0.573699
Client Index = 5	Epoch: 3	Loss: 0.446679
Client Index = 5	Epoch: 4	Loss: 0.530171
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 6
local mask changes: 2192566.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2350430.0, 2192566.0, 2351088.0]
Doing local aggregation!
test acc on this client before 305 / 505 : 0.60
Client Index = 6	Epoch: 0	Loss: 0.819535
Client Index = 6	Epoch: 1	Loss: 0.584874
Client Index = 6	Epoch: 2	Loss: 0.545202
Client Index = 6	Epoch: 3	Loss: 0.619273
Client Index = 6	Epoch: 4	Loss: 0.448518
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 7
local mask changes: 2191906.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2348886.0, 2191906.0, 2350532.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.881912
Client Index = 7	Epoch: 1	Loss: 0.750598
Client Index = 7	Epoch: 2	Loss: 0.815412
Client Index = 7	Epoch: 3	Loss: 0.669351
Client Index = 7	Epoch: 4	Loss: 0.851727
test acc on this client after 291 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 8
local mask changes: 2193868.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2346972.0, 2193868.0, 2349766.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.446240
Client Index = 8	Epoch: 1	Loss: 0.200063
Client Index = 8	Epoch: 2	Loss: 0.178060
Client Index = 8	Epoch: 3	Loss: 0.198584
Client Index = 8	Epoch: 4	Loss: 0.128347
test acc on this client after 454 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 9
local mask changes: 2191364.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2348826.0, 2191364.0, 2350020.0]
Doing local aggregation!
test acc on this client before 332 / 506 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.652500
Client Index = 9	Epoch: 1	Loss: 0.592130
Client Index = 9	Epoch: 2	Loss: 0.527681
Client Index = 9	Epoch: 3	Loss: 0.537980
Client Index = 9	Epoch: 4	Loss: 0.575364
test acc on this client after 329 / 506 : 0.65
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 10
local mask changes: 2192514.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2350846.0, 2192514.0, 2348432.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 10	Epoch: 0	Loss: 0.699043
Client Index = 10	Epoch: 1	Loss: 0.724776
Client Index = 10	Epoch: 2	Loss: 0.557830
Client Index = 10	Epoch: 3	Loss: 0.651597
Client Index = 10	Epoch: 4	Loss: 0.528300
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 11
local mask changes: 2192246.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2349506.0, 2192246.0, 2348142.0]
Doing local aggregation!
test acc on this client before 327 / 505 : 0.65
Client Index = 11	Epoch: 0	Loss: 0.400027
Client Index = 11	Epoch: 1	Loss: 0.323701
Client Index = 11	Epoch: 2	Loss: 0.292224
Client Index = 11	Epoch: 3	Loss: 0.307901
Client Index = 11	Epoch: 4	Loss: 0.295364
test acc on this client after 409 / 505 : 0.81
-----------------------------------
training flops per data 2653295104.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 12
local mask changes: 2192430.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2349286.0, 2192430.0, 2346988.0]
Doing local aggregation!
test acc on this client before 319 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.728941
Client Index = 12	Epoch: 1	Loss: 0.557361
Client Index = 12	Epoch: 2	Loss: 0.651390
Client Index = 12	Epoch: 3	Loss: 0.518058
Client Index = 12	Epoch: 4	Loss: 0.538480
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 13
local mask changes: 2192548.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2347652.0, 2192548.0, 2347982.0]
Doing local aggregation!
test acc on this client before 370 / 505 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.590151
Client Index = 13	Epoch: 1	Loss: 0.536753
Client Index = 13	Epoch: 2	Loss: 0.509142
Client Index = 13	Epoch: 3	Loss: 0.537673
Client Index = 13	Epoch: 4	Loss: 0.446813
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653305856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 14
local mask changes: 2194122.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2347454.0, 2194122.0, 2346934.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 14	Epoch: 0	Loss: 0.594231
Client Index = 14	Epoch: 1	Loss: 0.655798
Client Index = 14	Epoch: 2	Loss: 0.545253
Client Index = 14	Epoch: 3	Loss: 0.617198
Client Index = 14	Epoch: 4	Loss: 0.509129
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 15
local mask changes: 2193490.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2347660.0, 2193490.0, 2344948.0]
Doing local aggregation!
test acc on this client before 390 / 503 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.496406
Client Index = 15	Epoch: 1	Loss: 0.436190
Client Index = 15	Epoch: 2	Loss: 0.468497
Client Index = 15	Epoch: 3	Loss: 0.422945
Client Index = 15	Epoch: 4	Loss: 0.366567
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653298176.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 16
local mask changes: 2193116.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2347242.0, 2193116.0, 2347210.0]
Doing local aggregation!
test acc on this client before 333 / 504 : 0.66
Client Index = 16	Epoch: 0	Loss: 0.640148
Client Index = 16	Epoch: 1	Loss: 0.553636
Client Index = 16	Epoch: 2	Loss: 0.469911
Client Index = 16	Epoch: 3	Loss: 0.511199
Client Index = 16	Epoch: 4	Loss: 0.500574
test acc on this client after 264 / 504 : 0.52
-----------------------------------
training flops per data 2653307392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 17
local mask changes: 2193188.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2345468.0, 2193188.0, 2349024.0]
Doing local aggregation!
test acc on this client before 284 / 503 : 0.56
Client Index = 17	Epoch: 0	Loss: 0.748592
Client Index = 17	Epoch: 1	Loss: 0.758967
Client Index = 17	Epoch: 2	Loss: 0.588204
Client Index = 17	Epoch: 3	Loss: 0.628501
Client Index = 17	Epoch: 4	Loss: 0.631125
test acc on this client after 319 / 503 : 0.63
-----------------------------------
training flops per data 2653318656.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 18
local mask changes: 2192458.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2349824.0, 2192458.0, 2349342.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 18	Epoch: 0	Loss: 0.540928
Client Index = 18	Epoch: 1	Loss: 0.536035
Client Index = 18	Epoch: 2	Loss: 0.500611
Client Index = 18	Epoch: 3	Loss: 0.404736
Client Index = 18	Epoch: 4	Loss: 0.358258
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653302528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 19
local mask changes: 2192324.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2349082.0, 2347216.0, 2192324.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 19	Epoch: 0	Loss: 0.610007
Client Index = 19	Epoch: 1	Loss: 0.486280
Client Index = 19	Epoch: 2	Loss: 0.452676
Client Index = 19	Epoch: 3	Loss: 0.427107
Client Index = 19	Epoch: 4	Loss: 0.649716
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.5024965292476117}
################local_test_on_all_clients after local training in communication round: 40
{'test_acc_after': 0.7091114827219358, 'test_loss_after': 0.9671232354763826}
################local_test_on_all_clients before local training in communication round: 40
{'test_acc_before': 0.691753626076029, 'test_loss_before': 0.9136096415946809}
################Communication round : 41
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 0
local mask changes: 2153776.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2153776.0, 2311428.0, 2312418.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.574861
Client Index = 0	Epoch: 1	Loss: 0.471623
Client Index = 0	Epoch: 2	Loss: 0.460918
Client Index = 0	Epoch: 3	Loss: 0.530300
Client Index = 0	Epoch: 4	Loss: 0.366285
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 1
local mask changes: 2156580.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2310178.0, 2156580.0, 2310438.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.398828
Client Index = 1	Epoch: 1	Loss: 0.410270
Client Index = 1	Epoch: 2	Loss: 0.363527
Client Index = 1	Epoch: 3	Loss: 0.287670
Client Index = 1	Epoch: 4	Loss: 0.264128
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 2
local mask changes: 2156608.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2310908.0, 2156608.0, 2312480.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.239909
Client Index = 2	Epoch: 1	Loss: 0.245672
Client Index = 2	Epoch: 2	Loss: 0.216764
Client Index = 2	Epoch: 3	Loss: 0.202228
Client Index = 2	Epoch: 4	Loss: 0.180327
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 3
local mask changes: 2155014.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2312662.0, 2155014.0, 2313056.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.591568
Client Index = 3	Epoch: 1	Loss: 0.298531
Client Index = 3	Epoch: 2	Loss: 0.337893
Client Index = 3	Epoch: 3	Loss: 0.299808
Client Index = 3	Epoch: 4	Loss: 0.309177
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 4
local mask changes: 2156022.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2312744.0, 2156022.0, 2312986.0]
Doing local aggregation!
test acc on this client before 373 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.616545
Client Index = 4	Epoch: 1	Loss: 0.503787
Client Index = 4	Epoch: 2	Loss: 0.497384
Client Index = 4	Epoch: 3	Loss: 0.439217
Client Index = 4	Epoch: 4	Loss: 0.529005
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 5
local mask changes: 2155584.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2312770.0, 2155584.0, 2312806.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.578582
Client Index = 5	Epoch: 1	Loss: 0.523410
Client Index = 5	Epoch: 2	Loss: 0.521149
Client Index = 5	Epoch: 3	Loss: 0.455195
Client Index = 5	Epoch: 4	Loss: 0.525718
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 6
local mask changes: 2155568.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2312342.0, 2155568.0, 2315108.0]
Doing local aggregation!
test acc on this client before 317 / 505 : 0.63
Client Index = 6	Epoch: 0	Loss: 0.705781
Client Index = 6	Epoch: 1	Loss: 0.550015
Client Index = 6	Epoch: 2	Loss: 0.607472
Client Index = 6	Epoch: 3	Loss: 0.485378
Client Index = 6	Epoch: 4	Loss: 0.721223
test acc on this client after 362 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 7
local mask changes: 2154742.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2313244.0, 2154742.0, 2312228.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.791849
Client Index = 7	Epoch: 1	Loss: 0.767531
Client Index = 7	Epoch: 2	Loss: 0.785138
Client Index = 7	Epoch: 3	Loss: 0.701179
Client Index = 7	Epoch: 4	Loss: 0.757080
test acc on this client after 312 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 8
local mask changes: 2155238.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2309816.0, 2155238.0, 2312682.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.219847
Client Index = 8	Epoch: 1	Loss: 0.195608
Client Index = 8	Epoch: 2	Loss: 0.314062
Client Index = 8	Epoch: 3	Loss: 0.138061
Client Index = 8	Epoch: 4	Loss: 0.125700
test acc on this client after 458 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 9
local mask changes: 2156000.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2313424.0, 2156000.0, 2312006.0]
Doing local aggregation!
test acc on this client before 330 / 506 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.624763
Client Index = 9	Epoch: 1	Loss: 0.625896
Client Index = 9	Epoch: 2	Loss: 0.589082
Client Index = 9	Epoch: 3	Loss: 0.536983
Client Index = 9	Epoch: 4	Loss: 0.538659
test acc on this client after 332 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 10
local mask changes: 2156712.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2313726.0, 2156712.0, 2312886.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.767402
Client Index = 10	Epoch: 1	Loss: 0.572466
Client Index = 10	Epoch: 2	Loss: 0.623773
Client Index = 10	Epoch: 3	Loss: 0.575167
Client Index = 10	Epoch: 4	Loss: 0.593658
test acc on this client after 323 / 503 : 0.64
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 11
local mask changes: 2156224.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2312368.0, 2156224.0, 2310998.0]
Doing local aggregation!
test acc on this client before 318 / 505 : 0.63
Client Index = 11	Epoch: 0	Loss: 0.472978
Client Index = 11	Epoch: 1	Loss: 0.368213
Client Index = 11	Epoch: 2	Loss: 0.310576
Client Index = 11	Epoch: 3	Loss: 0.240959
Client Index = 11	Epoch: 4	Loss: 0.250472
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 12
local mask changes: 2155754.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2311724.0, 2155754.0, 2310290.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.739271
Client Index = 12	Epoch: 1	Loss: 0.607843
Client Index = 12	Epoch: 2	Loss: 0.535636
Client Index = 12	Epoch: 3	Loss: 0.539099
Client Index = 12	Epoch: 4	Loss: 0.648615
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653307904.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 13
local mask changes: 2154998.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2310924.0, 2154998.0, 2309028.0]
Doing local aggregation!
test acc on this client before 380 / 505 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.700531
Client Index = 13	Epoch: 1	Loss: 0.547810
Client Index = 13	Epoch: 2	Loss: 0.485825
Client Index = 13	Epoch: 3	Loss: 0.458789
Client Index = 13	Epoch: 4	Loss: 0.545372
test acc on this client after 346 / 505 : 0.69
-----------------------------------
training flops per data 2653300224.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 14
local mask changes: 2155406.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2311032.0, 2155406.0, 2309732.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.623952
Client Index = 14	Epoch: 1	Loss: 0.519299
Client Index = 14	Epoch: 2	Loss: 0.609901
Client Index = 14	Epoch: 3	Loss: 0.464461
Client Index = 14	Epoch: 4	Loss: 0.613881
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653302272.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 15
local mask changes: 2156392.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2309582.0, 2156392.0, 2307192.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.518315
Client Index = 15	Epoch: 1	Loss: 0.542551
Client Index = 15	Epoch: 2	Loss: 0.424048
Client Index = 15	Epoch: 3	Loss: 0.361432
Client Index = 15	Epoch: 4	Loss: 0.405661
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653302528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 16
local mask changes: 2154086.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2306966.0, 2154086.0, 2309924.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 16	Epoch: 0	Loss: 0.645130
Client Index = 16	Epoch: 1	Loss: 0.516818
Client Index = 16	Epoch: 2	Loss: 0.419001
Client Index = 16	Epoch: 3	Loss: 0.455530
Client Index = 16	Epoch: 4	Loss: 0.465465
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653303808.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 17
local mask changes: 2155420.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2309666.0, 2155420.0, 2311844.0]
Doing local aggregation!
test acc on this client before 270 / 503 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.696462
Client Index = 17	Epoch: 1	Loss: 0.612437
Client Index = 17	Epoch: 2	Loss: 0.700756
Client Index = 17	Epoch: 3	Loss: 0.610626
Client Index = 17	Epoch: 4	Loss: 0.668360
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653312000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 18
local mask changes: 2156042.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2312496.0, 2156042.0, 2312314.0]
Doing local aggregation!
test acc on this client before 375 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.591460
Client Index = 18	Epoch: 1	Loss: 0.466048
Client Index = 18	Epoch: 2	Loss: 0.420543
Client Index = 18	Epoch: 3	Loss: 0.368095
Client Index = 18	Epoch: 4	Loss: 0.408465
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653322752.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 19
local mask changes: 2154910.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2312434.0, 2310584.0, 2154910.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.489976
Client Index = 19	Epoch: 1	Loss: 0.605538
Client Index = 19	Epoch: 2	Loss: 0.446264
Client Index = 19	Epoch: 3	Loss: 0.473173
Client Index = 19	Epoch: 4	Loss: 0.464446
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.4921413693698124}
################local_test_on_all_clients after local training in communication round: 41
{'test_acc_after': 0.7394938513908069, 'test_loss_after': 0.8110316214389586}
################local_test_on_all_clients before local training in communication round: 41
{'test_acc_before': 0.6945456098420311, 'test_loss_before': 0.934021901554072}
################Communication round : 42
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 0
local mask changes: 2117606.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2117606.0, 2275128.0, 2274248.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.524229
Client Index = 0	Epoch: 1	Loss: 0.577222
Client Index = 0	Epoch: 2	Loss: 0.487076
Client Index = 0	Epoch: 3	Loss: 0.476606
Client Index = 0	Epoch: 4	Loss: 0.370246
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 1
local mask changes: 2117854.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2273712.0, 2117854.0, 2274022.0]
Doing local aggregation!
test acc on this client before 335 / 503 : 0.67
Client Index = 1	Epoch: 0	Loss: 0.606197
Client Index = 1	Epoch: 1	Loss: 0.275786
Client Index = 1	Epoch: 2	Loss: 0.356748
Client Index = 1	Epoch: 3	Loss: 0.355462
Client Index = 1	Epoch: 4	Loss: 0.249877
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 2
local mask changes: 2116900.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2273100.0, 2116900.0, 2273932.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.237261
Client Index = 2	Epoch: 1	Loss: 0.226806
Client Index = 2	Epoch: 2	Loss: 0.186408
Client Index = 2	Epoch: 3	Loss: 0.333728
Client Index = 2	Epoch: 4	Loss: 0.153834
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 3
local mask changes: 2117038.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2273634.0, 2117038.0, 2275672.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.520107
Client Index = 3	Epoch: 1	Loss: 0.345348
Client Index = 3	Epoch: 2	Loss: 0.255746
Client Index = 3	Epoch: 3	Loss: 0.559698
Client Index = 3	Epoch: 4	Loss: 0.235561
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 4
local mask changes: 2117720.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2275472.0, 2117720.0, 2272566.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.596511
Client Index = 4	Epoch: 1	Loss: 0.504158
Client Index = 4	Epoch: 2	Loss: 0.564100
Client Index = 4	Epoch: 3	Loss: 0.458959
Client Index = 4	Epoch: 4	Loss: 0.428011
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 5
local mask changes: 2117950.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2271110.0, 2117950.0, 2273100.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 5	Epoch: 0	Loss: 0.604056
Client Index = 5	Epoch: 1	Loss: 0.478807
Client Index = 5	Epoch: 2	Loss: 0.568370
Client Index = 5	Epoch: 3	Loss: 0.420262
Client Index = 5	Epoch: 4	Loss: 0.439261
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 6
local mask changes: 2116922.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2273096.0, 2116922.0, 2275858.0]
Doing local aggregation!
test acc on this client before 338 / 505 : 0.67
Client Index = 6	Epoch: 0	Loss: 0.578698
Client Index = 6	Epoch: 1	Loss: 0.559577
Client Index = 6	Epoch: 2	Loss: 0.542094
Client Index = 6	Epoch: 3	Loss: 0.663843
Client Index = 6	Epoch: 4	Loss: 0.590769
test acc on this client after 353 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 7
local mask changes: 2116698.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2274820.0, 2116698.0, 2276040.0]
Doing local aggregation!
test acc on this client before 288 / 504 : 0.57
Client Index = 7	Epoch: 0	Loss: 0.829218
Client Index = 7	Epoch: 1	Loss: 0.670170
Client Index = 7	Epoch: 2	Loss: 0.754730
Client Index = 7	Epoch: 3	Loss: 0.825067
Client Index = 7	Epoch: 4	Loss: 0.592137
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 8
local mask changes: 2116386.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2273264.0, 2116386.0, 2272384.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.385704
Client Index = 8	Epoch: 1	Loss: 0.166199
Client Index = 8	Epoch: 2	Loss: 0.220376
Client Index = 8	Epoch: 3	Loss: 0.154565
Client Index = 8	Epoch: 4	Loss: 0.112387
test acc on this client after 462 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 9
local mask changes: 2118206.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2273526.0, 2118206.0, 2274352.0]
Doing local aggregation!
test acc on this client before 329 / 506 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.591390
Client Index = 9	Epoch: 1	Loss: 0.570519
Client Index = 9	Epoch: 2	Loss: 0.533632
Client Index = 9	Epoch: 3	Loss: 0.533458
Client Index = 9	Epoch: 4	Loss: 0.480192
test acc on this client after 347 / 506 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 10
local mask changes: 2117402.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2274678.0, 2117402.0, 2273530.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.840551
Client Index = 10	Epoch: 1	Loss: 0.570353
Client Index = 10	Epoch: 2	Loss: 0.571169
Client Index = 10	Epoch: 3	Loss: 0.522577
Client Index = 10	Epoch: 4	Loss: 0.616799
test acc on this client after 343 / 503 : 0.68
-----------------------------------
training flops per data 2653337856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 11
local mask changes: 2116666.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2273676.0, 2116666.0, 2272334.0]
Doing local aggregation!
test acc on this client before 311 / 505 : 0.62
Client Index = 11	Epoch: 0	Loss: 0.509684
Client Index = 11	Epoch: 1	Loss: 0.252029
Client Index = 11	Epoch: 2	Loss: 0.211982
Client Index = 11	Epoch: 3	Loss: 0.276965
Client Index = 11	Epoch: 4	Loss: 0.238759
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 12
local mask changes: 2118614.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2273220.0, 2118614.0, 2270982.0]
Doing local aggregation!
test acc on this client before 332 / 504 : 0.66
Client Index = 12	Epoch: 0	Loss: 0.587686
Client Index = 12	Epoch: 1	Loss: 0.547372
Client Index = 12	Epoch: 2	Loss: 0.499813
Client Index = 12	Epoch: 3	Loss: 0.536496
Client Index = 12	Epoch: 4	Loss: 0.511120
test acc on this client after 314 / 504 : 0.62
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 13
local mask changes: 2118926.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2272530.0, 2118926.0, 2272044.0]
Doing local aggregation!
test acc on this client before 391 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.477345
Client Index = 13	Epoch: 1	Loss: 0.559401
Client Index = 13	Epoch: 2	Loss: 0.483803
Client Index = 13	Epoch: 3	Loss: 0.436576
Client Index = 13	Epoch: 4	Loss: 0.534035
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653307136.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 14
local mask changes: 2116538.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2273722.0, 2116538.0, 2269886.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.557461
Client Index = 14	Epoch: 1	Loss: 0.621683
Client Index = 14	Epoch: 2	Loss: 0.592299
Client Index = 14	Epoch: 3	Loss: 0.471625
Client Index = 14	Epoch: 4	Loss: 0.450327
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653305600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 15
local mask changes: 2116348.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2272150.0, 2116348.0, 2269544.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.565425
Client Index = 15	Epoch: 1	Loss: 0.397985
Client Index = 15	Epoch: 2	Loss: 0.475833
Client Index = 15	Epoch: 3	Loss: 0.367354
Client Index = 15	Epoch: 4	Loss: 0.412893
test acc on this client after 356 / 503 : 0.71
-----------------------------------
training flops per data 2653277952.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 16
local mask changes: 2116356.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2270948.0, 2116356.0, 2270478.0]
Doing local aggregation!
test acc on this client before 344 / 504 : 0.68
Client Index = 16	Epoch: 0	Loss: 0.554781
Client Index = 16	Epoch: 1	Loss: 0.592009
Client Index = 16	Epoch: 2	Loss: 0.470613
Client Index = 16	Epoch: 3	Loss: 0.532710
Client Index = 16	Epoch: 4	Loss: 0.358605
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653309952.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 17
local mask changes: 2116490.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2274546.0, 2116490.0, 2275782.0]
Doing local aggregation!
test acc on this client before 298 / 503 : 0.59
Client Index = 17	Epoch: 0	Loss: 0.661748
Client Index = 17	Epoch: 1	Loss: 0.769376
Client Index = 17	Epoch: 2	Loss: 0.628126
Client Index = 17	Epoch: 3	Loss: 0.658586
Client Index = 17	Epoch: 4	Loss: 0.568718
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 18
local mask changes: 2116468.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2274160.0, 2116468.0, 2274046.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.449994
Client Index = 18	Epoch: 1	Loss: 0.431846
Client Index = 18	Epoch: 2	Loss: 0.472002
Client Index = 18	Epoch: 3	Loss: 0.296979
Client Index = 18	Epoch: 4	Loss: 0.561590
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 19
local mask changes: 2117124.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2274978.0, 2273474.0, 2117124.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.601419
Client Index = 19	Epoch: 1	Loss: 0.494553
Client Index = 19	Epoch: 2	Loss: 0.398912
Client Index = 19	Epoch: 3	Loss: 0.440405
Client Index = 19	Epoch: 4	Loss: 0.385831
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.4777736851759255}
################local_test_on_all_clients after local training in communication round: 42
{'test_acc_after': 0.7205143154452882, 'test_loss_after': 0.9402607434685354}
################local_test_on_all_clients before local training in communication round: 42
{'test_acc_before': 0.7053528077561715, 'test_loss_before': 0.885500985917577}
################Communication round : 43
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 0
local mask changes: 2077066.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2077066.0, 2234946.0, 2235094.0]
Doing local aggregation!
test acc on this client before 345 / 503 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.600770
Client Index = 0	Epoch: 1	Loss: 0.537865
Client Index = 0	Epoch: 2	Loss: 0.415427
Client Index = 0	Epoch: 3	Loss: 0.432578
Client Index = 0	Epoch: 4	Loss: 0.417758
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 1
local mask changes: 2079092.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2235072.0, 2079092.0, 2233170.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.342582
Client Index = 1	Epoch: 1	Loss: 0.519366
Client Index = 1	Epoch: 2	Loss: 0.307278
Client Index = 1	Epoch: 3	Loss: 0.333248
Client Index = 1	Epoch: 4	Loss: 0.251904
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 2
local mask changes: 2078936.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2233248.0, 2078936.0, 2235676.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.235593
Client Index = 2	Epoch: 1	Loss: 0.226008
Client Index = 2	Epoch: 2	Loss: 0.181626
Client Index = 2	Epoch: 3	Loss: 0.160679
Client Index = 2	Epoch: 4	Loss: 0.189138
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 3
local mask changes: 2079142.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2236384.0, 2079142.0, 2236254.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.352744
Client Index = 3	Epoch: 1	Loss: 0.469885
Client Index = 3	Epoch: 2	Loss: 0.408751
Client Index = 3	Epoch: 3	Loss: 0.339112
Client Index = 3	Epoch: 4	Loss: 0.250106
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 4
local mask changes: 2077748.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2235784.0, 2077748.0, 2235428.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.586205
Client Index = 4	Epoch: 1	Loss: 0.500650
Client Index = 4	Epoch: 2	Loss: 0.516231
Client Index = 4	Epoch: 3	Loss: 0.431074
Client Index = 4	Epoch: 4	Loss: 0.603313
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 5
local mask changes: 2079644.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2234582.0, 2079644.0, 2234892.0]
Doing local aggregation!
test acc on this client before 327 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.591629
Client Index = 5	Epoch: 1	Loss: 0.554029
Client Index = 5	Epoch: 2	Loss: 0.435829
Client Index = 5	Epoch: 3	Loss: 0.475763
Client Index = 5	Epoch: 4	Loss: 0.473679
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 6
local mask changes: 2078574.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2236326.0, 2078574.0, 2238046.0]
Doing local aggregation!
test acc on this client before 321 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 0.620992
Client Index = 6	Epoch: 1	Loss: 0.556241
Client Index = 6	Epoch: 2	Loss: 0.681403
Client Index = 6	Epoch: 3	Loss: 0.562271
Client Index = 6	Epoch: 4	Loss: 0.512380
test acc on this client after 346 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 7
local mask changes: 2078088.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2236216.0, 2078088.0, 2235502.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.835710
Client Index = 7	Epoch: 1	Loss: 0.667432
Client Index = 7	Epoch: 2	Loss: 0.666948
Client Index = 7	Epoch: 3	Loss: 0.792385
Client Index = 7	Epoch: 4	Loss: 0.685202
test acc on this client after 282 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 8
local mask changes: 2079492.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2233696.0, 2079492.0, 2235770.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.387547
Client Index = 8	Epoch: 1	Loss: 0.167597
Client Index = 8	Epoch: 2	Loss: 0.207191
Client Index = 8	Epoch: 3	Loss: 0.146602
Client Index = 8	Epoch: 4	Loss: 0.134467
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 9
local mask changes: 2079600.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2235054.0, 2079600.0, 2236122.0]
Doing local aggregation!
test acc on this client before 353 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.627258
Client Index = 9	Epoch: 1	Loss: 0.549219
Client Index = 9	Epoch: 2	Loss: 0.552819
Client Index = 9	Epoch: 3	Loss: 0.472568
Client Index = 9	Epoch: 4	Loss: 0.471707
test acc on this client after 344 / 506 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 10
local mask changes: 2079434.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2236322.0, 2079434.0, 2234938.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 10	Epoch: 0	Loss: 0.619722
Client Index = 10	Epoch: 1	Loss: 0.542373
Client Index = 10	Epoch: 2	Loss: 0.535003
Client Index = 10	Epoch: 3	Loss: 0.665297
Client Index = 10	Epoch: 4	Loss: 0.513181
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653335040.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 11
local mask changes: 2080100.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2234342.0, 2080100.0, 2234132.0]
Doing local aggregation!
test acc on this client before 327 / 505 : 0.65
Client Index = 11	Epoch: 0	Loss: 0.567393
Client Index = 11	Epoch: 1	Loss: 0.408108
Client Index = 11	Epoch: 2	Loss: 0.231059
Client Index = 11	Epoch: 3	Loss: 0.193758
Client Index = 11	Epoch: 4	Loss: 0.327749
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653286912.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 12
local mask changes: 2079108.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2235880.0, 2079108.0, 2235212.0]
Doing local aggregation!
test acc on this client before 363 / 504 : 0.72
Client Index = 12	Epoch: 0	Loss: 0.639272
Client Index = 12	Epoch: 1	Loss: 0.605726
Client Index = 12	Epoch: 2	Loss: 0.441728
Client Index = 12	Epoch: 3	Loss: 0.639914
Client Index = 12	Epoch: 4	Loss: 0.445882
test acc on this client after 296 / 504 : 0.59
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 13
local mask changes: 2079174.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2234622.0, 2079174.0, 2235344.0]
Doing local aggregation!
test acc on this client before 366 / 505 : 0.72
Client Index = 13	Epoch: 0	Loss: 0.561286
Client Index = 13	Epoch: 1	Loss: 0.475103
Client Index = 13	Epoch: 2	Loss: 0.493897
Client Index = 13	Epoch: 3	Loss: 0.410209
Client Index = 13	Epoch: 4	Loss: 0.430474
test acc on this client after 392 / 505 : 0.78
-----------------------------------
training flops per data 2653305344.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 14
local mask changes: 2080030.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2233854.0, 2080030.0, 2233556.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.698681
Client Index = 14	Epoch: 1	Loss: 0.578009
Client Index = 14	Epoch: 2	Loss: 0.520100
Client Index = 14	Epoch: 3	Loss: 0.471479
Client Index = 14	Epoch: 4	Loss: 0.519768
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653299712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 15
local mask changes: 2079650.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2233310.0, 2079650.0, 2234138.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.477390
Client Index = 15	Epoch: 1	Loss: 0.462074
Client Index = 15	Epoch: 2	Loss: 0.378456
Client Index = 15	Epoch: 3	Loss: 0.426349
Client Index = 15	Epoch: 4	Loss: 0.318717
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653304832.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 16
local mask changes: 2078886.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2233338.0, 2078886.0, 2233882.0]
Doing local aggregation!
test acc on this client before 334 / 504 : 0.66
Client Index = 16	Epoch: 0	Loss: 0.606233
Client Index = 16	Epoch: 1	Loss: 0.576861
Client Index = 16	Epoch: 2	Loss: 0.421523
Client Index = 16	Epoch: 3	Loss: 0.501454
Client Index = 16	Epoch: 4	Loss: 0.387384
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653334528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 17
local mask changes: 2078782.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2234258.0, 2078782.0, 2234252.0]
Doing local aggregation!
test acc on this client before 277 / 503 : 0.55
Client Index = 17	Epoch: 0	Loss: 0.683101
Client Index = 17	Epoch: 1	Loss: 0.674885
Client Index = 17	Epoch: 2	Loss: 0.551467
Client Index = 17	Epoch: 3	Loss: 0.560150
Client Index = 17	Epoch: 4	Loss: 0.522361
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 18
local mask changes: 2078548.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2233374.0, 2078548.0, 2235154.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.491743
Client Index = 18	Epoch: 1	Loss: 0.470744
Client Index = 18	Epoch: 2	Loss: 0.397986
Client Index = 18	Epoch: 3	Loss: 0.381907
Client Index = 18	Epoch: 4	Loss: 0.406262
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 19
local mask changes: 2080662.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2235568.0, 2234408.0, 2080662.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 19	Epoch: 0	Loss: 0.605995
Client Index = 19	Epoch: 1	Loss: 0.539084
Client Index = 19	Epoch: 2	Loss: 0.455469
Client Index = 19	Epoch: 3	Loss: 0.404811
Client Index = 19	Epoch: 4	Loss: 0.526067
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.47202401945367456}
################local_test_on_all_clients after local training in communication round: 43
{'test_acc_after': 0.7361275974988308, 'test_loss_after': 0.8713087808997384}
################local_test_on_all_clients before local training in communication round: 43
{'test_acc_before': 0.6984868964018144, 'test_loss_before': 0.9301455726292648}
################Communication round : 44
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 0
local mask changes: 2038970.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [2038970.0, 2195614.0, 2196474.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.539343
Client Index = 0	Epoch: 1	Loss: 0.381433
Client Index = 0	Epoch: 2	Loss: 0.640055
Client Index = 0	Epoch: 3	Loss: 0.348746
Client Index = 0	Epoch: 4	Loss: 0.391928
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 1
local mask changes: 2038614.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2196164.0, 2038614.0, 2196742.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.401466
Client Index = 1	Epoch: 1	Loss: 0.383143
Client Index = 1	Epoch: 2	Loss: 0.250394
Client Index = 1	Epoch: 3	Loss: 0.211449
Client Index = 1	Epoch: 4	Loss: 0.280854
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 2
local mask changes: 2040850.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2196258.0, 2040850.0, 2196050.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.210940
Client Index = 2	Epoch: 1	Loss: 0.302574
Client Index = 2	Epoch: 2	Loss: 0.156911
Client Index = 2	Epoch: 3	Loss: 0.156427
Client Index = 2	Epoch: 4	Loss: 0.155214
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 3
local mask changes: 2039466.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2196360.0, 2039466.0, 2196502.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.330956
Client Index = 3	Epoch: 1	Loss: 0.438844
Client Index = 3	Epoch: 2	Loss: 0.297191
Client Index = 3	Epoch: 3	Loss: 0.271969
Client Index = 3	Epoch: 4	Loss: 0.274447
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 4
local mask changes: 2039154.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2197640.0, 2039154.0, 2195178.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.466822
Client Index = 4	Epoch: 1	Loss: 0.551361
Client Index = 4	Epoch: 2	Loss: 0.424476
Client Index = 4	Epoch: 3	Loss: 0.456212
Client Index = 4	Epoch: 4	Loss: 0.506741
test acc on this client after 291 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 5
local mask changes: 2038698.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2196206.0, 2038698.0, 2197514.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.528511
Client Index = 5	Epoch: 1	Loss: 0.493505
Client Index = 5	Epoch: 2	Loss: 0.430631
Client Index = 5	Epoch: 3	Loss: 0.576222
Client Index = 5	Epoch: 4	Loss: 0.459524
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 6
local mask changes: 2038004.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2194914.0, 2038004.0, 2197880.0]
Doing local aggregation!
test acc on this client before 327 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 0.564432
Client Index = 6	Epoch: 1	Loss: 0.555816
Client Index = 6	Epoch: 2	Loss: 0.515159
Client Index = 6	Epoch: 3	Loss: 0.488902
Client Index = 6	Epoch: 4	Loss: 0.469738
test acc on this client after 355 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 7
local mask changes: 2039718.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2197510.0, 2039718.0, 2197674.0]
Doing local aggregation!
test acc on this client before 301 / 504 : 0.60
Client Index = 7	Epoch: 0	Loss: 0.781356
Client Index = 7	Epoch: 1	Loss: 0.719397
Client Index = 7	Epoch: 2	Loss: 0.725141
Client Index = 7	Epoch: 3	Loss: 0.700559
Client Index = 7	Epoch: 4	Loss: 0.646520
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 8
local mask changes: 2039584.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2194214.0, 2039584.0, 2196470.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.252339
Client Index = 8	Epoch: 1	Loss: 0.152969
Client Index = 8	Epoch: 2	Loss: 0.199620
Client Index = 8	Epoch: 3	Loss: 0.118046
Client Index = 8	Epoch: 4	Loss: 0.244855
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 9
local mask changes: 2039214.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2197322.0, 2039214.0, 2198186.0]
Doing local aggregation!
test acc on this client before 331 / 506 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.634534
Client Index = 9	Epoch: 1	Loss: 0.597187
Client Index = 9	Epoch: 2	Loss: 0.449292
Client Index = 9	Epoch: 3	Loss: 0.407718
Client Index = 9	Epoch: 4	Loss: 0.462975
test acc on this client after 319 / 506 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 10
local mask changes: 2038566.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2197380.0, 2038566.0, 2196196.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.703535
Client Index = 10	Epoch: 1	Loss: 0.496015
Client Index = 10	Epoch: 2	Loss: 0.510513
Client Index = 10	Epoch: 3	Loss: 0.494720
Client Index = 10	Epoch: 4	Loss: 0.575427
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653337856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 11
local mask changes: 2039582.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2195084.0, 2039582.0, 2196152.0]
Doing local aggregation!
test acc on this client before 334 / 505 : 0.66
Client Index = 11	Epoch: 0	Loss: 0.487501
Client Index = 11	Epoch: 1	Loss: 0.401180
Client Index = 11	Epoch: 2	Loss: 0.253530
Client Index = 11	Epoch: 3	Loss: 0.256506
Client Index = 11	Epoch: 4	Loss: 0.208991
test acc on this client after 423 / 505 : 0.84
-----------------------------------
training flops per data 2653315584.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 12
local mask changes: 2038576.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2196794.0, 2038576.0, 2196426.0]
Doing local aggregation!
test acc on this client before 321 / 504 : 0.64
Client Index = 12	Epoch: 0	Loss: 0.644630
Client Index = 12	Epoch: 1	Loss: 0.507248
Client Index = 12	Epoch: 2	Loss: 0.568462
Client Index = 12	Epoch: 3	Loss: 0.487554
Client Index = 12	Epoch: 4	Loss: 0.471682
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653331968.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 13
local mask changes: 2038564.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2196208.0, 2038564.0, 2195230.0]
Doing local aggregation!
test acc on this client before 399 / 505 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.493859
Client Index = 13	Epoch: 1	Loss: 0.486753
Client Index = 13	Epoch: 2	Loss: 0.423417
Client Index = 13	Epoch: 3	Loss: 0.486245
Client Index = 13	Epoch: 4	Loss: 0.316783
test acc on this client after 372 / 505 : 0.74
-----------------------------------
training flops per data 2653309440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 14
local mask changes: 2039666.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2196356.0, 2039666.0, 2196148.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.585166
Client Index = 14	Epoch: 1	Loss: 0.494483
Client Index = 14	Epoch: 2	Loss: 0.561739
Client Index = 14	Epoch: 3	Loss: 0.455186
Client Index = 14	Epoch: 4	Loss: 0.482065
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653302272.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 15
local mask changes: 2038980.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2196312.0, 2038980.0, 2192408.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.535090
Client Index = 15	Epoch: 1	Loss: 0.391486
Client Index = 15	Epoch: 2	Loss: 0.424560
Client Index = 15	Epoch: 3	Loss: 0.328651
Client Index = 15	Epoch: 4	Loss: 0.417121
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653313536.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 16
local mask changes: 2038898.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2194054.0, 2038898.0, 2195290.0]
Doing local aggregation!
test acc on this client before 310 / 504 : 0.62
Client Index = 16	Epoch: 0	Loss: 0.530217
Client Index = 16	Epoch: 1	Loss: 0.507376
Client Index = 16	Epoch: 2	Loss: 0.438484
Client Index = 16	Epoch: 3	Loss: 0.433580
Client Index = 16	Epoch: 4	Loss: 0.423971
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653325824.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 17
local mask changes: 2040036.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2194754.0, 2040036.0, 2196144.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 17	Epoch: 0	Loss: 0.677697
Client Index = 17	Epoch: 1	Loss: 0.675930
Client Index = 17	Epoch: 2	Loss: 0.563267
Client Index = 17	Epoch: 3	Loss: 0.611287
Client Index = 17	Epoch: 4	Loss: 0.531772
test acc on this client after 319 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 18
local mask changes: 2039056.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2196370.0, 2039056.0, 2195650.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.541578
Client Index = 18	Epoch: 1	Loss: 0.359026
Client Index = 18	Epoch: 2	Loss: 0.350864
Client Index = 18	Epoch: 3	Loss: 0.461495
Client Index = 18	Epoch: 4	Loss: 0.292117
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653330944.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 19
local mask changes: 2038804.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2199064.0, 2195522.0, 2038804.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.472408
Client Index = 19	Epoch: 1	Loss: 0.487448
Client Index = 19	Epoch: 2	Loss: 0.448181
Client Index = 19	Epoch: 3	Loss: 0.411218
Client Index = 19	Epoch: 4	Loss: 0.428826
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.446016769785434}
################local_test_on_all_clients after local training in communication round: 44
{'test_acc_after': 0.743164295391173, 'test_loss_after': 0.833068114163052}
################local_test_on_all_clients before local training in communication round: 44
{'test_acc_before': 0.7067434920084626, 'test_loss_before': 0.9009494127525268}
################Communication round : 45
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 0
local mask changes: 1999210.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1999210.0, 2157384.0, 2158434.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 0	Epoch: 0	Loss: 0.569053
Client Index = 0	Epoch: 1	Loss: 0.624018
Client Index = 0	Epoch: 2	Loss: 0.436517
Client Index = 0	Epoch: 3	Loss: 0.326462
Client Index = 0	Epoch: 4	Loss: 0.366428
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 1
local mask changes: 1999518.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2157318.0, 1999518.0, 2157186.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.388517
Client Index = 1	Epoch: 1	Loss: 0.335001
Client Index = 1	Epoch: 2	Loss: 0.274911
Client Index = 1	Epoch: 3	Loss: 0.238487
Client Index = 1	Epoch: 4	Loss: 0.215573
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 2
local mask changes: 1998766.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2156904.0, 1998766.0, 2155926.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.194936
Client Index = 2	Epoch: 1	Loss: 0.204496
Client Index = 2	Epoch: 2	Loss: 0.179287
Client Index = 2	Epoch: 3	Loss: 0.138833
Client Index = 2	Epoch: 4	Loss: 0.150616
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 3
local mask changes: 1999014.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2156552.0, 1999014.0, 2157996.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.403580
Client Index = 3	Epoch: 1	Loss: 0.280392
Client Index = 3	Epoch: 2	Loss: 0.354261
Client Index = 3	Epoch: 3	Loss: 0.251939
Client Index = 3	Epoch: 4	Loss: 0.277783
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 4
local mask changes: 1998584.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2159180.0, 1998584.0, 2159706.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.472291
Client Index = 4	Epoch: 1	Loss: 0.506091
Client Index = 4	Epoch: 2	Loss: 0.446873
Client Index = 4	Epoch: 3	Loss: 0.371650
Client Index = 4	Epoch: 4	Loss: 0.592370
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 5
local mask changes: 1998320.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2157548.0, 1998320.0, 2158236.0]
Doing local aggregation!
test acc on this client before 335 / 503 : 0.67
Client Index = 5	Epoch: 0	Loss: 0.488902
Client Index = 5	Epoch: 1	Loss: 0.457103
Client Index = 5	Epoch: 2	Loss: 0.579715
Client Index = 5	Epoch: 3	Loss: 0.433166
Client Index = 5	Epoch: 4	Loss: 0.433185
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 6
local mask changes: 1998924.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2157108.0, 1998924.0, 2158798.0]
Doing local aggregation!
test acc on this client before 352 / 505 : 0.70
Client Index = 6	Epoch: 0	Loss: 0.575583
Client Index = 6	Epoch: 1	Loss: 0.514939
Client Index = 6	Epoch: 2	Loss: 0.481008
Client Index = 6	Epoch: 3	Loss: 0.592587
Client Index = 6	Epoch: 4	Loss: 0.481495
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 7
local mask changes: 1998410.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2159286.0, 1998410.0, 2157162.0]
Doing local aggregation!
test acc on this client before 311 / 504 : 0.62
Client Index = 7	Epoch: 0	Loss: 0.804113
Client Index = 7	Epoch: 1	Loss: 0.765246
Client Index = 7	Epoch: 2	Loss: 0.651488
Client Index = 7	Epoch: 3	Loss: 0.662123
Client Index = 7	Epoch: 4	Loss: 0.608137
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 8
local mask changes: 1998756.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2156184.0, 1998756.0, 2155086.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.205085
Client Index = 8	Epoch: 1	Loss: 0.259315
Client Index = 8	Epoch: 2	Loss: 0.207687
Client Index = 8	Epoch: 3	Loss: 0.122052
Client Index = 8	Epoch: 4	Loss: 0.123024
test acc on this client after 456 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 9
local mask changes: 2000156.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2159228.0, 2000156.0, 2159602.0]
Doing local aggregation!
test acc on this client before 332 / 506 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.543834
Client Index = 9	Epoch: 1	Loss: 0.533902
Client Index = 9	Epoch: 2	Loss: 0.459826
Client Index = 9	Epoch: 3	Loss: 0.581181
Client Index = 9	Epoch: 4	Loss: 0.458092
test acc on this client after 337 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 10
local mask changes: 1998420.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2160718.0, 1998420.0, 2156182.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 10	Epoch: 0	Loss: 0.611802
Client Index = 10	Epoch: 1	Loss: 0.569838
Client Index = 10	Epoch: 2	Loss: 0.541361
Client Index = 10	Epoch: 3	Loss: 0.547504
Client Index = 10	Epoch: 4	Loss: 0.538942
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 11
local mask changes: 1997784.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2158150.0, 1997784.0, 2156248.0]
Doing local aggregation!
test acc on this client before 330 / 505 : 0.65
Client Index = 11	Epoch: 0	Loss: 0.384785
Client Index = 11	Epoch: 1	Loss: 0.239910
Client Index = 11	Epoch: 2	Loss: 0.258841
Client Index = 11	Epoch: 3	Loss: 0.232574
Client Index = 11	Epoch: 4	Loss: 0.421368
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653322240.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 12
local mask changes: 2000178.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2158236.0, 2000178.0, 2157888.0]
Doing local aggregation!
test acc on this client before 344 / 504 : 0.68
Client Index = 12	Epoch: 0	Loss: 0.608118
Client Index = 12	Epoch: 1	Loss: 0.499562
Client Index = 12	Epoch: 2	Loss: 0.595217
Client Index = 12	Epoch: 3	Loss: 0.440572
Client Index = 12	Epoch: 4	Loss: 0.434226
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653314816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 13
local mask changes: 2000222.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2158200.0, 2000222.0, 2156838.0]
Doing local aggregation!
test acc on this client before 389 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.561256
Client Index = 13	Epoch: 1	Loss: 0.446909
Client Index = 13	Epoch: 2	Loss: 0.392861
Client Index = 13	Epoch: 3	Loss: 0.363882
Client Index = 13	Epoch: 4	Loss: 0.488027
test acc on this client after 342 / 505 : 0.68
-----------------------------------
training flops per data 2653310464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 14
local mask changes: 1998388.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2156082.0, 1998388.0, 2156826.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.596853
Client Index = 14	Epoch: 1	Loss: 0.524985
Client Index = 14	Epoch: 2	Loss: 0.480557
Client Index = 14	Epoch: 3	Loss: 0.451210
Client Index = 14	Epoch: 4	Loss: 0.436566
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653304320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 15
local mask changes: 1999376.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2157088.0, 1999376.0, 2154452.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.425090
Client Index = 15	Epoch: 1	Loss: 0.468722
Client Index = 15	Epoch: 2	Loss: 0.367500
Client Index = 15	Epoch: 3	Loss: 0.306532
Client Index = 15	Epoch: 4	Loss: 0.344059
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653307392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 16
local mask changes: 1997918.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2155490.0, 1997918.0, 2156256.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.519561
Client Index = 16	Epoch: 1	Loss: 0.391726
Client Index = 16	Epoch: 2	Loss: 0.464484
Client Index = 16	Epoch: 3	Loss: 0.483984
Client Index = 16	Epoch: 4	Loss: 0.485508
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653324800.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 17
local mask changes: 1998508.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2158230.0, 1998508.0, 2156656.0]
Doing local aggregation!
test acc on this client before 288 / 503 : 0.57
Client Index = 17	Epoch: 0	Loss: 0.829190
Client Index = 17	Epoch: 1	Loss: 0.591478
Client Index = 17	Epoch: 2	Loss: 0.576591
Client Index = 17	Epoch: 3	Loss: 0.601012
Client Index = 17	Epoch: 4	Loss: 0.517981
test acc on this client after 343 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 18
local mask changes: 1999082.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2155806.0, 1999082.0, 2157024.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.667735
Client Index = 18	Epoch: 1	Loss: 0.392985
Client Index = 18	Epoch: 2	Loss: 0.356992
Client Index = 18	Epoch: 3	Loss: 0.326058
Client Index = 18	Epoch: 4	Loss: 0.380042
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 19
local mask changes: 1999698.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2157500.0, 2157886.0, 1999698.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.472897
Client Index = 19	Epoch: 1	Loss: 0.443258
Client Index = 19	Epoch: 2	Loss: 0.423732
Client Index = 19	Epoch: 3	Loss: 0.568623
Client Index = 19	Epoch: 4	Loss: 0.441328
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.44137952288426463}
################local_test_on_all_clients after local training in communication round: 45
{'test_acc_after': 0.7221151891901588, 'test_loss_after': 0.8810667839798905}
################local_test_on_all_clients before local training in communication round: 45
{'test_acc_before': 0.7138845850182737, 'test_loss_before': 0.8805496490541916}
################Communication round : 46
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 0
local mask changes: 1958442.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1958442.0, 2119662.0, 2119586.0]
Doing local aggregation!
test acc on this client before 331 / 503 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.605267
Client Index = 0	Epoch: 1	Loss: 0.428435
Client Index = 0	Epoch: 2	Loss: 0.489727
Client Index = 0	Epoch: 3	Loss: 0.398955
Client Index = 0	Epoch: 4	Loss: 0.377968
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 1
local mask changes: 1958858.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2117386.0, 1958858.0, 2117200.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 1	Epoch: 0	Loss: 0.550509
Client Index = 1	Epoch: 1	Loss: 0.247463
Client Index = 1	Epoch: 2	Loss: 0.260008
Client Index = 1	Epoch: 3	Loss: 0.284583
Client Index = 1	Epoch: 4	Loss: 0.173368
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 2
local mask changes: 1957352.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2118790.0, 1957352.0, 2118850.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.213790
Client Index = 2	Epoch: 1	Loss: 0.148453
Client Index = 2	Epoch: 2	Loss: 0.131921
Client Index = 2	Epoch: 3	Loss: 0.335469
Client Index = 2	Epoch: 4	Loss: 0.151021
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 3
local mask changes: 1957516.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2119298.0, 1957516.0, 2121340.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.406497
Client Index = 3	Epoch: 1	Loss: 0.313222
Client Index = 3	Epoch: 2	Loss: 0.266197
Client Index = 3	Epoch: 3	Loss: 0.281400
Client Index = 3	Epoch: 4	Loss: 0.227461
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 4
local mask changes: 1957204.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2120254.0, 1957204.0, 2119486.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.537312
Client Index = 4	Epoch: 1	Loss: 0.517993
Client Index = 4	Epoch: 2	Loss: 0.485182
Client Index = 4	Epoch: 3	Loss: 0.363845
Client Index = 4	Epoch: 4	Loss: 0.403683
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 5
local mask changes: 1958952.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2120068.0, 1958952.0, 2119186.0]
Doing local aggregation!
test acc on this client before 328 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.595563
Client Index = 5	Epoch: 1	Loss: 0.492008
Client Index = 5	Epoch: 2	Loss: 0.439144
Client Index = 5	Epoch: 3	Loss: 0.589261
Client Index = 5	Epoch: 4	Loss: 0.353261
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 6
local mask changes: 1958254.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2119130.0, 1958254.0, 2121838.0]
Doing local aggregation!
test acc on this client before 335 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 0.587024
Client Index = 6	Epoch: 1	Loss: 0.592268
Client Index = 6	Epoch: 2	Loss: 0.483153
Client Index = 6	Epoch: 3	Loss: 0.453162
Client Index = 6	Epoch: 4	Loss: 0.478947
test acc on this client after 361 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 7
local mask changes: 1957296.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2119802.0, 1957296.0, 2119494.0]
Doing local aggregation!
test acc on this client before 313 / 504 : 0.62
Client Index = 7	Epoch: 0	Loss: 0.839441
Client Index = 7	Epoch: 1	Loss: 0.669029
Client Index = 7	Epoch: 2	Loss: 0.662531
Client Index = 7	Epoch: 3	Loss: 0.607843
Client Index = 7	Epoch: 4	Loss: 0.671195
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 8
local mask changes: 1956180.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2116734.0, 1956180.0, 2117956.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.366487
Client Index = 8	Epoch: 1	Loss: 0.162336
Client Index = 8	Epoch: 2	Loss: 0.120878
Client Index = 8	Epoch: 3	Loss: 0.098789
Client Index = 8	Epoch: 4	Loss: 0.153366
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 9
local mask changes: 1958128.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2119720.0, 1958128.0, 2119116.0]
Doing local aggregation!
test acc on this client before 360 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.506422
Client Index = 9	Epoch: 1	Loss: 0.565431
Client Index = 9	Epoch: 2	Loss: 0.510842
Client Index = 9	Epoch: 3	Loss: 0.407248
Client Index = 9	Epoch: 4	Loss: 0.502822
test acc on this client after 373 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 10
local mask changes: 1958238.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2118958.0, 1958238.0, 2119146.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.537936
Client Index = 10	Epoch: 1	Loss: 0.544132
Client Index = 10	Epoch: 2	Loss: 0.545282
Client Index = 10	Epoch: 3	Loss: 0.474915
Client Index = 10	Epoch: 4	Loss: 0.561015
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 11
local mask changes: 1958582.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2118750.0, 1958582.0, 2118056.0]
Doing local aggregation!
test acc on this client before 330 / 505 : 0.65
Client Index = 11	Epoch: 0	Loss: 0.333393
Client Index = 11	Epoch: 1	Loss: 0.316570
Client Index = 11	Epoch: 2	Loss: 0.295078
Client Index = 11	Epoch: 3	Loss: 0.338030
Client Index = 11	Epoch: 4	Loss: 0.186726
test acc on this client after 412 / 505 : 0.82
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 12
local mask changes: 1958094.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2117822.0, 1958094.0, 2118482.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.535164
Client Index = 12	Epoch: 1	Loss: 0.579403
Client Index = 12	Epoch: 2	Loss: 0.459285
Client Index = 12	Epoch: 3	Loss: 0.458985
Client Index = 12	Epoch: 4	Loss: 0.380345
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653311488.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 13
local mask changes: 1958182.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2119788.0, 1958182.0, 2117616.0]
Doing local aggregation!
test acc on this client before 375 / 505 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.450420
Client Index = 13	Epoch: 1	Loss: 0.416142
Client Index = 13	Epoch: 2	Loss: 0.491562
Client Index = 13	Epoch: 3	Loss: 0.343402
Client Index = 13	Epoch: 4	Loss: 0.388956
test acc on this client after 365 / 505 : 0.72
-----------------------------------
training flops per data 2653306368.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 14
local mask changes: 1958566.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2117296.0, 1958566.0, 2119242.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.644237
Client Index = 14	Epoch: 1	Loss: 0.517553
Client Index = 14	Epoch: 2	Loss: 0.452491
Client Index = 14	Epoch: 3	Loss: 0.497093
Client Index = 14	Epoch: 4	Loss: 0.376276
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653312512.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 15
local mask changes: 1957538.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2119104.0, 1957538.0, 2115498.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.422866
Client Index = 15	Epoch: 1	Loss: 0.440004
Client Index = 15	Epoch: 2	Loss: 0.370145
Client Index = 15	Epoch: 3	Loss: 0.376576
Client Index = 15	Epoch: 4	Loss: 0.359482
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 16
local mask changes: 1960576.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2116564.0, 1960576.0, 2119174.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 16	Epoch: 0	Loss: 0.508163
Client Index = 16	Epoch: 1	Loss: 0.464446
Client Index = 16	Epoch: 2	Loss: 0.402984
Client Index = 16	Epoch: 3	Loss: 0.423305
Client Index = 16	Epoch: 4	Loss: 0.355304
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653322752.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 17
local mask changes: 1958642.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2117998.0, 1958642.0, 2119026.0]
Doing local aggregation!
test acc on this client before 308 / 503 : 0.61
Client Index = 17	Epoch: 0	Loss: 0.649938
Client Index = 17	Epoch: 1	Loss: 0.525340
Client Index = 17	Epoch: 2	Loss: 0.596121
Client Index = 17	Epoch: 3	Loss: 0.551848
Client Index = 17	Epoch: 4	Loss: 0.556587
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 18
local mask changes: 1957016.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2118244.0, 1957016.0, 2119870.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.515272
Client Index = 18	Epoch: 1	Loss: 0.390484
Client Index = 18	Epoch: 2	Loss: 0.555377
Client Index = 18	Epoch: 3	Loss: 0.316025
Client Index = 18	Epoch: 4	Loss: 0.374043
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 19
local mask changes: 1956840.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2119056.0, 2117912.0, 1956840.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.503721
Client Index = 19	Epoch: 1	Loss: 0.376052
Client Index = 19	Epoch: 2	Loss: 0.481849
Client Index = 19	Epoch: 3	Loss: 0.370438
Client Index = 19	Epoch: 4	Loss: 0.378724
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.42897665985487404}
################local_test_on_all_clients after local training in communication round: 46
{'test_acc_after': 0.7355996816433925, 'test_loss_after': 0.9053879995867856}
################local_test_on_all_clients before local training in communication round: 46
{'test_acc_before': 0.7147745249902538, 'test_loss_before': 0.87642816012112}
################Communication round : 47
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 0
local mask changes: 1917022.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1917022.0, 2080168.0, 2080914.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.495935
Client Index = 0	Epoch: 1	Loss: 0.539448
Client Index = 0	Epoch: 2	Loss: 0.374514
Client Index = 0	Epoch: 3	Loss: 0.335195
Client Index = 0	Epoch: 4	Loss: 0.359745
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 1
local mask changes: 1917732.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2079610.0, 1917732.0, 2077980.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 1	Epoch: 0	Loss: 0.339005
Client Index = 1	Epoch: 1	Loss: 0.393784
Client Index = 1	Epoch: 2	Loss: 0.297064
Client Index = 1	Epoch: 3	Loss: 0.204124
Client Index = 1	Epoch: 4	Loss: 0.214544
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 2
local mask changes: 1918070.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2078790.0, 1918070.0, 2081354.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.227409
Client Index = 2	Epoch: 1	Loss: 0.146945
Client Index = 2	Epoch: 2	Loss: 0.156001
Client Index = 2	Epoch: 3	Loss: 0.151909
Client Index = 2	Epoch: 4	Loss: 0.137658
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 3
local mask changes: 1916854.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2081226.0, 1916854.0, 2078994.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.506533
Client Index = 3	Epoch: 1	Loss: 0.245554
Client Index = 3	Epoch: 2	Loss: 0.244396
Client Index = 3	Epoch: 3	Loss: 0.238325
Client Index = 3	Epoch: 4	Loss: 0.550054
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 4
local mask changes: 1918390.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2079912.0, 1918390.0, 2080814.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.524135
Client Index = 4	Epoch: 1	Loss: 0.520386
Client Index = 4	Epoch: 2	Loss: 0.344088
Client Index = 4	Epoch: 3	Loss: 0.415676
Client Index = 4	Epoch: 4	Loss: 0.379091
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 5
local mask changes: 1915902.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2081528.0, 1915902.0, 2082300.0]
Doing local aggregation!
test acc on this client before 323 / 503 : 0.64
Client Index = 5	Epoch: 0	Loss: 0.538768
Client Index = 5	Epoch: 1	Loss: 0.427468
Client Index = 5	Epoch: 2	Loss: 0.606086
Client Index = 5	Epoch: 3	Loss: 0.413250
Client Index = 5	Epoch: 4	Loss: 0.383074
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 6
local mask changes: 1916388.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2081270.0, 1916388.0, 2081100.0]
Doing local aggregation!
test acc on this client before 337 / 505 : 0.67
Client Index = 6	Epoch: 0	Loss: 0.504061
Client Index = 6	Epoch: 1	Loss: 0.581221
Client Index = 6	Epoch: 2	Loss: 0.447370
Client Index = 6	Epoch: 3	Loss: 0.553805
Client Index = 6	Epoch: 4	Loss: 0.457342
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 7
local mask changes: 1916522.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2080830.0, 1916522.0, 2080636.0]
Doing local aggregation!
test acc on this client before 309 / 504 : 0.61
Client Index = 7	Epoch: 0	Loss: 0.727424
Client Index = 7	Epoch: 1	Loss: 0.641613
Client Index = 7	Epoch: 2	Loss: 0.631915
Client Index = 7	Epoch: 3	Loss: 0.705547
Client Index = 7	Epoch: 4	Loss: 0.539035
test acc on this client after 272 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 8
local mask changes: 1915580.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2078292.0, 1915580.0, 2079234.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.185515
Client Index = 8	Epoch: 1	Loss: 0.170661
Client Index = 8	Epoch: 2	Loss: 0.128126
Client Index = 8	Epoch: 3	Loss: 0.177075
Client Index = 8	Epoch: 4	Loss: 0.176262
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 9
local mask changes: 1916692.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2080366.0, 1916692.0, 2080098.0]
Doing local aggregation!
test acc on this client before 351 / 506 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.530347
Client Index = 9	Epoch: 1	Loss: 0.480248
Client Index = 9	Epoch: 2	Loss: 0.469095
Client Index = 9	Epoch: 3	Loss: 0.402619
Client Index = 9	Epoch: 4	Loss: 0.384846
test acc on this client after 362 / 506 : 0.72
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 10
local mask changes: 1916146.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2081636.0, 1916146.0, 2080448.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 10	Epoch: 0	Loss: 0.581979
Client Index = 10	Epoch: 1	Loss: 0.517956
Client Index = 10	Epoch: 2	Loss: 0.647938
Client Index = 10	Epoch: 3	Loss: 0.411660
Client Index = 10	Epoch: 4	Loss: 0.468654
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 11
local mask changes: 1916586.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2080416.0, 1916586.0, 2079774.0]
Doing local aggregation!
test acc on this client before 332 / 505 : 0.66
Client Index = 11	Epoch: 0	Loss: 0.464681
Client Index = 11	Epoch: 1	Loss: 0.264143
Client Index = 11	Epoch: 2	Loss: 0.224182
Client Index = 11	Epoch: 3	Loss: 0.161411
Client Index = 11	Epoch: 4	Loss: 0.203507
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653290240.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 12
local mask changes: 1916710.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2082508.0, 1916710.0, 2081964.0]
Doing local aggregation!
test acc on this client before 350 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.597267
Client Index = 12	Epoch: 1	Loss: 0.538605
Client Index = 12	Epoch: 2	Loss: 0.381702
Client Index = 12	Epoch: 3	Loss: 0.459802
Client Index = 12	Epoch: 4	Loss: 0.371456
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653303296.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 13
local mask changes: 1916256.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2080460.0, 1916256.0, 2080226.0]
Doing local aggregation!
test acc on this client before 388 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.421165
Client Index = 13	Epoch: 1	Loss: 0.394572
Client Index = 13	Epoch: 2	Loss: 0.488422
Client Index = 13	Epoch: 3	Loss: 0.437055
Client Index = 13	Epoch: 4	Loss: 0.391651
test acc on this client after 354 / 505 : 0.70
-----------------------------------
training flops per data 2653308928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 14
local mask changes: 1916204.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2081620.0, 1916204.0, 2080578.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 14	Epoch: 0	Loss: 0.541744
Client Index = 14	Epoch: 1	Loss: 0.536100
Client Index = 14	Epoch: 2	Loss: 0.433477
Client Index = 14	Epoch: 3	Loss: 0.466669
Client Index = 14	Epoch: 4	Loss: 0.383882
test acc on this client after 369 / 503 : 0.73
-----------------------------------
training flops per data 2653305856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 15
local mask changes: 1916736.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2080828.0, 1916736.0, 2077476.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.466400
Client Index = 15	Epoch: 1	Loss: 0.442584
Client Index = 15	Epoch: 2	Loss: 0.391980
Client Index = 15	Epoch: 3	Loss: 0.412840
Client Index = 15	Epoch: 4	Loss: 0.308793
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653312000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 16
local mask changes: 1917372.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2078344.0, 1917372.0, 2079136.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.501058
Client Index = 16	Epoch: 1	Loss: 0.487634
Client Index = 16	Epoch: 2	Loss: 0.438792
Client Index = 16	Epoch: 3	Loss: 0.422618
Client Index = 16	Epoch: 4	Loss: 0.344050
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653318144.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 17
local mask changes: 1917610.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2081726.0, 1917610.0, 2079700.0]
Doing local aggregation!
test acc on this client before 278 / 503 : 0.55
Client Index = 17	Epoch: 0	Loss: 0.687614
Client Index = 17	Epoch: 1	Loss: 0.564941
Client Index = 17	Epoch: 2	Loss: 0.519317
Client Index = 17	Epoch: 3	Loss: 0.553645
Client Index = 17	Epoch: 4	Loss: 0.439137
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 18
local mask changes: 1916304.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2079464.0, 1916304.0, 2082792.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 18	Epoch: 0	Loss: 0.507640
Client Index = 18	Epoch: 1	Loss: 0.322323
Client Index = 18	Epoch: 2	Loss: 0.500884
Client Index = 18	Epoch: 3	Loss: 0.272538
Client Index = 18	Epoch: 4	Loss: 0.286453
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 19
local mask changes: 1916372.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2080216.0, 2081134.0, 1916372.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.509523
Client Index = 19	Epoch: 1	Loss: 0.677833
Client Index = 19	Epoch: 2	Loss: 0.384592
Client Index = 19	Epoch: 3	Loss: 0.336515
Client Index = 19	Epoch: 4	Loss: 0.398498
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.41572173725999895}
################local_test_on_all_clients after local training in communication round: 47
{'test_acc_after': 0.7381981452115179, 'test_loss_after': 0.8662279930898255}
################local_test_on_all_clients before local training in communication round: 47
{'test_acc_before': 0.7109967867781308, 'test_loss_before': 0.9178207183775757}
################Communication round : 48
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 0
local mask changes: 1874540.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1874540.0, 2041764.0, 2041450.0]
Doing local aggregation!
test acc on this client before 364 / 503 : 0.72
Client Index = 0	Epoch: 0	Loss: 0.514816
Client Index = 0	Epoch: 1	Loss: 0.425004
Client Index = 0	Epoch: 2	Loss: 0.361495
Client Index = 0	Epoch: 3	Loss: 0.395423
Client Index = 0	Epoch: 4	Loss: 0.483170
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 1
local mask changes: 1874892.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2041156.0, 1874892.0, 2040056.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.370456
Client Index = 1	Epoch: 1	Loss: 0.286923
Client Index = 1	Epoch: 2	Loss: 0.216202
Client Index = 1	Epoch: 3	Loss: 0.174723
Client Index = 1	Epoch: 4	Loss: 0.391280
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 2
local mask changes: 1875288.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2040058.0, 1875288.0, 2040914.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.203993
Client Index = 2	Epoch: 1	Loss: 0.160926
Client Index = 2	Epoch: 2	Loss: 0.181209
Client Index = 2	Epoch: 3	Loss: 0.130216
Client Index = 2	Epoch: 4	Loss: 0.104577
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 3
local mask changes: 1875804.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2042242.0, 1875804.0, 2042480.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.301850
Client Index = 3	Epoch: 1	Loss: 0.275720
Client Index = 3	Epoch: 2	Loss: 0.417115
Client Index = 3	Epoch: 3	Loss: 0.188983
Client Index = 3	Epoch: 4	Loss: 0.241490
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 4
local mask changes: 1875124.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2041880.0, 1875124.0, 2042620.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.466082
Client Index = 4	Epoch: 1	Loss: 0.459010
Client Index = 4	Epoch: 2	Loss: 0.307442
Client Index = 4	Epoch: 3	Loss: 0.390421
Client Index = 4	Epoch: 4	Loss: 0.450577
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 5
local mask changes: 1873670.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2041882.0, 1873670.0, 2041208.0]
Doing local aggregation!
test acc on this client before 323 / 503 : 0.64
Client Index = 5	Epoch: 0	Loss: 0.496457
Client Index = 5	Epoch: 1	Loss: 0.437313
Client Index = 5	Epoch: 2	Loss: 0.589655
Client Index = 5	Epoch: 3	Loss: 0.357948
Client Index = 5	Epoch: 4	Loss: 0.319200
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 6
local mask changes: 1874518.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2042136.0, 1874518.0, 2044634.0]
Doing local aggregation!
test acc on this client before 366 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.552236
Client Index = 6	Epoch: 1	Loss: 0.516489
Client Index = 6	Epoch: 2	Loss: 0.522549
Client Index = 6	Epoch: 3	Loss: 0.472759
Client Index = 6	Epoch: 4	Loss: 0.403329
test acc on this client after 345 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 7
local mask changes: 1873752.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2043302.0, 1873752.0, 2042346.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 7	Epoch: 0	Loss: 0.854178
Client Index = 7	Epoch: 1	Loss: 0.616347
Client Index = 7	Epoch: 2	Loss: 0.663684
Client Index = 7	Epoch: 3	Loss: 0.582419
Client Index = 7	Epoch: 4	Loss: 0.673970
test acc on this client after 262 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 8
local mask changes: 1875014.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2039394.0, 1875014.0, 2041444.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.381587
Client Index = 8	Epoch: 1	Loss: 0.098865
Client Index = 8	Epoch: 2	Loss: 0.117118
Client Index = 8	Epoch: 3	Loss: 0.109065
Client Index = 8	Epoch: 4	Loss: 0.109819
test acc on this client after 461 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 9
local mask changes: 1876194.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2040284.0, 1876194.0, 2041932.0]
Doing local aggregation!
test acc on this client before 330 / 506 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.568683
Client Index = 9	Epoch: 1	Loss: 0.419196
Client Index = 9	Epoch: 2	Loss: 0.455209
Client Index = 9	Epoch: 3	Loss: 0.412948
Client Index = 9	Epoch: 4	Loss: 0.564935
test acc on this client after 333 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 10
local mask changes: 1875004.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2042276.0, 1875004.0, 2042840.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.565109
Client Index = 10	Epoch: 1	Loss: 0.512170
Client Index = 10	Epoch: 2	Loss: 0.502115
Client Index = 10	Epoch: 3	Loss: 0.416852
Client Index = 10	Epoch: 4	Loss: 0.523853
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 11
local mask changes: 1874548.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2041982.0, 1874548.0, 2044088.0]
Doing local aggregation!
test acc on this client before 348 / 505 : 0.69
Client Index = 11	Epoch: 0	Loss: 0.362892
Client Index = 11	Epoch: 1	Loss: 0.246468
Client Index = 11	Epoch: 2	Loss: 0.384217
Client Index = 11	Epoch: 3	Loss: 0.180041
Client Index = 11	Epoch: 4	Loss: 0.170804
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 12
local mask changes: 1874428.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2042552.0, 1874428.0, 2042848.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.652821
Client Index = 12	Epoch: 1	Loss: 0.458484
Client Index = 12	Epoch: 2	Loss: 0.440010
Client Index = 12	Epoch: 3	Loss: 0.473552
Client Index = 12	Epoch: 4	Loss: 0.390410
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653311744.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 13
local mask changes: 1874912.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2042804.0, 1874912.0, 2042378.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.359554
Client Index = 13	Epoch: 1	Loss: 0.490946
Client Index = 13	Epoch: 2	Loss: 0.372450
Client Index = 13	Epoch: 3	Loss: 0.347699
Client Index = 13	Epoch: 4	Loss: 0.411282
test acc on this client after 376 / 505 : 0.74
-----------------------------------
training flops per data 2653299712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 14
local mask changes: 1874192.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2041852.0, 1874192.0, 2041930.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 14	Epoch: 0	Loss: 0.505506
Client Index = 14	Epoch: 1	Loss: 0.479355
Client Index = 14	Epoch: 2	Loss: 0.367832
Client Index = 14	Epoch: 3	Loss: 0.493667
Client Index = 14	Epoch: 4	Loss: 0.355331
test acc on this client after 337 / 503 : 0.67
-----------------------------------
training flops per data 2653305600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 15
local mask changes: 1873166.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2040956.0, 1873166.0, 2040374.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.443763
Client Index = 15	Epoch: 1	Loss: 0.390643
Client Index = 15	Epoch: 2	Loss: 0.473476
Client Index = 15	Epoch: 3	Loss: 0.288510
Client Index = 15	Epoch: 4	Loss: 0.295202
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653306368.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 16
local mask changes: 1874906.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2039620.0, 1874906.0, 2039080.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.535296
Client Index = 16	Epoch: 1	Loss: 0.332166
Client Index = 16	Epoch: 2	Loss: 0.435888
Client Index = 16	Epoch: 3	Loss: 0.403750
Client Index = 16	Epoch: 4	Loss: 0.330642
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653319168.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 17
local mask changes: 1874976.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2042000.0, 1874976.0, 2039838.0]
Doing local aggregation!
test acc on this client before 300 / 503 : 0.60
Client Index = 17	Epoch: 0	Loss: 0.682381
Client Index = 17	Epoch: 1	Loss: 0.612220
Client Index = 17	Epoch: 2	Loss: 0.428409
Client Index = 17	Epoch: 3	Loss: 0.459400
Client Index = 17	Epoch: 4	Loss: 0.541752
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 18
local mask changes: 1873914.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2040112.0, 1873914.0, 2040164.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.457921
Client Index = 18	Epoch: 1	Loss: 0.331541
Client Index = 18	Epoch: 2	Loss: 0.304703
Client Index = 18	Epoch: 3	Loss: 0.337420
Client Index = 18	Epoch: 4	Loss: 0.319165
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 19
local mask changes: 1873932.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2041994.0, 2041932.0, 1873932.0]
Doing local aggregation!
test acc on this client before 364 / 503 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.430973
Client Index = 19	Epoch: 1	Loss: 0.440038
Client Index = 19	Epoch: 2	Loss: 0.376235
Client Index = 19	Epoch: 3	Loss: 0.358641
Client Index = 19	Epoch: 4	Loss: 0.291357
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.39959968571178617}
################local_test_on_all_clients after local training in communication round: 48
{'test_acc_after': 0.731048130926598, 'test_loss_after': 0.8970017899512349}
################local_test_on_all_clients before local training in communication round: 48
{'test_acc_before': 0.7128820910334616, 'test_loss_before': 0.8992155582433691}
################Communication round : 49
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 0
local mask changes: 1832352.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1832352.0, 2003248.0, 2002998.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.510440
Client Index = 0	Epoch: 1	Loss: 0.404604
Client Index = 0	Epoch: 2	Loss: 0.311096
Client Index = 0	Epoch: 3	Loss: 0.564136
Client Index = 0	Epoch: 4	Loss: 0.264443
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 1
local mask changes: 1830350.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [2003122.0, 1830350.0, 2001642.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 1	Epoch: 0	Loss: 0.347720
Client Index = 1	Epoch: 1	Loss: 0.219001
Client Index = 1	Epoch: 2	Loss: 0.243566
Client Index = 1	Epoch: 3	Loss: 0.206554
Client Index = 1	Epoch: 4	Loss: 0.252781
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 2
local mask changes: 1830980.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [2002340.0, 1830980.0, 2003116.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.184434
Client Index = 2	Epoch: 1	Loss: 0.142142
Client Index = 2	Epoch: 2	Loss: 0.179276
Client Index = 2	Epoch: 3	Loss: 0.108405
Client Index = 2	Epoch: 4	Loss: 0.117491
test acc on this client after 379 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 3
local mask changes: 1830584.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [2003884.0, 1830584.0, 2004530.0]
Doing local aggregation!
test acc on this client before 373 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.520919
Client Index = 3	Epoch: 1	Loss: 0.260154
Client Index = 3	Epoch: 2	Loss: 0.241401
Client Index = 3	Epoch: 3	Loss: 0.301945
Client Index = 3	Epoch: 4	Loss: 0.247013
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 4
local mask changes: 1832348.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [2005074.0, 1832348.0, 2003836.0]
Doing local aggregation!
test acc on this client before 373 / 504 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.455453
Client Index = 4	Epoch: 1	Loss: 0.407004
Client Index = 4	Epoch: 2	Loss: 0.442123
Client Index = 4	Epoch: 3	Loss: 0.321738
Client Index = 4	Epoch: 4	Loss: 0.426454
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 5
local mask changes: 1832338.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [2003796.0, 1832338.0, 2003394.0]
Doing local aggregation!
test acc on this client before 327 / 503 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.522955
Client Index = 5	Epoch: 1	Loss: 0.485229
Client Index = 5	Epoch: 2	Loss: 0.416555
Client Index = 5	Epoch: 3	Loss: 0.388417
Client Index = 5	Epoch: 4	Loss: 0.379881
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 6
local mask changes: 1831906.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [2003256.0, 1831906.0, 2003950.0]
Doing local aggregation!
test acc on this client before 313 / 505 : 0.62
Client Index = 6	Epoch: 0	Loss: 0.641566
Client Index = 6	Epoch: 1	Loss: 0.471927
Client Index = 6	Epoch: 2	Loss: 0.414721
Client Index = 6	Epoch: 3	Loss: 0.438343
Client Index = 6	Epoch: 4	Loss: 0.464966
test acc on this client after 376 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 7
local mask changes: 1831110.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [2003768.0, 1831110.0, 2003504.0]
Doing local aggregation!
test acc on this client before 325 / 504 : 0.64
Client Index = 7	Epoch: 0	Loss: 0.771560
Client Index = 7	Epoch: 1	Loss: 0.666674
Client Index = 7	Epoch: 2	Loss: 0.643942
Client Index = 7	Epoch: 3	Loss: 0.518511
Client Index = 7	Epoch: 4	Loss: 0.587545
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 8
local mask changes: 1830942.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [2000982.0, 1830942.0, 2001866.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.197392
Client Index = 8	Epoch: 1	Loss: 0.112138
Client Index = 8	Epoch: 2	Loss: 0.331037
Client Index = 8	Epoch: 3	Loss: 0.122374
Client Index = 8	Epoch: 4	Loss: 0.089830
test acc on this client after 458 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 9
local mask changes: 1831138.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [2004274.0, 1831138.0, 2004314.0]
Doing local aggregation!
test acc on this client before 323 / 506 : 0.64
Client Index = 9	Epoch: 0	Loss: 0.522444
Client Index = 9	Epoch: 1	Loss: 0.445405
Client Index = 9	Epoch: 2	Loss: 0.480574
Client Index = 9	Epoch: 3	Loss: 0.340146
Client Index = 9	Epoch: 4	Loss: 0.556250
test acc on this client after 370 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 10
local mask changes: 1830798.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [2004020.0, 1830798.0, 2004506.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.573213
Client Index = 10	Epoch: 1	Loss: 0.469298
Client Index = 10	Epoch: 2	Loss: 0.504220
Client Index = 10	Epoch: 3	Loss: 0.426032
Client Index = 10	Epoch: 4	Loss: 0.492786
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 11
local mask changes: 1832806.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [2003156.0, 1832806.0, 2004562.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 11	Epoch: 0	Loss: 0.376395
Client Index = 11	Epoch: 1	Loss: 0.159540
Client Index = 11	Epoch: 2	Loss: 0.498674
Client Index = 11	Epoch: 3	Loss: 0.180646
Client Index = 11	Epoch: 4	Loss: 0.139812
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653293056.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 12
local mask changes: 1831508.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [2004780.0, 1831508.0, 2003902.0]
Doing local aggregation!
test acc on this client before 328 / 504 : 0.65
Client Index = 12	Epoch: 0	Loss: 0.588718
Client Index = 12	Epoch: 1	Loss: 0.464560
Client Index = 12	Epoch: 2	Loss: 0.434170
Client Index = 12	Epoch: 3	Loss: 0.377424
Client Index = 12	Epoch: 4	Loss: 0.361235
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653316352.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 13
local mask changes: 1831510.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [2004510.0, 1831510.0, 2004910.0]
Doing local aggregation!
test acc on this client before 400 / 505 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.454701
Client Index = 13	Epoch: 1	Loss: 0.336949
Client Index = 13	Epoch: 2	Loss: 0.450202
Client Index = 13	Epoch: 3	Loss: 0.261819
Client Index = 13	Epoch: 4	Loss: 0.422742
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653303808.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 14
local mask changes: 1831648.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [2003894.0, 1831648.0, 2005506.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.595452
Client Index = 14	Epoch: 1	Loss: 0.525775
Client Index = 14	Epoch: 2	Loss: 0.445344
Client Index = 14	Epoch: 3	Loss: 0.342611
Client Index = 14	Epoch: 4	Loss: 0.388794
test acc on this client after 325 / 503 : 0.65
-----------------------------------
training flops per data 2653301760.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 15
local mask changes: 1832064.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [2002250.0, 1832064.0, 2001118.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.443184
Client Index = 15	Epoch: 1	Loss: 0.408631
Client Index = 15	Epoch: 2	Loss: 0.422072
Client Index = 15	Epoch: 3	Loss: 0.303643
Client Index = 15	Epoch: 4	Loss: 0.254372
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653308672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 16
local mask changes: 1830256.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [2001360.0, 1830256.0, 2003124.0]
Doing local aggregation!
test acc on this client before 341 / 504 : 0.68
Client Index = 16	Epoch: 0	Loss: 0.470204
Client Index = 16	Epoch: 1	Loss: 0.441762
Client Index = 16	Epoch: 2	Loss: 0.352179
Client Index = 16	Epoch: 3	Loss: 0.375516
Client Index = 16	Epoch: 4	Loss: 0.398203
test acc on this client after 315 / 504 : 0.62
-----------------------------------
training flops per data 2653320192.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 17
local mask changes: 1830598.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [2004442.0, 1830598.0, 2001534.0]
Doing local aggregation!
test acc on this client before 324 / 503 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.693137
Client Index = 17	Epoch: 1	Loss: 0.540068
Client Index = 17	Epoch: 2	Loss: 0.507795
Client Index = 17	Epoch: 3	Loss: 0.507208
Client Index = 17	Epoch: 4	Loss: 0.478552
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653327872.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 18
local mask changes: 1830960.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [2003268.0, 1830960.0, 2002364.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.418929
Client Index = 18	Epoch: 1	Loss: 0.356459
Client Index = 18	Epoch: 2	Loss: 0.344158
Client Index = 18	Epoch: 3	Loss: 0.340044
Client Index = 18	Epoch: 4	Loss: 0.236981
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 19
local mask changes: 1832146.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [2003564.0, 2002964.0, 1832146.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.492095
Client Index = 19	Epoch: 1	Loss: 0.361344
Client Index = 19	Epoch: 2	Loss: 0.389907
Client Index = 19	Epoch: 3	Loss: 0.313907
Client Index = 19	Epoch: 4	Loss: 0.566796
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.39378929106239224}
################local_test_on_all_clients after local training in communication round: 49
{'test_acc_after': 0.739869508632883, 'test_loss_after': 0.8769300243583261}
################local_test_on_all_clients before local training in communication round: 49
{'test_acc_before': 0.7178666286775498, 'test_loss_before': 0.8801265923205982}
################Communication round : 50
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 0
local mask changes: 1788242.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1788242.0, 1963972.0, 1964606.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.529825
Client Index = 0	Epoch: 1	Loss: 0.417762
Client Index = 0	Epoch: 2	Loss: 0.332969
Client Index = 0	Epoch: 3	Loss: 0.322007
Client Index = 0	Epoch: 4	Loss: 0.466544
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 1
local mask changes: 1787310.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1963956.0, 1787310.0, 1964288.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 1	Epoch: 0	Loss: 0.337338
Client Index = 1	Epoch: 1	Loss: 0.184447
Client Index = 1	Epoch: 2	Loss: 0.357723
Client Index = 1	Epoch: 3	Loss: 0.196374
Client Index = 1	Epoch: 4	Loss: 0.194283
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 2
local mask changes: 1788512.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1961916.0, 1788512.0, 1963604.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.195958
Client Index = 2	Epoch: 1	Loss: 0.160702
Client Index = 2	Epoch: 2	Loss: 0.178676
Client Index = 2	Epoch: 3	Loss: 0.135155
Client Index = 2	Epoch: 4	Loss: 0.081138
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 3
local mask changes: 1789430.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1964164.0, 1789430.0, 1964380.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.330002
Client Index = 3	Epoch: 1	Loss: 0.272015
Client Index = 3	Epoch: 2	Loss: 0.224477
Client Index = 3	Epoch: 3	Loss: 0.229836
Client Index = 3	Epoch: 4	Loss: 0.190826
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 4
local mask changes: 1787150.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1966830.0, 1787150.0, 1966370.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.422399
Client Index = 4	Epoch: 1	Loss: 0.571285
Client Index = 4	Epoch: 2	Loss: 0.310764
Client Index = 4	Epoch: 3	Loss: 0.460183
Client Index = 4	Epoch: 4	Loss: 0.309306
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 5
local mask changes: 1788794.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1965494.0, 1788794.0, 1965342.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 5	Epoch: 0	Loss: 0.522204
Client Index = 5	Epoch: 1	Loss: 0.400960
Client Index = 5	Epoch: 2	Loss: 0.551787
Client Index = 5	Epoch: 3	Loss: 0.357267
Client Index = 5	Epoch: 4	Loss: 0.312711
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 6
local mask changes: 1789060.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1965190.0, 1789060.0, 1967020.0]
Doing local aggregation!
test acc on this client before 342 / 505 : 0.68
Client Index = 6	Epoch: 0	Loss: 0.440174
Client Index = 6	Epoch: 1	Loss: 0.494455
Client Index = 6	Epoch: 2	Loss: 0.528305
Client Index = 6	Epoch: 3	Loss: 0.362255
Client Index = 6	Epoch: 4	Loss: 0.459553
test acc on this client after 354 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 7
local mask changes: 1788504.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1966376.0, 1788504.0, 1966192.0]
Doing local aggregation!
test acc on this client before 319 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.763323
Client Index = 7	Epoch: 1	Loss: 0.602619
Client Index = 7	Epoch: 2	Loss: 0.617194
Client Index = 7	Epoch: 3	Loss: 0.656557
Client Index = 7	Epoch: 4	Loss: 0.510786
test acc on this client after 341 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 8
local mask changes: 1788432.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1963712.0, 1788432.0, 1964190.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.265164
Client Index = 8	Epoch: 1	Loss: 0.095968
Client Index = 8	Epoch: 2	Loss: 0.139241
Client Index = 8	Epoch: 3	Loss: 0.113739
Client Index = 8	Epoch: 4	Loss: 0.085901
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 9
local mask changes: 1790252.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1964984.0, 1790252.0, 1963530.0]
Doing local aggregation!
test acc on this client before 374 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.524675
Client Index = 9	Epoch: 1	Loss: 0.423911
Client Index = 9	Epoch: 2	Loss: 0.539820
Client Index = 9	Epoch: 3	Loss: 0.415437
Client Index = 9	Epoch: 4	Loss: 0.347779
test acc on this client after 348 / 506 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 10
local mask changes: 1789104.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1966374.0, 1789104.0, 1965818.0]
Doing local aggregation!
test acc on this client before 340 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.552289
Client Index = 10	Epoch: 1	Loss: 0.508867
Client Index = 10	Epoch: 2	Loss: 0.473648
Client Index = 10	Epoch: 3	Loss: 0.445787
Client Index = 10	Epoch: 4	Loss: 0.579656
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 11
local mask changes: 1788750.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1964810.0, 1788750.0, 1964006.0]
Doing local aggregation!
test acc on this client before 354 / 505 : 0.70
Client Index = 11	Epoch: 0	Loss: 0.509876
Client Index = 11	Epoch: 1	Loss: 0.189048
Client Index = 11	Epoch: 2	Loss: 0.159427
Client Index = 11	Epoch: 3	Loss: 0.210615
Client Index = 11	Epoch: 4	Loss: 0.173444
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 12
local mask changes: 1788900.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1967626.0, 1788900.0, 1966246.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 12	Epoch: 0	Loss: 0.590037
Client Index = 12	Epoch: 1	Loss: 0.377912
Client Index = 12	Epoch: 2	Loss: 0.456990
Client Index = 12	Epoch: 3	Loss: 0.458454
Client Index = 12	Epoch: 4	Loss: 0.360307
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653315584.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 13
local mask changes: 1788116.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1965730.0, 1788116.0, 1965626.0]
Doing local aggregation!
test acc on this client before 397 / 505 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.387674
Client Index = 13	Epoch: 1	Loss: 0.411870
Client Index = 13	Epoch: 2	Loss: 0.408528
Client Index = 13	Epoch: 3	Loss: 0.281663
Client Index = 13	Epoch: 4	Loss: 0.352588
test acc on this client after 384 / 505 : 0.76
-----------------------------------
training flops per data 2653307136.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 14
local mask changes: 1788830.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1965476.0, 1788830.0, 1963708.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 14	Epoch: 0	Loss: 0.566911
Client Index = 14	Epoch: 1	Loss: 0.415228
Client Index = 14	Epoch: 2	Loss: 0.302693
Client Index = 14	Epoch: 3	Loss: 0.447341
Client Index = 14	Epoch: 4	Loss: 0.293870
test acc on this client after 369 / 503 : 0.73
-----------------------------------
training flops per data 2653297152.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 15
local mask changes: 1788582.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1965338.0, 1788582.0, 1961902.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.526708
Client Index = 15	Epoch: 1	Loss: 0.350966
Client Index = 15	Epoch: 2	Loss: 0.348951
Client Index = 15	Epoch: 3	Loss: 0.348683
Client Index = 15	Epoch: 4	Loss: 0.334671
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653310208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 16
local mask changes: 1788570.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1963436.0, 1788570.0, 1964238.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 16	Epoch: 0	Loss: 0.457811
Client Index = 16	Epoch: 1	Loss: 0.403167
Client Index = 16	Epoch: 2	Loss: 0.378764
Client Index = 16	Epoch: 3	Loss: 0.453802
Client Index = 16	Epoch: 4	Loss: 0.319434
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 17
local mask changes: 1788282.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1965650.0, 1788282.0, 1964832.0]
Doing local aggregation!
test acc on this client before 313 / 503 : 0.62
Client Index = 17	Epoch: 0	Loss: 0.671971
Client Index = 17	Epoch: 1	Loss: 0.481091
Client Index = 17	Epoch: 2	Loss: 0.489437
Client Index = 17	Epoch: 3	Loss: 0.458025
Client Index = 17	Epoch: 4	Loss: 0.439792
test acc on this client after 296 / 503 : 0.59
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 18
local mask changes: 1788668.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1964370.0, 1788668.0, 1963620.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.526920
Client Index = 18	Epoch: 1	Loss: 0.298357
Client Index = 18	Epoch: 2	Loss: 0.458889
Client Index = 18	Epoch: 3	Loss: 0.254803
Client Index = 18	Epoch: 4	Loss: 0.336661
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 19
local mask changes: 1789678.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1964238.0, 1964426.0, 1789678.0]
Doing local aggregation!
test acc on this client before 375 / 503 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.501887
Client Index = 19	Epoch: 1	Loss: 0.353473
Client Index = 19	Epoch: 2	Loss: 0.476003
Client Index = 19	Epoch: 3	Loss: 0.315003
Client Index = 19	Epoch: 4	Loss: 0.345637
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.3818940489515662}
################local_test_on_all_clients after local training in communication round: 50
{'test_acc_after': 0.7480272571991897, 'test_loss_after': 0.8676113619833116}
################local_test_on_all_clients before local training in communication round: 50
{'test_acc_before': 0.7300509963030309, 'test_loss_before': 0.8474750221263385}
################Communication round : 51
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 0
local mask changes: 1745776.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1745776.0, 1926414.0, 1926244.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 0	Epoch: 0	Loss: 0.637868
Client Index = 0	Epoch: 1	Loss: 0.316401
Client Index = 0	Epoch: 2	Loss: 0.340508
Client Index = 0	Epoch: 3	Loss: 0.376469
Client Index = 0	Epoch: 4	Loss: 0.279336
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 1
local mask changes: 1745170.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1925232.0, 1745170.0, 1923128.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 1	Epoch: 0	Loss: 0.337981
Client Index = 1	Epoch: 1	Loss: 0.233792
Client Index = 1	Epoch: 2	Loss: 0.386710
Client Index = 1	Epoch: 3	Loss: 0.175027
Client Index = 1	Epoch: 4	Loss: 0.165122
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 2
local mask changes: 1745218.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1923470.0, 1745218.0, 1925596.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.164723
Client Index = 2	Epoch: 1	Loss: 0.112030
Client Index = 2	Epoch: 2	Loss: 0.105401
Client Index = 2	Epoch: 3	Loss: 0.141034
Client Index = 2	Epoch: 4	Loss: 0.170714
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 3
local mask changes: 1744650.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1925672.0, 1744650.0, 1928428.0]
Doing local aggregation!
test acc on this client before 365 / 504 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.426336
Client Index = 3	Epoch: 1	Loss: 0.487664
Client Index = 3	Epoch: 2	Loss: 0.183633
Client Index = 3	Epoch: 3	Loss: 0.337183
Client Index = 3	Epoch: 4	Loss: 0.150402
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 4
local mask changes: 1743432.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1929120.0, 1743432.0, 1927752.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.609161
Client Index = 4	Epoch: 1	Loss: 0.385010
Client Index = 4	Epoch: 2	Loss: 0.279399
Client Index = 4	Epoch: 3	Loss: 0.518911
Client Index = 4	Epoch: 4	Loss: 0.322257
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 5
local mask changes: 1744760.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1927344.0, 1744760.0, 1927184.0]
Doing local aggregation!
test acc on this client before 303 / 503 : 0.60
Client Index = 5	Epoch: 0	Loss: 0.544947
Client Index = 5	Epoch: 1	Loss: 0.355914
Client Index = 5	Epoch: 2	Loss: 0.345443
Client Index = 5	Epoch: 3	Loss: 0.463915
Client Index = 5	Epoch: 4	Loss: 0.343634
test acc on this client after 369 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 6
local mask changes: 1744712.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1928818.0, 1744712.0, 1928900.0]
Doing local aggregation!
test acc on this client before 358 / 505 : 0.71
Client Index = 6	Epoch: 0	Loss: 0.425975
Client Index = 6	Epoch: 1	Loss: 0.476235
Client Index = 6	Epoch: 2	Loss: 0.451822
Client Index = 6	Epoch: 3	Loss: 0.388634
Client Index = 6	Epoch: 4	Loss: 0.352712
test acc on this client after 359 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 7
local mask changes: 1744808.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1930430.0, 1744808.0, 1928470.0]
Doing local aggregation!
test acc on this client before 327 / 504 : 0.65
Client Index = 7	Epoch: 0	Loss: 0.649092
Client Index = 7	Epoch: 1	Loss: 0.586758
Client Index = 7	Epoch: 2	Loss: 0.728974
Client Index = 7	Epoch: 3	Loss: 0.569057
Client Index = 7	Epoch: 4	Loss: 0.562831
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 8
local mask changes: 1745420.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1924866.0, 1745420.0, 1924892.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.151739
Client Index = 8	Epoch: 1	Loss: 0.399308
Client Index = 8	Epoch: 2	Loss: 0.115225
Client Index = 8	Epoch: 3	Loss: 0.084417
Client Index = 8	Epoch: 4	Loss: 0.066419
test acc on this client after 460 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 9
local mask changes: 1744724.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1926784.0, 1744724.0, 1926074.0]
Doing local aggregation!
test acc on this client before 355 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.537758
Client Index = 9	Epoch: 1	Loss: 0.399383
Client Index = 9	Epoch: 2	Loss: 0.372439
Client Index = 9	Epoch: 3	Loss: 0.454146
Client Index = 9	Epoch: 4	Loss: 0.304480
test acc on this client after 381 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 10
local mask changes: 1744494.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1927594.0, 1744494.0, 1928144.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.531750
Client Index = 10	Epoch: 1	Loss: 0.519372
Client Index = 10	Epoch: 2	Loss: 0.504688
Client Index = 10	Epoch: 3	Loss: 0.371413
Client Index = 10	Epoch: 4	Loss: 0.450673
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653334528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 11
local mask changes: 1744096.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1926442.0, 1744096.0, 1926832.0]
Doing local aggregation!
test acc on this client before 355 / 505 : 0.70
Client Index = 11	Epoch: 0	Loss: 0.371835
Client Index = 11	Epoch: 1	Loss: 0.311199
Client Index = 11	Epoch: 2	Loss: 0.209354
Client Index = 11	Epoch: 3	Loss: 0.222195
Client Index = 11	Epoch: 4	Loss: 0.161247
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 12
local mask changes: 1744332.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1928686.0, 1744332.0, 1928710.0]
Doing local aggregation!
test acc on this client before 364 / 504 : 0.72
Client Index = 12	Epoch: 0	Loss: 0.532598
Client Index = 12	Epoch: 1	Loss: 0.487467
Client Index = 12	Epoch: 2	Loss: 0.340531
Client Index = 12	Epoch: 3	Loss: 0.562534
Client Index = 12	Epoch: 4	Loss: 0.298187
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653305856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 13
local mask changes: 1744732.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1927976.0, 1744732.0, 1927528.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.453902
Client Index = 13	Epoch: 1	Loss: 0.305073
Client Index = 13	Epoch: 2	Loss: 0.373083
Client Index = 13	Epoch: 3	Loss: 0.339689
Client Index = 13	Epoch: 4	Loss: 0.391266
test acc on this client after 372 / 505 : 0.74
-----------------------------------
training flops per data 2653304064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 14
local mask changes: 1743978.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1926682.0, 1743978.0, 1924998.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.559648
Client Index = 14	Epoch: 1	Loss: 0.427179
Client Index = 14	Epoch: 2	Loss: 0.407993
Client Index = 14	Epoch: 3	Loss: 0.349440
Client Index = 14	Epoch: 4	Loss: 0.300081
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653302784.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 15
local mask changes: 1744518.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1925750.0, 1744518.0, 1924516.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.409234
Client Index = 15	Epoch: 1	Loss: 0.275566
Client Index = 15	Epoch: 2	Loss: 0.456515
Client Index = 15	Epoch: 3	Loss: 0.283120
Client Index = 15	Epoch: 4	Loss: 0.273739
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 16
local mask changes: 1744642.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1925572.0, 1744642.0, 1926620.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.481293
Client Index = 16	Epoch: 1	Loss: 0.346884
Client Index = 16	Epoch: 2	Loss: 0.524973
Client Index = 16	Epoch: 3	Loss: 0.320796
Client Index = 16	Epoch: 4	Loss: 0.395989
test acc on this client after 325 / 504 : 0.64
-----------------------------------
training flops per data 2653328384.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 17
local mask changes: 1744386.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1927502.0, 1744386.0, 1926478.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 17	Epoch: 0	Loss: 0.623884
Client Index = 17	Epoch: 1	Loss: 0.486688
Client Index = 17	Epoch: 2	Loss: 0.420777
Client Index = 17	Epoch: 3	Loss: 0.512385
Client Index = 17	Epoch: 4	Loss: 0.538087
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653329920.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 18
local mask changes: 1745128.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1925676.0, 1745128.0, 1926674.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.342350
Client Index = 18	Epoch: 1	Loss: 0.463716
Client Index = 18	Epoch: 2	Loss: 0.332643
Client Index = 18	Epoch: 3	Loss: 0.222754
Client Index = 18	Epoch: 4	Loss: 0.195961
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 19
local mask changes: 1745450.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1926398.0, 1924962.0, 1745450.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.442465
Client Index = 19	Epoch: 1	Loss: 0.363224
Client Index = 19	Epoch: 2	Loss: 0.382769
Client Index = 19	Epoch: 3	Loss: 0.275243
Client Index = 19	Epoch: 4	Loss: 0.344092
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.3727187082208692}
################local_test_on_all_clients after local training in communication round: 51
{'test_acc_after': 0.7586323495777705, 'test_loss_after': 0.8360946173182384}
################local_test_on_all_clients before local training in communication round: 51
{'test_acc_before': 0.7277636927884654, 'test_loss_before': 0.8598841374167252}
################Communication round : 52
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 0
local mask changes: 1699922.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1699922.0, 1887708.0, 1888714.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.466095
Client Index = 0	Epoch: 1	Loss: 0.308883
Client Index = 0	Epoch: 2	Loss: 0.504882
Client Index = 0	Epoch: 3	Loss: 0.280177
Client Index = 0	Epoch: 4	Loss: 0.265837
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 1
local mask changes: 1700302.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1886516.0, 1700302.0, 1885728.0]
Doing local aggregation!
test acc on this client before 358 / 503 : 0.71
Client Index = 1	Epoch: 0	Loss: 0.359700
Client Index = 1	Epoch: 1	Loss: 0.251328
Client Index = 1	Epoch: 2	Loss: 0.149391
Client Index = 1	Epoch: 3	Loss: 0.349959
Client Index = 1	Epoch: 4	Loss: 0.209287
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 2
local mask changes: 1701964.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1885802.0, 1701964.0, 1886878.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.173378
Client Index = 2	Epoch: 1	Loss: 0.133575
Client Index = 2	Epoch: 2	Loss: 0.141313
Client Index = 2	Epoch: 3	Loss: 0.136347
Client Index = 2	Epoch: 4	Loss: 0.124155
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 3
local mask changes: 1700948.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1889488.0, 1700948.0, 1889570.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.337655
Client Index = 3	Epoch: 1	Loss: 0.303828
Client Index = 3	Epoch: 2	Loss: 0.240750
Client Index = 3	Epoch: 3	Loss: 0.143398
Client Index = 3	Epoch: 4	Loss: 0.184422
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 4
local mask changes: 1700278.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1889738.0, 1700278.0, 1889816.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.468065
Client Index = 4	Epoch: 1	Loss: 0.411187
Client Index = 4	Epoch: 2	Loss: 0.393921
Client Index = 4	Epoch: 3	Loss: 0.292732
Client Index = 4	Epoch: 4	Loss: 0.428216
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 5
local mask changes: 1700358.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1890098.0, 1700358.0, 1888976.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.453543
Client Index = 5	Epoch: 1	Loss: 0.390747
Client Index = 5	Epoch: 2	Loss: 0.453154
Client Index = 5	Epoch: 3	Loss: 0.372778
Client Index = 5	Epoch: 4	Loss: 0.408213
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 6
local mask changes: 1701094.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1889534.0, 1701094.0, 1891118.0]
Doing local aggregation!
test acc on this client before 350 / 505 : 0.69
Client Index = 6	Epoch: 0	Loss: 0.519849
Client Index = 6	Epoch: 1	Loss: 0.395207
Client Index = 6	Epoch: 2	Loss: 0.437549
Client Index = 6	Epoch: 3	Loss: 0.390411
Client Index = 6	Epoch: 4	Loss: 0.471024
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 7
local mask changes: 1700938.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1890334.0, 1700938.0, 1888960.0]
Doing local aggregation!
test acc on this client before 337 / 504 : 0.67
Client Index = 7	Epoch: 0	Loss: 0.641193
Client Index = 7	Epoch: 1	Loss: 0.565578
Client Index = 7	Epoch: 2	Loss: 0.625581
Client Index = 7	Epoch: 3	Loss: 0.555492
Client Index = 7	Epoch: 4	Loss: 0.577635
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 8
local mask changes: 1700240.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1887202.0, 1700240.0, 1885936.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.245112
Client Index = 8	Epoch: 1	Loss: 0.114441
Client Index = 8	Epoch: 2	Loss: 0.087592
Client Index = 8	Epoch: 3	Loss: 0.084279
Client Index = 8	Epoch: 4	Loss: 0.057777
test acc on this client after 463 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 9
local mask changes: 1701440.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1888184.0, 1701440.0, 1888494.0]
Doing local aggregation!
test acc on this client before 356 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.532570
Client Index = 9	Epoch: 1	Loss: 0.346528
Client Index = 9	Epoch: 2	Loss: 0.405163
Client Index = 9	Epoch: 3	Loss: 0.359246
Client Index = 9	Epoch: 4	Loss: 0.414313
test acc on this client after 367 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 10
local mask changes: 1700622.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1888784.0, 1700622.0, 1889314.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.516364
Client Index = 10	Epoch: 1	Loss: 0.539007
Client Index = 10	Epoch: 2	Loss: 0.443554
Client Index = 10	Epoch: 3	Loss: 0.401608
Client Index = 10	Epoch: 4	Loss: 0.431274
test acc on this client after 290 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 11
local mask changes: 1701686.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1888452.0, 1701686.0, 1887640.0]
Doing local aggregation!
test acc on this client before 371 / 505 : 0.73
Client Index = 11	Epoch: 0	Loss: 0.293637
Client Index = 11	Epoch: 1	Loss: 0.178923
Client Index = 11	Epoch: 2	Loss: 0.263408
Client Index = 11	Epoch: 3	Loss: 0.151194
Client Index = 11	Epoch: 4	Loss: 0.192752
test acc on this client after 419 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 12
local mask changes: 1700232.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1889674.0, 1700232.0, 1890190.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 12	Epoch: 0	Loss: 0.483448
Client Index = 12	Epoch: 1	Loss: 0.546358
Client Index = 12	Epoch: 2	Loss: 0.360833
Client Index = 12	Epoch: 3	Loss: 0.315463
Client Index = 12	Epoch: 4	Loss: 0.344833
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653313536.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 13
local mask changes: 1701270.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1890290.0, 1701270.0, 1888952.0]
Doing local aggregation!
test acc on this client before 402 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.390094
Client Index = 13	Epoch: 1	Loss: 0.315241
Client Index = 13	Epoch: 2	Loss: 0.462036
Client Index = 13	Epoch: 3	Loss: 0.287395
Client Index = 13	Epoch: 4	Loss: 0.232546
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653300224.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 14
local mask changes: 1699362.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1888800.0, 1699362.0, 1888326.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.504717
Client Index = 14	Epoch: 1	Loss: 0.407664
Client Index = 14	Epoch: 2	Loss: 0.424227
Client Index = 14	Epoch: 3	Loss: 0.270879
Client Index = 14	Epoch: 4	Loss: 0.457946
test acc on this client after 334 / 503 : 0.66
-----------------------------------
training flops per data 2653306368.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 15
local mask changes: 1701004.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1887146.0, 1701004.0, 1885814.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.408467
Client Index = 15	Epoch: 1	Loss: 0.297534
Client Index = 15	Epoch: 2	Loss: 0.321323
Client Index = 15	Epoch: 3	Loss: 0.268125
Client Index = 15	Epoch: 4	Loss: 0.296853
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653311488.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 16
local mask changes: 1699472.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1887026.0, 1699472.0, 1888488.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.457128
Client Index = 16	Epoch: 1	Loss: 0.408997
Client Index = 16	Epoch: 2	Loss: 0.361100
Client Index = 16	Epoch: 3	Loss: 0.273651
Client Index = 16	Epoch: 4	Loss: 0.251540
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 17
local mask changes: 1700984.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1888614.0, 1700984.0, 1888358.0]
Doing local aggregation!
test acc on this client before 295 / 503 : 0.59
Client Index = 17	Epoch: 0	Loss: 0.563886
Client Index = 17	Epoch: 1	Loss: 0.575778
Client Index = 17	Epoch: 2	Loss: 0.389643
Client Index = 17	Epoch: 3	Loss: 0.461250
Client Index = 17	Epoch: 4	Loss: 0.475683
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 18
local mask changes: 1700778.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1886820.0, 1700778.0, 1886666.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.364305
Client Index = 18	Epoch: 1	Loss: 0.438645
Client Index = 18	Epoch: 2	Loss: 0.238626
Client Index = 18	Epoch: 3	Loss: 0.376576
Client Index = 18	Epoch: 4	Loss: 0.199693
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 19
local mask changes: 1701034.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1889212.0, 1887418.0, 1701034.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.519931
Client Index = 19	Epoch: 1	Loss: 0.313550
Client Index = 19	Epoch: 2	Loss: 0.340319
Client Index = 19	Epoch: 3	Loss: 0.311433
Client Index = 19	Epoch: 4	Loss: 0.521307
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.35614199908822775}
################local_test_on_all_clients after local training in communication round: 52
{'test_acc_after': 0.7517779858833098, 'test_loss_after': 0.8502615415555159}
################local_test_on_all_clients before local training in communication round: 52
{'test_acc_before': 0.7366978030366662, 'test_loss_before': 0.8495807547756604}
################Communication round : 53
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 0
local mask changes: 1656686.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1656686.0, 1848714.0, 1849320.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.458625
Client Index = 0	Epoch: 1	Loss: 0.457845
Client Index = 0	Epoch: 2	Loss: 0.303590
Client Index = 0	Epoch: 3	Loss: 0.259242
Client Index = 0	Epoch: 4	Loss: 0.249891
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 1
local mask changes: 1655340.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1848304.0, 1655340.0, 1848774.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 1	Epoch: 0	Loss: 0.309282
Client Index = 1	Epoch: 1	Loss: 0.320951
Client Index = 1	Epoch: 2	Loss: 0.137127
Client Index = 1	Epoch: 3	Loss: 0.242517
Client Index = 1	Epoch: 4	Loss: 0.153148
test acc on this client after 432 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 2
local mask changes: 1656300.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1847598.0, 1656300.0, 1848496.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.222094
Client Index = 2	Epoch: 1	Loss: 0.137463
Client Index = 2	Epoch: 2	Loss: 0.109200
Client Index = 2	Epoch: 3	Loss: 0.089384
Client Index = 2	Epoch: 4	Loss: 0.069985
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 3
local mask changes: 1655606.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1849826.0, 1655606.0, 1850496.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.345056
Client Index = 3	Epoch: 1	Loss: 0.409630
Client Index = 3	Epoch: 2	Loss: 0.218629
Client Index = 3	Epoch: 3	Loss: 0.141989
Client Index = 3	Epoch: 4	Loss: 0.143814
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 4
local mask changes: 1655388.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1853170.0, 1655388.0, 1850220.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.416112
Client Index = 4	Epoch: 1	Loss: 0.329919
Client Index = 4	Epoch: 2	Loss: 0.491560
Client Index = 4	Epoch: 3	Loss: 0.237082
Client Index = 4	Epoch: 4	Loss: 0.296834
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 5
local mask changes: 1655160.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1850606.0, 1655160.0, 1852070.0]
Doing local aggregation!
test acc on this client before 370 / 503 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.423409
Client Index = 5	Epoch: 1	Loss: 0.344583
Client Index = 5	Epoch: 2	Loss: 0.431926
Client Index = 5	Epoch: 3	Loss: 0.338074
Client Index = 5	Epoch: 4	Loss: 0.402144
test acc on this client after 332 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 6
local mask changes: 1657028.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1852076.0, 1657028.0, 1851792.0]
Doing local aggregation!
test acc on this client before 352 / 505 : 0.70
Client Index = 6	Epoch: 0	Loss: 0.485673
Client Index = 6	Epoch: 1	Loss: 0.469290
Client Index = 6	Epoch: 2	Loss: 0.413204
Client Index = 6	Epoch: 3	Loss: 0.378787
Client Index = 6	Epoch: 4	Loss: 0.335682
test acc on this client after 333 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 7
local mask changes: 1654986.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1852674.0, 1654986.0, 1851190.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 7	Epoch: 0	Loss: 0.653754
Client Index = 7	Epoch: 1	Loss: 0.579208
Client Index = 7	Epoch: 2	Loss: 0.621053
Client Index = 7	Epoch: 3	Loss: 0.540857
Client Index = 7	Epoch: 4	Loss: 0.441925
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 8
local mask changes: 1657060.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1847774.0, 1657060.0, 1846640.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.197377
Client Index = 8	Epoch: 1	Loss: 0.167125
Client Index = 8	Epoch: 2	Loss: 0.092831
Client Index = 8	Epoch: 3	Loss: 0.063063
Client Index = 8	Epoch: 4	Loss: 0.135572
test acc on this client after 461 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 9
local mask changes: 1654394.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1850686.0, 1654394.0, 1849402.0]
Doing local aggregation!
test acc on this client before 355 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.594805
Client Index = 9	Epoch: 1	Loss: 0.330102
Client Index = 9	Epoch: 2	Loss: 0.340206
Client Index = 9	Epoch: 3	Loss: 0.387377
Client Index = 9	Epoch: 4	Loss: 0.405616
test acc on this client after 352 / 506 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 10
local mask changes: 1655416.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1851900.0, 1655416.0, 1851012.0]
Doing local aggregation!
test acc on this client before 358 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.488833
Client Index = 10	Epoch: 1	Loss: 0.524546
Client Index = 10	Epoch: 2	Loss: 0.361390
Client Index = 10	Epoch: 3	Loss: 0.445316
Client Index = 10	Epoch: 4	Loss: 0.392927
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 11
local mask changes: 1656832.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1850100.0, 1656832.0, 1850418.0]
Doing local aggregation!
test acc on this client before 373 / 505 : 0.74
Client Index = 11	Epoch: 0	Loss: 0.351445
Client Index = 11	Epoch: 1	Loss: 0.371811
Client Index = 11	Epoch: 2	Loss: 0.167160
Client Index = 11	Epoch: 3	Loss: 0.124825
Client Index = 11	Epoch: 4	Loss: 0.116281
test acc on this client after 421 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 12
local mask changes: 1656360.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1851496.0, 1656360.0, 1850652.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.573853
Client Index = 12	Epoch: 1	Loss: 0.336649
Client Index = 12	Epoch: 2	Loss: 0.568984
Client Index = 12	Epoch: 3	Loss: 0.407147
Client Index = 12	Epoch: 4	Loss: 0.338759
test acc on this client after 326 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 13
local mask changes: 1656002.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1850714.0, 1656002.0, 1851300.0]
Doing local aggregation!
test acc on this client before 402 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.443657
Client Index = 13	Epoch: 1	Loss: 0.315328
Client Index = 13	Epoch: 2	Loss: 0.338921
Client Index = 13	Epoch: 3	Loss: 0.234602
Client Index = 13	Epoch: 4	Loss: 0.381488
test acc on this client after 383 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 14
local mask changes: 1656126.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1851072.0, 1656126.0, 1851844.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.474378
Client Index = 14	Epoch: 1	Loss: 0.401733
Client Index = 14	Epoch: 2	Loss: 0.369444
Client Index = 14	Epoch: 3	Loss: 0.327638
Client Index = 14	Epoch: 4	Loss: 0.333454
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653299456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 15
local mask changes: 1655402.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1849636.0, 1655402.0, 1847314.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.437450
Client Index = 15	Epoch: 1	Loss: 0.313787
Client Index = 15	Epoch: 2	Loss: 0.254583
Client Index = 15	Epoch: 3	Loss: 0.282012
Client Index = 15	Epoch: 4	Loss: 0.327574
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 16
local mask changes: 1654944.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1847734.0, 1654944.0, 1848386.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 16	Epoch: 0	Loss: 0.474446
Client Index = 16	Epoch: 1	Loss: 0.377181
Client Index = 16	Epoch: 2	Loss: 0.345418
Client Index = 16	Epoch: 3	Loss: 0.332084
Client Index = 16	Epoch: 4	Loss: 0.418980
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 17
local mask changes: 1655638.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1850084.0, 1655638.0, 1849342.0]
Doing local aggregation!
test acc on this client before 320 / 503 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.543610
Client Index = 17	Epoch: 1	Loss: 0.473650
Client Index = 17	Epoch: 2	Loss: 0.411097
Client Index = 17	Epoch: 3	Loss: 0.563784
Client Index = 17	Epoch: 4	Loss: 0.373635
test acc on this client after 300 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 18
local mask changes: 1655934.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1850216.0, 1655934.0, 1848842.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.421385
Client Index = 18	Epoch: 1	Loss: 0.322825
Client Index = 18	Epoch: 2	Loss: 0.223637
Client Index = 18	Epoch: 3	Loss: 0.282000
Client Index = 18	Epoch: 4	Loss: 0.485502
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 19
local mask changes: 1655756.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1849920.0, 1850110.0, 1655756.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.361929
Client Index = 19	Epoch: 1	Loss: 0.595970
Client Index = 19	Epoch: 2	Loss: 0.295900
Client Index = 19	Epoch: 3	Loss: 0.253740
Client Index = 19	Epoch: 4	Loss: 0.289008
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.34776370046846566}
################local_test_on_all_clients after local training in communication round: 53
{'test_acc_after': 0.74246045096156, 'test_loss_after': 0.903101699116695}
################local_test_on_all_clients before local training in communication round: 53
{'test_acc_before': 0.7408662455529724, 'test_loss_before': 0.8258973015432971}
################Communication round : 54
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 0
local mask changes: 1609142.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1609142.0, 1809798.0, 1811146.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.583286
Client Index = 0	Epoch: 1	Loss: 0.361174
Client Index = 0	Epoch: 2	Loss: 0.382356
Client Index = 0	Epoch: 3	Loss: 0.290155
Client Index = 0	Epoch: 4	Loss: 0.186231
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 1
local mask changes: 1611490.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1807788.0, 1611490.0, 1809962.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 1	Epoch: 0	Loss: 0.371311
Client Index = 1	Epoch: 1	Loss: 0.179278
Client Index = 1	Epoch: 2	Loss: 0.185026
Client Index = 1	Epoch: 3	Loss: 0.160724
Client Index = 1	Epoch: 4	Loss: 0.154683
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 2
local mask changes: 1611478.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1809172.0, 1611478.0, 1808610.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.181988
Client Index = 2	Epoch: 1	Loss: 0.126774
Client Index = 2	Epoch: 2	Loss: 0.142204
Client Index = 2	Epoch: 3	Loss: 0.092114
Client Index = 2	Epoch: 4	Loss: 0.065942
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 3
local mask changes: 1610404.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1809106.0, 1610404.0, 1812304.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.447937
Client Index = 3	Epoch: 1	Loss: 0.188823
Client Index = 3	Epoch: 2	Loss: 0.149623
Client Index = 3	Epoch: 3	Loss: 0.251138
Client Index = 3	Epoch: 4	Loss: 0.408710
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 4
local mask changes: 1609768.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1813822.0, 1609768.0, 1812690.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.533789
Client Index = 4	Epoch: 1	Loss: 0.325952
Client Index = 4	Epoch: 2	Loss: 0.484480
Client Index = 4	Epoch: 3	Loss: 0.329957
Client Index = 4	Epoch: 4	Loss: 0.248540
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 5
local mask changes: 1610672.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1811910.0, 1610672.0, 1813138.0]
Doing local aggregation!
test acc on this client before 334 / 503 : 0.66
Client Index = 5	Epoch: 0	Loss: 0.469560
Client Index = 5	Epoch: 1	Loss: 0.399557
Client Index = 5	Epoch: 2	Loss: 0.363944
Client Index = 5	Epoch: 3	Loss: 0.426159
Client Index = 5	Epoch: 4	Loss: 0.408414
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 6
local mask changes: 1611364.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1813982.0, 1611364.0, 1814152.0]
Doing local aggregation!
test acc on this client before 337 / 505 : 0.67
Client Index = 6	Epoch: 0	Loss: 0.497441
Client Index = 6	Epoch: 1	Loss: 0.383095
Client Index = 6	Epoch: 2	Loss: 0.360183
Client Index = 6	Epoch: 3	Loss: 0.375545
Client Index = 6	Epoch: 4	Loss: 0.315927
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 7
local mask changes: 1610020.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1814740.0, 1610020.0, 1812552.0]
Doing local aggregation!
test acc on this client before 344 / 504 : 0.68
Client Index = 7	Epoch: 0	Loss: 0.797263
Client Index = 7	Epoch: 1	Loss: 0.493578
Client Index = 7	Epoch: 2	Loss: 0.561862
Client Index = 7	Epoch: 3	Loss: 0.526307
Client Index = 7	Epoch: 4	Loss: 0.490238
test acc on this client after 290 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 8
local mask changes: 1609816.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1810216.0, 1609816.0, 1807902.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.359654
Client Index = 8	Epoch: 1	Loss: 0.113233
Client Index = 8	Epoch: 2	Loss: 0.122552
Client Index = 8	Epoch: 3	Loss: 0.108596
Client Index = 8	Epoch: 4	Loss: 0.056728
test acc on this client after 463 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 9
local mask changes: 1611990.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1811664.0, 1611990.0, 1812718.0]
Doing local aggregation!
test acc on this client before 350 / 506 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.518728
Client Index = 9	Epoch: 1	Loss: 0.436598
Client Index = 9	Epoch: 2	Loss: 0.307167
Client Index = 9	Epoch: 3	Loss: 0.351778
Client Index = 9	Epoch: 4	Loss: 0.425397
test acc on this client after 355 / 506 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 10
local mask changes: 1610830.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1813048.0, 1610830.0, 1811624.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.459485
Client Index = 10	Epoch: 1	Loss: 0.505536
Client Index = 10	Epoch: 2	Loss: 0.385108
Client Index = 10	Epoch: 3	Loss: 0.345647
Client Index = 10	Epoch: 4	Loss: 0.358591
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 11
local mask changes: 1610360.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1810070.0, 1610360.0, 1812330.0]
Doing local aggregation!
test acc on this client before 366 / 505 : 0.72
Client Index = 11	Epoch: 0	Loss: 0.498201
Client Index = 11	Epoch: 1	Loss: 0.181485
Client Index = 11	Epoch: 2	Loss: 0.152389
Client Index = 11	Epoch: 3	Loss: 0.140031
Client Index = 11	Epoch: 4	Loss: 0.134145
test acc on this client after 415 / 505 : 0.82
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 12
local mask changes: 1611904.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1813786.0, 1611904.0, 1812486.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.469783
Client Index = 12	Epoch: 1	Loss: 0.377320
Client Index = 12	Epoch: 2	Loss: 0.460176
Client Index = 12	Epoch: 3	Loss: 0.429778
Client Index = 12	Epoch: 4	Loss: 0.333443
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 13
local mask changes: 1610452.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1812146.0, 1610452.0, 1813940.0]
Doing local aggregation!
test acc on this client before 407 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.444677
Client Index = 13	Epoch: 1	Loss: 0.346625
Client Index = 13	Epoch: 2	Loss: 0.302171
Client Index = 13	Epoch: 3	Loss: 0.257390
Client Index = 13	Epoch: 4	Loss: 0.334222
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653321216.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 14
local mask changes: 1611378.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1813050.0, 1611378.0, 1812328.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.445270
Client Index = 14	Epoch: 1	Loss: 0.438360
Client Index = 14	Epoch: 2	Loss: 0.384048
Client Index = 14	Epoch: 3	Loss: 0.305642
Client Index = 14	Epoch: 4	Loss: 0.373986
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 15
local mask changes: 1610000.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1812272.0, 1610000.0, 1807552.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.401485
Client Index = 15	Epoch: 1	Loss: 0.358710
Client Index = 15	Epoch: 2	Loss: 0.246194
Client Index = 15	Epoch: 3	Loss: 0.252371
Client Index = 15	Epoch: 4	Loss: 0.283082
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653311488.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 16
local mask changes: 1609922.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1809350.0, 1609922.0, 1809764.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 16	Epoch: 0	Loss: 0.527470
Client Index = 16	Epoch: 1	Loss: 0.318050
Client Index = 16	Epoch: 2	Loss: 0.470880
Client Index = 16	Epoch: 3	Loss: 0.300590
Client Index = 16	Epoch: 4	Loss: 0.237370
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653331456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 17
local mask changes: 1610634.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1810980.0, 1610634.0, 1812354.0]
Doing local aggregation!
test acc on this client before 313 / 503 : 0.62
Client Index = 17	Epoch: 0	Loss: 0.566425
Client Index = 17	Epoch: 1	Loss: 0.463048
Client Index = 17	Epoch: 2	Loss: 0.436197
Client Index = 17	Epoch: 3	Loss: 0.420960
Client Index = 17	Epoch: 4	Loss: 0.424664
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 18
local mask changes: 1610752.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1810764.0, 1610752.0, 1811764.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 18	Epoch: 0	Loss: 0.365477
Client Index = 18	Epoch: 1	Loss: 0.246544
Client Index = 18	Epoch: 2	Loss: 0.425200
Client Index = 18	Epoch: 3	Loss: 0.244058
Client Index = 18	Epoch: 4	Loss: 0.164042
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 19
local mask changes: 1611060.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1811498.0, 1809318.0, 1611060.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.526638
Client Index = 19	Epoch: 1	Loss: 0.344550
Client Index = 19	Epoch: 2	Loss: 0.304917
Client Index = 19	Epoch: 3	Loss: 0.228723
Client Index = 19	Epoch: 4	Loss: 0.503925
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.3442677124850453}
################local_test_on_all_clients after local training in communication round: 54
{'test_acc_after': 0.7542681916478943, 'test_loss_after': 0.8494672156840253}
################local_test_on_all_clients before local training in communication round: 54
{'test_acc_before': 0.7355193336483544, 'test_loss_before': 0.8602928057360041}
################Communication round : 55
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 0
local mask changes: 1565692.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1565692.0, 1772114.0, 1773064.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 0	Epoch: 0	Loss: 0.561685
Client Index = 0	Epoch: 1	Loss: 0.286515
Client Index = 0	Epoch: 2	Loss: 0.361904
Client Index = 0	Epoch: 3	Loss: 0.274788
Client Index = 0	Epoch: 4	Loss: 0.275949
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 1
local mask changes: 1564988.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1770556.0, 1564988.0, 1769856.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.507169
Client Index = 1	Epoch: 1	Loss: 0.178014
Client Index = 1	Epoch: 2	Loss: 0.186892
Client Index = 1	Epoch: 3	Loss: 0.181921
Client Index = 1	Epoch: 4	Loss: 0.156949
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 2
local mask changes: 1564962.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1770554.0, 1564962.0, 1770954.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.161793
Client Index = 2	Epoch: 1	Loss: 0.232510
Client Index = 2	Epoch: 2	Loss: 0.131688
Client Index = 2	Epoch: 3	Loss: 0.088260
Client Index = 2	Epoch: 4	Loss: 0.073669
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 3
local mask changes: 1565356.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1771176.0, 1565356.0, 1774332.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.492551
Client Index = 3	Epoch: 1	Loss: 0.194021
Client Index = 3	Epoch: 2	Loss: 0.163515
Client Index = 3	Epoch: 3	Loss: 0.179575
Client Index = 3	Epoch: 4	Loss: 0.147862
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 4
local mask changes: 1565104.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1773638.0, 1565104.0, 1773722.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.383157
Client Index = 4	Epoch: 1	Loss: 0.400031
Client Index = 4	Epoch: 2	Loss: 0.329223
Client Index = 4	Epoch: 3	Loss: 0.253021
Client Index = 4	Epoch: 4	Loss: 0.487131
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 5
local mask changes: 1565168.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1774184.0, 1565168.0, 1775332.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.473377
Client Index = 5	Epoch: 1	Loss: 0.297867
Client Index = 5	Epoch: 2	Loss: 0.614397
Client Index = 5	Epoch: 3	Loss: 0.312276
Client Index = 5	Epoch: 4	Loss: 0.249757
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 6
local mask changes: 1564130.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1775160.0, 1564130.0, 1775602.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.408405
Client Index = 6	Epoch: 1	Loss: 0.556056
Client Index = 6	Epoch: 2	Loss: 0.403129
Client Index = 6	Epoch: 3	Loss: 0.337450
Client Index = 6	Epoch: 4	Loss: 0.294790
test acc on this client after 352 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 7
local mask changes: 1566004.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1775190.0, 1566004.0, 1775020.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.615476
Client Index = 7	Epoch: 1	Loss: 0.588925
Client Index = 7	Epoch: 2	Loss: 0.575946
Client Index = 7	Epoch: 3	Loss: 0.498722
Client Index = 7	Epoch: 4	Loss: 0.578286
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 8
local mask changes: 1565750.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1770456.0, 1565750.0, 1769718.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.154267
Client Index = 8	Epoch: 1	Loss: 0.089983
Client Index = 8	Epoch: 2	Loss: 0.088627
Client Index = 8	Epoch: 3	Loss: 0.113491
Client Index = 8	Epoch: 4	Loss: 0.090105
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 9
local mask changes: 1564958.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1771912.0, 1564958.0, 1773964.0]
Doing local aggregation!
test acc on this client before 336 / 506 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.415720
Client Index = 9	Epoch: 1	Loss: 0.341150
Client Index = 9	Epoch: 2	Loss: 0.444271
Client Index = 9	Epoch: 3	Loss: 0.351922
Client Index = 9	Epoch: 4	Loss: 0.264073
test acc on this client after 329 / 506 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 10
local mask changes: 1565126.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1773528.0, 1565126.0, 1773114.0]
Doing local aggregation!
test acc on this client before 358 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.553993
Client Index = 10	Epoch: 1	Loss: 0.461752
Client Index = 10	Epoch: 2	Loss: 0.347024
Client Index = 10	Epoch: 3	Loss: 0.378665
Client Index = 10	Epoch: 4	Loss: 0.443572
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 11
local mask changes: 1564454.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1772930.0, 1564454.0, 1773188.0]
Doing local aggregation!
test acc on this client before 380 / 505 : 0.75
Client Index = 11	Epoch: 0	Loss: 0.372004
Client Index = 11	Epoch: 1	Loss: 0.196646
Client Index = 11	Epoch: 2	Loss: 0.166523
Client Index = 11	Epoch: 3	Loss: 0.176040
Client Index = 11	Epoch: 4	Loss: 0.295865
test acc on this client after 421 / 505 : 0.83
-----------------------------------
training flops per data 2653337088.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 12
local mask changes: 1565272.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1775206.0, 1565272.0, 1774802.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.561576
Client Index = 12	Epoch: 1	Loss: 0.396082
Client Index = 12	Epoch: 2	Loss: 0.361304
Client Index = 12	Epoch: 3	Loss: 0.320034
Client Index = 12	Epoch: 4	Loss: 0.227265
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653319680.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 13
local mask changes: 1565288.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1775404.0, 1565288.0, 1774260.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.285000
Client Index = 13	Epoch: 1	Loss: 0.319836
Client Index = 13	Epoch: 2	Loss: 0.328624
Client Index = 13	Epoch: 3	Loss: 0.277072
Client Index = 13	Epoch: 4	Loss: 0.325196
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653324032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 14
local mask changes: 1565376.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1774198.0, 1565376.0, 1773748.0]
Doing local aggregation!
test acc on this client before 370 / 503 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.363997
Client Index = 14	Epoch: 1	Loss: 0.391937
Client Index = 14	Epoch: 2	Loss: 0.303747
Client Index = 14	Epoch: 3	Loss: 0.300608
Client Index = 14	Epoch: 4	Loss: 0.365784
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653315072.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 15
local mask changes: 1564842.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1771906.0, 1564842.0, 1769878.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.358363
Client Index = 15	Epoch: 1	Loss: 0.359897
Client Index = 15	Epoch: 2	Loss: 0.240677
Client Index = 15	Epoch: 3	Loss: 0.320175
Client Index = 15	Epoch: 4	Loss: 0.235326
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653317888.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 16
local mask changes: 1564740.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1770016.0, 1564740.0, 1771348.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 16	Epoch: 0	Loss: 0.490725
Client Index = 16	Epoch: 1	Loss: 0.366562
Client Index = 16	Epoch: 2	Loss: 0.278207
Client Index = 16	Epoch: 3	Loss: 0.390460
Client Index = 16	Epoch: 4	Loss: 0.237220
test acc on this client after 344 / 504 : 0.68
-----------------------------------
training flops per data 2653335552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 17
local mask changes: 1563542.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1771482.0, 1563542.0, 1774184.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.498237
Client Index = 17	Epoch: 1	Loss: 0.494392
Client Index = 17	Epoch: 2	Loss: 0.521256
Client Index = 17	Epoch: 3	Loss: 0.376689
Client Index = 17	Epoch: 4	Loss: 0.390817
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653323776.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 18
local mask changes: 1564278.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1772408.0, 1564278.0, 1771830.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.388166
Client Index = 18	Epoch: 1	Loss: 0.257535
Client Index = 18	Epoch: 2	Loss: 0.340526
Client Index = 18	Epoch: 3	Loss: 0.228610
Client Index = 18	Epoch: 4	Loss: 0.233314
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653338112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 19
local mask changes: 1564426.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1773682.0, 1771704.0, 1564426.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.366310
Client Index = 19	Epoch: 1	Loss: 0.301151
Client Index = 19	Epoch: 2	Loss: 0.338819
Client Index = 19	Epoch: 3	Loss: 0.437965
Client Index = 19	Epoch: 4	Loss: 0.506877
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.33326678814832117}
################local_test_on_all_clients after local training in communication round: 55
{'test_acc_after': 0.7552732114693631, 'test_loss_after': 0.8828638489019746}
################local_test_on_all_clients before local training in communication round: 55
{'test_acc_before': 0.7461344005805691, 'test_loss_before': 0.8337871734907164}
################Communication round : 56
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 0
local mask changes: 1520612.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1520612.0, 1732590.0, 1735796.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.497435
Client Index = 0	Epoch: 1	Loss: 0.450136
Client Index = 0	Epoch: 2	Loss: 0.247965
Client Index = 0	Epoch: 3	Loss: 0.368480
Client Index = 0	Epoch: 4	Loss: 0.287738
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 1
local mask changes: 1518930.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1732026.0, 1518930.0, 1731470.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 1	Epoch: 0	Loss: 0.252127
Client Index = 1	Epoch: 1	Loss: 0.245044
Client Index = 1	Epoch: 2	Loss: 0.408143
Client Index = 1	Epoch: 3	Loss: 0.175617
Client Index = 1	Epoch: 4	Loss: 0.213990
test acc on this client after 436 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 2
local mask changes: 1517014.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1730516.0, 1517014.0, 1730526.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.190885
Client Index = 2	Epoch: 1	Loss: 0.157598
Client Index = 2	Epoch: 2	Loss: 0.098998
Client Index = 2	Epoch: 3	Loss: 0.064276
Client Index = 2	Epoch: 4	Loss: 0.083946
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 3
local mask changes: 1519324.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1732394.0, 1519324.0, 1734756.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.198642
Client Index = 3	Epoch: 1	Loss: 0.330017
Client Index = 3	Epoch: 2	Loss: 0.137661
Client Index = 3	Epoch: 3	Loss: 0.127931
Client Index = 3	Epoch: 4	Loss: 0.154914
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 4
local mask changes: 1519746.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1735824.0, 1519746.0, 1736206.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.355221
Client Index = 4	Epoch: 1	Loss: 0.451800
Client Index = 4	Epoch: 2	Loss: 0.329469
Client Index = 4	Epoch: 3	Loss: 0.370946
Client Index = 4	Epoch: 4	Loss: 0.257958
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 5
local mask changes: 1519758.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1736744.0, 1519758.0, 1737496.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 5	Epoch: 0	Loss: 0.420306
Client Index = 5	Epoch: 1	Loss: 0.395977
Client Index = 5	Epoch: 2	Loss: 0.363140
Client Index = 5	Epoch: 3	Loss: 0.296274
Client Index = 5	Epoch: 4	Loss: 0.255251
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 6
local mask changes: 1518172.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1737814.0, 1518172.0, 1737818.0]
Doing local aggregation!
test acc on this client before 351 / 505 : 0.70
Client Index = 6	Epoch: 0	Loss: 0.468370
Client Index = 6	Epoch: 1	Loss: 0.342781
Client Index = 6	Epoch: 2	Loss: 0.341207
Client Index = 6	Epoch: 3	Loss: 0.407047
Client Index = 6	Epoch: 4	Loss: 0.302781
test acc on this client after 366 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 7
local mask changes: 1518876.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1736948.0, 1518876.0, 1735760.0]
Doing local aggregation!
test acc on this client before 334 / 504 : 0.66
Client Index = 7	Epoch: 0	Loss: 0.625871
Client Index = 7	Epoch: 1	Loss: 0.488746
Client Index = 7	Epoch: 2	Loss: 0.489116
Client Index = 7	Epoch: 3	Loss: 0.522880
Client Index = 7	Epoch: 4	Loss: 0.562120
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 8
local mask changes: 1519336.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1732838.0, 1519336.0, 1731458.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.168232
Client Index = 8	Epoch: 1	Loss: 0.089509
Client Index = 8	Epoch: 2	Loss: 0.123951
Client Index = 8	Epoch: 3	Loss: 0.066361
Client Index = 8	Epoch: 4	Loss: 0.052731
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 9
local mask changes: 1519648.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1734534.0, 1519648.0, 1736016.0]
Doing local aggregation!
test acc on this client before 373 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.426626
Client Index = 9	Epoch: 1	Loss: 0.382718
Client Index = 9	Epoch: 2	Loss: 0.312277
Client Index = 9	Epoch: 3	Loss: 0.298113
Client Index = 9	Epoch: 4	Loss: 0.491028
test acc on this client after 366 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 10
local mask changes: 1519376.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1736298.0, 1519376.0, 1735950.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.441458
Client Index = 10	Epoch: 1	Loss: 0.448683
Client Index = 10	Epoch: 2	Loss: 0.458758
Client Index = 10	Epoch: 3	Loss: 0.344318
Client Index = 10	Epoch: 4	Loss: 0.308409
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 11
local mask changes: 1518740.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1734896.0, 1518740.0, 1733996.0]
Doing local aggregation!
test acc on this client before 391 / 505 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.225671
Client Index = 11	Epoch: 1	Loss: 0.233659
Client Index = 11	Epoch: 2	Loss: 0.161898
Client Index = 11	Epoch: 3	Loss: 0.133708
Client Index = 11	Epoch: 4	Loss: 0.140020
test acc on this client after 416 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 12
local mask changes: 1518380.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1734170.0, 1518380.0, 1736386.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.452193
Client Index = 12	Epoch: 1	Loss: 0.332044
Client Index = 12	Epoch: 2	Loss: 0.330614
Client Index = 12	Epoch: 3	Loss: 0.404439
Client Index = 12	Epoch: 4	Loss: 0.266215
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 13
local mask changes: 1518916.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1735834.0, 1518916.0, 1736266.0]
Doing local aggregation!
test acc on this client before 407 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.385120
Client Index = 13	Epoch: 1	Loss: 0.227260
Client Index = 13	Epoch: 2	Loss: 0.398873
Client Index = 13	Epoch: 3	Loss: 0.316640
Client Index = 13	Epoch: 4	Loss: 0.196790
test acc on this client after 371 / 505 : 0.73
-----------------------------------
training flops per data 2653314560.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 14
local mask changes: 1518664.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1736188.0, 1518664.0, 1734798.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 14	Epoch: 0	Loss: 0.463702
Client Index = 14	Epoch: 1	Loss: 0.424633
Client Index = 14	Epoch: 2	Loss: 0.279619
Client Index = 14	Epoch: 3	Loss: 0.362290
Client Index = 14	Epoch: 4	Loss: 0.301891
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 15
local mask changes: 1518886.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1733420.0, 1518886.0, 1731564.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.431965
Client Index = 15	Epoch: 1	Loss: 0.232834
Client Index = 15	Epoch: 2	Loss: 0.241106
Client Index = 15	Epoch: 3	Loss: 0.273155
Client Index = 15	Epoch: 4	Loss: 0.215607
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653313024.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 16
local mask changes: 1519390.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1731308.0, 1519390.0, 1731462.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.392657
Client Index = 16	Epoch: 1	Loss: 0.362588
Client Index = 16	Epoch: 2	Loss: 0.438778
Client Index = 16	Epoch: 3	Loss: 0.270806
Client Index = 16	Epoch: 4	Loss: 0.273037
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 17
local mask changes: 1518726.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1734888.0, 1518726.0, 1735526.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 17	Epoch: 0	Loss: 0.509324
Client Index = 17	Epoch: 1	Loss: 0.472978
Client Index = 17	Epoch: 2	Loss: 0.363464
Client Index = 17	Epoch: 3	Loss: 0.431930
Client Index = 17	Epoch: 4	Loss: 0.347457
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 18
local mask changes: 1518884.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1733480.0, 1518884.0, 1733344.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.327838
Client Index = 18	Epoch: 1	Loss: 0.323906
Client Index = 18	Epoch: 2	Loss: 0.330814
Client Index = 18	Epoch: 3	Loss: 0.179865
Client Index = 18	Epoch: 4	Loss: 0.331246
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 19
local mask changes: 1518680.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1734692.0, 1731740.0, 1518680.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.338479
Client Index = 19	Epoch: 1	Loss: 0.335786
Client Index = 19	Epoch: 2	Loss: 0.291824
Client Index = 19	Epoch: 3	Loss: 0.264921
Client Index = 19	Epoch: 4	Loss: 0.484687
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.316563050178811}
################local_test_on_all_clients after local training in communication round: 56
{'test_acc_after': 0.765501022882069, 'test_loss_after': 0.8239260764068479}
################local_test_on_all_clients before local training in communication round: 56
{'test_acc_before': 0.7515833517584869, 'test_loss_before': 0.8182781794540034}
################Communication round : 57
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 0
local mask changes: 1473058.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1473058.0, 1694572.0, 1696334.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 0	Epoch: 0	Loss: 0.382481
Client Index = 0	Epoch: 1	Loss: 0.359428
Client Index = 0	Epoch: 2	Loss: 0.364527
Client Index = 0	Epoch: 3	Loss: 0.235464
Client Index = 0	Epoch: 4	Loss: 0.390527
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 1
local mask changes: 1473660.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1694106.0, 1473660.0, 1693272.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.248083
Client Index = 1	Epoch: 1	Loss: 0.227545
Client Index = 1	Epoch: 2	Loss: 0.159788
Client Index = 1	Epoch: 3	Loss: 0.172404
Client Index = 1	Epoch: 4	Loss: 0.122453
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 2
local mask changes: 1471180.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1691968.0, 1471180.0, 1691962.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.141698
Client Index = 2	Epoch: 1	Loss: 0.083767
Client Index = 2	Epoch: 2	Loss: 0.098364
Client Index = 2	Epoch: 3	Loss: 0.123047
Client Index = 2	Epoch: 4	Loss: 0.079739
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 3
local mask changes: 1473114.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1692108.0, 1473114.0, 1695426.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.278496
Client Index = 3	Epoch: 1	Loss: 0.372167
Client Index = 3	Epoch: 2	Loss: 0.143993
Client Index = 3	Epoch: 3	Loss: 0.134782
Client Index = 3	Epoch: 4	Loss: 0.125539
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 4
local mask changes: 1472216.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1695914.0, 1472216.0, 1696538.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.337973
Client Index = 4	Epoch: 1	Loss: 0.419233
Client Index = 4	Epoch: 2	Loss: 0.319509
Client Index = 4	Epoch: 3	Loss: 0.246382
Client Index = 4	Epoch: 4	Loss: 0.317752
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 5
local mask changes: 1473482.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1697532.0, 1473482.0, 1698494.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.415843
Client Index = 5	Epoch: 1	Loss: 0.398200
Client Index = 5	Epoch: 2	Loss: 0.348235
Client Index = 5	Epoch: 3	Loss: 0.273734
Client Index = 5	Epoch: 4	Loss: 0.350036
test acc on this client after 329 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 6
local mask changes: 1473162.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1698942.0, 1473162.0, 1698966.0]
Doing local aggregation!
test acc on this client before 361 / 505 : 0.71
Client Index = 6	Epoch: 0	Loss: 0.405030
Client Index = 6	Epoch: 1	Loss: 0.467950
Client Index = 6	Epoch: 2	Loss: 0.460050
Client Index = 6	Epoch: 3	Loss: 0.275235
Client Index = 6	Epoch: 4	Loss: 0.230222
test acc on this client after 379 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 7
local mask changes: 1472852.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1698984.0, 1472852.0, 1696742.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.619263
Client Index = 7	Epoch: 1	Loss: 0.483078
Client Index = 7	Epoch: 2	Loss: 0.567576
Client Index = 7	Epoch: 3	Loss: 0.434069
Client Index = 7	Epoch: 4	Loss: 0.443104
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 8
local mask changes: 1472876.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1694760.0, 1472876.0, 1692290.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.125702
Client Index = 8	Epoch: 1	Loss: 0.265002
Client Index = 8	Epoch: 2	Loss: 0.080305
Client Index = 8	Epoch: 3	Loss: 0.049493
Client Index = 8	Epoch: 4	Loss: 0.065317
test acc on this client after 455 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 9
local mask changes: 1473610.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1694020.0, 1473610.0, 1698412.0]
Doing local aggregation!
test acc on this client before 363 / 506 : 0.72
Client Index = 9	Epoch: 0	Loss: 0.475927
Client Index = 9	Epoch: 1	Loss: 0.364992
Client Index = 9	Epoch: 2	Loss: 0.300784
Client Index = 9	Epoch: 3	Loss: 0.271104
Client Index = 9	Epoch: 4	Loss: 0.331776
test acc on this client after 372 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 10
local mask changes: 1474172.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1697272.0, 1474172.0, 1696994.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.448391
Client Index = 10	Epoch: 1	Loss: 0.326828
Client Index = 10	Epoch: 2	Loss: 0.449068
Client Index = 10	Epoch: 3	Loss: 0.346649
Client Index = 10	Epoch: 4	Loss: 0.389439
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 11
local mask changes: 1473504.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1696026.0, 1473504.0, 1695468.0]
Doing local aggregation!
test acc on this client before 381 / 505 : 0.75
Client Index = 11	Epoch: 0	Loss: 0.440199
Client Index = 11	Epoch: 1	Loss: 0.202657
Client Index = 11	Epoch: 2	Loss: 0.144851
Client Index = 11	Epoch: 3	Loss: 0.120952
Client Index = 11	Epoch: 4	Loss: 0.099902
test acc on this client after 428 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 12
local mask changes: 1472540.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1697876.0, 1472540.0, 1696908.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 12	Epoch: 0	Loss: 0.554216
Client Index = 12	Epoch: 1	Loss: 0.368775
Client Index = 12	Epoch: 2	Loss: 0.310489
Client Index = 12	Epoch: 3	Loss: 0.426301
Client Index = 12	Epoch: 4	Loss: 0.239083
test acc on this client after 307 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 13
local mask changes: 1472252.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1697982.0, 1472252.0, 1696650.0]
Doing local aggregation!
test acc on this client before 402 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.316660
Client Index = 13	Epoch: 1	Loss: 0.433951
Client Index = 13	Epoch: 2	Loss: 0.216813
Client Index = 13	Epoch: 3	Loss: 0.279196
Client Index = 13	Epoch: 4	Loss: 0.207481
test acc on this client after 259 / 505 : 0.51
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 14
local mask changes: 1473498.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1697390.0, 1473498.0, 1695936.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 14	Epoch: 0	Loss: 0.441488
Client Index = 14	Epoch: 1	Loss: 0.436529
Client Index = 14	Epoch: 2	Loss: 0.268398
Client Index = 14	Epoch: 3	Loss: 0.396613
Client Index = 14	Epoch: 4	Loss: 0.213941
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653313280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 15
local mask changes: 1471906.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1694148.0, 1471906.0, 1691872.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.383837
Client Index = 15	Epoch: 1	Loss: 0.295576
Client Index = 15	Epoch: 2	Loss: 0.386228
Client Index = 15	Epoch: 3	Loss: 0.234193
Client Index = 15	Epoch: 4	Loss: 0.186513
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653319168.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 16
local mask changes: 1472052.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1690470.0, 1472052.0, 1695264.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.357101
Client Index = 16	Epoch: 1	Loss: 0.367631
Client Index = 16	Epoch: 2	Loss: 0.240522
Client Index = 16	Epoch: 3	Loss: 0.334864
Client Index = 16	Epoch: 4	Loss: 0.391946
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653313280.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 17
local mask changes: 1474094.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1695584.0, 1474094.0, 1696426.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 17	Epoch: 0	Loss: 0.548887
Client Index = 17	Epoch: 1	Loss: 0.393402
Client Index = 17	Epoch: 2	Loss: 0.433637
Client Index = 17	Epoch: 3	Loss: 0.337644
Client Index = 17	Epoch: 4	Loss: 0.478744
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 18
local mask changes: 1472646.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1695838.0, 1472646.0, 1694370.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.353437
Client Index = 18	Epoch: 1	Loss: 0.395825
Client Index = 18	Epoch: 2	Loss: 0.224611
Client Index = 18	Epoch: 3	Loss: 0.227397
Client Index = 18	Epoch: 4	Loss: 0.164770
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653339648.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 19
local mask changes: 1473400.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1697106.0, 1694392.0, 1473400.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.379222
Client Index = 19	Epoch: 1	Loss: 0.309644
Client Index = 19	Epoch: 2	Loss: 0.282596
Client Index = 19	Epoch: 3	Loss: 0.253982
Client Index = 19	Epoch: 4	Loss: 0.239659
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.3066790318328422}
################local_test_on_all_clients after local training in communication round: 57
{'test_acc_after': 0.7460405489383879, 'test_loss_after': 0.9080003301969424}
################local_test_on_all_clients before local training in communication round: 57
{'test_acc_before': 0.7526872169839882, 'test_loss_before': 0.8165225429341861}
################Communication round : 58
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 0
local mask changes: 1427018.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1427018.0, 1657132.0, 1657068.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.456466
Client Index = 0	Epoch: 1	Loss: 0.296807
Client Index = 0	Epoch: 2	Loss: 0.256519
Client Index = 0	Epoch: 3	Loss: 0.266700
Client Index = 0	Epoch: 4	Loss: 0.210634
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 1
local mask changes: 1426372.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1655024.0, 1426372.0, 1653478.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.288684
Client Index = 1	Epoch: 1	Loss: 0.211801
Client Index = 1	Epoch: 2	Loss: 0.108463
Client Index = 1	Epoch: 3	Loss: 0.108368
Client Index = 1	Epoch: 4	Loss: 0.444588
test acc on this client after 433 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 2
local mask changes: 1426856.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1652918.0, 1426856.0, 1652908.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.135326
Client Index = 2	Epoch: 1	Loss: 0.094990
Client Index = 2	Epoch: 2	Loss: 0.097817
Client Index = 2	Epoch: 3	Loss: 0.099572
Client Index = 2	Epoch: 4	Loss: 0.080807
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 3
local mask changes: 1426118.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1653406.0, 1426118.0, 1654762.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.294286
Client Index = 3	Epoch: 1	Loss: 0.255821
Client Index = 3	Epoch: 2	Loss: 0.165172
Client Index = 3	Epoch: 3	Loss: 0.122204
Client Index = 3	Epoch: 4	Loss: 0.093045
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 4
local mask changes: 1425568.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1658100.0, 1425568.0, 1657778.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.307820
Client Index = 4	Epoch: 1	Loss: 0.427458
Client Index = 4	Epoch: 2	Loss: 0.300972
Client Index = 4	Epoch: 3	Loss: 0.298292
Client Index = 4	Epoch: 4	Loss: 0.247629
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 5
local mask changes: 1426492.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1658656.0, 1426492.0, 1659022.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.461516
Client Index = 5	Epoch: 1	Loss: 0.303257
Client Index = 5	Epoch: 2	Loss: 0.465078
Client Index = 5	Epoch: 3	Loss: 0.311287
Client Index = 5	Epoch: 4	Loss: 0.308584
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 6
local mask changes: 1426826.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1659088.0, 1426826.0, 1660858.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.630720
Client Index = 6	Epoch: 1	Loss: 0.344262
Client Index = 6	Epoch: 2	Loss: 0.264319
Client Index = 6	Epoch: 3	Loss: 0.362616
Client Index = 6	Epoch: 4	Loss: 0.310341
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 7
local mask changes: 1426472.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1659764.0, 1426472.0, 1658106.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 7	Epoch: 0	Loss: 0.603844
Client Index = 7	Epoch: 1	Loss: 0.528508
Client Index = 7	Epoch: 2	Loss: 0.555558
Client Index = 7	Epoch: 3	Loss: 0.620861
Client Index = 7	Epoch: 4	Loss: 0.378090
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 8
local mask changes: 1426190.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1654910.0, 1426190.0, 1652660.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.143855
Client Index = 8	Epoch: 1	Loss: 0.114099
Client Index = 8	Epoch: 2	Loss: 0.235582
Client Index = 8	Epoch: 3	Loss: 0.055377
Client Index = 8	Epoch: 4	Loss: 0.042777
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 9
local mask changes: 1425792.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1656338.0, 1425792.0, 1657886.0]
Doing local aggregation!
test acc on this client before 364 / 506 : 0.72
Client Index = 9	Epoch: 0	Loss: 0.462789
Client Index = 9	Epoch: 1	Loss: 0.327036
Client Index = 9	Epoch: 2	Loss: 0.341844
Client Index = 9	Epoch: 3	Loss: 0.428857
Client Index = 9	Epoch: 4	Loss: 0.338699
test acc on this client after 367 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 10
local mask changes: 1426494.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1657680.0, 1426494.0, 1657230.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.474349
Client Index = 10	Epoch: 1	Loss: 0.438335
Client Index = 10	Epoch: 2	Loss: 0.518305
Client Index = 10	Epoch: 3	Loss: 0.351131
Client Index = 10	Epoch: 4	Loss: 0.307610
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 11
local mask changes: 1425934.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1656390.0, 1425934.0, 1656192.0]
Doing local aggregation!
test acc on this client before 388 / 505 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.338363
Client Index = 11	Epoch: 1	Loss: 0.239719
Client Index = 11	Epoch: 2	Loss: 0.154983
Client Index = 11	Epoch: 3	Loss: 0.111107
Client Index = 11	Epoch: 4	Loss: 0.091691
test acc on this client after 424 / 505 : 0.84
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 12
local mask changes: 1426220.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1657340.0, 1426220.0, 1657870.0]
Doing local aggregation!
test acc on this client before 324 / 504 : 0.64
Client Index = 12	Epoch: 0	Loss: 0.396724
Client Index = 12	Epoch: 1	Loss: 0.373117
Client Index = 12	Epoch: 2	Loss: 0.333299
Client Index = 12	Epoch: 3	Loss: 0.423729
Client Index = 12	Epoch: 4	Loss: 0.361973
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 13
local mask changes: 1427598.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1658914.0, 1427598.0, 1658802.0]
Doing local aggregation!
test acc on this client before 382 / 505 : 0.76
Client Index = 13	Epoch: 0	Loss: 0.317035
Client Index = 13	Epoch: 1	Loss: 0.313990
Client Index = 13	Epoch: 2	Loss: 0.251523
Client Index = 13	Epoch: 3	Loss: 0.320713
Client Index = 13	Epoch: 4	Loss: 0.167139
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 14
local mask changes: 1427172.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1658020.0, 1427172.0, 1656702.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.448003
Client Index = 14	Epoch: 1	Loss: 0.316799
Client Index = 14	Epoch: 2	Loss: 0.329501
Client Index = 14	Epoch: 3	Loss: 0.367761
Client Index = 14	Epoch: 4	Loss: 0.291061
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653334528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 15
local mask changes: 1426514.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1655892.0, 1426514.0, 1652890.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.361470
Client Index = 15	Epoch: 1	Loss: 0.273979
Client Index = 15	Epoch: 2	Loss: 0.194466
Client Index = 15	Epoch: 3	Loss: 0.356712
Client Index = 15	Epoch: 4	Loss: 0.306755
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653311744.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 16
local mask changes: 1426272.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1654274.0, 1426272.0, 1655716.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 16	Epoch: 0	Loss: 0.364588
Client Index = 16	Epoch: 1	Loss: 0.302221
Client Index = 16	Epoch: 2	Loss: 0.263911
Client Index = 16	Epoch: 3	Loss: 0.300627
Client Index = 16	Epoch: 4	Loss: 0.214108
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 17
local mask changes: 1427330.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1656528.0, 1427330.0, 1658230.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.541521
Client Index = 17	Epoch: 1	Loss: 0.413731
Client Index = 17	Epoch: 2	Loss: 0.399605
Client Index = 17	Epoch: 3	Loss: 0.377422
Client Index = 17	Epoch: 4	Loss: 0.339901
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 18
local mask changes: 1426598.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1655856.0, 1426598.0, 1656008.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.316529
Client Index = 18	Epoch: 1	Loss: 0.205092
Client Index = 18	Epoch: 2	Loss: 0.357840
Client Index = 18	Epoch: 3	Loss: 0.167960
Client Index = 18	Epoch: 4	Loss: 0.186564
test acc on this client after 302 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 19
local mask changes: 1426322.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1657604.0, 1654922.0, 1426322.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.346597
Client Index = 19	Epoch: 1	Loss: 0.260902
Client Index = 19	Epoch: 2	Loss: 0.448461
Client Index = 19	Epoch: 3	Loss: 0.223573
Client Index = 19	Epoch: 4	Loss: 0.227437
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.30399929325096314}
################local_test_on_all_clients after local training in communication round: 58
{'test_acc_after': 0.7478969221166094, 'test_loss_after': 0.8805558441867773}
################local_test_on_all_clients before local training in communication round: 58
{'test_acc_before': 0.7545689764773743, 'test_loss_before': 0.8200868649856654}
################Communication round : 59
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 0
local mask changes: 1378748.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1378748.0, 1616922.0, 1617694.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.423924
Client Index = 0	Epoch: 1	Loss: 0.473692
Client Index = 0	Epoch: 2	Loss: 0.282549
Client Index = 0	Epoch: 3	Loss: 0.267192
Client Index = 0	Epoch: 4	Loss: 0.179364
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 1
local mask changes: 1379946.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1616820.0, 1379946.0, 1614550.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.245771
Client Index = 1	Epoch: 1	Loss: 0.182838
Client Index = 1	Epoch: 2	Loss: 0.131869
Client Index = 1	Epoch: 3	Loss: 0.101208
Client Index = 1	Epoch: 4	Loss: 0.136453
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 2
local mask changes: 1379758.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1614202.0, 1379758.0, 1612758.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.116426
Client Index = 2	Epoch: 1	Loss: 0.088858
Client Index = 2	Epoch: 2	Loss: 0.166455
Client Index = 2	Epoch: 3	Loss: 0.113292
Client Index = 2	Epoch: 4	Loss: 0.062720
test acc on this client after 437 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 3
local mask changes: 1378740.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1613220.0, 1378740.0, 1617210.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.240013
Client Index = 3	Epoch: 1	Loss: 0.219943
Client Index = 3	Epoch: 2	Loss: 0.145543
Client Index = 3	Epoch: 3	Loss: 0.217769
Client Index = 3	Epoch: 4	Loss: 0.403209
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 4
local mask changes: 1380210.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1619330.0, 1380210.0, 1620294.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.471965
Client Index = 4	Epoch: 1	Loss: 0.222368
Client Index = 4	Epoch: 2	Loss: 0.423215
Client Index = 4	Epoch: 3	Loss: 0.236756
Client Index = 4	Epoch: 4	Loss: 0.209195
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 5
local mask changes: 1379498.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1620200.0, 1379498.0, 1621142.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.546796
Client Index = 5	Epoch: 1	Loss: 0.337879
Client Index = 5	Epoch: 2	Loss: 0.312074
Client Index = 5	Epoch: 3	Loss: 0.282591
Client Index = 5	Epoch: 4	Loss: 0.248113
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 6
local mask changes: 1378252.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1621874.0, 1378252.0, 1620434.0]
Doing local aggregation!
test acc on this client before 337 / 505 : 0.67
Client Index = 6	Epoch: 0	Loss: 0.434975
Client Index = 6	Epoch: 1	Loss: 0.407648
Client Index = 6	Epoch: 2	Loss: 0.265423
Client Index = 6	Epoch: 3	Loss: 0.404340
Client Index = 6	Epoch: 4	Loss: 0.321687
test acc on this client after 354 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 7
local mask changes: 1379570.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1619916.0, 1379570.0, 1620252.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.572682
Client Index = 7	Epoch: 1	Loss: 0.425527
Client Index = 7	Epoch: 2	Loss: 0.645213
Client Index = 7	Epoch: 3	Loss: 0.409432
Client Index = 7	Epoch: 4	Loss: 0.403239
test acc on this client after 322 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 8
local mask changes: 1379848.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1615152.0, 1379848.0, 1613670.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.361491
Client Index = 8	Epoch: 1	Loss: 0.106134
Client Index = 8	Epoch: 2	Loss: 0.074215
Client Index = 8	Epoch: 3	Loss: 0.063432
Client Index = 8	Epoch: 4	Loss: 0.037269
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 9
local mask changes: 1378308.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1616450.0, 1378308.0, 1618964.0]
Doing local aggregation!
test acc on this client before 360 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.415273
Client Index = 9	Epoch: 1	Loss: 0.313387
Client Index = 9	Epoch: 2	Loss: 0.396502
Client Index = 9	Epoch: 3	Loss: 0.314957
Client Index = 9	Epoch: 4	Loss: 0.361010
test acc on this client after 346 / 506 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 10
local mask changes: 1379972.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1618702.0, 1379972.0, 1618824.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.427505
Client Index = 10	Epoch: 1	Loss: 0.407596
Client Index = 10	Epoch: 2	Loss: 0.255996
Client Index = 10	Epoch: 3	Loss: 0.365808
Client Index = 10	Epoch: 4	Loss: 0.299149
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 11
local mask changes: 1379906.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1616922.0, 1379906.0, 1614760.0]
Doing local aggregation!
test acc on this client before 384 / 505 : 0.76
Client Index = 11	Epoch: 0	Loss: 0.177946
Client Index = 11	Epoch: 1	Loss: 0.353507
Client Index = 11	Epoch: 2	Loss: 0.170700
Client Index = 11	Epoch: 3	Loss: 0.131128
Client Index = 11	Epoch: 4	Loss: 0.460341
test acc on this client after 420 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 12
local mask changes: 1380338.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1619398.0, 1380338.0, 1618482.0]
Doing local aggregation!
test acc on this client before 344 / 504 : 0.68
Client Index = 12	Epoch: 0	Loss: 0.351181
Client Index = 12	Epoch: 1	Loss: 0.404509
Client Index = 12	Epoch: 2	Loss: 0.249221
Client Index = 12	Epoch: 3	Loss: 0.319508
Client Index = 12	Epoch: 4	Loss: 0.329937
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 13
local mask changes: 1379620.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1618848.0, 1379620.0, 1619836.0]
Doing local aggregation!
test acc on this client before 381 / 505 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.408302
Client Index = 13	Epoch: 1	Loss: 0.259772
Client Index = 13	Epoch: 2	Loss: 0.189752
Client Index = 13	Epoch: 3	Loss: 0.223216
Client Index = 13	Epoch: 4	Loss: 0.158215
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653337856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 14
local mask changes: 1379196.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1620272.0, 1379196.0, 1617984.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 14	Epoch: 0	Loss: 0.391060
Client Index = 14	Epoch: 1	Loss: 0.384414
Client Index = 14	Epoch: 2	Loss: 0.316504
Client Index = 14	Epoch: 3	Loss: 0.228375
Client Index = 14	Epoch: 4	Loss: 0.180734
test acc on this client after 315 / 503 : 0.63
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 15
local mask changes: 1378516.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1616848.0, 1378516.0, 1616932.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.472054
Client Index = 15	Epoch: 1	Loss: 0.254925
Client Index = 15	Epoch: 2	Loss: 0.312969
Client Index = 15	Epoch: 3	Loss: 0.192346
Client Index = 15	Epoch: 4	Loss: 0.217587
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653316096.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 16
local mask changes: 1379564.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1614628.0, 1379564.0, 1615478.0]
Doing local aggregation!
test acc on this client before 362 / 504 : 0.72
Client Index = 16	Epoch: 0	Loss: 0.564723
Client Index = 16	Epoch: 1	Loss: 0.233952
Client Index = 16	Epoch: 2	Loss: 0.188406
Client Index = 16	Epoch: 3	Loss: 0.281613
Client Index = 16	Epoch: 4	Loss: 0.250447
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 17
local mask changes: 1379236.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1618462.0, 1379236.0, 1620396.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.495177
Client Index = 17	Epoch: 1	Loss: 0.394843
Client Index = 17	Epoch: 2	Loss: 0.454635
Client Index = 17	Epoch: 3	Loss: 0.338880
Client Index = 17	Epoch: 4	Loss: 0.369499
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653322496.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 18
local mask changes: 1379436.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1618438.0, 1379436.0, 1616330.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 18	Epoch: 0	Loss: 0.447655
Client Index = 18	Epoch: 1	Loss: 0.367031
Client Index = 18	Epoch: 2	Loss: 0.178157
Client Index = 18	Epoch: 3	Loss: 0.337481
Client Index = 18	Epoch: 4	Loss: 0.176106
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 19
local mask changes: 1380292.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1618458.0, 1616116.0, 1380292.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.598396
Client Index = 19	Epoch: 1	Loss: 0.271714
Client Index = 19	Epoch: 2	Loss: 0.270852
Client Index = 19	Epoch: 3	Loss: 0.240331
Client Index = 19	Epoch: 4	Loss: 0.226399
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2980442883041687}
################local_test_on_all_clients after local training in communication round: 59
{'test_acc_after': 0.7510945332629531, 'test_loss_after': 0.8804642053441407}
################local_test_on_all_clients before local training in communication round: 59
{'test_acc_before': 0.745340582128487, 'test_loss_before': 0.845499008844279}
################Communication round : 60
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 0
local mask changes: 1332696.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1332696.0, 1578176.0, 1578800.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 0	Epoch: 0	Loss: 0.469132
Client Index = 0	Epoch: 1	Loss: 0.358203
Client Index = 0	Epoch: 2	Loss: 0.295124
Client Index = 0	Epoch: 3	Loss: 0.260634
Client Index = 0	Epoch: 4	Loss: 0.159556
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 1
local mask changes: 1332288.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1576354.0, 1332288.0, 1574280.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.294740
Client Index = 1	Epoch: 1	Loss: 0.328045
Client Index = 1	Epoch: 2	Loss: 0.133481
Client Index = 1	Epoch: 3	Loss: 0.128851
Client Index = 1	Epoch: 4	Loss: 0.129117
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 2
local mask changes: 1331284.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1574112.0, 1331284.0, 1572750.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.096716
Client Index = 2	Epoch: 1	Loss: 0.086796
Client Index = 2	Epoch: 2	Loss: 0.136521
Client Index = 2	Epoch: 3	Loss: 0.051141
Client Index = 2	Epoch: 4	Loss: 0.078351
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 3
local mask changes: 1332000.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1575628.0, 1332000.0, 1578980.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.180878
Client Index = 3	Epoch: 1	Loss: 0.184233
Client Index = 3	Epoch: 2	Loss: 0.185374
Client Index = 3	Epoch: 3	Loss: 0.295205
Client Index = 3	Epoch: 4	Loss: 0.155784
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 4
local mask changes: 1332438.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1579272.0, 1332438.0, 1580758.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.417304
Client Index = 4	Epoch: 1	Loss: 0.348503
Client Index = 4	Epoch: 2	Loss: 0.271243
Client Index = 4	Epoch: 3	Loss: 0.240511
Client Index = 4	Epoch: 4	Loss: 0.267483
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 5
local mask changes: 1332502.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1581156.0, 1332502.0, 1582158.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 5	Epoch: 0	Loss: 0.399764
Client Index = 5	Epoch: 1	Loss: 0.341262
Client Index = 5	Epoch: 2	Loss: 0.322391
Client Index = 5	Epoch: 3	Loss: 0.471591
Client Index = 5	Epoch: 4	Loss: 0.274384
test acc on this client after 333 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 6
local mask changes: 1332064.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1582112.0, 1332064.0, 1581718.0]
Doing local aggregation!
test acc on this client before 357 / 505 : 0.71
Client Index = 6	Epoch: 0	Loss: 0.481346
Client Index = 6	Epoch: 1	Loss: 0.268319
Client Index = 6	Epoch: 2	Loss: 0.273799
Client Index = 6	Epoch: 3	Loss: 0.308649
Client Index = 6	Epoch: 4	Loss: 0.589973
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 7
local mask changes: 1332690.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1581684.0, 1332690.0, 1580304.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 7	Epoch: 0	Loss: 0.539003
Client Index = 7	Epoch: 1	Loss: 0.443057
Client Index = 7	Epoch: 2	Loss: 0.448320
Client Index = 7	Epoch: 3	Loss: 0.427541
Client Index = 7	Epoch: 4	Loss: 0.657443
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 8
local mask changes: 1332426.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1577450.0, 1332426.0, 1575208.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.326132
Client Index = 8	Epoch: 1	Loss: 0.124216
Client Index = 8	Epoch: 2	Loss: 0.062225
Client Index = 8	Epoch: 3	Loss: 0.061201
Client Index = 8	Epoch: 4	Loss: 0.054983
test acc on this client after 472 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 9
local mask changes: 1333404.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1577248.0, 1333404.0, 1580428.0]
Doing local aggregation!
test acc on this client before 367 / 506 : 0.73
Client Index = 9	Epoch: 0	Loss: 0.369470
Client Index = 9	Epoch: 1	Loss: 0.279810
Client Index = 9	Epoch: 2	Loss: 0.232244
Client Index = 9	Epoch: 3	Loss: 0.368338
Client Index = 9	Epoch: 4	Loss: 0.225814
test acc on this client after 386 / 506 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 10
local mask changes: 1332154.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1581812.0, 1332154.0, 1579980.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.409585
Client Index = 10	Epoch: 1	Loss: 0.328905
Client Index = 10	Epoch: 2	Loss: 0.389651
Client Index = 10	Epoch: 3	Loss: 0.278992
Client Index = 10	Epoch: 4	Loss: 0.412527
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 11
local mask changes: 1332144.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1578926.0, 1332144.0, 1580448.0]
Doing local aggregation!
test acc on this client before 390 / 505 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.243368
Client Index = 11	Epoch: 1	Loss: 0.184790
Client Index = 11	Epoch: 2	Loss: 0.362519
Client Index = 11	Epoch: 3	Loss: 0.154840
Client Index = 11	Epoch: 4	Loss: 0.106717
test acc on this client after 426 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 12
local mask changes: 1333004.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1581652.0, 1333004.0, 1581770.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.340623
Client Index = 12	Epoch: 1	Loss: 0.361441
Client Index = 12	Epoch: 2	Loss: 0.275397
Client Index = 12	Epoch: 3	Loss: 0.310576
Client Index = 12	Epoch: 4	Loss: 0.254942
test acc on this client after 353 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 13
local mask changes: 1332534.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1581090.0, 1332534.0, 1581088.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.342076
Client Index = 13	Epoch: 1	Loss: 0.280746
Client Index = 13	Epoch: 2	Loss: 0.216289
Client Index = 13	Epoch: 3	Loss: 0.214066
Client Index = 13	Epoch: 4	Loss: 0.286143
test acc on this client after 353 / 505 : 0.70
-----------------------------------
training flops per data 2653324288.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 14
local mask changes: 1333010.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1581228.0, 1333010.0, 1578662.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.426538
Client Index = 14	Epoch: 1	Loss: 0.308042
Client Index = 14	Epoch: 2	Loss: 0.378281
Client Index = 14	Epoch: 3	Loss: 0.249768
Client Index = 14	Epoch: 4	Loss: 0.217717
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653335552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 15
local mask changes: 1332316.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1576908.0, 1332316.0, 1576704.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.359750
Client Index = 15	Epoch: 1	Loss: 0.264966
Client Index = 15	Epoch: 2	Loss: 0.230670
Client Index = 15	Epoch: 3	Loss: 0.304256
Client Index = 15	Epoch: 4	Loss: 0.177968
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653323264.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 16
local mask changes: 1332306.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1576108.0, 1332306.0, 1578024.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 16	Epoch: 0	Loss: 0.417681
Client Index = 16	Epoch: 1	Loss: 0.343658
Client Index = 16	Epoch: 2	Loss: 0.231748
Client Index = 16	Epoch: 3	Loss: 0.263499
Client Index = 16	Epoch: 4	Loss: 0.162542
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 17
local mask changes: 1332382.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1578962.0, 1332382.0, 1580306.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 17	Epoch: 0	Loss: 0.544620
Client Index = 17	Epoch: 1	Loss: 0.371548
Client Index = 17	Epoch: 2	Loss: 0.408636
Client Index = 17	Epoch: 3	Loss: 0.366665
Client Index = 17	Epoch: 4	Loss: 0.346623
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 18
local mask changes: 1332756.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1580178.0, 1332756.0, 1577038.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.367564
Client Index = 18	Epoch: 1	Loss: 0.247795
Client Index = 18	Epoch: 2	Loss: 0.275323
Client Index = 18	Epoch: 3	Loss: 0.172240
Client Index = 18	Epoch: 4	Loss: 0.119716
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 19
local mask changes: 1332498.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1579986.0, 1577838.0, 1332498.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.324831
Client Index = 19	Epoch: 1	Loss: 0.311553
Client Index = 19	Epoch: 2	Loss: 0.452903
Client Index = 19	Epoch: 3	Loss: 0.224650
Client Index = 19	Epoch: 4	Loss: 0.267573
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2879771592724137}
################local_test_on_all_clients after local training in communication round: 60
{'test_acc_after': 0.7627797002453786, 'test_loss_after': 0.8346056885703783}
################local_test_on_all_clients before local training in communication round: 60
{'test_acc_before': 0.7656872128256007, 'test_loss_before': 0.7767266622215105}
################Communication round : 61
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 0
local mask changes: 1285254.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1285254.0, 1539426.0, 1540474.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.473220
Client Index = 0	Epoch: 1	Loss: 0.423394
Client Index = 0	Epoch: 2	Loss: 0.220751
Client Index = 0	Epoch: 3	Loss: 0.200945
Client Index = 0	Epoch: 4	Loss: 0.200556
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 1
local mask changes: 1285446.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1536898.0, 1285446.0, 1534642.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.428670
Client Index = 1	Epoch: 1	Loss: 0.171562
Client Index = 1	Epoch: 2	Loss: 0.163513
Client Index = 1	Epoch: 3	Loss: 0.234383
Client Index = 1	Epoch: 4	Loss: 0.090104
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 2
local mask changes: 1285456.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1533932.0, 1285456.0, 1535320.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.137586
Client Index = 2	Epoch: 1	Loss: 0.060158
Client Index = 2	Epoch: 2	Loss: 0.069744
Client Index = 2	Epoch: 3	Loss: 0.076651
Client Index = 2	Epoch: 4	Loss: 0.050441
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 3
local mask changes: 1285508.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1537852.0, 1285508.0, 1540814.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.166252
Client Index = 3	Epoch: 1	Loss: 0.276063
Client Index = 3	Epoch: 2	Loss: 0.330251
Client Index = 3	Epoch: 3	Loss: 0.127361
Client Index = 3	Epoch: 4	Loss: 0.131445
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 4
local mask changes: 1284506.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1542260.0, 1284506.0, 1542008.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.424622
Client Index = 4	Epoch: 1	Loss: 0.350159
Client Index = 4	Epoch: 2	Loss: 0.232547
Client Index = 4	Epoch: 3	Loss: 0.331713
Client Index = 4	Epoch: 4	Loss: 0.236063
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 5
local mask changes: 1286480.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1542560.0, 1286480.0, 1542492.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.390561
Client Index = 5	Epoch: 1	Loss: 0.326753
Client Index = 5	Epoch: 2	Loss: 0.258592
Client Index = 5	Epoch: 3	Loss: 0.347720
Client Index = 5	Epoch: 4	Loss: 0.395247
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 6
local mask changes: 1285706.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1545210.0, 1285706.0, 1545452.0]
Doing local aggregation!
test acc on this client before 378 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.390254
Client Index = 6	Epoch: 1	Loss: 0.290292
Client Index = 6	Epoch: 2	Loss: 0.332714
Client Index = 6	Epoch: 3	Loss: 0.398899
Client Index = 6	Epoch: 4	Loss: 0.276393
test acc on this client after 351 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 7
local mask changes: 1284946.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1544490.0, 1284946.0, 1541772.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 7	Epoch: 0	Loss: 0.482107
Client Index = 7	Epoch: 1	Loss: 0.501465
Client Index = 7	Epoch: 2	Loss: 0.481861
Client Index = 7	Epoch: 3	Loss: 0.340127
Client Index = 7	Epoch: 4	Loss: 0.492933
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 8
local mask changes: 1286068.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1537740.0, 1286068.0, 1535674.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.120896
Client Index = 8	Epoch: 1	Loss: 0.244365
Client Index = 8	Epoch: 2	Loss: 0.061011
Client Index = 8	Epoch: 3	Loss: 0.038583
Client Index = 8	Epoch: 4	Loss: 0.039348
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 9
local mask changes: 1285626.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1538506.0, 1285626.0, 1542406.0]
Doing local aggregation!
test acc on this client before 378 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.327156
Client Index = 9	Epoch: 1	Loss: 0.499748
Client Index = 9	Epoch: 2	Loss: 0.279213
Client Index = 9	Epoch: 3	Loss: 0.251318
Client Index = 9	Epoch: 4	Loss: 0.321347
test acc on this client after 343 / 506 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 10
local mask changes: 1285300.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1543560.0, 1285300.0, 1542304.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.424197
Client Index = 10	Epoch: 1	Loss: 0.401724
Client Index = 10	Epoch: 2	Loss: 0.320446
Client Index = 10	Epoch: 3	Loss: 0.334809
Client Index = 10	Epoch: 4	Loss: 0.255511
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 11
local mask changes: 1285316.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1541094.0, 1285316.0, 1540480.0]
Doing local aggregation!
test acc on this client before 400 / 505 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.172394
Client Index = 11	Epoch: 1	Loss: 0.103406
Client Index = 11	Epoch: 2	Loss: 0.128252
Client Index = 11	Epoch: 3	Loss: 0.098029
Client Index = 11	Epoch: 4	Loss: 0.116445
test acc on this client after 431 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 12
local mask changes: 1285924.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1542710.0, 1285924.0, 1542258.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 12	Epoch: 0	Loss: 0.402888
Client Index = 12	Epoch: 1	Loss: 0.311636
Client Index = 12	Epoch: 2	Loss: 0.262054
Client Index = 12	Epoch: 3	Loss: 0.227021
Client Index = 12	Epoch: 4	Loss: 0.286385
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 13
local mask changes: 1284392.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1541980.0, 1284392.0, 1543318.0]
Doing local aggregation!
test acc on this client before 404 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.198744
Client Index = 13	Epoch: 1	Loss: 0.469863
Client Index = 13	Epoch: 2	Loss: 0.204875
Client Index = 13	Epoch: 3	Loss: 0.218471
Client Index = 13	Epoch: 4	Loss: 0.213325
test acc on this client after 361 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 14
local mask changes: 1285246.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1539778.0, 1285246.0, 1539256.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 14	Epoch: 0	Loss: 0.324083
Client Index = 14	Epoch: 1	Loss: 0.429258
Client Index = 14	Epoch: 2	Loss: 0.390327
Client Index = 14	Epoch: 3	Loss: 0.203997
Client Index = 14	Epoch: 4	Loss: 0.190124
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653334016.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 15
local mask changes: 1285550.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1538194.0, 1285550.0, 1537200.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.442910
Client Index = 15	Epoch: 1	Loss: 0.215908
Client Index = 15	Epoch: 2	Loss: 0.268099
Client Index = 15	Epoch: 3	Loss: 0.160649
Client Index = 15	Epoch: 4	Loss: 0.366479
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 16
local mask changes: 1285762.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1537324.0, 1285762.0, 1539342.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.331869
Client Index = 16	Epoch: 1	Loss: 0.352869
Client Index = 16	Epoch: 2	Loss: 0.348271
Client Index = 16	Epoch: 3	Loss: 0.230204
Client Index = 16	Epoch: 4	Loss: 0.151762
test acc on this client after 284 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 17
local mask changes: 1284914.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1540442.0, 1284914.0, 1541400.0]
Doing local aggregation!
test acc on this client before 340 / 503 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.558361
Client Index = 17	Epoch: 1	Loss: 0.313400
Client Index = 17	Epoch: 2	Loss: 0.386676
Client Index = 17	Epoch: 3	Loss: 0.394202
Client Index = 17	Epoch: 4	Loss: 0.277787
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 18
local mask changes: 1286422.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1539874.0, 1286422.0, 1539392.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.363932
Client Index = 18	Epoch: 1	Loss: 0.326260
Client Index = 18	Epoch: 2	Loss: 0.214685
Client Index = 18	Epoch: 3	Loss: 0.215067
Client Index = 18	Epoch: 4	Loss: 0.179543
test acc on this client after 302 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 19
local mask changes: 1284246.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1540862.0, 1537874.0, 1284246.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.464662
Client Index = 19	Epoch: 1	Loss: 0.272170
Client Index = 19	Epoch: 2	Loss: 0.295171
Client Index = 19	Epoch: 3	Loss: 0.186022
Client Index = 19	Epoch: 4	Loss: 0.415101
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.27917378949560223}
################local_test_on_all_clients after local training in communication round: 61
{'test_acc_after': 0.7471266831405119, 'test_loss_after': 0.9589053054399879}
################local_test_on_all_clients before local training in communication round: 61
{'test_acc_before': 0.7715280072346787, 'test_loss_before': 0.7634121853189693}
################Communication round : 62
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 0
local mask changes: 1238048.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1238048.0, 1501284.0, 1500744.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.466423
Client Index = 0	Epoch: 1	Loss: 0.226842
Client Index = 0	Epoch: 2	Loss: 0.426358
Client Index = 0	Epoch: 3	Loss: 0.212052
Client Index = 0	Epoch: 4	Loss: 0.258256
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 1
local mask changes: 1237796.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1498980.0, 1237796.0, 1495348.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.223134
Client Index = 1	Epoch: 1	Loss: 0.339560
Client Index = 1	Epoch: 2	Loss: 0.112521
Client Index = 1	Epoch: 3	Loss: 0.149079
Client Index = 1	Epoch: 4	Loss: 0.102097
test acc on this client after 421 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 2
local mask changes: 1238674.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1492626.0, 1238674.0, 1496378.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.157225
Client Index = 2	Epoch: 1	Loss: 0.114328
Client Index = 2	Epoch: 2	Loss: 0.069928
Client Index = 2	Epoch: 3	Loss: 0.060563
Client Index = 2	Epoch: 4	Loss: 0.305113
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 3
local mask changes: 1238894.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1498422.0, 1238894.0, 1500924.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.168099
Client Index = 3	Epoch: 1	Loss: 0.205615
Client Index = 3	Epoch: 2	Loss: 0.129323
Client Index = 3	Epoch: 3	Loss: 0.158240
Client Index = 3	Epoch: 4	Loss: 0.159554
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 4
local mask changes: 1237484.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1502926.0, 1237484.0, 1503750.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.286684
Client Index = 4	Epoch: 1	Loss: 0.221551
Client Index = 4	Epoch: 2	Loss: 0.465708
Client Index = 4	Epoch: 3	Loss: 0.179059
Client Index = 4	Epoch: 4	Loss: 0.167485
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 5
local mask changes: 1238658.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1504028.0, 1238658.0, 1506932.0]
Doing local aggregation!
test acc on this client before 364 / 503 : 0.72
Client Index = 5	Epoch: 0	Loss: 0.373609
Client Index = 5	Epoch: 1	Loss: 0.235806
Client Index = 5	Epoch: 2	Loss: 0.250059
Client Index = 5	Epoch: 3	Loss: 0.339716
Client Index = 5	Epoch: 4	Loss: 0.273789
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 6
local mask changes: 1239162.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1506868.0, 1239162.0, 1506060.0]
Doing local aggregation!
test acc on this client before 354 / 505 : 0.70
Client Index = 6	Epoch: 0	Loss: 0.470064
Client Index = 6	Epoch: 1	Loss: 0.304029
Client Index = 6	Epoch: 2	Loss: 0.359834
Client Index = 6	Epoch: 3	Loss: 0.366325
Client Index = 6	Epoch: 4	Loss: 0.203642
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 7
local mask changes: 1238150.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1507140.0, 1238150.0, 1503244.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 7	Epoch: 0	Loss: 0.515125
Client Index = 7	Epoch: 1	Loss: 0.519043
Client Index = 7	Epoch: 2	Loss: 0.459915
Client Index = 7	Epoch: 3	Loss: 0.461379
Client Index = 7	Epoch: 4	Loss: 0.385857
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 8
local mask changes: 1237620.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1498424.0, 1237620.0, 1496176.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.162983
Client Index = 8	Epoch: 1	Loss: 0.065897
Client Index = 8	Epoch: 2	Loss: 0.059254
Client Index = 8	Epoch: 3	Loss: 0.045905
Client Index = 8	Epoch: 4	Loss: 0.034558
test acc on this client after 461 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 9
local mask changes: 1237756.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1498970.0, 1237756.0, 1503574.0]
Doing local aggregation!
test acc on this client before 349 / 506 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.416831
Client Index = 9	Epoch: 1	Loss: 0.291683
Client Index = 9	Epoch: 2	Loss: 0.421741
Client Index = 9	Epoch: 3	Loss: 0.234288
Client Index = 9	Epoch: 4	Loss: 0.245228
test acc on this client after 372 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 10
local mask changes: 1239060.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1504112.0, 1239060.0, 1502358.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.442234
Client Index = 10	Epoch: 1	Loss: 0.296650
Client Index = 10	Epoch: 2	Loss: 0.299152
Client Index = 10	Epoch: 3	Loss: 0.361087
Client Index = 10	Epoch: 4	Loss: 0.295881
test acc on this client after 343 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 11
local mask changes: 1237996.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1501052.0, 1237996.0, 1500008.0]
Doing local aggregation!
test acc on this client before 395 / 505 : 0.78
Client Index = 11	Epoch: 0	Loss: 0.320928
Client Index = 11	Epoch: 1	Loss: 0.142726
Client Index = 11	Epoch: 2	Loss: 0.099735
Client Index = 11	Epoch: 3	Loss: 0.083990
Client Index = 11	Epoch: 4	Loss: 0.332478
test acc on this client after 435 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 12
local mask changes: 1238460.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1501466.0, 1238460.0, 1503174.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.400572
Client Index = 12	Epoch: 1	Loss: 0.337638
Client Index = 12	Epoch: 2	Loss: 0.331511
Client Index = 12	Epoch: 3	Loss: 0.201227
Client Index = 12	Epoch: 4	Loss: 0.249136
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 13
local mask changes: 1237790.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1503014.0, 1237790.0, 1503198.0]
Doing local aggregation!
test acc on this client before 395 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.458628
Client Index = 13	Epoch: 1	Loss: 0.212067
Client Index = 13	Epoch: 2	Loss: 0.152124
Client Index = 13	Epoch: 3	Loss: 0.151087
Client Index = 13	Epoch: 4	Loss: 0.328859
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653336064.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 14
local mask changes: 1238258.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1502244.0, 1238258.0, 1500606.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.333621
Client Index = 14	Epoch: 1	Loss: 0.347480
Client Index = 14	Epoch: 2	Loss: 0.310531
Client Index = 14	Epoch: 3	Loss: 0.206424
Client Index = 14	Epoch: 4	Loss: 0.348970
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 15
local mask changes: 1236998.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1498948.0, 1236998.0, 1498524.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.311294
Client Index = 15	Epoch: 1	Loss: 0.211473
Client Index = 15	Epoch: 2	Loss: 0.350917
Client Index = 15	Epoch: 3	Loss: 0.255543
Client Index = 15	Epoch: 4	Loss: 0.151265
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653323264.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 16
local mask changes: 1237630.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1497872.0, 1237630.0, 1501126.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.278470
Client Index = 16	Epoch: 1	Loss: 0.257636
Client Index = 16	Epoch: 2	Loss: 0.397265
Client Index = 16	Epoch: 3	Loss: 0.241943
Client Index = 16	Epoch: 4	Loss: 0.196458
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 17
local mask changes: 1238458.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1501888.0, 1238458.0, 1502092.0]
Doing local aggregation!
test acc on this client before 323 / 503 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.554125
Client Index = 17	Epoch: 1	Loss: 0.466391
Client Index = 17	Epoch: 2	Loss: 0.315852
Client Index = 17	Epoch: 3	Loss: 0.312381
Client Index = 17	Epoch: 4	Loss: 0.349820
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 18
local mask changes: 1237780.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1502746.0, 1237780.0, 1501278.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.339122
Client Index = 18	Epoch: 1	Loss: 0.226010
Client Index = 18	Epoch: 2	Loss: 0.262054
Client Index = 18	Epoch: 3	Loss: 0.195226
Client Index = 18	Epoch: 4	Loss: 0.392401
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 19
local mask changes: 1238988.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1502308.0, 1500462.0, 1238988.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.257146
Client Index = 19	Epoch: 1	Loss: 0.356218
Client Index = 19	Epoch: 2	Loss: 0.213909
Client Index = 19	Epoch: 3	Loss: 0.491992
Client Index = 19	Epoch: 4	Loss: 0.186614
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2747761873663403}
################local_test_on_all_clients after local training in communication round: 62
{'test_acc_after': 0.7659728344489612, 'test_loss_after': 0.8436679960640749}
################local_test_on_all_clients before local training in communication round: 62
{'test_acc_before': 0.763315280742724, 'test_loss_before': 0.8056120361195516}
################Communication round : 63
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 0
local mask changes: 1190652.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1190652.0, 1462478.0, 1462476.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.509832
Client Index = 0	Epoch: 1	Loss: 0.239005
Client Index = 0	Epoch: 2	Loss: 0.224867
Client Index = 0	Epoch: 3	Loss: 0.255063
Client Index = 0	Epoch: 4	Loss: 0.190948
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 1
local mask changes: 1190916.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1459712.0, 1190916.0, 1455140.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.244916
Client Index = 1	Epoch: 1	Loss: 0.129949
Client Index = 1	Epoch: 2	Loss: 0.168999
Client Index = 1	Epoch: 3	Loss: 0.204059
Client Index = 1	Epoch: 4	Loss: 0.087995
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 2
local mask changes: 1190592.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1456302.0, 1190592.0, 1458430.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.117426
Client Index = 2	Epoch: 1	Loss: 0.063972
Client Index = 2	Epoch: 2	Loss: 0.253463
Client Index = 2	Epoch: 3	Loss: 0.079733
Client Index = 2	Epoch: 4	Loss: 0.047268
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 3
local mask changes: 1190438.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1458082.0, 1190438.0, 1462088.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.203746
Client Index = 3	Epoch: 1	Loss: 0.205358
Client Index = 3	Epoch: 2	Loss: 0.146921
Client Index = 3	Epoch: 3	Loss: 0.081545
Client Index = 3	Epoch: 4	Loss: 0.087640
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 4
local mask changes: 1191308.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1463566.0, 1191308.0, 1464048.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.479115
Client Index = 4	Epoch: 1	Loss: 0.226243
Client Index = 4	Epoch: 2	Loss: 0.176548
Client Index = 4	Epoch: 3	Loss: 0.366391
Client Index = 4	Epoch: 4	Loss: 0.178408
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 5
local mask changes: 1190798.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1465666.0, 1190798.0, 1467002.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.359408
Client Index = 5	Epoch: 1	Loss: 0.397549
Client Index = 5	Epoch: 2	Loss: 0.230663
Client Index = 5	Epoch: 3	Loss: 0.337152
Client Index = 5	Epoch: 4	Loss: 0.242164
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 6
local mask changes: 1191370.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1468210.0, 1191370.0, 1469630.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.373721
Client Index = 6	Epoch: 1	Loss: 0.329539
Client Index = 6	Epoch: 2	Loss: 0.354750
Client Index = 6	Epoch: 3	Loss: 0.234395
Client Index = 6	Epoch: 4	Loss: 0.224704
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 7
local mask changes: 1190406.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1467998.0, 1190406.0, 1466086.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 7	Epoch: 0	Loss: 0.435449
Client Index = 7	Epoch: 1	Loss: 0.543615
Client Index = 7	Epoch: 2	Loss: 0.478393
Client Index = 7	Epoch: 3	Loss: 0.417383
Client Index = 7	Epoch: 4	Loss: 0.319778
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 8
local mask changes: 1191692.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1459324.0, 1191692.0, 1456692.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.224343
Client Index = 8	Epoch: 1	Loss: 0.250120
Client Index = 8	Epoch: 2	Loss: 0.066184
Client Index = 8	Epoch: 3	Loss: 0.056698
Client Index = 8	Epoch: 4	Loss: 0.035166
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 9
local mask changes: 1190444.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1460188.0, 1190444.0, 1464770.0]
Doing local aggregation!
test acc on this client before 370 / 506 : 0.73
Client Index = 9	Epoch: 0	Loss: 0.452881
Client Index = 9	Epoch: 1	Loss: 0.289344
Client Index = 9	Epoch: 2	Loss: 0.324231
Client Index = 9	Epoch: 3	Loss: 0.189271
Client Index = 9	Epoch: 4	Loss: 0.219719
test acc on this client after 288 / 506 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 10
local mask changes: 1190556.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1466656.0, 1190556.0, 1462776.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.341632
Client Index = 10	Epoch: 1	Loss: 0.392796
Client Index = 10	Epoch: 2	Loss: 0.359347
Client Index = 10	Epoch: 3	Loss: 0.282404
Client Index = 10	Epoch: 4	Loss: 0.256200
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 11
local mask changes: 1190914.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1461914.0, 1190914.0, 1461278.0]
Doing local aggregation!
test acc on this client before 398 / 505 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.185249
Client Index = 11	Epoch: 1	Loss: 0.217519
Client Index = 11	Epoch: 2	Loss: 0.109713
Client Index = 11	Epoch: 3	Loss: 0.083881
Client Index = 11	Epoch: 4	Loss: 0.077514
test acc on this client after 431 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 12
local mask changes: 1190900.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1462764.0, 1190900.0, 1464892.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 12	Epoch: 0	Loss: 0.350715
Client Index = 12	Epoch: 1	Loss: 0.309909
Client Index = 12	Epoch: 2	Loss: 0.570195
Client Index = 12	Epoch: 3	Loss: 0.200938
Client Index = 12	Epoch: 4	Loss: 0.231454
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 13
local mask changes: 1190394.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1464154.0, 1190394.0, 1463574.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.252696
Client Index = 13	Epoch: 1	Loss: 0.223389
Client Index = 13	Epoch: 2	Loss: 0.203765
Client Index = 13	Epoch: 3	Loss: 0.249159
Client Index = 13	Epoch: 4	Loss: 0.283535
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 14
local mask changes: 1190084.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1464808.0, 1190084.0, 1462614.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.364188
Client Index = 14	Epoch: 1	Loss: 0.310433
Client Index = 14	Epoch: 2	Loss: 0.221123
Client Index = 14	Epoch: 3	Loss: 0.320919
Client Index = 14	Epoch: 4	Loss: 0.135950
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 15
local mask changes: 1191936.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1460698.0, 1191936.0, 1458328.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.293084
Client Index = 15	Epoch: 1	Loss: 0.243376
Client Index = 15	Epoch: 2	Loss: 0.203586
Client Index = 15	Epoch: 3	Loss: 0.223026
Client Index = 15	Epoch: 4	Loss: 0.304828
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653325824.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 16
local mask changes: 1190354.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1459568.0, 1190354.0, 1462370.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.397971
Client Index = 16	Epoch: 1	Loss: 0.303922
Client Index = 16	Epoch: 2	Loss: 0.269921
Client Index = 16	Epoch: 3	Loss: 0.184533
Client Index = 16	Epoch: 4	Loss: 0.258918
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 17
local mask changes: 1191198.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1464278.0, 1191198.0, 1464564.0]
Doing local aggregation!
test acc on this client before 324 / 503 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.457312
Client Index = 17	Epoch: 1	Loss: 0.363493
Client Index = 17	Epoch: 2	Loss: 0.371455
Client Index = 17	Epoch: 3	Loss: 0.325016
Client Index = 17	Epoch: 4	Loss: 0.316652
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 18
local mask changes: 1190738.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1463184.0, 1190738.0, 1461912.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.173482
Client Index = 18	Epoch: 1	Loss: 0.311972
Client Index = 18	Epoch: 2	Loss: 0.212093
Client Index = 18	Epoch: 3	Loss: 0.190360
Client Index = 18	Epoch: 4	Loss: 0.228490
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 19
local mask changes: 1191130.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1463952.0, 1463222.0, 1191130.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.246975
Client Index = 19	Epoch: 1	Loss: 0.243007
Client Index = 19	Epoch: 2	Loss: 0.221586
Client Index = 19	Epoch: 3	Loss: 0.225659
Client Index = 19	Epoch: 4	Loss: 0.307304
test acc on this client after 234 / 503 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2576867700112052}
################local_test_on_all_clients after local training in communication round: 63
{'test_acc_after': 0.761125341532832, 'test_loss_after': 0.8821713724213511}
################local_test_on_all_clients before local training in communication round: 63
{'test_acc_before': 0.7719427407004807, 'test_loss_before': 0.7507613601151191}
################Communication round : 64
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 0
local mask changes: 1143478.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1143478.0, 1424040.0, 1424408.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 0	Epoch: 0	Loss: 0.474511
Client Index = 0	Epoch: 1	Loss: 0.256266
Client Index = 0	Epoch: 2	Loss: 0.260243
Client Index = 0	Epoch: 3	Loss: 0.197368
Client Index = 0	Epoch: 4	Loss: 0.315908
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 1
local mask changes: 1144104.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1422072.0, 1144104.0, 1418468.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.364881
Client Index = 1	Epoch: 1	Loss: 0.167273
Client Index = 1	Epoch: 2	Loss: 0.094132
Client Index = 1	Epoch: 3	Loss: 0.107734
Client Index = 1	Epoch: 4	Loss: 0.095604
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 2
local mask changes: 1142902.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1416868.0, 1142902.0, 1418594.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.062446
Client Index = 2	Epoch: 1	Loss: 0.084560
Client Index = 2	Epoch: 2	Loss: 0.068771
Client Index = 2	Epoch: 3	Loss: 0.064115
Client Index = 2	Epoch: 4	Loss: 0.054024
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 3
local mask changes: 1143408.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1420082.0, 1143408.0, 1422314.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.138446
Client Index = 3	Epoch: 1	Loss: 0.558753
Client Index = 3	Epoch: 2	Loss: 0.118767
Client Index = 3	Epoch: 3	Loss: 0.127843
Client Index = 3	Epoch: 4	Loss: 0.219584
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 4
local mask changes: 1143046.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1425760.0, 1143046.0, 1425708.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.347993
Client Index = 4	Epoch: 1	Loss: 0.228214
Client Index = 4	Epoch: 2	Loss: 0.184664
Client Index = 4	Epoch: 3	Loss: 0.168952
Client Index = 4	Epoch: 4	Loss: 0.263869
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 5
local mask changes: 1143820.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1425530.0, 1143820.0, 1428782.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.398682
Client Index = 5	Epoch: 1	Loss: 0.340317
Client Index = 5	Epoch: 2	Loss: 0.227884
Client Index = 5	Epoch: 3	Loss: 0.254949
Client Index = 5	Epoch: 4	Loss: 0.227771
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 6
local mask changes: 1143964.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1429090.0, 1143964.0, 1431086.0]
Doing local aggregation!
test acc on this client before 379 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.327673
Client Index = 6	Epoch: 1	Loss: 0.390368
Client Index = 6	Epoch: 2	Loss: 0.263649
Client Index = 6	Epoch: 3	Loss: 0.291762
Client Index = 6	Epoch: 4	Loss: 0.223965
test acc on this client after 376 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 7
local mask changes: 1143626.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1431014.0, 1143626.0, 1426796.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 7	Epoch: 0	Loss: 0.538004
Client Index = 7	Epoch: 1	Loss: 0.423974
Client Index = 7	Epoch: 2	Loss: 0.374844
Client Index = 7	Epoch: 3	Loss: 0.347518
Client Index = 7	Epoch: 4	Loss: 0.404318
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 8
local mask changes: 1143614.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1422490.0, 1143614.0, 1418370.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.193076
Client Index = 8	Epoch: 1	Loss: 0.127755
Client Index = 8	Epoch: 2	Loss: 0.086948
Client Index = 8	Epoch: 3	Loss: 0.039646
Client Index = 8	Epoch: 4	Loss: 0.041079
test acc on this client after 463 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 9
local mask changes: 1143558.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1421546.0, 1143558.0, 1425976.0]
Doing local aggregation!
test acc on this client before 361 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.473089
Client Index = 9	Epoch: 1	Loss: 0.246629
Client Index = 9	Epoch: 2	Loss: 0.223805
Client Index = 9	Epoch: 3	Loss: 0.277190
Client Index = 9	Epoch: 4	Loss: 0.339065
test acc on this client after 370 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 10
local mask changes: 1142806.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1428054.0, 1142806.0, 1425672.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.520140
Client Index = 10	Epoch: 1	Loss: 0.289368
Client Index = 10	Epoch: 2	Loss: 0.278433
Client Index = 10	Epoch: 3	Loss: 0.288068
Client Index = 10	Epoch: 4	Loss: 0.225370
test acc on this client after 284 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 11
local mask changes: 1143358.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1422844.0, 1143358.0, 1422180.0]
Doing local aggregation!
test acc on this client before 412 / 505 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.210318
Client Index = 11	Epoch: 1	Loss: 0.127833
Client Index = 11	Epoch: 2	Loss: 0.209777
Client Index = 11	Epoch: 3	Loss: 0.099723
Client Index = 11	Epoch: 4	Loss: 0.065691
test acc on this client after 412 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 12
local mask changes: 1143832.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1426166.0, 1143832.0, 1427802.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.339067
Client Index = 12	Epoch: 1	Loss: 0.304500
Client Index = 12	Epoch: 2	Loss: 0.364761
Client Index = 12	Epoch: 3	Loss: 0.170029
Client Index = 12	Epoch: 4	Loss: 0.239369
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 13
local mask changes: 1143334.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1426608.0, 1143334.0, 1426240.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.283943
Client Index = 13	Epoch: 1	Loss: 0.263224
Client Index = 13	Epoch: 2	Loss: 0.138261
Client Index = 13	Epoch: 3	Loss: 0.432529
Client Index = 13	Epoch: 4	Loss: 0.132771
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 14
local mask changes: 1144030.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1424670.0, 1144030.0, 1422914.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 14	Epoch: 0	Loss: 0.400239
Client Index = 14	Epoch: 1	Loss: 0.339021
Client Index = 14	Epoch: 2	Loss: 0.257354
Client Index = 14	Epoch: 3	Loss: 0.304550
Client Index = 14	Epoch: 4	Loss: 0.160007
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 15
local mask changes: 1143294.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1422086.0, 1143294.0, 1420176.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.284972
Client Index = 15	Epoch: 1	Loss: 0.338369
Client Index = 15	Epoch: 2	Loss: 0.198031
Client Index = 15	Epoch: 3	Loss: 0.198556
Client Index = 15	Epoch: 4	Loss: 0.182677
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 16
local mask changes: 1143326.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1420500.0, 1143326.0, 1424424.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 16	Epoch: 0	Loss: 0.360734
Client Index = 16	Epoch: 1	Loss: 0.450333
Client Index = 16	Epoch: 2	Loss: 0.189228
Client Index = 16	Epoch: 3	Loss: 0.178669
Client Index = 16	Epoch: 4	Loss: 0.231833
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653337856.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 17
local mask changes: 1143274.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1424986.0, 1143274.0, 1427374.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 17	Epoch: 0	Loss: 0.494173
Client Index = 17	Epoch: 1	Loss: 0.315541
Client Index = 17	Epoch: 2	Loss: 0.513830
Client Index = 17	Epoch: 3	Loss: 0.225749
Client Index = 17	Epoch: 4	Loss: 0.295871
test acc on this client after 313 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 18
local mask changes: 1143730.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1426174.0, 1143730.0, 1424862.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.262134
Client Index = 18	Epoch: 1	Loss: 0.227075
Client Index = 18	Epoch: 2	Loss: 0.160956
Client Index = 18	Epoch: 3	Loss: 0.125672
Client Index = 18	Epoch: 4	Loss: 0.286719
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 19
local mask changes: 1144044.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1427350.0, 1424102.0, 1144044.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.401571
Client Index = 19	Epoch: 1	Loss: 0.218262
Client Index = 19	Epoch: 2	Loss: 0.197068
Client Index = 19	Epoch: 3	Loss: 0.223401
Client Index = 19	Epoch: 4	Loss: 0.429361
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2554400885286741}
################local_test_on_all_clients after local training in communication round: 64
{'test_acc_after': 0.7644809785841951, 'test_loss_after': 0.855824384610326}
################local_test_on_all_clients before local training in communication round: 64
{'test_acc_before': 0.7699387053130563, 'test_loss_before': 0.7872210832334708}
################Communication round : 65
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 0
local mask changes: 1095948.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1095948.0, 1386222.0, 1387972.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 0	Epoch: 0	Loss: 0.366525
Client Index = 0	Epoch: 1	Loss: 0.257759
Client Index = 0	Epoch: 2	Loss: 0.212460
Client Index = 0	Epoch: 3	Loss: 0.295523
Client Index = 0	Epoch: 4	Loss: 0.142096
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 1
local mask changes: 1096252.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1383418.0, 1096252.0, 1378342.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.398591
Client Index = 1	Epoch: 1	Loss: 0.129609
Client Index = 1	Epoch: 2	Loss: 0.112133
Client Index = 1	Epoch: 3	Loss: 0.144185
Client Index = 1	Epoch: 4	Loss: 0.104485
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 2
local mask changes: 1097056.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1376908.0, 1097056.0, 1378324.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.097401
Client Index = 2	Epoch: 1	Loss: 0.091529
Client Index = 2	Epoch: 2	Loss: 0.057484
Client Index = 2	Epoch: 3	Loss: 0.041422
Client Index = 2	Epoch: 4	Loss: 0.045081
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 3
local mask changes: 1096402.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1381566.0, 1096402.0, 1385470.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.256080
Client Index = 3	Epoch: 1	Loss: 0.141262
Client Index = 3	Epoch: 2	Loss: 0.229312
Client Index = 3	Epoch: 3	Loss: 0.087703
Client Index = 3	Epoch: 4	Loss: 0.137877
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 4
local mask changes: 1095490.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1386256.0, 1095490.0, 1388346.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.384644
Client Index = 4	Epoch: 1	Loss: 0.234756
Client Index = 4	Epoch: 2	Loss: 0.279841
Client Index = 4	Epoch: 3	Loss: 0.306562
Client Index = 4	Epoch: 4	Loss: 0.178358
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 5
local mask changes: 1096674.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1389264.0, 1096674.0, 1388908.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 5	Epoch: 0	Loss: 0.366000
Client Index = 5	Epoch: 1	Loss: 0.473891
Client Index = 5	Epoch: 2	Loss: 0.236938
Client Index = 5	Epoch: 3	Loss: 0.243958
Client Index = 5	Epoch: 4	Loss: 0.222349
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 6
local mask changes: 1096752.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1390740.0, 1096752.0, 1393646.0]
Doing local aggregation!
test acc on this client before 369 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.387837
Client Index = 6	Epoch: 1	Loss: 0.282826
Client Index = 6	Epoch: 2	Loss: 0.344940
Client Index = 6	Epoch: 3	Loss: 0.309945
Client Index = 6	Epoch: 4	Loss: 0.216783
test acc on this client after 362 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 7
local mask changes: 1096266.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1393266.0, 1096266.0, 1388250.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 7	Epoch: 0	Loss: 0.568068
Client Index = 7	Epoch: 1	Loss: 0.598717
Client Index = 7	Epoch: 2	Loss: 0.364082
Client Index = 7	Epoch: 3	Loss: 0.364858
Client Index = 7	Epoch: 4	Loss: 0.371090
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 8
local mask changes: 1097048.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1384316.0, 1097048.0, 1381292.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.111151
Client Index = 8	Epoch: 1	Loss: 0.082321
Client Index = 8	Epoch: 2	Loss: 0.041957
Client Index = 8	Epoch: 3	Loss: 0.035649
Client Index = 8	Epoch: 4	Loss: 0.083204
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 9
local mask changes: 1096688.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1383820.0, 1096688.0, 1389624.0]
Doing local aggregation!
test acc on this client before 357 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.249168
Client Index = 9	Epoch: 1	Loss: 0.550939
Client Index = 9	Epoch: 2	Loss: 0.225921
Client Index = 9	Epoch: 3	Loss: 0.181924
Client Index = 9	Epoch: 4	Loss: 0.295155
test acc on this client after 346 / 506 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 10
local mask changes: 1096136.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1390172.0, 1096136.0, 1386260.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.406332
Client Index = 10	Epoch: 1	Loss: 0.305308
Client Index = 10	Epoch: 2	Loss: 0.227386
Client Index = 10	Epoch: 3	Loss: 0.321039
Client Index = 10	Epoch: 4	Loss: 0.214491
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 11
local mask changes: 1095710.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1385538.0, 1095710.0, 1384054.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 11	Epoch: 0	Loss: 0.333129
Client Index = 11	Epoch: 1	Loss: 0.103364
Client Index = 11	Epoch: 2	Loss: 0.101758
Client Index = 11	Epoch: 3	Loss: 0.365453
Client Index = 11	Epoch: 4	Loss: 0.085774
test acc on this client after 433 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 12
local mask changes: 1096038.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1386576.0, 1096038.0, 1389652.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.391887
Client Index = 12	Epoch: 1	Loss: 0.259390
Client Index = 12	Epoch: 2	Loss: 0.290752
Client Index = 12	Epoch: 3	Loss: 0.144490
Client Index = 12	Epoch: 4	Loss: 0.202627
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 13
local mask changes: 1095876.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1388888.0, 1095876.0, 1387478.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.246685
Client Index = 13	Epoch: 1	Loss: 0.186520
Client Index = 13	Epoch: 2	Loss: 0.198934
Client Index = 13	Epoch: 3	Loss: 0.147824
Client Index = 13	Epoch: 4	Loss: 0.245865
test acc on this client after 369 / 505 : 0.73
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 14
local mask changes: 1096206.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1386482.0, 1096206.0, 1384922.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 14	Epoch: 0	Loss: 0.388789
Client Index = 14	Epoch: 1	Loss: 0.223988
Client Index = 14	Epoch: 2	Loss: 0.215165
Client Index = 14	Epoch: 3	Loss: 0.330893
Client Index = 14	Epoch: 4	Loss: 0.274690
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653337088.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 15
local mask changes: 1096028.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1382642.0, 1096028.0, 1382234.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.260349
Client Index = 15	Epoch: 1	Loss: 0.222073
Client Index = 15	Epoch: 2	Loss: 0.221377
Client Index = 15	Epoch: 3	Loss: 0.122036
Client Index = 15	Epoch: 4	Loss: 0.210837
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 16
local mask changes: 1096644.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1382002.0, 1096644.0, 1384728.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 16	Epoch: 0	Loss: 0.342890
Client Index = 16	Epoch: 1	Loss: 0.329468
Client Index = 16	Epoch: 2	Loss: 0.185535
Client Index = 16	Epoch: 3	Loss: 0.211937
Client Index = 16	Epoch: 4	Loss: 0.291463
test acc on this client after 394 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 17
local mask changes: 1095992.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1387794.0, 1095992.0, 1389730.0]
Doing local aggregation!
test acc on this client before 334 / 503 : 0.66
Client Index = 17	Epoch: 0	Loss: 0.483349
Client Index = 17	Epoch: 1	Loss: 0.264079
Client Index = 17	Epoch: 2	Loss: 0.396502
Client Index = 17	Epoch: 3	Loss: 0.275253
Client Index = 17	Epoch: 4	Loss: 0.313322
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 18
local mask changes: 1096078.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1388630.0, 1096078.0, 1385922.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.287244
Client Index = 18	Epoch: 1	Loss: 0.175886
Client Index = 18	Epoch: 2	Loss: 0.394852
Client Index = 18	Epoch: 3	Loss: 0.115332
Client Index = 18	Epoch: 4	Loss: 0.099746
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 19
local mask changes: 1096882.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1387712.0, 1386556.0, 1096882.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.257600
Client Index = 19	Epoch: 1	Loss: 0.262635
Client Index = 19	Epoch: 2	Loss: 0.187464
Client Index = 19	Epoch: 3	Loss: 0.207932
Client Index = 19	Epoch: 4	Loss: 0.212280
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.24486321348743512}
################local_test_on_all_clients after local training in communication round: 65
{'test_acc_after': 0.7609325619039313, 'test_loss_after': 0.8696693651558357}
################local_test_on_all_clients before local training in communication round: 65
{'test_acc_before': 0.7770091496310518, 'test_loss_before': 0.7616478758635198}
################Communication round : 66
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 0
local mask changes: 1048644.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1048644.0, 1348580.0, 1349616.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.588387
Client Index = 0	Epoch: 1	Loss: 0.195708
Client Index = 0	Epoch: 2	Loss: 0.192857
Client Index = 0	Epoch: 3	Loss: 0.272138
Client Index = 0	Epoch: 4	Loss: 0.229192
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 1
local mask changes: 1049476.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1345658.0, 1049476.0, 1339838.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 1	Epoch: 0	Loss: 0.196206
Client Index = 1	Epoch: 1	Loss: 0.157579
Client Index = 1	Epoch: 2	Loss: 0.136982
Client Index = 1	Epoch: 3	Loss: 0.169120
Client Index = 1	Epoch: 4	Loss: 0.258906
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 2
local mask changes: 1049354.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1338606.0, 1049354.0, 1341368.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.146711
Client Index = 2	Epoch: 1	Loss: 0.079986
Client Index = 2	Epoch: 2	Loss: 0.041811
Client Index = 2	Epoch: 3	Loss: 0.032480
Client Index = 2	Epoch: 4	Loss: 0.040058
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 3
local mask changes: 1049010.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1343422.0, 1049010.0, 1348454.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.224090
Client Index = 3	Epoch: 1	Loss: 0.163467
Client Index = 3	Epoch: 2	Loss: 0.105629
Client Index = 3	Epoch: 3	Loss: 0.086455
Client Index = 3	Epoch: 4	Loss: 0.069561
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 4
local mask changes: 1049476.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1349824.0, 1049476.0, 1350884.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.291434
Client Index = 4	Epoch: 1	Loss: 0.255699
Client Index = 4	Epoch: 2	Loss: 0.392343
Client Index = 4	Epoch: 3	Loss: 0.151903
Client Index = 4	Epoch: 4	Loss: 0.098722
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 5
local mask changes: 1048632.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1352046.0, 1048632.0, 1352936.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.339915
Client Index = 5	Epoch: 1	Loss: 0.329503
Client Index = 5	Epoch: 2	Loss: 0.256971
Client Index = 5	Epoch: 3	Loss: 0.181880
Client Index = 5	Epoch: 4	Loss: 0.217408
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 6
local mask changes: 1049232.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1353366.0, 1049232.0, 1355452.0]
Doing local aggregation!
test acc on this client before 347 / 505 : 0.69
Client Index = 6	Epoch: 0	Loss: 0.496167
Client Index = 6	Epoch: 1	Loss: 0.266295
Client Index = 6	Epoch: 2	Loss: 0.223776
Client Index = 6	Epoch: 3	Loss: 0.252395
Client Index = 6	Epoch: 4	Loss: 0.148126
test acc on this client after 384 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 7
local mask changes: 1049012.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1356498.0, 1049012.0, 1350656.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 7	Epoch: 0	Loss: 0.514434
Client Index = 7	Epoch: 1	Loss: 0.471620
Client Index = 7	Epoch: 2	Loss: 0.445758
Client Index = 7	Epoch: 3	Loss: 0.331320
Client Index = 7	Epoch: 4	Loss: 0.373705
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 8
local mask changes: 1049246.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1346036.0, 1049246.0, 1342496.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.129921
Client Index = 8	Epoch: 1	Loss: 0.072856
Client Index = 8	Epoch: 2	Loss: 0.037744
Client Index = 8	Epoch: 3	Loss: 0.096830
Client Index = 8	Epoch: 4	Loss: 0.031034
test acc on this client after 467 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 9
local mask changes: 1049180.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1346660.0, 1049180.0, 1352200.0]
Doing local aggregation!
test acc on this client before 361 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.363794
Client Index = 9	Epoch: 1	Loss: 0.326840
Client Index = 9	Epoch: 2	Loss: 0.241777
Client Index = 9	Epoch: 3	Loss: 0.189756
Client Index = 9	Epoch: 4	Loss: 0.230582
test acc on this client after 380 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 10
local mask changes: 1049006.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1352956.0, 1049006.0, 1348560.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.465508
Client Index = 10	Epoch: 1	Loss: 0.294559
Client Index = 10	Epoch: 2	Loss: 0.213210
Client Index = 10	Epoch: 3	Loss: 0.322459
Client Index = 10	Epoch: 4	Loss: 0.289360
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 11
local mask changes: 1049744.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1347390.0, 1049744.0, 1346110.0]
Doing local aggregation!
test acc on this client before 412 / 505 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.232155
Client Index = 11	Epoch: 1	Loss: 0.158262
Client Index = 11	Epoch: 2	Loss: 0.118053
Client Index = 11	Epoch: 3	Loss: 0.078173
Client Index = 11	Epoch: 4	Loss: 0.062327
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 12
local mask changes: 1049082.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1348320.0, 1049082.0, 1350854.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.432885
Client Index = 12	Epoch: 1	Loss: 0.300485
Client Index = 12	Epoch: 2	Loss: 0.232500
Client Index = 12	Epoch: 3	Loss: 0.233457
Client Index = 12	Epoch: 4	Loss: 0.122856
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 13
local mask changes: 1049004.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1351828.0, 1049004.0, 1347916.0]
Doing local aggregation!
test acc on this client before 387 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.434535
Client Index = 13	Epoch: 1	Loss: 0.159884
Client Index = 13	Epoch: 2	Loss: 0.146902
Client Index = 13	Epoch: 3	Loss: 0.201162
Client Index = 13	Epoch: 4	Loss: 0.151184
test acc on this client after 377 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 14
local mask changes: 1049154.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1349266.0, 1049154.0, 1347206.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.298534
Client Index = 14	Epoch: 1	Loss: 0.301139
Client Index = 14	Epoch: 2	Loss: 0.290836
Client Index = 14	Epoch: 3	Loss: 0.244047
Client Index = 14	Epoch: 4	Loss: 0.248060
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 15
local mask changes: 1049728.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1345354.0, 1049728.0, 1343084.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.259095
Client Index = 15	Epoch: 1	Loss: 0.202135
Client Index = 15	Epoch: 2	Loss: 0.246659
Client Index = 15	Epoch: 3	Loss: 0.172745
Client Index = 15	Epoch: 4	Loss: 0.153531
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 16
local mask changes: 1049812.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1344456.0, 1049812.0, 1348108.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 16	Epoch: 0	Loss: 0.346307
Client Index = 16	Epoch: 1	Loss: 0.376932
Client Index = 16	Epoch: 2	Loss: 0.249481
Client Index = 16	Epoch: 3	Loss: 0.410927
Client Index = 16	Epoch: 4	Loss: 0.178502
test acc on this client after 343 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 17
local mask changes: 1049254.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1349936.0, 1049254.0, 1351388.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 17	Epoch: 0	Loss: 0.499999
Client Index = 17	Epoch: 1	Loss: 0.388292
Client Index = 17	Epoch: 2	Loss: 0.239656
Client Index = 17	Epoch: 3	Loss: 0.388788
Client Index = 17	Epoch: 4	Loss: 0.276133
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 18
local mask changes: 1049644.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1348830.0, 1049644.0, 1347374.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.208963
Client Index = 18	Epoch: 1	Loss: 0.437329
Client Index = 18	Epoch: 2	Loss: 0.148971
Client Index = 18	Epoch: 3	Loss: 0.128695
Client Index = 18	Epoch: 4	Loss: 0.124351
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 19
local mask changes: 1049556.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1348608.0, 1347520.0, 1049556.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.386858
Client Index = 19	Epoch: 1	Loss: 0.361799
Client Index = 19	Epoch: 2	Loss: 0.178286
Client Index = 19	Epoch: 3	Loss: 0.150026
Client Index = 19	Epoch: 4	Loss: 0.169169
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.238639938615961}
################local_test_on_all_clients after local training in communication round: 66
{'test_acc_after': 0.7740105459862511, 'test_loss_after': 0.8424389375258899}
################local_test_on_all_clients before local training in communication round: 66
{'test_acc_before': 0.772245656861662, 'test_loss_before': 0.781380862902823}
################Communication round : 67
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 0
local mask changes: 1003128.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [1003128.0, 1311578.0, 1313182.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.443714
Client Index = 0	Epoch: 1	Loss: 0.187532
Client Index = 0	Epoch: 2	Loss: 0.327722
Client Index = 0	Epoch: 3	Loss: 0.139762
Client Index = 0	Epoch: 4	Loss: 0.217948
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 1
local mask changes: 1002548.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1308498.0, 1002548.0, 1303336.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.217363
Client Index = 1	Epoch: 1	Loss: 0.152921
Client Index = 1	Epoch: 2	Loss: 0.120071
Client Index = 1	Epoch: 3	Loss: 0.135029
Client Index = 1	Epoch: 4	Loss: 0.077089
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 2
local mask changes: 1002244.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1299818.0, 1002244.0, 1302216.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.140938
Client Index = 2	Epoch: 1	Loss: 0.097882
Client Index = 2	Epoch: 2	Loss: 0.046670
Client Index = 2	Epoch: 3	Loss: 0.086276
Client Index = 2	Epoch: 4	Loss: 0.059806
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 3
local mask changes: 1002494.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1303670.0, 1002494.0, 1308944.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.462249
Client Index = 3	Epoch: 1	Loss: 0.190839
Client Index = 3	Epoch: 2	Loss: 0.101877
Client Index = 3	Epoch: 3	Loss: 0.138479
Client Index = 3	Epoch: 4	Loss: 0.141530
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 4
local mask changes: 1002404.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1311530.0, 1002404.0, 1313496.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.393557
Client Index = 4	Epoch: 1	Loss: 0.277708
Client Index = 4	Epoch: 2	Loss: 0.284305
Client Index = 4	Epoch: 3	Loss: 0.331002
Client Index = 4	Epoch: 4	Loss: 0.183008
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 5
local mask changes: 1002224.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1314552.0, 1002224.0, 1315676.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 5	Epoch: 0	Loss: 0.548812
Client Index = 5	Epoch: 1	Loss: 0.246070
Client Index = 5	Epoch: 2	Loss: 0.254893
Client Index = 5	Epoch: 3	Loss: 0.229225
Client Index = 5	Epoch: 4	Loss: 0.203517
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 6
local mask changes: 1002468.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1316752.0, 1002468.0, 1317644.0]
Doing local aggregation!
test acc on this client before 371 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.377917
Client Index = 6	Epoch: 1	Loss: 0.317533
Client Index = 6	Epoch: 2	Loss: 0.254012
Client Index = 6	Epoch: 3	Loss: 0.161766
Client Index = 6	Epoch: 4	Loss: 0.204181
test acc on this client after 317 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 7
local mask changes: 1002842.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1318320.0, 1002842.0, 1311980.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 7	Epoch: 0	Loss: 0.590240
Client Index = 7	Epoch: 1	Loss: 0.468670
Client Index = 7	Epoch: 2	Loss: 0.379206
Client Index = 7	Epoch: 3	Loss: 0.322710
Client Index = 7	Epoch: 4	Loss: 0.329770
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 8
local mask changes: 1002706.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1308820.0, 1002706.0, 1305032.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.088788
Client Index = 8	Epoch: 1	Loss: 0.063645
Client Index = 8	Epoch: 2	Loss: 0.211325
Client Index = 8	Epoch: 3	Loss: 0.045591
Client Index = 8	Epoch: 4	Loss: 0.030269
test acc on this client after 467 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 9
local mask changes: 1001956.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1309042.0, 1001956.0, 1315436.0]
Doing local aggregation!
test acc on this client before 354 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.487739
Client Index = 9	Epoch: 1	Loss: 0.232262
Client Index = 9	Epoch: 2	Loss: 0.189215
Client Index = 9	Epoch: 3	Loss: 0.295587
Client Index = 9	Epoch: 4	Loss: 0.272721
test acc on this client after 368 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 10
local mask changes: 1001884.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1316360.0, 1001884.0, 1312550.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.264836
Client Index = 10	Epoch: 1	Loss: 0.296868
Client Index = 10	Epoch: 2	Loss: 0.342961
Client Index = 10	Epoch: 3	Loss: 0.276622
Client Index = 10	Epoch: 4	Loss: 0.177336
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 11
local mask changes: 1002370.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1309072.0, 1002370.0, 1308228.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 11	Epoch: 0	Loss: 0.157868
Client Index = 11	Epoch: 1	Loss: 0.337267
Client Index = 11	Epoch: 2	Loss: 0.133558
Client Index = 11	Epoch: 3	Loss: 0.082291
Client Index = 11	Epoch: 4	Loss: 0.067726
test acc on this client after 420 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 12
local mask changes: 1002332.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1311208.0, 1002332.0, 1313728.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.471192
Client Index = 12	Epoch: 1	Loss: 0.255337
Client Index = 12	Epoch: 2	Loss: 0.203311
Client Index = 12	Epoch: 3	Loss: 0.255488
Client Index = 12	Epoch: 4	Loss: 0.171942
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 13
local mask changes: 1002564.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1312990.0, 1002564.0, 1312276.0]
Doing local aggregation!
test acc on this client before 389 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.254778
Client Index = 13	Epoch: 1	Loss: 0.158973
Client Index = 13	Epoch: 2	Loss: 0.255909
Client Index = 13	Epoch: 3	Loss: 0.145482
Client Index = 13	Epoch: 4	Loss: 0.118694
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 14
local mask changes: 1002356.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1311686.0, 1002356.0, 1309082.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.336300
Client Index = 14	Epoch: 1	Loss: 0.245750
Client Index = 14	Epoch: 2	Loss: 0.298869
Client Index = 14	Epoch: 3	Loss: 0.132978
Client Index = 14	Epoch: 4	Loss: 0.297120
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653334016.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 15
local mask changes: 1002696.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1307786.0, 1002696.0, 1304682.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.280854
Client Index = 15	Epoch: 1	Loss: 0.246456
Client Index = 15	Epoch: 2	Loss: 0.199774
Client Index = 15	Epoch: 3	Loss: 0.237650
Client Index = 15	Epoch: 4	Loss: 0.131641
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 16
local mask changes: 1001890.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1307570.0, 1001890.0, 1311920.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 16	Epoch: 0	Loss: 0.477751
Client Index = 16	Epoch: 1	Loss: 0.268349
Client Index = 16	Epoch: 2	Loss: 0.275605
Client Index = 16	Epoch: 3	Loss: 0.133217
Client Index = 16	Epoch: 4	Loss: 0.144226
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 17
local mask changes: 1002146.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1312052.0, 1002146.0, 1313842.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.338267
Client Index = 17	Epoch: 1	Loss: 0.357681
Client Index = 17	Epoch: 2	Loss: 0.296594
Client Index = 17	Epoch: 3	Loss: 0.285685
Client Index = 17	Epoch: 4	Loss: 0.261821
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 18
local mask changes: 1002582.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1312030.0, 1002582.0, 1308784.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.520763
Client Index = 18	Epoch: 1	Loss: 0.204021
Client Index = 18	Epoch: 2	Loss: 0.134239
Client Index = 18	Epoch: 3	Loss: 0.148105
Client Index = 18	Epoch: 4	Loss: 0.223407
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 19
local mask changes: 1001828.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1312556.0, 1308192.0, 1001828.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.369009
Client Index = 19	Epoch: 1	Loss: 0.254610
Client Index = 19	Epoch: 2	Loss: 0.192490
Client Index = 19	Epoch: 3	Loss: 0.170041
Client Index = 19	Epoch: 4	Loss: 0.273641
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.23926294851093552}
################local_test_on_all_clients after local training in communication round: 67
{'test_acc_after': 0.7750336686608167, 'test_loss_after': 0.8583890602710029}
################local_test_on_all_clients before local training in communication round: 67
{'test_acc_before': 0.7703615165842801, 'test_loss_before': 0.7877365666246262}
################Communication round : 68
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 0
local mask changes: 956558.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [956558.0, 1272974.0, 1274298.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.321516
Client Index = 0	Epoch: 1	Loss: 0.266327
Client Index = 0	Epoch: 2	Loss: 0.166153
Client Index = 0	Epoch: 3	Loss: 0.160367
Client Index = 0	Epoch: 4	Loss: 0.342132
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 1
local mask changes: 955804.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1271580.0, 955804.0, 1265446.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.479341
Client Index = 1	Epoch: 1	Loss: 0.115112
Client Index = 1	Epoch: 2	Loss: 0.097679
Client Index = 1	Epoch: 3	Loss: 0.123889
Client Index = 1	Epoch: 4	Loss: 0.099364
test acc on this client after 432 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 2
local mask changes: 956054.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1263910.0, 956054.0, 1263898.0]
Doing local aggregation!
test acc on this client before 434 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.112383
Client Index = 2	Epoch: 1	Loss: 0.043570
Client Index = 2	Epoch: 2	Loss: 0.066506
Client Index = 2	Epoch: 3	Loss: 0.061267
Client Index = 2	Epoch: 4	Loss: 0.115495
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 3
local mask changes: 956018.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1266950.0, 956018.0, 1272006.0]
Doing local aggregation!
test acc on this client before 427 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.143582
Client Index = 3	Epoch: 1	Loss: 0.283663
Client Index = 3	Epoch: 2	Loss: 0.106589
Client Index = 3	Epoch: 3	Loss: 0.068007
Client Index = 3	Epoch: 4	Loss: 0.192282
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 4
local mask changes: 955036.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1273540.0, 955036.0, 1276144.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.366482
Client Index = 4	Epoch: 1	Loss: 0.238169
Client Index = 4	Epoch: 2	Loss: 0.203609
Client Index = 4	Epoch: 3	Loss: 0.226380
Client Index = 4	Epoch: 4	Loss: 0.232096
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 5
local mask changes: 956004.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1277702.0, 956004.0, 1278358.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 5	Epoch: 0	Loss: 0.525459
Client Index = 5	Epoch: 1	Loss: 0.213872
Client Index = 5	Epoch: 2	Loss: 0.261017
Client Index = 5	Epoch: 3	Loss: 0.202323
Client Index = 5	Epoch: 4	Loss: 0.316392
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 6
local mask changes: 956236.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1278784.0, 956236.0, 1280916.0]
Doing local aggregation!
test acc on this client before 382 / 505 : 0.76
Client Index = 6	Epoch: 0	Loss: 0.466631
Client Index = 6	Epoch: 1	Loss: 0.259850
Client Index = 6	Epoch: 2	Loss: 0.322392
Client Index = 6	Epoch: 3	Loss: 0.204206
Client Index = 6	Epoch: 4	Loss: 0.288605
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 7
local mask changes: 955520.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1282440.0, 955520.0, 1276358.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 7	Epoch: 0	Loss: 0.498950
Client Index = 7	Epoch: 1	Loss: 0.448158
Client Index = 7	Epoch: 2	Loss: 0.330277
Client Index = 7	Epoch: 3	Loss: 0.271747
Client Index = 7	Epoch: 4	Loss: 0.352974
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 8
local mask changes: 955516.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1270268.0, 955516.0, 1267064.0]
Doing local aggregation!
test acc on this client before 434 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.175523
Client Index = 8	Epoch: 1	Loss: 0.065713
Client Index = 8	Epoch: 2	Loss: 0.036090
Client Index = 8	Epoch: 3	Loss: 0.030750
Client Index = 8	Epoch: 4	Loss: 0.018036
test acc on this client after 465 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 9
local mask changes: 955452.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1271294.0, 955452.0, 1279552.0]
Doing local aggregation!
test acc on this client before 361 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.231960
Client Index = 9	Epoch: 1	Loss: 0.398336
Client Index = 9	Epoch: 2	Loss: 0.202079
Client Index = 9	Epoch: 3	Loss: 0.185471
Client Index = 9	Epoch: 4	Loss: 0.189982
test acc on this client after 357 / 506 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 10
local mask changes: 957056.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1279366.0, 957056.0, 1275442.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.494459
Client Index = 10	Epoch: 1	Loss: 0.161254
Client Index = 10	Epoch: 2	Loss: 0.249733
Client Index = 10	Epoch: 3	Loss: 0.300267
Client Index = 10	Epoch: 4	Loss: 0.259087
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 11
local mask changes: 956750.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1272482.0, 956750.0, 1271654.0]
Doing local aggregation!
test acc on this client before 415 / 505 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.152998
Client Index = 11	Epoch: 1	Loss: 0.362472
Client Index = 11	Epoch: 2	Loss: 0.081431
Client Index = 11	Epoch: 3	Loss: 0.053455
Client Index = 11	Epoch: 4	Loss: 0.047868
test acc on this client after 427 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 12
local mask changes: 955540.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1272390.0, 955540.0, 1276482.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.490349
Client Index = 12	Epoch: 1	Loss: 0.191389
Client Index = 12	Epoch: 2	Loss: 0.129191
Client Index = 12	Epoch: 3	Loss: 0.369998
Client Index = 12	Epoch: 4	Loss: 0.166496
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 13
local mask changes: 955912.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1275246.0, 955912.0, 1273100.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.314162
Client Index = 13	Epoch: 1	Loss: 0.207092
Client Index = 13	Epoch: 2	Loss: 0.229192
Client Index = 13	Epoch: 3	Loss: 0.189704
Client Index = 13	Epoch: 4	Loss: 0.262811
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 14
local mask changes: 956318.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1274966.0, 956318.0, 1271660.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 14	Epoch: 0	Loss: 0.221288
Client Index = 14	Epoch: 1	Loss: 0.335814
Client Index = 14	Epoch: 2	Loss: 0.188755
Client Index = 14	Epoch: 3	Loss: 0.157018
Client Index = 14	Epoch: 4	Loss: 0.315223
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 15
local mask changes: 955258.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1269608.0, 955258.0, 1269960.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.282539
Client Index = 15	Epoch: 1	Loss: 0.226832
Client Index = 15	Epoch: 2	Loss: 0.243890
Client Index = 15	Epoch: 3	Loss: 0.175709
Client Index = 15	Epoch: 4	Loss: 0.172910
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 16
local mask changes: 955874.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1270136.0, 955874.0, 1274078.0]
Doing local aggregation!
test acc on this client before 376 / 504 : 0.75
Client Index = 16	Epoch: 0	Loss: 0.506878
Client Index = 16	Epoch: 1	Loss: 0.202201
Client Index = 16	Epoch: 2	Loss: 0.135467
Client Index = 16	Epoch: 3	Loss: 0.158478
Client Index = 16	Epoch: 4	Loss: 0.368470
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 17
local mask changes: 955084.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1276144.0, 955084.0, 1276520.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.337691
Client Index = 17	Epoch: 1	Loss: 0.499374
Client Index = 17	Epoch: 2	Loss: 0.232433
Client Index = 17	Epoch: 3	Loss: 0.318019
Client Index = 17	Epoch: 4	Loss: 0.297316
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 18
local mask changes: 955802.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1274906.0, 955802.0, 1272004.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.368061
Client Index = 18	Epoch: 1	Loss: 0.344966
Client Index = 18	Epoch: 2	Loss: 0.168626
Client Index = 18	Epoch: 3	Loss: 0.105147
Client Index = 18	Epoch: 4	Loss: 0.098926
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 19
local mask changes: 955598.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1275572.0, 1272388.0, 955598.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.279795
Client Index = 19	Epoch: 1	Loss: 0.240864
Client Index = 19	Epoch: 2	Loss: 0.331938
Client Index = 19	Epoch: 3	Loss: 0.225937
Client Index = 19	Epoch: 4	Loss: 0.158385
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.23541108882939446}
################local_test_on_all_clients after local training in communication round: 68
{'test_acc_after': 0.7751200801504029, 'test_loss_after': 0.8096461510729782}
################local_test_on_all_clients before local training in communication round: 68
{'test_acc_before': 0.7772951571255196, 'test_loss_before': 0.7661418122953932}
################Communication round : 69
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 0
local mask changes: 909766.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [909766.0, 1237986.0, 1239152.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 0	Epoch: 0	Loss: 0.241298
Client Index = 0	Epoch: 1	Loss: 0.252410
Client Index = 0	Epoch: 2	Loss: 0.203227
Client Index = 0	Epoch: 3	Loss: 0.287110
Client Index = 0	Epoch: 4	Loss: 0.137140
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 1
local mask changes: 909820.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1232746.0, 909820.0, 1227592.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.316718
Client Index = 1	Epoch: 1	Loss: 0.142413
Client Index = 1	Epoch: 2	Loss: 0.218116
Client Index = 1	Epoch: 3	Loss: 0.114899
Client Index = 1	Epoch: 4	Loss: 0.057161
test acc on this client after 447 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 2
local mask changes: 909326.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1227720.0, 909326.0, 1228998.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.061106
Client Index = 2	Epoch: 1	Loss: 0.056434
Client Index = 2	Epoch: 2	Loss: 0.065029
Client Index = 2	Epoch: 3	Loss: 0.044432
Client Index = 2	Epoch: 4	Loss: 0.042970
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 3
local mask changes: 908856.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1231980.0, 908856.0, 1236896.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.163148
Client Index = 3	Epoch: 1	Loss: 0.183442
Client Index = 3	Epoch: 2	Loss: 0.104354
Client Index = 3	Epoch: 3	Loss: 0.091252
Client Index = 3	Epoch: 4	Loss: 0.405604
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 4
local mask changes: 909752.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1238206.0, 909752.0, 1241100.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.277988
Client Index = 4	Epoch: 1	Loss: 0.340696
Client Index = 4	Epoch: 2	Loss: 0.209957
Client Index = 4	Epoch: 3	Loss: 0.287771
Client Index = 4	Epoch: 4	Loss: 0.330132
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 5
local mask changes: 909866.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1241698.0, 909866.0, 1244218.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.308546
Client Index = 5	Epoch: 1	Loss: 0.271977
Client Index = 5	Epoch: 2	Loss: 0.182167
Client Index = 5	Epoch: 3	Loss: 0.277631
Client Index = 5	Epoch: 4	Loss: 0.332581
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 6
local mask changes: 909624.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1245176.0, 909624.0, 1247770.0]
Doing local aggregation!
test acc on this client before 365 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.237123
Client Index = 6	Epoch: 1	Loss: 0.361680
Client Index = 6	Epoch: 2	Loss: 0.380675
Client Index = 6	Epoch: 3	Loss: 0.198393
Client Index = 6	Epoch: 4	Loss: 0.257645
test acc on this client after 389 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 7
local mask changes: 909646.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1245830.0, 909646.0, 1239060.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.560161
Client Index = 7	Epoch: 1	Loss: 0.340282
Client Index = 7	Epoch: 2	Loss: 0.333370
Client Index = 7	Epoch: 3	Loss: 0.325895
Client Index = 7	Epoch: 4	Loss: 0.317707
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 8
local mask changes: 908892.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1234534.0, 908892.0, 1230380.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.217558
Client Index = 8	Epoch: 1	Loss: 0.058772
Client Index = 8	Epoch: 2	Loss: 0.032463
Client Index = 8	Epoch: 3	Loss: 0.054697
Client Index = 8	Epoch: 4	Loss: 0.046893
test acc on this client after 470 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 9
local mask changes: 909340.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1233406.0, 909340.0, 1241300.0]
Doing local aggregation!
test acc on this client before 357 / 506 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.246387
Client Index = 9	Epoch: 1	Loss: 0.289730
Client Index = 9	Epoch: 2	Loss: 0.303663
Client Index = 9	Epoch: 3	Loss: 0.143504
Client Index = 9	Epoch: 4	Loss: 0.247040
test acc on this client after 382 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 10
local mask changes: 909128.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1243446.0, 909128.0, 1237374.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.487109
Client Index = 10	Epoch: 1	Loss: 0.275805
Client Index = 10	Epoch: 2	Loss: 0.187675
Client Index = 10	Epoch: 3	Loss: 0.248754
Client Index = 10	Epoch: 4	Loss: 0.252344
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 11
local mask changes: 908978.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1235356.0, 908978.0, 1233654.0]
Doing local aggregation!
test acc on this client before 416 / 505 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.366190
Client Index = 11	Epoch: 1	Loss: 0.123589
Client Index = 11	Epoch: 2	Loss: 0.104581
Client Index = 11	Epoch: 3	Loss: 0.055226
Client Index = 11	Epoch: 4	Loss: 0.063880
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 12
local mask changes: 909652.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1236448.0, 909652.0, 1239440.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.292581
Client Index = 12	Epoch: 1	Loss: 0.353838
Client Index = 12	Epoch: 2	Loss: 0.208784
Client Index = 12	Epoch: 3	Loss: 0.280944
Client Index = 12	Epoch: 4	Loss: 0.147765
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 13
local mask changes: 909744.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1240218.0, 909744.0, 1238704.0]
Doing local aggregation!
test acc on this client before 403 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.270870
Client Index = 13	Epoch: 1	Loss: 0.270978
Client Index = 13	Epoch: 2	Loss: 0.122002
Client Index = 13	Epoch: 3	Loss: 0.119664
Client Index = 13	Epoch: 4	Loss: 0.150190
test acc on this client after 362 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 14
local mask changes: 909566.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1236582.0, 909566.0, 1235080.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.332386
Client Index = 14	Epoch: 1	Loss: 0.169853
Client Index = 14	Epoch: 2	Loss: 0.136190
Client Index = 14	Epoch: 3	Loss: 0.326842
Client Index = 14	Epoch: 4	Loss: 0.220691
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 15
local mask changes: 909086.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1234368.0, 909086.0, 1231622.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.249776
Client Index = 15	Epoch: 1	Loss: 0.218806
Client Index = 15	Epoch: 2	Loss: 0.265969
Client Index = 15	Epoch: 3	Loss: 0.147488
Client Index = 15	Epoch: 4	Loss: 0.116935
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 16
local mask changes: 909390.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1233326.0, 909390.0, 1237618.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.379178
Client Index = 16	Epoch: 1	Loss: 0.165146
Client Index = 16	Epoch: 2	Loss: 0.194709
Client Index = 16	Epoch: 3	Loss: 0.177077
Client Index = 16	Epoch: 4	Loss: 0.170734
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 17
local mask changes: 909196.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1239086.0, 909196.0, 1240548.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.410716
Client Index = 17	Epoch: 1	Loss: 0.356725
Client Index = 17	Epoch: 2	Loss: 0.227175
Client Index = 17	Epoch: 3	Loss: 0.368188
Client Index = 17	Epoch: 4	Loss: 0.203270
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 18
local mask changes: 909260.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1238834.0, 909260.0, 1233890.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.199693
Client Index = 18	Epoch: 1	Loss: 0.396766
Client Index = 18	Epoch: 2	Loss: 0.150084
Client Index = 18	Epoch: 3	Loss: 0.089972
Client Index = 18	Epoch: 4	Loss: 0.088469
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 19
local mask changes: 909222.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1238658.0, 1235130.0, 909222.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.362096
Client Index = 19	Epoch: 1	Loss: 0.217943
Client Index = 19	Epoch: 2	Loss: 0.257847
Client Index = 19	Epoch: 3	Loss: 0.145281
Client Index = 19	Epoch: 4	Loss: 0.176268
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.22266392681701105}
################local_test_on_all_clients after local training in communication round: 69
{'test_acc_after': 0.7825708527673954, 'test_loss_after': 0.824668969649505}
################local_test_on_all_clients before local training in communication round: 69
{'test_acc_before': 0.7824694535782316, 'test_loss_before': 0.7472662123086315}
################Communication round : 70
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 0
local mask changes: 863228.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [863228.0, 1200328.0, 1202616.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 0	Epoch: 0	Loss: 0.275485
Client Index = 0	Epoch: 1	Loss: 0.160427
Client Index = 0	Epoch: 2	Loss: 0.197421
Client Index = 0	Epoch: 3	Loss: 0.244937
Client Index = 0	Epoch: 4	Loss: 0.189988
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 1
local mask changes: 863330.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1199316.0, 863330.0, 1192718.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 1	Epoch: 0	Loss: 0.178125
Client Index = 1	Epoch: 1	Loss: 0.097473
Client Index = 1	Epoch: 2	Loss: 0.135108
Client Index = 1	Epoch: 3	Loss: 0.109075
Client Index = 1	Epoch: 4	Loss: 0.075421
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 2
local mask changes: 863294.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1190146.0, 863294.0, 1193738.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.122140
Client Index = 2	Epoch: 1	Loss: 0.077223
Client Index = 2	Epoch: 2	Loss: 0.062829
Client Index = 2	Epoch: 3	Loss: 0.076023
Client Index = 2	Epoch: 4	Loss: 0.068004
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 3
local mask changes: 863640.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1197716.0, 863640.0, 1203310.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.144336
Client Index = 3	Epoch: 1	Loss: 0.121483
Client Index = 3	Epoch: 2	Loss: 0.358182
Client Index = 3	Epoch: 3	Loss: 0.115151
Client Index = 3	Epoch: 4	Loss: 0.094126
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 4
local mask changes: 863296.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1204380.0, 863296.0, 1206996.0]
Doing local aggregation!
test acc on this client before 363 / 504 : 0.72
Client Index = 4	Epoch: 0	Loss: 0.230458
Client Index = 4	Epoch: 1	Loss: 0.188346
Client Index = 4	Epoch: 2	Loss: 0.252534
Client Index = 4	Epoch: 3	Loss: 0.180118
Client Index = 4	Epoch: 4	Loss: 0.234632
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 5
local mask changes: 863452.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1208418.0, 863452.0, 1210746.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.318428
Client Index = 5	Epoch: 1	Loss: 0.224126
Client Index = 5	Epoch: 2	Loss: 0.220244
Client Index = 5	Epoch: 3	Loss: 0.203247
Client Index = 5	Epoch: 4	Loss: 0.126509
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 6
local mask changes: 864116.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1211572.0, 864116.0, 1211218.0]
Doing local aggregation!
test acc on this client before 341 / 505 : 0.68
Client Index = 6	Epoch: 0	Loss: 0.339818
Client Index = 6	Epoch: 1	Loss: 0.209704
Client Index = 6	Epoch: 2	Loss: 0.210810
Client Index = 6	Epoch: 3	Loss: 0.135090
Client Index = 6	Epoch: 4	Loss: 0.429149
test acc on this client after 364 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 7
local mask changes: 863490.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1212304.0, 863490.0, 1205084.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.459939
Client Index = 7	Epoch: 1	Loss: 0.435885
Client Index = 7	Epoch: 2	Loss: 0.322999
Client Index = 7	Epoch: 3	Loss: 0.320864
Client Index = 7	Epoch: 4	Loss: 0.387349
test acc on this client after 318 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 8
local mask changes: 863114.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1197888.0, 863114.0, 1193624.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.126526
Client Index = 8	Epoch: 1	Loss: 0.084743
Client Index = 8	Epoch: 2	Loss: 0.041625
Client Index = 8	Epoch: 3	Loss: 0.035951
Client Index = 8	Epoch: 4	Loss: 0.025574
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 9
local mask changes: 863728.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1197376.0, 863728.0, 1205276.0]
Doing local aggregation!
test acc on this client before 372 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.549121
Client Index = 9	Epoch: 1	Loss: 0.215582
Client Index = 9	Epoch: 2	Loss: 0.202521
Client Index = 9	Epoch: 3	Loss: 0.303324
Client Index = 9	Epoch: 4	Loss: 0.164617
test acc on this client after 358 / 506 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 10
local mask changes: 863898.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1206548.0, 863898.0, 1201230.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.376255
Client Index = 10	Epoch: 1	Loss: 0.335244
Client Index = 10	Epoch: 2	Loss: 0.215445
Client Index = 10	Epoch: 3	Loss: 0.234632
Client Index = 10	Epoch: 4	Loss: 0.313290
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 11
local mask changes: 863644.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1198240.0, 863644.0, 1198224.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.443579
Client Index = 11	Epoch: 1	Loss: 0.113847
Client Index = 11	Epoch: 2	Loss: 0.082051
Client Index = 11	Epoch: 3	Loss: 0.075459
Client Index = 11	Epoch: 4	Loss: 0.069518
test acc on this client after 427 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 12
local mask changes: 863682.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1200926.0, 863682.0, 1205016.0]
Doing local aggregation!
test acc on this client before 364 / 504 : 0.72
Client Index = 12	Epoch: 0	Loss: 0.367355
Client Index = 12	Epoch: 1	Loss: 0.203683
Client Index = 12	Epoch: 2	Loss: 0.201732
Client Index = 12	Epoch: 3	Loss: 0.178866
Client Index = 12	Epoch: 4	Loss: 0.212042
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 13
local mask changes: 863388.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1204788.0, 863388.0, 1203932.0]
Doing local aggregation!
test acc on this client before 405 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.178935
Client Index = 13	Epoch: 1	Loss: 0.364629
Client Index = 13	Epoch: 2	Loss: 0.149027
Client Index = 13	Epoch: 3	Loss: 0.102751
Client Index = 13	Epoch: 4	Loss: 0.195228
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 14
local mask changes: 863176.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1200906.0, 863176.0, 1198934.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.333027
Client Index = 14	Epoch: 1	Loss: 0.198322
Client Index = 14	Epoch: 2	Loss: 0.164933
Client Index = 14	Epoch: 3	Loss: 0.159711
Client Index = 14	Epoch: 4	Loss: 0.138886
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 15
local mask changes: 863658.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1197060.0, 863658.0, 1195868.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.357111
Client Index = 15	Epoch: 1	Loss: 0.162793
Client Index = 15	Epoch: 2	Loss: 0.163827
Client Index = 15	Epoch: 3	Loss: 0.156706
Client Index = 15	Epoch: 4	Loss: 0.270642
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 16
local mask changes: 863900.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1196134.0, 863900.0, 1201016.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 16	Epoch: 0	Loss: 0.271580
Client Index = 16	Epoch: 1	Loss: 0.143309
Client Index = 16	Epoch: 2	Loss: 0.449240
Client Index = 16	Epoch: 3	Loss: 0.159036
Client Index = 16	Epoch: 4	Loss: 0.236075
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 17
local mask changes: 864242.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1203886.0, 864242.0, 1205094.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.454819
Client Index = 17	Epoch: 1	Loss: 0.312872
Client Index = 17	Epoch: 2	Loss: 0.247160
Client Index = 17	Epoch: 3	Loss: 0.259760
Client Index = 17	Epoch: 4	Loss: 0.210516
test acc on this client after 302 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 18
local mask changes: 862842.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1203236.0, 862842.0, 1198986.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.259017
Client Index = 18	Epoch: 1	Loss: 0.261717
Client Index = 18	Epoch: 2	Loss: 0.125818
Client Index = 18	Epoch: 3	Loss: 0.091604
Client Index = 18	Epoch: 4	Loss: 0.101219
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 19
local mask changes: 863710.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1203056.0, 1198780.0, 863710.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.345321
Client Index = 19	Epoch: 1	Loss: 0.193272
Client Index = 19	Epoch: 2	Loss: 0.243298
Client Index = 19	Epoch: 3	Loss: 0.145993
Client Index = 19	Epoch: 4	Loss: 0.114074
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.21228014492057262}
################local_test_on_all_clients after local training in communication round: 70
{'test_acc_after': 0.7688598296887467, 'test_loss_after': 0.8674061434650389}
################local_test_on_all_clients before local training in communication round: 70
{'test_acc_before': 0.7826779350570054, 'test_loss_before': 0.7455967275300732}
################Communication round : 71
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 0
local mask changes: 817880.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [817880.0, 1165900.0, 1167634.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.359470
Client Index = 0	Epoch: 1	Loss: 0.150182
Client Index = 0	Epoch: 2	Loss: 0.241486
Client Index = 0	Epoch: 3	Loss: 0.111322
Client Index = 0	Epoch: 4	Loss: 0.121756
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 1
local mask changes: 818292.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1162766.0, 818292.0, 1155064.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.249437
Client Index = 1	Epoch: 1	Loss: 0.079877
Client Index = 1	Epoch: 2	Loss: 0.104586
Client Index = 1	Epoch: 3	Loss: 0.377870
Client Index = 1	Epoch: 4	Loss: 0.073615
test acc on this client after 439 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 2
local mask changes: 816524.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1155082.0, 816524.0, 1159954.0]
Doing local aggregation!
test acc on this client before 434 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.066052
Client Index = 2	Epoch: 1	Loss: 0.077153
Client Index = 2	Epoch: 2	Loss: 0.080746
Client Index = 2	Epoch: 3	Loss: 0.068860
Client Index = 2	Epoch: 4	Loss: 0.042499
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 3
local mask changes: 817532.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1161958.0, 817532.0, 1168390.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.187334
Client Index = 3	Epoch: 1	Loss: 0.106991
Client Index = 3	Epoch: 2	Loss: 0.121166
Client Index = 3	Epoch: 3	Loss: 0.318041
Client Index = 3	Epoch: 4	Loss: 0.081242
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 4
local mask changes: 818364.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1172356.0, 818364.0, 1173294.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.302673
Client Index = 4	Epoch: 1	Loss: 0.317036
Client Index = 4	Epoch: 2	Loss: 0.150742
Client Index = 4	Epoch: 3	Loss: 0.186699
Client Index = 4	Epoch: 4	Loss: 0.145739
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 5
local mask changes: 817576.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1173684.0, 817576.0, 1175976.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 5	Epoch: 0	Loss: 0.336029
Client Index = 5	Epoch: 1	Loss: 0.197553
Client Index = 5	Epoch: 2	Loss: 0.188785
Client Index = 5	Epoch: 3	Loss: 0.262140
Client Index = 5	Epoch: 4	Loss: 0.221302
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 6
local mask changes: 818346.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1178784.0, 818346.0, 1178642.0]
Doing local aggregation!
test acc on this client before 382 / 505 : 0.76
Client Index = 6	Epoch: 0	Loss: 0.284908
Client Index = 6	Epoch: 1	Loss: 0.257282
Client Index = 6	Epoch: 2	Loss: 0.307019
Client Index = 6	Epoch: 3	Loss: 0.158277
Client Index = 6	Epoch: 4	Loss: 0.320425
test acc on this client after 366 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 7
local mask changes: 817418.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1177392.0, 817418.0, 1169350.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 7	Epoch: 0	Loss: 0.422993
Client Index = 7	Epoch: 1	Loss: 0.455209
Client Index = 7	Epoch: 2	Loss: 0.330376
Client Index = 7	Epoch: 3	Loss: 0.414796
Client Index = 7	Epoch: 4	Loss: 0.275306
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 8
local mask changes: 817582.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1163806.0, 817582.0, 1158238.0]
Doing local aggregation!
test acc on this client before 463 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.140640
Client Index = 8	Epoch: 1	Loss: 0.070065
Client Index = 8	Epoch: 2	Loss: 0.036610
Client Index = 8	Epoch: 3	Loss: 0.026250
Client Index = 8	Epoch: 4	Loss: 0.137835
test acc on this client after 462 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 9
local mask changes: 817538.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1160802.0, 817538.0, 1171268.0]
Doing local aggregation!
test acc on this client before 354 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.442021
Client Index = 9	Epoch: 1	Loss: 0.181382
Client Index = 9	Epoch: 2	Loss: 0.164883
Client Index = 9	Epoch: 3	Loss: 0.167078
Client Index = 9	Epoch: 4	Loss: 0.477345
test acc on this client after 369 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 10
local mask changes: 818056.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1171688.0, 818056.0, 1166064.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.248146
Client Index = 10	Epoch: 1	Loss: 0.433300
Client Index = 10	Epoch: 2	Loss: 0.281318
Client Index = 10	Epoch: 3	Loss: 0.214134
Client Index = 10	Epoch: 4	Loss: 0.219380
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 11
local mask changes: 817366.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1163562.0, 817366.0, 1162670.0]
Doing local aggregation!
test acc on this client before 407 / 505 : 0.81
Client Index = 11	Epoch: 0	Loss: 0.173988
Client Index = 11	Epoch: 1	Loss: 0.159783
Client Index = 11	Epoch: 2	Loss: 0.085167
Client Index = 11	Epoch: 3	Loss: 0.264394
Client Index = 11	Epoch: 4	Loss: 0.054476
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 12
local mask changes: 818260.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1165308.0, 818260.0, 1170044.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.290522
Client Index = 12	Epoch: 1	Loss: 0.359437
Client Index = 12	Epoch: 2	Loss: 0.153901
Client Index = 12	Epoch: 3	Loss: 0.193603
Client Index = 12	Epoch: 4	Loss: 0.131678
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 13
local mask changes: 817758.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1168252.0, 817758.0, 1167290.0]
Doing local aggregation!
test acc on this client before 411 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.344029
Client Index = 13	Epoch: 1	Loss: 0.282073
Client Index = 13	Epoch: 2	Loss: 0.132586
Client Index = 13	Epoch: 3	Loss: 0.118805
Client Index = 13	Epoch: 4	Loss: 0.183314
test acc on this client after 417 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 14
local mask changes: 818004.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1166742.0, 818004.0, 1163692.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.310039
Client Index = 14	Epoch: 1	Loss: 0.162951
Client Index = 14	Epoch: 2	Loss: 0.369712
Client Index = 14	Epoch: 3	Loss: 0.146826
Client Index = 14	Epoch: 4	Loss: 0.240025
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 15
local mask changes: 817542.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1162310.0, 817542.0, 1160658.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.239867
Client Index = 15	Epoch: 1	Loss: 0.190322
Client Index = 15	Epoch: 2	Loss: 0.164266
Client Index = 15	Epoch: 3	Loss: 0.165124
Client Index = 15	Epoch: 4	Loss: 0.113257
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 16
local mask changes: 818188.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1161928.0, 818188.0, 1166740.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 16	Epoch: 0	Loss: 0.290536
Client Index = 16	Epoch: 1	Loss: 0.269993
Client Index = 16	Epoch: 2	Loss: 0.175796
Client Index = 16	Epoch: 3	Loss: 0.185211
Client Index = 16	Epoch: 4	Loss: 0.513805
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 17
local mask changes: 818782.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1168302.0, 818782.0, 1170464.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.473681
Client Index = 17	Epoch: 1	Loss: 0.229448
Client Index = 17	Epoch: 2	Loss: 0.285640
Client Index = 17	Epoch: 3	Loss: 0.263573
Client Index = 17	Epoch: 4	Loss: 0.164549
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 18
local mask changes: 817760.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1167092.0, 817760.0, 1161984.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.369907
Client Index = 18	Epoch: 1	Loss: 0.129655
Client Index = 18	Epoch: 2	Loss: 0.121581
Client Index = 18	Epoch: 3	Loss: 0.121891
Client Index = 18	Epoch: 4	Loss: 0.162228
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 19
local mask changes: 818298.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1167056.0, 1163142.0, 818298.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.371344
Client Index = 19	Epoch: 1	Loss: 0.226558
Client Index = 19	Epoch: 2	Loss: 0.162063
Client Index = 19	Epoch: 3	Loss: 0.170207
Client Index = 19	Epoch: 4	Loss: 0.111802
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.21624972310825247}
################local_test_on_all_clients after local training in communication round: 71
{'test_acc_after': 0.799434777717674, 'test_loss_after': 0.7351396084549692}
################local_test_on_all_clients before local training in communication round: 71
{'test_acc_before': 0.780375869801766, 'test_loss_before': 0.7674548920358067}
################Communication round : 72
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 0
local mask changes: 772720.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [772720.0, 1130178.0, 1132072.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 0	Epoch: 0	Loss: 0.556673
Client Index = 0	Epoch: 1	Loss: 0.186883
Client Index = 0	Epoch: 2	Loss: 0.249643
Client Index = 0	Epoch: 3	Loss: 0.110446
Client Index = 0	Epoch: 4	Loss: 0.269617
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 1
local mask changes: 772780.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1129200.0, 772780.0, 1121634.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.141327
Client Index = 1	Epoch: 1	Loss: 0.174586
Client Index = 1	Epoch: 2	Loss: 0.088958
Client Index = 1	Epoch: 3	Loss: 0.074888
Client Index = 1	Epoch: 4	Loss: 0.047191
test acc on this client after 444 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 2
local mask changes: 772924.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1119600.0, 772924.0, 1125710.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.050425
Client Index = 2	Epoch: 1	Loss: 0.068893
Client Index = 2	Epoch: 2	Loss: 0.116009
Client Index = 2	Epoch: 3	Loss: 0.044157
Client Index = 2	Epoch: 4	Loss: 0.238729
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 3
local mask changes: 772886.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1126386.0, 772886.0, 1134330.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.145015
Client Index = 3	Epoch: 1	Loss: 0.248177
Client Index = 3	Epoch: 2	Loss: 0.159929
Client Index = 3	Epoch: 3	Loss: 0.056186
Client Index = 3	Epoch: 4	Loss: 0.067397
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 4
local mask changes: 772748.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1137318.0, 772748.0, 1138920.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.304567
Client Index = 4	Epoch: 1	Loss: 0.180603
Client Index = 4	Epoch: 2	Loss: 0.114506
Client Index = 4	Epoch: 3	Loss: 0.174427
Client Index = 4	Epoch: 4	Loss: 0.084586
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 5
local mask changes: 773616.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1139300.0, 773616.0, 1141976.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.313571
Client Index = 5	Epoch: 1	Loss: 0.272590
Client Index = 5	Epoch: 2	Loss: 0.243668
Client Index = 5	Epoch: 3	Loss: 0.147344
Client Index = 5	Epoch: 4	Loss: 0.229816
test acc on this client after 316 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 6
local mask changes: 772732.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1144322.0, 772732.0, 1144540.0]
Doing local aggregation!
test acc on this client before 376 / 505 : 0.74
Client Index = 6	Epoch: 0	Loss: 0.229546
Client Index = 6	Epoch: 1	Loss: 0.402617
Client Index = 6	Epoch: 2	Loss: 0.155891
Client Index = 6	Epoch: 3	Loss: 0.428403
Client Index = 6	Epoch: 4	Loss: 0.156223
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 7
local mask changes: 772748.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1143772.0, 772748.0, 1134270.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.374484
Client Index = 7	Epoch: 1	Loss: 0.267103
Client Index = 7	Epoch: 2	Loss: 0.410414
Client Index = 7	Epoch: 3	Loss: 0.513211
Client Index = 7	Epoch: 4	Loss: 0.239950
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 8
local mask changes: 772886.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1129238.0, 772886.0, 1123358.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.064927
Client Index = 8	Epoch: 1	Loss: 0.092386
Client Index = 8	Epoch: 2	Loss: 0.071757
Client Index = 8	Epoch: 3	Loss: 0.023758
Client Index = 8	Epoch: 4	Loss: 0.025435
test acc on this client after 462 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 9
local mask changes: 772336.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1128668.0, 772336.0, 1138412.0]
Doing local aggregation!
test acc on this client before 379 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.247309
Client Index = 9	Epoch: 1	Loss: 0.240407
Client Index = 9	Epoch: 2	Loss: 0.245040
Client Index = 9	Epoch: 3	Loss: 0.207392
Client Index = 9	Epoch: 4	Loss: 0.156933
test acc on this client after 382 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 10
local mask changes: 772206.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1136984.0, 772206.0, 1132150.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.307027
Client Index = 10	Epoch: 1	Loss: 0.210272
Client Index = 10	Epoch: 2	Loss: 0.319216
Client Index = 10	Epoch: 3	Loss: 0.141124
Client Index = 10	Epoch: 4	Loss: 0.288391
test acc on this client after 349 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 11
local mask changes: 772550.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1130462.0, 772550.0, 1128572.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 11	Epoch: 0	Loss: 0.415081
Client Index = 11	Epoch: 1	Loss: 0.091157
Client Index = 11	Epoch: 2	Loss: 0.084887
Client Index = 11	Epoch: 3	Loss: 0.057926
Client Index = 11	Epoch: 4	Loss: 0.056786
test acc on this client after 428 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 12
local mask changes: 772862.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1130558.0, 772862.0, 1135442.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.383492
Client Index = 12	Epoch: 1	Loss: 0.241172
Client Index = 12	Epoch: 2	Loss: 0.146969
Client Index = 12	Epoch: 3	Loss: 0.188036
Client Index = 12	Epoch: 4	Loss: 0.131787
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 13
local mask changes: 772370.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1134056.0, 772370.0, 1131854.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.232790
Client Index = 13	Epoch: 1	Loss: 0.123468
Client Index = 13	Epoch: 2	Loss: 0.244385
Client Index = 13	Epoch: 3	Loss: 0.362182
Client Index = 13	Epoch: 4	Loss: 0.088317
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 14
local mask changes: 773162.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1131562.0, 773162.0, 1128834.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.342010
Client Index = 14	Epoch: 1	Loss: 0.248930
Client Index = 14	Epoch: 2	Loss: 0.295969
Client Index = 14	Epoch: 3	Loss: 0.136246
Client Index = 14	Epoch: 4	Loss: 0.116352
test acc on this client after 369 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 15
local mask changes: 772912.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1127460.0, 772912.0, 1126498.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.241373
Client Index = 15	Epoch: 1	Loss: 0.189458
Client Index = 15	Epoch: 2	Loss: 0.193761
Client Index = 15	Epoch: 3	Loss: 0.150895
Client Index = 15	Epoch: 4	Loss: 0.370790
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 16
local mask changes: 772484.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1128244.0, 772484.0, 1133032.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 16	Epoch: 0	Loss: 0.280817
Client Index = 16	Epoch: 1	Loss: 0.256936
Client Index = 16	Epoch: 2	Loss: 0.231651
Client Index = 16	Epoch: 3	Loss: 0.288510
Client Index = 16	Epoch: 4	Loss: 0.093990
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 17
local mask changes: 772942.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1132516.0, 772942.0, 1135102.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 17	Epoch: 0	Loss: 0.429912
Client Index = 17	Epoch: 1	Loss: 0.355369
Client Index = 17	Epoch: 2	Loss: 0.328627
Client Index = 17	Epoch: 3	Loss: 0.254704
Client Index = 17	Epoch: 4	Loss: 0.124736
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 18
local mask changes: 772440.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1134304.0, 772440.0, 1128344.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.384058
Client Index = 18	Epoch: 1	Loss: 0.230719
Client Index = 18	Epoch: 2	Loss: 0.084246
Client Index = 18	Epoch: 3	Loss: 0.065474
Client Index = 18	Epoch: 4	Loss: 0.166268
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 19
local mask changes: 772564.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1132538.0, 1127000.0, 772564.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.288606
Client Index = 19	Epoch: 1	Loss: 0.332280
Client Index = 19	Epoch: 2	Loss: 0.261720
Client Index = 19	Epoch: 3	Loss: 0.136953
Client Index = 19	Epoch: 4	Loss: 0.180036
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2088985274579609}
################local_test_on_all_clients after local training in communication round: 72
{'test_acc_after': 0.7804467492039574, 'test_loss_after': 0.8289442546119355}
################local_test_on_all_clients before local training in communication round: 72
{'test_acc_before': 0.7916854606706487, 'test_loss_before': 0.7148871427408414}
################Communication round : 73
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 0
local mask changes: 728136.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [728136.0, 1097744.0, 1098948.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.164545
Client Index = 0	Epoch: 1	Loss: 0.339908
Client Index = 0	Epoch: 2	Loss: 0.125475
Client Index = 0	Epoch: 3	Loss: 0.282891
Client Index = 0	Epoch: 4	Loss: 0.092450
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 1
local mask changes: 728618.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1094174.0, 728618.0, 1087486.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 1	Epoch: 0	Loss: 0.191910
Client Index = 1	Epoch: 1	Loss: 0.063421
Client Index = 1	Epoch: 2	Loss: 0.449536
Client Index = 1	Epoch: 3	Loss: 0.090980
Client Index = 1	Epoch: 4	Loss: 0.243969
test acc on this client after 443 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 2
local mask changes: 728006.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1087954.0, 728006.0, 1093154.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.065841
Client Index = 2	Epoch: 1	Loss: 0.114340
Client Index = 2	Epoch: 2	Loss: 0.075638
Client Index = 2	Epoch: 3	Loss: 0.057026
Client Index = 2	Epoch: 4	Loss: 0.031267
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 3
local mask changes: 728190.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1091514.0, 728190.0, 1100486.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.116928
Client Index = 3	Epoch: 1	Loss: 0.409213
Client Index = 3	Epoch: 2	Loss: 0.096642
Client Index = 3	Epoch: 3	Loss: 0.073397
Client Index = 3	Epoch: 4	Loss: 0.063372
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 4
local mask changes: 727642.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1100888.0, 727642.0, 1103640.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.399866
Client Index = 4	Epoch: 1	Loss: 0.144946
Client Index = 4	Epoch: 2	Loss: 0.120292
Client Index = 4	Epoch: 3	Loss: 0.204931
Client Index = 4	Epoch: 4	Loss: 0.297567
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 5
local mask changes: 727938.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1105940.0, 727938.0, 1109568.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 5	Epoch: 0	Loss: 0.371103
Client Index = 5	Epoch: 1	Loss: 0.244830
Client Index = 5	Epoch: 2	Loss: 0.216604
Client Index = 5	Epoch: 3	Loss: 0.207067
Client Index = 5	Epoch: 4	Loss: 0.433799
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 6
local mask changes: 728790.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1110070.0, 728790.0, 1111368.0]
Doing local aggregation!
test acc on this client before 380 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.179964
Client Index = 6	Epoch: 1	Loss: 0.375652
Client Index = 6	Epoch: 2	Loss: 0.284462
Client Index = 6	Epoch: 3	Loss: 0.161039
Client Index = 6	Epoch: 4	Loss: 0.128400
test acc on this client after 369 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 7
local mask changes: 728010.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1109368.0, 728010.0, 1100190.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.491694
Client Index = 7	Epoch: 1	Loss: 0.314325
Client Index = 7	Epoch: 2	Loss: 0.339785
Client Index = 7	Epoch: 3	Loss: 0.246973
Client Index = 7	Epoch: 4	Loss: 0.316234
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 8
local mask changes: 728122.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1094808.0, 728122.0, 1090890.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.067868
Client Index = 8	Epoch: 1	Loss: 0.054288
Client Index = 8	Epoch: 2	Loss: 0.217354
Client Index = 8	Epoch: 3	Loss: 0.052121
Client Index = 8	Epoch: 4	Loss: 0.026588
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 9
local mask changes: 728512.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1095428.0, 728512.0, 1103676.0]
Doing local aggregation!
test acc on this client before 374 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.251099
Client Index = 9	Epoch: 1	Loss: 0.160908
Client Index = 9	Epoch: 2	Loss: 0.343203
Client Index = 9	Epoch: 3	Loss: 0.130430
Client Index = 9	Epoch: 4	Loss: 0.286639
test acc on this client after 379 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 10
local mask changes: 728306.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1104650.0, 728306.0, 1098610.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.270768
Client Index = 10	Epoch: 1	Loss: 0.356998
Client Index = 10	Epoch: 2	Loss: 0.159323
Client Index = 10	Epoch: 3	Loss: 0.164706
Client Index = 10	Epoch: 4	Loss: 0.214049
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 11
local mask changes: 728478.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1094932.0, 728478.0, 1093964.0]
Doing local aggregation!
test acc on this client before 404 / 505 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.185427
Client Index = 11	Epoch: 1	Loss: 0.154284
Client Index = 11	Epoch: 2	Loss: 0.105353
Client Index = 11	Epoch: 3	Loss: 0.068131
Client Index = 11	Epoch: 4	Loss: 0.034610
test acc on this client after 434 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 12
local mask changes: 728844.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1096616.0, 728844.0, 1101808.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.327336
Client Index = 12	Epoch: 1	Loss: 0.274831
Client Index = 12	Epoch: 2	Loss: 0.111121
Client Index = 12	Epoch: 3	Loss: 0.245767
Client Index = 12	Epoch: 4	Loss: 0.324832
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 13
local mask changes: 728114.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1100916.0, 728114.0, 1098552.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.159454
Client Index = 13	Epoch: 1	Loss: 0.390227
Client Index = 13	Epoch: 2	Loss: 0.130875
Client Index = 13	Epoch: 3	Loss: 0.115488
Client Index = 13	Epoch: 4	Loss: 0.165341
test acc on this client after 379 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 14
local mask changes: 728424.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1098400.0, 728424.0, 1094790.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.283710
Client Index = 14	Epoch: 1	Loss: 0.286946
Client Index = 14	Epoch: 2	Loss: 0.162225
Client Index = 14	Epoch: 3	Loss: 0.135636
Client Index = 14	Epoch: 4	Loss: 0.248774
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 15
local mask changes: 728372.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1094724.0, 728372.0, 1095412.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.260914
Client Index = 15	Epoch: 1	Loss: 0.165139
Client Index = 15	Epoch: 2	Loss: 0.144738
Client Index = 15	Epoch: 3	Loss: 0.222452
Client Index = 15	Epoch: 4	Loss: 0.151144
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 16
local mask changes: 728954.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1094124.0, 728954.0, 1099038.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 16	Epoch: 0	Loss: 0.266311
Client Index = 16	Epoch: 1	Loss: 0.200362
Client Index = 16	Epoch: 2	Loss: 0.196615
Client Index = 16	Epoch: 3	Loss: 0.192753
Client Index = 16	Epoch: 4	Loss: 0.110642
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 17
local mask changes: 728400.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1100726.0, 728400.0, 1101914.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.408309
Client Index = 17	Epoch: 1	Loss: 0.280821
Client Index = 17	Epoch: 2	Loss: 0.278566
Client Index = 17	Epoch: 3	Loss: 0.229783
Client Index = 17	Epoch: 4	Loss: 0.228276
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 18
local mask changes: 728270.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1100780.0, 728270.0, 1095224.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.415545
Client Index = 18	Epoch: 1	Loss: 0.129494
Client Index = 18	Epoch: 2	Loss: 0.111542
Client Index = 18	Epoch: 3	Loss: 0.254356
Client Index = 18	Epoch: 4	Loss: 0.120379
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 19
local mask changes: 728236.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1099480.0, 1095398.0, 728236.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.236924
Client Index = 19	Epoch: 1	Loss: 0.228259
Client Index = 19	Epoch: 2	Loss: 0.168435
Client Index = 19	Epoch: 3	Loss: 0.307832
Client Index = 19	Epoch: 4	Loss: 0.128430
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2073301681485027}
################local_test_on_all_clients after local training in communication round: 73
{'test_acc_after': 0.7935810090369028, 'test_loss_after': 0.7638235240853375}
################local_test_on_all_clients before local training in communication round: 73
{'test_acc_before': 0.7866263055664198, 'test_loss_before': 0.7455907936019882}
################Communication round : 74
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 0
local mask changes: 684522.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [684522.0, 1063492.0, 1066002.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.296475
Client Index = 0	Epoch: 1	Loss: 0.186994
Client Index = 0	Epoch: 2	Loss: 0.161992
Client Index = 0	Epoch: 3	Loss: 0.086660
Client Index = 0	Epoch: 4	Loss: 0.126003
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 1
local mask changes: 684164.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1063196.0, 684164.0, 1057416.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.107801
Client Index = 1	Epoch: 1	Loss: 0.093130
Client Index = 1	Epoch: 2	Loss: 0.083004
Client Index = 1	Epoch: 3	Loss: 0.063870
Client Index = 1	Epoch: 4	Loss: 0.444886
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 2
local mask changes: 684776.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1053774.0, 684776.0, 1058172.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.059245
Client Index = 2	Epoch: 1	Loss: 0.042531
Client Index = 2	Epoch: 2	Loss: 0.087645
Client Index = 2	Epoch: 3	Loss: 0.282616
Client Index = 2	Epoch: 4	Loss: 0.043438
test acc on this client after 444 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 3
local mask changes: 684604.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1059870.0, 684604.0, 1065472.0]
Doing local aggregation!
test acc on this client before 427 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.118202
Client Index = 3	Epoch: 1	Loss: 0.386310
Client Index = 3	Epoch: 2	Loss: 0.102868
Client Index = 3	Epoch: 3	Loss: 0.108559
Client Index = 3	Epoch: 4	Loss: 0.055590
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 4
local mask changes: 684150.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1068480.0, 684150.0, 1072270.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.354410
Client Index = 4	Epoch: 1	Loss: 0.192457
Client Index = 4	Epoch: 2	Loss: 0.163779
Client Index = 4	Epoch: 3	Loss: 0.222493
Client Index = 4	Epoch: 4	Loss: 0.146270
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 5
local mask changes: 684388.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1075024.0, 684388.0, 1078744.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.231778
Client Index = 5	Epoch: 1	Loss: 0.322849
Client Index = 5	Epoch: 2	Loss: 0.195027
Client Index = 5	Epoch: 3	Loss: 0.167924
Client Index = 5	Epoch: 4	Loss: 0.185983
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 6
local mask changes: 684064.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1077282.0, 684064.0, 1077206.0]
Doing local aggregation!
test acc on this client before 390 / 505 : 0.77
Client Index = 6	Epoch: 0	Loss: 0.189661
Client Index = 6	Epoch: 1	Loss: 0.219224
Client Index = 6	Epoch: 2	Loss: 0.225092
Client Index = 6	Epoch: 3	Loss: 0.244679
Client Index = 6	Epoch: 4	Loss: 0.250372
test acc on this client after 355 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 7
local mask changes: 685074.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1077626.0, 685074.0, 1066502.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.425141
Client Index = 7	Epoch: 1	Loss: 0.364225
Client Index = 7	Epoch: 2	Loss: 0.397095
Client Index = 7	Epoch: 3	Loss: 0.348118
Client Index = 7	Epoch: 4	Loss: 0.186751
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 8
local mask changes: 684356.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1061886.0, 684356.0, 1059006.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.067199
Client Index = 8	Epoch: 1	Loss: 0.048895
Client Index = 8	Epoch: 2	Loss: 0.043644
Client Index = 8	Epoch: 3	Loss: 0.023815
Client Index = 8	Epoch: 4	Loss: 0.131472
test acc on this client after 463 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 9
local mask changes: 684460.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1061814.0, 684460.0, 1070890.0]
Doing local aggregation!
test acc on this client before 377 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.195542
Client Index = 9	Epoch: 1	Loss: 0.291892
Client Index = 9	Epoch: 2	Loss: 0.265496
Client Index = 9	Epoch: 3	Loss: 0.153563
Client Index = 9	Epoch: 4	Loss: 0.180335
test acc on this client after 339 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 10
local mask changes: 684756.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1071094.0, 684756.0, 1065318.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.235585
Client Index = 10	Epoch: 1	Loss: 0.357345
Client Index = 10	Epoch: 2	Loss: 0.211103
Client Index = 10	Epoch: 3	Loss: 0.403231
Client Index = 10	Epoch: 4	Loss: 0.132643
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 11
local mask changes: 684960.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1061858.0, 684960.0, 1060464.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 11	Epoch: 0	Loss: 0.386565
Client Index = 11	Epoch: 1	Loss: 0.108168
Client Index = 11	Epoch: 2	Loss: 0.083338
Client Index = 11	Epoch: 3	Loss: 0.059626
Client Index = 11	Epoch: 4	Loss: 0.073440
test acc on this client after 436 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 12
local mask changes: 684388.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1063630.0, 684388.0, 1069064.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.409375
Client Index = 12	Epoch: 1	Loss: 0.134589
Client Index = 12	Epoch: 2	Loss: 0.406236
Client Index = 12	Epoch: 3	Loss: 0.182048
Client Index = 12	Epoch: 4	Loss: 0.098456
test acc on this client after 379 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 13
local mask changes: 684480.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1068740.0, 684480.0, 1066154.0]
Doing local aggregation!
test acc on this client before 413 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.241425
Client Index = 13	Epoch: 1	Loss: 0.166612
Client Index = 13	Epoch: 2	Loss: 0.131187
Client Index = 13	Epoch: 3	Loss: 0.150986
Client Index = 13	Epoch: 4	Loss: 0.133340
test acc on this client after 373 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 14
local mask changes: 684946.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1065598.0, 684946.0, 1063190.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.336771
Client Index = 14	Epoch: 1	Loss: 0.159174
Client Index = 14	Epoch: 2	Loss: 0.259164
Client Index = 14	Epoch: 3	Loss: 0.097629
Client Index = 14	Epoch: 4	Loss: 0.140048
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 15
local mask changes: 684906.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1061856.0, 684906.0, 1062052.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.168119
Client Index = 15	Epoch: 1	Loss: 0.235791
Client Index = 15	Epoch: 2	Loss: 0.118646
Client Index = 15	Epoch: 3	Loss: 0.139486
Client Index = 15	Epoch: 4	Loss: 0.135551
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 16
local mask changes: 684480.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1062096.0, 684480.0, 1065696.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.415253
Client Index = 16	Epoch: 1	Loss: 0.194167
Client Index = 16	Epoch: 2	Loss: 0.145889
Client Index = 16	Epoch: 3	Loss: 0.153032
Client Index = 16	Epoch: 4	Loss: 0.178131
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 17
local mask changes: 684200.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1067684.0, 684200.0, 1068548.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.476074
Client Index = 17	Epoch: 1	Loss: 0.266138
Client Index = 17	Epoch: 2	Loss: 0.242368
Client Index = 17	Epoch: 3	Loss: 0.176865
Client Index = 17	Epoch: 4	Loss: 0.246680
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 18
local mask changes: 684694.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1068302.0, 684694.0, 1063536.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.198424
Client Index = 18	Epoch: 1	Loss: 0.234545
Client Index = 18	Epoch: 2	Loss: 0.129433
Client Index = 18	Epoch: 3	Loss: 0.076142
Client Index = 18	Epoch: 4	Loss: 0.065479
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 19
local mask changes: 684174.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1066990.0, 1062654.0, 684174.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.196106
Client Index = 19	Epoch: 1	Loss: 0.186427
Client Index = 19	Epoch: 2	Loss: 0.328141
Client Index = 19	Epoch: 3	Loss: 0.217361
Client Index = 19	Epoch: 4	Loss: 0.106321
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.19501653277361763}
################local_test_on_all_clients after local training in communication round: 74
{'test_acc_after': 0.780299281624506, 'test_loss_after': 0.8438772422361895}
################local_test_on_all_clients before local training in communication round: 74
{'test_acc_before': 0.7922706455474461, 'test_loss_before': 0.7188570938791752}
################Communication round : 75
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 0
local mask changes: 640742.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [640742.0, 1033154.0, 1034550.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.427231
Client Index = 0	Epoch: 1	Loss: 0.152838
Client Index = 0	Epoch: 2	Loss: 0.262167
Client Index = 0	Epoch: 3	Loss: 0.132754
Client Index = 0	Epoch: 4	Loss: 0.179474
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 1
local mask changes: 641168.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1031564.0, 641168.0, 1024788.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.191528
Client Index = 1	Epoch: 1	Loss: 0.071933
Client Index = 1	Epoch: 2	Loss: 0.070963
Client Index = 1	Epoch: 3	Loss: 0.096465
Client Index = 1	Epoch: 4	Loss: 0.092180
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 2
local mask changes: 640978.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [1023478.0, 640978.0, 1025790.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.049979
Client Index = 2	Epoch: 1	Loss: 0.050182
Client Index = 2	Epoch: 2	Loss: 0.072698
Client Index = 2	Epoch: 3	Loss: 0.029807
Client Index = 2	Epoch: 4	Loss: 0.026050
test acc on this client after 448 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 3
local mask changes: 640708.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [1027208.0, 640708.0, 1034482.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.172384
Client Index = 3	Epoch: 1	Loss: 0.174561
Client Index = 3	Epoch: 2	Loss: 0.077362
Client Index = 3	Epoch: 3	Loss: 0.088090
Client Index = 3	Epoch: 4	Loss: 0.056107
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 4
local mask changes: 641202.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1036908.0, 641202.0, 1042888.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.384917
Client Index = 4	Epoch: 1	Loss: 0.144196
Client Index = 4	Epoch: 2	Loss: 0.274415
Client Index = 4	Epoch: 3	Loss: 0.086096
Client Index = 4	Epoch: 4	Loss: 0.131249
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 5
local mask changes: 641070.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1043942.0, 641070.0, 1046210.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.266862
Client Index = 5	Epoch: 1	Loss: 0.437895
Client Index = 5	Epoch: 2	Loss: 0.226437
Client Index = 5	Epoch: 3	Loss: 0.125431
Client Index = 5	Epoch: 4	Loss: 0.138502
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 6
local mask changes: 640758.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1047090.0, 640758.0, 1046846.0]
Doing local aggregation!
test acc on this client before 374 / 505 : 0.74
Client Index = 6	Epoch: 0	Loss: 0.242047
Client Index = 6	Epoch: 1	Loss: 0.409359
Client Index = 6	Epoch: 2	Loss: 0.154642
Client Index = 6	Epoch: 3	Loss: 0.276856
Client Index = 6	Epoch: 4	Loss: 0.182933
test acc on this client after 392 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 7
local mask changes: 641702.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1045888.0, 641702.0, 1034724.0]
Doing local aggregation!
test acc on this client before 364 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.306969
Client Index = 7	Epoch: 1	Loss: 0.512941
Client Index = 7	Epoch: 2	Loss: 0.296069
Client Index = 7	Epoch: 3	Loss: 0.246827
Client Index = 7	Epoch: 4	Loss: 0.182959
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 8
local mask changes: 641296.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [1029552.0, 641296.0, 1026444.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.091718
Client Index = 8	Epoch: 1	Loss: 0.047917
Client Index = 8	Epoch: 2	Loss: 0.041562
Client Index = 8	Epoch: 3	Loss: 0.046471
Client Index = 8	Epoch: 4	Loss: 0.018298
test acc on this client after 465 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 9
local mask changes: 641312.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [1030224.0, 641312.0, 1039394.0]
Doing local aggregation!
test acc on this client before 389 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.244897
Client Index = 9	Epoch: 1	Loss: 0.211866
Client Index = 9	Epoch: 2	Loss: 0.138491
Client Index = 9	Epoch: 3	Loss: 0.422419
Client Index = 9	Epoch: 4	Loss: 0.163958
test acc on this client after 380 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 10
local mask changes: 641220.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1039978.0, 641220.0, 1032852.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.279517
Client Index = 10	Epoch: 1	Loss: 0.292317
Client Index = 10	Epoch: 2	Loss: 0.221317
Client Index = 10	Epoch: 3	Loss: 0.176732
Client Index = 10	Epoch: 4	Loss: 0.205265
test acc on this client after 356 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 11
local mask changes: 641004.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [1029384.0, 641004.0, 1028894.0]
Doing local aggregation!
test acc on this client before 418 / 505 : 0.83
Client Index = 11	Epoch: 0	Loss: 0.339568
Client Index = 11	Epoch: 1	Loss: 0.115261
Client Index = 11	Epoch: 2	Loss: 0.063442
Client Index = 11	Epoch: 3	Loss: 0.074882
Client Index = 11	Epoch: 4	Loss: 0.054125
test acc on this client after 442 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 12
local mask changes: 641726.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1031248.0, 641726.0, 1037716.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.347695
Client Index = 12	Epoch: 1	Loss: 0.174130
Client Index = 12	Epoch: 2	Loss: 0.241477
Client Index = 12	Epoch: 3	Loss: 0.171042
Client Index = 12	Epoch: 4	Loss: 0.298617
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 13
local mask changes: 641360.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1036610.0, 641360.0, 1034062.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.243521
Client Index = 13	Epoch: 1	Loss: 0.236414
Client Index = 13	Epoch: 2	Loss: 0.104729
Client Index = 13	Epoch: 3	Loss: 0.098473
Client Index = 13	Epoch: 4	Loss: 0.085736
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 14
local mask changes: 641182.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1033720.0, 641182.0, 1030638.0]
Doing local aggregation!
test acc on this client before 390 / 503 : 0.78
Client Index = 14	Epoch: 0	Loss: 0.211325
Client Index = 14	Epoch: 1	Loss: 0.202061
Client Index = 14	Epoch: 2	Loss: 0.265352
Client Index = 14	Epoch: 3	Loss: 0.241022
Client Index = 14	Epoch: 4	Loss: 0.073182
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 15
local mask changes: 641836.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [1029840.0, 641836.0, 1028506.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.218071
Client Index = 15	Epoch: 1	Loss: 0.140618
Client Index = 15	Epoch: 2	Loss: 0.187256
Client Index = 15	Epoch: 3	Loss: 0.326244
Client Index = 15	Epoch: 4	Loss: 0.118798
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 16
local mask changes: 640898.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [1029992.0, 640898.0, 1035010.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.205863
Client Index = 16	Epoch: 1	Loss: 0.353259
Client Index = 16	Epoch: 2	Loss: 0.180082
Client Index = 16	Epoch: 3	Loss: 0.194259
Client Index = 16	Epoch: 4	Loss: 0.103582
test acc on this client after 379 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 17
local mask changes: 640734.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1037146.0, 640734.0, 1038810.0]
Doing local aggregation!
test acc on this client before 370 / 503 : 0.74
Client Index = 17	Epoch: 0	Loss: 0.329005
Client Index = 17	Epoch: 1	Loss: 0.243944
Client Index = 17	Epoch: 2	Loss: 0.469363
Client Index = 17	Epoch: 3	Loss: 0.206905
Client Index = 17	Epoch: 4	Loss: 0.180592
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 18
local mask changes: 641058.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1035368.0, 641058.0, 1031132.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.378820
Client Index = 18	Epoch: 1	Loss: 0.165661
Client Index = 18	Epoch: 2	Loss: 0.120919
Client Index = 18	Epoch: 3	Loss: 0.107065
Client Index = 18	Epoch: 4	Loss: 0.131875
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 19
local mask changes: 641034.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1034016.0, 1032014.0, 641034.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.274201
Client Index = 19	Epoch: 1	Loss: 0.220571
Client Index = 19	Epoch: 2	Loss: 0.150062
Client Index = 19	Epoch: 3	Loss: 0.138542
Client Index = 19	Epoch: 4	Loss: 0.128265
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.19020981183473487}
################local_test_on_all_clients after local training in communication round: 75
{'test_acc_after': 0.7945506352479462, 'test_loss_after': 0.7789167302933027}
################local_test_on_all_clients before local training in communication round: 75
{'test_acc_before': 0.7931725829946269, 'test_loss_before': 0.7380547188468229}
################Communication round : 76
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 0
local mask changes: 599020.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [599020.0, 1003274.0, 1004392.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.194627
Client Index = 0	Epoch: 1	Loss: 0.197164
Client Index = 0	Epoch: 2	Loss: 0.186604
Client Index = 0	Epoch: 3	Loss: 0.258067
Client Index = 0	Epoch: 4	Loss: 0.094251
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 1
local mask changes: 598764.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [1000206.0, 598764.0, 993744.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.153037
Client Index = 1	Epoch: 1	Loss: 0.106672
Client Index = 1	Epoch: 2	Loss: 0.069149
Client Index = 1	Epoch: 3	Loss: 0.088306
Client Index = 1	Epoch: 4	Loss: 0.045657
test acc on this client after 436 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 2
local mask changes: 598672.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [992044.0, 598672.0, 993178.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.069850
Client Index = 2	Epoch: 1	Loss: 0.044268
Client Index = 2	Epoch: 2	Loss: 0.022194
Client Index = 2	Epoch: 3	Loss: 0.010517
Client Index = 2	Epoch: 4	Loss: 0.024841
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 3
local mask changes: 599060.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [996196.0, 599060.0, 1003442.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 3	Epoch: 0	Loss: 0.101826
Client Index = 3	Epoch: 1	Loss: 0.068595
Client Index = 3	Epoch: 2	Loss: 0.150533
Client Index = 3	Epoch: 3	Loss: 0.080133
Client Index = 3	Epoch: 4	Loss: 0.087930
test acc on this client after 437 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 4
local mask changes: 598812.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [1006518.0, 598812.0, 1012066.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.287276
Client Index = 4	Epoch: 1	Loss: 0.174174
Client Index = 4	Epoch: 2	Loss: 0.190115
Client Index = 4	Epoch: 3	Loss: 0.137857
Client Index = 4	Epoch: 4	Loss: 0.128925
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 5
local mask changes: 598978.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [1013678.0, 598978.0, 1015300.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.362702
Client Index = 5	Epoch: 1	Loss: 0.145763
Client Index = 5	Epoch: 2	Loss: 0.179982
Client Index = 5	Epoch: 3	Loss: 0.189301
Client Index = 5	Epoch: 4	Loss: 0.262484
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 6
local mask changes: 598012.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [1016642.0, 598012.0, 1016294.0]
Doing local aggregation!
test acc on this client before 398 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.236947
Client Index = 6	Epoch: 1	Loss: 0.191250
Client Index = 6	Epoch: 2	Loss: 0.420651
Client Index = 6	Epoch: 3	Loss: 0.199359
Client Index = 6	Epoch: 4	Loss: 0.169554
test acc on this client after 385 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 7
local mask changes: 599212.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [1016600.0, 599212.0, 1004312.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.486959
Client Index = 7	Epoch: 1	Loss: 0.275107
Client Index = 7	Epoch: 2	Loss: 0.289497
Client Index = 7	Epoch: 3	Loss: 0.497153
Client Index = 7	Epoch: 4	Loss: 0.313666
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 8
local mask changes: 598512.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [998900.0, 598512.0, 995350.0]
Doing local aggregation!
test acc on this client before 457 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.070220
Client Index = 8	Epoch: 1	Loss: 0.063268
Client Index = 8	Epoch: 2	Loss: 0.049234
Client Index = 8	Epoch: 3	Loss: 0.031769
Client Index = 8	Epoch: 4	Loss: 0.020018
test acc on this client after 467 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 9
local mask changes: 598946.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [999670.0, 598946.0, 1008596.0]
Doing local aggregation!
test acc on this client before 369 / 506 : 0.73
Client Index = 9	Epoch: 0	Loss: 0.162322
Client Index = 9	Epoch: 1	Loss: 0.452443
Client Index = 9	Epoch: 2	Loss: 0.138956
Client Index = 9	Epoch: 3	Loss: 0.123229
Client Index = 9	Epoch: 4	Loss: 0.183601
test acc on this client after 389 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 10
local mask changes: 598582.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [1010182.0, 598582.0, 1002338.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.323364
Client Index = 10	Epoch: 1	Loss: 0.247164
Client Index = 10	Epoch: 2	Loss: 0.203957
Client Index = 10	Epoch: 3	Loss: 0.144691
Client Index = 10	Epoch: 4	Loss: 0.218355
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 11
local mask changes: 599068.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [999124.0, 599068.0, 996894.0]
Doing local aggregation!
test acc on this client before 422 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.241440
Client Index = 11	Epoch: 1	Loss: 0.109182
Client Index = 11	Epoch: 2	Loss: 0.067391
Client Index = 11	Epoch: 3	Loss: 0.071403
Client Index = 11	Epoch: 4	Loss: 0.098477
test acc on this client after 435 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 12
local mask changes: 599062.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [1001104.0, 599062.0, 1008346.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.199403
Client Index = 12	Epoch: 1	Loss: 0.214575
Client Index = 12	Epoch: 2	Loss: 0.146632
Client Index = 12	Epoch: 3	Loss: 0.143065
Client Index = 12	Epoch: 4	Loss: 0.202384
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 13
local mask changes: 599064.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [1005400.0, 599064.0, 1002072.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.160189
Client Index = 13	Epoch: 1	Loss: 0.342375
Client Index = 13	Epoch: 2	Loss: 0.121862
Client Index = 13	Epoch: 3	Loss: 0.107791
Client Index = 13	Epoch: 4	Loss: 0.071916
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 14
local mask changes: 598944.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [1002290.0, 598944.0, 998692.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.325963
Client Index = 14	Epoch: 1	Loss: 0.149434
Client Index = 14	Epoch: 2	Loss: 0.134520
Client Index = 14	Epoch: 3	Loss: 0.218161
Client Index = 14	Epoch: 4	Loss: 0.075754
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 15
local mask changes: 598964.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [997962.0, 598964.0, 997718.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.236141
Client Index = 15	Epoch: 1	Loss: 0.153835
Client Index = 15	Epoch: 2	Loss: 0.135570
Client Index = 15	Epoch: 3	Loss: 0.158532
Client Index = 15	Epoch: 4	Loss: 0.102984
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 16
local mask changes: 598878.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [998490.0, 598878.0, 1005196.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.335252
Client Index = 16	Epoch: 1	Loss: 0.177590
Client Index = 16	Epoch: 2	Loss: 0.128516
Client Index = 16	Epoch: 3	Loss: 0.241237
Client Index = 16	Epoch: 4	Loss: 0.125674
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 17
local mask changes: 598988.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [1007010.0, 598988.0, 1008226.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.327830
Client Index = 17	Epoch: 1	Loss: 0.351459
Client Index = 17	Epoch: 2	Loss: 0.233155
Client Index = 17	Epoch: 3	Loss: 0.145545
Client Index = 17	Epoch: 4	Loss: 0.226564
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 18
local mask changes: 598580.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [1006596.0, 598580.0, 1000784.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.411786
Client Index = 18	Epoch: 1	Loss: 0.136344
Client Index = 18	Epoch: 2	Loss: 0.115160
Client Index = 18	Epoch: 3	Loss: 0.150629
Client Index = 18	Epoch: 4	Loss: 0.073829
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 19
local mask changes: 599362.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [1003160.0, 1000316.0, 599362.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.173157
Client Index = 19	Epoch: 1	Loss: 0.448262
Client Index = 19	Epoch: 2	Loss: 0.195162
Client Index = 19	Epoch: 3	Loss: 0.121694
Client Index = 19	Epoch: 4	Loss: 0.084247
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.17817603609792426}
################local_test_on_all_clients after local training in communication round: 76
{'test_acc_after': 0.7985303386296053, 'test_loss_after': 0.7610551270769046}
################local_test_on_all_clients before local training in communication round: 76
{'test_acc_before': 0.8006230961021965, 'test_loss_before': 0.721898544673827}
################Communication round : 77
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 0
local mask changes: 557188.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [557188.0, 973826.0, 975066.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.265499
Client Index = 0	Epoch: 1	Loss: 0.189580
Client Index = 0	Epoch: 2	Loss: 0.105687
Client Index = 0	Epoch: 3	Loss: 0.130230
Client Index = 0	Epoch: 4	Loss: 0.200394
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 1
local mask changes: 557254.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [970566.0, 557254.0, 962230.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.427393
Client Index = 1	Epoch: 1	Loss: 0.103340
Client Index = 1	Epoch: 2	Loss: 0.060464
Client Index = 1	Epoch: 3	Loss: 0.069063
Client Index = 1	Epoch: 4	Loss: 0.038569
test acc on this client after 446 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 2
local mask changes: 557266.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [960154.0, 557266.0, 961908.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.079846
Client Index = 2	Epoch: 1	Loss: 0.124899
Client Index = 2	Epoch: 2	Loss: 0.136106
Client Index = 2	Epoch: 3	Loss: 0.154605
Client Index = 2	Epoch: 4	Loss: 0.028992
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 3
local mask changes: 556936.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [964666.0, 556936.0, 973312.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.256644
Client Index = 3	Epoch: 1	Loss: 0.224539
Client Index = 3	Epoch: 2	Loss: 0.079630
Client Index = 3	Epoch: 3	Loss: 0.049976
Client Index = 3	Epoch: 4	Loss: 0.063053
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 4
local mask changes: 557898.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [976184.0, 557898.0, 982304.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.250364
Client Index = 4	Epoch: 1	Loss: 0.186309
Client Index = 4	Epoch: 2	Loss: 0.128770
Client Index = 4	Epoch: 3	Loss: 0.086749
Client Index = 4	Epoch: 4	Loss: 0.248085
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 5
local mask changes: 557694.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [983366.0, 557694.0, 986396.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.234349
Client Index = 5	Epoch: 1	Loss: 0.340280
Client Index = 5	Epoch: 2	Loss: 0.239496
Client Index = 5	Epoch: 3	Loss: 0.169088
Client Index = 5	Epoch: 4	Loss: 0.160775
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 6
local mask changes: 557414.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [988030.0, 557414.0, 988682.0]
Doing local aggregation!
test acc on this client before 377 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.241969
Client Index = 6	Epoch: 1	Loss: 0.210711
Client Index = 6	Epoch: 2	Loss: 0.138029
Client Index = 6	Epoch: 3	Loss: 0.159980
Client Index = 6	Epoch: 4	Loss: 0.252775
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 7
local mask changes: 557270.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [988770.0, 557270.0, 975680.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.409245
Client Index = 7	Epoch: 1	Loss: 0.335579
Client Index = 7	Epoch: 2	Loss: 0.263475
Client Index = 7	Epoch: 3	Loss: 0.314672
Client Index = 7	Epoch: 4	Loss: 0.205292
test acc on this client after 314 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 8
local mask changes: 556898.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [968738.0, 556898.0, 965306.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.083199
Client Index = 8	Epoch: 1	Loss: 0.309148
Client Index = 8	Epoch: 2	Loss: 0.047361
Client Index = 8	Epoch: 3	Loss: 0.028717
Client Index = 8	Epoch: 4	Loss: 0.012974
test acc on this client after 472 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 9
local mask changes: 557626.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [969742.0, 557626.0, 979224.0]
Doing local aggregation!
test acc on this client before 378 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.203883
Client Index = 9	Epoch: 1	Loss: 0.141539
Client Index = 9	Epoch: 2	Loss: 0.253054
Client Index = 9	Epoch: 3	Loss: 0.405524
Client Index = 9	Epoch: 4	Loss: 0.106334
test acc on this client after 356 / 506 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 10
local mask changes: 557350.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [979802.0, 557350.0, 972310.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.262737
Client Index = 10	Epoch: 1	Loss: 0.328731
Client Index = 10	Epoch: 2	Loss: 0.226167
Client Index = 10	Epoch: 3	Loss: 0.212877
Client Index = 10	Epoch: 4	Loss: 0.107294
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 11
local mask changes: 557752.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [968988.0, 557752.0, 969146.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 11	Epoch: 0	Loss: 0.130075
Client Index = 11	Epoch: 1	Loss: 0.268153
Client Index = 11	Epoch: 2	Loss: 0.086298
Client Index = 11	Epoch: 3	Loss: 0.087376
Client Index = 11	Epoch: 4	Loss: 0.101604
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 12
local mask changes: 557406.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [971394.0, 557406.0, 977152.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.442900
Client Index = 12	Epoch: 1	Loss: 0.150302
Client Index = 12	Epoch: 2	Loss: 0.149082
Client Index = 12	Epoch: 3	Loss: 0.211904
Client Index = 12	Epoch: 4	Loss: 0.095254
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 13
local mask changes: 557272.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [976012.0, 557272.0, 972504.0]
Doing local aggregation!
test acc on this client before 411 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.202337
Client Index = 13	Epoch: 1	Loss: 0.141395
Client Index = 13	Epoch: 2	Loss: 0.208249
Client Index = 13	Epoch: 3	Loss: 0.181656
Client Index = 13	Epoch: 4	Loss: 0.072737
test acc on this client after 400 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 14
local mask changes: 557068.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [971036.0, 557068.0, 968570.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.346955
Client Index = 14	Epoch: 1	Loss: 0.118816
Client Index = 14	Epoch: 2	Loss: 0.162698
Client Index = 14	Epoch: 3	Loss: 0.111786
Client Index = 14	Epoch: 4	Loss: 0.068257
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 15
local mask changes: 557336.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [968078.0, 557336.0, 968232.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.296524
Client Index = 15	Epoch: 1	Loss: 0.163518
Client Index = 15	Epoch: 2	Loss: 0.139909
Client Index = 15	Epoch: 3	Loss: 0.222889
Client Index = 15	Epoch: 4	Loss: 0.094325
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 16
local mask changes: 557340.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [968356.0, 557340.0, 975888.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.329090
Client Index = 16	Epoch: 1	Loss: 0.255738
Client Index = 16	Epoch: 2	Loss: 0.102650
Client Index = 16	Epoch: 3	Loss: 0.325327
Client Index = 16	Epoch: 4	Loss: 0.101704
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 17
local mask changes: 557462.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [978392.0, 557462.0, 979884.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.466339
Client Index = 17	Epoch: 1	Loss: 0.220710
Client Index = 17	Epoch: 2	Loss: 0.148682
Client Index = 17	Epoch: 3	Loss: 0.272780
Client Index = 17	Epoch: 4	Loss: 0.280377
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 18
local mask changes: 557100.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [977682.0, 557100.0, 970672.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.367396
Client Index = 18	Epoch: 1	Loss: 0.145259
Client Index = 18	Epoch: 2	Loss: 0.100669
Client Index = 18	Epoch: 3	Loss: 0.095790
Client Index = 18	Epoch: 4	Loss: 0.087128
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 19
local mask changes: 557422.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [974922.0, 971200.0, 557422.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.213789
Client Index = 19	Epoch: 1	Loss: 0.198625
Client Index = 19	Epoch: 2	Loss: 0.338423
Client Index = 19	Epoch: 3	Loss: 0.143040
Client Index = 19	Epoch: 4	Loss: 0.276145
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.18818700740142957}
################local_test_on_all_clients after local training in communication round: 77
{'test_acc_after': 0.7869307816384173, 'test_loss_after': 0.8133170760848587}
################local_test_on_all_clients before local training in communication round: 77
{'test_acc_before': 0.7976498601186324, 'test_loss_before': 0.7071442612471204}
################Communication round : 78
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 0
local mask changes: 516250.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [516250.0, 944186.0, 947236.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.240844
Client Index = 0	Epoch: 1	Loss: 0.229941
Client Index = 0	Epoch: 2	Loss: 0.164604
Client Index = 0	Epoch: 3	Loss: 0.129748
Client Index = 0	Epoch: 4	Loss: 0.124404
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 1
local mask changes: 516732.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [942260.0, 516732.0, 932002.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.178797
Client Index = 1	Epoch: 1	Loss: 0.131928
Client Index = 1	Epoch: 2	Loss: 0.051242
Client Index = 1	Epoch: 3	Loss: 0.047701
Client Index = 1	Epoch: 4	Loss: 0.096543
test acc on this client after 434 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 2
local mask changes: 516612.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [932432.0, 516612.0, 934334.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.042602
Client Index = 2	Epoch: 1	Loss: 0.021355
Client Index = 2	Epoch: 2	Loss: 0.038548
Client Index = 2	Epoch: 3	Loss: 0.036312
Client Index = 2	Epoch: 4	Loss: 0.043924
test acc on this client after 455 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 3
local mask changes: 516342.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [934480.0, 516342.0, 944432.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.111363
Client Index = 3	Epoch: 1	Loss: 0.105133
Client Index = 3	Epoch: 2	Loss: 0.061795
Client Index = 3	Epoch: 3	Loss: 0.081631
Client Index = 3	Epoch: 4	Loss: 0.204443
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 4
local mask changes: 516540.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [947392.0, 516540.0, 954606.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.194498
Client Index = 4	Epoch: 1	Loss: 0.427003
Client Index = 4	Epoch: 2	Loss: 0.096009
Client Index = 4	Epoch: 3	Loss: 0.071746
Client Index = 4	Epoch: 4	Loss: 0.221289
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 5
local mask changes: 516488.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [955670.0, 516488.0, 959512.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.252865
Client Index = 5	Epoch: 1	Loss: 0.271135
Client Index = 5	Epoch: 2	Loss: 0.210017
Client Index = 5	Epoch: 3	Loss: 0.162298
Client Index = 5	Epoch: 4	Loss: 0.124792
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 6
local mask changes: 517076.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [960374.0, 517076.0, 960914.0]
Doing local aggregation!
test acc on this client before 383 / 505 : 0.76
Client Index = 6	Epoch: 0	Loss: 0.284067
Client Index = 6	Epoch: 1	Loss: 0.228142
Client Index = 6	Epoch: 2	Loss: 0.134100
Client Index = 6	Epoch: 3	Loss: 0.369498
Client Index = 6	Epoch: 4	Loss: 0.143432
test acc on this client after 382 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 7
local mask changes: 516912.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [961760.0, 516912.0, 947898.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.386090
Client Index = 7	Epoch: 1	Loss: 0.413081
Client Index = 7	Epoch: 2	Loss: 0.329619
Client Index = 7	Epoch: 3	Loss: 0.186335
Client Index = 7	Epoch: 4	Loss: 0.270377
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 8
local mask changes: 516918.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [941592.0, 516918.0, 937380.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.061180
Client Index = 8	Epoch: 1	Loss: 0.021946
Client Index = 8	Epoch: 2	Loss: 0.035149
Client Index = 8	Epoch: 3	Loss: 0.028547
Client Index = 8	Epoch: 4	Loss: 0.026862
test acc on this client after 464 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 9
local mask changes: 516728.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [941560.0, 516728.0, 950702.0]
Doing local aggregation!
test acc on this client before 380 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.185602
Client Index = 9	Epoch: 1	Loss: 0.363104
Client Index = 9	Epoch: 2	Loss: 0.124410
Client Index = 9	Epoch: 3	Loss: 0.125927
Client Index = 9	Epoch: 4	Loss: 0.080650
test acc on this client after 379 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 10
local mask changes: 516760.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [951284.0, 516760.0, 943944.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.317015
Client Index = 10	Epoch: 1	Loss: 0.199224
Client Index = 10	Epoch: 2	Loss: 0.222236
Client Index = 10	Epoch: 3	Loss: 0.234110
Client Index = 10	Epoch: 4	Loss: 0.138609
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 11
local mask changes: 516788.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [942356.0, 516788.0, 940612.0]
Doing local aggregation!
test acc on this client before 427 / 505 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.094528
Client Index = 11	Epoch: 1	Loss: 0.112273
Client Index = 11	Epoch: 2	Loss: 0.113257
Client Index = 11	Epoch: 3	Loss: 0.072782
Client Index = 11	Epoch: 4	Loss: 0.050905
test acc on this client after 430 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 12
local mask changes: 516394.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [942026.0, 516394.0, 948260.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.302873
Client Index = 12	Epoch: 1	Loss: 0.284456
Client Index = 12	Epoch: 2	Loss: 0.229026
Client Index = 12	Epoch: 3	Loss: 0.133895
Client Index = 12	Epoch: 4	Loss: 0.064144
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 13
local mask changes: 516934.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [947928.0, 516934.0, 943696.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.275521
Client Index = 13	Epoch: 1	Loss: 0.093113
Client Index = 13	Epoch: 2	Loss: 0.113359
Client Index = 13	Epoch: 3	Loss: 0.283669
Client Index = 13	Epoch: 4	Loss: 0.065348
test acc on this client after 394 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 14
local mask changes: 516758.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [942376.0, 516758.0, 939240.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.349507
Client Index = 14	Epoch: 1	Loss: 0.162877
Client Index = 14	Epoch: 2	Loss: 0.158296
Client Index = 14	Epoch: 3	Loss: 0.095586
Client Index = 14	Epoch: 4	Loss: 0.191944
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 15
local mask changes: 516564.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [938792.0, 516564.0, 938284.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.171988
Client Index = 15	Epoch: 1	Loss: 0.173582
Client Index = 15	Epoch: 2	Loss: 0.261116
Client Index = 15	Epoch: 3	Loss: 0.096710
Client Index = 15	Epoch: 4	Loss: 0.161382
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 16
local mask changes: 517464.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [940678.0, 517464.0, 948160.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.367490
Client Index = 16	Epoch: 1	Loss: 0.200641
Client Index = 16	Epoch: 2	Loss: 0.199929
Client Index = 16	Epoch: 3	Loss: 0.122990
Client Index = 16	Epoch: 4	Loss: 0.184675
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 17
local mask changes: 516668.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [950924.0, 516668.0, 953324.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.247781
Client Index = 17	Epoch: 1	Loss: 0.212165
Client Index = 17	Epoch: 2	Loss: 0.457411
Client Index = 17	Epoch: 3	Loss: 0.168183
Client Index = 17	Epoch: 4	Loss: 0.127820
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 18
local mask changes: 516644.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [949124.0, 516644.0, 941908.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.192995
Client Index = 18	Epoch: 1	Loss: 0.555798
Client Index = 18	Epoch: 2	Loss: 0.080002
Client Index = 18	Epoch: 3	Loss: 0.077400
Client Index = 18	Epoch: 4	Loss: 0.052590
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 19
local mask changes: 516652.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [948922.0, 943602.0, 516652.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.114689
Client Index = 19	Epoch: 1	Loss: 0.160728
Client Index = 19	Epoch: 2	Loss: 0.296813
Client Index = 19	Epoch: 3	Loss: 0.119484
Client Index = 19	Epoch: 4	Loss: 0.134901
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.17270443706354127}
################local_test_on_all_clients after local training in communication round: 78
{'test_acc_after': 0.788120142302686, 'test_loss_after': 0.8012473396434927}
################local_test_on_all_clients before local training in communication round: 78
{'test_acc_before': 0.7998199954344618, 'test_loss_before': 0.7168605157888213}
################Communication round : 79
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 0
local mask changes: 477640.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [477640.0, 916442.0, 921000.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.296580
Client Index = 0	Epoch: 1	Loss: 0.118361
Client Index = 0	Epoch: 2	Loss: 0.367235
Client Index = 0	Epoch: 3	Loss: 0.167450
Client Index = 0	Epoch: 4	Loss: 0.104046
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 1
local mask changes: 477170.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [914220.0, 477170.0, 905912.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.134541
Client Index = 1	Epoch: 1	Loss: 0.318258
Client Index = 1	Epoch: 2	Loss: 0.091284
Client Index = 1	Epoch: 3	Loss: 0.156596
Client Index = 1	Epoch: 4	Loss: 0.039217
test acc on this client after 443 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 2
local mask changes: 477138.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [903562.0, 477138.0, 904856.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.062086
Client Index = 2	Epoch: 1	Loss: 0.066283
Client Index = 2	Epoch: 2	Loss: 0.091251
Client Index = 2	Epoch: 3	Loss: 0.047170
Client Index = 2	Epoch: 4	Loss: 0.010935
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 3
local mask changes: 477548.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [908812.0, 477548.0, 918130.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.143921
Client Index = 3	Epoch: 1	Loss: 0.204048
Client Index = 3	Epoch: 2	Loss: 0.057995
Client Index = 3	Epoch: 3	Loss: 0.106154
Client Index = 3	Epoch: 4	Loss: 0.067981
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 4
local mask changes: 476854.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [920650.0, 476854.0, 928186.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.172914
Client Index = 4	Epoch: 1	Loss: 0.267971
Client Index = 4	Epoch: 2	Loss: 0.157906
Client Index = 4	Epoch: 3	Loss: 0.114684
Client Index = 4	Epoch: 4	Loss: 0.135456
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 5
local mask changes: 477234.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [927978.0, 477234.0, 932726.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.235070
Client Index = 5	Epoch: 1	Loss: 0.225487
Client Index = 5	Epoch: 2	Loss: 0.124749
Client Index = 5	Epoch: 3	Loss: 0.358004
Client Index = 5	Epoch: 4	Loss: 0.210638
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 6
local mask changes: 477028.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [934086.0, 477028.0, 935972.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.197207
Client Index = 6	Epoch: 1	Loss: 0.189156
Client Index = 6	Epoch: 2	Loss: 0.223815
Client Index = 6	Epoch: 3	Loss: 0.322465
Client Index = 6	Epoch: 4	Loss: 0.162767
test acc on this client after 392 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 7
local mask changes: 477180.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [935736.0, 477180.0, 921248.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 7	Epoch: 0	Loss: 0.503988
Client Index = 7	Epoch: 1	Loss: 0.282741
Client Index = 7	Epoch: 2	Loss: 0.295834
Client Index = 7	Epoch: 3	Loss: 0.205818
Client Index = 7	Epoch: 4	Loss: 0.140315
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 8
local mask changes: 477530.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [914938.0, 477530.0, 909990.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.094403
Client Index = 8	Epoch: 1	Loss: 0.032401
Client Index = 8	Epoch: 2	Loss: 0.036142
Client Index = 8	Epoch: 3	Loss: 0.020085
Client Index = 8	Epoch: 4	Loss: 0.244076
test acc on this client after 465 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 9
local mask changes: 477490.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [914008.0, 477490.0, 922898.0]
Doing local aggregation!
test acc on this client before 355 / 506 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.342418
Client Index = 9	Epoch: 1	Loss: 0.180532
Client Index = 9	Epoch: 2	Loss: 0.095735
Client Index = 9	Epoch: 3	Loss: 0.260359
Client Index = 9	Epoch: 4	Loss: 0.250531
test acc on this client after 380 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 10
local mask changes: 476770.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [924612.0, 476770.0, 918128.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 10	Epoch: 0	Loss: 0.194792
Client Index = 10	Epoch: 1	Loss: 0.205822
Client Index = 10	Epoch: 2	Loss: 0.382916
Client Index = 10	Epoch: 3	Loss: 0.108985
Client Index = 10	Epoch: 4	Loss: 0.080415
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 11
local mask changes: 477158.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [914742.0, 477158.0, 913352.0]
Doing local aggregation!
test acc on this client before 429 / 505 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.302876
Client Index = 11	Epoch: 1	Loss: 0.067153
Client Index = 11	Epoch: 2	Loss: 0.076416
Client Index = 11	Epoch: 3	Loss: 0.073706
Client Index = 11	Epoch: 4	Loss: 0.053102
test acc on this client after 434 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 12
local mask changes: 477042.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [914624.0, 477042.0, 921318.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.339451
Client Index = 12	Epoch: 1	Loss: 0.243221
Client Index = 12	Epoch: 2	Loss: 0.201353
Client Index = 12	Epoch: 3	Loss: 0.165588
Client Index = 12	Epoch: 4	Loss: 0.073195
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 13
local mask changes: 476910.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [921150.0, 476910.0, 915970.0]
Doing local aggregation!
test acc on this client before 416 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.281289
Client Index = 13	Epoch: 1	Loss: 0.189115
Client Index = 13	Epoch: 2	Loss: 0.091114
Client Index = 13	Epoch: 3	Loss: 0.071449
Client Index = 13	Epoch: 4	Loss: 0.058312
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 14
local mask changes: 476840.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [915630.0, 476840.0, 913198.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.136258
Client Index = 14	Epoch: 1	Loss: 0.234261
Client Index = 14	Epoch: 2	Loss: 0.256005
Client Index = 14	Epoch: 3	Loss: 0.162728
Client Index = 14	Epoch: 4	Loss: 0.091917
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 15
local mask changes: 477160.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [911590.0, 477160.0, 912244.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.284851
Client Index = 15	Epoch: 1	Loss: 0.130733
Client Index = 15	Epoch: 2	Loss: 0.093084
Client Index = 15	Epoch: 3	Loss: 0.352387
Client Index = 15	Epoch: 4	Loss: 0.099184
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 16
local mask changes: 476850.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [913280.0, 476850.0, 923270.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.322486
Client Index = 16	Epoch: 1	Loss: 0.191029
Client Index = 16	Epoch: 2	Loss: 0.137272
Client Index = 16	Epoch: 3	Loss: 0.261660
Client Index = 16	Epoch: 4	Loss: 0.071439
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 17
local mask changes: 476944.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [924834.0, 476944.0, 925898.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.467997
Client Index = 17	Epoch: 1	Loss: 0.141917
Client Index = 17	Epoch: 2	Loss: 0.128898
Client Index = 17	Epoch: 3	Loss: 0.378250
Client Index = 17	Epoch: 4	Loss: 0.127555
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 18
local mask changes: 477154.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [923776.0, 477154.0, 915932.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.301610
Client Index = 18	Epoch: 1	Loss: 0.191692
Client Index = 18	Epoch: 2	Loss: 0.172458
Client Index = 18	Epoch: 3	Loss: 0.140112
Client Index = 18	Epoch: 4	Loss: 0.104009
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 19
local mask changes: 477254.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [921500.0, 915914.0, 477254.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.149383
Client Index = 19	Epoch: 1	Loss: 0.518537
Client Index = 19	Epoch: 2	Loss: 0.177808
Client Index = 19	Epoch: 3	Loss: 0.137177
Client Index = 19	Epoch: 4	Loss: 0.091443
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.18049469483457506}
################local_test_on_all_clients after local training in communication round: 79
{'test_acc_after': 0.8058788895942556, 'test_loss_after': 0.7151158847275381}
################local_test_on_all_clients before local training in communication round: 79
{'test_acc_before': 0.8038045750292031, 'test_loss_before': 0.7013440153137068}
################Communication round : 80
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 0
local mask changes: 438602.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [438602.0, 892096.0, 896738.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.247149
Client Index = 0	Epoch: 1	Loss: 0.157580
Client Index = 0	Epoch: 2	Loss: 0.136335
Client Index = 0	Epoch: 3	Loss: 0.179601
Client Index = 0	Epoch: 4	Loss: 0.054359
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 1
local mask changes: 438564.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [888260.0, 438564.0, 878804.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.119427
Client Index = 1	Epoch: 1	Loss: 0.225951
Client Index = 1	Epoch: 2	Loss: 0.113295
Client Index = 1	Epoch: 3	Loss: 0.060662
Client Index = 1	Epoch: 4	Loss: 0.037532
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 2
local mask changes: 438710.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [878410.0, 438710.0, 880424.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.041669
Client Index = 2	Epoch: 1	Loss: 0.043615
Client Index = 2	Epoch: 2	Loss: 0.080198
Client Index = 2	Epoch: 3	Loss: 0.039631
Client Index = 2	Epoch: 4	Loss: 0.044232
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 3
local mask changes: 438918.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [881848.0, 438918.0, 892732.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.075142
Client Index = 3	Epoch: 1	Loss: 0.107081
Client Index = 3	Epoch: 2	Loss: 0.171483
Client Index = 3	Epoch: 3	Loss: 0.399594
Client Index = 3	Epoch: 4	Loss: 0.046247
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 4
local mask changes: 438820.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [895036.0, 438820.0, 900960.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.160178
Client Index = 4	Epoch: 1	Loss: 0.358943
Client Index = 4	Epoch: 2	Loss: 0.147670
Client Index = 4	Epoch: 3	Loss: 0.089844
Client Index = 4	Epoch: 4	Loss: 0.099249
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 5
local mask changes: 438384.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [903350.0, 438384.0, 907412.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.198561
Client Index = 5	Epoch: 1	Loss: 0.223148
Client Index = 5	Epoch: 2	Loss: 0.148467
Client Index = 5	Epoch: 3	Loss: 0.108891
Client Index = 5	Epoch: 4	Loss: 0.202330
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 6
local mask changes: 438286.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [908464.0, 438286.0, 911596.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.211544
Client Index = 6	Epoch: 1	Loss: 0.191648
Client Index = 6	Epoch: 2	Loss: 0.270680
Client Index = 6	Epoch: 3	Loss: 0.097851
Client Index = 6	Epoch: 4	Loss: 0.087572
test acc on this client after 391 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 7
local mask changes: 438888.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [909928.0, 438888.0, 895110.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 7	Epoch: 0	Loss: 0.407103
Client Index = 7	Epoch: 1	Loss: 0.282374
Client Index = 7	Epoch: 2	Loss: 0.187272
Client Index = 7	Epoch: 3	Loss: 0.362857
Client Index = 7	Epoch: 4	Loss: 0.279031
test acc on this client after 323 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 8
local mask changes: 438968.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [891006.0, 438968.0, 884302.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.047300
Client Index = 8	Epoch: 1	Loss: 0.089265
Client Index = 8	Epoch: 2	Loss: 0.043403
Client Index = 8	Epoch: 3	Loss: 0.011054
Client Index = 8	Epoch: 4	Loss: 0.008826
test acc on this client after 470 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 9
local mask changes: 438750.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [889208.0, 438750.0, 899178.0]
Doing local aggregation!
test acc on this client before 385 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.175165
Client Index = 9	Epoch: 1	Loss: 0.222750
Client Index = 9	Epoch: 2	Loss: 0.107825
Client Index = 9	Epoch: 3	Loss: 0.133219
Client Index = 9	Epoch: 4	Loss: 0.294608
test acc on this client after 341 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 10
local mask changes: 439198.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [898858.0, 439198.0, 891512.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.246448
Client Index = 10	Epoch: 1	Loss: 0.189849
Client Index = 10	Epoch: 2	Loss: 0.473637
Client Index = 10	Epoch: 3	Loss: 0.095974
Client Index = 10	Epoch: 4	Loss: 0.198819
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 11
local mask changes: 439034.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [889008.0, 439034.0, 886732.0]
Doing local aggregation!
test acc on this client before 426 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.301348
Client Index = 11	Epoch: 1	Loss: 0.094559
Client Index = 11	Epoch: 2	Loss: 0.058654
Client Index = 11	Epoch: 3	Loss: 0.216424
Client Index = 11	Epoch: 4	Loss: 0.042977
test acc on this client after 425 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 12
local mask changes: 438638.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [889094.0, 438638.0, 895934.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.468377
Client Index = 12	Epoch: 1	Loss: 0.166208
Client Index = 12	Epoch: 2	Loss: 0.126079
Client Index = 12	Epoch: 3	Loss: 0.087021
Client Index = 12	Epoch: 4	Loss: 0.100695
test acc on this client after 394 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 13
local mask changes: 439024.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [894812.0, 439024.0, 889782.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.148254
Client Index = 13	Epoch: 1	Loss: 0.343517
Client Index = 13	Epoch: 2	Loss: 0.149241
Client Index = 13	Epoch: 3	Loss: 0.090273
Client Index = 13	Epoch: 4	Loss: 0.109915
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 14
local mask changes: 438538.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [891094.0, 438538.0, 887424.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.347172
Client Index = 14	Epoch: 1	Loss: 0.132399
Client Index = 14	Epoch: 2	Loss: 0.115955
Client Index = 14	Epoch: 3	Loss: 0.238289
Client Index = 14	Epoch: 4	Loss: 0.126035
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 15
local mask changes: 438492.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [887352.0, 438492.0, 887400.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.190961
Client Index = 15	Epoch: 1	Loss: 0.210654
Client Index = 15	Epoch: 2	Loss: 0.194844
Client Index = 15	Epoch: 3	Loss: 0.073517
Client Index = 15	Epoch: 4	Loss: 0.108220
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 16
local mask changes: 439012.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [887412.0, 439012.0, 897520.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 16	Epoch: 0	Loss: 0.336650
Client Index = 16	Epoch: 1	Loss: 0.120233
Client Index = 16	Epoch: 2	Loss: 0.147391
Client Index = 16	Epoch: 3	Loss: 0.173622
Client Index = 16	Epoch: 4	Loss: 0.246573
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 17
local mask changes: 438662.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [899800.0, 438662.0, 899350.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.319004
Client Index = 17	Epoch: 1	Loss: 0.224654
Client Index = 17	Epoch: 2	Loss: 0.137156
Client Index = 17	Epoch: 3	Loss: 0.095864
Client Index = 17	Epoch: 4	Loss: 0.439061
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 18
local mask changes: 438648.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [899288.0, 438648.0, 890880.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.121074
Client Index = 18	Epoch: 1	Loss: 0.152300
Client Index = 18	Epoch: 2	Loss: 0.119382
Client Index = 18	Epoch: 3	Loss: 0.237369
Client Index = 18	Epoch: 4	Loss: 0.100874
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 19
local mask changes: 438832.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [895824.0, 890090.0, 438832.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.239463
Client Index = 19	Epoch: 1	Loss: 0.239400
Client Index = 19	Epoch: 2	Loss: 0.241488
Client Index = 19	Epoch: 3	Loss: 0.113569
Client Index = 19	Epoch: 4	Loss: 0.096690
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.16977540954144207}
################local_test_on_all_clients after local training in communication round: 80
{'test_acc_after': 0.7896223476196575, 'test_loss_after': 0.8148422138361792}
################local_test_on_all_clients before local training in communication round: 80
{'test_acc_before': 0.8110356724320049, 'test_loss_before': 0.6809855282595562}
################Communication round : 81
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 0
local mask changes: 401298.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [401298.0, 866994.0, 871826.0]
Doing local aggregation!
test acc on this client before 436 / 503 : 0.87
Client Index = 0	Epoch: 0	Loss: 0.184183
Client Index = 0	Epoch: 1	Loss: 0.323192
Client Index = 0	Epoch: 2	Loss: 0.129345
Client Index = 0	Epoch: 3	Loss: 0.112282
Client Index = 0	Epoch: 4	Loss: 0.086563
test acc on this client after 432 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 1
local mask changes: 401164.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [865310.0, 401164.0, 854658.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.092294
Client Index = 1	Epoch: 1	Loss: 0.070246
Client Index = 1	Epoch: 2	Loss: 0.160213
Client Index = 1	Epoch: 3	Loss: 0.062691
Client Index = 1	Epoch: 4	Loss: 0.083643
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 2
local mask changes: 401304.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [853216.0, 401304.0, 855300.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.060124
Client Index = 2	Epoch: 1	Loss: 0.095036
Client Index = 2	Epoch: 2	Loss: 0.036536
Client Index = 2	Epoch: 3	Loss: 0.042162
Client Index = 2	Epoch: 4	Loss: 0.016516
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 3
local mask changes: 401354.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [858894.0, 401354.0, 868846.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.168791
Client Index = 3	Epoch: 1	Loss: 0.149073
Client Index = 3	Epoch: 2	Loss: 0.067612
Client Index = 3	Epoch: 3	Loss: 0.046821
Client Index = 3	Epoch: 4	Loss: 0.031106
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 4
local mask changes: 401268.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [869742.0, 401268.0, 877258.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.220864
Client Index = 4	Epoch: 1	Loss: 0.172130
Client Index = 4	Epoch: 2	Loss: 0.191862
Client Index = 4	Epoch: 3	Loss: 0.117494
Client Index = 4	Epoch: 4	Loss: 0.139411
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 5
local mask changes: 401136.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [878614.0, 401136.0, 883802.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.312391
Client Index = 5	Epoch: 1	Loss: 0.202516
Client Index = 5	Epoch: 2	Loss: 0.156230
Client Index = 5	Epoch: 3	Loss: 0.095418
Client Index = 5	Epoch: 4	Loss: 0.090829
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 6
local mask changes: 401172.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [884780.0, 401172.0, 886140.0]
Doing local aggregation!
test acc on this client before 387 / 505 : 0.77
Client Index = 6	Epoch: 0	Loss: 0.228594
Client Index = 6	Epoch: 1	Loss: 0.150630
Client Index = 6	Epoch: 2	Loss: 0.134880
Client Index = 6	Epoch: 3	Loss: 0.100067
Client Index = 6	Epoch: 4	Loss: 0.159097
test acc on this client after 380 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 7
local mask changes: 401340.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [887110.0, 401340.0, 872052.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.573891
Client Index = 7	Epoch: 1	Loss: 0.273000
Client Index = 7	Epoch: 2	Loss: 0.149505
Client Index = 7	Epoch: 3	Loss: 0.417698
Client Index = 7	Epoch: 4	Loss: 0.141547
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 8
local mask changes: 401190.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [865686.0, 401190.0, 860926.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.066342
Client Index = 8	Epoch: 1	Loss: 0.095927
Client Index = 8	Epoch: 2	Loss: 0.041136
Client Index = 8	Epoch: 3	Loss: 0.022484
Client Index = 8	Epoch: 4	Loss: 0.009319
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 9
local mask changes: 401476.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [866366.0, 401476.0, 876158.0]
Doing local aggregation!
test acc on this client before 388 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.171360
Client Index = 9	Epoch: 1	Loss: 0.218350
Client Index = 9	Epoch: 2	Loss: 0.247987
Client Index = 9	Epoch: 3	Loss: 0.108700
Client Index = 9	Epoch: 4	Loss: 0.064967
test acc on this client after 375 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 10
local mask changes: 401538.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [876334.0, 401538.0, 867868.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.268249
Client Index = 10	Epoch: 1	Loss: 0.279491
Client Index = 10	Epoch: 2	Loss: 0.156977
Client Index = 10	Epoch: 3	Loss: 0.351916
Client Index = 10	Epoch: 4	Loss: 0.095169
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 11
local mask changes: 401012.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [864428.0, 401012.0, 863024.0]
Doing local aggregation!
test acc on this client before 425 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.124563
Client Index = 11	Epoch: 1	Loss: 0.065424
Client Index = 11	Epoch: 2	Loss: 0.278491
Client Index = 11	Epoch: 3	Loss: 0.075121
Client Index = 11	Epoch: 4	Loss: 0.052868
test acc on this client after 439 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 12
local mask changes: 401104.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [864670.0, 401104.0, 871102.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.373200
Client Index = 12	Epoch: 1	Loss: 0.119663
Client Index = 12	Epoch: 2	Loss: 0.212515
Client Index = 12	Epoch: 3	Loss: 0.098557
Client Index = 12	Epoch: 4	Loss: 0.095384
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 13
local mask changes: 401342.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [871726.0, 401342.0, 867124.0]
Doing local aggregation!
test acc on this client before 417 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.203605
Client Index = 13	Epoch: 1	Loss: 0.211654
Client Index = 13	Epoch: 2	Loss: 0.064085
Client Index = 13	Epoch: 3	Loss: 0.069869
Client Index = 13	Epoch: 4	Loss: 0.062841
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 14
local mask changes: 401142.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [866496.0, 401142.0, 864958.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.262977
Client Index = 14	Epoch: 1	Loss: 0.168279
Client Index = 14	Epoch: 2	Loss: 0.106257
Client Index = 14	Epoch: 3	Loss: 0.110188
Client Index = 14	Epoch: 4	Loss: 0.398706
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 15
local mask changes: 401178.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [863766.0, 401178.0, 863464.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.353338
Client Index = 15	Epoch: 1	Loss: 0.144399
Client Index = 15	Epoch: 2	Loss: 0.134043
Client Index = 15	Epoch: 3	Loss: 0.076302
Client Index = 15	Epoch: 4	Loss: 0.101753
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 16
local mask changes: 401326.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [864124.0, 401326.0, 874110.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.322855
Client Index = 16	Epoch: 1	Loss: 0.181967
Client Index = 16	Epoch: 2	Loss: 0.160217
Client Index = 16	Epoch: 3	Loss: 0.121854
Client Index = 16	Epoch: 4	Loss: 0.155759
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 17
local mask changes: 401598.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [875872.0, 401598.0, 877176.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.303831
Client Index = 17	Epoch: 1	Loss: 0.143024
Client Index = 17	Epoch: 2	Loss: 0.319518
Client Index = 17	Epoch: 3	Loss: 0.141262
Client Index = 17	Epoch: 4	Loss: 0.145724
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 18
local mask changes: 401236.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [874500.0, 401236.0, 867042.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.117241
Client Index = 18	Epoch: 1	Loss: 0.156697
Client Index = 18	Epoch: 2	Loss: 0.157281
Client Index = 18	Epoch: 3	Loss: 0.076537
Client Index = 18	Epoch: 4	Loss: 0.069380
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 19
local mask changes: 401478.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [872702.0, 867354.0, 401478.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.157449
Client Index = 19	Epoch: 1	Loss: 0.148491
Client Index = 19	Epoch: 2	Loss: 0.159989
Client Index = 19	Epoch: 3	Loss: 0.196887
Client Index = 19	Epoch: 4	Loss: 0.307899
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.1575279422897147}
################local_test_on_all_clients after local training in communication round: 81
{'test_acc_after': 0.8004173882343842, 'test_loss_after': 0.7887642322216379}
################local_test_on_all_clients before local training in communication round: 81
{'test_acc_before': 0.8044839037436583, 'test_loss_before': 0.7097930600019023}
################Communication round : 82
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 0
local mask changes: 365140.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [365140.0, 843862.0, 849598.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.307482
Client Index = 0	Epoch: 1	Loss: 0.101365
Client Index = 0	Epoch: 2	Loss: 0.086132
Client Index = 0	Epoch: 3	Loss: 0.115592
Client Index = 0	Epoch: 4	Loss: 0.101743
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 1
local mask changes: 365134.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [841302.0, 365134.0, 830880.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 1	Epoch: 0	Loss: 0.130406
Client Index = 1	Epoch: 1	Loss: 0.220238
Client Index = 1	Epoch: 2	Loss: 0.175774
Client Index = 1	Epoch: 3	Loss: 0.070056
Client Index = 1	Epoch: 4	Loss: 0.028283
test acc on this client after 446 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 2
local mask changes: 365042.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [830530.0, 365042.0, 833216.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.142845
Client Index = 2	Epoch: 1	Loss: 0.046779
Client Index = 2	Epoch: 2	Loss: 0.038830
Client Index = 2	Epoch: 3	Loss: 0.029441
Client Index = 2	Epoch: 4	Loss: 0.015285
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 3
local mask changes: 365252.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [834456.0, 365252.0, 845230.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.091807
Client Index = 3	Epoch: 1	Loss: 0.154877
Client Index = 3	Epoch: 2	Loss: 0.066959
Client Index = 3	Epoch: 3	Loss: 0.064964
Client Index = 3	Epoch: 4	Loss: 0.252972
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 4
local mask changes: 365108.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [848394.0, 365108.0, 854408.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.220537
Client Index = 4	Epoch: 1	Loss: 0.157757
Client Index = 4	Epoch: 2	Loss: 0.137104
Client Index = 4	Epoch: 3	Loss: 0.269335
Client Index = 4	Epoch: 4	Loss: 0.253989
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 5
local mask changes: 365068.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [855222.0, 365068.0, 861314.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.372627
Client Index = 5	Epoch: 1	Loss: 0.193883
Client Index = 5	Epoch: 2	Loss: 0.151901
Client Index = 5	Epoch: 3	Loss: 0.282290
Client Index = 5	Epoch: 4	Loss: 0.138561
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 6
local mask changes: 365294.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [861234.0, 365294.0, 863840.0]
Doing local aggregation!
test acc on this client before 382 / 505 : 0.76
Client Index = 6	Epoch: 0	Loss: 0.197323
Client Index = 6	Epoch: 1	Loss: 0.172746
Client Index = 6	Epoch: 2	Loss: 0.342196
Client Index = 6	Epoch: 3	Loss: 0.116813
Client Index = 6	Epoch: 4	Loss: 0.124178
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 7
local mask changes: 365088.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [863172.0, 365088.0, 848680.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.445973
Client Index = 7	Epoch: 1	Loss: 0.288501
Client Index = 7	Epoch: 2	Loss: 0.198046
Client Index = 7	Epoch: 3	Loss: 0.355106
Client Index = 7	Epoch: 4	Loss: 0.160120
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 8
local mask changes: 365418.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [843458.0, 365418.0, 837916.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.040465
Client Index = 8	Epoch: 1	Loss: 0.034106
Client Index = 8	Epoch: 2	Loss: 0.055479
Client Index = 8	Epoch: 3	Loss: 0.043928
Client Index = 8	Epoch: 4	Loss: 0.022193
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 9
local mask changes: 365050.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [842148.0, 365050.0, 853690.0]
Doing local aggregation!
test acc on this client before 374 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.207432
Client Index = 9	Epoch: 1	Loss: 0.167952
Client Index = 9	Epoch: 2	Loss: 0.183191
Client Index = 9	Epoch: 3	Loss: 0.121271
Client Index = 9	Epoch: 4	Loss: 0.178232
test acc on this client after 403 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 10
local mask changes: 365170.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [855236.0, 365170.0, 845858.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.180203
Client Index = 10	Epoch: 1	Loss: 0.318620
Client Index = 10	Epoch: 2	Loss: 0.179373
Client Index = 10	Epoch: 3	Loss: 0.074487
Client Index = 10	Epoch: 4	Loss: 0.115376
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 11
local mask changes: 364946.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [842694.0, 364946.0, 839664.0]
Doing local aggregation!
test acc on this client before 425 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.163631
Client Index = 11	Epoch: 1	Loss: 0.066031
Client Index = 11	Epoch: 2	Loss: 0.053047
Client Index = 11	Epoch: 3	Loss: 0.088629
Client Index = 11	Epoch: 4	Loss: 0.280818
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 12
local mask changes: 365080.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [841804.0, 365080.0, 848896.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.111416
Client Index = 12	Epoch: 1	Loss: 0.280473
Client Index = 12	Epoch: 2	Loss: 0.079287
Client Index = 12	Epoch: 3	Loss: 0.221217
Client Index = 12	Epoch: 4	Loss: 0.139736
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 13
local mask changes: 365198.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [848156.0, 365198.0, 844094.0]
Doing local aggregation!
test acc on this client before 415 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.156297
Client Index = 13	Epoch: 1	Loss: 0.146049
Client Index = 13	Epoch: 2	Loss: 0.174407
Client Index = 13	Epoch: 3	Loss: 0.274663
Client Index = 13	Epoch: 4	Loss: 0.062105
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 14
local mask changes: 365036.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [846054.0, 365036.0, 843944.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.203628
Client Index = 14	Epoch: 1	Loss: 0.263966
Client Index = 14	Epoch: 2	Loss: 0.109484
Client Index = 14	Epoch: 3	Loss: 0.158610
Client Index = 14	Epoch: 4	Loss: 0.138160
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 15
local mask changes: 364776.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [841696.0, 364776.0, 840558.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.225672
Client Index = 15	Epoch: 1	Loss: 0.221254
Client Index = 15	Epoch: 2	Loss: 0.129517
Client Index = 15	Epoch: 3	Loss: 0.214862
Client Index = 15	Epoch: 4	Loss: 0.071333
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 16
local mask changes: 365220.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [842058.0, 365220.0, 851442.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.231845
Client Index = 16	Epoch: 1	Loss: 0.263491
Client Index = 16	Epoch: 2	Loss: 0.166487
Client Index = 16	Epoch: 3	Loss: 0.110847
Client Index = 16	Epoch: 4	Loss: 0.216181
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 17
local mask changes: 365404.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [853598.0, 365404.0, 854662.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.349145
Client Index = 17	Epoch: 1	Loss: 0.163418
Client Index = 17	Epoch: 2	Loss: 0.402787
Client Index = 17	Epoch: 3	Loss: 0.163443
Client Index = 17	Epoch: 4	Loss: 0.137488
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 18
local mask changes: 365158.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [852806.0, 365158.0, 844324.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.136690
Client Index = 18	Epoch: 1	Loss: 0.407027
Client Index = 18	Epoch: 2	Loss: 0.093096
Client Index = 18	Epoch: 3	Loss: 0.074940
Client Index = 18	Epoch: 4	Loss: 0.059652
test acc on this client after 418 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 19
local mask changes: 365076.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [849964.0, 845510.0, 365076.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.132875
Client Index = 19	Epoch: 1	Loss: 0.194160
Client Index = 19	Epoch: 2	Loss: 0.244133
Client Index = 19	Epoch: 3	Loss: 0.096298
Client Index = 19	Epoch: 4	Loss: 0.083812
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.16505229296477048}
################local_test_on_all_clients after local training in communication round: 82
{'test_acc_after': 0.8071682158429839, 'test_loss_after': 0.7411740857219182}
################local_test_on_all_clients before local training in communication round: 82
{'test_acc_before': 0.8070752616023243, 'test_loss_before': 0.7059990559073429}
################Communication round : 83
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 0
local mask changes: 330286.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [330286.0, 822172.0, 829042.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.267487
Client Index = 0	Epoch: 1	Loss: 0.087121
Client Index = 0	Epoch: 2	Loss: 0.185997
Client Index = 0	Epoch: 3	Loss: 0.128371
Client Index = 0	Epoch: 4	Loss: 0.109890
test acc on this client after 434 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 1
local mask changes: 330544.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [821114.0, 330544.0, 810532.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.138433
Client Index = 1	Epoch: 1	Loss: 0.069512
Client Index = 1	Epoch: 2	Loss: 0.030793
Client Index = 1	Epoch: 3	Loss: 0.040343
Client Index = 1	Epoch: 4	Loss: 0.327079
test acc on this client after 444 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 2
local mask changes: 330258.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [808218.0, 330258.0, 811218.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.022194
Client Index = 2	Epoch: 1	Loss: 0.018333
Client Index = 2	Epoch: 2	Loss: 0.027020
Client Index = 2	Epoch: 3	Loss: 0.028936
Client Index = 2	Epoch: 4	Loss: 0.046283
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 3
local mask changes: 330280.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [814100.0, 330280.0, 824880.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.079164
Client Index = 3	Epoch: 1	Loss: 0.271859
Client Index = 3	Epoch: 2	Loss: 0.098046
Client Index = 3	Epoch: 3	Loss: 0.035829
Client Index = 3	Epoch: 4	Loss: 0.027037
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 4
local mask changes: 330310.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [828364.0, 330310.0, 835158.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.143038
Client Index = 4	Epoch: 1	Loss: 0.085301
Client Index = 4	Epoch: 2	Loss: 0.322106
Client Index = 4	Epoch: 3	Loss: 0.081286
Client Index = 4	Epoch: 4	Loss: 0.315876
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 5
local mask changes: 330256.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [835578.0, 330256.0, 840572.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.162422
Client Index = 5	Epoch: 1	Loss: 0.189445
Client Index = 5	Epoch: 2	Loss: 0.194219
Client Index = 5	Epoch: 3	Loss: 0.177264
Client Index = 5	Epoch: 4	Loss: 0.139096
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 6
local mask changes: 330228.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [841346.0, 330228.0, 843498.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.162714
Client Index = 6	Epoch: 1	Loss: 0.509114
Client Index = 6	Epoch: 2	Loss: 0.135054
Client Index = 6	Epoch: 3	Loss: 0.139809
Client Index = 6	Epoch: 4	Loss: 0.177556
test acc on this client after 387 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 7
local mask changes: 330374.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [843410.0, 330374.0, 828088.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 7	Epoch: 0	Loss: 0.495505
Client Index = 7	Epoch: 1	Loss: 0.249258
Client Index = 7	Epoch: 2	Loss: 0.288117
Client Index = 7	Epoch: 3	Loss: 0.161760
Client Index = 7	Epoch: 4	Loss: 0.230893
test acc on this client after 373 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 8
local mask changes: 330158.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [822026.0, 330158.0, 815972.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.065388
Client Index = 8	Epoch: 1	Loss: 0.051983
Client Index = 8	Epoch: 2	Loss: 0.034552
Client Index = 8	Epoch: 3	Loss: 0.018460
Client Index = 8	Epoch: 4	Loss: 0.011613
test acc on this client after 471 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 9
local mask changes: 330184.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [820584.0, 330184.0, 833000.0]
Doing local aggregation!
test acc on this client before 386 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.191575
Client Index = 9	Epoch: 1	Loss: 0.337847
Client Index = 9	Epoch: 2	Loss: 0.119412
Client Index = 9	Epoch: 3	Loss: 0.085230
Client Index = 9	Epoch: 4	Loss: 0.161373
test acc on this client after 365 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 10
local mask changes: 330372.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [832856.0, 330372.0, 823256.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.234461
Client Index = 10	Epoch: 1	Loss: 0.321255
Client Index = 10	Epoch: 2	Loss: 0.241890
Client Index = 10	Epoch: 3	Loss: 0.153405
Client Index = 10	Epoch: 4	Loss: 0.099445
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 11
local mask changes: 330226.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [821822.0, 330226.0, 818420.0]
Doing local aggregation!
test acc on this client before 424 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.106794
Client Index = 11	Epoch: 1	Loss: 0.079807
Client Index = 11	Epoch: 2	Loss: 0.266696
Client Index = 11	Epoch: 3	Loss: 0.047561
Client Index = 11	Epoch: 4	Loss: 0.037453
test acc on this client after 444 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 12
local mask changes: 330326.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [820232.0, 330326.0, 828168.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.137997
Client Index = 12	Epoch: 1	Loss: 0.281207
Client Index = 12	Epoch: 2	Loss: 0.060127
Client Index = 12	Epoch: 3	Loss: 0.069081
Client Index = 12	Epoch: 4	Loss: 0.094717
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 13
local mask changes: 330110.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [827046.0, 330110.0, 824518.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.178479
Client Index = 13	Epoch: 1	Loss: 0.312969
Client Index = 13	Epoch: 2	Loss: 0.258305
Client Index = 13	Epoch: 3	Loss: 0.121571
Client Index = 13	Epoch: 4	Loss: 0.061315
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 14
local mask changes: 330244.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [824032.0, 330244.0, 822644.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.184731
Client Index = 14	Epoch: 1	Loss: 0.245050
Client Index = 14	Epoch: 2	Loss: 0.117357
Client Index = 14	Epoch: 3	Loss: 0.072602
Client Index = 14	Epoch: 4	Loss: 0.099319
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 15
local mask changes: 330076.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [822144.0, 330076.0, 820298.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.198517
Client Index = 15	Epoch: 1	Loss: 0.106516
Client Index = 15	Epoch: 2	Loss: 0.106180
Client Index = 15	Epoch: 3	Loss: 0.220116
Client Index = 15	Epoch: 4	Loss: 0.171215
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 16
local mask changes: 329956.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [821074.0, 329956.0, 830622.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 16	Epoch: 0	Loss: 0.149301
Client Index = 16	Epoch: 1	Loss: 0.366858
Client Index = 16	Epoch: 2	Loss: 0.230025
Client Index = 16	Epoch: 3	Loss: 0.111732
Client Index = 16	Epoch: 4	Loss: 0.078390
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 17
local mask changes: 330154.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [832856.0, 330154.0, 833684.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.312177
Client Index = 17	Epoch: 1	Loss: 0.351031
Client Index = 17	Epoch: 2	Loss: 0.150760
Client Index = 17	Epoch: 3	Loss: 0.161584
Client Index = 17	Epoch: 4	Loss: 0.130896
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 18
local mask changes: 330408.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [830960.0, 330408.0, 823206.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.115916
Client Index = 18	Epoch: 1	Loss: 0.289763
Client Index = 18	Epoch: 2	Loss: 0.079501
Client Index = 18	Epoch: 3	Loss: 0.071162
Client Index = 18	Epoch: 4	Loss: 0.098537
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 19
local mask changes: 330274.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [829130.0, 824140.0, 330274.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.178562
Client Index = 19	Epoch: 1	Loss: 0.196295
Client Index = 19	Epoch: 2	Loss: 0.152515
Client Index = 19	Epoch: 3	Loss: 0.156670
Client Index = 19	Epoch: 4	Loss: 0.278750
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.15823558477591726}
################local_test_on_all_clients after local training in communication round: 83
{'test_acc_after': 0.7970410140414532, 'test_loss_after': 0.8058002751636304}
################local_test_on_all_clients before local training in communication round: 83
{'test_acc_before': 0.8083626187331945, 'test_loss_before': 0.693963447516841}
################Communication round : 84
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 0
local mask changes: 296688.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [296688.0, 803082.0, 809382.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 0	Epoch: 0	Loss: 0.229335
Client Index = 0	Epoch: 1	Loss: 0.241949
Client Index = 0	Epoch: 2	Loss: 0.062759
Client Index = 0	Epoch: 3	Loss: 0.059836
Client Index = 0	Epoch: 4	Loss: 0.179797
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 1
local mask changes: 296758.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [801842.0, 296758.0, 791194.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.088588
Client Index = 1	Epoch: 1	Loss: 0.155237
Client Index = 1	Epoch: 2	Loss: 0.055911
Client Index = 1	Epoch: 3	Loss: 0.039054
Client Index = 1	Epoch: 4	Loss: 0.025295
test acc on this client after 437 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 2
local mask changes: 296882.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [787830.0, 296882.0, 791190.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.056437
Client Index = 2	Epoch: 1	Loss: 0.038649
Client Index = 2	Epoch: 2	Loss: 0.062311
Client Index = 2	Epoch: 3	Loss: 0.063743
Client Index = 2	Epoch: 4	Loss: 0.064677
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 3
local mask changes: 296764.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [793212.0, 296764.0, 806452.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.121931
Client Index = 3	Epoch: 1	Loss: 0.084525
Client Index = 3	Epoch: 2	Loss: 0.106716
Client Index = 3	Epoch: 3	Loss: 0.064699
Client Index = 3	Epoch: 4	Loss: 0.091902
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 4
local mask changes: 296762.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [810378.0, 296762.0, 817210.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.106897
Client Index = 4	Epoch: 1	Loss: 0.141108
Client Index = 4	Epoch: 2	Loss: 0.095759
Client Index = 4	Epoch: 3	Loss: 0.494610
Client Index = 4	Epoch: 4	Loss: 0.107136
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 5
local mask changes: 296710.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [818708.0, 296710.0, 822496.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.140808
Client Index = 5	Epoch: 1	Loss: 0.181417
Client Index = 5	Epoch: 2	Loss: 0.416683
Client Index = 5	Epoch: 3	Loss: 0.112608
Client Index = 5	Epoch: 4	Loss: 0.090406
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 6
local mask changes: 297086.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [823220.0, 297086.0, 825466.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.140428
Client Index = 6	Epoch: 1	Loss: 0.223839
Client Index = 6	Epoch: 2	Loss: 0.170107
Client Index = 6	Epoch: 3	Loss: 0.189807
Client Index = 6	Epoch: 4	Loss: 0.092794
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 7
local mask changes: 296756.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [825146.0, 296756.0, 809436.0]
Doing local aggregation!
test acc on this client before 364 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.327298
Client Index = 7	Epoch: 1	Loss: 0.345099
Client Index = 7	Epoch: 2	Loss: 0.200145
Client Index = 7	Epoch: 3	Loss: 0.241850
Client Index = 7	Epoch: 4	Loss: 0.270288
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 8
local mask changes: 296676.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [802980.0, 296676.0, 796410.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.098666
Client Index = 8	Epoch: 1	Loss: 0.031537
Client Index = 8	Epoch: 2	Loss: 0.019363
Client Index = 8	Epoch: 3	Loss: 0.019168
Client Index = 8	Epoch: 4	Loss: 0.020433
test acc on this client after 468 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 9
local mask changes: 297014.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [800550.0, 297014.0, 812580.0]
Doing local aggregation!
test acc on this client before 382 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.097275
Client Index = 9	Epoch: 1	Loss: 0.296993
Client Index = 9	Epoch: 2	Loss: 0.392807
Client Index = 9	Epoch: 3	Loss: 0.101115
Client Index = 9	Epoch: 4	Loss: 0.078300
test acc on this client after 394 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 10
local mask changes: 297036.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [813092.0, 297036.0, 803528.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 10	Epoch: 0	Loss: 0.231288
Client Index = 10	Epoch: 1	Loss: 0.191069
Client Index = 10	Epoch: 2	Loss: 0.189100
Client Index = 10	Epoch: 3	Loss: 0.217292
Client Index = 10	Epoch: 4	Loss: 0.313291
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 11
local mask changes: 296822.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [801074.0, 296822.0, 798732.0]
Doing local aggregation!
test acc on this client before 423 / 505 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.211954
Client Index = 11	Epoch: 1	Loss: 0.100736
Client Index = 11	Epoch: 2	Loss: 0.042269
Client Index = 11	Epoch: 3	Loss: 0.039108
Client Index = 11	Epoch: 4	Loss: 0.042377
test acc on this client after 427 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 12
local mask changes: 297022.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [800466.0, 297022.0, 809050.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.150254
Client Index = 12	Epoch: 1	Loss: 0.378297
Client Index = 12	Epoch: 2	Loss: 0.100400
Client Index = 12	Epoch: 3	Loss: 0.090943
Client Index = 12	Epoch: 4	Loss: 0.245987
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 13
local mask changes: 296790.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [809722.0, 296790.0, 805524.0]
Doing local aggregation!
test acc on this client before 408 / 505 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.203811
Client Index = 13	Epoch: 1	Loss: 0.257675
Client Index = 13	Epoch: 2	Loss: 0.076325
Client Index = 13	Epoch: 3	Loss: 0.073340
Client Index = 13	Epoch: 4	Loss: 0.138552
test acc on this client after 354 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 14
local mask changes: 296874.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [805494.0, 296874.0, 803902.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.190712
Client Index = 14	Epoch: 1	Loss: 0.204145
Client Index = 14	Epoch: 2	Loss: 0.079758
Client Index = 14	Epoch: 3	Loss: 0.192222
Client Index = 14	Epoch: 4	Loss: 0.070955
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 15
local mask changes: 296880.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [802690.0, 296880.0, 801658.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.179016
Client Index = 15	Epoch: 1	Loss: 0.125260
Client Index = 15	Epoch: 2	Loss: 0.102841
Client Index = 15	Epoch: 3	Loss: 0.114561
Client Index = 15	Epoch: 4	Loss: 0.108416
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 16
local mask changes: 296906.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [801486.0, 296906.0, 811576.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.209834
Client Index = 16	Epoch: 1	Loss: 0.188466
Client Index = 16	Epoch: 2	Loss: 0.138350
Client Index = 16	Epoch: 3	Loss: 0.075669
Client Index = 16	Epoch: 4	Loss: 0.265347
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 17
local mask changes: 296826.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [813576.0, 296826.0, 814058.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.267904
Client Index = 17	Epoch: 1	Loss: 0.186493
Client Index = 17	Epoch: 2	Loss: 0.274642
Client Index = 17	Epoch: 3	Loss: 0.169787
Client Index = 17	Epoch: 4	Loss: 0.112398
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 18
local mask changes: 296362.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [811994.0, 296362.0, 803364.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.238571
Client Index = 18	Epoch: 1	Loss: 0.195756
Client Index = 18	Epoch: 2	Loss: 0.091466
Client Index = 18	Epoch: 3	Loss: 0.071235
Client Index = 18	Epoch: 4	Loss: 0.066906
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 19
local mask changes: 296812.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [811986.0, 806788.0, 296812.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.130941
Client Index = 19	Epoch: 1	Loss: 0.206990
Client Index = 19	Epoch: 2	Loss: 0.130741
Client Index = 19	Epoch: 3	Loss: 0.110636
Client Index = 19	Epoch: 4	Loss: 0.072018
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.1500420346558094}
################local_test_on_all_clients after local training in communication round: 84
{'test_acc_after': 0.7978488738041901, 'test_loss_after': 0.7741441090725385}
################local_test_on_all_clients before local training in communication round: 84
{'test_acc_before': 0.8087612004658972, 'test_loss_before': 0.6893243236007619}
################Communication round : 85
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 0
local mask changes: 264938.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [264938.0, 785970.0, 794174.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.442251
Client Index = 0	Epoch: 1	Loss: 0.109376
Client Index = 0	Epoch: 2	Loss: 0.073262
Client Index = 0	Epoch: 3	Loss: 0.205405
Client Index = 0	Epoch: 4	Loss: 0.064851
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 1
local mask changes: 264868.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [783220.0, 264868.0, 770866.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 1	Epoch: 0	Loss: 0.212393
Client Index = 1	Epoch: 1	Loss: 0.151637
Client Index = 1	Epoch: 2	Loss: 0.068758
Client Index = 1	Epoch: 3	Loss: 0.038495
Client Index = 1	Epoch: 4	Loss: 0.051176
test acc on this client after 452 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 2
local mask changes: 264638.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [771920.0, 264638.0, 773188.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.036694
Client Index = 2	Epoch: 1	Loss: 0.031594
Client Index = 2	Epoch: 2	Loss: 0.025333
Client Index = 2	Epoch: 3	Loss: 0.048484
Client Index = 2	Epoch: 4	Loss: 0.027905
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 3
local mask changes: 264928.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [774604.0, 264928.0, 789434.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.090942
Client Index = 3	Epoch: 1	Loss: 0.037685
Client Index = 3	Epoch: 2	Loss: 0.060478
Client Index = 3	Epoch: 3	Loss: 0.048653
Client Index = 3	Epoch: 4	Loss: 0.435871
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 4
local mask changes: 264480.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [792144.0, 264480.0, 800420.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.133566
Client Index = 4	Epoch: 1	Loss: 0.187786
Client Index = 4	Epoch: 2	Loss: 0.358269
Client Index = 4	Epoch: 3	Loss: 0.088903
Client Index = 4	Epoch: 4	Loss: 0.069478
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 5
local mask changes: 264618.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [801294.0, 264618.0, 805012.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.231937
Client Index = 5	Epoch: 1	Loss: 0.214411
Client Index = 5	Epoch: 2	Loss: 0.277491
Client Index = 5	Epoch: 3	Loss: 0.130513
Client Index = 5	Epoch: 4	Loss: 0.070718
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 6
local mask changes: 264774.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [805710.0, 264774.0, 808558.0]
Doing local aggregation!
test acc on this client before 399 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.228260
Client Index = 6	Epoch: 1	Loss: 0.321691
Client Index = 6	Epoch: 2	Loss: 0.107923
Client Index = 6	Epoch: 3	Loss: 0.080094
Client Index = 6	Epoch: 4	Loss: 0.206659
test acc on this client after 380 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 7
local mask changes: 264904.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [809786.0, 264904.0, 791848.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 7	Epoch: 0	Loss: 0.337931
Client Index = 7	Epoch: 1	Loss: 0.330932
Client Index = 7	Epoch: 2	Loss: 0.317875
Client Index = 7	Epoch: 3	Loss: 0.183701
Client Index = 7	Epoch: 4	Loss: 0.131802
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 8
local mask changes: 264630.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [785442.0, 264630.0, 778456.0]
Doing local aggregation!
test acc on this client before 456 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.093164
Client Index = 8	Epoch: 1	Loss: 0.036763
Client Index = 8	Epoch: 2	Loss: 0.188878
Client Index = 8	Epoch: 3	Loss: 0.023179
Client Index = 8	Epoch: 4	Loss: 0.016057
test acc on this client after 471 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 9
local mask changes: 264858.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [782228.0, 264858.0, 795138.0]
Doing local aggregation!
test acc on this client before 382 / 506 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.143809
Client Index = 9	Epoch: 1	Loss: 0.409425
Client Index = 9	Epoch: 2	Loss: 0.094675
Client Index = 9	Epoch: 3	Loss: 0.102850
Client Index = 9	Epoch: 4	Loss: 0.153553
test acc on this client after 395 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 10
local mask changes: 264800.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [796836.0, 264800.0, 787246.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.231287
Client Index = 10	Epoch: 1	Loss: 0.118550
Client Index = 10	Epoch: 2	Loss: 0.294829
Client Index = 10	Epoch: 3	Loss: 0.121824
Client Index = 10	Epoch: 4	Loss: 0.054418
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 11
local mask changes: 264526.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [782414.0, 264526.0, 779756.0]
Doing local aggregation!
test acc on this client before 416 / 505 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.096860
Client Index = 11	Epoch: 1	Loss: 0.317947
Client Index = 11	Epoch: 2	Loss: 0.060083
Client Index = 11	Epoch: 3	Loss: 0.038833
Client Index = 11	Epoch: 4	Loss: 0.077987
test acc on this client after 446 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 12
local mask changes: 264674.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [783046.0, 264674.0, 793096.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.159945
Client Index = 12	Epoch: 1	Loss: 0.304871
Client Index = 12	Epoch: 2	Loss: 0.146897
Client Index = 12	Epoch: 3	Loss: 0.213239
Client Index = 12	Epoch: 4	Loss: 0.069388
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 13
local mask changes: 264396.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [793180.0, 264396.0, 789838.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.226271
Client Index = 13	Epoch: 1	Loss: 0.160783
Client Index = 13	Epoch: 2	Loss: 0.142566
Client Index = 13	Epoch: 3	Loss: 0.110163
Client Index = 13	Epoch: 4	Loss: 0.063959
test acc on this client after 393 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 14
local mask changes: 264764.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [787744.0, 264764.0, 785486.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.138057
Client Index = 14	Epoch: 1	Loss: 0.275647
Client Index = 14	Epoch: 2	Loss: 0.226042
Client Index = 14	Epoch: 3	Loss: 0.111815
Client Index = 14	Epoch: 4	Loss: 0.058866
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 15
local mask changes: 264780.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [785178.0, 264780.0, 783272.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.179887
Client Index = 15	Epoch: 1	Loss: 0.093883
Client Index = 15	Epoch: 2	Loss: 0.164062
Client Index = 15	Epoch: 3	Loss: 0.101376
Client Index = 15	Epoch: 4	Loss: 0.112805
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 16
local mask changes: 264740.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [784498.0, 264740.0, 794690.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.217094
Client Index = 16	Epoch: 1	Loss: 0.255068
Client Index = 16	Epoch: 2	Loss: 0.167729
Client Index = 16	Epoch: 3	Loss: 0.114960
Client Index = 16	Epoch: 4	Loss: 0.192934
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 17
local mask changes: 264806.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [796202.0, 264806.0, 796196.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.167647
Client Index = 17	Epoch: 1	Loss: 0.308098
Client Index = 17	Epoch: 2	Loss: 0.121655
Client Index = 17	Epoch: 3	Loss: 0.196687
Client Index = 17	Epoch: 4	Loss: 0.194164
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 18
local mask changes: 264914.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [794618.0, 264914.0, 787968.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.502500
Client Index = 18	Epoch: 1	Loss: 0.149900
Client Index = 18	Epoch: 2	Loss: 0.071559
Client Index = 18	Epoch: 3	Loss: 0.043382
Client Index = 18	Epoch: 4	Loss: 0.075054
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 19
local mask changes: 264954.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [793688.0, 788478.0, 264954.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.106580
Client Index = 19	Epoch: 1	Loss: 0.222656
Client Index = 19	Epoch: 2	Loss: 0.166570
Client Index = 19	Epoch: 3	Loss: 0.119535
Client Index = 19	Epoch: 4	Loss: 0.063492
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.15463941828708627}
################local_test_on_all_clients after local training in communication round: 85
{'test_acc_after': 0.8110431678810546, 'test_loss_after': 0.7421676510130154}
################local_test_on_all_clients before local training in communication round: 85
{'test_acc_before': 0.8100573775133093, 'test_loss_before': 0.6913546972080349}
################Communication round : 86
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 0
local mask changes: 234246.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [234246.0, 769230.0, 777394.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.333014
Client Index = 0	Epoch: 1	Loss: 0.137290
Client Index = 0	Epoch: 2	Loss: 0.111443
Client Index = 0	Epoch: 3	Loss: 0.052796
Client Index = 0	Epoch: 4	Loss: 0.069003
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 1
local mask changes: 234180.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [766852.0, 234180.0, 754718.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.280445
Client Index = 1	Epoch: 1	Loss: 0.106048
Client Index = 1	Epoch: 2	Loss: 0.047934
Client Index = 1	Epoch: 3	Loss: 0.094614
Client Index = 1	Epoch: 4	Loss: 0.042477
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 2
local mask changes: 234418.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [753558.0, 234418.0, 756872.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.052414
Client Index = 2	Epoch: 1	Loss: 0.069165
Client Index = 2	Epoch: 2	Loss: 0.036135
Client Index = 2	Epoch: 3	Loss: 0.051232
Client Index = 2	Epoch: 4	Loss: 0.040478
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 3
local mask changes: 234504.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [760396.0, 234504.0, 775534.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.064943
Client Index = 3	Epoch: 1	Loss: 0.164628
Client Index = 3	Epoch: 2	Loss: 0.207267
Client Index = 3	Epoch: 3	Loss: 0.047455
Client Index = 3	Epoch: 4	Loss: 0.036349
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 4
local mask changes: 234346.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [776352.0, 234346.0, 783918.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.077014
Client Index = 4	Epoch: 1	Loss: 0.170378
Client Index = 4	Epoch: 2	Loss: 0.120754
Client Index = 4	Epoch: 3	Loss: 0.266605
Client Index = 4	Epoch: 4	Loss: 0.070069
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 5
local mask changes: 234312.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [785084.0, 234312.0, 789330.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.399630
Client Index = 5	Epoch: 1	Loss: 0.221605
Client Index = 5	Epoch: 2	Loss: 0.102505
Client Index = 5	Epoch: 3	Loss: 0.274506
Client Index = 5	Epoch: 4	Loss: 0.068797
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 6
local mask changes: 234282.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [790692.0, 234282.0, 794244.0]
Doing local aggregation!
test acc on this client before 400 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.187259
Client Index = 6	Epoch: 1	Loss: 0.249567
Client Index = 6	Epoch: 2	Loss: 0.162105
Client Index = 6	Epoch: 3	Loss: 0.079389
Client Index = 6	Epoch: 4	Loss: 0.058277
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 7
local mask changes: 234214.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [793428.0, 234214.0, 775564.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 7	Epoch: 0	Loss: 0.414171
Client Index = 7	Epoch: 1	Loss: 0.216625
Client Index = 7	Epoch: 2	Loss: 0.234672
Client Index = 7	Epoch: 3	Loss: 0.369976
Client Index = 7	Epoch: 4	Loss: 0.154645
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 8
local mask changes: 234400.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [770564.0, 234400.0, 762004.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.048676
Client Index = 8	Epoch: 1	Loss: 0.044473
Client Index = 8	Epoch: 2	Loss: 0.028421
Client Index = 8	Epoch: 3	Loss: 0.034085
Client Index = 8	Epoch: 4	Loss: 0.012019
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 9
local mask changes: 234224.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [765996.0, 234224.0, 780544.0]
Doing local aggregation!
test acc on this client before 396 / 506 : 0.78
Client Index = 9	Epoch: 0	Loss: 0.205044
Client Index = 9	Epoch: 1	Loss: 0.268335
Client Index = 9	Epoch: 2	Loss: 0.102934
Client Index = 9	Epoch: 3	Loss: 0.168357
Client Index = 9	Epoch: 4	Loss: 0.185466
test acc on this client after 398 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 10
local mask changes: 234294.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [780170.0, 234294.0, 769608.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.207715
Client Index = 10	Epoch: 1	Loss: 0.174538
Client Index = 10	Epoch: 2	Loss: 0.096140
Client Index = 10	Epoch: 3	Loss: 0.262598
Client Index = 10	Epoch: 4	Loss: 0.088073
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 11
local mask changes: 234176.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [768260.0, 234176.0, 764094.0]
Doing local aggregation!
test acc on this client before 428 / 505 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.078671
Client Index = 11	Epoch: 1	Loss: 0.314538
Client Index = 11	Epoch: 2	Loss: 0.078595
Client Index = 11	Epoch: 3	Loss: 0.040274
Client Index = 11	Epoch: 4	Loss: 0.030739
test acc on this client after 436 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 12
local mask changes: 234448.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [766950.0, 234448.0, 778928.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 12	Epoch: 0	Loss: 0.398544
Client Index = 12	Epoch: 1	Loss: 0.194342
Client Index = 12	Epoch: 2	Loss: 0.098486
Client Index = 12	Epoch: 3	Loss: 0.067080
Client Index = 12	Epoch: 4	Loss: 0.351720
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 13
local mask changes: 234396.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [778064.0, 234396.0, 773746.0]
Doing local aggregation!
test acc on this client before 420 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.102477
Client Index = 13	Epoch: 1	Loss: 0.236712
Client Index = 13	Epoch: 2	Loss: 0.181284
Client Index = 13	Epoch: 3	Loss: 0.084718
Client Index = 13	Epoch: 4	Loss: 0.039820
test acc on this client after 410 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 14
local mask changes: 234352.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [772936.0, 234352.0, 769234.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.259840
Client Index = 14	Epoch: 1	Loss: 0.234509
Client Index = 14	Epoch: 2	Loss: 0.100734
Client Index = 14	Epoch: 3	Loss: 0.133335
Client Index = 14	Epoch: 4	Loss: 0.068395
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 15
local mask changes: 234342.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [768298.0, 234342.0, 766878.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.145774
Client Index = 15	Epoch: 1	Loss: 0.368132
Client Index = 15	Epoch: 2	Loss: 0.127342
Client Index = 15	Epoch: 3	Loss: 0.097573
Client Index = 15	Epoch: 4	Loss: 0.109428
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 16
local mask changes: 234436.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [768536.0, 234436.0, 779836.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.123529
Client Index = 16	Epoch: 1	Loss: 0.214265
Client Index = 16	Epoch: 2	Loss: 0.129380
Client Index = 16	Epoch: 3	Loss: 0.136412
Client Index = 16	Epoch: 4	Loss: 0.100391
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 17
local mask changes: 234278.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [781022.0, 234278.0, 780958.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.200316
Client Index = 17	Epoch: 1	Loss: 0.275894
Client Index = 17	Epoch: 2	Loss: 0.101543
Client Index = 17	Epoch: 3	Loss: 0.332217
Client Index = 17	Epoch: 4	Loss: 0.074442
test acc on this client after 369 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 18
local mask changes: 234302.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [779014.0, 234302.0, 771692.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.154818
Client Index = 18	Epoch: 1	Loss: 0.210398
Client Index = 18	Epoch: 2	Loss: 0.090996
Client Index = 18	Epoch: 3	Loss: 0.086421
Client Index = 18	Epoch: 4	Loss: 0.389439
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 19
local mask changes: 234404.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [777228.0, 771260.0, 234404.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.225922
Client Index = 19	Epoch: 1	Loss: 0.103608
Client Index = 19	Epoch: 2	Loss: 0.272263
Client Index = 19	Epoch: 3	Loss: 0.154305
Client Index = 19	Epoch: 4	Loss: 0.090378
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.15280556265986525}
################local_test_on_all_clients after local training in communication round: 86
{'test_acc_after': 0.7980290160188611, 'test_loss_after': 0.7811523904113864}
################local_test_on_all_clients before local training in communication round: 86
{'test_acc_before': 0.8189757562218813, 'test_loss_before': 0.6763737124393931}
################Communication round : 87
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 0
local mask changes: 205422.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [205422.0, 754620.0, 762606.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 0	Epoch: 0	Loss: 0.139809
Client Index = 0	Epoch: 1	Loss: 0.360027
Client Index = 0	Epoch: 2	Loss: 0.106643
Client Index = 0	Epoch: 3	Loss: 0.060389
Client Index = 0	Epoch: 4	Loss: 0.172793
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 1
local mask changes: 205360.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [753162.0, 205360.0, 740240.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.070960
Client Index = 1	Epoch: 1	Loss: 0.280553
Client Index = 1	Epoch: 2	Loss: 0.074916
Client Index = 1	Epoch: 3	Loss: 0.051186
Client Index = 1	Epoch: 4	Loss: 0.040011
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 2
local mask changes: 205530.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [739002.0, 205530.0, 744144.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.033252
Client Index = 2	Epoch: 1	Loss: 0.022617
Client Index = 2	Epoch: 2	Loss: 0.037294
Client Index = 2	Epoch: 3	Loss: 0.040531
Client Index = 2	Epoch: 4	Loss: 0.024982
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 3
local mask changes: 205494.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [745448.0, 205494.0, 761136.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 3	Epoch: 0	Loss: 0.076150
Client Index = 3	Epoch: 1	Loss: 0.175548
Client Index = 3	Epoch: 2	Loss: 0.045379
Client Index = 3	Epoch: 3	Loss: 0.041516
Client Index = 3	Epoch: 4	Loss: 0.046408
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 4
local mask changes: 205384.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [762136.0, 205384.0, 769216.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.168021
Client Index = 4	Epoch: 1	Loss: 0.109831
Client Index = 4	Epoch: 2	Loss: 0.108150
Client Index = 4	Epoch: 3	Loss: 0.106953
Client Index = 4	Epoch: 4	Loss: 0.337151
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 5
local mask changes: 205658.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [770150.0, 205658.0, 776238.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.220750
Client Index = 5	Epoch: 1	Loss: 0.173642
Client Index = 5	Epoch: 2	Loss: 0.105486
Client Index = 5	Epoch: 3	Loss: 0.103531
Client Index = 5	Epoch: 4	Loss: 0.194379
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 6
local mask changes: 205638.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [775494.0, 205638.0, 779130.0]
Doing local aggregation!
test acc on this client before 398 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.149129
Client Index = 6	Epoch: 1	Loss: 0.203254
Client Index = 6	Epoch: 2	Loss: 0.173344
Client Index = 6	Epoch: 3	Loss: 0.103554
Client Index = 6	Epoch: 4	Loss: 0.079099
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 7
local mask changes: 205238.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [780034.0, 205238.0, 761334.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.361015
Client Index = 7	Epoch: 1	Loss: 0.435703
Client Index = 7	Epoch: 2	Loss: 0.223277
Client Index = 7	Epoch: 3	Loss: 0.136614
Client Index = 7	Epoch: 4	Loss: 0.247979
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 8
local mask changes: 205414.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [755754.0, 205414.0, 747408.0]
Doing local aggregation!
test acc on this client before 470 / 504 : 0.93
Client Index = 8	Epoch: 0	Loss: 0.132567
Client Index = 8	Epoch: 1	Loss: 0.244572
Client Index = 8	Epoch: 2	Loss: 0.025918
Client Index = 8	Epoch: 3	Loss: 0.018875
Client Index = 8	Epoch: 4	Loss: 0.012999
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 9
local mask changes: 205460.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [752202.0, 205460.0, 766550.0]
Doing local aggregation!
test acc on this client before 375 / 506 : 0.74
Client Index = 9	Epoch: 0	Loss: 0.259715
Client Index = 9	Epoch: 1	Loss: 0.123212
Client Index = 9	Epoch: 2	Loss: 0.273516
Client Index = 9	Epoch: 3	Loss: 0.191095
Client Index = 9	Epoch: 4	Loss: 0.074478
test acc on this client after 395 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 10
local mask changes: 205452.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [765480.0, 205452.0, 754630.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.192559
Client Index = 10	Epoch: 1	Loss: 0.159651
Client Index = 10	Epoch: 2	Loss: 0.245284
Client Index = 10	Epoch: 3	Loss: 0.105386
Client Index = 10	Epoch: 4	Loss: 0.091262
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 11
local mask changes: 205308.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [752752.0, 205308.0, 750936.0]
Doing local aggregation!
test acc on this client before 434 / 505 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.090838
Client Index = 11	Epoch: 1	Loss: 0.231512
Client Index = 11	Epoch: 2	Loss: 0.045072
Client Index = 11	Epoch: 3	Loss: 0.037210
Client Index = 11	Epoch: 4	Loss: 0.046845
test acc on this client after 430 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 12
local mask changes: 205604.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [754752.0, 205604.0, 766608.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.236218
Client Index = 12	Epoch: 1	Loss: 0.108272
Client Index = 12	Epoch: 2	Loss: 0.081672
Client Index = 12	Epoch: 3	Loss: 0.137975
Client Index = 12	Epoch: 4	Loss: 0.074275
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 13
local mask changes: 205282.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [763726.0, 205282.0, 758700.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.279438
Client Index = 13	Epoch: 1	Loss: 0.091811
Client Index = 13	Epoch: 2	Loss: 0.082834
Client Index = 13	Epoch: 3	Loss: 0.051711
Client Index = 13	Epoch: 4	Loss: 0.075970
test acc on this client after 325 / 505 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 14
local mask changes: 205286.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [758890.0, 205286.0, 754674.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.235388
Client Index = 14	Epoch: 1	Loss: 0.225011
Client Index = 14	Epoch: 2	Loss: 0.103078
Client Index = 14	Epoch: 3	Loss: 0.081998
Client Index = 14	Epoch: 4	Loss: 0.078681
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 15
local mask changes: 205494.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [754260.0, 205494.0, 753504.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.177182
Client Index = 15	Epoch: 1	Loss: 0.186215
Client Index = 15	Epoch: 2	Loss: 0.187587
Client Index = 15	Epoch: 3	Loss: 0.096776
Client Index = 15	Epoch: 4	Loss: 0.065361
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 16
local mask changes: 205302.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [753572.0, 205302.0, 765882.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.089576
Client Index = 16	Epoch: 1	Loss: 0.329710
Client Index = 16	Epoch: 2	Loss: 0.201164
Client Index = 16	Epoch: 3	Loss: 0.129563
Client Index = 16	Epoch: 4	Loss: 0.079879
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 17
local mask changes: 205540.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [767548.0, 205540.0, 767040.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 17	Epoch: 0	Loss: 0.194746
Client Index = 17	Epoch: 1	Loss: 0.280758
Client Index = 17	Epoch: 2	Loss: 0.353009
Client Index = 17	Epoch: 3	Loss: 0.100844
Client Index = 17	Epoch: 4	Loss: 0.194146
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 18
local mask changes: 205354.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [767466.0, 205354.0, 759040.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.080811
Client Index = 18	Epoch: 1	Loss: 0.076914
Client Index = 18	Epoch: 2	Loss: 0.120123
Client Index = 18	Epoch: 3	Loss: 0.051481
Client Index = 18	Epoch: 4	Loss: 0.141632
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 19
local mask changes: 205378.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [764010.0, 758150.0, 205378.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.108804
Client Index = 19	Epoch: 1	Loss: 0.118298
Client Index = 19	Epoch: 2	Loss: 0.145857
Client Index = 19	Epoch: 3	Loss: 0.411089
Client Index = 19	Epoch: 4	Loss: 0.083032
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.14193281159061005}
################local_test_on_all_clients after local training in communication round: 87
{'test_acc_after': 0.7884982253720352, 'test_loss_after': 0.8458274037671492}
################local_test_on_all_clients before local training in communication round: 87
{'test_acc_before': 0.8118330456336942, 'test_loss_before': 0.6968224864696412}
################Communication round : 88
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 0
local mask changes: 178134.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [178134.0, 743374.0, 752170.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.159883
Client Index = 0	Epoch: 1	Loss: 0.107189
Client Index = 0	Epoch: 2	Loss: 0.122966
Client Index = 0	Epoch: 3	Loss: 0.123518
Client Index = 0	Epoch: 4	Loss: 0.082635
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 1
local mask changes: 178202.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [740158.0, 178202.0, 728114.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 1	Epoch: 0	Loss: 0.137748
Client Index = 1	Epoch: 1	Loss: 0.050284
Client Index = 1	Epoch: 2	Loss: 0.034677
Client Index = 1	Epoch: 3	Loss: 0.051965
Client Index = 1	Epoch: 4	Loss: 0.288713
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 2
local mask changes: 178200.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [725934.0, 178200.0, 730968.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.034537
Client Index = 2	Epoch: 1	Loss: 0.051895
Client Index = 2	Epoch: 2	Loss: 0.130930
Client Index = 2	Epoch: 3	Loss: 0.178793
Client Index = 2	Epoch: 4	Loss: 0.038378
test acc on this client after 458 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 3
local mask changes: 178200.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [732028.0, 178200.0, 747262.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.118661
Client Index = 3	Epoch: 1	Loss: 0.281442
Client Index = 3	Epoch: 2	Loss: 0.065156
Client Index = 3	Epoch: 3	Loss: 0.032367
Client Index = 3	Epoch: 4	Loss: 0.020690
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 4
local mask changes: 178058.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [750262.0, 178058.0, 757422.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.148669
Client Index = 4	Epoch: 1	Loss: 0.301607
Client Index = 4	Epoch: 2	Loss: 0.106727
Client Index = 4	Epoch: 3	Loss: 0.055617
Client Index = 4	Epoch: 4	Loss: 0.132972
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 5
local mask changes: 178002.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [757154.0, 178002.0, 762978.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.170525
Client Index = 5	Epoch: 1	Loss: 0.274555
Client Index = 5	Epoch: 2	Loss: 0.226512
Client Index = 5	Epoch: 3	Loss: 0.081022
Client Index = 5	Epoch: 4	Loss: 0.064849
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 6
local mask changes: 178208.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [763364.0, 178208.0, 766924.0]
Doing local aggregation!
test acc on this client before 403 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.188731
Client Index = 6	Epoch: 1	Loss: 0.416580
Client Index = 6	Epoch: 2	Loss: 0.179997
Client Index = 6	Epoch: 3	Loss: 0.111966
Client Index = 6	Epoch: 4	Loss: 0.076948
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 7
local mask changes: 178160.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [767210.0, 178160.0, 748160.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.315571
Client Index = 7	Epoch: 1	Loss: 0.257779
Client Index = 7	Epoch: 2	Loss: 0.206413
Client Index = 7	Epoch: 3	Loss: 0.329953
Client Index = 7	Epoch: 4	Loss: 0.102987
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 8
local mask changes: 178044.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [743722.0, 178044.0, 735760.0]
Doing local aggregation!
test acc on this client before 459 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.032041
Client Index = 8	Epoch: 1	Loss: 0.019783
Client Index = 8	Epoch: 2	Loss: 0.038448
Client Index = 8	Epoch: 3	Loss: 0.016156
Client Index = 8	Epoch: 4	Loss: 0.074232
test acc on this client after 458 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 9
local mask changes: 178024.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [738834.0, 178024.0, 753798.0]
Doing local aggregation!
test acc on this client before 387 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.094002
Client Index = 9	Epoch: 1	Loss: 0.122574
Client Index = 9	Epoch: 2	Loss: 0.320415
Client Index = 9	Epoch: 3	Loss: 0.134970
Client Index = 9	Epoch: 4	Loss: 0.074530
test acc on this client after 393 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 10
local mask changes: 178086.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [754014.0, 178086.0, 742150.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.162207
Client Index = 10	Epoch: 1	Loss: 0.244373
Client Index = 10	Epoch: 2	Loss: 0.099698
Client Index = 10	Epoch: 3	Loss: 0.093146
Client Index = 10	Epoch: 4	Loss: 0.262360
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 11
local mask changes: 178142.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [739740.0, 178142.0, 739954.0]
Doing local aggregation!
test acc on this client before 433 / 505 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.163311
Client Index = 11	Epoch: 1	Loss: 0.077348
Client Index = 11	Epoch: 2	Loss: 0.052746
Client Index = 11	Epoch: 3	Loss: 0.115999
Client Index = 11	Epoch: 4	Loss: 0.036610
test acc on this client after 430 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 12
local mask changes: 178234.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [741856.0, 178234.0, 753238.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.206457
Client Index = 12	Epoch: 1	Loss: 0.318342
Client Index = 12	Epoch: 2	Loss: 0.183979
Client Index = 12	Epoch: 3	Loss: 0.079933
Client Index = 12	Epoch: 4	Loss: 0.035525
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 13
local mask changes: 178170.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [752580.0, 178170.0, 745824.0]
Doing local aggregation!
test acc on this client before 387 / 505 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.204842
Client Index = 13	Epoch: 1	Loss: 0.284285
Client Index = 13	Epoch: 2	Loss: 0.093615
Client Index = 13	Epoch: 3	Loss: 0.056990
Client Index = 13	Epoch: 4	Loss: 0.033064
test acc on this client after 404 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 14
local mask changes: 178030.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [746180.0, 178030.0, 742830.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.272823
Client Index = 14	Epoch: 1	Loss: 0.152734
Client Index = 14	Epoch: 2	Loss: 0.121681
Client Index = 14	Epoch: 3	Loss: 0.084548
Client Index = 14	Epoch: 4	Loss: 0.051927
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 15
local mask changes: 177962.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [741782.0, 177962.0, 740512.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.199940
Client Index = 15	Epoch: 1	Loss: 0.116960
Client Index = 15	Epoch: 2	Loss: 0.095002
Client Index = 15	Epoch: 3	Loss: 0.242930
Client Index = 15	Epoch: 4	Loss: 0.069182
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 16
local mask changes: 178314.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [741426.0, 178314.0, 753620.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.219216
Client Index = 16	Epoch: 1	Loss: 0.137216
Client Index = 16	Epoch: 2	Loss: 0.089858
Client Index = 16	Epoch: 3	Loss: 0.159168
Client Index = 16	Epoch: 4	Loss: 0.073251
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 17
local mask changes: 178164.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [755848.0, 178164.0, 756960.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.356952
Client Index = 17	Epoch: 1	Loss: 0.173188
Client Index = 17	Epoch: 2	Loss: 0.105440
Client Index = 17	Epoch: 3	Loss: 0.336542
Client Index = 17	Epoch: 4	Loss: 0.107271
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 18
local mask changes: 178052.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [754472.0, 178052.0, 746050.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.084037
Client Index = 18	Epoch: 1	Loss: 0.057632
Client Index = 18	Epoch: 2	Loss: 0.049672
Client Index = 18	Epoch: 3	Loss: 0.052580
Client Index = 18	Epoch: 4	Loss: 0.387526
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 19
local mask changes: 178304.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [751954.0, 748046.0, 178304.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.143532
Client Index = 19	Epoch: 1	Loss: 0.182382
Client Index = 19	Epoch: 2	Loss: 0.092007
Client Index = 19	Epoch: 3	Loss: 0.109770
Client Index = 19	Epoch: 4	Loss: 0.301466
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.14220821696845815}
################local_test_on_all_clients after local training in communication round: 88
{'test_acc_after': 0.8034810121433592, 'test_loss_after': 0.7416909219504138}
################local_test_on_all_clients before local training in communication round: 88
{'test_acc_before': 0.8092509294426226, 'test_loss_before': 0.6882481796265337}
################Communication round : 89
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 0
local mask changes: 152716.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [152716.0, 733460.0, 742608.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.133952
Client Index = 0	Epoch: 1	Loss: 0.262569
Client Index = 0	Epoch: 2	Loss: 0.201922
Client Index = 0	Epoch: 3	Loss: 0.097305
Client Index = 0	Epoch: 4	Loss: 0.086902
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 1
local mask changes: 152582.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [731820.0, 152582.0, 717606.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 1	Epoch: 0	Loss: 0.101330
Client Index = 1	Epoch: 1	Loss: 0.041158
Client Index = 1	Epoch: 2	Loss: 0.066178
Client Index = 1	Epoch: 3	Loss: 0.032967
Client Index = 1	Epoch: 4	Loss: 0.017978
test acc on this client after 453 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 2
local mask changes: 152720.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [716634.0, 152720.0, 720372.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.021578
Client Index = 2	Epoch: 1	Loss: 0.015651
Client Index = 2	Epoch: 2	Loss: 0.018448
Client Index = 2	Epoch: 3	Loss: 0.009084
Client Index = 2	Epoch: 4	Loss: 0.004562
test acc on this client after 448 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 3
local mask changes: 152644.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [720228.0, 152644.0, 736878.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.069604
Client Index = 3	Epoch: 1	Loss: 0.066934
Client Index = 3	Epoch: 2	Loss: 0.173995
Client Index = 3	Epoch: 3	Loss: 0.117681
Client Index = 3	Epoch: 4	Loss: 0.079847
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 4
local mask changes: 152648.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [738998.0, 152648.0, 746568.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.155250
Client Index = 4	Epoch: 1	Loss: 0.088642
Client Index = 4	Epoch: 2	Loss: 0.237443
Client Index = 4	Epoch: 3	Loss: 0.176286
Client Index = 4	Epoch: 4	Loss: 0.165423
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 5
local mask changes: 152598.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [747236.0, 152598.0, 752086.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.293731
Client Index = 5	Epoch: 1	Loss: 0.134828
Client Index = 5	Epoch: 2	Loss: 0.158863
Client Index = 5	Epoch: 3	Loss: 0.126093
Client Index = 5	Epoch: 4	Loss: 0.068680
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 6
local mask changes: 152736.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [753348.0, 152736.0, 756920.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.241251
Client Index = 6	Epoch: 1	Loss: 0.280628
Client Index = 6	Epoch: 2	Loss: 0.079932
Client Index = 6	Epoch: 3	Loss: 0.056427
Client Index = 6	Epoch: 4	Loss: 0.140928
test acc on this client after 399 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 7
local mask changes: 152734.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [756680.0, 152734.0, 737806.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.292773
Client Index = 7	Epoch: 1	Loss: 0.303169
Client Index = 7	Epoch: 2	Loss: 0.142046
Client Index = 7	Epoch: 3	Loss: 0.355473
Client Index = 7	Epoch: 4	Loss: 0.211774
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 8
local mask changes: 152628.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [733010.0, 152628.0, 724220.0]
Doing local aggregation!
test acc on this client before 451 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.041716
Client Index = 8	Epoch: 1	Loss: 0.028297
Client Index = 8	Epoch: 2	Loss: 0.022911
Client Index = 8	Epoch: 3	Loss: 0.017676
Client Index = 8	Epoch: 4	Loss: 0.017450
test acc on this client after 466 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 9
local mask changes: 152672.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [727806.0, 152672.0, 743360.0]
Doing local aggregation!
test acc on this client before 399 / 506 : 0.79
Client Index = 9	Epoch: 0	Loss: 0.252323
Client Index = 9	Epoch: 1	Loss: 0.234267
Client Index = 9	Epoch: 2	Loss: 0.075795
Client Index = 9	Epoch: 3	Loss: 0.148795
Client Index = 9	Epoch: 4	Loss: 0.144617
test acc on this client after 360 / 506 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 10
local mask changes: 152482.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [744196.0, 152482.0, 731986.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.262275
Client Index = 10	Epoch: 1	Loss: 0.186463
Client Index = 10	Epoch: 2	Loss: 0.099877
Client Index = 10	Epoch: 3	Loss: 0.097739
Client Index = 10	Epoch: 4	Loss: 0.139991
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 11
local mask changes: 152684.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [728926.0, 152684.0, 728760.0]
Doing local aggregation!
test acc on this client before 433 / 505 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.091609
Client Index = 11	Epoch: 1	Loss: 0.105758
Client Index = 11	Epoch: 2	Loss: 0.112017
Client Index = 11	Epoch: 3	Loss: 0.034707
Client Index = 11	Epoch: 4	Loss: 0.047580
test acc on this client after 440 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 12
local mask changes: 152582.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [730236.0, 152582.0, 741598.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.179377
Client Index = 12	Epoch: 1	Loss: 0.166341
Client Index = 12	Epoch: 2	Loss: 0.353022
Client Index = 12	Epoch: 3	Loss: 0.062373
Client Index = 12	Epoch: 4	Loss: 0.055339
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 13
local mask changes: 152584.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [741098.0, 152584.0, 734700.0]
Doing local aggregation!
test acc on this client before 422 / 505 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.292586
Client Index = 13	Epoch: 1	Loss: 0.240459
Client Index = 13	Epoch: 2	Loss: 0.063596
Client Index = 13	Epoch: 3	Loss: 0.060089
Client Index = 13	Epoch: 4	Loss: 0.085318
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 14
local mask changes: 152512.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [734752.0, 152512.0, 731922.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.273492
Client Index = 14	Epoch: 1	Loss: 0.140869
Client Index = 14	Epoch: 2	Loss: 0.355384
Client Index = 14	Epoch: 3	Loss: 0.062988
Client Index = 14	Epoch: 4	Loss: 0.039163
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 15
local mask changes: 152684.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [730984.0, 152684.0, 729670.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.207694
Client Index = 15	Epoch: 1	Loss: 0.103682
Client Index = 15	Epoch: 2	Loss: 0.074783
Client Index = 15	Epoch: 3	Loss: 0.239931
Client Index = 15	Epoch: 4	Loss: 0.217770
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 16
local mask changes: 152720.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [729878.0, 152720.0, 743474.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.290213
Client Index = 16	Epoch: 1	Loss: 0.159147
Client Index = 16	Epoch: 2	Loss: 0.260992
Client Index = 16	Epoch: 3	Loss: 0.060489
Client Index = 16	Epoch: 4	Loss: 0.068598
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 17
local mask changes: 152528.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [745584.0, 152528.0, 746094.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.277301
Client Index = 17	Epoch: 1	Loss: 0.170134
Client Index = 17	Epoch: 2	Loss: 0.152670
Client Index = 17	Epoch: 3	Loss: 0.072070
Client Index = 17	Epoch: 4	Loss: 0.177581
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 18
local mask changes: 152568.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [744592.0, 152568.0, 736084.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.066193
Client Index = 18	Epoch: 1	Loss: 0.272955
Client Index = 18	Epoch: 2	Loss: 0.104728
Client Index = 18	Epoch: 3	Loss: 0.054929
Client Index = 18	Epoch: 4	Loss: 0.031469
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 19
local mask changes: 152710.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [742948.0, 737096.0, 152710.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.121058
Client Index = 19	Epoch: 1	Loss: 0.143109
Client Index = 19	Epoch: 2	Loss: 0.171472
Client Index = 19	Epoch: 3	Loss: 0.055094
Client Index = 19	Epoch: 4	Loss: 0.089689
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.13565293534030204}
################local_test_on_all_clients after local training in communication round: 89
{'test_acc_after': 0.8073774029292833, 'test_loss_after': 0.763107022898591}
################local_test_on_all_clients before local training in communication round: 89
{'test_acc_before': 0.8159873507926099, 'test_loss_before': 0.6686585040454494}
################Communication round : 90
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 0
local mask changes: 128906.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [128906.0, 726268.0, 734774.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.203975
Client Index = 0	Epoch: 1	Loss: 0.305446
Client Index = 0	Epoch: 2	Loss: 0.060510
Client Index = 0	Epoch: 3	Loss: 0.061329
Client Index = 0	Epoch: 4	Loss: 0.038685
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 1
local mask changes: 128912.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [722808.0, 128912.0, 708300.0]
Doing local aggregation!
test acc on this client before 436 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.085684
Client Index = 1	Epoch: 1	Loss: 0.052646
Client Index = 1	Epoch: 2	Loss: 0.029569
Client Index = 1	Epoch: 3	Loss: 0.054005
Client Index = 1	Epoch: 4	Loss: 0.053382
test acc on this client after 436 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 2
local mask changes: 128778.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [707056.0, 128778.0, 709318.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.039346
Client Index = 2	Epoch: 1	Loss: 0.362152
Client Index = 2	Epoch: 2	Loss: 0.082686
Client Index = 2	Epoch: 3	Loss: 0.033600
Client Index = 2	Epoch: 4	Loss: 0.016853
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 3
local mask changes: 128862.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [712998.0, 128862.0, 728874.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.057009
Client Index = 3	Epoch: 1	Loss: 0.136932
Client Index = 3	Epoch: 2	Loss: 0.087998
Client Index = 3	Epoch: 3	Loss: 0.057072
Client Index = 3	Epoch: 4	Loss: 0.020958
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 4
local mask changes: 128912.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [729962.0, 128912.0, 737844.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.083917
Client Index = 4	Epoch: 1	Loss: 0.127162
Client Index = 4	Epoch: 2	Loss: 0.206178
Client Index = 4	Epoch: 3	Loss: 0.088609
Client Index = 4	Epoch: 4	Loss: 0.055317
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 5
local mask changes: 128962.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [738138.0, 128962.0, 743884.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.141929
Client Index = 5	Epoch: 1	Loss: 0.193650
Client Index = 5	Epoch: 2	Loss: 0.411714
Client Index = 5	Epoch: 3	Loss: 0.087984
Client Index = 5	Epoch: 4	Loss: 0.121285
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 6
local mask changes: 128906.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [744192.0, 128906.0, 748242.0]
Doing local aggregation!
test acc on this client before 389 / 505 : 0.77
Client Index = 6	Epoch: 0	Loss: 0.177902
Client Index = 6	Epoch: 1	Loss: 0.222392
Client Index = 6	Epoch: 2	Loss: 0.111392
Client Index = 6	Epoch: 3	Loss: 0.063097
Client Index = 6	Epoch: 4	Loss: 0.065392
test acc on this client after 398 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 7
local mask changes: 128908.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [749196.0, 128908.0, 728930.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 7	Epoch: 0	Loss: 0.210568
Client Index = 7	Epoch: 1	Loss: 0.216273
Client Index = 7	Epoch: 2	Loss: 0.248801
Client Index = 7	Epoch: 3	Loss: 0.306135
Client Index = 7	Epoch: 4	Loss: 0.158249
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 8
local mask changes: 128960.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [723578.0, 128960.0, 714062.0]
Doing local aggregation!
test acc on this client before 462 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.044578
Client Index = 8	Epoch: 1	Loss: 0.244878
Client Index = 8	Epoch: 2	Loss: 0.034250
Client Index = 8	Epoch: 3	Loss: 0.019272
Client Index = 8	Epoch: 4	Loss: 0.020130
test acc on this client after 461 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 9
local mask changes: 128850.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [717508.0, 128850.0, 734908.0]
Doing local aggregation!
test acc on this client before 385 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.319505
Client Index = 9	Epoch: 1	Loss: 0.159281
Client Index = 9	Epoch: 2	Loss: 0.112531
Client Index = 9	Epoch: 3	Loss: 0.117478
Client Index = 9	Epoch: 4	Loss: 0.113638
test acc on this client after 396 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 10
local mask changes: 128944.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [735540.0, 128944.0, 722742.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.110767
Client Index = 10	Epoch: 1	Loss: 0.369495
Client Index = 10	Epoch: 2	Loss: 0.243401
Client Index = 10	Epoch: 3	Loss: 0.117278
Client Index = 10	Epoch: 4	Loss: 0.056461
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 11
local mask changes: 128936.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [720270.0, 128936.0, 718960.0]
Doing local aggregation!
test acc on this client before 437 / 505 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.256035
Client Index = 11	Epoch: 1	Loss: 0.063747
Client Index = 11	Epoch: 2	Loss: 0.044188
Client Index = 11	Epoch: 3	Loss: 0.035895
Client Index = 11	Epoch: 4	Loss: 0.034745
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 12
local mask changes: 129034.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [721562.0, 129034.0, 732396.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.169729
Client Index = 12	Epoch: 1	Loss: 0.153808
Client Index = 12	Epoch: 2	Loss: 0.101670
Client Index = 12	Epoch: 3	Loss: 0.096415
Client Index = 12	Epoch: 4	Loss: 0.045890
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 13
local mask changes: 128934.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [731728.0, 128934.0, 725652.0]
Doing local aggregation!
test acc on this client before 417 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.070508
Client Index = 13	Epoch: 1	Loss: 0.190652
Client Index = 13	Epoch: 2	Loss: 0.235288
Client Index = 13	Epoch: 3	Loss: 0.064866
Client Index = 13	Epoch: 4	Loss: 0.040371
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 14
local mask changes: 129030.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [725112.0, 129030.0, 722172.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.272563
Client Index = 14	Epoch: 1	Loss: 0.132475
Client Index = 14	Epoch: 2	Loss: 0.140090
Client Index = 14	Epoch: 3	Loss: 0.133961
Client Index = 14	Epoch: 4	Loss: 0.121387
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 15
local mask changes: 129000.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [722772.0, 129000.0, 720890.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.103050
Client Index = 15	Epoch: 1	Loss: 0.143212
Client Index = 15	Epoch: 2	Loss: 0.133771
Client Index = 15	Epoch: 3	Loss: 0.054934
Client Index = 15	Epoch: 4	Loss: 0.203549
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 16
local mask changes: 128882.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [720724.0, 128882.0, 734772.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.311186
Client Index = 16	Epoch: 1	Loss: 0.170678
Client Index = 16	Epoch: 2	Loss: 0.122941
Client Index = 16	Epoch: 3	Loss: 0.070035
Client Index = 16	Epoch: 4	Loss: 0.045930
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 17
local mask changes: 129076.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [736666.0, 129076.0, 737426.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.133332
Client Index = 17	Epoch: 1	Loss: 0.162321
Client Index = 17	Epoch: 2	Loss: 0.485785
Client Index = 17	Epoch: 3	Loss: 0.124825
Client Index = 17	Epoch: 4	Loss: 0.100653
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 18
local mask changes: 128872.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [735286.0, 128872.0, 727322.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.213871
Client Index = 18	Epoch: 1	Loss: 0.168921
Client Index = 18	Epoch: 2	Loss: 0.112944
Client Index = 18	Epoch: 3	Loss: 0.062240
Client Index = 18	Epoch: 4	Loss: 0.066583
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 19
local mask changes: 128954.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [733822.0, 727586.0, 128954.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.096894
Client Index = 19	Epoch: 1	Loss: 0.293184
Client Index = 19	Epoch: 2	Loss: 0.203648
Client Index = 19	Epoch: 3	Loss: 0.129506
Client Index = 19	Epoch: 4	Loss: 0.053106
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.13392108631553126}
################local_test_on_all_clients after local training in communication round: 90
{'test_acc_after': 0.8046677464305585, 'test_loss_after': 0.787079583640942}
################local_test_on_all_clients before local training in communication round: 90
{'test_acc_before': 0.821567319888145, 'test_loss_before': 0.6626009853561967}
################Communication round : 91
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 0
local mask changes: 107170.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [107170.0, 717436.0, 726908.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.376422
Client Index = 0	Epoch: 1	Loss: 0.098754
Client Index = 0	Epoch: 2	Loss: 0.065408
Client Index = 0	Epoch: 3	Loss: 0.049548
Client Index = 0	Epoch: 4	Loss: 0.128549
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 1
local mask changes: 107102.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [715836.0, 107102.0, 698152.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.082331
Client Index = 1	Epoch: 1	Loss: 0.249920
Client Index = 1	Epoch: 2	Loss: 0.061250
Client Index = 1	Epoch: 3	Loss: 0.066485
Client Index = 1	Epoch: 4	Loss: 0.021684
test acc on this client after 449 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 2
local mask changes: 107004.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [698936.0, 107004.0, 703668.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.036471
Client Index = 2	Epoch: 1	Loss: 0.020394
Client Index = 2	Epoch: 2	Loss: 0.037521
Client Index = 2	Epoch: 3	Loss: 0.045896
Client Index = 2	Epoch: 4	Loss: 0.042736
test acc on this client after 447 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 3
local mask changes: 107074.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [703038.0, 107074.0, 721132.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.193295
Client Index = 3	Epoch: 1	Loss: 0.199195
Client Index = 3	Epoch: 2	Loss: 0.062904
Client Index = 3	Epoch: 3	Loss: 0.157677
Client Index = 3	Epoch: 4	Loss: 0.049257
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 4
local mask changes: 107052.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [722840.0, 107052.0, 730090.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.198243
Client Index = 4	Epoch: 1	Loss: 0.121547
Client Index = 4	Epoch: 2	Loss: 0.080420
Client Index = 4	Epoch: 3	Loss: 0.070284
Client Index = 4	Epoch: 4	Loss: 0.334955
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 5
local mask changes: 107120.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [731476.0, 107120.0, 736848.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.327850
Client Index = 5	Epoch: 1	Loss: 0.108514
Client Index = 5	Epoch: 2	Loss: 0.093929
Client Index = 5	Epoch: 3	Loss: 0.193582
Client Index = 5	Epoch: 4	Loss: 0.068063
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 6
local mask changes: 107118.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [736630.0, 107118.0, 741626.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.320667
Client Index = 6	Epoch: 1	Loss: 0.146820
Client Index = 6	Epoch: 2	Loss: 0.195932
Client Index = 6	Epoch: 3	Loss: 0.161096
Client Index = 6	Epoch: 4	Loss: 0.045454
test acc on this client after 373 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 7
local mask changes: 107110.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [742170.0, 107110.0, 721434.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.162709
Client Index = 7	Epoch: 1	Loss: 0.445862
Client Index = 7	Epoch: 2	Loss: 0.171067
Client Index = 7	Epoch: 3	Loss: 0.121755
Client Index = 7	Epoch: 4	Loss: 0.176999
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 8
local mask changes: 107042.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [717602.0, 107042.0, 706786.0]
Doing local aggregation!
test acc on this client before 458 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.028829
Client Index = 8	Epoch: 1	Loss: 0.030361
Client Index = 8	Epoch: 2	Loss: 0.033068
Client Index = 8	Epoch: 3	Loss: 0.025496
Client Index = 8	Epoch: 4	Loss: 0.018035
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 9
local mask changes: 107156.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [709360.0, 107156.0, 727916.0]
Doing local aggregation!
test acc on this client before 399 / 506 : 0.79
Client Index = 9	Epoch: 0	Loss: 0.186518
Client Index = 9	Epoch: 1	Loss: 0.171867
Client Index = 9	Epoch: 2	Loss: 0.102903
Client Index = 9	Epoch: 3	Loss: 0.074426
Client Index = 9	Epoch: 4	Loss: 0.080482
test acc on this client after 398 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 10
local mask changes: 107134.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [728068.0, 107134.0, 714574.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.159745
Client Index = 10	Epoch: 1	Loss: 0.343585
Client Index = 10	Epoch: 2	Loss: 0.119995
Client Index = 10	Epoch: 3	Loss: 0.118976
Client Index = 10	Epoch: 4	Loss: 0.055111
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 11
local mask changes: 107056.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [712584.0, 107056.0, 711558.0]
Doing local aggregation!
test acc on this client before 446 / 505 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.363565
Client Index = 11	Epoch: 1	Loss: 0.084253
Client Index = 11	Epoch: 2	Loss: 0.065290
Client Index = 11	Epoch: 3	Loss: 0.032447
Client Index = 11	Epoch: 4	Loss: 0.043103
test acc on this client after 428 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 12
local mask changes: 107048.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [713594.0, 107048.0, 724854.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 12	Epoch: 0	Loss: 0.123961
Client Index = 12	Epoch: 1	Loss: 0.394219
Client Index = 12	Epoch: 2	Loss: 0.103163
Client Index = 12	Epoch: 3	Loss: 0.074509
Client Index = 12	Epoch: 4	Loss: 0.097812
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 13
local mask changes: 107104.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [724318.0, 107104.0, 717550.0]
Doing local aggregation!
test acc on this client before 418 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.244061
Client Index = 13	Epoch: 1	Loss: 0.098129
Client Index = 13	Epoch: 2	Loss: 0.094718
Client Index = 13	Epoch: 3	Loss: 0.137430
Client Index = 13	Epoch: 4	Loss: 0.065750
test acc on this client after 409 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 14
local mask changes: 107120.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [718324.0, 107120.0, 716120.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.084806
Client Index = 14	Epoch: 1	Loss: 0.194013
Client Index = 14	Epoch: 2	Loss: 0.223244
Client Index = 14	Epoch: 3	Loss: 0.112419
Client Index = 14	Epoch: 4	Loss: 0.177073
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 15
local mask changes: 107078.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [714966.0, 107078.0, 713612.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.209512
Client Index = 15	Epoch: 1	Loss: 0.106637
Client Index = 15	Epoch: 2	Loss: 0.091708
Client Index = 15	Epoch: 3	Loss: 0.118014
Client Index = 15	Epoch: 4	Loss: 0.192174
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 16
local mask changes: 107016.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [713520.0, 107016.0, 727354.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.277661
Client Index = 16	Epoch: 1	Loss: 0.086203
Client Index = 16	Epoch: 2	Loss: 0.143387
Client Index = 16	Epoch: 3	Loss: 0.130838
Client Index = 16	Epoch: 4	Loss: 0.126431
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 17
local mask changes: 107112.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [729908.0, 107112.0, 730300.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.203891
Client Index = 17	Epoch: 1	Loss: 0.232221
Client Index = 17	Epoch: 2	Loss: 0.239713
Client Index = 17	Epoch: 3	Loss: 0.088899
Client Index = 17	Epoch: 4	Loss: 0.365703
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 18
local mask changes: 106986.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [728884.0, 106986.0, 719954.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.302877
Client Index = 18	Epoch: 1	Loss: 0.236283
Client Index = 18	Epoch: 2	Loss: 0.052135
Client Index = 18	Epoch: 3	Loss: 0.113390
Client Index = 18	Epoch: 4	Loss: 0.110024
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 19
local mask changes: 107048.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [726898.0, 719748.0, 107048.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 19	Epoch: 0	Loss: 0.072725
Client Index = 19	Epoch: 1	Loss: 0.120024
Client Index = 19	Epoch: 2	Loss: 0.285743
Client Index = 19	Epoch: 3	Loss: 0.095305
Client Index = 19	Epoch: 4	Loss: 0.157273
test acc on this client after 336 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.14113580639846623}
################local_test_on_all_clients after local training in communication round: 91
{'test_acc_after': 0.8064617279353239, 'test_loss_after': 0.7646222889944541}
################local_test_on_all_clients before local training in communication round: 91
{'test_acc_before': 0.8221456407198702, 'test_loss_before': 0.6561555933280616}
################Communication round : 92
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 0
local mask changes: 87114.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [87114.0, 710744.0, 720608.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.083855
Client Index = 0	Epoch: 1	Loss: 0.236196
Client Index = 0	Epoch: 2	Loss: 0.183316
Client Index = 0	Epoch: 3	Loss: 0.191510
Client Index = 0	Epoch: 4	Loss: 0.054927
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 1
local mask changes: 87048.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [709726.0, 87048.0, 693488.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.105280
Client Index = 1	Epoch: 1	Loss: 0.052566
Client Index = 1	Epoch: 2	Loss: 0.079181
Client Index = 1	Epoch: 3	Loss: 0.057085
Client Index = 1	Epoch: 4	Loss: 0.031026
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 2
local mask changes: 87048.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [691904.0, 87048.0, 696520.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.035057
Client Index = 2	Epoch: 1	Loss: 0.047536
Client Index = 2	Epoch: 2	Loss: 0.037485
Client Index = 2	Epoch: 3	Loss: 0.038261
Client Index = 2	Epoch: 4	Loss: 0.029705
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 3
local mask changes: 87114.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [698072.0, 87114.0, 715268.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.059494
Client Index = 3	Epoch: 1	Loss: 0.063777
Client Index = 3	Epoch: 2	Loss: 0.070205
Client Index = 3	Epoch: 3	Loss: 0.044386
Client Index = 3	Epoch: 4	Loss: 0.047683
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 4
local mask changes: 87192.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [716806.0, 87192.0, 725642.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.085680
Client Index = 4	Epoch: 1	Loss: 0.235144
Client Index = 4	Epoch: 2	Loss: 0.082449
Client Index = 4	Epoch: 3	Loss: 0.123078
Client Index = 4	Epoch: 4	Loss: 0.072476
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 5
local mask changes: 87134.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [725150.0, 87134.0, 730790.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.157042
Client Index = 5	Epoch: 1	Loss: 0.111588
Client Index = 5	Epoch: 2	Loss: 0.192932
Client Index = 5	Epoch: 3	Loss: 0.124330
Client Index = 5	Epoch: 4	Loss: 0.136891
test acc on this client after 403 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 6
local mask changes: 87052.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [731620.0, 87052.0, 736612.0]
Doing local aggregation!
test acc on this client before 412 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.275018
Client Index = 6	Epoch: 1	Loss: 0.182540
Client Index = 6	Epoch: 2	Loss: 0.191099
Client Index = 6	Epoch: 3	Loss: 0.125074
Client Index = 6	Epoch: 4	Loss: 0.078360
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 7
local mask changes: 87082.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [736542.0, 87082.0, 715736.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.255128
Client Index = 7	Epoch: 1	Loss: 0.310524
Client Index = 7	Epoch: 2	Loss: 0.190180
Client Index = 7	Epoch: 3	Loss: 0.223814
Client Index = 7	Epoch: 4	Loss: 0.119867
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 8
local mask changes: 87098.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [712022.0, 87098.0, 700814.0]
Doing local aggregation!
test acc on this client before 465 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.060470
Client Index = 8	Epoch: 1	Loss: 0.208430
Client Index = 8	Epoch: 2	Loss: 0.036720
Client Index = 8	Epoch: 3	Loss: 0.029132
Client Index = 8	Epoch: 4	Loss: 0.010814
test acc on this client after 469 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 9
local mask changes: 87080.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [703678.0, 87080.0, 721912.0]
Doing local aggregation!
test acc on this client before 388 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.084152
Client Index = 9	Epoch: 1	Loss: 0.519844
Client Index = 9	Epoch: 2	Loss: 0.213510
Client Index = 9	Epoch: 3	Loss: 0.086066
Client Index = 9	Epoch: 4	Loss: 0.075863
test acc on this client after 392 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 10
local mask changes: 87082.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [722160.0, 87082.0, 708220.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.252001
Client Index = 10	Epoch: 1	Loss: 0.183800
Client Index = 10	Epoch: 2	Loss: 0.060877
Client Index = 10	Epoch: 3	Loss: 0.069912
Client Index = 10	Epoch: 4	Loss: 0.301849
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 11
local mask changes: 87118.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [706704.0, 87118.0, 705968.0]
Doing local aggregation!
test acc on this client before 435 / 505 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.090768
Client Index = 11	Epoch: 1	Loss: 0.080085
Client Index = 11	Epoch: 2	Loss: 0.040881
Client Index = 11	Epoch: 3	Loss: 0.173985
Client Index = 11	Epoch: 4	Loss: 0.063007
test acc on this client after 443 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 12
local mask changes: 87132.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [706994.0, 87132.0, 718674.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.138502
Client Index = 12	Epoch: 1	Loss: 0.209949
Client Index = 12	Epoch: 2	Loss: 0.243203
Client Index = 12	Epoch: 3	Loss: 0.281783
Client Index = 12	Epoch: 4	Loss: 0.087520
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 13
local mask changes: 87150.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [718662.0, 87150.0, 712544.0]
Doing local aggregation!
test acc on this client before 413 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.149250
Client Index = 13	Epoch: 1	Loss: 0.132522
Client Index = 13	Epoch: 2	Loss: 0.061678
Client Index = 13	Epoch: 3	Loss: 0.039124
Client Index = 13	Epoch: 4	Loss: 0.049403
test acc on this client after 384 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 14
local mask changes: 87132.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [712840.0, 87132.0, 710694.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.109950
Client Index = 14	Epoch: 1	Loss: 0.271126
Client Index = 14	Epoch: 2	Loss: 0.079353
Client Index = 14	Epoch: 3	Loss: 0.039694
Client Index = 14	Epoch: 4	Loss: 0.086690
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 15
local mask changes: 87070.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [710494.0, 87070.0, 708124.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.133944
Client Index = 15	Epoch: 1	Loss: 0.076420
Client Index = 15	Epoch: 2	Loss: 0.311765
Client Index = 15	Epoch: 3	Loss: 0.094075
Client Index = 15	Epoch: 4	Loss: 0.050421
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 16
local mask changes: 87124.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [707576.0, 87124.0, 722498.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.073247
Client Index = 16	Epoch: 1	Loss: 0.444570
Client Index = 16	Epoch: 2	Loss: 0.161524
Client Index = 16	Epoch: 3	Loss: 0.080935
Client Index = 16	Epoch: 4	Loss: 0.039706
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 17
local mask changes: 87058.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [724482.0, 87058.0, 726474.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.204636
Client Index = 17	Epoch: 1	Loss: 0.127219
Client Index = 17	Epoch: 2	Loss: 0.134861
Client Index = 17	Epoch: 3	Loss: 0.332512
Client Index = 17	Epoch: 4	Loss: 0.103525
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 18
local mask changes: 87082.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [724462.0, 87082.0, 714494.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.095338
Client Index = 18	Epoch: 1	Loss: 0.177910
Client Index = 18	Epoch: 2	Loss: 0.083517
Client Index = 18	Epoch: 3	Loss: 0.089335
Client Index = 18	Epoch: 4	Loss: 0.024295
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 19
local mask changes: 87084.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [721420.0, 715012.0, 87084.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.096214
Client Index = 19	Epoch: 1	Loss: 0.430863
Client Index = 19	Epoch: 2	Loss: 0.113061
Client Index = 19	Epoch: 3	Loss: 0.063971
Client Index = 19	Epoch: 4	Loss: 0.081340
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.13068866404518487}
################local_test_on_all_clients after local training in communication round: 92
{'test_acc_after': 0.807564228159168, 'test_loss_after': 0.7549785429282687}
################local_test_on_all_clients before local training in communication round: 92
{'test_acc_before': 0.8236429815727704, 'test_loss_before': 0.6399573857223589}
################Communication round : 93
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 0
local mask changes: 69056.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [69056.0, 706444.0, 716880.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.231846
Client Index = 0	Epoch: 1	Loss: 0.207207
Client Index = 0	Epoch: 2	Loss: 0.060752
Client Index = 0	Epoch: 3	Loss: 0.042556
Client Index = 0	Epoch: 4	Loss: 0.039031
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 1
local mask changes: 69106.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [705008.0, 69106.0, 688106.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.125921
Client Index = 1	Epoch: 1	Loss: 0.073851
Client Index = 1	Epoch: 2	Loss: 0.038627
Client Index = 1	Epoch: 3	Loss: 0.035918
Client Index = 1	Epoch: 4	Loss: 0.020248
test acc on this client after 451 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 2
local mask changes: 69044.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [687780.0, 69044.0, 692134.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.019739
Client Index = 2	Epoch: 1	Loss: 0.021507
Client Index = 2	Epoch: 2	Loss: 0.009260
Client Index = 2	Epoch: 3	Loss: 0.014013
Client Index = 2	Epoch: 4	Loss: 0.010536
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 3
local mask changes: 69050.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [692806.0, 69050.0, 711332.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.060475
Client Index = 3	Epoch: 1	Loss: 0.075307
Client Index = 3	Epoch: 2	Loss: 0.367385
Client Index = 3	Epoch: 3	Loss: 0.049470
Client Index = 3	Epoch: 4	Loss: 0.063179
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 4
local mask changes: 69118.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [712314.0, 69118.0, 720828.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.128173
Client Index = 4	Epoch: 1	Loss: 0.302779
Client Index = 4	Epoch: 2	Loss: 0.079994
Client Index = 4	Epoch: 3	Loss: 0.072329
Client Index = 4	Epoch: 4	Loss: 0.065411
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 5
local mask changes: 69120.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [722050.0, 69120.0, 727416.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.163179
Client Index = 5	Epoch: 1	Loss: 0.081733
Client Index = 5	Epoch: 2	Loss: 0.342767
Client Index = 5	Epoch: 3	Loss: 0.100203
Client Index = 5	Epoch: 4	Loss: 0.074198
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 6
local mask changes: 69166.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [727720.0, 69166.0, 733146.0]
Doing local aggregation!
test acc on this client before 398 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.087015
Client Index = 6	Epoch: 1	Loss: 0.323268
Client Index = 6	Epoch: 2	Loss: 0.094005
Client Index = 6	Epoch: 3	Loss: 0.093236
Client Index = 6	Epoch: 4	Loss: 0.067377
test acc on this client after 409 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 7
local mask changes: 69054.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [732752.0, 69054.0, 711114.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 7	Epoch: 0	Loss: 0.442662
Client Index = 7	Epoch: 1	Loss: 0.204554
Client Index = 7	Epoch: 2	Loss: 0.215419
Client Index = 7	Epoch: 3	Loss: 0.166605
Client Index = 7	Epoch: 4	Loss: 0.197491
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 8
local mask changes: 69060.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [707944.0, 69060.0, 696588.0]
Doing local aggregation!
test acc on this client before 458 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.106039
Client Index = 8	Epoch: 1	Loss: 0.041139
Client Index = 8	Epoch: 2	Loss: 0.017255
Client Index = 8	Epoch: 3	Loss: 0.018162
Client Index = 8	Epoch: 4	Loss: 0.020137
test acc on this client after 472 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 9
local mask changes: 69074.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [698888.0, 69074.0, 717832.0]
Doing local aggregation!
test acc on this client before 389 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.085345
Client Index = 9	Epoch: 1	Loss: 0.365779
Client Index = 9	Epoch: 2	Loss: 0.105495
Client Index = 9	Epoch: 3	Loss: 0.083317
Client Index = 9	Epoch: 4	Loss: 0.060981
test acc on this client after 379 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 10
local mask changes: 69086.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [718444.0, 69086.0, 704376.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.084991
Client Index = 10	Epoch: 1	Loss: 0.117777
Client Index = 10	Epoch: 2	Loss: 0.364159
Client Index = 10	Epoch: 3	Loss: 0.096999
Client Index = 10	Epoch: 4	Loss: 0.122037
test acc on this client after 358 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 11
local mask changes: 69056.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [702794.0, 69056.0, 701800.0]
Doing local aggregation!
test acc on this client before 436 / 505 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.055874
Client Index = 11	Epoch: 1	Loss: 0.076831
Client Index = 11	Epoch: 2	Loss: 0.066172
Client Index = 11	Epoch: 3	Loss: 0.046469
Client Index = 11	Epoch: 4	Loss: 0.101245
test acc on this client after 445 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 12
local mask changes: 69124.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [703292.0, 69124.0, 715266.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.073820
Client Index = 12	Epoch: 1	Loss: 0.114813
Client Index = 12	Epoch: 2	Loss: 0.242243
Client Index = 12	Epoch: 3	Loss: 0.153675
Client Index = 12	Epoch: 4	Loss: 0.108513
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 13
local mask changes: 69114.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [714000.0, 69114.0, 708352.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.100156
Client Index = 13	Epoch: 1	Loss: 0.247674
Client Index = 13	Epoch: 2	Loss: 0.069245
Client Index = 13	Epoch: 3	Loss: 0.071069
Client Index = 13	Epoch: 4	Loss: 0.198280
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 14
local mask changes: 69070.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [708582.0, 69070.0, 706504.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.101003
Client Index = 14	Epoch: 1	Loss: 0.188970
Client Index = 14	Epoch: 2	Loss: 0.139843
Client Index = 14	Epoch: 3	Loss: 0.106055
Client Index = 14	Epoch: 4	Loss: 0.171934
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 15
local mask changes: 69036.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [706524.0, 69036.0, 703426.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.079084
Client Index = 15	Epoch: 1	Loss: 0.176283
Client Index = 15	Epoch: 2	Loss: 0.083012
Client Index = 15	Epoch: 3	Loss: 0.065959
Client Index = 15	Epoch: 4	Loss: 0.082025
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 16
local mask changes: 69126.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [703944.0, 69126.0, 718984.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.089684
Client Index = 16	Epoch: 1	Loss: 0.248709
Client Index = 16	Epoch: 2	Loss: 0.083244
Client Index = 16	Epoch: 3	Loss: 0.111788
Client Index = 16	Epoch: 4	Loss: 0.220093
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 17
local mask changes: 69084.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [720120.0, 69084.0, 722466.0]
Doing local aggregation!
test acc on this client before 393 / 503 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.328573
Client Index = 17	Epoch: 1	Loss: 0.282672
Client Index = 17	Epoch: 2	Loss: 0.124847
Client Index = 17	Epoch: 3	Loss: 0.090396
Client Index = 17	Epoch: 4	Loss: 0.064013
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 18
local mask changes: 69150.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [721224.0, 69150.0, 710342.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.080644
Client Index = 18	Epoch: 1	Loss: 0.173517
Client Index = 18	Epoch: 2	Loss: 0.091703
Client Index = 18	Epoch: 3	Loss: 0.050107
Client Index = 18	Epoch: 4	Loss: 0.064606
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 19
local mask changes: 68994.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [716676.0, 710834.0, 68994.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.070311
Client Index = 19	Epoch: 1	Loss: 0.174119
Client Index = 19	Epoch: 2	Loss: 0.126424
Client Index = 19	Epoch: 3	Loss: 0.121110
Client Index = 19	Epoch: 4	Loss: 0.189549
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12265191281714942}
################local_test_on_all_clients after local training in communication round: 93
{'test_acc_after': 0.804181144277635, 'test_loss_after': 0.7759985253256113}
################local_test_on_all_clients before local training in communication round: 93
{'test_acc_before': 0.8207620458247498, 'test_loss_before': 0.6531514383163453}
################Communication round : 94
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 0
local mask changes: 53096.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [53096.0, 702680.0, 713634.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.202640
Client Index = 0	Epoch: 1	Loss: 0.164371
Client Index = 0	Epoch: 2	Loss: 0.098140
Client Index = 0	Epoch: 3	Loss: 0.224970
Client Index = 0	Epoch: 4	Loss: 0.220552
test acc on this client after 435 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 1
local mask changes: 53104.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [701824.0, 53104.0, 684444.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.230579
Client Index = 1	Epoch: 1	Loss: 0.174879
Client Index = 1	Epoch: 2	Loss: 0.062496
Client Index = 1	Epoch: 3	Loss: 0.035764
Client Index = 1	Epoch: 4	Loss: 0.024165
test acc on this client after 452 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 2
local mask changes: 53084.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [683218.0, 53084.0, 687624.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.063183
Client Index = 2	Epoch: 1	Loss: 0.107258
Client Index = 2	Epoch: 2	Loss: 0.044158
Client Index = 2	Epoch: 3	Loss: 0.097477
Client Index = 2	Epoch: 4	Loss: 0.025280
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 3
local mask changes: 53062.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [690090.0, 53062.0, 708678.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.044816
Client Index = 3	Epoch: 1	Loss: 0.073236
Client Index = 3	Epoch: 2	Loss: 0.122355
Client Index = 3	Epoch: 3	Loss: 0.062560
Client Index = 3	Epoch: 4	Loss: 0.052776
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 4
local mask changes: 53100.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [708690.0, 53100.0, 718458.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.112022
Client Index = 4	Epoch: 1	Loss: 0.209308
Client Index = 4	Epoch: 2	Loss: 0.114873
Client Index = 4	Epoch: 3	Loss: 0.073256
Client Index = 4	Epoch: 4	Loss: 0.188805
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 5
local mask changes: 53072.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [719006.0, 53072.0, 725010.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.129754
Client Index = 5	Epoch: 1	Loss: 0.167607
Client Index = 5	Epoch: 2	Loss: 0.160067
Client Index = 5	Epoch: 3	Loss: 0.128903
Client Index = 5	Epoch: 4	Loss: 0.224781
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 6
local mask changes: 53144.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [724974.0, 53144.0, 730458.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.092173
Client Index = 6	Epoch: 1	Loss: 0.115929
Client Index = 6	Epoch: 2	Loss: 0.293756
Client Index = 6	Epoch: 3	Loss: 0.098709
Client Index = 6	Epoch: 4	Loss: 0.119102
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 7
local mask changes: 53066.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [731214.0, 53066.0, 708590.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 7	Epoch: 0	Loss: 0.226404
Client Index = 7	Epoch: 1	Loss: 0.183816
Client Index = 7	Epoch: 2	Loss: 0.137510
Client Index = 7	Epoch: 3	Loss: 0.347798
Client Index = 7	Epoch: 4	Loss: 0.113847
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 8
local mask changes: 53088.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [705228.0, 53088.0, 693602.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.027929
Client Index = 8	Epoch: 1	Loss: 0.041913
Client Index = 8	Epoch: 2	Loss: 0.010223
Client Index = 8	Epoch: 3	Loss: 0.011390
Client Index = 8	Epoch: 4	Loss: 0.011599
test acc on this client after 460 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 9
local mask changes: 53094.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [695530.0, 53094.0, 715492.0]
Doing local aggregation!
test acc on this client before 383 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.072618
Client Index = 9	Epoch: 1	Loss: 0.250324
Client Index = 9	Epoch: 2	Loss: 0.082562
Client Index = 9	Epoch: 3	Loss: 0.110007
Client Index = 9	Epoch: 4	Loss: 0.237374
test acc on this client after 405 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 10
local mask changes: 53060.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [715832.0, 53060.0, 701396.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.086947
Client Index = 10	Epoch: 1	Loss: 0.134922
Client Index = 10	Epoch: 2	Loss: 0.185359
Client Index = 10	Epoch: 3	Loss: 0.177890
Client Index = 10	Epoch: 4	Loss: 0.074310
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 11
local mask changes: 53082.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [699948.0, 53082.0, 699278.0]
Doing local aggregation!
test acc on this client before 442 / 505 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.044853
Client Index = 11	Epoch: 1	Loss: 0.041904
Client Index = 11	Epoch: 2	Loss: 0.046622
Client Index = 11	Epoch: 3	Loss: 0.079192
Client Index = 11	Epoch: 4	Loss: 0.041936
test acc on this client after 440 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 12
local mask changes: 53064.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [701268.0, 53064.0, 712346.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 12	Epoch: 0	Loss: 0.303274
Client Index = 12	Epoch: 1	Loss: 0.085663
Client Index = 12	Epoch: 2	Loss: 0.062473
Client Index = 12	Epoch: 3	Loss: 0.079765
Client Index = 12	Epoch: 4	Loss: 0.053121
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 13
local mask changes: 53106.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [712186.0, 53106.0, 705796.0]
Doing local aggregation!
test acc on this client before 423 / 505 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.095288
Client Index = 13	Epoch: 1	Loss: 0.064264
Client Index = 13	Epoch: 2	Loss: 0.103184
Client Index = 13	Epoch: 3	Loss: 0.253012
Client Index = 13	Epoch: 4	Loss: 0.140530
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 14
local mask changes: 53070.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [705880.0, 53070.0, 703702.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.074427
Client Index = 14	Epoch: 1	Loss: 0.263630
Client Index = 14	Epoch: 2	Loss: 0.140098
Client Index = 14	Epoch: 3	Loss: 0.084303
Client Index = 14	Epoch: 4	Loss: 0.072807
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 15
local mask changes: 53098.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [702554.0, 53098.0, 699566.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.169383
Client Index = 15	Epoch: 1	Loss: 0.063017
Client Index = 15	Epoch: 2	Loss: 0.059663
Client Index = 15	Epoch: 3	Loss: 0.273991
Client Index = 15	Epoch: 4	Loss: 0.095854
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 16
local mask changes: 53116.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [701004.0, 53116.0, 716502.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.086404
Client Index = 16	Epoch: 1	Loss: 0.225577
Client Index = 16	Epoch: 2	Loss: 0.097400
Client Index = 16	Epoch: 3	Loss: 0.243491
Client Index = 16	Epoch: 4	Loss: 0.053568
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 17
local mask changes: 53070.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [716872.0, 53070.0, 719322.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.286151
Client Index = 17	Epoch: 1	Loss: 0.189284
Client Index = 17	Epoch: 2	Loss: 0.213810
Client Index = 17	Epoch: 3	Loss: 0.132594
Client Index = 17	Epoch: 4	Loss: 0.080005
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 18
local mask changes: 53016.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [718118.0, 53016.0, 706956.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.079712
Client Index = 18	Epoch: 1	Loss: 0.340750
Client Index = 18	Epoch: 2	Loss: 0.070949
Client Index = 18	Epoch: 3	Loss: 0.053230
Client Index = 18	Epoch: 4	Loss: 0.050430
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 19
local mask changes: 53092.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [714562.0, 707948.0, 53092.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.092446
Client Index = 19	Epoch: 1	Loss: 0.104869
Client Index = 19	Epoch: 2	Loss: 0.061095
Client Index = 19	Epoch: 3	Loss: 0.054629
Client Index = 19	Epoch: 4	Loss: 0.054867
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12248955391364869}
################local_test_on_all_clients after local training in communication round: 94
{'test_acc_after': 0.8111311680434558, 'test_loss_after': 0.7462714022344425}
################local_test_on_all_clients before local training in communication round: 94
{'test_acc_before': 0.8252294911415128, 'test_loss_before': 0.6594317973123925}
################Communication round : 95
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 0
local mask changes: 39134.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [39134.0, 701462.0, 713264.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.055710
Client Index = 0	Epoch: 1	Loss: 0.160534
Client Index = 0	Epoch: 2	Loss: 0.089636
Client Index = 0	Epoch: 3	Loss: 0.280798
Client Index = 0	Epoch: 4	Loss: 0.054394
test acc on this client after 434 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 1
local mask changes: 39100.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [699756.0, 39100.0, 681488.0]
Doing local aggregation!
test acc on this client before 433 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.064739
Client Index = 1	Epoch: 1	Loss: 0.139668
Client Index = 1	Epoch: 2	Loss: 0.064842
Client Index = 1	Epoch: 3	Loss: 0.034841
Client Index = 1	Epoch: 4	Loss: 0.023781
test acc on this client after 437 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 2
local mask changes: 39136.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [681414.0, 39136.0, 687084.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.026269
Client Index = 2	Epoch: 1	Loss: 0.026104
Client Index = 2	Epoch: 2	Loss: 0.017090
Client Index = 2	Epoch: 3	Loss: 0.029939
Client Index = 2	Epoch: 4	Loss: 0.012626
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 3
local mask changes: 39108.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [687016.0, 39108.0, 706328.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.043233
Client Index = 3	Epoch: 1	Loss: 0.041424
Client Index = 3	Epoch: 2	Loss: 0.036084
Client Index = 3	Epoch: 3	Loss: 0.058398
Client Index = 3	Epoch: 4	Loss: 0.212636
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 4
local mask changes: 39132.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [707706.0, 39132.0, 717194.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.085627
Client Index = 4	Epoch: 1	Loss: 0.265498
Client Index = 4	Epoch: 2	Loss: 0.086854
Client Index = 4	Epoch: 3	Loss: 0.095975
Client Index = 4	Epoch: 4	Loss: 0.336825
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 5
local mask changes: 39098.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [717422.0, 39098.0, 723286.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 5	Epoch: 0	Loss: 0.110123
Client Index = 5	Epoch: 1	Loss: 0.377302
Client Index = 5	Epoch: 2	Loss: 0.145196
Client Index = 5	Epoch: 3	Loss: 0.137657
Client Index = 5	Epoch: 4	Loss: 0.085757
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 6
local mask changes: 39142.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [723562.0, 39142.0, 729804.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.109437
Client Index = 6	Epoch: 1	Loss: 0.124864
Client Index = 6	Epoch: 2	Loss: 0.443032
Client Index = 6	Epoch: 3	Loss: 0.132148
Client Index = 6	Epoch: 4	Loss: 0.158143
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 7
local mask changes: 39134.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [729802.0, 39134.0, 706362.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 7	Epoch: 0	Loss: 0.140509
Client Index = 7	Epoch: 1	Loss: 0.199692
Client Index = 7	Epoch: 2	Loss: 0.103383
Client Index = 7	Epoch: 3	Loss: 0.429140
Client Index = 7	Epoch: 4	Loss: 0.244449
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 8
local mask changes: 39132.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [703910.0, 39132.0, 691100.0]
Doing local aggregation!
test acc on this client before 458 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.165875
Client Index = 8	Epoch: 1	Loss: 0.050206
Client Index = 8	Epoch: 2	Loss: 0.018766
Client Index = 8	Epoch: 3	Loss: 0.020330
Client Index = 8	Epoch: 4	Loss: 0.009421
test acc on this client after 473 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 9
local mask changes: 39074.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [693352.0, 39074.0, 714118.0]
Doing local aggregation!
test acc on this client before 389 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.126599
Client Index = 9	Epoch: 1	Loss: 0.253100
Client Index = 9	Epoch: 2	Loss: 0.106838
Client Index = 9	Epoch: 3	Loss: 0.148662
Client Index = 9	Epoch: 4	Loss: 0.095381
test acc on this client after 390 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 10
local mask changes: 39104.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [714072.0, 39104.0, 699194.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.183710
Client Index = 10	Epoch: 1	Loss: 0.129679
Client Index = 10	Epoch: 2	Loss: 0.055117
Client Index = 10	Epoch: 3	Loss: 0.184829
Client Index = 10	Epoch: 4	Loss: 0.112045
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 11
local mask changes: 39100.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [698008.0, 39100.0, 697880.0]
Doing local aggregation!
test acc on this client before 447 / 505 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.133961
Client Index = 11	Epoch: 1	Loss: 0.082648
Client Index = 11	Epoch: 2	Loss: 0.063358
Client Index = 11	Epoch: 3	Loss: 0.030056
Client Index = 11	Epoch: 4	Loss: 0.030052
test acc on this client after 445 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 12
local mask changes: 39098.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [698940.0, 39098.0, 710726.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.060632
Client Index = 12	Epoch: 1	Loss: 0.294255
Client Index = 12	Epoch: 2	Loss: 0.074820
Client Index = 12	Epoch: 3	Loss: 0.106076
Client Index = 12	Epoch: 4	Loss: 0.106924
test acc on this client after 353 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 13
local mask changes: 39098.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [710906.0, 39098.0, 704682.0]
Doing local aggregation!
test acc on this client before 417 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.068930
Client Index = 13	Epoch: 1	Loss: 0.289078
Client Index = 13	Epoch: 2	Loss: 0.123872
Client Index = 13	Epoch: 3	Loss: 0.057138
Client Index = 13	Epoch: 4	Loss: 0.057861
test acc on this client after 413 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 14
local mask changes: 39078.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [704716.0, 39078.0, 701494.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.056855
Client Index = 14	Epoch: 1	Loss: 0.249391
Client Index = 14	Epoch: 2	Loss: 0.085579
Client Index = 14	Epoch: 3	Loss: 0.050618
Client Index = 14	Epoch: 4	Loss: 0.181466
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 15
local mask changes: 39098.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [701192.0, 39098.0, 698054.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.155575
Client Index = 15	Epoch: 1	Loss: 0.067682
Client Index = 15	Epoch: 2	Loss: 0.078539
Client Index = 15	Epoch: 3	Loss: 0.077756
Client Index = 15	Epoch: 4	Loss: 0.082347
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 16
local mask changes: 39120.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [698550.0, 39120.0, 714800.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.141592
Client Index = 16	Epoch: 1	Loss: 0.270916
Client Index = 16	Epoch: 2	Loss: 0.075380
Client Index = 16	Epoch: 3	Loss: 0.091017
Client Index = 16	Epoch: 4	Loss: 0.073619
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 17
local mask changes: 39124.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [715238.0, 39124.0, 717306.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 17	Epoch: 0	Loss: 0.121948
Client Index = 17	Epoch: 1	Loss: 0.241380
Client Index = 17	Epoch: 2	Loss: 0.146651
Client Index = 17	Epoch: 3	Loss: 0.213423
Client Index = 17	Epoch: 4	Loss: 0.105622
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 18
local mask changes: 39130.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [716502.0, 39130.0, 705580.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.097444
Client Index = 18	Epoch: 1	Loss: 0.145569
Client Index = 18	Epoch: 2	Loss: 0.096436
Client Index = 18	Epoch: 3	Loss: 0.086118
Client Index = 18	Epoch: 4	Loss: 0.058326
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 19
local mask changes: 39106.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [712100.0, 705724.0, 39106.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 19	Epoch: 0	Loss: 0.167897
Client Index = 19	Epoch: 1	Loss: 0.316238
Client Index = 19	Epoch: 2	Loss: 0.079696
Client Index = 19	Epoch: 3	Loss: 0.100967
Client Index = 19	Epoch: 4	Loss: 0.059949
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12300571669754574}
################local_test_on_all_clients after local training in communication round: 95
{'test_acc_after': 0.8145150105088055, 'test_loss_after': 0.7339982553427424}
################local_test_on_all_clients before local training in communication round: 95
{'test_acc_before': 0.8308958950162578, 'test_loss_before': 0.6342069257800633}
################Communication round : 96
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 0
local mask changes: 27244.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [27244.0, 700736.0, 712214.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.046234
Client Index = 0	Epoch: 1	Loss: 0.136372
Client Index = 0	Epoch: 2	Loss: 0.047951
Client Index = 0	Epoch: 3	Loss: 0.084337
Client Index = 0	Epoch: 4	Loss: 0.261536
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 1
local mask changes: 27264.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [699774.0, 27264.0, 680810.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.137211
Client Index = 1	Epoch: 1	Loss: 0.050478
Client Index = 1	Epoch: 2	Loss: 0.035879
Client Index = 1	Epoch: 3	Loss: 0.053476
Client Index = 1	Epoch: 4	Loss: 0.279039
test acc on this client after 448 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 2
local mask changes: 27234.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [680138.0, 27234.0, 685564.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.024959
Client Index = 2	Epoch: 1	Loss: 0.015899
Client Index = 2	Epoch: 2	Loss: 0.016461
Client Index = 2	Epoch: 3	Loss: 0.036286
Client Index = 2	Epoch: 4	Loss: 0.046575
test acc on this client after 447 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 3
local mask changes: 27238.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [686376.0, 27238.0, 705832.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.047060
Client Index = 3	Epoch: 1	Loss: 0.025946
Client Index = 3	Epoch: 2	Loss: 0.080706
Client Index = 3	Epoch: 3	Loss: 0.042257
Client Index = 3	Epoch: 4	Loss: 0.201807
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 4
local mask changes: 27220.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [706872.0, 27220.0, 717212.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 4	Epoch: 0	Loss: 0.077392
Client Index = 4	Epoch: 1	Loss: 0.048270
Client Index = 4	Epoch: 2	Loss: 0.149352
Client Index = 4	Epoch: 3	Loss: 0.236485
Client Index = 4	Epoch: 4	Loss: 0.177554
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 5
local mask changes: 27236.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [717132.0, 27236.0, 723028.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.089693
Client Index = 5	Epoch: 1	Loss: 0.245079
Client Index = 5	Epoch: 2	Loss: 0.128916
Client Index = 5	Epoch: 3	Loss: 0.065968
Client Index = 5	Epoch: 4	Loss: 0.078891
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 6
local mask changes: 27236.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [723480.0, 27236.0, 729816.0]
Doing local aggregation!
test acc on this client before 402 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.077116
Client Index = 6	Epoch: 1	Loss: 0.116573
Client Index = 6	Epoch: 2	Loss: 0.177996
Client Index = 6	Epoch: 3	Loss: 0.145581
Client Index = 6	Epoch: 4	Loss: 0.046611
test acc on this client after 409 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 7
local mask changes: 27250.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [729624.0, 27250.0, 705262.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.226580
Client Index = 7	Epoch: 1	Loss: 0.303445
Client Index = 7	Epoch: 2	Loss: 0.194376
Client Index = 7	Epoch: 3	Loss: 0.090380
Client Index = 7	Epoch: 4	Loss: 0.061764
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 8
local mask changes: 27230.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [703304.0, 27230.0, 690392.0]
Doing local aggregation!
test acc on this client before 462 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.306515
Client Index = 8	Epoch: 1	Loss: 0.045399
Client Index = 8	Epoch: 2	Loss: 0.022144
Client Index = 8	Epoch: 3	Loss: 0.014565
Client Index = 8	Epoch: 4	Loss: 0.010043
test acc on this client after 473 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 9
local mask changes: 27248.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [691786.0, 27248.0, 713536.0]
Doing local aggregation!
test acc on this client before 384 / 506 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.066473
Client Index = 9	Epoch: 1	Loss: 0.094699
Client Index = 9	Epoch: 2	Loss: 0.289756
Client Index = 9	Epoch: 3	Loss: 0.117942
Client Index = 9	Epoch: 4	Loss: 0.217905
test acc on this client after 369 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 10
local mask changes: 27240.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [713442.0, 27240.0, 697902.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.059335
Client Index = 10	Epoch: 1	Loss: 0.129158
Client Index = 10	Epoch: 2	Loss: 0.081516
Client Index = 10	Epoch: 3	Loss: 0.213516
Client Index = 10	Epoch: 4	Loss: 0.264261
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 11
local mask changes: 27248.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [696936.0, 27248.0, 696682.0]
Doing local aggregation!
test acc on this client before 442 / 505 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.349936
Client Index = 11	Epoch: 1	Loss: 0.069344
Client Index = 11	Epoch: 2	Loss: 0.037038
Client Index = 11	Epoch: 3	Loss: 0.043743
Client Index = 11	Epoch: 4	Loss: 0.016887
test acc on this client after 441 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 12
local mask changes: 27240.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [697296.0, 27240.0, 709886.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.080917
Client Index = 12	Epoch: 1	Loss: 0.289432
Client Index = 12	Epoch: 2	Loss: 0.117417
Client Index = 12	Epoch: 3	Loss: 0.037652
Client Index = 12	Epoch: 4	Loss: 0.063137
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 13
local mask changes: 27250.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [709806.0, 27250.0, 703674.0]
Doing local aggregation!
test acc on this client before 418 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.096801
Client Index = 13	Epoch: 1	Loss: 0.145570
Client Index = 13	Epoch: 2	Loss: 0.061766
Client Index = 13	Epoch: 3	Loss: 0.112597
Client Index = 13	Epoch: 4	Loss: 0.377442
test acc on this client after 394 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 14
local mask changes: 27234.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [703734.0, 27234.0, 700410.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.063728
Client Index = 14	Epoch: 1	Loss: 0.239506
Client Index = 14	Epoch: 2	Loss: 0.054019
Client Index = 14	Epoch: 3	Loss: 0.080649
Client Index = 14	Epoch: 4	Loss: 0.088416
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 15
local mask changes: 27218.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [700096.0, 27218.0, 697048.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.081290
Client Index = 15	Epoch: 1	Loss: 0.169075
Client Index = 15	Epoch: 2	Loss: 0.162695
Client Index = 15	Epoch: 3	Loss: 0.067005
Client Index = 15	Epoch: 4	Loss: 0.093386
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 16
local mask changes: 27260.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [697714.0, 27260.0, 714228.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.212751
Client Index = 16	Epoch: 1	Loss: 0.145521
Client Index = 16	Epoch: 2	Loss: 0.059807
Client Index = 16	Epoch: 3	Loss: 0.034375
Client Index = 16	Epoch: 4	Loss: 0.220267
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 17
local mask changes: 27230.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [714804.0, 27230.0, 716418.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 17	Epoch: 0	Loss: 0.184433
Client Index = 17	Epoch: 1	Loss: 0.215833
Client Index = 17	Epoch: 2	Loss: 0.183021
Client Index = 17	Epoch: 3	Loss: 0.104246
Client Index = 17	Epoch: 4	Loss: 0.062626
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 18
local mask changes: 27216.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [715534.0, 27216.0, 704520.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.094627
Client Index = 18	Epoch: 1	Loss: 0.354893
Client Index = 18	Epoch: 2	Loss: 0.060758
Client Index = 18	Epoch: 3	Loss: 0.035170
Client Index = 18	Epoch: 4	Loss: 0.017362
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 19
local mask changes: 27260.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [712022.0, 704794.0, 27260.0]
Doing local aggregation!
test acc on this client before 426 / 503 : 0.85
Client Index = 19	Epoch: 0	Loss: 0.199892
Client Index = 19	Epoch: 1	Loss: 0.322837
Client Index = 19	Epoch: 2	Loss: 0.090976
Client Index = 19	Epoch: 3	Loss: 0.060753
Client Index = 19	Epoch: 4	Loss: 0.034450
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12035763212351594}
################local_test_on_all_clients after local training in communication round: 96
{'test_acc_after': 0.7978508516809351, 'test_loss_after': 0.7736599613712176}
################local_test_on_all_clients before local training in communication round: 96
{'test_acc_before': 0.8285151297334024, 'test_loss_before': 0.6343174391289054}
################Communication round : 97
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 0
local mask changes: 17462.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [17462.0, 700484.0, 712010.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 0	Epoch: 0	Loss: 0.078259
Client Index = 0	Epoch: 1	Loss: 0.159787
Client Index = 0	Epoch: 2	Loss: 0.056022
Client Index = 0	Epoch: 3	Loss: 0.035434
Client Index = 0	Epoch: 4	Loss: 0.386416
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 1
local mask changes: 17468.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [700080.0, 17468.0, 680372.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.046304
Client Index = 1	Epoch: 1	Loss: 0.056142
Client Index = 1	Epoch: 2	Loss: 0.027551
Client Index = 1	Epoch: 3	Loss: 0.026593
Client Index = 1	Epoch: 4	Loss: 0.347288
test acc on this client after 444 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 2
local mask changes: 17456.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [679658.0, 17456.0, 685030.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.024099
Client Index = 2	Epoch: 1	Loss: 0.019108
Client Index = 2	Epoch: 2	Loss: 0.011914
Client Index = 2	Epoch: 3	Loss: 0.013109
Client Index = 2	Epoch: 4	Loss: 0.044591
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 3
local mask changes: 17466.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [685684.0, 17466.0, 706312.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.055390
Client Index = 3	Epoch: 1	Loss: 0.015175
Client Index = 3	Epoch: 2	Loss: 0.044068
Client Index = 3	Epoch: 3	Loss: 0.046176
Client Index = 3	Epoch: 4	Loss: 0.025633
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 4
local mask changes: 17468.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [706750.0, 17468.0, 717358.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.083690
Client Index = 4	Epoch: 1	Loss: 0.280024
Client Index = 4	Epoch: 2	Loss: 0.188699
Client Index = 4	Epoch: 3	Loss: 0.045874
Client Index = 4	Epoch: 4	Loss: 0.034149
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 5
local mask changes: 17466.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [717078.0, 17466.0, 723324.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.236067
Client Index = 5	Epoch: 1	Loss: 0.129104
Client Index = 5	Epoch: 2	Loss: 0.090079
Client Index = 5	Epoch: 3	Loss: 0.068392
Client Index = 5	Epoch: 4	Loss: 0.110888
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 6
local mask changes: 17470.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [723520.0, 17470.0, 729930.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.060199
Client Index = 6	Epoch: 1	Loss: 0.082767
Client Index = 6	Epoch: 2	Loss: 0.275282
Client Index = 6	Epoch: 3	Loss: 0.128443
Client Index = 6	Epoch: 4	Loss: 0.133969
test acc on this client after 391 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 7
local mask changes: 17460.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [729760.0, 17460.0, 704590.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 7	Epoch: 0	Loss: 0.277684
Client Index = 7	Epoch: 1	Loss: 0.134864
Client Index = 7	Epoch: 2	Loss: 0.247474
Client Index = 7	Epoch: 3	Loss: 0.103280
Client Index = 7	Epoch: 4	Loss: 0.333841
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 8
local mask changes: 17458.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [703638.0, 17458.0, 690340.0]
Doing local aggregation!
test acc on this client before 461 / 504 : 0.91
Client Index = 8	Epoch: 0	Loss: 0.025360
Client Index = 8	Epoch: 1	Loss: 0.016640
Client Index = 8	Epoch: 2	Loss: 0.015576
Client Index = 8	Epoch: 3	Loss: 0.023625
Client Index = 8	Epoch: 4	Loss: 0.027576
test acc on this client after 464 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 9
local mask changes: 17460.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [691612.0, 17460.0, 713626.0]
Doing local aggregation!
test acc on this client before 398 / 506 : 0.79
Client Index = 9	Epoch: 0	Loss: 0.063352
Client Index = 9	Epoch: 1	Loss: 0.041319
Client Index = 9	Epoch: 2	Loss: 0.046117
Client Index = 9	Epoch: 3	Loss: 0.305027
Client Index = 9	Epoch: 4	Loss: 0.095390
test acc on this client after 337 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 10
local mask changes: 17468.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [713722.0, 17468.0, 697552.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.169488
Client Index = 10	Epoch: 1	Loss: 0.146904
Client Index = 10	Epoch: 2	Loss: 0.196514
Client Index = 10	Epoch: 3	Loss: 0.102313
Client Index = 10	Epoch: 4	Loss: 0.141055
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 11
local mask changes: 17474.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [696706.0, 17474.0, 696360.0]
Doing local aggregation!
test acc on this client before 448 / 505 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.176775
Client Index = 11	Epoch: 1	Loss: 0.092477
Client Index = 11	Epoch: 2	Loss: 0.042806
Client Index = 11	Epoch: 3	Loss: 0.046665
Client Index = 11	Epoch: 4	Loss: 0.037067
test acc on this client after 444 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 12
local mask changes: 17466.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [696846.0, 17466.0, 709552.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.293907
Client Index = 12	Epoch: 1	Loss: 0.135839
Client Index = 12	Epoch: 2	Loss: 0.056492
Client Index = 12	Epoch: 3	Loss: 0.074073
Client Index = 12	Epoch: 4	Loss: 0.105020
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 13
local mask changes: 17478.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [709884.0, 17478.0, 703546.0]
Doing local aggregation!
test acc on this client before 416 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.091719
Client Index = 13	Epoch: 1	Loss: 0.166010
Client Index = 13	Epoch: 2	Loss: 0.078502
Client Index = 13	Epoch: 3	Loss: 0.108508
Client Index = 13	Epoch: 4	Loss: 0.065057
test acc on this client after 408 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 14
local mask changes: 17468.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [703194.0, 17468.0, 699748.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.242659
Client Index = 14	Epoch: 1	Loss: 0.101645
Client Index = 14	Epoch: 2	Loss: 0.178429
Client Index = 14	Epoch: 3	Loss: 0.067760
Client Index = 14	Epoch: 4	Loss: 0.077894
test acc on this client after 351 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 15
local mask changes: 17458.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [699878.0, 17458.0, 697226.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.100610
Client Index = 15	Epoch: 1	Loss: 0.268384
Client Index = 15	Epoch: 2	Loss: 0.059452
Client Index = 15	Epoch: 3	Loss: 0.057236
Client Index = 15	Epoch: 4	Loss: 0.040042
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 16
local mask changes: 17470.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [697386.0, 17470.0, 714586.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.153761
Client Index = 16	Epoch: 1	Loss: 0.068007
Client Index = 16	Epoch: 2	Loss: 0.083425
Client Index = 16	Epoch: 3	Loss: 0.290213
Client Index = 16	Epoch: 4	Loss: 0.074148
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 17
local mask changes: 17468.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [714920.0, 17468.0, 716076.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.157240
Client Index = 17	Epoch: 1	Loss: 0.409451
Client Index = 17	Epoch: 2	Loss: 0.086623
Client Index = 17	Epoch: 3	Loss: 0.113479
Client Index = 17	Epoch: 4	Loss: 0.171068
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 18
local mask changes: 17474.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [715796.0, 17474.0, 704274.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.088046
Client Index = 18	Epoch: 1	Loss: 0.141888
Client Index = 18	Epoch: 2	Loss: 0.085903
Client Index = 18	Epoch: 3	Loss: 0.333038
Client Index = 18	Epoch: 4	Loss: 0.073280
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 19
local mask changes: 17464.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [712006.0, 704506.0, 17464.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.117585
Client Index = 19	Epoch: 1	Loss: 0.114809
Client Index = 19	Epoch: 2	Loss: 0.202786
Client Index = 19	Epoch: 3	Loss: 0.097592
Client Index = 19	Epoch: 4	Loss: 0.040566
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.11648019974492489}
################local_test_on_all_clients after local training in communication round: 97
{'test_acc_after': 0.8021196075175354, 'test_loss_after': 0.792376110452959}
################local_test_on_all_clients before local training in communication round: 97
{'test_acc_before': 0.824928359389722, 'test_loss_before': 0.6350252441875843}
################Communication round : 98
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 0
local mask changes: 9838.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [9838.0, 700998.0, 712358.0]
Doing local aggregation!
test acc on this client before 426 / 503 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.067153
Client Index = 0	Epoch: 1	Loss: 0.088456
Client Index = 0	Epoch: 2	Loss: 0.058000
Client Index = 0	Epoch: 3	Loss: 0.244357
Client Index = 0	Epoch: 4	Loss: 0.047548
test acc on this client after 432 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 1
local mask changes: 9840.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [700458.0, 9840.0, 680336.0]
Doing local aggregation!
test acc on this client before 438 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.048691
Client Index = 1	Epoch: 1	Loss: 0.042781
Client Index = 1	Epoch: 2	Loss: 0.074369
Client Index = 1	Epoch: 3	Loss: 0.024794
Client Index = 1	Epoch: 4	Loss: 0.017531
test acc on this client after 453 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 2
local mask changes: 9848.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [679858.0, 9848.0, 685120.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.028600
Client Index = 2	Epoch: 1	Loss: 0.042380
Client Index = 2	Epoch: 2	Loss: 0.047839
Client Index = 2	Epoch: 3	Loss: 0.030028
Client Index = 2	Epoch: 4	Loss: 0.042268
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 3
local mask changes: 9842.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [685234.0, 9842.0, 706426.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.150135
Client Index = 3	Epoch: 1	Loss: 0.074970
Client Index = 3	Epoch: 2	Loss: 0.042109
Client Index = 3	Epoch: 3	Loss: 0.061480
Client Index = 3	Epoch: 4	Loss: 0.031410
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 4
local mask changes: 9842.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [706844.0, 9842.0, 717092.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.036862
Client Index = 4	Epoch: 1	Loss: 0.129917
Client Index = 4	Epoch: 2	Loss: 0.064176
Client Index = 4	Epoch: 3	Loss: 0.099333
Client Index = 4	Epoch: 4	Loss: 0.096405
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 5
local mask changes: 9848.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [717366.0, 9848.0, 723592.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.119210
Client Index = 5	Epoch: 1	Loss: 0.247725
Client Index = 5	Epoch: 2	Loss: 0.250887
Client Index = 5	Epoch: 3	Loss: 0.057064
Client Index = 5	Epoch: 4	Loss: 0.058506
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 6
local mask changes: 9844.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [723710.0, 9844.0, 729960.0]
Doing local aggregation!
test acc on this client before 405 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.090740
Client Index = 6	Epoch: 1	Loss: 0.060966
Client Index = 6	Epoch: 2	Loss: 0.089682
Client Index = 6	Epoch: 3	Loss: 0.180848
Client Index = 6	Epoch: 4	Loss: 0.305028
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 7
local mask changes: 9840.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [730114.0, 9840.0, 704750.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 7	Epoch: 0	Loss: 0.134603
Client Index = 7	Epoch: 1	Loss: 0.394883
Client Index = 7	Epoch: 2	Loss: 0.150163
Client Index = 7	Epoch: 3	Loss: 0.157259
Client Index = 7	Epoch: 4	Loss: 0.353604
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 8
local mask changes: 9838.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [703618.0, 9838.0, 690876.0]
Doing local aggregation!
test acc on this client before 463 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.037077
Client Index = 8	Epoch: 1	Loss: 0.017503
Client Index = 8	Epoch: 2	Loss: 0.036382
Client Index = 8	Epoch: 3	Loss: 0.043014
Client Index = 8	Epoch: 4	Loss: 0.016725
test acc on this client after 473 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 9
local mask changes: 9848.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [691448.0, 9848.0, 714182.0]
Doing local aggregation!
test acc on this client before 388 / 506 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.103558
Client Index = 9	Epoch: 1	Loss: 0.196091
Client Index = 9	Epoch: 2	Loss: 0.071419
Client Index = 9	Epoch: 3	Loss: 0.066997
Client Index = 9	Epoch: 4	Loss: 0.056784
test acc on this client after 394 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 10
local mask changes: 9846.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [714252.0, 9846.0, 697632.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.099688
Client Index = 10	Epoch: 1	Loss: 0.318326
Client Index = 10	Epoch: 2	Loss: 0.101600
Client Index = 10	Epoch: 3	Loss: 0.113963
Client Index = 10	Epoch: 4	Loss: 0.102027
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 11
local mask changes: 9848.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [697212.0, 9848.0, 696488.0]
Doing local aggregation!
test acc on this client before 443 / 505 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.070024
Client Index = 11	Epoch: 1	Loss: 0.095182
Client Index = 11	Epoch: 2	Loss: 0.083318
Client Index = 11	Epoch: 3	Loss: 0.021268
Client Index = 11	Epoch: 4	Loss: 0.034194
test acc on this client after 435 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 12
local mask changes: 9842.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [697012.0, 9842.0, 710088.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.265718
Client Index = 12	Epoch: 1	Loss: 0.222194
Client Index = 12	Epoch: 2	Loss: 0.069217
Client Index = 12	Epoch: 3	Loss: 0.053092
Client Index = 12	Epoch: 4	Loss: 0.039234
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 13
local mask changes: 9842.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [710040.0, 9842.0, 703736.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.086976
Client Index = 13	Epoch: 1	Loss: 0.247001
Client Index = 13	Epoch: 2	Loss: 0.065824
Client Index = 13	Epoch: 3	Loss: 0.060999
Client Index = 13	Epoch: 4	Loss: 0.049884
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 14
local mask changes: 9844.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [703728.0, 9844.0, 700026.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.227542
Client Index = 14	Epoch: 1	Loss: 0.109604
Client Index = 14	Epoch: 2	Loss: 0.294670
Client Index = 14	Epoch: 3	Loss: 0.204327
Client Index = 14	Epoch: 4	Loss: 0.068816
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 15
local mask changes: 9846.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [699812.0, 9846.0, 697488.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.082901
Client Index = 15	Epoch: 1	Loss: 0.234077
Client Index = 15	Epoch: 2	Loss: 0.118799
Client Index = 15	Epoch: 3	Loss: 0.067000
Client Index = 15	Epoch: 4	Loss: 0.054971
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 16
local mask changes: 9840.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [697728.0, 9840.0, 714960.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 16	Epoch: 0	Loss: 0.073355
Client Index = 16	Epoch: 1	Loss: 0.159282
Client Index = 16	Epoch: 2	Loss: 0.101918
Client Index = 16	Epoch: 3	Loss: 0.116260
Client Index = 16	Epoch: 4	Loss: 0.263205
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 17
local mask changes: 9840.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [715228.0, 9840.0, 716358.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.075919
Client Index = 17	Epoch: 1	Loss: 0.352556
Client Index = 17	Epoch: 2	Loss: 0.114457
Client Index = 17	Epoch: 3	Loss: 0.137692
Client Index = 17	Epoch: 4	Loss: 0.120446
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 18
local mask changes: 9842.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [716134.0, 9842.0, 704578.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.061065
Client Index = 18	Epoch: 1	Loss: 0.381651
Client Index = 18	Epoch: 2	Loss: 0.042991
Client Index = 18	Epoch: 3	Loss: 0.035669
Client Index = 18	Epoch: 4	Loss: 0.025299
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 19
local mask changes: 9848.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [712096.0, 704490.0, 9848.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.093826
Client Index = 19	Epoch: 1	Loss: 0.188447
Client Index = 19	Epoch: 2	Loss: 0.123807
Client Index = 19	Epoch: 3	Loss: 0.054031
Client Index = 19	Epoch: 4	Loss: 0.022470
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.11195091498142576}
################local_test_on_all_clients after local training in communication round: 98
{'test_acc_after': 0.8186824637309191, 'test_loss_after': 0.7242701156712246}
################local_test_on_all_clients before local training in communication round: 98
{'test_acc_before': 0.8246366299293697, 'test_loss_before': 0.6418176401295813}
################Communication round : 99
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 0
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 0  1 19], accoring to ring
choose mask diff: [4386.0, 701152.0, 712614.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 0	Epoch: 0	Loss: 0.046972
Client Index = 0	Epoch: 1	Loss: 0.042098
Client Index = 0	Epoch: 2	Loss: 0.280100
Client Index = 0	Epoch: 3	Loss: 0.189317
Client Index = 0	Epoch: 4	Loss: 0.053999
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 1
local mask changes: 4386.0 / 11173962
choose client_indexes: [0 1 2], accoring to ring
choose mask diff: [700940.0, 4386.0, 680282.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.050848
Client Index = 1	Epoch: 1	Loss: 0.054166
Client Index = 1	Epoch: 2	Loss: 0.060950
Client Index = 1	Epoch: 3	Loss: 0.060150
Client Index = 1	Epoch: 4	Loss: 0.026376
test acc on this client after 443 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 2
local mask changes: 4386.0 / 11173962
choose client_indexes: [1 2 3], accoring to ring
choose mask diff: [680250.0, 4386.0, 685102.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.015553
Client Index = 2	Epoch: 1	Loss: 0.029481
Client Index = 2	Epoch: 2	Loss: 0.034437
Client Index = 2	Epoch: 3	Loss: 0.057295
Client Index = 2	Epoch: 4	Loss: 0.056279
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 3
local mask changes: 4386.0 / 11173962
choose client_indexes: [2 3 4], accoring to ring
choose mask diff: [685288.0, 4386.0, 706714.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.104483
Client Index = 3	Epoch: 1	Loss: 0.180347
Client Index = 3	Epoch: 2	Loss: 0.145908
Client Index = 3	Epoch: 3	Loss: 0.044271
Client Index = 3	Epoch: 4	Loss: 0.038987
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 4
local mask changes: 4386.0 / 11173962
choose client_indexes: [3 4 5], accoring to ring
choose mask diff: [706840.0, 4386.0, 717430.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.060546
Client Index = 4	Epoch: 1	Loss: 0.123866
Client Index = 4	Epoch: 2	Loss: 0.186786
Client Index = 4	Epoch: 3	Loss: 0.074227
Client Index = 4	Epoch: 4	Loss: 0.123610
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 5
local mask changes: 4388.0 / 11173962
choose client_indexes: [4 5 6], accoring to ring
choose mask diff: [717540.0, 4388.0, 724034.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.084996
Client Index = 5	Epoch: 1	Loss: 0.476930
Client Index = 5	Epoch: 2	Loss: 0.137133
Client Index = 5	Epoch: 3	Loss: 0.085025
Client Index = 5	Epoch: 4	Loss: 0.056225
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 6
local mask changes: 4384.0 / 11173962
choose client_indexes: [5 6 7], accoring to ring
choose mask diff: [724060.0, 4384.0, 730416.0]
Doing local aggregation!
test acc on this client before 412 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.057720
Client Index = 6	Epoch: 1	Loss: 0.338721
Client Index = 6	Epoch: 2	Loss: 0.131340
Client Index = 6	Epoch: 3	Loss: 0.069236
Client Index = 6	Epoch: 4	Loss: 0.066556
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 7
local mask changes: 4388.0 / 11173962
choose client_indexes: [6 7 8], accoring to ring
choose mask diff: [730456.0, 4388.0, 704690.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.102198
Client Index = 7	Epoch: 1	Loss: 0.255311
Client Index = 7	Epoch: 2	Loss: 0.083681
Client Index = 7	Epoch: 3	Loss: 0.234355
Client Index = 7	Epoch: 4	Loss: 0.079663
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 8
local mask changes: 4382.0 / 11173962
choose client_indexes: [7 8 9], accoring to ring
choose mask diff: [704318.0, 4382.0, 691222.0]
Doing local aggregation!
test acc on this client before 466 / 504 : 0.92
Client Index = 8	Epoch: 0	Loss: 0.029713
Client Index = 8	Epoch: 1	Loss: 0.039980
Client Index = 8	Epoch: 2	Loss: 0.026818
Client Index = 8	Epoch: 3	Loss: 0.019891
Client Index = 8	Epoch: 4	Loss: 0.172016
test acc on this client after 476 / 504 : 0.94
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 9
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 8  9 10], accoring to ring
choose mask diff: [691378.0, 4386.0, 714548.0]
Doing local aggregation!
test acc on this client before 397 / 506 : 0.78
Client Index = 9	Epoch: 0	Loss: 0.053932
Client Index = 9	Epoch: 1	Loss: 0.234268
Client Index = 9	Epoch: 2	Loss: 0.086512
Client Index = 9	Epoch: 3	Loss: 0.232057
Client Index = 9	Epoch: 4	Loss: 0.109590
test acc on this client after 395 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 10
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 9 10 11], accoring to ring
choose mask diff: [714644.0, 4388.0, 697900.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.059415
Client Index = 10	Epoch: 1	Loss: 0.121675
Client Index = 10	Epoch: 2	Loss: 0.252561
Client Index = 10	Epoch: 3	Loss: 0.289087
Client Index = 10	Epoch: 4	Loss: 0.096665
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 11
local mask changes: 4388.0 / 11173962
choose client_indexes: [10 11 12], accoring to ring
choose mask diff: [697634.0, 4388.0, 697014.0]
Doing local aggregation!
test acc on this client before 447 / 505 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.080461
Client Index = 11	Epoch: 1	Loss: 0.263174
Client Index = 11	Epoch: 2	Loss: 0.033599
Client Index = 11	Epoch: 3	Loss: 0.018982
Client Index = 11	Epoch: 4	Loss: 0.023972
test acc on this client after 439 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 12
local mask changes: 4386.0 / 11173962
choose client_indexes: [11 12 13], accoring to ring
choose mask diff: [697126.0, 4386.0, 710446.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 12	Epoch: 0	Loss: 0.213474
Client Index = 12	Epoch: 1	Loss: 0.275414
Client Index = 12	Epoch: 2	Loss: 0.138213
Client Index = 12	Epoch: 3	Loss: 0.065875
Client Index = 12	Epoch: 4	Loss: 0.134170
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 13
local mask changes: 4382.0 / 11173962
choose client_indexes: [12 13 14], accoring to ring
choose mask diff: [710498.0, 4382.0, 704202.0]
Doing local aggregation!
test acc on this client before 415 / 505 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.079107
Client Index = 13	Epoch: 1	Loss: 0.227240
Client Index = 13	Epoch: 2	Loss: 0.046931
Client Index = 13	Epoch: 3	Loss: 0.046734
Client Index = 13	Epoch: 4	Loss: 0.054920
test acc on this client after 390 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 14
local mask changes: 4386.0 / 11173962
choose client_indexes: [13 14 15], accoring to ring
choose mask diff: [704140.0, 4386.0, 700308.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.094779
Client Index = 14	Epoch: 1	Loss: 0.233692
Client Index = 14	Epoch: 2	Loss: 0.126719
Client Index = 14	Epoch: 3	Loss: 0.054504
Client Index = 14	Epoch: 4	Loss: 0.064351
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 15
local mask changes: 4386.0 / 11173962
choose client_indexes: [14 15 16], accoring to ring
choose mask diff: [700142.0, 4386.0, 697990.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.116392
Client Index = 15	Epoch: 1	Loss: 0.139680
Client Index = 15	Epoch: 2	Loss: 0.164413
Client Index = 15	Epoch: 3	Loss: 0.053850
Client Index = 15	Epoch: 4	Loss: 0.029018
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 16
local mask changes: 4388.0 / 11173962
choose client_indexes: [15 16 17], accoring to ring
choose mask diff: [698028.0, 4388.0, 715590.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.084037
Client Index = 16	Epoch: 1	Loss: 0.126920
Client Index = 16	Epoch: 2	Loss: 0.185688
Client Index = 16	Epoch: 3	Loss: 0.042276
Client Index = 16	Epoch: 4	Loss: 0.080157
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 17
local mask changes: 4388.0 / 11173962
choose client_indexes: [16 17 18], accoring to ring
choose mask diff: [715592.0, 4388.0, 716792.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.175433
Client Index = 17	Epoch: 1	Loss: 0.279231
Client Index = 17	Epoch: 2	Loss: 0.109743
Client Index = 17	Epoch: 3	Loss: 0.125245
Client Index = 17	Epoch: 4	Loss: 0.079293
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 18
local mask changes: 4388.0 / 11173962
choose client_indexes: [17 18 19], accoring to ring
choose mask diff: [716622.0, 4388.0, 704788.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.109152
Client Index = 18	Epoch: 1	Loss: 0.235686
Client Index = 18	Epoch: 2	Loss: 0.046002
Client Index = 18	Epoch: 3	Loss: 0.054016
Client Index = 18	Epoch: 4	Loss: 0.040643
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 19
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 0 18 19], accoring to ring
choose mask diff: [712544.0, 704844.0, 4384.0]
Doing local aggregation!
test acc on this client before 426 / 503 : 0.85
Client Index = 19	Epoch: 0	Loss: 0.159324
Client Index = 19	Epoch: 1	Loss: 0.095550
Client Index = 19	Epoch: 2	Loss: 0.068123
Client Index = 19	Epoch: 3	Loss: 0.079994
Client Index = 19	Epoch: 4	Loss: 0.215478
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.11395978943409864}
################local_test_on_all_clients after local training in communication round: 99
{'test_acc_after': 0.8128277081641088, 'test_loss_after': 0.7507193839126253}
################local_test_on_all_clients before local training in communication round: 99
{'test_acc_before': 0.8340618497456601, 'test_loss_before': 0.6211917526659232}
