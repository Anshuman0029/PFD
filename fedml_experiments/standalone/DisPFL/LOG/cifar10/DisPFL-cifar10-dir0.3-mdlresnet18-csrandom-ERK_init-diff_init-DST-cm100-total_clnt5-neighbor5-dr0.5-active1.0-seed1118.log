Namespace(active=1.0, anneal_factor=0.5, batch_size=128, ci=0, client_num_in_total=5, client_num_per_round=5, client_optimizer='sgd', comm_round=100, cs='random', data_dir='/Date/FL/DisPFL-master/data/', dataset='cifar10', dense_ratio=0.5, diff_spa=False, different_initial=True, dis_gradient_check=True, epochs=5, erk_power_scale=1, frac=1.0, frequency_of_the_test=1, global_test=False, gpu=0, identity='DisPFL-cifar10-dir0.3-mdlresnet18-csrandom-ERK_init-diff_init-DST-cm100-total_clnt5-neighbor5-dr0.5-active1.0-seed1118', lr=0.1, lr_decay=0.998, model='resnet18', momentum=0, partition_alpha=0.3, partition_method='dir', public_portion=0, record_mask_diff=False, save_masks=False, seed=1118, static=False, strict_avg=False, tag='test', uniform=False, wd=0.0005)
cuda:0
*********partition data***************
train_num25000  test_num2005
client_idx = 0, local_sample_number = 25000
train_num25000  test_num2005
client_idx = 1, local_sample_number = 25000
train_num25000  test_num2003
client_idx = 2, local_sample_number = 25000
train_num25000  test_num2006
client_idx = 3, local_sample_number = 25000
train_num25000  test_num2005
client_idx = 4, local_sample_number = 25000
DATA Partition: Train [2545, 2474, 2499, 2427, 2552, 2506, 2486, 2502, 2482, 2527]; Test [204, 198, 200, 195, 205, 201, 199, 201, 199, 203]
DATA Partition: Train [2521, 2513, 2412, 2494, 2533, 2557, 2466, 2541, 2499, 2464]; Test [202, 202, 193, 200, 203, 205, 198, 204, 200, 198]
DATA Partition: Train [2454, 2470, 2487, 2459, 2525, 2525, 2536, 2582, 2480, 2482]; Test [197, 198, 199, 197, 202, 202, 203, 207, 199, 199]
DATA Partition: Train [2533, 2516, 2493, 2494, 2470, 2513, 2503, 2550, 2476, 2452]; Test [203, 202, 200, 200, 198, 202, 201, 204, 199, 197]
DATA Partition: Train [2455, 2453, 2506, 2511, 2548, 2512, 2567, 2466, 2489, 2493]; Test [197, 197, 201, 201, 204, 201, 206, 198, 200, 200]
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 128, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 256, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 512, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
############setup_clients (START)#############
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
self.local_sample_number = 25000
############setup_clients (END)#############
initialize by ERK
################Communication round : 0
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 0
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [0.0, 4551334.0, 4552914.0, 4550632.0, 4550534.0]
Doing local aggregation!
test acc on this client before 205 / 2005 : 0.10
Client Index = 0	Epoch: 0	Loss: 2.368668
Client Index = 0	Epoch: 1	Loss: 1.983713
Client Index = 0	Epoch: 2	Loss: 1.837641
Client Index = 0	Epoch: 3	Loss: 1.728852
Client Index = 0	Epoch: 4	Loss: 1.640300
test acc on this client after 784 / 2005 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 1
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4551334.0, 0.0, 4552570.0, 4553176.0, 4551606.0]
Doing local aggregation!
test acc on this client before 214 / 2005 : 0.11
Client Index = 1	Epoch: 0	Loss: 2.416151
Client Index = 1	Epoch: 1	Loss: 1.977753
Client Index = 1	Epoch: 2	Loss: 1.836345
Client Index = 1	Epoch: 3	Loss: 1.734469
Client Index = 1	Epoch: 4	Loss: 1.659913
test acc on this client after 780 / 2005 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 2
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4552914.0, 4552570.0, 0.0, 4552544.0, 4552270.0]
Doing local aggregation!
test acc on this client before 195 / 2003 : 0.10
Client Index = 2	Epoch: 0	Loss: 2.406731
Client Index = 2	Epoch: 1	Loss: 1.991690
Client Index = 2	Epoch: 2	Loss: 1.851852
Client Index = 2	Epoch: 3	Loss: 1.746876
Client Index = 2	Epoch: 4	Loss: 1.663787
test acc on this client after 845 / 2003 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 3
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4550632.0, 4553176.0, 4552544.0, 0.0, 4552026.0]
Doing local aggregation!
test acc on this client before 203 / 2006 : 0.10
Client Index = 3	Epoch: 0	Loss: 2.413362
Client Index = 3	Epoch: 1	Loss: 1.979908
Client Index = 3	Epoch: 2	Loss: 1.833085
Client Index = 3	Epoch: 3	Loss: 1.741152
Client Index = 3	Epoch: 4	Loss: 1.650214
test acc on this client after 652 / 2006 : 0.33
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 4
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4550534.0, 4551606.0, 4552270.0, 4552026.0, 0.0]
Doing local aggregation!
test acc on this client before 178 / 2005 : 0.09
Client Index = 4	Epoch: 0	Loss: 2.390403
Client Index = 4	Epoch: 1	Loss: 1.967705
Client Index = 4	Epoch: 2	Loss: 1.838068
Client Index = 4	Epoch: 3	Loss: 1.721682
Client Index = 4	Epoch: 4	Loss: 1.646455
test acc on this client after 548 / 2005 : 0.27
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.921071052916196}
################local_test_on_all_clients after local training in communication round: 0
{'test_acc_after': 0.3600517415933345, 'test_loss_after': 1.7907741796484995}
################local_test_on_all_clients before local training in communication round: 0
{'test_acc_before': 0.09926119815733916, 'test_loss_before': 2.4175710414237264}
################Communication round : 1
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 0
local mask changes: 2939242.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2939242.0, 4552494.0, 4553170.0, 4551470.0, 4553552.0]
Doing local aggregation!
test acc on this client before 428 / 2005 : 0.21
Client Index = 0	Epoch: 0	Loss: 1.779626
Client Index = 0	Epoch: 1	Loss: 1.617636
Client Index = 0	Epoch: 2	Loss: 1.521434
Client Index = 0	Epoch: 3	Loss: 1.450656
Client Index = 0	Epoch: 4	Loss: 1.378870
test acc on this client after 1046 / 2005 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 1
local mask changes: 2938676.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4552368.0, 2938676.0, 4553024.0, 4552702.0, 4552594.0]
Doing local aggregation!
test acc on this client before 386 / 2005 : 0.19
Client Index = 1	Epoch: 0	Loss: 1.790096
Client Index = 1	Epoch: 1	Loss: 1.619022
Client Index = 1	Epoch: 2	Loss: 1.529850
Client Index = 1	Epoch: 3	Loss: 1.457474
Client Index = 1	Epoch: 4	Loss: 1.373105
test acc on this client after 692 / 2005 : 0.35
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 2
local mask changes: 2940274.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4551894.0, 4551344.0, 2940274.0, 4551692.0, 4553024.0]
Doing local aggregation!
test acc on this client before 373 / 2003 : 0.19
Client Index = 2	Epoch: 0	Loss: 1.804191
Client Index = 2	Epoch: 1	Loss: 1.638752
Client Index = 2	Epoch: 2	Loss: 1.542625
Client Index = 2	Epoch: 3	Loss: 1.473104
Client Index = 2	Epoch: 4	Loss: 1.391722
test acc on this client after 949 / 2003 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 3
local mask changes: 2939926.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4554296.0, 4554646.0, 4549422.0, 2939926.0, 4553638.0]
Doing local aggregation!
test acc on this client before 375 / 2006 : 0.19
Client Index = 3	Epoch: 0	Loss: 1.794481
Client Index = 3	Epoch: 1	Loss: 1.629323
Client Index = 3	Epoch: 2	Loss: 1.532071
Client Index = 3	Epoch: 3	Loss: 1.460049
Client Index = 3	Epoch: 4	Loss: 1.380359
test acc on this client after 798 / 2006 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 4
local mask changes: 2941006.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4555196.0, 4550014.0, 4552074.0, 4554474.0, 2941006.0]
Doing local aggregation!
test acc on this client before 423 / 2005 : 0.21
Client Index = 4	Epoch: 0	Loss: 1.794251
Client Index = 4	Epoch: 1	Loss: 1.622925
Client Index = 4	Epoch: 2	Loss: 1.530651
Client Index = 4	Epoch: 3	Loss: 1.452874
Client Index = 4	Epoch: 4	Loss: 1.389330
test acc on this client after 885 / 2005 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.5581792260189444}
################local_test_on_all_clients after local training in communication round: 1
{'test_acc_after': 0.4359650645438197, 'test_loss_after': 1.6139917347144515}
################local_test_on_all_clients before local training in communication round: 1
{'test_acc_before': 0.19802349148683696, 'test_loss_before': 1.9958747665698635}
################Communication round : 2
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 0
local mask changes: 2939212.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2939212.0, 4126054.0, 4125730.0, 4125150.0, 4125306.0]
Doing local aggregation!
test acc on this client before 993 / 2005 : 0.50
Client Index = 0	Epoch: 0	Loss: 1.404074
Client Index = 0	Epoch: 1	Loss: 1.306966
Client Index = 0	Epoch: 2	Loss: 1.237250
Client Index = 0	Epoch: 3	Loss: 1.182738
Client Index = 0	Epoch: 4	Loss: 1.117753
test acc on this client after 929 / 2005 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 1
local mask changes: 2940828.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4128572.0, 2940828.0, 4124848.0, 4127762.0, 4125690.0]
Doing local aggregation!
test acc on this client before 936 / 2005 : 0.47
Client Index = 1	Epoch: 0	Loss: 1.390690
Client Index = 1	Epoch: 1	Loss: 1.298762
Client Index = 1	Epoch: 2	Loss: 1.227573
Client Index = 1	Epoch: 3	Loss: 1.175932
Client Index = 1	Epoch: 4	Loss: 1.113633
test acc on this client after 1043 / 2005 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 2
local mask changes: 2937922.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4128146.0, 4129580.0, 2937922.0, 4127338.0, 4125204.0]
Doing local aggregation!
test acc on this client before 953 / 2003 : 0.48
Client Index = 2	Epoch: 0	Loss: 1.408100
Client Index = 2	Epoch: 1	Loss: 1.316130
Client Index = 2	Epoch: 2	Loss: 1.246282
Client Index = 2	Epoch: 3	Loss: 1.186158
Client Index = 2	Epoch: 4	Loss: 1.127490
test acc on this client after 1181 / 2003 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 3
local mask changes: 2939698.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4127202.0, 4128918.0, 4127212.0, 2939698.0, 4125860.0]
Doing local aggregation!
test acc on this client before 969 / 2006 : 0.48
Client Index = 3	Epoch: 0	Loss: 1.411803
Client Index = 3	Epoch: 1	Loss: 1.317718
Client Index = 3	Epoch: 2	Loss: 1.242401
Client Index = 3	Epoch: 3	Loss: 1.174205
Client Index = 3	Epoch: 4	Loss: 1.122440
test acc on this client after 1171 / 2006 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 4
local mask changes: 2939054.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4128110.0, 4125294.0, 4130110.0, 4127938.0, 2939054.0]
Doing local aggregation!
test acc on this client before 953 / 2005 : 0.48
Client Index = 4	Epoch: 0	Loss: 1.404450
Client Index = 4	Epoch: 1	Loss: 1.321810
Client Index = 4	Epoch: 2	Loss: 1.238659
Client Index = 4	Epoch: 3	Loss: 1.177554
Client Index = 4	Epoch: 4	Loss: 1.107275
test acc on this client after 1015 / 2005 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 1.2503139112068684}
################local_test_on_all_clients after local training in communication round: 2
{'test_acc_after': 0.5326279782942176, 'test_loss_after': 1.3223013945049236}
################local_test_on_all_clients before local training in communication round: 2
{'test_acc_before': 0.47924873035347443, 'test_loss_before': 1.457113714875597}
################Communication round : 3
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 0
local mask changes: 2936968.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2936968.0, 3878798.0, 3881514.0, 3881380.0, 3878908.0]
Doing local aggregation!
test acc on this client before 1284 / 2005 : 0.64
Client Index = 0	Epoch: 0	Loss: 1.093876
Client Index = 0	Epoch: 1	Loss: 1.058207
Client Index = 0	Epoch: 2	Loss: 0.979075
Client Index = 0	Epoch: 3	Loss: 0.937793
Client Index = 0	Epoch: 4	Loss: 0.900068
test acc on this client after 1273 / 2005 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 1
local mask changes: 2938196.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3877014.0, 2938196.0, 3880760.0, 3877944.0, 3877774.0]
Doing local aggregation!
test acc on this client before 1260 / 2005 : 0.63
Client Index = 1	Epoch: 0	Loss: 1.089688
Client Index = 1	Epoch: 1	Loss: 1.033940
Client Index = 1	Epoch: 2	Loss: 0.997798
Client Index = 1	Epoch: 3	Loss: 0.932709
Client Index = 1	Epoch: 4	Loss: 0.909468
test acc on this client after 1176 / 2005 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 2
local mask changes: 2938382.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3880856.0, 3880552.0, 2938382.0, 3880538.0, 3882126.0]
Doing local aggregation!
test acc on this client before 1252 / 2003 : 0.63
Client Index = 2	Epoch: 0	Loss: 1.100836
Client Index = 2	Epoch: 1	Loss: 1.051964
Client Index = 2	Epoch: 2	Loss: 0.988681
Client Index = 2	Epoch: 3	Loss: 0.952672
Client Index = 2	Epoch: 4	Loss: 0.903854
test acc on this client after 1207 / 2003 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 3
local mask changes: 2937912.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3880196.0, 3877306.0, 3877746.0, 2937912.0, 3879486.0]
Doing local aggregation!
test acc on this client before 1239 / 2006 : 0.62
Client Index = 3	Epoch: 0	Loss: 1.101673
Client Index = 3	Epoch: 1	Loss: 1.035611
Client Index = 3	Epoch: 2	Loss: 0.991354
Client Index = 3	Epoch: 3	Loss: 0.932545
Client Index = 3	Epoch: 4	Loss: 0.903313
test acc on this client after 1298 / 2006 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 4
local mask changes: 2936592.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3876082.0, 3875494.0, 3879340.0, 3879106.0, 2936592.0]
Doing local aggregation!
test acc on this client before 1222 / 2005 : 0.61
Client Index = 4	Epoch: 0	Loss: 1.099638
Client Index = 4	Epoch: 1	Loss: 1.041162
Client Index = 4	Epoch: 2	Loss: 0.988670
Client Index = 4	Epoch: 3	Loss: 0.942332
Client Index = 4	Epoch: 4	Loss: 0.900795
test acc on this client after 1069 / 2005 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.9947089380999001}
################local_test_on_all_clients after local training in communication round: 3
{'test_acc_after': 0.6008536791409629, 'test_loss_after': 1.1756816766929226}
################local_test_on_all_clients before local training in communication round: 3
{'test_acc_before': 0.624202740923088, 'test_loss_before': 1.065049264052139}
################Communication round : 4
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 0
local mask changes: 2933694.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2933694.0, 3708392.0, 3710634.0, 3712604.0, 3707486.0]
Doing local aggregation!
test acc on this client before 1427 / 2005 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.850033
Client Index = 0	Epoch: 1	Loss: 0.820278
Client Index = 0	Epoch: 2	Loss: 0.783233
Client Index = 0	Epoch: 3	Loss: 0.740737
Client Index = 0	Epoch: 4	Loss: 0.710465
test acc on this client after 1263 / 2005 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 1
local mask changes: 2933952.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3704384.0, 2933952.0, 3706614.0, 3707234.0, 3705458.0]
Doing local aggregation!
test acc on this client before 1379 / 2005 : 0.69
Client Index = 1	Epoch: 0	Loss: 0.845289
Client Index = 1	Epoch: 1	Loss: 0.818460
Client Index = 1	Epoch: 2	Loss: 0.783579
Client Index = 1	Epoch: 3	Loss: 0.760511
Client Index = 1	Epoch: 4	Loss: 0.717504
test acc on this client after 1313 / 2005 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 2
local mask changes: 2936546.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3709676.0, 3707480.0, 2936546.0, 3706776.0, 3705346.0]
Doing local aggregation!
test acc on this client before 1388 / 2003 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.869477
Client Index = 2	Epoch: 1	Loss: 0.834356
Client Index = 2	Epoch: 2	Loss: 0.790038
Client Index = 2	Epoch: 3	Loss: 0.755163
Client Index = 2	Epoch: 4	Loss: 0.731062
test acc on this client after 1403 / 2003 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 3
local mask changes: 2932226.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3708436.0, 3706692.0, 3708156.0, 2932226.0, 3704564.0]
Doing local aggregation!
test acc on this client before 1403 / 2006 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.859885
Client Index = 3	Epoch: 1	Loss: 0.831319
Client Index = 3	Epoch: 2	Loss: 0.789685
Client Index = 3	Epoch: 3	Loss: 0.755385
Client Index = 3	Epoch: 4	Loss: 0.716361
test acc on this client after 1344 / 2006 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 4
local mask changes: 2935750.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3706372.0, 3703478.0, 3707912.0, 3706554.0, 2935750.0]
Doing local aggregation!
test acc on this client before 1356 / 2005 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.853876
Client Index = 4	Epoch: 1	Loss: 0.827593
Client Index = 4	Epoch: 2	Loss: 0.794713
Client Index = 4	Epoch: 3	Loss: 0.758843
Client Index = 4	Epoch: 4	Loss: 0.726784
test acc on this client after 1310 / 2005 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.7889851282993141}
################local_test_on_all_clients after local training in communication round: 4
{'test_acc_after': 0.6617187938775173, 'test_loss_after': 1.0042589279742937}
################local_test_on_all_clients before local training in communication round: 4
{'test_acc_before': 0.6936345655185743, 'test_loss_before': 0.8907484516692333}
################Communication round : 5
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 0
local mask changes: 2929592.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2929592.0, 3576552.0, 3577514.0, 3576248.0, 3573938.0]
Doing local aggregation!
test acc on this client before 1494 / 2005 : 0.75
Client Index = 0	Epoch: 0	Loss: 0.678230
Client Index = 0	Epoch: 1	Loss: 0.650633
Client Index = 0	Epoch: 2	Loss: 0.633823
Client Index = 0	Epoch: 3	Loss: 0.615967
Client Index = 0	Epoch: 4	Loss: 0.589628
test acc on this client after 1517 / 2005 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 1
local mask changes: 2930122.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3574788.0, 2930122.0, 3576570.0, 3573722.0, 3572292.0]
Doing local aggregation!
test acc on this client before 1492 / 2005 : 0.74
Client Index = 1	Epoch: 0	Loss: 0.678367
Client Index = 1	Epoch: 1	Loss: 0.658883
Client Index = 1	Epoch: 2	Loss: 0.636285
Client Index = 1	Epoch: 3	Loss: 0.618233
Client Index = 1	Epoch: 4	Loss: 0.576062
test acc on this client after 1326 / 2005 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 2
local mask changes: 2930232.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3574954.0, 3575076.0, 2930232.0, 3572972.0, 3573838.0]
Doing local aggregation!
test acc on this client before 1478 / 2003 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.686645
Client Index = 2	Epoch: 1	Loss: 0.667315
Client Index = 2	Epoch: 2	Loss: 0.651159
Client Index = 2	Epoch: 3	Loss: 0.615513
Client Index = 2	Epoch: 4	Loss: 0.590406
test acc on this client after 1243 / 2003 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 3
local mask changes: 2930478.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3576566.0, 3571304.0, 3572332.0, 2930478.0, 3573330.0]
Doing local aggregation!
test acc on this client before 1495 / 2006 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.679712
Client Index = 3	Epoch: 1	Loss: 0.665680
Client Index = 3	Epoch: 2	Loss: 0.634463
Client Index = 3	Epoch: 3	Loss: 0.619374
Client Index = 3	Epoch: 4	Loss: 0.589009
test acc on this client after 1414 / 2006 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 4
local mask changes: 2930908.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3575576.0, 3571992.0, 3574020.0, 3572318.0, 2930908.0]
Doing local aggregation!
test acc on this client before 1465 / 2005 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.685023
Client Index = 4	Epoch: 1	Loss: 0.658746
Client Index = 4	Epoch: 2	Loss: 0.649327
Client Index = 4	Epoch: 3	Loss: 0.613172
Client Index = 4	Epoch: 4	Loss: 0.587945
test acc on this client after 1468 / 2005 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.6371839479524262}
################local_test_on_all_clients after local training in communication round: 5
{'test_acc_after': 0.6951158357055953, 'test_loss_after': 0.9304599207409847}
################local_test_on_all_clients before local training in communication round: 5
{'test_acc_before': 0.7406214984651511, 'test_loss_before': 0.7360973560629505}
################Communication round : 6
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 0
local mask changes: 2926828.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2926828.0, 3471592.0, 3472642.0, 3472214.0, 3469832.0]
Doing local aggregation!
test acc on this client before 1627 / 2005 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.550110
Client Index = 0	Epoch: 1	Loss: 0.548246
Client Index = 0	Epoch: 2	Loss: 0.525660
Client Index = 0	Epoch: 3	Loss: 0.493647
Client Index = 0	Epoch: 4	Loss: 0.487836
test acc on this client after 1664 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 1
local mask changes: 2925556.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3473102.0, 2925556.0, 3473310.0, 3468744.0, 3472246.0]
Doing local aggregation!
test acc on this client before 1610 / 2005 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.551697
Client Index = 1	Epoch: 1	Loss: 0.547258
Client Index = 1	Epoch: 2	Loss: 0.523043
Client Index = 1	Epoch: 3	Loss: 0.506538
Client Index = 1	Epoch: 4	Loss: 0.496040
test acc on this client after 1496 / 2005 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 2
local mask changes: 2926482.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3471922.0, 3470618.0, 2926482.0, 3470234.0, 3471562.0]
Doing local aggregation!
test acc on this client before 1568 / 2003 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.569244
Client Index = 2	Epoch: 1	Loss: 0.553068
Client Index = 2	Epoch: 2	Loss: 0.540657
Client Index = 2	Epoch: 3	Loss: 0.512431
Client Index = 2	Epoch: 4	Loss: 0.496004
test acc on this client after 1519 / 2003 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 3
local mask changes: 2927246.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3470052.0, 3470480.0, 3472882.0, 2927246.0, 3471720.0]
Doing local aggregation!
test acc on this client before 1608 / 2006 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.566583
Client Index = 3	Epoch: 1	Loss: 0.559471
Client Index = 3	Epoch: 2	Loss: 0.532835
Client Index = 3	Epoch: 3	Loss: 0.516370
Client Index = 3	Epoch: 4	Loss: 0.502376
test acc on this client after 1530 / 2006 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 4
local mask changes: 2925514.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3470472.0, 3470222.0, 3469236.0, 3471058.0, 2925514.0]
Doing local aggregation!
test acc on this client before 1612 / 2005 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.563718
Client Index = 4	Epoch: 1	Loss: 0.555527
Client Index = 4	Epoch: 2	Loss: 0.534559
Client Index = 4	Epoch: 3	Loss: 0.516174
Client Index = 4	Epoch: 4	Loss: 0.486431
test acc on this client after 1504 / 2005 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.529420833043298}
################local_test_on_all_clients after local training in communication round: 6
{'test_acc_after': 0.7694517718751346, 'test_loss_after': 0.6953369349001232}
################local_test_on_all_clients before local training in communication round: 6
{'test_acc_before': 0.8005749682103103, 'test_loss_before': 0.5800116300212943}
################Communication round : 7
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 0
local mask changes: 2920614.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2920614.0, 3388660.0, 3389386.0, 3389324.0, 3391916.0]
Doing local aggregation!
test acc on this client before 1699 / 2005 : 0.85
Client Index = 0	Epoch: 0	Loss: 0.469462
Client Index = 0	Epoch: 1	Loss: 0.456386
Client Index = 0	Epoch: 2	Loss: 0.443548
Client Index = 0	Epoch: 3	Loss: 0.436782
Client Index = 0	Epoch: 4	Loss: 0.421512
test acc on this client after 1657 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 1
local mask changes: 2920718.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3390918.0, 2920718.0, 3389460.0, 3389444.0, 3387524.0]
Doing local aggregation!
test acc on this client before 1673 / 2005 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.467612
Client Index = 1	Epoch: 1	Loss: 0.471109
Client Index = 1	Epoch: 2	Loss: 0.444870
Client Index = 1	Epoch: 3	Loss: 0.438721
Client Index = 1	Epoch: 4	Loss: 0.418582
test acc on this client after 1610 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 2
local mask changes: 2920322.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3388968.0, 3391122.0, 2920322.0, 3390380.0, 3389750.0]
Doing local aggregation!
test acc on this client before 1664 / 2003 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.476586
Client Index = 2	Epoch: 1	Loss: 0.474024
Client Index = 2	Epoch: 2	Loss: 0.464421
Client Index = 2	Epoch: 3	Loss: 0.443724
Client Index = 2	Epoch: 4	Loss: 0.428044
test acc on this client after 1630 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 3
local mask changes: 2919942.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3389196.0, 3387644.0, 3390370.0, 2919942.0, 3389312.0]
Doing local aggregation!
test acc on this client before 1664 / 2006 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.471994
Client Index = 3	Epoch: 1	Loss: 0.475960
Client Index = 3	Epoch: 2	Loss: 0.456754
Client Index = 3	Epoch: 3	Loss: 0.448993
Client Index = 3	Epoch: 4	Loss: 0.424354
test acc on this client after 1548 / 2006 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 4
local mask changes: 2921238.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3391622.0, 3389566.0, 3391556.0, 3390476.0, 2921238.0]
Doing local aggregation!
test acc on this client before 1649 / 2005 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.481428
Client Index = 4	Epoch: 1	Loss: 0.463565
Client Index = 4	Epoch: 2	Loss: 0.464705
Client Index = 4	Epoch: 3	Loss: 0.436849
Client Index = 4	Epoch: 4	Loss: 0.432261
test acc on this client after 1555 / 2005 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.4524898235895196}
################local_test_on_all_clients after local training in communication round: 7
{'test_acc_after': 0.7980903614680142, 'test_loss_after': 0.6157493853556952}
################local_test_on_all_clients before local training in communication round: 7
{'test_acc_before': 0.8329009472591311, 'test_loss_before': 0.4899527759673109}
################Communication round : 8
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 0
local mask changes: 2918444.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2918444.0, 3324446.0, 3326528.0, 3324950.0, 3326804.0]
Doing local aggregation!
test acc on this client before 1735 / 2005 : 0.87
Client Index = 0	Epoch: 0	Loss: 0.401744
Client Index = 0	Epoch: 1	Loss: 0.404094
Client Index = 0	Epoch: 2	Loss: 0.392640
Client Index = 0	Epoch: 3	Loss: 0.372640
Client Index = 0	Epoch: 4	Loss: 0.383949
test acc on this client after 1598 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 1
local mask changes: 2914786.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3326366.0, 2914786.0, 3326542.0, 3324574.0, 3327520.0]
Doing local aggregation!
test acc on this client before 1706 / 2005 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.399323
Client Index = 1	Epoch: 1	Loss: 0.400171
Client Index = 1	Epoch: 2	Loss: 0.396898
Client Index = 1	Epoch: 3	Loss: 0.391525
Client Index = 1	Epoch: 4	Loss: 0.361288
test acc on this client after 1531 / 2005 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 2
local mask changes: 2913974.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3325036.0, 3327576.0, 2913974.0, 3321990.0, 3325524.0]
Doing local aggregation!
test acc on this client before 1693 / 2003 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.416882
Client Index = 2	Epoch: 1	Loss: 0.404005
Client Index = 2	Epoch: 2	Loss: 0.405546
Client Index = 2	Epoch: 3	Loss: 0.385176
Client Index = 2	Epoch: 4	Loss: 0.372147
test acc on this client after 1217 / 2003 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 3
local mask changes: 2914004.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3325540.0, 3324554.0, 3325624.0, 2914004.0, 3323254.0]
Doing local aggregation!
test acc on this client before 1693 / 2006 : 0.84
Client Index = 3	Epoch: 0	Loss: 0.413410
Client Index = 3	Epoch: 1	Loss: 0.411826
Client Index = 3	Epoch: 2	Loss: 0.395924
Client Index = 3	Epoch: 3	Loss: 0.392367
Client Index = 3	Epoch: 4	Loss: 0.379657
test acc on this client after 1446 / 2006 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 4
local mask changes: 2913050.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3325650.0, 3327052.0, 3326308.0, 3324516.0, 2913050.0]
Doing local aggregation!
test acc on this client before 1706 / 2005 : 0.85
Client Index = 4	Epoch: 0	Loss: 0.412810
Client Index = 4	Epoch: 1	Loss: 0.410734
Client Index = 4	Epoch: 2	Loss: 0.406211
Client Index = 4	Epoch: 3	Loss: 0.384908
Client Index = 4	Epoch: 4	Loss: 0.372830
test acc on this client after 1536 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.39474814275089576}
################local_test_on_all_clients after local training in communication round: 8
{'test_acc_after': 0.7310218792764699, 'test_loss_after': 0.9463505102999747}
################local_test_on_all_clients before local training in communication round: 8
{'test_acc_before': 0.8512565083499084, 'test_loss_before': 0.4437831176489803}
################Communication round : 9
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 0
local mask changes: 2905952.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2905952.0, 3274982.0, 3274636.0, 3272758.0, 3274894.0]
Doing local aggregation!
test acc on this client before 1681 / 2005 : 0.84
Client Index = 0	Epoch: 0	Loss: 0.343284
Client Index = 0	Epoch: 1	Loss: 0.360939
Client Index = 0	Epoch: 2	Loss: 0.349116
Client Index = 0	Epoch: 3	Loss: 0.331650
Client Index = 0	Epoch: 4	Loss: 0.312371
test acc on this client after 1680 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 1
local mask changes: 2905322.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3274290.0, 2905322.0, 3271712.0, 3274224.0, 3274130.0]
Doing local aggregation!
test acc on this client before 1659 / 2005 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.357473
Client Index = 1	Epoch: 1	Loss: 0.357903
Client Index = 1	Epoch: 2	Loss: 0.340370
Client Index = 1	Epoch: 3	Loss: 0.332955
Client Index = 1	Epoch: 4	Loss: 0.328248
test acc on this client after 1595 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 2
local mask changes: 2905756.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3273970.0, 3274152.0, 2905756.0, 3274230.0, 3274254.0]
Doing local aggregation!
test acc on this client before 1641 / 2003 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.360096
Client Index = 2	Epoch: 1	Loss: 0.359669
Client Index = 2	Epoch: 2	Loss: 0.347484
Client Index = 2	Epoch: 3	Loss: 0.348296
Client Index = 2	Epoch: 4	Loss: 0.327276
test acc on this client after 1536 / 2003 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 3
local mask changes: 2905890.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3273310.0, 3274126.0, 3272824.0, 2905890.0, 3274858.0]
Doing local aggregation!
test acc on this client before 1640 / 2006 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.355529
Client Index = 3	Epoch: 1	Loss: 0.363684
Client Index = 3	Epoch: 2	Loss: 0.348725
Client Index = 3	Epoch: 3	Loss: 0.344383
Client Index = 3	Epoch: 4	Loss: 0.328254
test acc on this client after 1689 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 4
local mask changes: 2907858.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3274760.0, 3275498.0, 3274470.0, 3274746.0, 2907858.0]
Doing local aggregation!
test acc on this client before 1636 / 2005 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.359813
Client Index = 4	Epoch: 1	Loss: 0.360632
Client Index = 4	Epoch: 2	Loss: 0.349745
Client Index = 4	Epoch: 3	Loss: 0.332266
Client Index = 4	Epoch: 4	Loss: 0.321985
test acc on this client after 1652 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.34488583003075757}
################local_test_on_all_clients after local training in communication round: 9
{'test_acc_after': 0.8132360823314769, 'test_loss_after': 0.59001386790095}
################local_test_on_all_clients before local training in communication round: 9
{'test_acc_before': 0.8237227925016253, 'test_loss_before': 0.5595450190859586}
################Communication round : 10
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 0
local mask changes: 2898466.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2898466.0, 3232160.0, 3233790.0, 3232214.0, 3229694.0]
Doing local aggregation!
test acc on this client before 1785 / 2005 : 0.89
Client Index = 0	Epoch: 0	Loss: 0.305915
Client Index = 0	Epoch: 1	Loss: 0.317781
Client Index = 0	Epoch: 2	Loss: 0.306079
Client Index = 0	Epoch: 3	Loss: 0.294222
Client Index = 0	Epoch: 4	Loss: 0.281493
test acc on this client after 1729 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 1
local mask changes: 2898204.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3232520.0, 2898204.0, 3230874.0, 3231244.0, 3233982.0]
Doing local aggregation!
test acc on this client before 1735 / 2005 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.310356
Client Index = 1	Epoch: 1	Loss: 0.309265
Client Index = 1	Epoch: 2	Loss: 0.306076
Client Index = 1	Epoch: 3	Loss: 0.286085
Client Index = 1	Epoch: 4	Loss: 0.290245
test acc on this client after 1660 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 2
local mask changes: 2896152.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3229514.0, 3231582.0, 2896152.0, 3232138.0, 3229666.0]
Doing local aggregation!
test acc on this client before 1712 / 2003 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.319970
Client Index = 2	Epoch: 1	Loss: 0.318639
Client Index = 2	Epoch: 2	Loss: 0.311855
Client Index = 2	Epoch: 3	Loss: 0.305804
Client Index = 2	Epoch: 4	Loss: 0.301776
test acc on this client after 1607 / 2003 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 3
local mask changes: 2898106.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3232676.0, 3231512.0, 3231772.0, 2898106.0, 3232760.0]
Doing local aggregation!
test acc on this client before 1739 / 2006 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.319610
Client Index = 3	Epoch: 1	Loss: 0.330650
Client Index = 3	Epoch: 2	Loss: 0.305409
Client Index = 3	Epoch: 3	Loss: 0.302476
Client Index = 3	Epoch: 4	Loss: 0.288000
test acc on this client after 1639 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 4
local mask changes: 2900274.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3230844.0, 3231556.0, 3232632.0, 3231624.0, 2900274.0]
Doing local aggregation!
test acc on this client before 1730 / 2005 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.306787
Client Index = 4	Epoch: 1	Loss: 0.330031
Client Index = 4	Epoch: 2	Loss: 0.304322
Client Index = 4	Epoch: 3	Loss: 0.318675
Client Index = 4	Epoch: 4	Loss: 0.287500
test acc on this client after 1483 / 2005 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.3063607854107205}
################local_test_on_all_clients after local training in communication round: 10
{'test_acc_after': 0.8098541191278699, 'test_loss_after': 0.5963369237157068}
################local_test_on_all_clients before local training in communication round: 10
{'test_acc_before': 0.8680142181091408, 'test_loss_before': 0.4006534071711383}
################Communication round : 11
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 0
local mask changes: 2889678.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2889678.0, 3196322.0, 3196258.0, 3196974.0, 3195200.0]
Doing local aggregation!
test acc on this client before 1795 / 2005 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.270091
Client Index = 0	Epoch: 1	Loss: 0.269953
Client Index = 0	Epoch: 2	Loss: 0.274923
Client Index = 0	Epoch: 3	Loss: 0.265024
Client Index = 0	Epoch: 4	Loss: 0.254938
test acc on this client after 1654 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 1
local mask changes: 2890090.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3197530.0, 2890090.0, 3195422.0, 3198038.0, 3198426.0]
Doing local aggregation!
test acc on this client before 1769 / 2005 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.271312
Client Index = 1	Epoch: 1	Loss: 0.280690
Client Index = 1	Epoch: 2	Loss: 0.267259
Client Index = 1	Epoch: 3	Loss: 0.261510
Client Index = 1	Epoch: 4	Loss: 0.259204
test acc on this client after 1676 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 2
local mask changes: 2887862.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3197182.0, 3198476.0, 2887862.0, 3195716.0, 3198802.0]
Doing local aggregation!
test acc on this client before 1725 / 2003 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.282765
Client Index = 2	Epoch: 1	Loss: 0.279408
Client Index = 2	Epoch: 2	Loss: 0.278603
Client Index = 2	Epoch: 3	Loss: 0.276635
Client Index = 2	Epoch: 4	Loss: 0.252983
test acc on this client after 1526 / 2003 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 3
local mask changes: 2890250.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3194194.0, 3195060.0, 3196616.0, 2890250.0, 3196200.0]
Doing local aggregation!
test acc on this client before 1740 / 2006 : 0.87
Client Index = 3	Epoch: 0	Loss: 0.283730
Client Index = 3	Epoch: 1	Loss: 0.285749
Client Index = 3	Epoch: 2	Loss: 0.268946
Client Index = 3	Epoch: 3	Loss: 0.275584
Client Index = 3	Epoch: 4	Loss: 0.264508
test acc on this client after 1612 / 2006 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 4
local mask changes: 2888946.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3196448.0, 3196050.0, 3195494.0, 3195648.0, 2888946.0]
Doing local aggregation!
test acc on this client before 1742 / 2005 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.282221
Client Index = 4	Epoch: 1	Loss: 0.280518
Client Index = 4	Epoch: 2	Loss: 0.278053
Client Index = 4	Epoch: 3	Loss: 0.262076
Client Index = 4	Epoch: 4	Loss: 0.255589
test acc on this client after 1510 / 2005 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2712908774652347}
################local_test_on_all_clients after local training in communication round: 11
{'test_acc_after': 0.7958823067527236, 'test_loss_after': 0.6817238540723367}
################local_test_on_all_clients before local training in communication round: 11
{'test_acc_before': 0.8749980068397862, 'test_loss_before': 0.3843720596551551}
################Communication round : 12
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 0
local mask changes: 2877930.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2877930.0, 3164914.0, 3165948.0, 3163756.0, 3164730.0]
Doing local aggregation!
test acc on this client before 1796 / 2005 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.246529
Client Index = 0	Epoch: 1	Loss: 0.249172
Client Index = 0	Epoch: 2	Loss: 0.236922
Client Index = 0	Epoch: 3	Loss: 0.237032
Client Index = 0	Epoch: 4	Loss: 0.231686
test acc on this client after 1597 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 1
local mask changes: 2880892.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3167664.0, 2880892.0, 3168146.0, 3165600.0, 3167184.0]
Doing local aggregation!
test acc on this client before 1780 / 2005 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.246291
Client Index = 1	Epoch: 1	Loss: 0.251458
Client Index = 1	Epoch: 2	Loss: 0.248921
Client Index = 1	Epoch: 3	Loss: 0.231419
Client Index = 1	Epoch: 4	Loss: 0.220877
test acc on this client after 1666 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 2
local mask changes: 2877650.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3167144.0, 3165072.0, 2877650.0, 3164960.0, 3165872.0]
Doing local aggregation!
test acc on this client before 1754 / 2003 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.263730
Client Index = 2	Epoch: 1	Loss: 0.255976
Client Index = 2	Epoch: 2	Loss: 0.242945
Client Index = 2	Epoch: 3	Loss: 0.239918
Client Index = 2	Epoch: 4	Loss: 0.228878
test acc on this client after 1638 / 2003 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 3
local mask changes: 2878202.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3165386.0, 3165446.0, 3165538.0, 2878202.0, 3165066.0]
Doing local aggregation!
test acc on this client before 1775 / 2006 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.248959
Client Index = 3	Epoch: 1	Loss: 0.256056
Client Index = 3	Epoch: 2	Loss: 0.245514
Client Index = 3	Epoch: 3	Loss: 0.236659
Client Index = 3	Epoch: 4	Loss: 0.247346
test acc on this client after 1471 / 2006 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 4
local mask changes: 2881126.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3167808.0, 3167478.0, 3167444.0, 3165572.0, 2881126.0]
Doing local aggregation!
test acc on this client before 1751 / 2005 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.242513
Client Index = 4	Epoch: 1	Loss: 0.255793
Client Index = 4	Epoch: 2	Loss: 0.243082
Client Index = 4	Epoch: 3	Loss: 0.236336
Client Index = 4	Epoch: 4	Loss: 0.231781
test acc on this client after 1327 / 2005 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.2430317674729289}
################local_test_on_all_clients after local training in communication round: 12
{'test_acc_after': 0.7680700495341924, 'test_loss_after': 0.8299893246151197}
################local_test_on_all_clients before local training in communication round: 12
{'test_acc_before': 0.8834779578530654, 'test_loss_before': 0.36590665598951533}
################Communication round : 13
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 0
local mask changes: 2866108.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2866108.0, 3139490.0, 3137674.0, 3135780.0, 3137380.0]
Doing local aggregation!
test acc on this client before 1795 / 2005 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.219987
Client Index = 0	Epoch: 1	Loss: 0.224820
Client Index = 0	Epoch: 2	Loss: 0.207765
Client Index = 0	Epoch: 3	Loss: 0.224726
Client Index = 0	Epoch: 4	Loss: 0.206398
test acc on this client after 1604 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 1
local mask changes: 2865364.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3139246.0, 2865364.0, 3137854.0, 3136550.0, 3137412.0]
Doing local aggregation!
test acc on this client before 1766 / 2005 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.215541
Client Index = 1	Epoch: 1	Loss: 0.223825
Client Index = 1	Epoch: 2	Loss: 0.219196
Client Index = 1	Epoch: 3	Loss: 0.211871
Client Index = 1	Epoch: 4	Loss: 0.208013
test acc on this client after 1562 / 2005 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 2
local mask changes: 2869436.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3136766.0, 3138812.0, 2869436.0, 3137756.0, 3138240.0]
Doing local aggregation!
test acc on this client before 1743 / 2003 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.219963
Client Index = 2	Epoch: 1	Loss: 0.227284
Client Index = 2	Epoch: 2	Loss: 0.227355
Client Index = 2	Epoch: 3	Loss: 0.212423
Client Index = 2	Epoch: 4	Loss: 0.212101
test acc on this client after 1714 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 3
local mask changes: 2866036.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3139864.0, 3138538.0, 3136832.0, 2866036.0, 3138702.0]
Doing local aggregation!
test acc on this client before 1761 / 2006 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.227151
Client Index = 3	Epoch: 1	Loss: 0.223683
Client Index = 3	Epoch: 2	Loss: 0.225469
Client Index = 3	Epoch: 3	Loss: 0.225869
Client Index = 3	Epoch: 4	Loss: 0.213875
test acc on this client after 1711 / 2006 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 4
local mask changes: 2865838.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3137596.0, 3137826.0, 3140590.0, 3137396.0, 2865838.0]
Doing local aggregation!
test acc on this client before 1749 / 2005 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.218023
Client Index = 4	Epoch: 1	Loss: 0.221134
Client Index = 4	Epoch: 2	Loss: 0.228876
Client Index = 4	Epoch: 3	Loss: 0.204568
Client Index = 4	Epoch: 4	Loss: 0.228328
test acc on this client after 1640 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.21912979844501432}
################local_test_on_all_clients after local training in communication round: 13
{'test_acc_after': 0.8211330166258607, 'test_loss_after': 0.6197868382158487}
################local_test_on_all_clients before local training in communication round: 13
{'test_acc_before': 0.8792880322209555, 'test_loss_before': 0.3796015630871481}
################Communication round : 14
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 0
local mask changes: 2854018.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2854018.0, 3111830.0, 3110048.0, 3111080.0, 3112478.0]
Doing local aggregation!
test acc on this client before 1795 / 2005 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.188481
Client Index = 0	Epoch: 1	Loss: 0.192003
Client Index = 0	Epoch: 2	Loss: 0.199987
Client Index = 0	Epoch: 3	Loss: 0.192060
Client Index = 0	Epoch: 4	Loss: 0.196199
test acc on this client after 1792 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 1
local mask changes: 2854080.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3112136.0, 2854080.0, 3113036.0, 3113368.0, 3112580.0]
Doing local aggregation!
test acc on this client before 1775 / 2005 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.193646
Client Index = 1	Epoch: 1	Loss: 0.201341
Client Index = 1	Epoch: 2	Loss: 0.186852
Client Index = 1	Epoch: 3	Loss: 0.204536
Client Index = 1	Epoch: 4	Loss: 0.184332
test acc on this client after 1732 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 2
local mask changes: 2852870.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3114160.0, 3114510.0, 2852870.0, 3112414.0, 3112316.0]
Doing local aggregation!
test acc on this client before 1756 / 2003 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.206471
Client Index = 2	Epoch: 1	Loss: 0.205018
Client Index = 2	Epoch: 2	Loss: 0.197205
Client Index = 2	Epoch: 3	Loss: 0.188432
Client Index = 2	Epoch: 4	Loss: 0.191887
test acc on this client after 1550 / 2003 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 3
local mask changes: 2855698.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3112060.0, 3111870.0, 3110012.0, 2855698.0, 3113512.0]
Doing local aggregation!
test acc on this client before 1770 / 2006 : 0.88
Client Index = 3	Epoch: 0	Loss: 0.192537
Client Index = 3	Epoch: 1	Loss: 0.211723
Client Index = 3	Epoch: 2	Loss: 0.212477
Client Index = 3	Epoch: 3	Loss: 0.193847
Client Index = 3	Epoch: 4	Loss: 0.182913
test acc on this client after 1733 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 4
local mask changes: 2854288.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3112648.0, 3113810.0, 3111866.0, 3111852.0, 2854288.0]
Doing local aggregation!
test acc on this client before 1758 / 2005 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.193093
Client Index = 4	Epoch: 1	Loss: 0.202125
Client Index = 4	Epoch: 2	Loss: 0.195012
Client Index = 4	Epoch: 3	Loss: 0.200227
Client Index = 4	Epoch: 4	Loss: 0.191645
test acc on this client after 1611 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.19616200355622843}
################local_test_on_all_clients after local training in communication round: 14
{'test_acc_after': 0.8397689546341249, 'test_loss_after': 0.5416872207584756}
################local_test_on_all_clients before local training in communication round: 14
{'test_acc_before': 0.8832789044392924, 'test_loss_before': 0.37890112314258934}
################Communication round : 15
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 0
local mask changes: 2841678.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2841678.0, 3092034.0, 3088150.0, 3087738.0, 3088990.0]
Doing local aggregation!
test acc on this client before 1822 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.174037
Client Index = 0	Epoch: 1	Loss: 0.177277
Client Index = 0	Epoch: 2	Loss: 0.192133
Client Index = 0	Epoch: 3	Loss: 0.172189
Client Index = 0	Epoch: 4	Loss: 0.183986
test acc on this client after 1668 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 1
local mask changes: 2842424.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3090146.0, 2842424.0, 3088532.0, 3090392.0, 3089308.0]
Doing local aggregation!
test acc on this client before 1786 / 2005 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.174636
Client Index = 1	Epoch: 1	Loss: 0.178992
Client Index = 1	Epoch: 2	Loss: 0.182608
Client Index = 1	Epoch: 3	Loss: 0.170805
Client Index = 1	Epoch: 4	Loss: 0.163703
test acc on this client after 1594 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 2
local mask changes: 2841528.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3089716.0, 3090770.0, 2841528.0, 3085526.0, 3088686.0]
Doing local aggregation!
test acc on this client before 1779 / 2003 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.178952
Client Index = 2	Epoch: 1	Loss: 0.180500
Client Index = 2	Epoch: 2	Loss: 0.192796
Client Index = 2	Epoch: 3	Loss: 0.177586
Client Index = 2	Epoch: 4	Loss: 0.171466
test acc on this client after 1650 / 2003 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 3
local mask changes: 2841840.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3089086.0, 3087064.0, 3085464.0, 2841840.0, 3090870.0]
Doing local aggregation!
test acc on this client before 1794 / 2006 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.171788
Client Index = 3	Epoch: 1	Loss: 0.186887
Client Index = 3	Epoch: 2	Loss: 0.181099
Client Index = 3	Epoch: 3	Loss: 0.177457
Client Index = 3	Epoch: 4	Loss: 0.178830
test acc on this client after 1670 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 4
local mask changes: 2843718.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3090150.0, 3089672.0, 3087710.0, 3089284.0, 2843718.0]
Doing local aggregation!
test acc on this client before 1783 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.178070
Client Index = 4	Epoch: 1	Loss: 0.175797
Client Index = 4	Epoch: 2	Loss: 0.189607
Client Index = 4	Epoch: 3	Loss: 0.179483
Client Index = 4	Epoch: 4	Loss: 0.172863
test acc on this client after 1591 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.17854181389647478}
################local_test_on_all_clients after local training in communication round: 15
{'test_acc_after': 0.8153431447595428, 'test_loss_after': 0.623639682577893}
################local_test_on_all_clients before local training in communication round: 15
{'test_acc_before': 0.8942525704187434, 'test_loss_before': 0.3508482027905614}
################Communication round : 16
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 0
local mask changes: 2825398.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2825398.0, 3066870.0, 3067854.0, 3065874.0, 3067624.0]
Doing local aggregation!
test acc on this client before 1813 / 2005 : 0.90
Client Index = 0	Epoch: 0	Loss: 0.149778
Client Index = 0	Epoch: 1	Loss: 0.174885
Client Index = 0	Epoch: 2	Loss: 0.169268
Client Index = 0	Epoch: 3	Loss: 0.161751
Client Index = 0	Epoch: 4	Loss: 0.153732
test acc on this client after 1456 / 2005 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 1
local mask changes: 2823434.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3067290.0, 2823434.0, 3067430.0, 3065152.0, 3067844.0]
Doing local aggregation!
test acc on this client before 1813 / 2005 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.153282
Client Index = 1	Epoch: 1	Loss: 0.175991
Client Index = 1	Epoch: 2	Loss: 0.152679
Client Index = 1	Epoch: 3	Loss: 0.153560
Client Index = 1	Epoch: 4	Loss: 0.162763
test acc on this client after 1657 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 2
local mask changes: 2826494.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3065920.0, 3065978.0, 2826494.0, 3064590.0, 3066718.0]
Doing local aggregation!
test acc on this client before 1779 / 2003 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.154546
Client Index = 2	Epoch: 1	Loss: 0.175980
Client Index = 2	Epoch: 2	Loss: 0.169283
Client Index = 2	Epoch: 3	Loss: 0.174089
Client Index = 2	Epoch: 4	Loss: 0.158219
test acc on this client after 1706 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 3
local mask changes: 2826228.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3068258.0, 3068462.0, 3066298.0, 2826228.0, 3069128.0]
Doing local aggregation!
test acc on this client before 1803 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.155603
Client Index = 3	Epoch: 1	Loss: 0.175115
Client Index = 3	Epoch: 2	Loss: 0.167733
Client Index = 3	Epoch: 3	Loss: 0.170684
Client Index = 3	Epoch: 4	Loss: 0.151096
test acc on this client after 1711 / 2006 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 4
local mask changes: 2825416.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3065804.0, 3068272.0, 3067790.0, 3066726.0, 2825416.0]
Doing local aggregation!
test acc on this client before 1786 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.151518
Client Index = 4	Epoch: 1	Loss: 0.170874
Client Index = 4	Epoch: 2	Loss: 0.172536
Client Index = 4	Epoch: 3	Loss: 0.160434
Client Index = 4	Epoch: 4	Loss: 0.157616
test acc on this client after 1696 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.16292062220182651}
################local_test_on_all_clients after local training in communication round: 16
{'test_acc_after': 0.8206334666988809, 'test_loss_after': 0.6324711186903412}
################local_test_on_all_clients before local training in communication round: 16
{'test_acc_before': 0.8972446415867854, 'test_loss_before': 0.336490946272605}
################Communication round : 17
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 0
local mask changes: 2811486.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2811486.0, 3046470.0, 3047170.0, 3046592.0, 3047390.0]
Doing local aggregation!
test acc on this client before 1819 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.132934
Client Index = 0	Epoch: 1	Loss: 0.157001
Client Index = 0	Epoch: 2	Loss: 0.143482
Client Index = 0	Epoch: 3	Loss: 0.149279
Client Index = 0	Epoch: 4	Loss: 0.146042
test acc on this client after 1774 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 1
local mask changes: 2811062.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3045208.0, 2811062.0, 3045426.0, 3045072.0, 3043528.0]
Doing local aggregation!
test acc on this client before 1813 / 2005 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.137102
Client Index = 1	Epoch: 1	Loss: 0.150758
Client Index = 1	Epoch: 2	Loss: 0.148275
Client Index = 1	Epoch: 3	Loss: 0.152708
Client Index = 1	Epoch: 4	Loss: 0.129859
test acc on this client after 1649 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 2
local mask changes: 2810284.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3044934.0, 3047452.0, 2810284.0, 3046974.0, 3046412.0]
Doing local aggregation!
test acc on this client before 1786 / 2003 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.148640
Client Index = 2	Epoch: 1	Loss: 0.155803
Client Index = 2	Epoch: 2	Loss: 0.147468
Client Index = 2	Epoch: 3	Loss: 0.166089
Client Index = 2	Epoch: 4	Loss: 0.156421
test acc on this client after 1726 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 3
local mask changes: 2809338.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3045224.0, 3045974.0, 3042874.0, 2809338.0, 3045676.0]
Doing local aggregation!
test acc on this client before 1785 / 2006 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.151719
Client Index = 3	Epoch: 1	Loss: 0.162571
Client Index = 3	Epoch: 2	Loss: 0.156168
Client Index = 3	Epoch: 3	Loss: 0.143378
Client Index = 3	Epoch: 4	Loss: 0.149287
test acc on this client after 1644 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 4
local mask changes: 2810144.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3045716.0, 3047198.0, 3043760.0, 3047104.0, 2810144.0]
Doing local aggregation!
test acc on this client before 1788 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.140089
Client Index = 4	Epoch: 1	Loss: 0.151894
Client Index = 4	Epoch: 2	Loss: 0.157396
Client Index = 4	Epoch: 3	Loss: 0.143919
Client Index = 4	Epoch: 4	Loss: 0.144379
test acc on this client after 1742 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.14890650786953616}
################local_test_on_all_clients after local training in communication round: 17
{'test_acc_after': 0.8514617330176371, 'test_loss_after': 0.515248987995147}
################local_test_on_all_clients before local training in communication round: 17
{'test_acc_before': 0.8969469819954121, 'test_loss_before': 0.3530394781045936}
################Communication round : 18
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 0
local mask changes: 2792508.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2792508.0, 3026064.0, 3023740.0, 3023748.0, 3025370.0]
Doing local aggregation!
test acc on this client before 1833 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.122292
Client Index = 0	Epoch: 1	Loss: 0.152319
Client Index = 0	Epoch: 2	Loss: 0.142537
Client Index = 0	Epoch: 3	Loss: 0.138852
Client Index = 0	Epoch: 4	Loss: 0.142826
test acc on this client after 1710 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 1
local mask changes: 2793664.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3026716.0, 2793664.0, 3027472.0, 3025412.0, 3026798.0]
Doing local aggregation!
test acc on this client before 1821 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.125324
Client Index = 1	Epoch: 1	Loss: 0.154660
Client Index = 1	Epoch: 2	Loss: 0.127553
Client Index = 1	Epoch: 3	Loss: 0.153217
Client Index = 1	Epoch: 4	Loss: 0.135747
test acc on this client after 1748 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 2
local mask changes: 2791974.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3028244.0, 3027064.0, 2791974.0, 3024086.0, 3025502.0]
Doing local aggregation!
test acc on this client before 1798 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.129870
Client Index = 2	Epoch: 1	Loss: 0.146783
Client Index = 2	Epoch: 2	Loss: 0.146738
Client Index = 2	Epoch: 3	Loss: 0.138447
Client Index = 2	Epoch: 4	Loss: 0.138108
test acc on this client after 1603 / 2003 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 3
local mask changes: 2793438.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3026708.0, 3024190.0, 3025462.0, 2793438.0, 3024450.0]
Doing local aggregation!
test acc on this client before 1787 / 2006 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.121882
Client Index = 3	Epoch: 1	Loss: 0.138224
Client Index = 3	Epoch: 2	Loss: 0.159291
Client Index = 3	Epoch: 3	Loss: 0.139231
Client Index = 3	Epoch: 4	Loss: 0.125024
test acc on this client after 1563 / 2006 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 4
local mask changes: 2794978.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3025746.0, 3024956.0, 3026534.0, 3024864.0, 2794978.0]
Doing local aggregation!
test acc on this client before 1794 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.131195
Client Index = 4	Epoch: 1	Loss: 0.142135
Client Index = 4	Epoch: 2	Loss: 0.142019
Client Index = 4	Epoch: 3	Loss: 0.136875
Client Index = 4	Epoch: 4	Loss: 0.139937
test acc on this client after 1672 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.13884344866993475}
################local_test_on_all_clients after local training in communication round: 18
{'test_acc_after': 0.8276131108816843, 'test_loss_after': 0.6217251458728793}
################local_test_on_all_clients before local training in communication round: 18
{'test_acc_before': 0.9011376039423433, 'test_loss_before': 0.3336649767241687}
################Communication round : 19
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 0
local mask changes: 2777138.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2777138.0, 3004828.0, 3005348.0, 3004410.0, 3004444.0]
Doing local aggregation!
test acc on this client before 1821 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.111875
Client Index = 0	Epoch: 1	Loss: 0.135235
Client Index = 0	Epoch: 2	Loss: 0.130672
Client Index = 0	Epoch: 3	Loss: 0.123769
Client Index = 0	Epoch: 4	Loss: 0.127165
test acc on this client after 1753 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 1
local mask changes: 2776540.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3005364.0, 2776540.0, 3004734.0, 3003272.0, 3007334.0]
Doing local aggregation!
test acc on this client before 1816 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.107157
Client Index = 1	Epoch: 1	Loss: 0.142329
Client Index = 1	Epoch: 2	Loss: 0.123697
Client Index = 1	Epoch: 3	Loss: 0.133836
Client Index = 1	Epoch: 4	Loss: 0.119807
test acc on this client after 1675 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 2
local mask changes: 2775782.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3003828.0, 3005386.0, 2775782.0, 3005040.0, 3007104.0]
Doing local aggregation!
test acc on this client before 1790 / 2003 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.107695
Client Index = 2	Epoch: 1	Loss: 0.140620
Client Index = 2	Epoch: 2	Loss: 0.142849
Client Index = 2	Epoch: 3	Loss: 0.130658
Client Index = 2	Epoch: 4	Loss: 0.127776
test acc on this client after 1714 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 3
local mask changes: 2776974.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3005636.0, 3004842.0, 3005534.0, 2776974.0, 3004530.0]
Doing local aggregation!
test acc on this client before 1784 / 2006 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.116345
Client Index = 3	Epoch: 1	Loss: 0.140735
Client Index = 3	Epoch: 2	Loss: 0.140150
Client Index = 3	Epoch: 3	Loss: 0.144664
Client Index = 3	Epoch: 4	Loss: 0.124415
test acc on this client after 1736 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 4
local mask changes: 2774476.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [3006708.0, 3004600.0, 3005494.0, 3006378.0, 2774476.0]
Doing local aggregation!
test acc on this client before 1789 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.109745
Client Index = 4	Epoch: 1	Loss: 0.154493
Client Index = 4	Epoch: 2	Loss: 0.121634
Client Index = 4	Epoch: 3	Loss: 0.134949
Client Index = 4	Epoch: 4	Loss: 0.126312
test acc on this client after 1604 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12874330982869986}
################local_test_on_all_clients after local training in communication round: 19
{'test_acc_after': 0.8461691799563182, 'test_loss_after': 0.5499964049654373}
################local_test_on_all_clients before local training in communication round: 19
{'test_acc_before': 0.8978451857374046, 'test_loss_before': 0.3587538207902303}
################Communication round : 20
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 0
local mask changes: 2758172.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2758172.0, 2984534.0, 2985936.0, 2984766.0, 2987128.0]
Doing local aggregation!
test acc on this client before 1838 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.106154
Client Index = 0	Epoch: 1	Loss: 0.117150
Client Index = 0	Epoch: 2	Loss: 0.120829
Client Index = 0	Epoch: 3	Loss: 0.120312
Client Index = 0	Epoch: 4	Loss: 0.125567
test acc on this client after 1649 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 1
local mask changes: 2758626.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2984862.0, 2758626.0, 2985882.0, 2984488.0, 2984784.0]
Doing local aggregation!
test acc on this client before 1817 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.092219
Client Index = 1	Epoch: 1	Loss: 0.130264
Client Index = 1	Epoch: 2	Loss: 0.119352
Client Index = 1	Epoch: 3	Loss: 0.121417
Client Index = 1	Epoch: 4	Loss: 0.123788
test acc on this client after 1575 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 2
local mask changes: 2757372.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2986420.0, 2988240.0, 2757372.0, 2985110.0, 2985902.0]
Doing local aggregation!
test acc on this client before 1797 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.107585
Client Index = 2	Epoch: 1	Loss: 0.130114
Client Index = 2	Epoch: 2	Loss: 0.127167
Client Index = 2	Epoch: 3	Loss: 0.134769
Client Index = 2	Epoch: 4	Loss: 0.138541
test acc on this client after 1762 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 3
local mask changes: 2758164.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2983906.0, 2985414.0, 2988170.0, 2758164.0, 2987042.0]
Doing local aggregation!
test acc on this client before 1807 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.103150
Client Index = 3	Epoch: 1	Loss: 0.122760
Client Index = 3	Epoch: 2	Loss: 0.135459
Client Index = 3	Epoch: 3	Loss: 0.127087
Client Index = 3	Epoch: 4	Loss: 0.123152
test acc on this client after 1736 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 4
local mask changes: 2757506.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2987044.0, 2985228.0, 2985876.0, 2986488.0, 2757506.0]
Doing local aggregation!
test acc on this client before 1799 / 2005 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.099214
Client Index = 4	Epoch: 1	Loss: 0.115016
Client Index = 4	Epoch: 2	Loss: 0.127928
Client Index = 4	Epoch: 3	Loss: 0.127168
Client Index = 4	Epoch: 4	Loss: 0.116332
test acc on this client after 1727 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.12049977024028799}
################local_test_on_all_clients after local training in communication round: 20
{'test_acc_after': 0.8428821902413894, 'test_loss_after': 0.5736235991039185}
################local_test_on_all_clients before local training in communication round: 20
{'test_acc_before': 0.9036302754044904, 'test_loss_before': 0.33365490058891145}
################Communication round : 21
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 0
local mask changes: 2737756.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2737756.0, 2966938.0, 2968048.0, 2966450.0, 2967172.0]
Doing local aggregation!
test acc on this client before 1822 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.073782
Client Index = 0	Epoch: 1	Loss: 0.116828
Client Index = 0	Epoch: 2	Loss: 0.116050
Client Index = 0	Epoch: 3	Loss: 0.114775
Client Index = 0	Epoch: 4	Loss: 0.113809
test acc on this client after 1779 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 1
local mask changes: 2738298.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2967012.0, 2738298.0, 2967486.0, 2965250.0, 2966202.0]
Doing local aggregation!
test acc on this client before 1815 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.086745
Client Index = 1	Epoch: 1	Loss: 0.114574
Client Index = 1	Epoch: 2	Loss: 0.116096
Client Index = 1	Epoch: 3	Loss: 0.115419
Client Index = 1	Epoch: 4	Loss: 0.116130
test acc on this client after 1670 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 2
local mask changes: 2736376.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2967248.0, 2969634.0, 2736376.0, 2967544.0, 2969318.0]
Doing local aggregation!
test acc on this client before 1799 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.086960
Client Index = 2	Epoch: 1	Loss: 0.124067
Client Index = 2	Epoch: 2	Loss: 0.115589
Client Index = 2	Epoch: 3	Loss: 0.123579
Client Index = 2	Epoch: 4	Loss: 0.112137
test acc on this client after 1540 / 2003 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 3
local mask changes: 2739202.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2964980.0, 2967162.0, 2965858.0, 2739202.0, 2965406.0]
Doing local aggregation!
test acc on this client before 1802 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.082737
Client Index = 3	Epoch: 1	Loss: 0.138924
Client Index = 3	Epoch: 2	Loss: 0.115407
Client Index = 3	Epoch: 3	Loss: 0.122659
Client Index = 3	Epoch: 4	Loss: 0.120032
test acc on this client after 1677 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 4
local mask changes: 2737834.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2968668.0, 2966746.0, 2966508.0, 2965924.0, 2737834.0]
Doing local aggregation!
test acc on this client before 1807 / 2005 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.097090
Client Index = 4	Epoch: 1	Loss: 0.114531
Client Index = 4	Epoch: 2	Loss: 0.111649
Client Index = 4	Epoch: 3	Loss: 0.117056
Client Index = 4	Epoch: 4	Loss: 0.115131
test acc on this client after 1672 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.11127035582172021}
################local_test_on_all_clients after local training in communication round: 21
{'test_acc_after': 0.8317906934100631, 'test_loss_after': 0.6332527188197993}
################local_test_on_all_clients before local training in communication round: 21
{'test_acc_before': 0.9023339651328621, 'test_loss_before': 0.3349794748431116}
################Communication round : 22
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 0
local mask changes: 2718048.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2718048.0, 2946668.0, 2946708.0, 2946076.0, 2948794.0]
Doing local aggregation!
test acc on this client before 1841 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.074508
Client Index = 0	Epoch: 1	Loss: 0.118003
Client Index = 0	Epoch: 2	Loss: 0.101755
Client Index = 0	Epoch: 3	Loss: 0.102027
Client Index = 0	Epoch: 4	Loss: 0.119473
test acc on this client after 1675 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 1
local mask changes: 2717654.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2945086.0, 2717654.0, 2948418.0, 2946602.0, 2947320.0]
Doing local aggregation!
test acc on this client before 1819 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.081609
Client Index = 1	Epoch: 1	Loss: 0.120259
Client Index = 1	Epoch: 2	Loss: 0.111080
Client Index = 1	Epoch: 3	Loss: 0.117715
Client Index = 1	Epoch: 4	Loss: 0.106962
test acc on this client after 1679 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 2
local mask changes: 2717222.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2950206.0, 2950224.0, 2717222.0, 2949064.0, 2947814.0]
Doing local aggregation!
test acc on this client before 1799 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.085747
Client Index = 2	Epoch: 1	Loss: 0.127965
Client Index = 2	Epoch: 2	Loss: 0.104905
Client Index = 2	Epoch: 3	Loss: 0.125238
Client Index = 2	Epoch: 4	Loss: 0.106757
test acc on this client after 1722 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 3
local mask changes: 2719530.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2948464.0, 2948002.0, 2948000.0, 2719530.0, 2948494.0]
Doing local aggregation!
test acc on this client before 1810 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.094310
Client Index = 3	Epoch: 1	Loss: 0.104667
Client Index = 3	Epoch: 2	Loss: 0.127168
Client Index = 3	Epoch: 3	Loss: 0.123961
Client Index = 3	Epoch: 4	Loss: 0.098985
test acc on this client after 1665 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 4
local mask changes: 2716742.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2948634.0, 2950186.0, 2949422.0, 2950158.0, 2716742.0]
Doing local aggregation!
test acc on this client before 1815 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.081781
Client Index = 4	Epoch: 1	Loss: 0.109294
Client Index = 4	Epoch: 2	Loss: 0.114739
Client Index = 4	Epoch: 3	Loss: 0.117323
Client Index = 4	Epoch: 4	Loss: 0.110595
test acc on this client after 1703 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.10747304786908991}
################local_test_on_all_clients after local training in communication round: 22
{'test_acc_after': 0.8423829836307837, 'test_loss_after': 0.5815231657854998}
################local_test_on_all_clients before local training in communication round: 22
{'test_acc_before': 0.90622384163801, 'test_loss_before': 0.3189897926786777}
################Communication round : 23
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 0
local mask changes: 2697810.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2697810.0, 2927612.0, 2929612.0, 2928006.0, 2930852.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.073757
Client Index = 0	Epoch: 1	Loss: 0.118468
Client Index = 0	Epoch: 2	Loss: 0.090065
Client Index = 0	Epoch: 3	Loss: 0.109241
Client Index = 0	Epoch: 4	Loss: 0.100896
test acc on this client after 1591 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 1
local mask changes: 2696166.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2927046.0, 2696166.0, 2931536.0, 2928920.0, 2929782.0]
Doing local aggregation!
test acc on this client before 1831 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.073603
Client Index = 1	Epoch: 1	Loss: 0.118334
Client Index = 1	Epoch: 2	Loss: 0.115247
Client Index = 1	Epoch: 3	Loss: 0.092151
Client Index = 1	Epoch: 4	Loss: 0.112881
test acc on this client after 1723 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 2
local mask changes: 2695678.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2930234.0, 2928878.0, 2695678.0, 2929712.0, 2929676.0]
Doing local aggregation!
test acc on this client before 1811 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.084877
Client Index = 2	Epoch: 1	Loss: 0.124354
Client Index = 2	Epoch: 2	Loss: 0.102752
Client Index = 2	Epoch: 3	Loss: 0.107093
Client Index = 2	Epoch: 4	Loss: 0.114810
test acc on this client after 1415 / 2003 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 3
local mask changes: 2697708.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2929264.0, 2928592.0, 2929738.0, 2697708.0, 2931582.0]
Doing local aggregation!
test acc on this client before 1807 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.075782
Client Index = 3	Epoch: 1	Loss: 0.110334
Client Index = 3	Epoch: 2	Loss: 0.117320
Client Index = 3	Epoch: 3	Loss: 0.111994
Client Index = 3	Epoch: 4	Loss: 0.110237
test acc on this client after 1497 / 2006 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 4
local mask changes: 2696372.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2931274.0, 2930180.0, 2929368.0, 2930576.0, 2696372.0]
Doing local aggregation!
test acc on this client before 1812 / 2005 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.074069
Client Index = 4	Epoch: 1	Loss: 0.125425
Client Index = 4	Epoch: 2	Loss: 0.103250
Client Index = 4	Epoch: 3	Loss: 0.106208
Client Index = 4	Epoch: 4	Loss: 0.120243
test acc on this client after 1651 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.10373560896086298}
################local_test_on_all_clients after local training in communication round: 23
{'test_acc_after': 0.7858021565548758, 'test_loss_after': 0.847434372503413}
################local_test_on_all_clients before local training in communication round: 23
{'test_acc_before': 0.9087189516171043, 'test_loss_before': 0.33010475156379504}
################Communication round : 24
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 0
local mask changes: 2672978.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2672978.0, 2912062.0, 2912654.0, 2911018.0, 2913182.0]
Doing local aggregation!
test acc on this client before 1820 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.069395
Client Index = 0	Epoch: 1	Loss: 0.106751
Client Index = 0	Epoch: 2	Loss: 0.103625
Client Index = 0	Epoch: 3	Loss: 0.126656
Client Index = 0	Epoch: 4	Loss: 0.088926
test acc on this client after 1677 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 1
local mask changes: 2676722.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2910876.0, 2676722.0, 2911826.0, 2913516.0, 2914012.0]
Doing local aggregation!
test acc on this client before 1799 / 2005 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.073251
Client Index = 1	Epoch: 1	Loss: 0.093080
Client Index = 1	Epoch: 2	Loss: 0.094414
Client Index = 1	Epoch: 3	Loss: 0.124278
Client Index = 1	Epoch: 4	Loss: 0.099690
test acc on this client after 1744 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 2
local mask changes: 2673284.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2915046.0, 2912162.0, 2673284.0, 2912766.0, 2914732.0]
Doing local aggregation!
test acc on this client before 1783 / 2003 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.075049
Client Index = 2	Epoch: 1	Loss: 0.120604
Client Index = 2	Epoch: 2	Loss: 0.098104
Client Index = 2	Epoch: 3	Loss: 0.108755
Client Index = 2	Epoch: 4	Loss: 0.094107
test acc on this client after 1744 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 3
local mask changes: 2672798.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2911640.0, 2913238.0, 2913638.0, 2672798.0, 2914892.0]
Doing local aggregation!
test acc on this client before 1788 / 2006 : 0.89
Client Index = 3	Epoch: 0	Loss: 0.060936
Client Index = 3	Epoch: 1	Loss: 0.104956
Client Index = 3	Epoch: 2	Loss: 0.108682
Client Index = 3	Epoch: 3	Loss: 0.114424
Client Index = 3	Epoch: 4	Loss: 0.101926
test acc on this client after 1729 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 4
local mask changes: 2674240.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2913552.0, 2911686.0, 2914996.0, 2913862.0, 2674240.0]
Doing local aggregation!
test acc on this client before 1786 / 2005 : 0.89
Client Index = 4	Epoch: 0	Loss: 0.071341
Client Index = 4	Epoch: 1	Loss: 0.098636
Client Index = 4	Epoch: 2	Loss: 0.109835
Client Index = 4	Epoch: 3	Loss: 0.105428
Client Index = 4	Epoch: 4	Loss: 0.093927
test acc on this client after 1769 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.09787107431272767}
################local_test_on_all_clients after local training in communication round: 24
{'test_acc_after': 0.8642273789187925, 'test_loss_after': 0.48840726456775563}
################local_test_on_all_clients before local training in communication round: 24
{'test_acc_before': 0.8954502746617263, 'test_loss_before': 0.37964851724613047}
################Communication round : 25
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 0
local mask changes: 2649256.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2649256.0, 2894442.0, 2898480.0, 2896882.0, 2894952.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.071154
Client Index = 0	Epoch: 1	Loss: 0.113701
Client Index = 0	Epoch: 2	Loss: 0.090859
Client Index = 0	Epoch: 3	Loss: 0.090884
Client Index = 0	Epoch: 4	Loss: 0.104957
test acc on this client after 1750 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 1
local mask changes: 2650010.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2893208.0, 2650010.0, 2895114.0, 2895638.0, 2896036.0]
Doing local aggregation!
test acc on this client before 1830 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.055726
Client Index = 1	Epoch: 1	Loss: 0.099694
Client Index = 1	Epoch: 2	Loss: 0.098234
Client Index = 1	Epoch: 3	Loss: 0.103972
Client Index = 1	Epoch: 4	Loss: 0.098396
test acc on this client after 1753 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 2
local mask changes: 2649644.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2894402.0, 2895806.0, 2649644.0, 2895004.0, 2894338.0]
Doing local aggregation!
test acc on this client before 1800 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.059252
Client Index = 2	Epoch: 1	Loss: 0.102917
Client Index = 2	Epoch: 2	Loss: 0.098485
Client Index = 2	Epoch: 3	Loss: 0.114521
Client Index = 2	Epoch: 4	Loss: 0.095870
test acc on this client after 1722 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 3
local mask changes: 2650010.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2895540.0, 2896546.0, 2894796.0, 2650010.0, 2897970.0]
Doing local aggregation!
test acc on this client before 1814 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.062161
Client Index = 3	Epoch: 1	Loss: 0.089005
Client Index = 3	Epoch: 2	Loss: 0.106189
Client Index = 3	Epoch: 3	Loss: 0.105017
Client Index = 3	Epoch: 4	Loss: 0.100382
test acc on this client after 1761 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 4
local mask changes: 2649910.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2896028.0, 2894452.0, 2896580.0, 2897198.0, 2649910.0]
Doing local aggregation!
test acc on this client before 1820 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.058291
Client Index = 4	Epoch: 1	Loss: 0.094262
Client Index = 4	Epoch: 2	Loss: 0.117858
Client Index = 4	Epoch: 3	Loss: 0.093301
Client Index = 4	Epoch: 4	Loss: 0.114056
test acc on this client after 1587 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.09356575950690336}
################local_test_on_all_clients after local training in communication round: 25
{'test_acc_after': 0.8552460403459252, 'test_loss_after': 0.5249804580737255}
################local_test_on_all_clients before local training in communication round: 25
{'test_acc_before': 0.9085180066738504, 'test_loss_before': 0.3167598762448406}
################Communication round : 26
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 0
local mask changes: 2628230.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2628230.0, 2874538.0, 2875294.0, 2878392.0, 2877110.0]
Doing local aggregation!
test acc on this client before 1845 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.056096
Client Index = 0	Epoch: 1	Loss: 0.088186
Client Index = 0	Epoch: 2	Loss: 0.115580
Client Index = 0	Epoch: 3	Loss: 0.106466
Client Index = 0	Epoch: 4	Loss: 0.092251
test acc on this client after 1796 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 1
local mask changes: 2625826.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2879150.0, 2625826.0, 2877564.0, 2879818.0, 2877708.0]
Doing local aggregation!
test acc on this client before 1845 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.056771
Client Index = 1	Epoch: 1	Loss: 0.093186
Client Index = 1	Epoch: 2	Loss: 0.081557
Client Index = 1	Epoch: 3	Loss: 0.126656
Client Index = 1	Epoch: 4	Loss: 0.090098
test acc on this client after 1590 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 2
local mask changes: 2628110.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2878082.0, 2875988.0, 2628110.0, 2878634.0, 2878194.0]
Doing local aggregation!
test acc on this client before 1809 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.067638
Client Index = 2	Epoch: 1	Loss: 0.085248
Client Index = 2	Epoch: 2	Loss: 0.091206
Client Index = 2	Epoch: 3	Loss: 0.111955
Client Index = 2	Epoch: 4	Loss: 0.105262
test acc on this client after 1406 / 2003 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 3
local mask changes: 2626650.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2876822.0, 2878816.0, 2879416.0, 2626650.0, 2878074.0]
Doing local aggregation!
test acc on this client before 1813 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.047054
Client Index = 3	Epoch: 1	Loss: 0.092757
Client Index = 3	Epoch: 2	Loss: 0.104121
Client Index = 3	Epoch: 3	Loss: 0.093361
Client Index = 3	Epoch: 4	Loss: 0.111779
test acc on this client after 1773 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 4
local mask changes: 2626546.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2879772.0, 2879464.0, 2877992.0, 2878562.0, 2626546.0]
Doing local aggregation!
test acc on this client before 1820 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.046897
Client Index = 4	Epoch: 1	Loss: 0.101910
Client Index = 4	Epoch: 2	Loss: 0.103448
Client Index = 4	Epoch: 3	Loss: 0.104052
Client Index = 4	Epoch: 4	Loss: 0.094883
test acc on this client after 1696 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.09073671252476243}
################local_test_on_all_clients after local training in communication round: 26
{'test_acc_after': 0.8240917751325811, 'test_loss_after': 0.691087581007032}
################local_test_on_all_clients before local training in communication round: 26
{'test_acc_before': 0.911012718397013, 'test_loss_before': 0.3221487444677194}
################Communication round : 27
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 0
local mask changes: 2600974.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2600974.0, 2859366.0, 2860522.0, 2859070.0, 2860898.0]
Doing local aggregation!
test acc on this client before 1849 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.045731
Client Index = 0	Epoch: 1	Loss: 0.093565
Client Index = 0	Epoch: 2	Loss: 0.106354
Client Index = 0	Epoch: 3	Loss: 0.099804
Client Index = 0	Epoch: 4	Loss: 0.098243
test acc on this client after 1599 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 1
local mask changes: 2601032.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2860486.0, 2601032.0, 2859298.0, 2860552.0, 2862070.0]
Doing local aggregation!
test acc on this client before 1828 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.046936
Client Index = 1	Epoch: 1	Loss: 0.107313
Client Index = 1	Epoch: 2	Loss: 0.079113
Client Index = 1	Epoch: 3	Loss: 0.103445
Client Index = 1	Epoch: 4	Loss: 0.103197
test acc on this client after 1746 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 2
local mask changes: 2601424.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2862380.0, 2861858.0, 2601424.0, 2862080.0, 2861808.0]
Doing local aggregation!
test acc on this client before 1816 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.058563
Client Index = 2	Epoch: 1	Loss: 0.090132
Client Index = 2	Epoch: 2	Loss: 0.084771
Client Index = 2	Epoch: 3	Loss: 0.112905
Client Index = 2	Epoch: 4	Loss: 0.102053
test acc on this client after 1755 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 3
local mask changes: 2600496.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2862808.0, 2861722.0, 2862822.0, 2600496.0, 2863816.0]
Doing local aggregation!
test acc on this client before 1812 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.045685
Client Index = 3	Epoch: 1	Loss: 0.097388
Client Index = 3	Epoch: 2	Loss: 0.103684
Client Index = 3	Epoch: 3	Loss: 0.112477
Client Index = 3	Epoch: 4	Loss: 0.103710
test acc on this client after 1440 / 2006 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 4
local mask changes: 2600462.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2861722.0, 2863990.0, 2861546.0, 2863208.0, 2600462.0]
Doing local aggregation!
test acc on this client before 1839 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.047152
Client Index = 4	Epoch: 1	Loss: 0.100142
Client Index = 4	Epoch: 2	Loss: 0.097011
Client Index = 4	Epoch: 3	Loss: 0.108674
Client Index = 4	Epoch: 4	Loss: 0.093322
test acc on this client after 1706 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.08965487210360375}
################local_test_on_all_clients after local training in communication round: 27
{'test_acc_after': 0.8226468354096974, 'test_loss_after': 0.7062301458911605}
################local_test_on_all_clients before local training in communication round: 27
{'test_acc_before': 0.9122104728129944, 'test_loss_before': 0.3138713207553117}
################Communication round : 28
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 0
local mask changes: 2577122.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2577122.0, 2845176.0, 2846324.0, 2844376.0, 2847028.0]
Doing local aggregation!
test acc on this client before 1835 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.042867
Client Index = 0	Epoch: 1	Loss: 0.111025
Client Index = 0	Epoch: 2	Loss: 0.103762
Client Index = 0	Epoch: 3	Loss: 0.092153
Client Index = 0	Epoch: 4	Loss: 0.091578
test acc on this client after 1539 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 1
local mask changes: 2574730.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2841018.0, 2574730.0, 2845092.0, 2845980.0, 2846148.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.040325
Client Index = 1	Epoch: 1	Loss: 0.078430
Client Index = 1	Epoch: 2	Loss: 0.108475
Client Index = 1	Epoch: 3	Loss: 0.084604
Client Index = 1	Epoch: 4	Loss: 0.103315
test acc on this client after 1480 / 2005 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 2
local mask changes: 2573712.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2844202.0, 2845756.0, 2573712.0, 2845166.0, 2846684.0]
Doing local aggregation!
test acc on this client before 1812 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.040392
Client Index = 2	Epoch: 1	Loss: 0.090375
Client Index = 2	Epoch: 2	Loss: 0.088991
Client Index = 2	Epoch: 3	Loss: 0.110152
Client Index = 2	Epoch: 4	Loss: 0.103323
test acc on this client after 1690 / 2003 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 3
local mask changes: 2575378.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2847222.0, 2846852.0, 2847632.0, 2575378.0, 2846048.0]
Doing local aggregation!
test acc on this client before 1801 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.034134
Client Index = 3	Epoch: 1	Loss: 0.096029
Client Index = 3	Epoch: 2	Loss: 0.094160
Client Index = 3	Epoch: 3	Loss: 0.106208
Client Index = 3	Epoch: 4	Loss: 0.088636
test acc on this client after 1679 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 4
local mask changes: 2576610.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2847514.0, 2845852.0, 2847122.0, 2845658.0, 2576610.0]
Doing local aggregation!
test acc on this client before 1818 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.054074
Client Index = 4	Epoch: 1	Loss: 0.080069
Client Index = 4	Epoch: 2	Loss: 0.092228
Client Index = 4	Epoch: 3	Loss: 0.103668
Client Index = 4	Epoch: 4	Loss: 0.095580
test acc on this client after 1770 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.08538218940855288}
################local_test_on_all_clients after local training in communication round: 28
{'test_acc_after': 0.8138504219215864, 'test_loss_after': 0.7290841146055105}
################local_test_on_all_clients before local training in communication round: 28
{'test_acc_before': 0.9086195989516842, 'test_loss_before': 0.3310907668236283}
################Communication round : 29
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 0
local mask changes: 2549100.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2549100.0, 2829066.0, 2830492.0, 2829468.0, 2831020.0]
Doing local aggregation!
test acc on this client before 1829 / 2005 : 0.91
Client Index = 0	Epoch: 0	Loss: 0.047117
Client Index = 0	Epoch: 1	Loss: 0.084564
Client Index = 0	Epoch: 2	Loss: 0.084038
Client Index = 0	Epoch: 3	Loss: 0.106486
Client Index = 0	Epoch: 4	Loss: 0.093238
test acc on this client after 1607 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 1
local mask changes: 2547936.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2827994.0, 2547936.0, 2829292.0, 2829156.0, 2828848.0]
Doing local aggregation!
test acc on this client before 1835 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.035739
Client Index = 1	Epoch: 1	Loss: 0.085692
Client Index = 1	Epoch: 2	Loss: 0.096776
Client Index = 1	Epoch: 3	Loss: 0.089663
Client Index = 1	Epoch: 4	Loss: 0.084617
test acc on this client after 1738 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 2
local mask changes: 2546730.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2830918.0, 2830208.0, 2546730.0, 2830612.0, 2832154.0]
Doing local aggregation!
test acc on this client before 1804 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.038934
Client Index = 2	Epoch: 1	Loss: 0.082666
Client Index = 2	Epoch: 2	Loss: 0.090708
Client Index = 2	Epoch: 3	Loss: 0.103699
Client Index = 2	Epoch: 4	Loss: 0.088492
test acc on this client after 1628 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 3
local mask changes: 2548640.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2829468.0, 2828510.0, 2830010.0, 2548640.0, 2832332.0]
Doing local aggregation!
test acc on this client before 1801 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.032670
Client Index = 3	Epoch: 1	Loss: 0.103091
Client Index = 3	Epoch: 2	Loss: 0.097454
Client Index = 3	Epoch: 3	Loss: 0.097119
Client Index = 3	Epoch: 4	Loss: 0.096706
test acc on this client after 1750 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 4
local mask changes: 2547946.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2829518.0, 2829650.0, 2830794.0, 2832216.0, 2547946.0]
Doing local aggregation!
test acc on this client before 1797 / 2005 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.044051
Client Index = 4	Epoch: 1	Loss: 0.093376
Client Index = 4	Epoch: 2	Loss: 0.085627
Client Index = 4	Epoch: 3	Loss: 0.104185
Client Index = 4	Epoch: 4	Loss: 0.091483
test acc on this client after 1715 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.08232762326871293}
################local_test_on_all_clients after local training in communication round: 29
{'test_acc_after': 0.8417708906539719, 'test_loss_after': 0.592926880831492}
################local_test_on_all_clients before local training in communication round: 29
{'test_acc_before': 0.9044292759573725, 'test_loss_before': 0.3363466177232158}
################Communication round : 30
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 0
local mask changes: 2520798.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2520798.0, 2813944.0, 2816162.0, 2812524.0, 2813966.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.035788
Client Index = 0	Epoch: 1	Loss: 0.082843
Client Index = 0	Epoch: 2	Loss: 0.094092
Client Index = 0	Epoch: 3	Loss: 0.099987
Client Index = 0	Epoch: 4	Loss: 0.085816
test acc on this client after 1682 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 1
local mask changes: 2519722.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2811086.0, 2519722.0, 2811000.0, 2813142.0, 2812288.0]
Doing local aggregation!
test acc on this client before 1831 / 2005 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.037480
Client Index = 1	Epoch: 1	Loss: 0.084956
Client Index = 1	Epoch: 2	Loss: 0.090313
Client Index = 1	Epoch: 3	Loss: 0.113439
Client Index = 1	Epoch: 4	Loss: 0.081119
test acc on this client after 1721 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 2
local mask changes: 2519902.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2811642.0, 2811024.0, 2519902.0, 2813352.0, 2813330.0]
Doing local aggregation!
test acc on this client before 1807 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.048866
Client Index = 2	Epoch: 1	Loss: 0.096603
Client Index = 2	Epoch: 2	Loss: 0.082212
Client Index = 2	Epoch: 3	Loss: 0.106300
Client Index = 2	Epoch: 4	Loss: 0.097465
test acc on this client after 1666 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 3
local mask changes: 2521340.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2813422.0, 2812878.0, 2815420.0, 2521340.0, 2814332.0]
Doing local aggregation!
test acc on this client before 1815 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.041799
Client Index = 3	Epoch: 1	Loss: 0.090474
Client Index = 3	Epoch: 2	Loss: 0.107974
Client Index = 3	Epoch: 3	Loss: 0.088000
Client Index = 3	Epoch: 4	Loss: 0.086137
test acc on this client after 1761 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 4
local mask changes: 2519106.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2813592.0, 2814298.0, 2814850.0, 2813916.0, 2519106.0]
Doing local aggregation!
test acc on this client before 1813 / 2005 : 0.90
Client Index = 4	Epoch: 0	Loss: 0.034171
Client Index = 4	Epoch: 1	Loss: 0.094429
Client Index = 4	Epoch: 2	Loss: 0.099056
Client Index = 4	Epoch: 3	Loss: 0.105554
Client Index = 4	Epoch: 4	Loss: 0.092439
test acc on this client after 1705 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0830924445121283}
################local_test_on_all_clients after local training in communication round: 30
{'test_acc_after': 0.851449938986742, 'test_loss_after': 0.5684702942617166}
################local_test_on_all_clients before local training in communication round: 30
{'test_acc_before': 0.9094164097672408, 'test_loss_before': 0.3238778087604594}
################Communication round : 31
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 0
local mask changes: 2491612.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2491612.0, 2795094.0, 2794778.0, 2795758.0, 2797368.0]
Doing local aggregation!
test acc on this client before 1860 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.035642
Client Index = 0	Epoch: 1	Loss: 0.089731
Client Index = 0	Epoch: 2	Loss: 0.075277
Client Index = 0	Epoch: 3	Loss: 0.098462
Client Index = 0	Epoch: 4	Loss: 0.109630
test acc on this client after 1746 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 1
local mask changes: 2491784.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2795122.0, 2491784.0, 2795032.0, 2795748.0, 2795258.0]
Doing local aggregation!
test acc on this client before 1847 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.031671
Client Index = 1	Epoch: 1	Loss: 0.080584
Client Index = 1	Epoch: 2	Loss: 0.108562
Client Index = 1	Epoch: 3	Loss: 0.085242
Client Index = 1	Epoch: 4	Loss: 0.089042
test acc on this client after 1789 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 2
local mask changes: 2491160.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2800160.0, 2796396.0, 2491160.0, 2796708.0, 2798090.0]
Doing local aggregation!
test acc on this client before 1818 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.030357
Client Index = 2	Epoch: 1	Loss: 0.093131
Client Index = 2	Epoch: 2	Loss: 0.093030
Client Index = 2	Epoch: 3	Loss: 0.093216
Client Index = 2	Epoch: 4	Loss: 0.095716
test acc on this client after 1713 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 3
local mask changes: 2490964.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2796632.0, 2796482.0, 2796196.0, 2490964.0, 2799150.0]
Doing local aggregation!
test acc on this client before 1825 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.025607
Client Index = 3	Epoch: 1	Loss: 0.099777
Client Index = 3	Epoch: 2	Loss: 0.098206
Client Index = 3	Epoch: 3	Loss: 0.090825
Client Index = 3	Epoch: 4	Loss: 0.100174
test acc on this client after 1681 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 4
local mask changes: 2492074.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2798772.0, 2796578.0, 2796562.0, 2797672.0, 2492074.0]
Doing local aggregation!
test acc on this client before 1824 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.031482
Client Index = 4	Epoch: 1	Loss: 0.081216
Client Index = 4	Epoch: 2	Loss: 0.089420
Client Index = 4	Epoch: 3	Loss: 0.109277
Client Index = 4	Epoch: 4	Loss: 0.082599
test acc on this client after 1491 / 2005 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.08071512018862578}
################local_test_on_all_clients after local training in communication round: 31
{'test_acc_after': 0.8399872766390626, 'test_loss_after': 0.6217326088311484}
################local_test_on_all_clients before local training in communication round: 31
{'test_acc_before': 0.9152025442789464, 'test_loss_before': 0.314515659699453}
################Communication round : 32
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 0
local mask changes: 2461314.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2461314.0, 2777250.0, 2779024.0, 2778422.0, 2778200.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.034802
Client Index = 0	Epoch: 1	Loss: 0.088581
Client Index = 0	Epoch: 2	Loss: 0.088074
Client Index = 0	Epoch: 3	Loss: 0.095368
Client Index = 0	Epoch: 4	Loss: 0.087866
test acc on this client after 1598 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 1
local mask changes: 2461890.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2778946.0, 2461890.0, 2778646.0, 2778972.0, 2780304.0]
Doing local aggregation!
test acc on this client before 1838 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.033012
Client Index = 1	Epoch: 1	Loss: 0.076473
Client Index = 1	Epoch: 2	Loss: 0.084938
Client Index = 1	Epoch: 3	Loss: 0.089844
Client Index = 1	Epoch: 4	Loss: 0.087717
test acc on this client after 1696 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 2
local mask changes: 2460946.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2781902.0, 2782728.0, 2460946.0, 2780804.0, 2782054.0]
Doing local aggregation!
test acc on this client before 1810 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.039237
Client Index = 2	Epoch: 1	Loss: 0.102331
Client Index = 2	Epoch: 2	Loss: 0.084237
Client Index = 2	Epoch: 3	Loss: 0.088615
Client Index = 2	Epoch: 4	Loss: 0.097570
test acc on this client after 1632 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 3
local mask changes: 2460194.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2783048.0, 2781452.0, 2782174.0, 2460194.0, 2784008.0]
Doing local aggregation!
test acc on this client before 1804 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.026011
Client Index = 3	Epoch: 1	Loss: 0.084800
Client Index = 3	Epoch: 2	Loss: 0.094845
Client Index = 3	Epoch: 3	Loss: 0.089407
Client Index = 3	Epoch: 4	Loss: 0.086366
test acc on this client after 1641 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 4
local mask changes: 2462658.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2782928.0, 2783204.0, 2781096.0, 2782440.0, 2462658.0]
Doing local aggregation!
test acc on this client before 1815 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.036342
Client Index = 4	Epoch: 1	Loss: 0.109031
Client Index = 4	Epoch: 2	Loss: 0.080772
Client Index = 4	Epoch: 3	Loss: 0.094580
Client Index = 4	Epoch: 4	Loss: 0.107513
test acc on this client after 1780 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0795332067186602}
################local_test_on_all_clients after local training in communication round: 32
{'test_acc_after': 0.8326994024742232, 'test_loss_after': 0.6295284229687728}
################local_test_on_all_clients before local training in communication round: 32
{'test_acc_before': 0.9093175049349309, 'test_loss_before': 0.33870997548651144}
################Communication round : 33
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 0
local mask changes: 2430774.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2430774.0, 2761182.0, 2762148.0, 2764970.0, 2765362.0]
Doing local aggregation!
test acc on this client before 1846 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.033137
Client Index = 0	Epoch: 1	Loss: 0.078053
Client Index = 0	Epoch: 2	Loss: 0.101294
Client Index = 0	Epoch: 3	Loss: 0.089675
Client Index = 0	Epoch: 4	Loss: 0.105595
test acc on this client after 1824 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 1
local mask changes: 2431640.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2760922.0, 2431640.0, 2762738.0, 2761152.0, 2761228.0]
Doing local aggregation!
test acc on this client before 1839 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.028184
Client Index = 1	Epoch: 1	Loss: 0.087685
Client Index = 1	Epoch: 2	Loss: 0.099429
Client Index = 1	Epoch: 3	Loss: 0.095101
Client Index = 1	Epoch: 4	Loss: 0.075869
test acc on this client after 1812 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 2
local mask changes: 2432018.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2763012.0, 2764760.0, 2432018.0, 2765202.0, 2766816.0]
Doing local aggregation!
test acc on this client before 1806 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.024358
Client Index = 2	Epoch: 1	Loss: 0.090847
Client Index = 2	Epoch: 2	Loss: 0.112434
Client Index = 2	Epoch: 3	Loss: 0.078901
Client Index = 2	Epoch: 4	Loss: 0.093615
test acc on this client after 1665 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 3
local mask changes: 2430338.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2762612.0, 2765852.0, 2765062.0, 2430338.0, 2766340.0]
Doing local aggregation!
test acc on this client before 1805 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.031996
Client Index = 3	Epoch: 1	Loss: 0.086435
Client Index = 3	Epoch: 2	Loss: 0.084687
Client Index = 3	Epoch: 3	Loss: 0.100493
Client Index = 3	Epoch: 4	Loss: 0.087143
test acc on this client after 1548 / 2006 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 4
local mask changes: 2429936.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2764066.0, 2764152.0, 2766664.0, 2766884.0, 2429936.0]
Doing local aggregation!
test acc on this client before 1822 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.024656
Client Index = 4	Epoch: 1	Loss: 0.086002
Client Index = 4	Epoch: 2	Loss: 0.091189
Client Index = 4	Epoch: 3	Loss: 0.108857
Client Index = 4	Epoch: 4	Loss: 0.096438
test acc on this client after 1686 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0796829055899241}
################local_test_on_all_clients after local training in communication round: 33
{'test_acc_after': 0.8514604310519177, 'test_loss_after': 0.5646895520176829}
################local_test_on_all_clients before local training in communication round: 33
{'test_acc_before': 0.9096163086742353, 'test_loss_before': 0.3149243706033896}
################Communication round : 34
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 0
local mask changes: 2400164.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2400164.0, 2743712.0, 2748462.0, 2746200.0, 2748696.0]
Doing local aggregation!
test acc on this client before 1846 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.022257
Client Index = 0	Epoch: 1	Loss: 0.068525
Client Index = 0	Epoch: 2	Loss: 0.102394
Client Index = 0	Epoch: 3	Loss: 0.080048
Client Index = 0	Epoch: 4	Loss: 0.074578
test acc on this client after 1808 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 1
local mask changes: 2400164.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2741624.0, 2400164.0, 2744910.0, 2744438.0, 2747086.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.024398
Client Index = 1	Epoch: 1	Loss: 0.070475
Client Index = 1	Epoch: 2	Loss: 0.083625
Client Index = 1	Epoch: 3	Loss: 0.095850
Client Index = 1	Epoch: 4	Loss: 0.098497
test acc on this client after 1820 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 2
local mask changes: 2399446.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2748198.0, 2748852.0, 2399446.0, 2749226.0, 2749754.0]
Doing local aggregation!
test acc on this client before 1806 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.021509
Client Index = 2	Epoch: 1	Loss: 0.086988
Client Index = 2	Epoch: 2	Loss: 0.080636
Client Index = 2	Epoch: 3	Loss: 0.100445
Client Index = 2	Epoch: 4	Loss: 0.090800
test acc on this client after 1725 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 3
local mask changes: 2399026.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2747204.0, 2745490.0, 2747626.0, 2399026.0, 2747804.0]
Doing local aggregation!
test acc on this client before 1816 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.030700
Client Index = 3	Epoch: 1	Loss: 0.081547
Client Index = 3	Epoch: 2	Loss: 0.075268
Client Index = 3	Epoch: 3	Loss: 0.105360
Client Index = 3	Epoch: 4	Loss: 0.078105
test acc on this client after 1750 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 4
local mask changes: 2400674.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2749598.0, 2748332.0, 2750878.0, 2750826.0, 2400674.0]
Doing local aggregation!
test acc on this client before 1816 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.024305
Client Index = 4	Epoch: 1	Loss: 0.089554
Client Index = 4	Epoch: 2	Loss: 0.082306
Client Index = 4	Epoch: 3	Loss: 0.083523
Client Index = 4	Epoch: 4	Loss: 0.090230
test acc on this client after 1690 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07367704562719304}
################local_test_on_all_clients after local training in communication round: 34
{'test_acc_after': 0.8771920232941636, 'test_loss_after': 0.4607007808179434}
################local_test_on_all_clients before local training in communication round: 34
{'test_acc_before': 0.9112117716618311, 'test_loss_before': 0.3209844237034596}
################Communication round : 35
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 0
local mask changes: 2368484.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2368484.0, 2724678.0, 2727930.0, 2727014.0, 2730238.0]
Doing local aggregation!
test acc on this client before 1859 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.019343
Client Index = 0	Epoch: 1	Loss: 0.072897
Client Index = 0	Epoch: 2	Loss: 0.078657
Client Index = 0	Epoch: 3	Loss: 0.096193
Client Index = 0	Epoch: 4	Loss: 0.083429
test acc on this client after 1723 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 1
local mask changes: 2367038.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2729564.0, 2367038.0, 2730042.0, 2726842.0, 2728748.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.024403
Client Index = 1	Epoch: 1	Loss: 0.077418
Client Index = 1	Epoch: 2	Loss: 0.096608
Client Index = 1	Epoch: 3	Loss: 0.078954
Client Index = 1	Epoch: 4	Loss: 0.097375
test acc on this client after 1627 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 2
local mask changes: 2365696.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2728246.0, 2728494.0, 2365696.0, 2730584.0, 2732284.0]
Doing local aggregation!
test acc on this client before 1824 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.029194
Client Index = 2	Epoch: 1	Loss: 0.068344
Client Index = 2	Epoch: 2	Loss: 0.093098
Client Index = 2	Epoch: 3	Loss: 0.091924
Client Index = 2	Epoch: 4	Loss: 0.095659
test acc on this client after 1709 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 3
local mask changes: 2367614.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2726852.0, 2725602.0, 2728216.0, 2367614.0, 2729986.0]
Doing local aggregation!
test acc on this client before 1827 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.039372
Client Index = 3	Epoch: 1	Loss: 0.065185
Client Index = 3	Epoch: 2	Loss: 0.084382
Client Index = 3	Epoch: 3	Loss: 0.100367
Client Index = 3	Epoch: 4	Loss: 0.094106
test acc on this client after 1754 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 4
local mask changes: 2366816.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2730200.0, 2728118.0, 2732006.0, 2730922.0, 2366816.0]
Doing local aggregation!
test acc on this client before 1834 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.028206
Client Index = 4	Epoch: 1	Loss: 0.079513
Client Index = 4	Epoch: 2	Loss: 0.085875
Client Index = 4	Epoch: 3	Loss: 0.089596
Client Index = 4	Epoch: 4	Loss: 0.097364
test acc on this client after 1778 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07469843531645151}
################local_test_on_all_clients after local training in communication round: 35
{'test_acc_after': 0.8570406048349227, 'test_loss_after': 0.54545514341303}
################local_test_on_all_clients before local training in communication round: 35
{'test_acc_before': 0.9169985536559544, 'test_loss_before': 0.30472339620392397}
################Communication round : 36
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 0
local mask changes: 2335614.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2335614.0, 2706284.0, 2707934.0, 2707484.0, 2709744.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.018285
Client Index = 0	Epoch: 1	Loss: 0.063879
Client Index = 0	Epoch: 2	Loss: 0.086380
Client Index = 0	Epoch: 3	Loss: 0.084239
Client Index = 0	Epoch: 4	Loss: 0.090079
test acc on this client after 1824 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 1
local mask changes: 2333526.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2710232.0, 2333526.0, 2709330.0, 2709574.0, 2709470.0]
Doing local aggregation!
test acc on this client before 1839 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.016830
Client Index = 1	Epoch: 1	Loss: 0.070749
Client Index = 1	Epoch: 2	Loss: 0.075242
Client Index = 1	Epoch: 3	Loss: 0.114939
Client Index = 1	Epoch: 4	Loss: 0.098472
test acc on this client after 1736 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 2
local mask changes: 2334708.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2713408.0, 2715476.0, 2334708.0, 2711264.0, 2715374.0]
Doing local aggregation!
test acc on this client before 1811 / 2003 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.015967
Client Index = 2	Epoch: 1	Loss: 0.066644
Client Index = 2	Epoch: 2	Loss: 0.091225
Client Index = 2	Epoch: 3	Loss: 0.083130
Client Index = 2	Epoch: 4	Loss: 0.110586
test acc on this client after 1748 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 3
local mask changes: 2333670.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2712288.0, 2710166.0, 2711234.0, 2333670.0, 2712598.0]
Doing local aggregation!
test acc on this client before 1822 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.014840
Client Index = 3	Epoch: 1	Loss: 0.064198
Client Index = 3	Epoch: 2	Loss: 0.091808
Client Index = 3	Epoch: 3	Loss: 0.087156
Client Index = 3	Epoch: 4	Loss: 0.094109
test acc on this client after 1776 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 4
local mask changes: 2333126.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2711338.0, 2712160.0, 2711648.0, 2712280.0, 2333126.0]
Doing local aggregation!
test acc on this client before 1819 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.021434
Client Index = 4	Epoch: 1	Loss: 0.090384
Client Index = 4	Epoch: 2	Loss: 0.085687
Client Index = 4	Epoch: 3	Loss: 0.079298
Client Index = 4	Epoch: 4	Loss: 0.089858
test acc on this client after 1417 / 2005 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07221676094695088}
################local_test_on_all_clients after local training in communication round: 36
{'test_acc_after': 0.8480658391979066, 'test_loss_after': 0.5885976017136748}
################local_test_on_all_clients before local training in communication round: 36
{'test_acc_before': 0.9131072331565256, 'test_loss_before': 0.3051348377884152}
################Communication round : 37
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 0
local mask changes: 2299188.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2299188.0, 2689576.0, 2693030.0, 2690964.0, 2691574.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.012134
Client Index = 0	Epoch: 1	Loss: 0.056792
Client Index = 0	Epoch: 2	Loss: 0.098063
Client Index = 0	Epoch: 3	Loss: 0.067402
Client Index = 0	Epoch: 4	Loss: 0.097694
test acc on this client after 1620 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 1
local mask changes: 2299990.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2689662.0, 2299990.0, 2693418.0, 2693772.0, 2693482.0]
Doing local aggregation!
test acc on this client before 1847 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.018186
Client Index = 1	Epoch: 1	Loss: 0.073078
Client Index = 1	Epoch: 2	Loss: 0.088503
Client Index = 1	Epoch: 3	Loss: 0.097240
Client Index = 1	Epoch: 4	Loss: 0.109609
test acc on this client after 1621 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 2
local mask changes: 2297378.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2693222.0, 2693912.0, 2297378.0, 2695686.0, 2696358.0]
Doing local aggregation!
test acc on this client before 1828 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.017182
Client Index = 2	Epoch: 1	Loss: 0.063922
Client Index = 2	Epoch: 2	Loss: 0.078278
Client Index = 2	Epoch: 3	Loss: 0.114472
Client Index = 2	Epoch: 4	Loss: 0.083762
test acc on this client after 1575 / 2003 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 3
local mask changes: 2300954.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2691266.0, 2692926.0, 2694702.0, 2300954.0, 2693356.0]
Doing local aggregation!
test acc on this client before 1828 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.024672
Client Index = 3	Epoch: 1	Loss: 0.081638
Client Index = 3	Epoch: 2	Loss: 0.088973
Client Index = 3	Epoch: 3	Loss: 0.105909
Client Index = 3	Epoch: 4	Loss: 0.093363
test acc on this client after 1741 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 4
local mask changes: 2298788.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2693632.0, 2693344.0, 2696818.0, 2695562.0, 2298788.0]
Doing local aggregation!
test acc on this client before 1830 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.019601
Client Index = 4	Epoch: 1	Loss: 0.060191
Client Index = 4	Epoch: 2	Loss: 0.092632
Client Index = 4	Epoch: 3	Loss: 0.087203
Client Index = 4	Epoch: 4	Loss: 0.091766
test acc on this client after 1782 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07289053538790428}
################local_test_on_all_clients after local training in communication round: 37
{'test_acc_after': 0.8318907476037282, 'test_loss_after': 0.6541316734578223}
################local_test_on_all_clients before local training in communication round: 37
{'test_acc_before': 0.9172981542050318, 'test_loss_before': 0.3001795490906559}
################Communication round : 38
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 0
local mask changes: 2265618.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2265618.0, 2669048.0, 2671464.0, 2670320.0, 2672212.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.024469
Client Index = 0	Epoch: 1	Loss: 0.070179
Client Index = 0	Epoch: 2	Loss: 0.093531
Client Index = 0	Epoch: 3	Loss: 0.091321
Client Index = 0	Epoch: 4	Loss: 0.081379
test acc on this client after 1617 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 1
local mask changes: 2265754.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2674586.0, 2265754.0, 2678794.0, 2675780.0, 2674570.0]
Doing local aggregation!
test acc on this client before 1840 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.022146
Client Index = 1	Epoch: 1	Loss: 0.082139
Client Index = 1	Epoch: 2	Loss: 0.075577
Client Index = 1	Epoch: 3	Loss: 0.100420
Client Index = 1	Epoch: 4	Loss: 0.075808
test acc on this client after 1621 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 2
local mask changes: 2265820.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2674450.0, 2676486.0, 2265820.0, 2674472.0, 2673662.0]
Doing local aggregation!
test acc on this client before 1832 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.017484
Client Index = 2	Epoch: 1	Loss: 0.069745
Client Index = 2	Epoch: 2	Loss: 0.081517
Client Index = 2	Epoch: 3	Loss: 0.098876
Client Index = 2	Epoch: 4	Loss: 0.088641
test acc on this client after 1763 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 3
local mask changes: 2264570.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2674662.0, 2675160.0, 2675800.0, 2264570.0, 2677026.0]
Doing local aggregation!
test acc on this client before 1830 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.023561
Client Index = 3	Epoch: 1	Loss: 0.060711
Client Index = 3	Epoch: 2	Loss: 0.083677
Client Index = 3	Epoch: 3	Loss: 0.086897
Client Index = 3	Epoch: 4	Loss: 0.111991
test acc on this client after 1496 / 2006 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 4
local mask changes: 2265564.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2673458.0, 2673228.0, 2675162.0, 2672780.0, 2265564.0]
Doing local aggregation!
test acc on this client before 1821 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.015293
Client Index = 4	Epoch: 1	Loss: 0.072086
Client Index = 4	Epoch: 2	Loss: 0.072204
Client Index = 4	Epoch: 3	Loss: 0.107272
Client Index = 4	Epoch: 4	Loss: 0.082825
test acc on this client after 1742 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07158996106852417}
################local_test_on_all_clients after local training in communication round: 38
{'test_acc_after': 0.8219465931919145, 'test_loss_after': 0.7052527143384361}
################local_test_on_all_clients before local training in communication round: 38
{'test_acc_before': 0.9171987025342101, 'test_loss_before': 0.31123460736330066}
################Communication round : 39
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 0
local mask changes: 2228690.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2228690.0, 2655428.0, 2655114.0, 2654672.0, 2654644.0]
Doing local aggregation!
test acc on this client before 1865 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.021371
Client Index = 0	Epoch: 1	Loss: 0.062475
Client Index = 0	Epoch: 2	Loss: 0.077474
Client Index = 0	Epoch: 3	Loss: 0.104646
Client Index = 0	Epoch: 4	Loss: 0.091080
test acc on this client after 1545 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 1
local mask changes: 2227562.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2654574.0, 2227562.0, 2658032.0, 2657548.0, 2654812.0]
Doing local aggregation!
test acc on this client before 1845 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.014292
Client Index = 1	Epoch: 1	Loss: 0.067029
Client Index = 1	Epoch: 2	Loss: 0.077623
Client Index = 1	Epoch: 3	Loss: 0.098864
Client Index = 1	Epoch: 4	Loss: 0.090609
test acc on this client after 1756 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 2
local mask changes: 2227506.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2654124.0, 2657292.0, 2227506.0, 2657034.0, 2656406.0]
Doing local aggregation!
test acc on this client before 1838 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.021248
Client Index = 2	Epoch: 1	Loss: 0.071706
Client Index = 2	Epoch: 2	Loss: 0.086246
Client Index = 2	Epoch: 3	Loss: 0.083681
Client Index = 2	Epoch: 4	Loss: 0.089185
test acc on this client after 1723 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 3
local mask changes: 2230478.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2658314.0, 2660014.0, 2661532.0, 2230478.0, 2660726.0]
Doing local aggregation!
test acc on this client before 1814 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.016528
Client Index = 3	Epoch: 1	Loss: 0.069018
Client Index = 3	Epoch: 2	Loss: 0.074009
Client Index = 3	Epoch: 3	Loss: 0.090451
Client Index = 3	Epoch: 4	Loss: 0.084212
test acc on this client after 1612 / 2006 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 4
local mask changes: 2229628.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2653424.0, 2657024.0, 2656588.0, 2656700.0, 2229628.0]
Doing local aggregation!
test acc on this client before 1826 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.021427
Client Index = 4	Epoch: 1	Loss: 0.074783
Client Index = 4	Epoch: 2	Loss: 0.076532
Client Index = 4	Epoch: 3	Loss: 0.084526
Client Index = 4	Epoch: 4	Loss: 0.099127
test acc on this client after 1774 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06992567125907433}
################local_test_on_all_clients after local training in communication round: 39
{'test_acc_after': 0.8389941975200639, 'test_loss_after': 0.6328855665852974}
################local_test_on_all_clients before local training in communication round: 39
{'test_acc_before': 0.9166015920190246, 'test_loss_before': 0.3253971914163185}
################Communication round : 40
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 0
local mask changes: 2192764.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2192764.0, 2639192.0, 2638250.0, 2638858.0, 2636306.0]
Doing local aggregation!
test acc on this client before 1851 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.011886
Client Index = 0	Epoch: 1	Loss: 0.077406
Client Index = 0	Epoch: 2	Loss: 0.075341
Client Index = 0	Epoch: 3	Loss: 0.075235
Client Index = 0	Epoch: 4	Loss: 0.101290
test acc on this client after 1718 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 1
local mask changes: 2193750.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2633552.0, 2193750.0, 2634876.0, 2636112.0, 2634884.0]
Doing local aggregation!
test acc on this client before 1854 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.016724
Client Index = 1	Epoch: 1	Loss: 0.061257
Client Index = 1	Epoch: 2	Loss: 0.092640
Client Index = 1	Epoch: 3	Loss: 0.078110
Client Index = 1	Epoch: 4	Loss: 0.096752
test acc on this client after 1622 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 2
local mask changes: 2192128.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2634166.0, 2635780.0, 2192128.0, 2638892.0, 2635402.0]
Doing local aggregation!
test acc on this client before 1822 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.021752
Client Index = 2	Epoch: 1	Loss: 0.083707
Client Index = 2	Epoch: 2	Loss: 0.071971
Client Index = 2	Epoch: 3	Loss: 0.081903
Client Index = 2	Epoch: 4	Loss: 0.100128
test acc on this client after 1642 / 2003 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 3
local mask changes: 2192408.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2637250.0, 2636582.0, 2638610.0, 2192408.0, 2638736.0]
Doing local aggregation!
test acc on this client before 1828 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.012226
Client Index = 3	Epoch: 1	Loss: 0.076187
Client Index = 3	Epoch: 2	Loss: 0.093824
Client Index = 3	Epoch: 3	Loss: 0.077816
Client Index = 3	Epoch: 4	Loss: 0.093152
test acc on this client after 1647 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 4
local mask changes: 2192208.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2637106.0, 2638622.0, 2637398.0, 2640954.0, 2192208.0]
Doing local aggregation!
test acc on this client before 1829 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.030840
Client Index = 4	Epoch: 1	Loss: 0.057855
Client Index = 4	Epoch: 2	Loss: 0.098485
Client Index = 4	Epoch: 3	Loss: 0.087067
Client Index = 4	Epoch: 4	Loss: 0.087057
test acc on this client after 1763 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.07042436508145848}
################local_test_on_all_clients after local training in communication round: 40
{'test_acc_after': 0.8371888781845023, 'test_loss_after': 0.6227671948898854}
################local_test_on_all_clients before local training in communication round: 40
{'test_acc_before': 0.9162002997398467, 'test_loss_before': 0.30727644673856286}
################Communication round : 41
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 0
local mask changes: 2156306.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2156306.0, 2612496.0, 2614054.0, 2616194.0, 2616118.0]
Doing local aggregation!
test acc on this client before 1861 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.014180
Client Index = 0	Epoch: 1	Loss: 0.068898
Client Index = 0	Epoch: 2	Loss: 0.071030
Client Index = 0	Epoch: 3	Loss: 0.082532
Client Index = 0	Epoch: 4	Loss: 0.083874
test acc on this client after 1529 / 2005 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 1
local mask changes: 2154990.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2613946.0, 2154990.0, 2615046.0, 2613656.0, 2614846.0]
Doing local aggregation!
test acc on this client before 1845 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.017139
Client Index = 1	Epoch: 1	Loss: 0.059849
Client Index = 1	Epoch: 2	Loss: 0.081538
Client Index = 1	Epoch: 3	Loss: 0.079969
Client Index = 1	Epoch: 4	Loss: 0.092083
test acc on this client after 1797 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 2
local mask changes: 2155072.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2617178.0, 2615680.0, 2155072.0, 2617514.0, 2619166.0]
Doing local aggregation!
test acc on this client before 1813 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.014268
Client Index = 2	Epoch: 1	Loss: 0.046697
Client Index = 2	Epoch: 2	Loss: 0.090292
Client Index = 2	Epoch: 3	Loss: 0.082010
Client Index = 2	Epoch: 4	Loss: 0.099879
test acc on this client after 1781 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 3
local mask changes: 2155870.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2617034.0, 2615508.0, 2615924.0, 2155870.0, 2617338.0]
Doing local aggregation!
test acc on this client before 1812 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.010990
Client Index = 3	Epoch: 1	Loss: 0.050975
Client Index = 3	Epoch: 2	Loss: 0.075004
Client Index = 3	Epoch: 3	Loss: 0.099059
Client Index = 3	Epoch: 4	Loss: 0.086357
test acc on this client after 1721 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 4
local mask changes: 2154812.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2616554.0, 2614276.0, 2616860.0, 2616728.0, 2154812.0]
Doing local aggregation!
test acc on this client before 1835 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.015254
Client Index = 4	Epoch: 1	Loss: 0.073345
Client Index = 4	Epoch: 2	Loss: 0.072100
Client Index = 4	Epoch: 3	Loss: 0.092106
Client Index = 4	Epoch: 4	Loss: 0.074804
test acc on this client after 1769 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0653692421205912}
################local_test_on_all_clients after local training in communication round: 41
{'test_acc_after': 0.8576479208259264, 'test_loss_after': 0.5394223890299841}
################local_test_on_all_clients before local training in communication round: 41
{'test_acc_before': 0.9144046877250404, 'test_loss_before': 0.3086259954775063}
################Communication round : 42
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 0
local mask changes: 2117072.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2117072.0, 2592968.0, 2593882.0, 2593788.0, 2592996.0]
Doing local aggregation!
test acc on this client before 1852 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.015365
Client Index = 0	Epoch: 1	Loss: 0.043281
Client Index = 0	Epoch: 2	Loss: 0.082255
Client Index = 0	Epoch: 3	Loss: 0.102614
Client Index = 0	Epoch: 4	Loss: 0.082812
test acc on this client after 1828 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 1
local mask changes: 2117720.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2589772.0, 2117720.0, 2591622.0, 2590550.0, 2591934.0]
Doing local aggregation!
test acc on this client before 1849 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.016283
Client Index = 1	Epoch: 1	Loss: 0.071391
Client Index = 1	Epoch: 2	Loss: 0.073627
Client Index = 1	Epoch: 3	Loss: 0.070944
Client Index = 1	Epoch: 4	Loss: 0.082036
test acc on this client after 1789 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 2
local mask changes: 2117158.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2596346.0, 2595722.0, 2117158.0, 2597520.0, 2597286.0]
Doing local aggregation!
test acc on this client before 1822 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.017796
Client Index = 2	Epoch: 1	Loss: 0.054142
Client Index = 2	Epoch: 2	Loss: 0.112220
Client Index = 2	Epoch: 3	Loss: 0.064503
Client Index = 2	Epoch: 4	Loss: 0.085197
test acc on this client after 1768 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 3
local mask changes: 2117252.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2591706.0, 2593596.0, 2594200.0, 2117252.0, 2594162.0]
Doing local aggregation!
test acc on this client before 1815 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.012829
Client Index = 3	Epoch: 1	Loss: 0.080151
Client Index = 3	Epoch: 2	Loss: 0.076110
Client Index = 3	Epoch: 3	Loss: 0.079489
Client Index = 3	Epoch: 4	Loss: 0.092163
test acc on this client after 1764 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 4
local mask changes: 2118032.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2593278.0, 2592026.0, 2592488.0, 2593726.0, 2118032.0]
Doing local aggregation!
test acc on this client before 1825 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.014663
Client Index = 4	Epoch: 1	Loss: 0.065070
Client Index = 4	Epoch: 2	Loss: 0.078420
Client Index = 4	Epoch: 3	Loss: 0.070173
Client Index = 4	Epoch: 4	Loss: 0.116786
test acc on this client after 1770 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06641277480152988}
################local_test_on_all_clients after local training in communication round: 42
{'test_acc_after': 0.8897641885344424, 'test_loss_after': 0.3995734261763498}
################local_test_on_all_clients before local training in communication round: 42
{'test_acc_before': 0.9141061830873106, 'test_loss_before': 0.3151919658967067}
################Communication round : 43
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 0
local mask changes: 2077568.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2077568.0, 2566830.0, 2569022.0, 2567186.0, 2566940.0]
Doing local aggregation!
test acc on this client before 1865 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.012156
Client Index = 0	Epoch: 1	Loss: 0.073022
Client Index = 0	Epoch: 2	Loss: 0.067122
Client Index = 0	Epoch: 3	Loss: 0.091864
Client Index = 0	Epoch: 4	Loss: 0.099042
test acc on this client after 1454 / 2005 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 1
local mask changes: 2079162.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2564128.0, 2079162.0, 2564990.0, 2565042.0, 2564884.0]
Doing local aggregation!
test acc on this client before 1861 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.010462
Client Index = 1	Epoch: 1	Loss: 0.048709
Client Index = 1	Epoch: 2	Loss: 0.091142
Client Index = 1	Epoch: 3	Loss: 0.088528
Client Index = 1	Epoch: 4	Loss: 0.082176
test acc on this client after 1707 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 2
local mask changes: 2079512.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2570604.0, 2569040.0, 2079512.0, 2570102.0, 2570228.0]
Doing local aggregation!
test acc on this client before 1837 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.019728
Client Index = 2	Epoch: 1	Loss: 0.065227
Client Index = 2	Epoch: 2	Loss: 0.091505
Client Index = 2	Epoch: 3	Loss: 0.079711
Client Index = 2	Epoch: 4	Loss: 0.081887
test acc on this client after 1752 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 3
local mask changes: 2078876.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2570748.0, 2569718.0, 2571730.0, 2078876.0, 2569514.0]
Doing local aggregation!
test acc on this client before 1837 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.010619
Client Index = 3	Epoch: 1	Loss: 0.039326
Client Index = 3	Epoch: 2	Loss: 0.075720
Client Index = 3	Epoch: 3	Loss: 0.100503
Client Index = 3	Epoch: 4	Loss: 0.083321
test acc on this client after 1789 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 4
local mask changes: 2079282.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2570638.0, 2569664.0, 2571234.0, 2571796.0, 2079282.0]
Doing local aggregation!
test acc on this client before 1830 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.009290
Client Index = 4	Epoch: 1	Loss: 0.057947
Client Index = 4	Epoch: 2	Loss: 0.069516
Client Index = 4	Epoch: 3	Loss: 0.096539
Client Index = 4	Epoch: 4	Loss: 0.088540
test acc on this client after 1753 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06534412571233791}
################local_test_on_all_clients after local training in communication round: 43
{'test_acc_after': 0.8434770624847557, 'test_loss_after': 0.6180585636582285}
################local_test_on_all_clients before local training in communication round: 43
{'test_acc_before': 0.9207898749012753, 'test_loss_before': 0.29568881704831695}
################Communication round : 44
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 0
local mask changes: 2040458.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2040458.0, 2544142.0, 2548394.0, 2547802.0, 2549088.0]
Doing local aggregation!
test acc on this client before 1856 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.010129
Client Index = 0	Epoch: 1	Loss: 0.053231
Client Index = 0	Epoch: 2	Loss: 0.084222
Client Index = 0	Epoch: 3	Loss: 0.080545
Client Index = 0	Epoch: 4	Loss: 0.102135
test acc on this client after 1784 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 1
local mask changes: 2038162.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2539518.0, 2038162.0, 2542676.0, 2542998.0, 2544640.0]
Doing local aggregation!
test acc on this client before 1847 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.013325
Client Index = 1	Epoch: 1	Loss: 0.042630
Client Index = 1	Epoch: 2	Loss: 0.098660
Client Index = 1	Epoch: 3	Loss: 0.069945
Client Index = 1	Epoch: 4	Loss: 0.090064
test acc on this client after 1627 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 2
local mask changes: 2039758.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2547218.0, 2546846.0, 2039758.0, 2549104.0, 2551064.0]
Doing local aggregation!
test acc on this client before 1828 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.014116
Client Index = 2	Epoch: 1	Loss: 0.059228
Client Index = 2	Epoch: 2	Loss: 0.083595
Client Index = 2	Epoch: 3	Loss: 0.079995
Client Index = 2	Epoch: 4	Loss: 0.092254
test acc on this client after 1561 / 2003 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 3
local mask changes: 2039116.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2542656.0, 2541948.0, 2546246.0, 2039116.0, 2545834.0]
Doing local aggregation!
test acc on this client before 1829 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.007276
Client Index = 3	Epoch: 1	Loss: 0.054386
Client Index = 3	Epoch: 2	Loss: 0.103369
Client Index = 3	Epoch: 3	Loss: 0.067326
Client Index = 3	Epoch: 4	Loss: 0.095893
test acc on this client after 1662 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 4
local mask changes: 2038472.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2542838.0, 2540458.0, 2545564.0, 2546866.0, 2038472.0]
Doing local aggregation!
test acc on this client before 1833 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.015332
Client Index = 4	Epoch: 1	Loss: 0.068774
Client Index = 4	Epoch: 2	Loss: 0.074618
Client Index = 4	Epoch: 3	Loss: 0.093935
Client Index = 4	Epoch: 4	Loss: 0.084799
test acc on this client after 1782 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06559119470075381}
################local_test_on_all_clients after local training in communication round: 44
{'test_acc_after': 0.8395740795561455, 'test_loss_after': 0.6260551413731659}
################local_test_on_all_clients before local training in communication round: 44
{'test_acc_before': 0.9170986032320156, 'test_loss_before': 0.3081028063464982}
################Communication round : 45
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 0
local mask changes: 1999370.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1999370.0, 2518340.0, 2522354.0, 2519696.0, 2519112.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.012397
Client Index = 0	Epoch: 1	Loss: 0.050958
Client Index = 0	Epoch: 2	Loss: 0.099685
Client Index = 0	Epoch: 3	Loss: 0.077960
Client Index = 0	Epoch: 4	Loss: 0.081227
test acc on this client after 1745 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 1
local mask changes: 1999560.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2519678.0, 1999560.0, 2521130.0, 2518558.0, 2518082.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.019834
Client Index = 1	Epoch: 1	Loss: 0.072032
Client Index = 1	Epoch: 2	Loss: 0.083110
Client Index = 1	Epoch: 3	Loss: 0.075165
Client Index = 1	Epoch: 4	Loss: 0.085270
test acc on this client after 1755 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 2
local mask changes: 1999282.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2527428.0, 2524778.0, 1999282.0, 2525602.0, 2525428.0]
Doing local aggregation!
test acc on this client before 1827 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.008726
Client Index = 2	Epoch: 1	Loss: 0.037382
Client Index = 2	Epoch: 2	Loss: 0.085053
Client Index = 2	Epoch: 3	Loss: 0.086218
Client Index = 2	Epoch: 4	Loss: 0.083769
test acc on this client after 1575 / 2003 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 3
local mask changes: 1997686.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2524660.0, 2523510.0, 2524412.0, 1997686.0, 2523636.0]
Doing local aggregation!
test acc on this client before 1845 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.009367
Client Index = 3	Epoch: 1	Loss: 0.055654
Client Index = 3	Epoch: 2	Loss: 0.098756
Client Index = 3	Epoch: 3	Loss: 0.074518
Client Index = 3	Epoch: 4	Loss: 0.098556
test acc on this client after 1738 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 4
local mask changes: 1999592.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2526464.0, 2522778.0, 2528272.0, 2524980.0, 1999592.0]
Doing local aggregation!
test acc on this client before 1831 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.011762
Client Index = 4	Epoch: 1	Loss: 0.075602
Client Index = 4	Epoch: 2	Loss: 0.075635
Client Index = 4	Epoch: 3	Loss: 0.098019
Client Index = 4	Epoch: 4	Loss: 0.082417
test acc on this client after 1701 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06556290866548138}
################local_test_on_all_clients after local training in communication round: 45
{'test_acc_after': 0.8493472558843725, 'test_loss_after': 0.579938358306465}
################local_test_on_all_clients before local training in communication round: 45
{'test_acc_before': 0.9190927204814889, 'test_loss_before': 0.29823277367220646}
################Communication round : 46
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 0
local mask changes: 1958066.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1958066.0, 2494940.0, 2499372.0, 2498270.0, 2497998.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.011233
Client Index = 0	Epoch: 1	Loss: 0.064791
Client Index = 0	Epoch: 2	Loss: 0.080515
Client Index = 0	Epoch: 3	Loss: 0.080068
Client Index = 0	Epoch: 4	Loss: 0.081543
test acc on this client after 1743 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 1
local mask changes: 1958056.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2500348.0, 1958056.0, 2504874.0, 2503812.0, 2504754.0]
Doing local aggregation!
test acc on this client before 1857 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.019780
Client Index = 1	Epoch: 1	Loss: 0.059265
Client Index = 1	Epoch: 2	Loss: 0.066004
Client Index = 1	Epoch: 3	Loss: 0.089747
Client Index = 1	Epoch: 4	Loss: 0.086776
test acc on this client after 1683 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 2
local mask changes: 1957976.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2498278.0, 2498838.0, 1957976.0, 2501584.0, 2501948.0]
Doing local aggregation!
test acc on this client before 1828 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.013258
Client Index = 2	Epoch: 1	Loss: 0.058179
Client Index = 2	Epoch: 2	Loss: 0.066407
Client Index = 2	Epoch: 3	Loss: 0.083997
Client Index = 2	Epoch: 4	Loss: 0.104377
test acc on this client after 1568 / 2003 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 3
local mask changes: 1956842.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2503290.0, 2501636.0, 2506424.0, 1956842.0, 2505822.0]
Doing local aggregation!
test acc on this client before 1827 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.016621
Client Index = 3	Epoch: 1	Loss: 0.082060
Client Index = 3	Epoch: 2	Loss: 0.078002
Client Index = 3	Epoch: 3	Loss: 0.078611
Client Index = 3	Epoch: 4	Loss: 0.090326
test acc on this client after 1740 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 4
local mask changes: 1959050.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2503334.0, 2501194.0, 2508182.0, 2505070.0, 1959050.0]
Doing local aggregation!
test acc on this client before 1833 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.010939
Client Index = 4	Epoch: 1	Loss: 0.057044
Client Index = 4	Epoch: 2	Loss: 0.063375
Client Index = 4	Epoch: 3	Loss: 0.087740
Client Index = 4	Epoch: 4	Loss: 0.095052
test acc on this client after 1779 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06502836368935258}
################local_test_on_all_clients after local training in communication round: 46
{'test_acc_after': 0.8492467086001133, 'test_loss_after': 0.5735072139181293}
################local_test_on_all_clients before local training in communication round: 46
{'test_acc_before': 0.9193929670234345, 'test_loss_before': 0.30677760495297635}
################Communication round : 47
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 0
local mask changes: 1916906.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1916906.0, 2476690.0, 2474930.0, 2477594.0, 2477060.0]
Doing local aggregation!
test acc on this client before 1869 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.015518
Client Index = 0	Epoch: 1	Loss: 0.069964
Client Index = 0	Epoch: 2	Loss: 0.053360
Client Index = 0	Epoch: 3	Loss: 0.074437
Client Index = 0	Epoch: 4	Loss: 0.081206
test acc on this client after 1804 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 1
local mask changes: 1917120.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2479828.0, 1917120.0, 2482518.0, 2483630.0, 2482780.0]
Doing local aggregation!
test acc on this client before 1853 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.010156
Client Index = 1	Epoch: 1	Loss: 0.052804
Client Index = 1	Epoch: 2	Loss: 0.081589
Client Index = 1	Epoch: 3	Loss: 0.070535
Client Index = 1	Epoch: 4	Loss: 0.099389
test acc on this client after 1804 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 2
local mask changes: 1916626.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2478442.0, 2481978.0, 1916626.0, 2481828.0, 2482964.0]
Doing local aggregation!
test acc on this client before 1830 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.012975
Client Index = 2	Epoch: 1	Loss: 0.040210
Client Index = 2	Epoch: 2	Loss: 0.070645
Client Index = 2	Epoch: 3	Loss: 0.090939
Client Index = 2	Epoch: 4	Loss: 0.094941
test acc on this client after 1776 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 3
local mask changes: 1917800.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2482586.0, 2487246.0, 2484486.0, 1917800.0, 2487334.0]
Doing local aggregation!
test acc on this client before 1831 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.011289
Client Index = 3	Epoch: 1	Loss: 0.061130
Client Index = 3	Epoch: 2	Loss: 0.075740
Client Index = 3	Epoch: 3	Loss: 0.068802
Client Index = 3	Epoch: 4	Loss: 0.088389
test acc on this client after 1764 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 4
local mask changes: 1916976.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2476668.0, 2481142.0, 2480310.0, 2482410.0, 1916976.0]
Doing local aggregation!
test acc on this client before 1836 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.008437
Client Index = 4	Epoch: 1	Loss: 0.025307
Client Index = 4	Epoch: 2	Loss: 0.089757
Client Index = 4	Epoch: 3	Loss: 0.112090
Client Index = 4	Epoch: 4	Loss: 0.077698
test acc on this client after 1717 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06149221956703756}
################local_test_on_all_clients after local training in communication round: 47
{'test_acc_after': 0.8843784516783799, 'test_loss_after': 0.44408370743504333}
################local_test_on_all_clients before local training in communication round: 47
{'test_acc_before': 0.9196922191916685, 'test_loss_before': 0.30384074440129416}
################Communication round : 48
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 0
local mask changes: 1874786.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1874786.0, 2453466.0, 2453630.0, 2456256.0, 2453202.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.017160
Client Index = 0	Epoch: 1	Loss: 0.051843
Client Index = 0	Epoch: 2	Loss: 0.083340
Client Index = 0	Epoch: 3	Loss: 0.068186
Client Index = 0	Epoch: 4	Loss: 0.086470
test acc on this client after 1725 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 1
local mask changes: 1874552.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2451750.0, 1874552.0, 2455704.0, 2459188.0, 2454992.0]
Doing local aggregation!
test acc on this client before 1860 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.025086
Client Index = 1	Epoch: 1	Loss: 0.047902
Client Index = 1	Epoch: 2	Loss: 0.082424
Client Index = 1	Epoch: 3	Loss: 0.080717
Client Index = 1	Epoch: 4	Loss: 0.096966
test acc on this client after 1756 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 2
local mask changes: 1874622.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2453540.0, 2457694.0, 1874622.0, 2457966.0, 2456154.0]
Doing local aggregation!
test acc on this client before 1837 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.011508
Client Index = 2	Epoch: 1	Loss: 0.071601
Client Index = 2	Epoch: 2	Loss: 0.081414
Client Index = 2	Epoch: 3	Loss: 0.077995
Client Index = 2	Epoch: 4	Loss: 0.091554
test acc on this client after 1776 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 3
local mask changes: 1873256.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2456546.0, 2459870.0, 2458622.0, 1873256.0, 2459808.0]
Doing local aggregation!
test acc on this client before 1841 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.016091
Client Index = 3	Epoch: 1	Loss: 0.064038
Client Index = 3	Epoch: 2	Loss: 0.069635
Client Index = 3	Epoch: 3	Loss: 0.073883
Client Index = 3	Epoch: 4	Loss: 0.094805
test acc on this client after 1775 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 4
local mask changes: 1875738.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2453182.0, 2457036.0, 2455674.0, 2459130.0, 1875738.0]
Doing local aggregation!
test acc on this client before 1844 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.011172
Client Index = 4	Epoch: 1	Loss: 0.050761
Client Index = 4	Epoch: 2	Loss: 0.087758
Client Index = 4	Epoch: 3	Loss: 0.086318
Client Index = 4	Epoch: 4	Loss: 0.083837
test acc on this client after 1672 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0644987133242741}
################local_test_on_all_clients after local training in communication round: 48
{'test_acc_after': 0.8683180543168485, 'test_loss_after': 0.5035144750511306}
################local_test_on_all_clients before local training in communication round: 48
{'test_acc_before': 0.9231836909593355, 'test_loss_before': 0.30613240158661814}
################Communication round : 49
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 0
local mask changes: 1832706.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1832706.0, 2429530.0, 2430440.0, 2429900.0, 2429098.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.010242
Client Index = 0	Epoch: 1	Loss: 0.046810
Client Index = 0	Epoch: 2	Loss: 0.071139
Client Index = 0	Epoch: 3	Loss: 0.079589
Client Index = 0	Epoch: 4	Loss: 0.082063
test acc on this client after 1541 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 1
local mask changes: 1831926.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2434060.0, 1831926.0, 2436506.0, 2438828.0, 2435144.0]
Doing local aggregation!
test acc on this client before 1870 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.008139
Client Index = 1	Epoch: 1	Loss: 0.039648
Client Index = 1	Epoch: 2	Loss: 0.061652
Client Index = 1	Epoch: 3	Loss: 0.094376
Client Index = 1	Epoch: 4	Loss: 0.081341
test acc on this client after 1620 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 2
local mask changes: 1831294.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2432380.0, 2434366.0, 1831294.0, 2435728.0, 2433590.0]
Doing local aggregation!
test acc on this client before 1845 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.007519
Client Index = 2	Epoch: 1	Loss: 0.035302
Client Index = 2	Epoch: 2	Loss: 0.065627
Client Index = 2	Epoch: 3	Loss: 0.109290
Client Index = 2	Epoch: 4	Loss: 0.063423
test acc on this client after 1698 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 3
local mask changes: 1830738.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2430410.0, 2433930.0, 2434102.0, 1830738.0, 2434108.0]
Doing local aggregation!
test acc on this client before 1854 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.006811
Client Index = 3	Epoch: 1	Loss: 0.058443
Client Index = 3	Epoch: 2	Loss: 0.063645
Client Index = 3	Epoch: 3	Loss: 0.109137
Client Index = 3	Epoch: 4	Loss: 0.067952
test acc on this client after 1702 / 2006 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 4
local mask changes: 1830984.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2429966.0, 2430076.0, 2432914.0, 2431966.0, 1830984.0]
Doing local aggregation!
test acc on this client before 1855 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.012826
Client Index = 4	Epoch: 1	Loss: 0.049403
Client Index = 4	Epoch: 2	Loss: 0.080228
Client Index = 4	Epoch: 3	Loss: 0.073715
Client Index = 4	Epoch: 4	Loss: 0.090686
test acc on this client after 1783 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05876023055550794}
################local_test_on_all_clients after local training in communication round: 49
{'test_acc_after': 0.8324036909903926, 'test_loss_after': 0.670091939814945}
################local_test_on_all_clients before local training in communication round: 49
{'test_acc_before': 0.9272736168904725, 'test_loss_before': 0.28893843934209784}
################Communication round : 50
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 0
local mask changes: 1788522.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1788522.0, 2408306.0, 2405490.0, 2404838.0, 2403304.0]
Doing local aggregation!
test acc on this client before 1858 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.014322
Client Index = 0	Epoch: 1	Loss: 0.065517
Client Index = 0	Epoch: 2	Loss: 0.068498
Client Index = 0	Epoch: 3	Loss: 0.083554
Client Index = 0	Epoch: 4	Loss: 0.090143
test acc on this client after 1775 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 1
local mask changes: 1788566.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2406416.0, 1788566.0, 2409330.0, 2406746.0, 2405522.0]
Doing local aggregation!
test acc on this client before 1858 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.009595
Client Index = 1	Epoch: 1	Loss: 0.055247
Client Index = 1	Epoch: 2	Loss: 0.084931
Client Index = 1	Epoch: 3	Loss: 0.068630
Client Index = 1	Epoch: 4	Loss: 0.085950
test acc on this client after 1809 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 2
local mask changes: 1789798.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2404500.0, 2408650.0, 1789798.0, 2403718.0, 2405520.0]
Doing local aggregation!
test acc on this client before 1819 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.007874
Client Index = 2	Epoch: 1	Loss: 0.055500
Client Index = 2	Epoch: 2	Loss: 0.078070
Client Index = 2	Epoch: 3	Loss: 0.086074
Client Index = 2	Epoch: 4	Loss: 0.074150
test acc on this client after 1804 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 3
local mask changes: 1788310.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2406046.0, 2410708.0, 2409010.0, 1788310.0, 2407490.0]
Doing local aggregation!
test acc on this client before 1829 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.006655
Client Index = 3	Epoch: 1	Loss: 0.057464
Client Index = 3	Epoch: 2	Loss: 0.078180
Client Index = 3	Epoch: 3	Loss: 0.074131
Client Index = 3	Epoch: 4	Loss: 0.071002
test acc on this client after 1662 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 4
local mask changes: 1788046.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2410114.0, 2414042.0, 2411146.0, 2410716.0, 1788046.0]
Doing local aggregation!
test acc on this client before 1835 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.010196
Client Index = 4	Epoch: 1	Loss: 0.049507
Client Index = 4	Epoch: 2	Loss: 0.080392
Client Index = 4	Epoch: 3	Loss: 0.079862
Client Index = 4	Epoch: 4	Loss: 0.097942
test acc on this client after 1600 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06133541037461587}
################local_test_on_all_clients after local training in communication round: 50
{'test_acc_after': 0.8629399285382833, 'test_loss_after': 0.5376182775353058}
################local_test_on_all_clients before local training in communication round: 50
{'test_acc_before': 0.9176962105616695, 'test_loss_before': 0.30794344110917865}
################Communication round : 51
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 0
local mask changes: 1744010.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1744010.0, 2382326.0, 2380424.0, 2382036.0, 2385780.0]
Doing local aggregation!
test acc on this client before 1883 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.006327
Client Index = 0	Epoch: 1	Loss: 0.031841
Client Index = 0	Epoch: 2	Loss: 0.088802
Client Index = 0	Epoch: 3	Loss: 0.085464
Client Index = 0	Epoch: 4	Loss: 0.075962
test acc on this client after 1809 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 1
local mask changes: 1744860.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2374736.0, 1744860.0, 2376598.0, 2378486.0, 2378594.0]
Doing local aggregation!
test acc on this client before 1857 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.008060
Client Index = 1	Epoch: 1	Loss: 0.026326
Client Index = 1	Epoch: 2	Loss: 0.089126
Client Index = 1	Epoch: 3	Loss: 0.093033
Client Index = 1	Epoch: 4	Loss: 0.081299
test acc on this client after 1784 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 2
local mask changes: 1744218.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2378466.0, 2379516.0, 1744218.0, 2381282.0, 2381838.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.008213
Client Index = 2	Epoch: 1	Loss: 0.041103
Client Index = 2	Epoch: 2	Loss: 0.081037
Client Index = 2	Epoch: 3	Loss: 0.078392
Client Index = 2	Epoch: 4	Loss: 0.080454
test acc on this client after 1616 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 3
local mask changes: 1745080.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2376704.0, 2380014.0, 2379060.0, 1745080.0, 2381136.0]
Doing local aggregation!
test acc on this client before 1838 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.008258
Client Index = 3	Epoch: 1	Loss: 0.051596
Client Index = 3	Epoch: 2	Loss: 0.073967
Client Index = 3	Epoch: 3	Loss: 0.086308
Client Index = 3	Epoch: 4	Loss: 0.093867
test acc on this client after 1788 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 4
local mask changes: 1745582.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2382918.0, 2382820.0, 2384122.0, 2385708.0, 1745582.0]
Doing local aggregation!
test acc on this client before 1841 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.011283
Client Index = 4	Epoch: 1	Loss: 0.048473
Client Index = 4	Epoch: 2	Loss: 0.082521
Client Index = 4	Epoch: 3	Loss: 0.085644
Client Index = 4	Epoch: 4	Loss: 0.072323
test acc on this client after 1785 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.059587176498215724}
################local_test_on_all_clients after local training in communication round: 51
{'test_acc_after': 0.8760820203100869, 'test_loss_after': 0.4635489470637637}
################local_test_on_all_clients before local training in communication round: 51
{'test_acc_before': 0.9237827422832703, 'test_loss_before': 0.29192001132394835}
################Communication round : 52
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 0
local mask changes: 1699530.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1699530.0, 2349982.0, 2353050.0, 2351722.0, 2356160.0]
Doing local aggregation!
test acc on this client before 1885 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.008880
Client Index = 0	Epoch: 1	Loss: 0.049145
Client Index = 0	Epoch: 2	Loss: 0.064997
Client Index = 0	Epoch: 3	Loss: 0.083603
Client Index = 0	Epoch: 4	Loss: 0.086135
test acc on this client after 1739 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 1
local mask changes: 1700290.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2353476.0, 1700290.0, 2352530.0, 2351398.0, 2353754.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.008905
Client Index = 1	Epoch: 1	Loss: 0.035734
Client Index = 1	Epoch: 2	Loss: 0.078461
Client Index = 1	Epoch: 3	Loss: 0.077512
Client Index = 1	Epoch: 4	Loss: 0.079071
test acc on this client after 1660 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 2
local mask changes: 1700646.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2357120.0, 2355634.0, 1700646.0, 2355146.0, 2358938.0]
Doing local aggregation!
test acc on this client before 1851 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.010352
Client Index = 2	Epoch: 1	Loss: 0.043092
Client Index = 2	Epoch: 2	Loss: 0.082102
Client Index = 2	Epoch: 3	Loss: 0.087283
Client Index = 2	Epoch: 4	Loss: 0.064447
test acc on this client after 1785 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 3
local mask changes: 1700554.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2354928.0, 2353354.0, 2355100.0, 1700554.0, 2355818.0]
Doing local aggregation!
test acc on this client before 1849 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.008731
Client Index = 3	Epoch: 1	Loss: 0.058662
Client Index = 3	Epoch: 2	Loss: 0.068895
Client Index = 3	Epoch: 3	Loss: 0.083181
Client Index = 3	Epoch: 4	Loss: 0.078927
test acc on this client after 1681 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 4
local mask changes: 1701422.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2360136.0, 2354120.0, 2356750.0, 2355778.0, 1701422.0]
Doing local aggregation!
test acc on this client before 1840 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.009508
Client Index = 4	Epoch: 1	Loss: 0.045356
Client Index = 4	Epoch: 2	Loss: 0.088956
Client Index = 4	Epoch: 3	Loss: 0.070992
Client Index = 4	Epoch: 4	Loss: 0.090705
test acc on this client after 1745 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05854519062704046}
################local_test_on_all_clients after local training in communication round: 52
{'test_acc_after': 0.8589470663808838, 'test_loss_after': 0.5595163140700004}
################local_test_on_all_clients before local training in communication round: 52
{'test_acc_before': 0.9264764581409375, 'test_loss_before': 0.27269189747058026}
################Communication round : 53
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 0
local mask changes: 1656216.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1656216.0, 2324248.0, 2329358.0, 2326616.0, 2329066.0]
Doing local aggregation!
test acc on this client before 1846 / 2005 : 0.92
Client Index = 0	Epoch: 0	Loss: 0.004195
Client Index = 0	Epoch: 1	Loss: 0.024480
Client Index = 0	Epoch: 2	Loss: 0.076679
Client Index = 0	Epoch: 3	Loss: 0.084294
Client Index = 0	Epoch: 4	Loss: 0.088234
test acc on this client after 1617 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 1
local mask changes: 1655298.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2323338.0, 1655298.0, 2327962.0, 2324882.0, 2326502.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.010177
Client Index = 1	Epoch: 1	Loss: 0.058147
Client Index = 1	Epoch: 2	Loss: 0.078445
Client Index = 1	Epoch: 3	Loss: 0.069892
Client Index = 1	Epoch: 4	Loss: 0.074833
test acc on this client after 1715 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 2
local mask changes: 1654868.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2327474.0, 2328370.0, 1654868.0, 2327164.0, 2328716.0]
Doing local aggregation!
test acc on this client before 1821 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.007651
Client Index = 2	Epoch: 1	Loss: 0.056758
Client Index = 2	Epoch: 2	Loss: 0.064492
Client Index = 2	Epoch: 3	Loss: 0.073651
Client Index = 2	Epoch: 4	Loss: 0.091216
test acc on this client after 1708 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 3
local mask changes: 1657164.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2328194.0, 2326574.0, 2331246.0, 1657164.0, 2329458.0]
Doing local aggregation!
test acc on this client before 1812 / 2006 : 0.90
Client Index = 3	Epoch: 0	Loss: 0.008467
Client Index = 3	Epoch: 1	Loss: 0.045230
Client Index = 3	Epoch: 2	Loss: 0.068593
Client Index = 3	Epoch: 3	Loss: 0.069293
Client Index = 3	Epoch: 4	Loss: 0.090711
test acc on this client after 1783 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 4
local mask changes: 1656408.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2329628.0, 2325778.0, 2330564.0, 2326876.0, 1656408.0]
Doing local aggregation!
test acc on this client before 1826 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.011742
Client Index = 4	Epoch: 1	Loss: 0.072053
Client Index = 4	Epoch: 2	Loss: 0.063800
Client Index = 4	Epoch: 3	Loss: 0.084955
Client Index = 4	Epoch: 4	Loss: 0.098014
test acc on this client after 1340 / 2005 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0590401069126187}
################local_test_on_all_clients after local training in communication round: 53
{'test_acc_after': 0.8143457963429169, 'test_loss_after': 0.7383688625640381}
################local_test_on_all_clients before local training in communication round: 53
{'test_acc_before': 0.9125102226894267, 'test_loss_before': 0.3341761524744501}
################Communication round : 54
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 0
local mask changes: 1610858.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1610858.0, 2296734.0, 2300296.0, 2300044.0, 2299506.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.011212
Client Index = 0	Epoch: 1	Loss: 0.057904
Client Index = 0	Epoch: 2	Loss: 0.061522
Client Index = 0	Epoch: 3	Loss: 0.077082
Client Index = 0	Epoch: 4	Loss: 0.082234
test acc on this client after 1798 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 1
local mask changes: 1608998.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2296656.0, 1608998.0, 2300654.0, 2299100.0, 2298778.0]
Doing local aggregation!
test acc on this client before 1853 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.008573
Client Index = 1	Epoch: 1	Loss: 0.027277
Client Index = 1	Epoch: 2	Loss: 0.072426
Client Index = 1	Epoch: 3	Loss: 0.077069
Client Index = 1	Epoch: 4	Loss: 0.099363
test acc on this client after 1835 / 2005 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 2
local mask changes: 1609864.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2301830.0, 2299926.0, 1609864.0, 2303852.0, 2302788.0]
Doing local aggregation!
test acc on this client before 1828 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.006620
Client Index = 2	Epoch: 1	Loss: 0.032125
Client Index = 2	Epoch: 2	Loss: 0.071652
Client Index = 2	Epoch: 3	Loss: 0.076998
Client Index = 2	Epoch: 4	Loss: 0.088799
test acc on this client after 1619 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 3
local mask changes: 1610966.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2300492.0, 2298378.0, 2301736.0, 1610966.0, 2299082.0]
Doing local aggregation!
test acc on this client before 1821 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.009829
Client Index = 3	Epoch: 1	Loss: 0.040334
Client Index = 3	Epoch: 2	Loss: 0.076737
Client Index = 3	Epoch: 3	Loss: 0.085478
Client Index = 3	Epoch: 4	Loss: 0.084201
test acc on this client after 1800 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 4
local mask changes: 1610504.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2307838.0, 2308426.0, 2311092.0, 2308564.0, 1610504.0]
Doing local aggregation!
test acc on this client before 1824 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.006729
Client Index = 4	Epoch: 1	Loss: 0.043413
Client Index = 4	Epoch: 2	Loss: 0.063827
Client Index = 4	Epoch: 3	Loss: 0.076242
Client Index = 4	Epoch: 4	Loss: 0.101352
test acc on this client after 1688 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05755992362468161}
################local_test_on_all_clients after local training in communication round: 54
{'test_acc_after': 0.8718921962156131, 'test_loss_after': 0.49551779044622923}
################local_test_on_all_clients before local training in communication round: 54
{'test_acc_before': 0.9166002479238753, 'test_loss_before': 0.3136258137461566}
################Communication round : 55
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 0
local mask changes: 1565440.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1565440.0, 2273888.0, 2276670.0, 2273546.0, 2282716.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.007113
Client Index = 0	Epoch: 1	Loss: 0.043071
Client Index = 0	Epoch: 2	Loss: 0.070244
Client Index = 0	Epoch: 3	Loss: 0.066392
Client Index = 0	Epoch: 4	Loss: 0.079330
test acc on this client after 1792 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 1
local mask changes: 1565768.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2268228.0, 1565768.0, 2272514.0, 2268434.0, 2274094.0]
Doing local aggregation!
test acc on this client before 1856 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.010929
Client Index = 1	Epoch: 1	Loss: 0.052714
Client Index = 1	Epoch: 2	Loss: 0.071621
Client Index = 1	Epoch: 3	Loss: 0.083330
Client Index = 1	Epoch: 4	Loss: 0.073938
test acc on this client after 1600 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 2
local mask changes: 1563500.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2275276.0, 2273978.0, 1563500.0, 2275660.0, 2282160.0]
Doing local aggregation!
test acc on this client before 1840 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.013937
Client Index = 2	Epoch: 1	Loss: 0.056608
Client Index = 2	Epoch: 2	Loss: 0.069564
Client Index = 2	Epoch: 3	Loss: 0.100902
Client Index = 2	Epoch: 4	Loss: 0.083209
test acc on this client after 1764 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 3
local mask changes: 1564890.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2274630.0, 2275622.0, 2279402.0, 1564890.0, 2281826.0]
Doing local aggregation!
test acc on this client before 1835 / 2006 : 0.91
Client Index = 3	Epoch: 0	Loss: 0.008843
Client Index = 3	Epoch: 1	Loss: 0.032403
Client Index = 3	Epoch: 2	Loss: 0.070298
Client Index = 3	Epoch: 3	Loss: 0.088868
Client Index = 3	Epoch: 4	Loss: 0.075810
test acc on this client after 1734 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 4
local mask changes: 1564686.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2280648.0, 2278730.0, 2282268.0, 2280020.0, 1564686.0]
Doing local aggregation!
test acc on this client before 1829 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.006825
Client Index = 4	Epoch: 1	Loss: 0.033561
Client Index = 4	Epoch: 2	Loss: 0.088407
Client Index = 4	Epoch: 3	Loss: 0.056828
Client Index = 4	Epoch: 4	Loss: 0.079803
test acc on this client after 1667 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05698184830808954}
################local_test_on_all_clients after local training in communication round: 55
{'test_acc_after': 0.85365555622777, 'test_loss_after': 0.5888255844505034}
################local_test_on_all_clients before local training in communication round: 55
{'test_acc_before': 0.9205907719103241, 'test_loss_before': 0.30340471406230785}
################Communication round : 56
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 0
local mask changes: 1518946.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1518946.0, 2242642.0, 2248408.0, 2247596.0, 2249488.0]
Doing local aggregation!
test acc on this client before 1879 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.008579
Client Index = 0	Epoch: 1	Loss: 0.044239
Client Index = 0	Epoch: 2	Loss: 0.075027
Client Index = 0	Epoch: 3	Loss: 0.089022
Client Index = 0	Epoch: 4	Loss: 0.067163
test acc on this client after 1807 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 1
local mask changes: 1518714.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2250754.0, 1518714.0, 2250878.0, 2248318.0, 2251588.0]
Doing local aggregation!
test acc on this client before 1849 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.009321
Client Index = 1	Epoch: 1	Loss: 0.031107
Client Index = 1	Epoch: 2	Loss: 0.083325
Client Index = 1	Epoch: 3	Loss: 0.059767
Client Index = 1	Epoch: 4	Loss: 0.092230
test acc on this client after 1759 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 2
local mask changes: 1518818.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2258448.0, 2253644.0, 1518818.0, 2258556.0, 2260854.0]
Doing local aggregation!
test acc on this client before 1837 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005760
Client Index = 2	Epoch: 1	Loss: 0.019158
Client Index = 2	Epoch: 2	Loss: 0.067850
Client Index = 2	Epoch: 3	Loss: 0.082068
Client Index = 2	Epoch: 4	Loss: 0.087685
test acc on this client after 1712 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 3
local mask changes: 1517300.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2249062.0, 2247878.0, 2252332.0, 1517300.0, 2253928.0]
Doing local aggregation!
test acc on this client before 1846 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.005966
Client Index = 3	Epoch: 1	Loss: 0.032126
Client Index = 3	Epoch: 2	Loss: 0.047839
Client Index = 3	Epoch: 3	Loss: 0.101475
Client Index = 3	Epoch: 4	Loss: 0.082497
test acc on this client after 1707 / 2006 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 4
local mask changes: 1519142.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2252044.0, 2248212.0, 2252512.0, 2253886.0, 1519142.0]
Doing local aggregation!
test acc on this client before 1851 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.009556
Client Index = 4	Epoch: 1	Loss: 0.037012
Client Index = 4	Epoch: 2	Loss: 0.084482
Client Index = 4	Epoch: 3	Loss: 0.073026
Client Index = 4	Epoch: 4	Loss: 0.072495
test acc on this client after 1752 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0547510567744386}
################local_test_on_all_clients after local training in communication round: 56
{'test_acc_after': 0.8716068317892974, 'test_loss_after': 0.49921366955797514}
################local_test_on_all_clients before local training in communication round: 56
{'test_acc_before': 0.9239814473162001, 'test_loss_before': 0.29744308059123725}
################Communication round : 57
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 0
local mask changes: 1473264.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1473264.0, 2227296.0, 2231778.0, 2226712.0, 2227716.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.010413
Client Index = 0	Epoch: 1	Loss: 0.054384
Client Index = 0	Epoch: 2	Loss: 0.066452
Client Index = 0	Epoch: 3	Loss: 0.091239
Client Index = 0	Epoch: 4	Loss: 0.084861
test acc on this client after 1815 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 1
local mask changes: 1472936.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2218560.0, 1472936.0, 2226142.0, 2221678.0, 2221264.0]
Doing local aggregation!
test acc on this client before 1860 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.016037
Client Index = 1	Epoch: 1	Loss: 0.047131
Client Index = 1	Epoch: 2	Loss: 0.082313
Client Index = 1	Epoch: 3	Loss: 0.078977
Client Index = 1	Epoch: 4	Loss: 0.087648
test acc on this client after 1786 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 2
local mask changes: 1471430.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2224828.0, 2226816.0, 1471430.0, 2226752.0, 2226096.0]
Doing local aggregation!
test acc on this client before 1836 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005613
Client Index = 2	Epoch: 1	Loss: 0.040196
Client Index = 2	Epoch: 2	Loss: 0.086258
Client Index = 2	Epoch: 3	Loss: 0.076213
Client Index = 2	Epoch: 4	Loss: 0.079503
test acc on this client after 1723 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 3
local mask changes: 1473012.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2219046.0, 2223428.0, 2227954.0, 1473012.0, 2222916.0]
Doing local aggregation!
test acc on this client before 1840 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.007172
Client Index = 3	Epoch: 1	Loss: 0.036231
Client Index = 3	Epoch: 2	Loss: 0.074738
Client Index = 3	Epoch: 3	Loss: 0.089509
Client Index = 3	Epoch: 4	Loss: 0.094440
test acc on this client after 1802 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 4
local mask changes: 1472066.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2222472.0, 2226488.0, 2231066.0, 2225970.0, 1472066.0]
Doing local aggregation!
test acc on this client before 1847 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005537
Client Index = 4	Epoch: 1	Loss: 0.036490
Client Index = 4	Epoch: 2	Loss: 0.064041
Client Index = 4	Epoch: 3	Loss: 0.097017
Client Index = 4	Epoch: 4	Loss: 0.090610
test acc on this client after 1765 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.06012084639369871}
################local_test_on_all_clients after local training in communication round: 57
{'test_acc_after': 0.8869647994300447, 'test_loss_after': 0.42667190643597575}
################local_test_on_all_clients before local training in communication round: 57
{'test_acc_before': 0.9233831423311301, 'test_loss_before': 0.29960993730658203}
################Communication round : 58
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 0
local mask changes: 1426512.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1426512.0, 2199522.0, 2204174.0, 2200174.0, 2202828.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.009379
Client Index = 0	Epoch: 1	Loss: 0.047100
Client Index = 0	Epoch: 2	Loss: 0.070444
Client Index = 0	Epoch: 3	Loss: 0.059394
Client Index = 0	Epoch: 4	Loss: 0.085739
test acc on this client after 1766 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 1
local mask changes: 1426514.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2200688.0, 1426514.0, 2198854.0, 2196884.0, 2198088.0]
Doing local aggregation!
test acc on this client before 1865 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.006849
Client Index = 1	Epoch: 1	Loss: 0.030477
Client Index = 1	Epoch: 2	Loss: 0.061376
Client Index = 1	Epoch: 3	Loss: 0.074674
Client Index = 1	Epoch: 4	Loss: 0.087611
test acc on this client after 1656 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 2
local mask changes: 1426650.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2201246.0, 2197926.0, 1426650.0, 2200928.0, 2199520.0]
Doing local aggregation!
test acc on this client before 1848 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005896
Client Index = 2	Epoch: 1	Loss: 0.023915
Client Index = 2	Epoch: 2	Loss: 0.084946
Client Index = 2	Epoch: 3	Loss: 0.080536
Client Index = 2	Epoch: 4	Loss: 0.096702
test acc on this client after 1676 / 2003 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 3
local mask changes: 1425198.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2203960.0, 2199258.0, 2204080.0, 1425198.0, 2201910.0]
Doing local aggregation!
test acc on this client before 1845 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.005926
Client Index = 3	Epoch: 1	Loss: 0.037159
Client Index = 3	Epoch: 2	Loss: 0.071200
Client Index = 3	Epoch: 3	Loss: 0.061798
Client Index = 3	Epoch: 4	Loss: 0.105564
test acc on this client after 1763 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 4
local mask changes: 1426518.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2205086.0, 2199240.0, 2203894.0, 2200798.0, 1426518.0]
Doing local aggregation!
test acc on this client before 1840 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005537
Client Index = 4	Epoch: 1	Loss: 0.036568
Client Index = 4	Epoch: 2	Loss: 0.075647
Client Index = 4	Epoch: 3	Loss: 0.066650
Client Index = 4	Epoch: 4	Loss: 0.080444
test acc on this client after 1783 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05486129289944371}
################local_test_on_all_clients after local training in communication round: 58
{'test_acc_after': 0.8623236535018037, 'test_loss_after': 0.5414438809953965}
################local_test_on_all_clients before local training in communication round: 58
{'test_acc_before': 0.9256783532542748, 'test_loss_before': 0.2902106301421532}
################Communication round : 59
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 0
local mask changes: 1378864.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1378864.0, 2176782.0, 2178722.0, 2180094.0, 2180434.0]
Doing local aggregation!
test acc on this client before 1875 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.005297
Client Index = 0	Epoch: 1	Loss: 0.032776
Client Index = 0	Epoch: 2	Loss: 0.070259
Client Index = 0	Epoch: 3	Loss: 0.073637
Client Index = 0	Epoch: 4	Loss: 0.086282
test acc on this client after 1830 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 1
local mask changes: 1378966.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2174704.0, 1378966.0, 2175350.0, 2176912.0, 2177012.0]
Doing local aggregation!
test acc on this client before 1857 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.007525
Client Index = 1	Epoch: 1	Loss: 0.057716
Client Index = 1	Epoch: 2	Loss: 0.064917
Client Index = 1	Epoch: 3	Loss: 0.074116
Client Index = 1	Epoch: 4	Loss: 0.086896
test acc on this client after 1774 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 2
local mask changes: 1379020.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2177838.0, 2176472.0, 1379020.0, 2179632.0, 2180148.0]
Doing local aggregation!
test acc on this client before 1843 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.006158
Client Index = 2	Epoch: 1	Loss: 0.043013
Client Index = 2	Epoch: 2	Loss: 0.073496
Client Index = 2	Epoch: 3	Loss: 0.078432
Client Index = 2	Epoch: 4	Loss: 0.095251
test acc on this client after 1786 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 3
local mask changes: 1379654.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2180304.0, 2177602.0, 2180278.0, 1379654.0, 2181362.0]
Doing local aggregation!
test acc on this client before 1843 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.004961
Client Index = 3	Epoch: 1	Loss: 0.038101
Client Index = 3	Epoch: 2	Loss: 0.082135
Client Index = 3	Epoch: 3	Loss: 0.091517
Client Index = 3	Epoch: 4	Loss: 0.079607
test acc on this client after 1733 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 4
local mask changes: 1379424.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2178906.0, 2175028.0, 2175750.0, 2179700.0, 1379424.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005357
Client Index = 4	Epoch: 1	Loss: 0.027158
Client Index = 4	Epoch: 2	Loss: 0.053703
Client Index = 4	Epoch: 3	Loss: 0.096830
Client Index = 4	Epoch: 4	Loss: 0.087814
test acc on this client after 1786 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05691816610298406}
################local_test_on_all_clients after local training in communication round: 59
{'test_acc_after': 0.8887700166321503, 'test_loss_after': 0.4288133231882486}
################local_test_on_all_clients before local training in communication round: 59
{'test_acc_before': 0.9238824434784882, 'test_loss_before': 0.29386602483911883}
################Communication round : 60
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 0
local mask changes: 1333416.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1333416.0, 2148310.0, 2150698.0, 2154112.0, 2149790.0]
Doing local aggregation!
test acc on this client before 1865 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.003667
Client Index = 0	Epoch: 1	Loss: 0.009625
Client Index = 0	Epoch: 2	Loss: 0.052161
Client Index = 0	Epoch: 3	Loss: 0.078448
Client Index = 0	Epoch: 4	Loss: 0.091751
test acc on this client after 1783 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 1
local mask changes: 1332006.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2154104.0, 1332006.0, 2154732.0, 2155426.0, 2154182.0]
Doing local aggregation!
test acc on this client before 1854 / 2005 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.004540
Client Index = 1	Epoch: 1	Loss: 0.024143
Client Index = 1	Epoch: 2	Loss: 0.061833
Client Index = 1	Epoch: 3	Loss: 0.087703
Client Index = 1	Epoch: 4	Loss: 0.093185
test acc on this client after 1680 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 2
local mask changes: 1333666.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2154390.0, 2151536.0, 1333666.0, 2157014.0, 2153226.0]
Doing local aggregation!
test acc on this client before 1839 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003899
Client Index = 2	Epoch: 1	Loss: 0.019308
Client Index = 2	Epoch: 2	Loss: 0.071654
Client Index = 2	Epoch: 3	Loss: 0.067013
Client Index = 2	Epoch: 4	Loss: 0.086376
test acc on this client after 1751 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 3
local mask changes: 1332430.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2156422.0, 2154770.0, 2156770.0, 1332430.0, 2155510.0]
Doing local aggregation!
test acc on this client before 1845 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.005671
Client Index = 3	Epoch: 1	Loss: 0.042906
Client Index = 3	Epoch: 2	Loss: 0.063766
Client Index = 3	Epoch: 3	Loss: 0.083832
Client Index = 3	Epoch: 4	Loss: 0.076749
test acc on this client after 1716 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 4
local mask changes: 1332438.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2151188.0, 2147176.0, 2149954.0, 2151302.0, 1332438.0]
Doing local aggregation!
test acc on this client before 1845 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005729
Client Index = 4	Epoch: 1	Loss: 0.015165
Client Index = 4	Epoch: 2	Loss: 0.072676
Client Index = 4	Epoch: 3	Loss: 0.098158
Client Index = 4	Epoch: 4	Loss: 0.081210
test acc on this client after 1676 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05204660651542492}
################local_test_on_all_clients after local training in communication round: 60
{'test_acc_after': 0.8585429370309173, 'test_loss_after': 0.5595632424550564}
################local_test_on_all_clients before local training in communication round: 60
{'test_acc_before': 0.922585187516597, 'test_loss_before': 0.28413192567814727}
################Communication round : 61
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 0
local mask changes: 1285756.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1285756.0, 2120224.0, 2119614.0, 2121618.0, 2118264.0]
Doing local aggregation!
test acc on this client before 1866 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.005081
Client Index = 0	Epoch: 1	Loss: 0.007410
Client Index = 0	Epoch: 2	Loss: 0.053188
Client Index = 0	Epoch: 3	Loss: 0.083643
Client Index = 0	Epoch: 4	Loss: 0.090105
test acc on this client after 1807 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 1
local mask changes: 1284450.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2125804.0, 1284450.0, 2126832.0, 2129720.0, 2124770.0]
Doing local aggregation!
test acc on this client before 1861 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004136
Client Index = 1	Epoch: 1	Loss: 0.032416
Client Index = 1	Epoch: 2	Loss: 0.064539
Client Index = 1	Epoch: 3	Loss: 0.074665
Client Index = 1	Epoch: 4	Loss: 0.088565
test acc on this client after 1635 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 2
local mask changes: 1285428.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2123412.0, 2126248.0, 1285428.0, 2129380.0, 2121190.0]
Doing local aggregation!
test acc on this client before 1835 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005178
Client Index = 2	Epoch: 1	Loss: 0.031030
Client Index = 2	Epoch: 2	Loss: 0.077533
Client Index = 2	Epoch: 3	Loss: 0.087772
Client Index = 2	Epoch: 4	Loss: 0.080796
test acc on this client after 1790 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 3
local mask changes: 1285602.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2130646.0, 2131334.0, 2132134.0, 1285602.0, 2128250.0]
Doing local aggregation!
test acc on this client before 1844 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.006252
Client Index = 3	Epoch: 1	Loss: 0.040009
Client Index = 3	Epoch: 2	Loss: 0.070028
Client Index = 3	Epoch: 3	Loss: 0.069541
Client Index = 3	Epoch: 4	Loss: 0.089566
test acc on this client after 1775 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 4
local mask changes: 1284654.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2125058.0, 2126120.0, 2124370.0, 2127738.0, 1284654.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004346
Client Index = 4	Epoch: 1	Loss: 0.033649
Client Index = 4	Epoch: 2	Loss: 0.053376
Client Index = 4	Epoch: 3	Loss: 0.082509
Client Index = 4	Epoch: 4	Loss: 0.085283
test acc on this client after 1712 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05282459100817653}
################local_test_on_all_clients after local training in communication round: 61
{'test_acc_after': 0.8698157080855721, 'test_loss_after': 0.5220007997500118}
################local_test_on_all_clients before local training in communication round: 61
{'test_acc_before': 0.9225848388378439, 'test_loss_before': 0.287775173665314}
################Communication round : 62
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 0
local mask changes: 1238738.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1238738.0, 2086064.0, 2085968.0, 2090080.0, 2087166.0]
Doing local aggregation!
test acc on this client before 1877 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.007118
Client Index = 0	Epoch: 1	Loss: 0.033028
Client Index = 0	Epoch: 2	Loss: 0.073560
Client Index = 0	Epoch: 3	Loss: 0.068508
Client Index = 0	Epoch: 4	Loss: 0.080024
test acc on this client after 1411 / 2005 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 1
local mask changes: 1238330.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2095472.0, 1238330.0, 2099968.0, 2104588.0, 2101090.0]
Doing local aggregation!
test acc on this client before 1866 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004969
Client Index = 1	Epoch: 1	Loss: 0.045358
Client Index = 1	Epoch: 2	Loss: 0.067951
Client Index = 1	Epoch: 3	Loss: 0.083067
Client Index = 1	Epoch: 4	Loss: 0.078879
test acc on this client after 1810 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 2
local mask changes: 1237438.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2096530.0, 2102256.0, 1237438.0, 2105630.0, 2099040.0]
Doing local aggregation!
test acc on this client before 1848 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.006035
Client Index = 2	Epoch: 1	Loss: 0.041862
Client Index = 2	Epoch: 2	Loss: 0.072664
Client Index = 2	Epoch: 3	Loss: 0.081108
Client Index = 2	Epoch: 4	Loss: 0.076939
test acc on this client after 1762 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 3
local mask changes: 1238406.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2098046.0, 2103374.0, 2103144.0, 1238406.0, 2103486.0]
Doing local aggregation!
test acc on this client before 1853 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.007333
Client Index = 3	Epoch: 1	Loss: 0.041047
Client Index = 3	Epoch: 2	Loss: 0.077720
Client Index = 3	Epoch: 3	Loss: 0.088468
Client Index = 3	Epoch: 4	Loss: 0.088583
test acc on this client after 1609 / 2006 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 4
local mask changes: 1237252.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2095186.0, 2100198.0, 2099100.0, 2104044.0, 1237252.0]
Doing local aggregation!
test acc on this client before 1846 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.008536
Client Index = 4	Epoch: 1	Loss: 0.032671
Client Index = 4	Epoch: 2	Loss: 0.071433
Client Index = 4	Epoch: 3	Loss: 0.091944
Client Index = 4	Epoch: 4	Loss: 0.079086
test acc on this client after 1788 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05631569249892836}
################local_test_on_all_clients after local training in communication round: 62
{'test_acc_after': 0.8360057124428646, 'test_loss_after': 0.692342736298351}
################local_test_on_all_clients before local training in communication round: 62
{'test_acc_before': 0.9267752123030636, 'test_loss_before': 0.2806915243135214}
################Communication round : 63
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 0
local mask changes: 1190532.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1190532.0, 2069414.0, 2068416.0, 2070820.0, 2070070.0]
Doing local aggregation!
test acc on this client before 1886 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.004136
Client Index = 0	Epoch: 1	Loss: 0.007242
Client Index = 0	Epoch: 2	Loss: 0.062141
Client Index = 0	Epoch: 3	Loss: 0.080686
Client Index = 0	Epoch: 4	Loss: 0.081766
test acc on this client after 1788 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 1
local mask changes: 1191118.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2068236.0, 1191118.0, 2080536.0, 2081590.0, 2078776.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.005484
Client Index = 1	Epoch: 1	Loss: 0.053453
Client Index = 1	Epoch: 2	Loss: 0.059966
Client Index = 1	Epoch: 3	Loss: 0.086466
Client Index = 1	Epoch: 4	Loss: 0.080922
test acc on this client after 1782 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 2
local mask changes: 1190386.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2069020.0, 2078854.0, 1190386.0, 2080510.0, 2078062.0]
Doing local aggregation!
test acc on this client before 1844 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.007802
Client Index = 2	Epoch: 1	Loss: 0.047780
Client Index = 2	Epoch: 2	Loss: 0.076242
Client Index = 2	Epoch: 3	Loss: 0.058154
Client Index = 2	Epoch: 4	Loss: 0.078618
test acc on this client after 1770 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 3
local mask changes: 1191672.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2074634.0, 2084150.0, 2084022.0, 1191672.0, 2082760.0]
Doing local aggregation!
test acc on this client before 1855 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.007793
Client Index = 3	Epoch: 1	Loss: 0.049074
Client Index = 3	Epoch: 2	Loss: 0.070298
Client Index = 3	Epoch: 3	Loss: 0.096221
Client Index = 3	Epoch: 4	Loss: 0.070847
test acc on this client after 1497 / 2006 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 4
local mask changes: 1190430.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2071156.0, 2079830.0, 2079662.0, 2082084.0, 1190430.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.008598
Client Index = 4	Epoch: 1	Loss: 0.049347
Client Index = 4	Epoch: 2	Loss: 0.069159
Client Index = 4	Epoch: 3	Loss: 0.072784
Client Index = 4	Epoch: 4	Loss: 0.096012
test acc on this client after 1776 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05523960682306894}
################local_test_on_all_clients after local training in communication round: 63
{'test_acc_after': 0.8592539738414148, 'test_loss_after': 0.5610666804046242}
################local_test_on_all_clients before local training in communication round: 63
{'test_acc_before': 0.9285702256678559, 'test_loss_before': 0.2849884074317285}
################Communication round : 64
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 0
local mask changes: 1143294.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1143294.0, 2046666.0, 2045492.0, 2051576.0, 2047674.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.004339
Client Index = 0	Epoch: 1	Loss: 0.028836
Client Index = 0	Epoch: 2	Loss: 0.059996
Client Index = 0	Epoch: 3	Loss: 0.082422
Client Index = 0	Epoch: 4	Loss: 0.084537
test acc on this client after 1763 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 1
local mask changes: 1143526.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2053934.0, 1143526.0, 2061346.0, 2063170.0, 2061422.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003875
Client Index = 1	Epoch: 1	Loss: 0.015513
Client Index = 1	Epoch: 2	Loss: 0.060987
Client Index = 1	Epoch: 3	Loss: 0.075545
Client Index = 1	Epoch: 4	Loss: 0.091407
test acc on this client after 1811 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 2
local mask changes: 1143898.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2048914.0, 2057194.0, 1143898.0, 2060984.0, 2055902.0]
Doing local aggregation!
test acc on this client before 1829 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.006931
Client Index = 2	Epoch: 1	Loss: 0.043917
Client Index = 2	Epoch: 2	Loss: 0.061186
Client Index = 2	Epoch: 3	Loss: 0.078893
Client Index = 2	Epoch: 4	Loss: 0.081846
test acc on this client after 1746 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 3
local mask changes: 1144014.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2057202.0, 2064364.0, 2064496.0, 1144014.0, 2064578.0]
Doing local aggregation!
test acc on this client before 1847 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.005070
Client Index = 3	Epoch: 1	Loss: 0.020413
Client Index = 3	Epoch: 2	Loss: 0.076184
Client Index = 3	Epoch: 3	Loss: 0.077905
Client Index = 3	Epoch: 4	Loss: 0.081483
test acc on this client after 1737 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 4
local mask changes: 1144480.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2054238.0, 2061372.0, 2060900.0, 2064034.0, 1144480.0]
Doing local aggregation!
test acc on this client before 1831 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.006307
Client Index = 4	Epoch: 1	Loss: 0.028628
Client Index = 4	Epoch: 2	Loss: 0.070698
Client Index = 4	Epoch: 3	Loss: 0.078677
Client Index = 4	Epoch: 4	Loss: 0.076542
test acc on this client after 1556 / 2005 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05208544520224083}
################local_test_on_all_clients after local training in communication round: 64
{'test_acc_after': 0.8592396491400993, 'test_loss_after': 0.5470183543886117}
################local_test_on_all_clients before local training in communication round: 64
{'test_acc_before': 0.9228833439224384, 'test_loss_before': 0.3008787914049963}
################Communication round : 65
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 0
local mask changes: 1096816.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1096816.0, 2027148.0, 2023642.0, 2029728.0, 2028730.0]
Doing local aggregation!
test acc on this client before 1875 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.006620
Client Index = 0	Epoch: 1	Loss: 0.014869
Client Index = 0	Epoch: 2	Loss: 0.064216
Client Index = 0	Epoch: 3	Loss: 0.075747
Client Index = 0	Epoch: 4	Loss: 0.081221
test acc on this client after 1801 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 1
local mask changes: 1095634.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2028810.0, 1095634.0, 2036582.0, 2039610.0, 2038568.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.009878
Client Index = 1	Epoch: 1	Loss: 0.020129
Client Index = 1	Epoch: 2	Loss: 0.062387
Client Index = 1	Epoch: 3	Loss: 0.071135
Client Index = 1	Epoch: 4	Loss: 0.086631
test acc on this client after 1713 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 2
local mask changes: 1097036.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2026778.0, 2037520.0, 1097036.0, 2039226.0, 2034968.0]
Doing local aggregation!
test acc on this client before 1845 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004832
Client Index = 2	Epoch: 1	Loss: 0.015860
Client Index = 2	Epoch: 2	Loss: 0.073007
Client Index = 2	Epoch: 3	Loss: 0.070058
Client Index = 2	Epoch: 4	Loss: 0.077079
test acc on this client after 1656 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 3
local mask changes: 1096054.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2034622.0, 2044324.0, 2041718.0, 1096054.0, 2045046.0]
Doing local aggregation!
test acc on this client before 1848 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.005048
Client Index = 3	Epoch: 1	Loss: 0.026906
Client Index = 3	Epoch: 2	Loss: 0.067338
Client Index = 3	Epoch: 3	Loss: 0.074867
Client Index = 3	Epoch: 4	Loss: 0.071661
test acc on this client after 1813 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 4
local mask changes: 1095672.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2032286.0, 2039988.0, 2037924.0, 2042182.0, 1095672.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005881
Client Index = 4	Epoch: 1	Loss: 0.036050
Client Index = 4	Epoch: 2	Loss: 0.076783
Client Index = 4	Epoch: 3	Loss: 0.079603
Client Index = 4	Epoch: 4	Loss: 0.074072
test acc on this client after 1632 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05007505719571337}
################local_test_on_all_clients after local training in communication round: 65
{'test_acc_after': 0.8594264070909048, 'test_loss_after': 0.5440250808940251}
################local_test_on_all_clients before local training in communication round: 65
{'test_acc_before': 0.9260769077659756, 'test_loss_before': 0.27803518882920014}
################Communication round : 66
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 0
local mask changes: 1049672.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1049672.0, 2006070.0, 2003968.0, 2010194.0, 2008536.0]
Doing local aggregation!
test acc on this client before 1877 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003419
Client Index = 0	Epoch: 1	Loss: 0.009562
Client Index = 0	Epoch: 2	Loss: 0.076909
Client Index = 0	Epoch: 3	Loss: 0.077955
Client Index = 0	Epoch: 4	Loss: 0.083282
test acc on this client after 1796 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 1
local mask changes: 1048998.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2005216.0, 1048998.0, 2012548.0, 2017178.0, 2015192.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003593
Client Index = 1	Epoch: 1	Loss: 0.005213
Client Index = 1	Epoch: 2	Loss: 0.045008
Client Index = 1	Epoch: 3	Loss: 0.065847
Client Index = 1	Epoch: 4	Loss: 0.073317
test acc on this client after 1759 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 2
local mask changes: 1050108.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1999022.0, 2007430.0, 1050108.0, 2011842.0, 2009254.0]
Doing local aggregation!
test acc on this client before 1840 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003935
Client Index = 2	Epoch: 1	Loss: 0.024697
Client Index = 2	Epoch: 2	Loss: 0.070539
Client Index = 2	Epoch: 3	Loss: 0.070628
Client Index = 2	Epoch: 4	Loss: 0.089522
test acc on this client after 1697 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 3
local mask changes: 1048652.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2007288.0, 2013550.0, 2012468.0, 1048652.0, 2014762.0]
Doing local aggregation!
test acc on this client before 1844 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003039
Client Index = 3	Epoch: 1	Loss: 0.002581
Client Index = 3	Epoch: 2	Loss: 0.041543
Client Index = 3	Epoch: 3	Loss: 0.072158
Client Index = 3	Epoch: 4	Loss: 0.078594
test acc on this client after 1527 / 2006 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 4
local mask changes: 1049846.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [2014316.0, 2018102.0, 2017396.0, 2022764.0, 1049846.0]
Doing local aggregation!
test acc on this client before 1839 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.006967
Client Index = 4	Epoch: 1	Loss: 0.032022
Client Index = 4	Epoch: 2	Loss: 0.074337
Client Index = 4	Epoch: 3	Loss: 0.091999
Client Index = 4	Epoch: 4	Loss: 0.080660
test acc on this client after 1764 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04749293530155544}
################local_test_on_all_clients after local training in communication round: 66
{'test_acc_after': 0.85226266752734, 'test_loss_after': 0.5841207220543068}
################local_test_on_all_clients before local training in communication round: 66
{'test_acc_before': 0.9249793518065456, 'test_loss_before': 0.2931524103787018}
################Communication round : 67
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 0
local mask changes: 1002516.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1002516.0, 1985820.0, 1980788.0, 1984406.0, 1990756.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.007503
Client Index = 0	Epoch: 1	Loss: 0.045049
Client Index = 0	Epoch: 2	Loss: 0.069037
Client Index = 0	Epoch: 3	Loss: 0.073302
Client Index = 0	Epoch: 4	Loss: 0.075417
test acc on this client after 1703 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 1
local mask changes: 1002284.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1976146.0, 1002284.0, 1977570.0, 1980426.0, 1985452.0]
Doing local aggregation!
test acc on this client before 1876 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.005548
Client Index = 1	Epoch: 1	Loss: 0.027016
Client Index = 1	Epoch: 2	Loss: 0.082388
Client Index = 1	Epoch: 3	Loss: 0.070012
Client Index = 1	Epoch: 4	Loss: 0.090529
test acc on this client after 1813 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 2
local mask changes: 1003086.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1985040.0, 1991760.0, 1003086.0, 1989058.0, 1994260.0]
Doing local aggregation!
test acc on this client before 1844 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.006508
Client Index = 2	Epoch: 1	Loss: 0.039085
Client Index = 2	Epoch: 2	Loss: 0.062103
Client Index = 2	Epoch: 3	Loss: 0.084848
Client Index = 2	Epoch: 4	Loss: 0.085223
test acc on this client after 1601 / 2003 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 3
local mask changes: 1002390.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1978464.0, 1983324.0, 1978182.0, 1002390.0, 1986636.0]
Doing local aggregation!
test acc on this client before 1853 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.004627
Client Index = 3	Epoch: 1	Loss: 0.007370
Client Index = 3	Epoch: 2	Loss: 0.092660
Client Index = 3	Epoch: 3	Loss: 0.061568
Client Index = 3	Epoch: 4	Loss: 0.089138
test acc on this client after 1747 / 2006 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 4
local mask changes: 1002256.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1993292.0, 1997474.0, 1991580.0, 1995024.0, 1002256.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004655
Client Index = 4	Epoch: 1	Loss: 0.004842
Client Index = 4	Epoch: 2	Loss: 0.071016
Client Index = 4	Epoch: 3	Loss: 0.085596
Client Index = 4	Epoch: 4	Loss: 0.078132
test acc on this client after 1608 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05292685318840382}
################local_test_on_all_clients after local training in communication round: 67
{'test_acc_after': 0.845159871796396, 'test_loss_after': 0.5853161007473954}
################local_test_on_all_clients before local training in communication round: 67
{'test_acc_before': 0.9266750632747358, 'test_loss_before': 0.2771872922705628}
################Communication round : 68
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 0
local mask changes: 956092.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [956092.0, 1963410.0, 1970948.0, 1964610.0, 1975520.0]
Doing local aggregation!
test acc on this client before 1869 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.006771
Client Index = 0	Epoch: 1	Loss: 0.024381
Client Index = 0	Epoch: 2	Loss: 0.068919
Client Index = 0	Epoch: 3	Loss: 0.082400
Client Index = 0	Epoch: 4	Loss: 0.079801
test acc on this client after 1843 / 2005 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 1
local mask changes: 955494.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1962216.0, 955494.0, 1966204.0, 1959018.0, 1970748.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.005572
Client Index = 1	Epoch: 1	Loss: 0.028554
Client Index = 1	Epoch: 2	Loss: 0.078381
Client Index = 1	Epoch: 3	Loss: 0.093033
Client Index = 1	Epoch: 4	Loss: 0.088127
test acc on this client after 1636 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 2
local mask changes: 955862.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1973100.0, 1970766.0, 955862.0, 1970430.0, 1980668.0]
Doing local aggregation!
test acc on this client before 1830 / 2003 : 0.91
Client Index = 2	Epoch: 0	Loss: 0.004746
Client Index = 2	Epoch: 1	Loss: 0.038711
Client Index = 2	Epoch: 2	Loss: 0.060422
Client Index = 2	Epoch: 3	Loss: 0.073437
Client Index = 2	Epoch: 4	Loss: 0.094517
test acc on this client after 1763 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 3
local mask changes: 955492.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1962100.0, 1957364.0, 1965292.0, 955492.0, 1969900.0]
Doing local aggregation!
test acc on this client before 1858 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.008102
Client Index = 3	Epoch: 1	Loss: 0.042290
Client Index = 3	Epoch: 2	Loss: 0.070617
Client Index = 3	Epoch: 3	Loss: 0.093448
Client Index = 3	Epoch: 4	Loss: 0.080104
test acc on this client after 1788 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 4
local mask changes: 955958.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1970052.0, 1965390.0, 1971662.0, 1965818.0, 955958.0]
Doing local aggregation!
test acc on this client before 1831 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.006398
Client Index = 4	Epoch: 1	Loss: 0.044394
Client Index = 4	Epoch: 2	Loss: 0.060423
Client Index = 4	Epoch: 3	Loss: 0.085527
Client Index = 4	Epoch: 4	Loss: 0.087885
test acc on this client after 1774 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05627836326139561}
################local_test_on_all_clients after local training in communication round: 68
{'test_acc_after': 0.878291175405374, 'test_loss_after': 0.4727329412861968}
################local_test_on_all_clients before local training in communication round: 68
{'test_acc_before': 0.9238804027706076, 'test_loss_before': 0.28387039205368503}
################Communication round : 69
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 0
local mask changes: 909582.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [909582.0, 1948996.0, 1955974.0, 1948720.0, 1951274.0]
Doing local aggregation!
test acc on this client before 1877 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003953
Client Index = 0	Epoch: 1	Loss: 0.017362
Client Index = 0	Epoch: 2	Loss: 0.058839
Client Index = 0	Epoch: 3	Loss: 0.064864
Client Index = 0	Epoch: 4	Loss: 0.098643
test acc on this client after 1788 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 1
local mask changes: 909572.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1954816.0, 909572.0, 1959874.0, 1949830.0, 1955530.0]
Doing local aggregation!
test acc on this client before 1870 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003501
Client Index = 1	Epoch: 1	Loss: 0.004524
Client Index = 1	Epoch: 2	Loss: 0.037752
Client Index = 1	Epoch: 3	Loss: 0.082748
Client Index = 1	Epoch: 4	Loss: 0.073329
test acc on this client after 1829 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 2
local mask changes: 909552.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1961644.0, 1960224.0, 909552.0, 1958132.0, 1961216.0]
Doing local aggregation!
test acc on this client before 1845 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003757
Client Index = 2	Epoch: 1	Loss: 0.028599
Client Index = 2	Epoch: 2	Loss: 0.065570
Client Index = 2	Epoch: 3	Loss: 0.073890
Client Index = 2	Epoch: 4	Loss: 0.081295
test acc on this client after 1667 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 3
local mask changes: 908868.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1955522.0, 1952258.0, 1960852.0, 908868.0, 1955270.0]
Doing local aggregation!
test acc on this client before 1857 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.004957
Client Index = 3	Epoch: 1	Loss: 0.034619
Client Index = 3	Epoch: 2	Loss: 0.084791
Client Index = 3	Epoch: 3	Loss: 0.070980
Client Index = 3	Epoch: 4	Loss: 0.077755
test acc on this client after 1725 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 4
local mask changes: 909214.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1958208.0, 1954936.0, 1960652.0, 1953834.0, 909214.0]
Doing local aggregation!
test acc on this client before 1829 / 2005 : 0.91
Client Index = 4	Epoch: 0	Loss: 0.006772
Client Index = 4	Epoch: 1	Loss: 0.030758
Client Index = 4	Epoch: 2	Loss: 0.065228
Client Index = 4	Epoch: 3	Loss: 0.085056
Client Index = 4	Epoch: 4	Loss: 0.071553
test acc on this client after 1770 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.049243780899037394}
################local_test_on_all_clients after local training in communication round: 69
{'test_acc_after': 0.8757909808484639, 'test_loss_after': 0.4887995622709867}
################local_test_on_all_clients before local training in communication round: 69
{'test_acc_before': 0.9255777071135688, 'test_loss_before': 0.28222375896514534}
################Communication round : 70
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 0
local mask changes: 864256.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [864256.0, 1935090.0, 1939510.0, 1937966.0, 1937416.0]
Doing local aggregation!
test acc on this client before 1876 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003753
Client Index = 0	Epoch: 1	Loss: 0.025802
Client Index = 0	Epoch: 2	Loss: 0.069012
Client Index = 0	Epoch: 3	Loss: 0.064666
Client Index = 0	Epoch: 4	Loss: 0.081701
test acc on this client after 1778 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 1
local mask changes: 863290.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1927986.0, 863290.0, 1936050.0, 1932554.0, 1933400.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004112
Client Index = 1	Epoch: 1	Loss: 0.018042
Client Index = 1	Epoch: 2	Loss: 0.059020
Client Index = 1	Epoch: 3	Loss: 0.074177
Client Index = 1	Epoch: 4	Loss: 0.057969
test acc on this client after 1795 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 2
local mask changes: 863294.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1946296.0, 1950064.0, 863294.0, 1948868.0, 1948468.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005386
Client Index = 2	Epoch: 1	Loss: 0.022816
Client Index = 2	Epoch: 2	Loss: 0.059550
Client Index = 2	Epoch: 3	Loss: 0.091460
Client Index = 2	Epoch: 4	Loss: 0.082469
test acc on this client after 1793 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 3
local mask changes: 863132.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1940294.0, 1942180.0, 1946240.0, 863132.0, 1943666.0]
Doing local aggregation!
test acc on this client before 1848 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.006052
Client Index = 3	Epoch: 1	Loss: 0.045184
Client Index = 3	Epoch: 2	Loss: 0.059674
Client Index = 3	Epoch: 3	Loss: 0.086201
Client Index = 3	Epoch: 4	Loss: 0.080281
test acc on this client after 1787 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 4
local mask changes: 863358.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1940888.0, 1943856.0, 1946552.0, 1944656.0, 863358.0]
Doing local aggregation!
test acc on this client before 1838 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003503
Client Index = 4	Epoch: 1	Loss: 0.017170
Client Index = 4	Epoch: 2	Loss: 0.057501
Client Index = 4	Epoch: 3	Loss: 0.092007
Client Index = 4	Epoch: 4	Loss: 0.084171
test acc on this client after 1782 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05006709830091829}
################local_test_on_all_clients after local training in communication round: 70
{'test_acc_after': 0.8913615448389786, 'test_loss_after': 0.42272934457256256}
################local_test_on_all_clients before local training in communication round: 70
{'test_acc_before': 0.9248795018797924, 'test_loss_before': 0.2979447420364716}
################Communication round : 71
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 0
local mask changes: 818168.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [818168.0, 1913250.0, 1925704.0, 1922314.0, 1922030.0]
Doing local aggregation!
test acc on this client before 1864 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.004224
Client Index = 0	Epoch: 1	Loss: 0.026529
Client Index = 0	Epoch: 2	Loss: 0.072958
Client Index = 0	Epoch: 3	Loss: 0.065835
Client Index = 0	Epoch: 4	Loss: 0.068528
test acc on this client after 1826 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 1
local mask changes: 818796.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1904872.0, 818796.0, 1918320.0, 1912658.0, 1914986.0]
Doing local aggregation!
test acc on this client before 1875 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.004912
Client Index = 1	Epoch: 1	Loss: 0.040130
Client Index = 1	Epoch: 2	Loss: 0.050738
Client Index = 1	Epoch: 3	Loss: 0.088263
Client Index = 1	Epoch: 4	Loss: 0.088533
test acc on this client after 1793 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 2
local mask changes: 818396.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1926716.0, 1924878.0, 818396.0, 1932400.0, 1931904.0]
Doing local aggregation!
test acc on this client before 1854 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.003625
Client Index = 2	Epoch: 1	Loss: 0.024863
Client Index = 2	Epoch: 2	Loss: 0.070050
Client Index = 2	Epoch: 3	Loss: 0.079342
Client Index = 2	Epoch: 4	Loss: 0.091146
test acc on this client after 1778 / 2003 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 3
local mask changes: 818152.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1925922.0, 1922842.0, 1936228.0, 818152.0, 1932184.0]
Doing local aggregation!
test acc on this client before 1848 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003635
Client Index = 3	Epoch: 1	Loss: 0.015367
Client Index = 3	Epoch: 2	Loss: 0.056234
Client Index = 3	Epoch: 3	Loss: 0.082617
Client Index = 3	Epoch: 4	Loss: 0.075389
test acc on this client after 1763 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 4
local mask changes: 817552.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1921126.0, 1916586.0, 1929286.0, 1926812.0, 817552.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.005131
Client Index = 4	Epoch: 1	Loss: 0.031004
Client Index = 4	Epoch: 2	Loss: 0.057931
Client Index = 4	Epoch: 3	Loss: 0.073856
Client Index = 4	Epoch: 4	Loss: 0.084462
test acc on this client after 1598 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.050612159699168324}
################local_test_on_all_clients after local training in communication round: 71
{'test_acc_after': 0.8737053838987269, 'test_loss_after': 0.48054794987637195}
################local_test_on_all_clients before local training in communication round: 71
{'test_acc_before': 0.9261775548004115, 'test_loss_before': 0.28600567083108014}
################Communication round : 72
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 0
local mask changes: 772958.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [772958.0, 1893766.0, 1908260.0, 1908186.0, 1904886.0]
Doing local aggregation!
test acc on this client before 1878 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002906
Client Index = 0	Epoch: 1	Loss: 0.009906
Client Index = 0	Epoch: 2	Loss: 0.045408
Client Index = 0	Epoch: 3	Loss: 0.071610
Client Index = 0	Epoch: 4	Loss: 0.078788
test acc on this client after 1822 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 1
local mask changes: 772944.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1900876.0, 772944.0, 1909612.0, 1908882.0, 1904558.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004965
Client Index = 1	Epoch: 1	Loss: 0.016402
Client Index = 1	Epoch: 2	Loss: 0.052026
Client Index = 1	Epoch: 3	Loss: 0.081850
Client Index = 1	Epoch: 4	Loss: 0.087737
test acc on this client after 1771 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 2
local mask changes: 772838.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1914638.0, 1908810.0, 772838.0, 1922290.0, 1916292.0]
Doing local aggregation!
test acc on this client before 1847 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004167
Client Index = 2	Epoch: 1	Loss: 0.012797
Client Index = 2	Epoch: 2	Loss: 0.063664
Client Index = 2	Epoch: 3	Loss: 0.068113
Client Index = 2	Epoch: 4	Loss: 0.086958
test acc on this client after 1489 / 2003 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 3
local mask changes: 772348.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1906346.0, 1899584.0, 1913532.0, 772348.0, 1909418.0]
Doing local aggregation!
test acc on this client before 1857 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.005699
Client Index = 3	Epoch: 1	Loss: 0.027712
Client Index = 3	Epoch: 2	Loss: 0.063141
Client Index = 3	Epoch: 3	Loss: 0.071511
Client Index = 3	Epoch: 4	Loss: 0.083759
test acc on this client after 1762 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 4
local mask changes: 772948.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1907448.0, 1901708.0, 1914188.0, 1914018.0, 772948.0]
Doing local aggregation!
test acc on this client before 1843 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004299
Client Index = 4	Epoch: 1	Loss: 0.017109
Client Index = 4	Epoch: 2	Loss: 0.071800
Client Index = 4	Epoch: 3	Loss: 0.090337
Client Index = 4	Epoch: 4	Loss: 0.075108
test acc on this client after 1613 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.047910901608791356}
################local_test_on_all_clients after local training in communication round: 72
{'test_acc_after': 0.843651711215955, 'test_loss_after': 0.5907144571740575}
################local_test_on_all_clients before local training in communication round: 72
{'test_acc_before': 0.9273734175379571, 'test_loss_before': 0.28223510473070346}
################Communication round : 73
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 0
local mask changes: 728092.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [728092.0, 1881998.0, 1890962.0, 1883618.0, 1884796.0]
Doing local aggregation!
test acc on this client before 1886 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.006269
Client Index = 0	Epoch: 1	Loss: 0.038072
Client Index = 0	Epoch: 2	Loss: 0.067321
Client Index = 0	Epoch: 3	Loss: 0.080692
Client Index = 0	Epoch: 4	Loss: 0.075683
test acc on this client after 1838 / 2005 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 1
local mask changes: 728784.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1884432.0, 728784.0, 1895756.0, 1888782.0, 1891212.0]
Doing local aggregation!
test acc on this client before 1875 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.004553
Client Index = 1	Epoch: 1	Loss: 0.024769
Client Index = 1	Epoch: 2	Loss: 0.069726
Client Index = 1	Epoch: 3	Loss: 0.067456
Client Index = 1	Epoch: 4	Loss: 0.092849
test acc on this client after 1705 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 2
local mask changes: 727810.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1897016.0, 1896804.0, 727810.0, 1899870.0, 1899818.0]
Doing local aggregation!
test acc on this client before 1851 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004512
Client Index = 2	Epoch: 1	Loss: 0.040637
Client Index = 2	Epoch: 2	Loss: 0.056858
Client Index = 2	Epoch: 3	Loss: 0.072814
Client Index = 2	Epoch: 4	Loss: 0.087773
test acc on this client after 1588 / 2003 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 3
local mask changes: 728426.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1892518.0, 1894486.0, 1903196.0, 728426.0, 1897240.0]
Doing local aggregation!
test acc on this client before 1857 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.004512
Client Index = 3	Epoch: 1	Loss: 0.022496
Client Index = 3	Epoch: 2	Loss: 0.051713
Client Index = 3	Epoch: 3	Loss: 0.082935
Client Index = 3	Epoch: 4	Loss: 0.076002
test acc on this client after 1634 / 2006 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 4
local mask changes: 728274.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1891506.0, 1895146.0, 1902938.0, 1896748.0, 728274.0]
Doing local aggregation!
test acc on this client before 1836 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003850
Client Index = 4	Epoch: 1	Loss: 0.007725
Client Index = 4	Epoch: 2	Loss: 0.069914
Client Index = 4	Epoch: 3	Loss: 0.068292
Client Index = 4	Epoch: 4	Loss: 0.083186
test acc on this client after 1592 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.050424342625750684}
################local_test_on_all_clients after local training in communication round: 73
{'test_acc_after': 0.8336928743378197, 'test_loss_after': 0.671039976646635}
################local_test_on_all_clients before local training in communication round: 73
{'test_acc_before': 0.9282715715538161, 'test_loss_before': 0.28180172030330874}
################Communication round : 74
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 0
local mask changes: 684764.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [684764.0, 1874678.0, 1883322.0, 1879890.0, 1879516.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.007637
Client Index = 0	Epoch: 1	Loss: 0.040774
Client Index = 0	Epoch: 2	Loss: 0.061891
Client Index = 0	Epoch: 3	Loss: 0.068715
Client Index = 0	Epoch: 4	Loss: 0.073051
test acc on this client after 1695 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 1
local mask changes: 684528.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1872032.0, 684528.0, 1884134.0, 1881516.0, 1882026.0]
Doing local aggregation!
test acc on this client before 1861 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.007355
Client Index = 1	Epoch: 1	Loss: 0.043563
Client Index = 1	Epoch: 2	Loss: 0.056215
Client Index = 1	Epoch: 3	Loss: 0.076376
Client Index = 1	Epoch: 4	Loss: 0.069807
test acc on this client after 1761 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 2
local mask changes: 684380.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1879296.0, 1883596.0, 684380.0, 1889070.0, 1888250.0]
Doing local aggregation!
test acc on this client before 1834 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.005213
Client Index = 2	Epoch: 1	Loss: 0.027303
Client Index = 2	Epoch: 2	Loss: 0.065851
Client Index = 2	Epoch: 3	Loss: 0.069293
Client Index = 2	Epoch: 4	Loss: 0.085193
test acc on this client after 1793 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 3
local mask changes: 684466.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1875940.0, 1880850.0, 1889182.0, 684466.0, 1885722.0]
Doing local aggregation!
test acc on this client before 1843 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.006942
Client Index = 3	Epoch: 1	Loss: 0.026623
Client Index = 3	Epoch: 2	Loss: 0.064750
Client Index = 3	Epoch: 3	Loss: 0.077065
Client Index = 3	Epoch: 4	Loss: 0.087608
test acc on this client after 1805 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 4
local mask changes: 684670.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1873198.0, 1878528.0, 1885808.0, 1883970.0, 684670.0]
Doing local aggregation!
test acc on this client before 1840 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.007242
Client Index = 4	Epoch: 1	Loss: 0.038579
Client Index = 4	Epoch: 2	Loss: 0.067880
Client Index = 4	Epoch: 3	Loss: 0.076698
Client Index = 4	Epoch: 4	Loss: 0.078799
test acc on this client after 1628 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05161697383936761}
################local_test_on_all_clients after local training in communication round: 74
{'test_acc_after': 0.8661237420379054, 'test_loss_after': 0.5210633515072203}
################local_test_on_all_clients before local training in communication round: 74
{'test_acc_before': 0.9223852877158729, 'test_loss_before': 0.30574883032387873}
################Communication round : 75
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 0
local mask changes: 641032.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [641032.0, 1870414.0, 1877150.0, 1873584.0, 1871712.0]
Doing local aggregation!
test acc on this client before 1884 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.005093
Client Index = 0	Epoch: 1	Loss: 0.019407
Client Index = 0	Epoch: 2	Loss: 0.058575
Client Index = 0	Epoch: 3	Loss: 0.066272
Client Index = 0	Epoch: 4	Loss: 0.079572
test acc on this client after 1810 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 1
local mask changes: 641528.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1868684.0, 641528.0, 1875870.0, 1873982.0, 1871828.0]
Doing local aggregation!
test acc on this client before 1866 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003746
Client Index = 1	Epoch: 1	Loss: 0.023246
Client Index = 1	Epoch: 2	Loss: 0.060326
Client Index = 1	Epoch: 3	Loss: 0.072972
Client Index = 1	Epoch: 4	Loss: 0.075080
test acc on this client after 1787 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 2
local mask changes: 641338.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1878534.0, 1878230.0, 641338.0, 1882452.0, 1878318.0]
Doing local aggregation!
test acc on this client before 1846 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004846
Client Index = 2	Epoch: 1	Loss: 0.022400
Client Index = 2	Epoch: 2	Loss: 0.068440
Client Index = 2	Epoch: 3	Loss: 0.083081
Client Index = 2	Epoch: 4	Loss: 0.078594
test acc on this client after 1766 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 3
local mask changes: 641238.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1872944.0, 1873422.0, 1880858.0, 641238.0, 1874930.0]
Doing local aggregation!
test acc on this client before 1856 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.004638
Client Index = 3	Epoch: 1	Loss: 0.023035
Client Index = 3	Epoch: 2	Loss: 0.074830
Client Index = 3	Epoch: 3	Loss: 0.065514
Client Index = 3	Epoch: 4	Loss: 0.073356
test acc on this client after 1790 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 4
local mask changes: 640954.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1874782.0, 1874540.0, 1879906.0, 1877430.0, 640954.0]
Doing local aggregation!
test acc on this client before 1841 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004170
Client Index = 4	Epoch: 1	Loss: 0.025577
Client Index = 4	Epoch: 2	Loss: 0.067273
Client Index = 4	Epoch: 3	Loss: 0.074318
Client Index = 4	Epoch: 4	Loss: 0.069301
test acc on this client after 1794 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.048146486264054794}
################local_test_on_all_clients after local training in communication round: 75
{'test_acc_after': 0.892555713908892, 'test_loss_after': 0.4165565283716471}
################local_test_on_all_clients before local training in communication round: 75
{'test_acc_before': 0.9270741157925446, 'test_loss_before': 0.2859040796353437}
################Communication round : 76
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 0
local mask changes: 599156.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [599156.0, 1862176.0, 1870468.0, 1865840.0, 1867750.0]
Doing local aggregation!
test acc on this client before 1878 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003491
Client Index = 0	Epoch: 1	Loss: 0.012594
Client Index = 0	Epoch: 2	Loss: 0.046620
Client Index = 0	Epoch: 3	Loss: 0.070716
Client Index = 0	Epoch: 4	Loss: 0.076169
test acc on this client after 1603 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 1
local mask changes: 598798.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1859976.0, 598798.0, 1867988.0, 1863298.0, 1864458.0]
Doing local aggregation!
test acc on this client before 1888 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002859
Client Index = 1	Epoch: 1	Loss: 0.002351
Client Index = 1	Epoch: 2	Loss: 0.025830
Client Index = 1	Epoch: 3	Loss: 0.068291
Client Index = 1	Epoch: 4	Loss: 0.069186
test acc on this client after 1632 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 2
local mask changes: 598734.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1872446.0, 1871014.0, 598734.0, 1875906.0, 1873966.0]
Doing local aggregation!
test acc on this client before 1851 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004152
Client Index = 2	Epoch: 1	Loss: 0.040093
Client Index = 2	Epoch: 2	Loss: 0.048907
Client Index = 2	Epoch: 3	Loss: 0.087841
Client Index = 2	Epoch: 4	Loss: 0.084768
test acc on this client after 1555 / 2003 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 3
local mask changes: 598980.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1864410.0, 1864224.0, 1872860.0, 598980.0, 1867394.0]
Doing local aggregation!
test acc on this client before 1858 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.005246
Client Index = 3	Epoch: 1	Loss: 0.019901
Client Index = 3	Epoch: 2	Loss: 0.060625
Client Index = 3	Epoch: 3	Loss: 0.095576
Client Index = 3	Epoch: 4	Loss: 0.083537
test acc on this client after 1642 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 4
local mask changes: 598674.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1867102.0, 1866654.0, 1873176.0, 1869302.0, 598674.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004142
Client Index = 4	Epoch: 1	Loss: 0.034096
Client Index = 4	Epoch: 2	Loss: 0.073629
Client Index = 4	Epoch: 3	Loss: 0.059798
Client Index = 4	Epoch: 4	Loss: 0.076052
test acc on this client after 1794 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04625883643726856}
################local_test_on_all_clients after local training in communication round: 76
{'test_acc_after': 0.820621858017617, 'test_loss_after': 0.716695799604299}
################local_test_on_all_clients before local training in communication round: 76
{'test_acc_before': 0.9300670330496279, 'test_loss_before': 0.286112658373588}
################Communication round : 77
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 0
local mask changes: 557042.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [557042.0, 1852138.0, 1862558.0, 1854776.0, 1857492.0]
Doing local aggregation!
test acc on this client before 1876 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003583
Client Index = 0	Epoch: 1	Loss: 0.004431
Client Index = 0	Epoch: 2	Loss: 0.064893
Client Index = 0	Epoch: 3	Loss: 0.066546
Client Index = 0	Epoch: 4	Loss: 0.072170
test acc on this client after 1715 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 1
local mask changes: 557726.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1843432.0, 557726.0, 1850640.0, 1844098.0, 1845298.0]
Doing local aggregation!
test acc on this client before 1876 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.005801
Client Index = 1	Epoch: 1	Loss: 0.010317
Client Index = 1	Epoch: 2	Loss: 0.060923
Client Index = 1	Epoch: 3	Loss: 0.059609
Client Index = 1	Epoch: 4	Loss: 0.068504
test acc on this client after 1806 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 2
local mask changes: 557308.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1864606.0, 1861976.0, 557308.0, 1866610.0, 1867432.0]
Doing local aggregation!
test acc on this client before 1844 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004969
Client Index = 2	Epoch: 1	Loss: 0.005528
Client Index = 2	Epoch: 2	Loss: 0.045431
Client Index = 2	Epoch: 3	Loss: 0.064758
Client Index = 2	Epoch: 4	Loss: 0.078080
test acc on this client after 1668 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 3
local mask changes: 556948.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1862058.0, 1858750.0, 1869122.0, 556948.0, 1863734.0]
Doing local aggregation!
test acc on this client before 1860 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.003789
Client Index = 3	Epoch: 1	Loss: 0.008765
Client Index = 3	Epoch: 2	Loss: 0.042513
Client Index = 3	Epoch: 3	Loss: 0.081285
Client Index = 3	Epoch: 4	Loss: 0.092840
test acc on this client after 1794 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 4
local mask changes: 557384.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1860732.0, 1858396.0, 1867454.0, 1861150.0, 557384.0]
Doing local aggregation!
test acc on this client before 1846 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.006194
Client Index = 4	Epoch: 1	Loss: 0.035285
Client Index = 4	Epoch: 2	Loss: 0.055804
Client Index = 4	Epoch: 3	Loss: 0.085520
Client Index = 4	Epoch: 4	Loss: 0.073227
test acc on this client after 1639 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04403052915598037}
################local_test_on_all_clients after local training in communication round: 77
{'test_acc_after': 0.8601268014661869, 'test_loss_after': 0.543046266603062}
################local_test_on_all_clients before local training in communication round: 77
{'test_acc_before': 0.9279714732965407, 'test_loss_before': 0.2730117298629426}
################Communication round : 78
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 0
local mask changes: 516664.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [516664.0, 1833386.0, 1851334.0, 1847306.0, 1847422.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003115
Client Index = 0	Epoch: 1	Loss: 0.011573
Client Index = 0	Epoch: 2	Loss: 0.061817
Client Index = 0	Epoch: 3	Loss: 0.076004
Client Index = 0	Epoch: 4	Loss: 0.083393
test acc on this client after 1821 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 1
local mask changes: 516750.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1833486.0, 516750.0, 1840964.0, 1838670.0, 1837338.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003391
Client Index = 1	Epoch: 1	Loss: 0.015355
Client Index = 1	Epoch: 2	Loss: 0.064458
Client Index = 1	Epoch: 3	Loss: 0.076484
Client Index = 1	Epoch: 4	Loss: 0.094595
test acc on this client after 1656 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 2
local mask changes: 516564.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1852092.0, 1841912.0, 516564.0, 1858384.0, 1855106.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003236
Client Index = 2	Epoch: 1	Loss: 0.024476
Client Index = 2	Epoch: 2	Loss: 0.067664
Client Index = 2	Epoch: 3	Loss: 0.062876
Client Index = 2	Epoch: 4	Loss: 0.099307
test acc on this client after 1744 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 3
local mask changes: 516770.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1850166.0, 1839470.0, 1858464.0, 516770.0, 1853928.0]
Doing local aggregation!
test acc on this client before 1854 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003742
Client Index = 3	Epoch: 1	Loss: 0.018782
Client Index = 3	Epoch: 2	Loss: 0.069561
Client Index = 3	Epoch: 3	Loss: 0.064745
Client Index = 3	Epoch: 4	Loss: 0.079938
test acc on this client after 1763 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 4
local mask changes: 516874.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1856746.0, 1846170.0, 1863152.0, 1861178.0, 516874.0]
Doing local aggregation!
test acc on this client before 1837 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004107
Client Index = 4	Epoch: 1	Loss: 0.006980
Client Index = 4	Epoch: 2	Loss: 0.063112
Client Index = 4	Epoch: 3	Loss: 0.053996
Client Index = 4	Epoch: 4	Loss: 0.081095
test acc on this client after 1764 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04775210861518162}
################local_test_on_all_clients after local training in communication round: 78
{'test_acc_after': 0.8727044912227783, 'test_loss_after': 0.5029088015332384}
################local_test_on_all_clients before local training in communication round: 78
{'test_acc_before': 0.9258767097574065, 'test_loss_before': 0.28034613290099375}
################Communication round : 79
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 0
local mask changes: 477300.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [477300.0, 1827100.0, 1842818.0, 1839014.0, 1845540.0]
Doing local aggregation!
test acc on this client before 1886 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003468
Client Index = 0	Epoch: 1	Loss: 0.006566
Client Index = 0	Epoch: 2	Loss: 0.051699
Client Index = 0	Epoch: 3	Loss: 0.075423
Client Index = 0	Epoch: 4	Loss: 0.085273
test acc on this client after 1811 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 1
local mask changes: 476828.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1830950.0, 476828.0, 1837908.0, 1835082.0, 1842134.0]
Doing local aggregation!
test acc on this client before 1880 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.003875
Client Index = 1	Epoch: 1	Loss: 0.028678
Client Index = 1	Epoch: 2	Loss: 0.066297
Client Index = 1	Epoch: 3	Loss: 0.072620
Client Index = 1	Epoch: 4	Loss: 0.073203
test acc on this client after 1684 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 2
local mask changes: 477316.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1848310.0, 1839150.0, 477316.0, 1852354.0, 1856212.0]
Doing local aggregation!
test acc on this client before 1854 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.003902
Client Index = 2	Epoch: 1	Loss: 0.009643
Client Index = 2	Epoch: 2	Loss: 0.057241
Client Index = 2	Epoch: 3	Loss: 0.066553
Client Index = 2	Epoch: 4	Loss: 0.065652
test acc on this client after 1750 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 3
local mask changes: 477168.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1840224.0, 1832780.0, 1849454.0, 477168.0, 1850886.0]
Doing local aggregation!
test acc on this client before 1849 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.002750
Client Index = 3	Epoch: 1	Loss: 0.011314
Client Index = 3	Epoch: 2	Loss: 0.059478
Client Index = 3	Epoch: 3	Loss: 0.085235
Client Index = 3	Epoch: 4	Loss: 0.080303
test acc on this client after 1763 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 4
local mask changes: 476852.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1842850.0, 1836298.0, 1849770.0, 1848950.0, 476852.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002953
Client Index = 4	Epoch: 1	Loss: 0.003860
Client Index = 4	Epoch: 2	Loss: 0.041736
Client Index = 4	Epoch: 3	Loss: 0.076667
Client Index = 4	Epoch: 4	Loss: 0.076187
test acc on this client after 1699 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04442299114761171}
################local_test_on_all_clients after local training in communication round: 79
{'test_acc_after': 0.8686153132690106, 'test_loss_after': 0.5196732147705129}
################local_test_on_all_clients before local training in communication round: 79
{'test_acc_before': 0.9288707719071958, 'test_loss_before': 0.2768932530737975}
################Communication round : 80
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 0
local mask changes: 438658.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [438658.0, 1830580.0, 1845204.0, 1837340.0, 1839826.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.003719
Client Index = 0	Epoch: 1	Loss: 0.008776
Client Index = 0	Epoch: 2	Loss: 0.044265
Client Index = 0	Epoch: 3	Loss: 0.094633
Client Index = 0	Epoch: 4	Loss: 0.077791
test acc on this client after 1834 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 1
local mask changes: 438212.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1833470.0, 438212.0, 1842822.0, 1837268.0, 1840646.0]
Doing local aggregation!
test acc on this client before 1875 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002992
Client Index = 1	Epoch: 1	Loss: 0.003109
Client Index = 1	Epoch: 2	Loss: 0.040943
Client Index = 1	Epoch: 3	Loss: 0.066313
Client Index = 1	Epoch: 4	Loss: 0.082501
test acc on this client after 1781 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 2
local mask changes: 438648.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1839786.0, 1834750.0, 438648.0, 1844590.0, 1844726.0]
Doing local aggregation!
test acc on this client before 1842 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004404
Client Index = 2	Epoch: 1	Loss: 0.027278
Client Index = 2	Epoch: 2	Loss: 0.057199
Client Index = 2	Epoch: 3	Loss: 0.079139
Client Index = 2	Epoch: 4	Loss: 0.086469
test acc on this client after 1689 / 2003 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 3
local mask changes: 438340.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1840296.0, 1837716.0, 1852088.0, 438340.0, 1846472.0]
Doing local aggregation!
test acc on this client before 1854 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.002668
Client Index = 3	Epoch: 1	Loss: 0.003149
Client Index = 3	Epoch: 2	Loss: 0.044660
Client Index = 3	Epoch: 3	Loss: 0.071118
Client Index = 3	Epoch: 4	Loss: 0.069294
test acc on this client after 1814 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 4
local mask changes: 438802.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1836840.0, 1834878.0, 1846816.0, 1842516.0, 438802.0]
Doing local aggregation!
test acc on this client before 1848 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.004667
Client Index = 4	Epoch: 1	Loss: 0.036849
Client Index = 4	Epoch: 2	Loss: 0.078397
Client Index = 4	Epoch: 3	Loss: 0.066606
Client Index = 4	Epoch: 4	Loss: 0.079969
test acc on this client after 1714 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.045476293326973234}
################local_test_on_all_clients after local training in communication round: 80
{'test_acc_after': 0.8810755294918676, 'test_loss_after': 0.4524211253211039}
################local_test_on_all_clients before local training in communication round: 80
{'test_acc_before': 0.9269740662164836, 'test_loss_before': 0.2833451837623257}
################Communication round : 81
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 0
local mask changes: 401038.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [401038.0, 1832702.0, 1837296.0, 1837700.0, 1834844.0]
Doing local aggregation!
test acc on this client before 1887 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002799
Client Index = 0	Epoch: 1	Loss: 0.001694
Client Index = 0	Epoch: 2	Loss: 0.001817
Client Index = 0	Epoch: 3	Loss: 0.033336
Client Index = 0	Epoch: 4	Loss: 0.069658
test acc on this client after 1746 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 1
local mask changes: 401198.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1830270.0, 401198.0, 1833826.0, 1835710.0, 1833154.0]
Doing local aggregation!
test acc on this client before 1882 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.005540
Client Index = 1	Epoch: 1	Loss: 0.039094
Client Index = 1	Epoch: 2	Loss: 0.075985
Client Index = 1	Epoch: 3	Loss: 0.076127
Client Index = 1	Epoch: 4	Loss: 0.065818
test acc on this client after 1564 / 2005 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 2
local mask changes: 401336.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1842850.0, 1841466.0, 401336.0, 1847822.0, 1844556.0]
Doing local aggregation!
test acc on this client before 1862 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.003432
Client Index = 2	Epoch: 1	Loss: 0.022152
Client Index = 2	Epoch: 2	Loss: 0.048290
Client Index = 2	Epoch: 3	Loss: 0.073081
Client Index = 2	Epoch: 4	Loss: 0.094173
test acc on this client after 1740 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 3
local mask changes: 401256.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1833376.0, 1833366.0, 1838930.0, 401256.0, 1836638.0]
Doing local aggregation!
test acc on this client before 1853 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003919
Client Index = 3	Epoch: 1	Loss: 0.023796
Client Index = 3	Epoch: 2	Loss: 0.056372
Client Index = 3	Epoch: 3	Loss: 0.063872
Client Index = 3	Epoch: 4	Loss: 0.086514
test acc on this client after 1726 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 4
local mask changes: 401238.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1841416.0, 1842336.0, 1845244.0, 1846630.0, 401238.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.004878
Client Index = 4	Epoch: 1	Loss: 0.030975
Client Index = 4	Epoch: 2	Loss: 0.053517
Client Index = 4	Epoch: 3	Loss: 0.070936
Client Index = 4	Epoch: 4	Loss: 0.090594
test acc on this client after 1781 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04393479955769904}
################local_test_on_all_clients after local training in communication round: 81
{'test_acc_after': 0.8536535636075181, 'test_loss_after': 0.5917274036724702}
################local_test_on_all_clients before local training in communication round: 81
{'test_acc_before': 0.9323626416328843, 'test_loss_before': 0.26936836971500877}
################Communication round : 82
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 0
local mask changes: 365048.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [365048.0, 1813242.0, 1824538.0, 1814074.0, 1823600.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.004529
Client Index = 0	Epoch: 1	Loss: 0.018900
Client Index = 0	Epoch: 2	Loss: 0.068102
Client Index = 0	Epoch: 3	Loss: 0.061884
Client Index = 0	Epoch: 4	Loss: 0.082772
test acc on this client after 1660 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 1
local mask changes: 365316.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1833536.0, 365316.0, 1841670.0, 1834384.0, 1841786.0]
Doing local aggregation!
test acc on this client before 1870 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003224
Client Index = 1	Epoch: 1	Loss: 0.016292
Client Index = 1	Epoch: 2	Loss: 0.058550
Client Index = 1	Epoch: 3	Loss: 0.084426
Client Index = 1	Epoch: 4	Loss: 0.075106
test acc on this client after 1772 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 2
local mask changes: 365460.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1844264.0, 1841086.0, 365460.0, 1844704.0, 1851086.0]
Doing local aggregation!
test acc on this client before 1859 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.003425
Client Index = 2	Epoch: 1	Loss: 0.022565
Client Index = 2	Epoch: 2	Loss: 0.068445
Client Index = 2	Epoch: 3	Loss: 0.081120
Client Index = 2	Epoch: 4	Loss: 0.069410
test acc on this client after 1658 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 3
local mask changes: 365480.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1836210.0, 1833660.0, 1846124.0, 365480.0, 1843384.0]
Doing local aggregation!
test acc on this client before 1846 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.010602
Client Index = 3	Epoch: 1	Loss: 0.043403
Client Index = 3	Epoch: 2	Loss: 0.074288
Client Index = 3	Epoch: 3	Loss: 0.085351
Client Index = 3	Epoch: 4	Loss: 0.077769
test acc on this client after 1636 / 2006 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 4
local mask changes: 365456.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1842880.0, 1841440.0, 1851008.0, 1843782.0, 365456.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.006041
Client Index = 4	Epoch: 1	Loss: 0.032076
Client Index = 4	Epoch: 2	Loss: 0.073925
Client Index = 4	Epoch: 3	Loss: 0.094960
Client Index = 4	Epoch: 4	Loss: 0.073124
test acc on this client after 1752 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.05161163934639522}
################local_test_on_all_clients after local training in communication round: 82
{'test_acc_after': 0.8457695724074746, 'test_loss_after': 0.6187284091110928}
################local_test_on_all_clients before local training in communication round: 82
{'test_acc_before': 0.928372665974497, 'test_loss_before': 0.27613855464921394}
################Communication round : 83
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 0
local mask changes: 330386.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [330386.0, 1824230.0, 1833212.0, 1825078.0, 1831220.0]
Doing local aggregation!
test acc on this client before 1873 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.005239
Client Index = 0	Epoch: 1	Loss: 0.036215
Client Index = 0	Epoch: 2	Loss: 0.066544
Client Index = 0	Epoch: 3	Loss: 0.078460
Client Index = 0	Epoch: 4	Loss: 0.080972
test acc on this client after 1812 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 1
local mask changes: 330136.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1821300.0, 330136.0, 1844898.0, 1838874.0, 1845162.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.009098
Client Index = 1	Epoch: 1	Loss: 0.030981
Client Index = 1	Epoch: 2	Loss: 0.055387
Client Index = 1	Epoch: 3	Loss: 0.074442
Client Index = 1	Epoch: 4	Loss: 0.074754
test acc on this client after 1539 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 2
local mask changes: 330236.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1832430.0, 1846998.0, 330236.0, 1850656.0, 1855492.0]
Doing local aggregation!
test acc on this client before 1853 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.003096
Client Index = 2	Epoch: 1	Loss: 0.005223
Client Index = 2	Epoch: 2	Loss: 0.042961
Client Index = 2	Epoch: 3	Loss: 0.057211
Client Index = 2	Epoch: 4	Loss: 0.071278
test acc on this client after 1704 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 3
local mask changes: 330370.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1829604.0, 1845610.0, 1854740.0, 330370.0, 1853834.0]
Doing local aggregation!
test acc on this client before 1847 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003211
Client Index = 3	Epoch: 1	Loss: 0.007306
Client Index = 3	Epoch: 2	Loss: 0.048328
Client Index = 3	Epoch: 3	Loss: 0.080677
Client Index = 3	Epoch: 4	Loss: 0.074369
test acc on this client after 1792 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 4
local mask changes: 330044.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1834246.0, 1849380.0, 1858264.0, 1852508.0, 330044.0]
Doing local aggregation!
test acc on this client before 1852 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003797
Client Index = 4	Epoch: 1	Loss: 0.008106
Client Index = 4	Epoch: 2	Loss: 0.058456
Client Index = 4	Epoch: 3	Loss: 0.077830
Client Index = 4	Epoch: 4	Loss: 0.063342
test acc on this client after 1645 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04469140404402944}
################local_test_on_all_clients after local training in communication round: 83
{'test_acc_after': 0.8471629055150499, 'test_loss_after': 0.6397465442135829}
################local_test_on_all_clients before local training in communication round: 83
{'test_acc_before': 0.9270752605362957, 'test_loss_before': 0.2876241973351784}
################Communication round : 84
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 0
local mask changes: 296950.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [296950.0, 1835160.0, 1844872.0, 1841996.0, 1845024.0]
Doing local aggregation!
test acc on this client before 1874 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.002919
Client Index = 0	Epoch: 1	Loss: 0.012208
Client Index = 0	Epoch: 2	Loss: 0.060908
Client Index = 0	Epoch: 3	Loss: 0.074092
Client Index = 0	Epoch: 4	Loss: 0.077747
test acc on this client after 1833 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 1
local mask changes: 296706.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1834024.0, 296706.0, 1852054.0, 1850306.0, 1853478.0]
Doing local aggregation!
test acc on this client before 1867 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004366
Client Index = 1	Epoch: 1	Loss: 0.027224
Client Index = 1	Epoch: 2	Loss: 0.072851
Client Index = 1	Epoch: 3	Loss: 0.058671
Client Index = 1	Epoch: 4	Loss: 0.076081
test acc on this client after 1553 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 2
local mask changes: 296560.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1837300.0, 1846432.0, 296560.0, 1855088.0, 1857128.0]
Doing local aggregation!
test acc on this client before 1842 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.002579
Client Index = 2	Epoch: 1	Loss: 0.017912
Client Index = 2	Epoch: 2	Loss: 0.059453
Client Index = 2	Epoch: 3	Loss: 0.069223
Client Index = 2	Epoch: 4	Loss: 0.089089
test acc on this client after 1639 / 2003 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 3
local mask changes: 296810.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1837104.0, 1847140.0, 1857466.0, 296810.0, 1858928.0]
Doing local aggregation!
test acc on this client before 1841 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.002928
Client Index = 3	Epoch: 1	Loss: 0.005920
Client Index = 3	Epoch: 2	Loss: 0.060310
Client Index = 3	Epoch: 3	Loss: 0.056440
Client Index = 3	Epoch: 4	Loss: 0.068412
test acc on this client after 1592 / 2006 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 4
local mask changes: 296806.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1839728.0, 1850472.0, 1860244.0, 1858638.0, 296806.0]
Doing local aggregation!
test acc on this client before 1838 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002814
Client Index = 4	Epoch: 1	Loss: 0.001959
Client Index = 4	Epoch: 2	Loss: 0.037710
Client Index = 4	Epoch: 3	Loss: 0.059512
Client Index = 4	Epoch: 4	Loss: 0.080911
test acc on this client after 1788 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04328966887462267}
################local_test_on_all_clients after local training in communication round: 84
{'test_acc_after': 0.8384880724229081, 'test_loss_after': 0.6696920947173408}
################local_test_on_all_clients before local training in communication round: 84
{'test_acc_before': 0.9239821939529748, 'test_loss_before': 0.2979648388043712}
################Communication round : 85
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 0
local mask changes: 264844.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [264844.0, 1845464.0, 1848168.0, 1848178.0, 1850460.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.005245
Client Index = 0	Epoch: 1	Loss: 0.030942
Client Index = 0	Epoch: 2	Loss: 0.056590
Client Index = 0	Epoch: 3	Loss: 0.064772
Client Index = 0	Epoch: 4	Loss: 0.081265
test acc on this client after 1777 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 1
local mask changes: 264858.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1845984.0, 264858.0, 1854356.0, 1854746.0, 1856692.0]
Doing local aggregation!
test acc on this client before 1874 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.004999
Client Index = 1	Epoch: 1	Loss: 0.026759
Client Index = 1	Epoch: 2	Loss: 0.064183
Client Index = 1	Epoch: 3	Loss: 0.073247
Client Index = 1	Epoch: 4	Loss: 0.082112
test acc on this client after 1558 / 2005 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 2
local mask changes: 264768.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1847294.0, 1853410.0, 264768.0, 1857524.0, 1859306.0]
Doing local aggregation!
test acc on this client before 1852 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003685
Client Index = 2	Epoch: 1	Loss: 0.014235
Client Index = 2	Epoch: 2	Loss: 0.047158
Client Index = 2	Epoch: 3	Loss: 0.065307
Client Index = 2	Epoch: 4	Loss: 0.081176
test acc on this client after 1748 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 3
local mask changes: 264938.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1845008.0, 1852038.0, 1856218.0, 264938.0, 1858778.0]
Doing local aggregation!
test acc on this client before 1839 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003198
Client Index = 3	Epoch: 1	Loss: 0.019376
Client Index = 3	Epoch: 2	Loss: 0.061393
Client Index = 3	Epoch: 3	Loss: 0.069756
Client Index = 3	Epoch: 4	Loss: 0.079416
test acc on this client after 1785 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 4
local mask changes: 264974.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1844792.0, 1851898.0, 1854434.0, 1856170.0, 264974.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002799
Client Index = 4	Epoch: 1	Loss: 0.016401
Client Index = 4	Epoch: 2	Loss: 0.056170
Client Index = 4	Epoch: 3	Loss: 0.077311
Client Index = 4	Epoch: 4	Loss: 0.091184
test acc on this client after 1674 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04714708113523761}
################local_test_on_all_clients after local training in communication round: 85
{'test_acc_after': 0.852155167223804, 'test_loss_after': 0.6058224928151044}
################local_test_on_all_clients before local training in communication round: 85
{'test_acc_before': 0.9265768056269337, 'test_loss_before': 0.2835632650110105}
################Communication round : 86
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 0
local mask changes: 234488.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [234488.0, 1855442.0, 1856294.0, 1853878.0, 1854010.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.002492
Client Index = 0	Epoch: 1	Loss: 0.002330
Client Index = 0	Epoch: 2	Loss: 0.029432
Client Index = 0	Epoch: 3	Loss: 0.071530
Client Index = 0	Epoch: 4	Loss: 0.063103
test acc on this client after 1680 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 1
local mask changes: 234310.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1856510.0, 234310.0, 1863454.0, 1861472.0, 1861478.0]
Doing local aggregation!
test acc on this client before 1859 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.002920
Client Index = 1	Epoch: 1	Loss: 0.007934
Client Index = 1	Epoch: 2	Loss: 0.043841
Client Index = 1	Epoch: 3	Loss: 0.051589
Client Index = 1	Epoch: 4	Loss: 0.064287
test acc on this client after 1514 / 2005 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 2
local mask changes: 234440.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1853868.0, 1860226.0, 234440.0, 1861018.0, 1859612.0]
Doing local aggregation!
test acc on this client before 1843 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003500
Client Index = 2	Epoch: 1	Loss: 0.005202
Client Index = 2	Epoch: 2	Loss: 0.036191
Client Index = 2	Epoch: 3	Loss: 0.081805
Client Index = 2	Epoch: 4	Loss: 0.078151
test acc on this client after 1699 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 3
local mask changes: 234368.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1854440.0, 1859708.0, 1861894.0, 234368.0, 1860116.0]
Doing local aggregation!
test acc on this client before 1845 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.004413
Client Index = 3	Epoch: 1	Loss: 0.016362
Client Index = 3	Epoch: 2	Loss: 0.064359
Client Index = 3	Epoch: 3	Loss: 0.072176
Client Index = 3	Epoch: 4	Loss: 0.083346
test acc on this client after 1664 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 4
local mask changes: 234158.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1855106.0, 1860474.0, 1862604.0, 1861660.0, 234158.0]
Doing local aggregation!
test acc on this client before 1840 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003002
Client Index = 4	Epoch: 1	Loss: 0.003832
Client Index = 4	Epoch: 2	Loss: 0.053457
Client Index = 4	Epoch: 3	Loss: 0.061189
Client Index = 4	Epoch: 4	Loss: 0.082943
test acc on this client after 1751 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.03957538921333735}
################local_test_on_all_clients after local training in communication round: 86
{'test_acc_after': 0.8288146577407902, 'test_loss_after': 0.6861680196190166}
################local_test_on_all_clients before local training in communication round: 86
{'test_acc_before': 0.9236828427793388, 'test_loss_before': 0.29466792061901403}
################Communication round : 87
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 0
local mask changes: 205456.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [205456.0, 1862710.0, 1860448.0, 1860562.0, 1860762.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 0	Epoch: 0	Loss: 0.004860
Client Index = 0	Epoch: 1	Loss: 0.009109
Client Index = 0	Epoch: 2	Loss: 0.071077
Client Index = 0	Epoch: 3	Loss: 0.075392
Client Index = 0	Epoch: 4	Loss: 0.089207
test acc on this client after 1656 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 1
local mask changes: 205322.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1861938.0, 205322.0, 1866728.0, 1865052.0, 1866938.0]
Doing local aggregation!
test acc on this client before 1868 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.002835
Client Index = 1	Epoch: 1	Loss: 0.002316
Client Index = 1	Epoch: 2	Loss: 0.038713
Client Index = 1	Epoch: 3	Loss: 0.066199
Client Index = 1	Epoch: 4	Loss: 0.090509
test acc on this client after 1733 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 2
local mask changes: 205420.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1863408.0, 1868958.0, 205420.0, 1867692.0, 1868826.0]
Doing local aggregation!
test acc on this client before 1836 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004002
Client Index = 2	Epoch: 1	Loss: 0.014968
Client Index = 2	Epoch: 2	Loss: 0.062853
Client Index = 2	Epoch: 3	Loss: 0.074607
Client Index = 2	Epoch: 4	Loss: 0.075958
test acc on this client after 1718 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 3
local mask changes: 205578.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1865358.0, 1870810.0, 1869804.0, 205578.0, 1870624.0]
Doing local aggregation!
test acc on this client before 1843 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.002791
Client Index = 3	Epoch: 1	Loss: 0.002295
Client Index = 3	Epoch: 2	Loss: 0.010241
Client Index = 3	Epoch: 3	Loss: 0.070527
Client Index = 3	Epoch: 4	Loss: 0.078258
test acc on this client after 1807 / 2006 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 4
local mask changes: 205332.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1863266.0, 1870134.0, 1868822.0, 1869164.0, 205332.0]
Doing local aggregation!
test acc on this client before 1844 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003751
Client Index = 4	Epoch: 1	Loss: 0.007112
Client Index = 4	Epoch: 2	Loss: 0.061815
Client Index = 4	Epoch: 3	Loss: 0.064825
Client Index = 4	Epoch: 4	Loss: 0.082756
test acc on this client after 1802 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04267902961553179}
################local_test_on_all_clients after local training in communication round: 87
{'test_acc_after': 0.8695076936910257, 'test_loss_after': 0.5069097877695834}
################local_test_on_all_clients before local training in communication round: 87
{'test_acc_before': 0.9239814968933786, 'test_loss_before': 0.2863254918865049}
################Communication round : 88
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 0
local mask changes: 178230.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [178230.0, 1868516.0, 1870560.0, 1871860.0, 1869628.0]
Doing local aggregation!
test acc on this client before 1886 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002749
Client Index = 0	Epoch: 1	Loss: 0.001924
Client Index = 0	Epoch: 2	Loss: 0.010030
Client Index = 0	Epoch: 3	Loss: 0.075601
Client Index = 0	Epoch: 4	Loss: 0.087487
test acc on this client after 1737 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 1
local mask changes: 178240.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1867166.0, 178240.0, 1872348.0, 1873574.0, 1873186.0]
Doing local aggregation!
test acc on this client before 1887 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002682
Client Index = 1	Epoch: 1	Loss: 0.004352
Client Index = 1	Epoch: 2	Loss: 0.040568
Client Index = 1	Epoch: 3	Loss: 0.072174
Client Index = 1	Epoch: 4	Loss: 0.072699
test acc on this client after 1811 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 2
local mask changes: 178232.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1869336.0, 1873814.0, 178232.0, 1877120.0, 1876078.0]
Doing local aggregation!
test acc on this client before 1848 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.002827
Client Index = 2	Epoch: 1	Loss: 0.002886
Client Index = 2	Epoch: 2	Loss: 0.036224
Client Index = 2	Epoch: 3	Loss: 0.073756
Client Index = 2	Epoch: 4	Loss: 0.073726
test acc on this client after 1695 / 2003 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 3
local mask changes: 178202.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1866888.0, 1870818.0, 1872964.0, 178202.0, 1873602.0]
Doing local aggregation!
test acc on this client before 1855 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003621
Client Index = 3	Epoch: 1	Loss: 0.004197
Client Index = 3	Epoch: 2	Loss: 0.049308
Client Index = 3	Epoch: 3	Loss: 0.074046
Client Index = 3	Epoch: 4	Loss: 0.091912
test acc on this client after 1794 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 4
local mask changes: 178200.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1869242.0, 1874542.0, 1876646.0, 1878432.0, 178200.0]
Doing local aggregation!
test acc on this client before 1857 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.004378
Client Index = 4	Epoch: 1	Loss: 0.004332
Client Index = 4	Epoch: 2	Loss: 0.045801
Client Index = 4	Epoch: 3	Loss: 0.067579
Client Index = 4	Epoch: 4	Loss: 0.086183
test acc on this client after 1785 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.03964169004017355}
################local_test_on_all_clients after local training in communication round: 88
{'test_acc_after': 0.8800796153874497, 'test_loss_after': 0.4719637316092878}
################local_test_on_all_clients before local training in communication round: 88
{'test_acc_before': 0.931064389658777, 'test_loss_before': 0.2578940098083907}
################Communication round : 89
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 0
local mask changes: 152556.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [152556.0, 1875166.0, 1877552.0, 1874116.0, 1876544.0]
Doing local aggregation!
test acc on this client before 1882 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002730
Client Index = 0	Epoch: 1	Loss: 0.003117
Client Index = 0	Epoch: 2	Loss: 0.050858
Client Index = 0	Epoch: 3	Loss: 0.070729
Client Index = 0	Epoch: 4	Loss: 0.078923
test acc on this client after 1815 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 1
local mask changes: 152752.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1875532.0, 152752.0, 1879598.0, 1876994.0, 1880432.0]
Doing local aggregation!
test acc on this client before 1876 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.004445
Client Index = 1	Epoch: 1	Loss: 0.019936
Client Index = 1	Epoch: 2	Loss: 0.060616
Client Index = 1	Epoch: 3	Loss: 0.077453
Client Index = 1	Epoch: 4	Loss: 0.081733
test acc on this client after 1650 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 2
local mask changes: 152734.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1877756.0, 1879568.0, 152734.0, 1879998.0, 1883190.0]
Doing local aggregation!
test acc on this client before 1845 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003000
Client Index = 2	Epoch: 1	Loss: 0.018029
Client Index = 2	Epoch: 2	Loss: 0.067499
Client Index = 2	Epoch: 3	Loss: 0.092068
Client Index = 2	Epoch: 4	Loss: 0.095395
test acc on this client after 1722 / 2003 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 3
local mask changes: 152808.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1877090.0, 1879160.0, 1882456.0, 152808.0, 1883236.0]
Doing local aggregation!
test acc on this client before 1861 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.003017
Client Index = 3	Epoch: 1	Loss: 0.007687
Client Index = 3	Epoch: 2	Loss: 0.054068
Client Index = 3	Epoch: 3	Loss: 0.073117
Client Index = 3	Epoch: 4	Loss: 0.090099
test acc on this client after 1583 / 2006 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 4
local mask changes: 152568.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1878848.0, 1881650.0, 1884532.0, 1882016.0, 152568.0]
Doing local aggregation!
test acc on this client before 1855 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.002929
Client Index = 4	Epoch: 1	Loss: 0.020011
Client Index = 4	Epoch: 2	Loss: 0.074811
Client Index = 4	Epoch: 3	Loss: 0.082031
Client Index = 4	Epoch: 4	Loss: 0.077244
test acc on this client after 1693 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04846181895463889}
################local_test_on_all_clients after local training in communication round: 89
{'test_acc_after': 0.8442823230191026, 'test_loss_after': 0.6160440883054015}
################local_test_on_all_clients before local training in communication round: 89
{'test_acc_before': 0.9296672837701327, 'test_loss_before': 0.28032852454223545}
################Communication round : 90
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 0
local mask changes: 128934.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [128934.0, 1882690.0, 1884624.0, 1883904.0, 1885580.0]
Doing local aggregation!
test acc on this client before 1895 / 2005 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.003725
Client Index = 0	Epoch: 1	Loss: 0.003851
Client Index = 0	Epoch: 2	Loss: 0.043679
Client Index = 0	Epoch: 3	Loss: 0.075838
Client Index = 0	Epoch: 4	Loss: 0.098950
test acc on this client after 1846 / 2005 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 1
local mask changes: 128978.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1884130.0, 128978.0, 1889012.0, 1887940.0, 1890004.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.002673
Client Index = 1	Epoch: 1	Loss: 0.002732
Client Index = 1	Epoch: 2	Loss: 0.035160
Client Index = 1	Epoch: 3	Loss: 0.074412
Client Index = 1	Epoch: 4	Loss: 0.079768
test acc on this client after 1801 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 2
local mask changes: 128876.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1887474.0, 1890110.0, 128876.0, 1892578.0, 1894600.0]
Doing local aggregation!
test acc on this client before 1847 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003647
Client Index = 2	Epoch: 1	Loss: 0.009710
Client Index = 2	Epoch: 2	Loss: 0.058781
Client Index = 2	Epoch: 3	Loss: 0.073516
Client Index = 2	Epoch: 4	Loss: 0.079685
test acc on this client after 1811 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 3
local mask changes: 128916.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1885378.0, 1888714.0, 1891376.0, 128916.0, 1892722.0]
Doing local aggregation!
test acc on this client before 1871 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.003229
Client Index = 3	Epoch: 1	Loss: 0.002305
Client Index = 3	Epoch: 2	Loss: 0.022739
Client Index = 3	Epoch: 3	Loss: 0.064985
Client Index = 3	Epoch: 4	Loss: 0.081729
test acc on this client after 1680 / 2006 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 4
local mask changes: 128998.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1886744.0, 1890570.0, 1893548.0, 1893166.0, 128998.0]
Doing local aggregation!
test acc on this client before 1849 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002624
Client Index = 4	Epoch: 1	Loss: 0.001595
Client Index = 4	Epoch: 2	Loss: 0.021974
Client Index = 4	Epoch: 3	Loss: 0.060495
Client Index = 4	Epoch: 4	Loss: 0.098305
test acc on this client after 1805 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.0402442574170323}
################local_test_on_all_clients after local training in communication round: 90
{'test_acc_after': 0.8921666633447641, 'test_loss_after': 0.41300886953582994}
################local_test_on_all_clients before local training in communication round: 90
{'test_acc_before': 0.9311632450628637, 'test_loss_before': 0.2603704315843961}
################Communication round : 91
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 0
local mask changes: 106948.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [106948.0, 1895466.0, 1898306.0, 1895800.0, 1897476.0]
Doing local aggregation!
test acc on this client before 1892 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003269
Client Index = 0	Epoch: 1	Loss: 0.009124
Client Index = 0	Epoch: 2	Loss: 0.058756
Client Index = 0	Epoch: 3	Loss: 0.072021
Client Index = 0	Epoch: 4	Loss: 0.078005
test acc on this client after 1796 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 1
local mask changes: 107198.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1892666.0, 107198.0, 1899834.0, 1898018.0, 1900116.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002682
Client Index = 1	Epoch: 1	Loss: 0.009468
Client Index = 1	Epoch: 2	Loss: 0.056984
Client Index = 1	Epoch: 3	Loss: 0.077412
Client Index = 1	Epoch: 4	Loss: 0.085030
test acc on this client after 1658 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 2
local mask changes: 107114.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1897854.0, 1902076.0, 107114.0, 1904494.0, 1905856.0]
Doing local aggregation!
test acc on this client before 1852 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.002372
Client Index = 2	Epoch: 1	Loss: 0.018287
Client Index = 2	Epoch: 2	Loss: 0.056092
Client Index = 2	Epoch: 3	Loss: 0.076636
Client Index = 2	Epoch: 4	Loss: 0.099499
test acc on this client after 1674 / 2003 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 3
local mask changes: 107052.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1894052.0, 1898180.0, 1902396.0, 107052.0, 1902438.0]
Doing local aggregation!
test acc on this client before 1862 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.004060
Client Index = 3	Epoch: 1	Loss: 0.011518
Client Index = 3	Epoch: 2	Loss: 0.053766
Client Index = 3	Epoch: 3	Loss: 0.077305
Client Index = 3	Epoch: 4	Loss: 0.086295
test acc on this client after 1760 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 4
local mask changes: 106998.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1895106.0, 1899988.0, 1904568.0, 1902886.0, 106998.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003240
Client Index = 4	Epoch: 1	Loss: 0.024672
Client Index = 4	Epoch: 2	Loss: 0.047027
Client Index = 4	Epoch: 3	Loss: 0.090815
Client Index = 4	Epoch: 4	Loss: 0.082337
test acc on this client after 1740 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.047466925531530715}
################local_test_on_all_clients after local training in communication round: 91
{'test_acc_after': 0.860727593502698, 'test_loss_after': 0.5266082798976296}
################local_test_on_all_clients before local training in communication round: 91
{'test_acc_before': 0.9314634424744959, 'test_loss_before': 0.2603586876981407}
################Communication round : 92
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 0
local mask changes: 87128.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [87128.0, 1904006.0, 1908928.0, 1904650.0, 1905658.0]
Doing local aggregation!
test acc on this client before 1889 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.003941
Client Index = 0	Epoch: 1	Loss: 0.013183
Client Index = 0	Epoch: 2	Loss: 0.049914
Client Index = 0	Epoch: 3	Loss: 0.088012
Client Index = 0	Epoch: 4	Loss: 0.075407
test acc on this client after 1768 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 1
local mask changes: 87168.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1904490.0, 87168.0, 1910832.0, 1907062.0, 1909482.0]
Doing local aggregation!
test acc on this client before 1871 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.002992
Client Index = 1	Epoch: 1	Loss: 0.002509
Client Index = 1	Epoch: 2	Loss: 0.009495
Client Index = 1	Epoch: 3	Loss: 0.084235
Client Index = 1	Epoch: 4	Loss: 0.058976
test acc on this client after 1742 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 2
local mask changes: 87038.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1909884.0, 1911938.0, 87038.0, 1914248.0, 1915502.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.002901
Client Index = 2	Epoch: 1	Loss: 0.002715
Client Index = 2	Epoch: 2	Loss: 0.051375
Client Index = 2	Epoch: 3	Loss: 0.062070
Client Index = 2	Epoch: 4	Loss: 0.080413
test acc on this client after 1770 / 2003 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 3
local mask changes: 87052.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1904700.0, 1906538.0, 1913142.0, 87052.0, 1911232.0]
Doing local aggregation!
test acc on this client before 1865 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.002779
Client Index = 3	Epoch: 1	Loss: 0.006034
Client Index = 3	Epoch: 2	Loss: 0.059788
Client Index = 3	Epoch: 3	Loss: 0.071602
Client Index = 3	Epoch: 4	Loss: 0.076671
test acc on this client after 1790 / 2006 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 4
local mask changes: 87128.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1906548.0, 1909444.0, 1915170.0, 1912032.0, 87128.0]
Doing local aggregation!
test acc on this client before 1863 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.003015
Client Index = 4	Epoch: 1	Loss: 0.017887
Client Index = 4	Epoch: 2	Loss: 0.055319
Client Index = 4	Epoch: 3	Loss: 0.074774
Client Index = 4	Epoch: 4	Loss: 0.080067
test acc on this client after 1758 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04144284862483262}
################local_test_on_all_clients after local training in communication round: 92
{'test_acc_after': 0.8806857881242521, 'test_loss_after': 0.4648622832187149}
################local_test_on_all_clients before local training in communication round: 92
{'test_acc_before': 0.9306641926951269, 'test_loss_before': 0.25695517477891294}
################Communication round : 93
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 0
local mask changes: 69076.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [69076.0, 1914838.0, 1920102.0, 1915084.0, 1916316.0]
Doing local aggregation!
test acc on this client before 1895 / 2005 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.002873
Client Index = 0	Epoch: 1	Loss: 0.016183
Client Index = 0	Epoch: 2	Loss: 0.070540
Client Index = 0	Epoch: 3	Loss: 0.071235
Client Index = 0	Epoch: 4	Loss: 0.074034
test acc on this client after 1621 / 2005 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 1
local mask changes: 69074.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1912926.0, 69074.0, 1920186.0, 1914608.0, 1918080.0]
Doing local aggregation!
test acc on this client before 1890 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002854
Client Index = 1	Epoch: 1	Loss: 0.008567
Client Index = 1	Epoch: 2	Loss: 0.051664
Client Index = 1	Epoch: 3	Loss: 0.066822
Client Index = 1	Epoch: 4	Loss: 0.080320
test acc on this client after 1780 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 2
local mask changes: 69110.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1918938.0, 1921298.0, 69110.0, 1923140.0, 1924712.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.004936
Client Index = 2	Epoch: 1	Loss: 0.021312
Client Index = 2	Epoch: 2	Loss: 0.060263
Client Index = 2	Epoch: 3	Loss: 0.078643
Client Index = 2	Epoch: 4	Loss: 0.076055
test acc on this client after 1794 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 3
local mask changes: 69200.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1914504.0, 1916522.0, 1923902.0, 69200.0, 1921532.0]
Doing local aggregation!
test acc on this client before 1858 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.002880
Client Index = 3	Epoch: 1	Loss: 0.015429
Client Index = 3	Epoch: 2	Loss: 0.058750
Client Index = 3	Epoch: 3	Loss: 0.083412
Client Index = 3	Epoch: 4	Loss: 0.076434
test acc on this client after 1674 / 2006 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 4
local mask changes: 69074.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1916454.0, 1919762.0, 1925918.0, 1921992.0, 69074.0]
Doing local aggregation!
test acc on this client before 1850 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.003478
Client Index = 4	Epoch: 1	Loss: 0.011347
Client Index = 4	Epoch: 2	Loss: 0.059531
Client Index = 4	Epoch: 3	Loss: 0.078730
Client Index = 4	Epoch: 4	Loss: 0.079645
test acc on this client after 1580 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04623742370525308}
################local_test_on_all_clients after local training in communication round: 93
{'test_acc_after': 0.8428884605007466, 'test_loss_after': 0.6325850681992874}
################local_test_on_all_clients before local training in communication round: 93
{'test_acc_before': 0.9311632938952673, 'test_loss_before': 0.2720034223705975}
################Communication round : 94
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 0
local mask changes: 53124.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [53124.0, 1923886.0, 1928666.0, 1924708.0, 1926456.0]
Doing local aggregation!
test acc on this client before 1895 / 2005 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.002299
Client Index = 0	Epoch: 1	Loss: 0.002449
Client Index = 0	Epoch: 2	Loss: 0.022128
Client Index = 0	Epoch: 3	Loss: 0.078323
Client Index = 0	Epoch: 4	Loss: 0.066228
test acc on this client after 1709 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 1
local mask changes: 53106.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1922322.0, 53106.0, 1928248.0, 1923002.0, 1926826.0]
Doing local aggregation!
test acc on this client before 1887 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.003054
Client Index = 1	Epoch: 1	Loss: 0.002736
Client Index = 1	Epoch: 2	Loss: 0.032314
Client Index = 1	Epoch: 3	Loss: 0.074101
Client Index = 1	Epoch: 4	Loss: 0.076499
test acc on this client after 1673 / 2005 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 2
local mask changes: 53082.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1928410.0, 1929026.0, 53082.0, 1932286.0, 1934206.0]
Doing local aggregation!
test acc on this client before 1852 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003544
Client Index = 2	Epoch: 1	Loss: 0.014253
Client Index = 2	Epoch: 2	Loss: 0.054118
Client Index = 2	Epoch: 3	Loss: 0.069515
Client Index = 2	Epoch: 4	Loss: 0.083001
test acc on this client after 1627 / 2003 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 3
local mask changes: 53036.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1924282.0, 1924028.0, 1931760.0, 53036.0, 1930628.0]
Doing local aggregation!
test acc on this client before 1866 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.002677
Client Index = 3	Epoch: 1	Loss: 0.017757
Client Index = 3	Epoch: 2	Loss: 0.061253
Client Index = 3	Epoch: 3	Loss: 0.072474
Client Index = 3	Epoch: 4	Loss: 0.099295
test acc on this client after 1722 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 4
local mask changes: 53094.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1926034.0, 1927726.0, 1934274.0, 1931048.0, 53094.0]
Doing local aggregation!
test acc on this client before 1859 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.002592
Client Index = 4	Epoch: 1	Loss: 0.002394
Client Index = 4	Epoch: 2	Loss: 0.027660
Client Index = 4	Epoch: 3	Loss: 0.068016
Client Index = 4	Epoch: 4	Loss: 0.087413
test acc on this client after 1801 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04104378233182633}
################local_test_on_all_clients after local training in communication round: 94
{'test_acc_after': 0.8511487419879746, 'test_loss_after': 0.5966136651457588}
################local_test_on_all_clients before local training in communication round: 94
{'test_acc_before': 0.9336577572856732, 'test_loss_before': 0.24893958098879088}
################Communication round : 95
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 0
local mask changes: 39120.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [39120.0, 1930784.0, 1935968.0, 1932044.0, 1933938.0]
Doing local aggregation!
test acc on this client before 1884 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002836
Client Index = 0	Epoch: 1	Loss: 0.002286
Client Index = 0	Epoch: 2	Loss: 0.030286
Client Index = 0	Epoch: 3	Loss: 0.069313
Client Index = 0	Epoch: 4	Loss: 0.072895
test acc on this client after 1750 / 2005 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 1
local mask changes: 39132.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1931576.0, 39132.0, 1936410.0, 1931584.0, 1934880.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003660
Client Index = 1	Epoch: 1	Loss: 0.031297
Client Index = 1	Epoch: 2	Loss: 0.057621
Client Index = 1	Epoch: 3	Loss: 0.078656
Client Index = 1	Epoch: 4	Loss: 0.063576
test acc on this client after 1793 / 2005 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 2
local mask changes: 39078.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1937470.0, 1937022.0, 39078.0, 1940424.0, 1942754.0]
Doing local aggregation!
test acc on this client before 1850 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003518
Client Index = 2	Epoch: 1	Loss: 0.003423
Client Index = 2	Epoch: 2	Loss: 0.027803
Client Index = 2	Epoch: 3	Loss: 0.071005
Client Index = 2	Epoch: 4	Loss: 0.069285
test acc on this client after 1564 / 2003 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 3
local mask changes: 39092.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1933504.0, 1932416.0, 1940758.0, 39092.0, 1939482.0]
Doing local aggregation!
test acc on this client before 1861 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.004007
Client Index = 3	Epoch: 1	Loss: 0.002739
Client Index = 3	Epoch: 2	Loss: 0.043444
Client Index = 3	Epoch: 3	Loss: 0.081253
Client Index = 3	Epoch: 4	Loss: 0.079239
test acc on this client after 1720 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 4
local mask changes: 39106.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1934546.0, 1934984.0, 1941916.0, 1938634.0, 39106.0]
Doing local aggregation!
test acc on this client before 1842 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002614
Client Index = 4	Epoch: 1	Loss: 0.001763
Client Index = 4	Epoch: 2	Loss: 0.027711
Client Index = 4	Epoch: 3	Loss: 0.066637
Client Index = 4	Epoch: 4	Loss: 0.073012
test acc on this client after 1691 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.03879518554221639}
################local_test_on_all_clients after local training in communication round: 95
{'test_acc_after': 0.8497460578351003, 'test_loss_after': 0.6536081506347925}
################local_test_on_all_clients before local training in communication round: 95
{'test_acc_before': 0.9286702755418268, 'test_loss_before': 0.28318984545796966}
################Communication round : 96
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 0
local mask changes: 27266.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [27266.0, 1937358.0, 1942798.0, 1939338.0, 1940140.0]
Doing local aggregation!
test acc on this client before 1893 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002462
Client Index = 0	Epoch: 1	Loss: 0.011650
Client Index = 0	Epoch: 2	Loss: 0.067515
Client Index = 0	Epoch: 3	Loss: 0.077843
Client Index = 0	Epoch: 4	Loss: 0.082553
test acc on this client after 1800 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 1
local mask changes: 27212.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1937892.0, 27212.0, 1943628.0, 1939346.0, 1941408.0]
Doing local aggregation!
test acc on this client before 1881 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.003290
Client Index = 1	Epoch: 1	Loss: 0.015324
Client Index = 1	Epoch: 2	Loss: 0.050950
Client Index = 1	Epoch: 3	Loss: 0.086559
Client Index = 1	Epoch: 4	Loss: 0.072673
test acc on this client after 1700 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 2
local mask changes: 27250.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1942900.0, 1943198.0, 27250.0, 1947690.0, 1948356.0]
Doing local aggregation!
test acc on this client before 1852 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.002440
Client Index = 2	Epoch: 1	Loss: 0.001822
Client Index = 2	Epoch: 2	Loss: 0.045045
Client Index = 2	Epoch: 3	Loss: 0.082341
Client Index = 2	Epoch: 4	Loss: 0.090740
test acc on this client after 1802 / 2003 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 3
local mask changes: 27254.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1939608.0, 1939740.0, 1947808.0, 27254.0, 1945964.0]
Doing local aggregation!
test acc on this client before 1867 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.002341
Client Index = 3	Epoch: 1	Loss: 0.002758
Client Index = 3	Epoch: 2	Loss: 0.044047
Client Index = 3	Epoch: 3	Loss: 0.067617
Client Index = 3	Epoch: 4	Loss: 0.084908
test acc on this client after 1616 / 2006 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 4
local mask changes: 27228.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1940122.0, 1941068.0, 1948196.0, 1945410.0, 27228.0]
Doing local aggregation!
test acc on this client before 1857 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.002601
Client Index = 4	Epoch: 1	Loss: 0.021560
Client Index = 4	Epoch: 2	Loss: 0.049659
Client Index = 4	Epoch: 3	Loss: 0.072330
Client Index = 4	Epoch: 4	Loss: 0.094210
test acc on this client after 1609 / 2005 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04540945874389299}
################local_test_on_all_clients after local training in communication round: 96
{'test_acc_after': 0.850672690054681, 'test_loss_after': 0.5738311248019359}
################local_test_on_all_clients before local training in communication round: 96
{'test_acc_before': 0.9327599519485675, 'test_loss_before': 0.2688419359488346}
################Communication round : 97
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 0
local mask changes: 17454.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [17454.0, 1943110.0, 1948064.0, 1945136.0, 1945496.0]
Doing local aggregation!
test acc on this client before 1896 / 2005 : 0.95
Client Index = 0	Epoch: 0	Loss: 0.002594
Client Index = 0	Epoch: 1	Loss: 0.003697
Client Index = 0	Epoch: 2	Loss: 0.043304
Client Index = 0	Epoch: 3	Loss: 0.075483
Client Index = 0	Epoch: 4	Loss: 0.082862
test acc on this client after 1823 / 2005 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 1
local mask changes: 17474.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1943072.0, 17474.0, 1948840.0, 1945272.0, 1946718.0]
Doing local aggregation!
test acc on this client before 1872 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003534
Client Index = 1	Epoch: 1	Loss: 0.011800
Client Index = 1	Epoch: 2	Loss: 0.055250
Client Index = 1	Epoch: 3	Loss: 0.068353
Client Index = 1	Epoch: 4	Loss: 0.073755
test acc on this client after 1651 / 2005 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 2
local mask changes: 17470.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1947770.0, 1948970.0, 17470.0, 1952930.0, 1952878.0]
Doing local aggregation!
test acc on this client before 1852 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003685
Client Index = 2	Epoch: 1	Loss: 0.017889
Client Index = 2	Epoch: 2	Loss: 0.054417
Client Index = 2	Epoch: 3	Loss: 0.076801
Client Index = 2	Epoch: 4	Loss: 0.077027
test acc on this client after 1676 / 2003 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 3
local mask changes: 17460.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1944956.0, 1945364.0, 1953164.0, 17460.0, 1951082.0]
Doing local aggregation!
test acc on this client before 1859 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.003024
Client Index = 3	Epoch: 1	Loss: 0.009114
Client Index = 3	Epoch: 2	Loss: 0.061495
Client Index = 3	Epoch: 3	Loss: 0.079206
Client Index = 3	Epoch: 4	Loss: 0.086036
test acc on this client after 1759 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 4
local mask changes: 17464.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1945278.0, 1946602.0, 1953228.0, 1951092.0, 17464.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 4	Epoch: 0	Loss: 0.002838
Client Index = 4	Epoch: 1	Loss: 0.004283
Client Index = 4	Epoch: 2	Loss: 0.038321
Client Index = 4	Epoch: 3	Loss: 0.054210
Client Index = 4	Epoch: 4	Loss: 0.090946
test acc on this client after 1730 / 2005 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.04319690479487134}
################local_test_on_all_clients after local training in communication round: 97
{'test_acc_after': 0.86182509928913, 'test_loss_after': 0.5294351540231609}
################local_test_on_all_clients before local training in communication round: 97
{'test_acc_before': 0.9318625941466614, 'test_loss_before': 0.24935583977835027}
################Communication round : 98
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 0
local mask changes: 9850.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [9850.0, 1947170.0, 1951976.0, 1949202.0, 1949330.0]
Doing local aggregation!
test acc on this client before 1885 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002719
Client Index = 0	Epoch: 1	Loss: 0.006906
Client Index = 0	Epoch: 2	Loss: 0.055551
Client Index = 0	Epoch: 3	Loss: 0.065992
Client Index = 0	Epoch: 4	Loss: 0.091006
test acc on this client after 1696 / 2005 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 1
local mask changes: 9844.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1947248.0, 9844.0, 1953108.0, 1949382.0, 1950768.0]
Doing local aggregation!
test acc on this client before 1884 / 2005 : 0.94
Client Index = 1	Epoch: 0	Loss: 0.002378
Client Index = 1	Epoch: 1	Loss: 0.002782
Client Index = 1	Epoch: 2	Loss: 0.030127
Client Index = 1	Epoch: 3	Loss: 0.072115
Client Index = 1	Epoch: 4	Loss: 0.071639
test acc on this client after 1767 / 2005 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 2
local mask changes: 9840.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1952042.0, 1953248.0, 9840.0, 1956992.0, 1956988.0]
Doing local aggregation!
test acc on this client before 1863 / 2003 : 0.93
Client Index = 2	Epoch: 0	Loss: 0.002877
Client Index = 2	Epoch: 1	Loss: 0.001754
Client Index = 2	Epoch: 2	Loss: 0.003342
Client Index = 2	Epoch: 3	Loss: 0.039751
Client Index = 2	Epoch: 4	Loss: 0.070865
test acc on this client after 1744 / 2003 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 3
local mask changes: 9844.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1949280.0, 1949516.0, 1957046.0, 9844.0, 1955162.0]
Doing local aggregation!
test acc on this client before 1865 / 2006 : 0.93
Client Index = 3	Epoch: 0	Loss: 0.003080
Client Index = 3	Epoch: 1	Loss: 0.003371
Client Index = 3	Epoch: 2	Loss: 0.040059
Client Index = 3	Epoch: 3	Loss: 0.072859
Client Index = 3	Epoch: 4	Loss: 0.081808
test acc on this client after 1734 / 2006 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 4
local mask changes: 9836.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1949526.0, 1950862.0, 1956866.0, 1955080.0, 9836.0]
Doing local aggregation!
test acc on this client before 1852 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002414
Client Index = 4	Epoch: 1	Loss: 0.004216
Client Index = 4	Epoch: 2	Loss: 0.043622
Client Index = 4	Epoch: 3	Loss: 0.068639
Client Index = 4	Epoch: 4	Loss: 0.084164
test acc on this client after 1588 / 2005 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.036961415547031765}
################local_test_on_all_clients after local training in communication round: 98
{'test_acc_after': 0.8508605467469786, 'test_loss_after': 0.5695053747274011}
################local_test_on_all_clients before local training in communication round: 98
{'test_acc_before': 0.9326613963908302, 'test_loss_before': 0.2537812325694693}
################Communication round : 99
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 0
local mask changes: 4388.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [4388.0, 1949660.0, 1954446.0, 1951580.0, 1951790.0]
Doing local aggregation!
test acc on this client before 1891 / 2005 : 0.94
Client Index = 0	Epoch: 0	Loss: 0.002345
Client Index = 0	Epoch: 1	Loss: 0.001737
Client Index = 0	Epoch: 2	Loss: 0.001436
Client Index = 0	Epoch: 3	Loss: 0.017408
Client Index = 0	Epoch: 4	Loss: 0.065523
test acc on this client after 1796 / 2005 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 1
local mask changes: 4386.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1949658.0, 4386.0, 1955542.0, 1951854.0, 1953258.0]
Doing local aggregation!
test acc on this client before 1862 / 2005 : 0.93
Client Index = 1	Epoch: 0	Loss: 0.003745
Client Index = 1	Epoch: 1	Loss: 0.010203
Client Index = 1	Epoch: 2	Loss: 0.066217
Client Index = 1	Epoch: 3	Loss: 0.074585
Client Index = 1	Epoch: 4	Loss: 0.076998
test acc on this client after 1685 / 2005 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 2
local mask changes: 4384.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1954272.0, 1955538.0, 4384.0, 1959266.0, 1959154.0]
Doing local aggregation!
test acc on this client before 1841 / 2003 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.003514
Client Index = 2	Epoch: 1	Loss: 0.008885
Client Index = 2	Epoch: 2	Loss: 0.066742
Client Index = 2	Epoch: 3	Loss: 0.078561
Client Index = 2	Epoch: 4	Loss: 0.095355
test acc on this client after 1664 / 2003 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 3
local mask changes: 4388.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1951660.0, 1952014.0, 1959532.0, 4388.0, 1957624.0]
Doing local aggregation!
test acc on this client before 1855 / 2006 : 0.92
Client Index = 3	Epoch: 0	Loss: 0.003674
Client Index = 3	Epoch: 1	Loss: 0.009766
Client Index = 3	Epoch: 2	Loss: 0.058309
Client Index = 3	Epoch: 3	Loss: 0.078830
Client Index = 3	Epoch: 4	Loss: 0.079364
test acc on this client after 1758 / 2006 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 4
local mask changes: 4380.0 / 11173962
choose client_indexes: [0 1 2 3 4], accoring to random
choose mask diff: [1951706.0, 1953244.0, 1959272.0, 1957490.0, 4380.0]
Doing local aggregation!
test acc on this client before 1851 / 2005 : 0.92
Client Index = 4	Epoch: 0	Loss: 0.002491
Client Index = 4	Epoch: 1	Loss: 0.002372
Client Index = 4	Epoch: 2	Loss: 0.018536
Client Index = 4	Epoch: 3	Loss: 0.078379
Client Index = 4	Epoch: 4	Loss: 0.083451
test acc on this client after 1534 / 2005 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
{'training_loss': 0.03953702347544354}
################local_test_on_all_clients after local training in communication round: 99
{'test_acc_after': 0.8416743278654419, 'test_loss_after': 0.6132240979570367}
################local_test_on_all_clients before local training in communication round: 99
{'test_acc_before': 0.9277719218766597, 'test_loss_before': 0.26854012084411377}
