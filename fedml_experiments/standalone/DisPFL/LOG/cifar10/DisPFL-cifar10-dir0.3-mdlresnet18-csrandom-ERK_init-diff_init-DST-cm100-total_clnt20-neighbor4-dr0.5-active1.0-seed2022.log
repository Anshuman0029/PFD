Namespace(active=1.0, anneal_factor=0.5, batch_size=128, ci=0, client_num_in_total=20, client_num_per_round=4, client_optimizer='sgd', comm_round=100, cs='random', data_dir='/Date/FL/DisPFL-master/data/', dataset='cifar10', dense_ratio=0.5, diff_spa=False, different_initial=True, dis_gradient_check=True, epochs=5, erk_power_scale=1, frac=0.2, frequency_of_the_test=1, global_test=False, gpu=0, identity='DisPFL-cifar10-dir0.3-mdlresnet18-csrandom-ERK_init-diff_init-DST-cm100-total_clnt20-neighbor4-dr0.5-active1.0-seed2022', lr=0.1, lr_decay=0.998, model='resnet18', momentum=0, partition_alpha=0.3, partition_method='dir', public_portion=0, record_mask_diff=False, save_masks=False, seed=2022, static=False, strict_avg=False, tag='test', uniform=False, wd=0.0005)
cuda:0
*********partition data***************
train_num2500  test_num504
client_idx = 0, local_sample_number = 2500
train_num2500  test_num503
client_idx = 1, local_sample_number = 2500
train_num2500  test_num502
client_idx = 2, local_sample_number = 2500
train_num2500  test_num504
client_idx = 3, local_sample_number = 2500
train_num2500  test_num503
client_idx = 4, local_sample_number = 2500
train_num2500  test_num504
client_idx = 5, local_sample_number = 2500
train_num2500  test_num505
client_idx = 6, local_sample_number = 2500
train_num2500  test_num504
client_idx = 7, local_sample_number = 2500
train_num2500  test_num504
client_idx = 8, local_sample_number = 2500
train_num2500  test_num504
client_idx = 9, local_sample_number = 2500
train_num2500  test_num503
client_idx = 10, local_sample_number = 2500
train_num2500  test_num504
client_idx = 11, local_sample_number = 2500
train_num2500  test_num504
client_idx = 12, local_sample_number = 2500
train_num2500  test_num503
client_idx = 13, local_sample_number = 2500
train_num2500  test_num502
client_idx = 14, local_sample_number = 2500
train_num2500  test_num504
client_idx = 15, local_sample_number = 2500
train_num2500  test_num503
client_idx = 16, local_sample_number = 2500
train_num2500  test_num505
client_idx = 17, local_sample_number = 2500
train_num2500  test_num504
client_idx = 18, local_sample_number = 2500
train_num2500  test_num506
client_idx = 19, local_sample_number = 2500
DATA Partition: Train [449, 153, 327, 509, 430, 112, 1, 16, 189, 314]; Test [90, 31, 66, 102, 86, 23, 1, 4, 38, 63]
DATA Partition: Train [1, 40, 0, 45, 319, 91, 1039, 0, 627, 338]; Test [1, 8, 0, 9, 64, 19, 208, 0, 126, 68]
DATA Partition: Train [360, 205, 71, 0, 143, 155, 1514, 0, 0, 52]; Test [72, 41, 15, 0, 29, 31, 303, 0, 0, 11]
DATA Partition: Train [529, 114, 900, 556, 11, 41, 149, 16, 0, 184]; Test [106, 23, 180, 112, 3, 9, 30, 4, 0, 37]
DATA Partition: Train [782, 113, 1291, 0, 22, 103, 0, 20, 169, 0]; Test [157, 23, 259, 0, 5, 21, 0, 4, 34, 0]
DATA Partition: Train [10, 533, 2, 393, 1096, 52, 28, 305, 1, 80]; Test [2, 107, 1, 79, 220, 11, 6, 61, 1, 16]
DATA Partition: Train [578, 143, 533, 21, 511, 334, 62, 306, 0, 12]; Test [116, 29, 107, 5, 103, 67, 13, 62, 0, 3]
DATA Partition: Train [294, 248, 1, 4, 624, 280, 214, 831, 3, 1]; Test [59, 50, 1, 1, 125, 56, 43, 167, 1, 1]
DATA Partition: Train [0, 109, 408, 0, 461, 311, 19, 1044, 1, 147]; Test [0, 22, 82, 0, 93, 63, 4, 209, 1, 30]
DATA Partition: Train [9, 526, 3, 464, 0, 28, 62, 850, 126, 432]; Test [2, 106, 1, 93, 0, 6, 13, 170, 26, 87]
DATA Partition: Train [1, 319, 283, 14, 678, 38, 489, 110, 404, 164]; Test [1, 64, 57, 3, 136, 8, 98, 22, 81, 33]
DATA Partition: Train [573, 292, 32, 33, 0, 688, 1, 0, 12, 869]; Test [115, 59, 7, 7, 0, 138, 1, 0, 3, 174]
DATA Partition: Train [210, 104, 68, 276, 218, 93, 81, 73, 1354, 23]; Test [42, 21, 14, 56, 44, 19, 17, 15, 271, 5]
DATA Partition: Train [445, 645, 173, 91, 0, 102, 479, 158, 378, 29]; Test [89, 129, 35, 19, 0, 21, 96, 32, 76, 6]
DATA Partition: Train [271, 435, 190, 120, 49, 783, 29, 310, 0, 313]; Test [55, 87, 38, 24, 10, 157, 6, 62, 0, 63]
DATA Partition: Train [29, 187, 337, 76, 8, 74, 23, 879, 768, 119]; Test [6, 38, 68, 16, 2, 15, 5, 176, 154, 24]
DATA Partition: Train [322, 209, 29, 59, 180, 390, 56, 43, 0, 1212]; Test [65, 42, 6, 12, 36, 78, 12, 9, 0, 243]
DATA Partition: Train [72, 276, 3, 1270, 16, 1, 752, 29, 80, 1]; Test [15, 56, 1, 254, 4, 1, 151, 6, 16, 1]
DATA Partition: Train [22, 8, 12, 198, 28, 1323, 0, 10, 236, 663]; Test [5, 2, 3, 40, 6, 265, 0, 2, 48, 133]
DATA Partition: Train [43, 341, 337, 871, 206, 1, 2, 0, 652, 47]; Test [9, 69, 68, 175, 42, 1, 1, 0, 131, 10]
ResNet(
  (conv1): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
  (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
  (layer1): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
    (1): BasicBlock(
      (conv1): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 64, eps=1e-05, affine=True)
      (conv2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 64, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer2): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(64, 128, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(64, 128, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 128, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 128, eps=1e-05, affine=True)
      (conv2): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 128, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer3): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(128, 256, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(128, 256, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 256, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 256, eps=1e-05, affine=True)
      (conv2): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 256, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (layer4): Sequential(
    (0): BasicBlock(
      (conv1): Conv2d(256, 512, kernel_size=(3, 3), stride=(2, 2), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential(
        (0): Conv2d(256, 512, kernel_size=(1, 1), stride=(2, 2), bias=False)
        (1): GroupNorm(32, 512, eps=1e-05, affine=True)
      )
    )
    (1): BasicBlock(
      (conv1): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn1): GroupNorm(32, 512, eps=1e-05, affine=True)
      (conv2): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1), bias=False)
      (bn2): GroupNorm(32, 512, eps=1e-05, affine=True)
      (shortcut): Sequential()
    )
  )
  (linear): Linear(in_features=512, out_features=10, bias=True)
)
############setup_clients (START)#############
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
self.local_sample_number = 2500
############setup_clients (END)#############
initialize by ERK
################Communication round : 0
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 0
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  1  5  7 10], accoring to random
choose mask diff: [0.0, 4551738.0, 4554162.0, 4554018.0, 4552084.0]
Doing local aggregation!
test acc on this client before 102 / 504 : 0.20
Client Index = 0	Epoch: 0	Loss: 4.348886
Client Index = 0	Epoch: 1	Loss: 2.062655
Client Index = 0	Epoch: 2	Loss: 2.002786
Client Index = 0	Epoch: 3	Loss: 1.974971
Client Index = 0	Epoch: 4	Loss: 1.928360
test acc on this client after 192 / 504 : 0.38
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 1
local mask changes: 0.0 / 11173962
choose client_indexes: [ 1  4  8 13 15], accoring to random
choose mask diff: [0.0, 4553924.0, 4553286.0, 4553184.0, 4552338.0]
Doing local aggregation!
test acc on this client before 113 / 503 : 0.22
Client Index = 1	Epoch: 0	Loss: 4.509167
Client Index = 1	Epoch: 1	Loss: 1.655682
Client Index = 1	Epoch: 2	Loss: 1.614362
Client Index = 1	Epoch: 3	Loss: 1.501238
Client Index = 1	Epoch: 4	Loss: 1.373460
test acc on this client after 289 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 2
local mask changes: 0.0 / 11173962
choose client_indexes: [ 2  3 17 18 19], accoring to random
choose mask diff: [0.0, 4553508.0, 4551940.0, 4552836.0, 4554204.0]
Doing local aggregation!
test acc on this client before 0 / 502 : 0.00
Client Index = 2	Epoch: 0	Loss: 3.823943
Client Index = 2	Epoch: 1	Loss: 1.376869
Client Index = 2	Epoch: 2	Loss: 1.321550
Client Index = 2	Epoch: 3	Loss: 1.275412
Client Index = 2	Epoch: 4	Loss: 1.257797
test acc on this client after 310 / 502 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 3
local mask changes: 0.0 / 11173962
choose client_indexes: [0 1 3 4 6], accoring to random
choose mask diff: [4553510.0, 4552242.0, 0.0, 4551984.0, 4553874.0]
Doing local aggregation!
test acc on this client before 84 / 504 : 0.17
Client Index = 3	Epoch: 0	Loss: 4.464753
Client Index = 3	Epoch: 1	Loss: 1.722523
Client Index = 3	Epoch: 2	Loss: 1.682905
Client Index = 3	Epoch: 3	Loss: 1.633507
Client Index = 3	Epoch: 4	Loss: 1.600131
test acc on this client after 206 / 504 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 4
local mask changes: 0.0 / 11173962
choose client_indexes: [ 4 11 15 16 19], accoring to random
choose mask diff: [0.0, 4552978.0, 4554324.0, 4555044.0, 4551928.0]
Doing local aggregation!
test acc on this client before 17 / 503 : 0.03
Client Index = 4	Epoch: 0	Loss: 4.416185
Client Index = 4	Epoch: 1	Loss: 1.382199
Client Index = 4	Epoch: 2	Loss: 1.278473
Client Index = 4	Epoch: 3	Loss: 1.261754
Client Index = 4	Epoch: 4	Loss: 1.263402
test acc on this client after 157 / 503 : 0.31
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 5
local mask changes: 0.0 / 11173962
choose client_indexes: [ 5  7  8 14 15], accoring to random
choose mask diff: [0.0, 4552596.0, 4551372.0, 4551716.0, 4554748.0]
Doing local aggregation!
test acc on this client before 107 / 504 : 0.21
Client Index = 5	Epoch: 0	Loss: 4.150655
Client Index = 5	Epoch: 1	Loss: 1.599777
Client Index = 5	Epoch: 2	Loss: 1.569268
Client Index = 5	Epoch: 3	Loss: 1.525778
Client Index = 5	Epoch: 4	Loss: 1.499678
test acc on this client after 171 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 6
local mask changes: 0.0 / 11173962
choose client_indexes: [ 5  6 10 16 18], accoring to random
choose mask diff: [4552430.0, 0.0, 4553186.0, 4552518.0, 4551886.0]
Doing local aggregation!
test acc on this client before 5 / 505 : 0.01
Client Index = 6	Epoch: 0	Loss: 4.489506
Client Index = 6	Epoch: 1	Loss: 1.911111
Client Index = 6	Epoch: 2	Loss: 1.858562
Client Index = 6	Epoch: 3	Loss: 1.814364
Client Index = 6	Epoch: 4	Loss: 1.813107
test acc on this client after 150 / 505 : 0.30
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 7
local mask changes: 0.0 / 11173962
choose client_indexes: [ 3  5  6  7 16], accoring to random
choose mask diff: [4551630.0, 4552596.0, 4554700.0, 0.0, 4554422.0]
Doing local aggregation!
test acc on this client before 45 / 504 : 0.09
Client Index = 7	Epoch: 0	Loss: 4.358529
Client Index = 7	Epoch: 1	Loss: 1.786938
Client Index = 7	Epoch: 2	Loss: 1.729459
Client Index = 7	Epoch: 3	Loss: 1.676759
Client Index = 7	Epoch: 4	Loss: 1.673550
test acc on this client after 174 / 504 : 0.35
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 8
local mask changes: 0.0 / 11173962
choose client_indexes: [ 2  8 10 14 17], accoring to random
choose mask diff: [4553732.0, 0.0, 4554512.0, 4552892.0, 4555348.0]
Doing local aggregation!
test acc on this client before 2 / 504 : 0.00
Client Index = 8	Epoch: 0	Loss: 4.119672
Client Index = 8	Epoch: 1	Loss: 1.655336
Client Index = 8	Epoch: 2	Loss: 1.635048
Client Index = 8	Epoch: 3	Loss: 1.572333
Client Index = 8	Epoch: 4	Loss: 1.592478
test acc on this client after 209 / 504 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 9
local mask changes: 0.0 / 11173962
choose client_indexes: [ 7  8  9 12 16], accoring to random
choose mask diff: [4553748.0, 4552896.0, 0.0, 4551922.0, 4552824.0]
Doing local aggregation!
test acc on this client before 92 / 504 : 0.18
Client Index = 9	Epoch: 0	Loss: 4.267646
Client Index = 9	Epoch: 1	Loss: 1.728220
Client Index = 9	Epoch: 2	Loss: 1.630995
Client Index = 9	Epoch: 3	Loss: 1.608580
Client Index = 9	Epoch: 4	Loss: 1.598506
test acc on this client after 137 / 504 : 0.27
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 10
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  1 10 13 15], accoring to random
choose mask diff: [4552084.0, 4553788.0, 0.0, 4552460.0, 4553042.0]
Doing local aggregation!
test acc on this client before 31 / 503 : 0.06
Client Index = 10	Epoch: 0	Loss: 4.690004
Client Index = 10	Epoch: 1	Loss: 1.990815
Client Index = 10	Epoch: 2	Loss: 1.929690
Client Index = 10	Epoch: 3	Loss: 1.878456
Client Index = 10	Epoch: 4	Loss: 1.836916
test acc on this client after 136 / 503 : 0.27
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 11
local mask changes: 0.0 / 11173962
choose client_indexes: [ 1  4  8  9 11], accoring to random
choose mask diff: [4551216.0, 4552978.0, 4554598.0, 4553858.0, 0.0]
Doing local aggregation!
test acc on this client before 9 / 504 : 0.02
Client Index = 11	Epoch: 0	Loss: 4.350798
Client Index = 11	Epoch: 1	Loss: 1.583750
Client Index = 11	Epoch: 2	Loss: 1.475726
Client Index = 11	Epoch: 3	Loss: 1.431496
Client Index = 11	Epoch: 4	Loss: 1.370919
test acc on this client after 241 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 12
local mask changes: 0.0 / 11173962
choose client_indexes: [ 1  2 12 14 19], accoring to random
choose mask diff: [4555588.0, 4554894.0, 0.0, 4552982.0, 4551366.0]
Doing local aggregation!
test acc on this client before 56 / 504 : 0.11
Client Index = 12	Epoch: 0	Loss: 4.410650
Client Index = 12	Epoch: 1	Loss: 1.677482
Client Index = 12	Epoch: 2	Loss: 1.661583
Client Index = 12	Epoch: 3	Loss: 1.627468
Client Index = 12	Epoch: 4	Loss: 1.595120
test acc on this client after 271 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 13
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  7 10 13 15], accoring to random
choose mask diff: [4553196.0, 4552396.0, 4552460.0, 0.0, 4550332.0]
Doing local aggregation!
test acc on this client before 20 / 503 : 0.04
Client Index = 13	Epoch: 0	Loss: 4.629553
Client Index = 13	Epoch: 1	Loss: 2.075649
Client Index = 13	Epoch: 2	Loss: 1.907956
Client Index = 13	Epoch: 3	Loss: 1.819749
Client Index = 13	Epoch: 4	Loss: 1.828120
test acc on this client after 168 / 503 : 0.33
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 14
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  5  7 14 16], accoring to random
choose mask diff: [4553332.0, 4551716.0, 4554034.0, 0.0, 4553212.0]
Doing local aggregation!
test acc on this client before 70 / 502 : 0.14
Client Index = 14	Epoch: 0	Loss: 4.565254
Client Index = 14	Epoch: 1	Loss: 1.994243
Client Index = 14	Epoch: 2	Loss: 1.940034
Client Index = 14	Epoch: 3	Loss: 1.885059
Client Index = 14	Epoch: 4	Loss: 1.846841
test acc on this client after 181 / 502 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 15
local mask changes: 0.0 / 11173962
choose client_indexes: [ 4  9 12 15 17], accoring to random
choose mask diff: [4554324.0, 4551712.0, 4550916.0, 0.0, 4551230.0]
Doing local aggregation!
test acc on this client before 152 / 504 : 0.30
Client Index = 15	Epoch: 0	Loss: 4.592201
Client Index = 15	Epoch: 1	Loss: 1.769729
Client Index = 15	Epoch: 2	Loss: 1.707230
Client Index = 15	Epoch: 3	Loss: 1.653498
Client Index = 15	Epoch: 4	Loss: 1.601354
test acc on this client after 173 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 16
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0  1  9 12 16], accoring to random
choose mask diff: [4553774.0, 4554242.0, 4552824.0, 4553294.0, 0.0]
Doing local aggregation!
test acc on this client before 12 / 503 : 0.02
Client Index = 16	Epoch: 0	Loss: 4.247686
Client Index = 16	Epoch: 1	Loss: 1.732092
Client Index = 16	Epoch: 2	Loss: 1.637693
Client Index = 16	Epoch: 3	Loss: 1.570430
Client Index = 16	Epoch: 4	Loss: 1.521414
test acc on this client after 259 / 503 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 17
local mask changes: 0.0 / 11173962
choose client_indexes: [ 0 12 14 15 17], accoring to random
choose mask diff: [4554834.0, 4554260.0, 4554194.0, 4551230.0, 0.0]
Doing local aggregation!
test acc on this client before 21 / 505 : 0.04
Client Index = 17	Epoch: 0	Loss: 4.762316
Client Index = 17	Epoch: 1	Loss: 1.417381
Client Index = 17	Epoch: 2	Loss: 1.295309
Client Index = 17	Epoch: 3	Loss: 1.259970
Client Index = 17	Epoch: 4	Loss: 1.253338
test acc on this client after 222 / 505 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 18
local mask changes: 0.0 / 11173962
choose client_indexes: [ 6  7 11 15 18], accoring to random
choose mask diff: [4551886.0, 4553882.0, 4550702.0, 4550088.0, 0.0]
Doing local aggregation!
test acc on this client before 0 / 504 : 0.00
Client Index = 18	Epoch: 0	Loss: 4.490757
Client Index = 18	Epoch: 1	Loss: 1.381624
Client Index = 18	Epoch: 2	Loss: 1.297097
Client Index = 18	Epoch: 3	Loss: 1.302816
Client Index = 18	Epoch: 4	Loss: 1.205438
test acc on this client after 290 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(0) with spasity 0.5: 19
local mask changes: 0.0 / 11173962
choose client_indexes: [ 1  5 10 17 19], accoring to random
choose mask diff: [4552838.0, 4555410.0, 4554860.0, 4552686.0, 0.0]
Doing local aggregation!
test acc on this client before 162 / 506 : 0.32
Client Index = 19	Epoch: 0	Loss: 3.876291
Client Index = 19	Epoch: 1	Loss: 1.715300
Client Index = 19	Epoch: 2	Loss: 1.639388
Client Index = 19	Epoch: 3	Loss: 1.649334
Client Index = 19	Epoch: 4	Loss: 1.572924
test acc on this client after 247 / 506 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 0
{'test_acc': 0.41520329576043347, 'test_loss': 1.5632263620575637}
################local_test_on_all_clients before local training in communication round: 0
{'test_acc': 0.10912408540885161, 'test_loss': 2.408936609911984}
################Communication round : 1
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 0
local mask changes: 2940080.0 / 11173962
choose client_indexes: [ 0  3  5  6 19], accoring to random
choose mask diff: [2940080.0, 4555670.0, 4552650.0, 4553132.0, 4553306.0]
Doing local aggregation!
test acc on this client before 98 / 504 : 0.19
Client Index = 0	Epoch: 0	Loss: 2.129281
Client Index = 0	Epoch: 1	Loss: 1.918818
Client Index = 0	Epoch: 2	Loss: 1.871399
Client Index = 0	Epoch: 3	Loss: 1.808040
Client Index = 0	Epoch: 4	Loss: 1.799021
test acc on this client after 202 / 504 : 0.40
-----------------------------------
training flops per data 2653332992.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 1
local mask changes: 2938066.0 / 11173962
choose client_indexes: [ 1  3  5  7 18], accoring to random
choose mask diff: [2938066.0, 4553902.0, 4552026.0, 4556212.0, 4550006.0]
Doing local aggregation!
test acc on this client before 66 / 503 : 0.13
Client Index = 1	Epoch: 0	Loss: 1.892134
Client Index = 1	Epoch: 1	Loss: 1.357487
Client Index = 1	Epoch: 2	Loss: 1.284828
Client Index = 1	Epoch: 3	Loss: 1.202965
Client Index = 1	Epoch: 4	Loss: 1.222790
test acc on this client after 300 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 2
local mask changes: 2939378.0 / 11173962
choose client_indexes: [ 2  7  8 10 19], accoring to random
choose mask diff: [2939378.0, 4553218.0, 4554396.0, 4553440.0, 4552088.0]
Doing local aggregation!
test acc on this client before 29 / 502 : 0.06
Client Index = 2	Epoch: 0	Loss: 1.714611
Client Index = 2	Epoch: 1	Loss: 1.218361
Client Index = 2	Epoch: 2	Loss: 1.168665
Client Index = 2	Epoch: 3	Loss: 1.135925
Client Index = 2	Epoch: 4	Loss: 1.068241
test acc on this client after 269 / 502 : 0.54
-----------------------------------
training flops per data 2653334016.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 3
local mask changes: 2938896.0 / 11173962
choose client_indexes: [ 3  6 10 14 17], accoring to random
choose mask diff: [2938896.0, 4551354.0, 4552244.0, 4553770.0, 4551836.0]
Doing local aggregation!
test acc on this client before 106 / 504 : 0.21
Client Index = 3	Epoch: 0	Loss: 1.870083
Client Index = 3	Epoch: 1	Loss: 1.668339
Client Index = 3	Epoch: 2	Loss: 1.541499
Client Index = 3	Epoch: 3	Loss: 1.602776
Client Index = 3	Epoch: 4	Loss: 1.496751
test acc on this client after 210 / 504 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 4
local mask changes: 2938448.0 / 11173962
choose client_indexes: [ 0  4  5  6 14], accoring to random
choose mask diff: [4552282.0, 2938448.0, 4552864.0, 4552136.0, 4556022.0]
Doing local aggregation!
test acc on this client before 157 / 503 : 0.31
Client Index = 4	Epoch: 0	Loss: 1.778870
Client Index = 4	Epoch: 1	Loss: 1.304228
Client Index = 4	Epoch: 2	Loss: 1.230218
Client Index = 4	Epoch: 3	Loss: 1.162770
Client Index = 4	Epoch: 4	Loss: 1.076733
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653342464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 5
local mask changes: 2940418.0 / 11173962
choose client_indexes: [ 0  2  5  9 15], accoring to random
choose mask diff: [4553150.0, 4552870.0, 2940418.0, 4554502.0, 4553728.0]
Doing local aggregation!
test acc on this client before 107 / 504 : 0.21
Client Index = 5	Epoch: 0	Loss: 1.850594
Client Index = 5	Epoch: 1	Loss: 1.485367
Client Index = 5	Epoch: 2	Loss: 1.465690
Client Index = 5	Epoch: 3	Loss: 1.483000
Client Index = 5	Epoch: 4	Loss: 1.399625
test acc on this client after 231 / 504 : 0.46
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 6
local mask changes: 2939012.0 / 11173962
choose client_indexes: [ 6  7 12 18 19], accoring to random
choose mask diff: [2939012.0, 4554098.0, 4553900.0, 4553430.0, 4549778.0]
Doing local aggregation!
test acc on this client before 106 / 505 : 0.21
Client Index = 6	Epoch: 0	Loss: 2.000763
Client Index = 6	Epoch: 1	Loss: 1.749232
Client Index = 6	Epoch: 2	Loss: 1.733550
Client Index = 6	Epoch: 3	Loss: 1.707834
Client Index = 6	Epoch: 4	Loss: 1.668639
test acc on this client after 184 / 505 : 0.36
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 7
local mask changes: 2940102.0 / 11173962
choose client_indexes: [ 1  7 13 16 19], accoring to random
choose mask diff: [4551740.0, 2940102.0, 4552762.0, 4554016.0, 4556944.0]
Doing local aggregation!
test acc on this client before 50 / 504 : 0.10
Client Index = 7	Epoch: 0	Loss: 2.001326
Client Index = 7	Epoch: 1	Loss: 1.667900
Client Index = 7	Epoch: 2	Loss: 1.620492
Client Index = 7	Epoch: 3	Loss: 1.565537
Client Index = 7	Epoch: 4	Loss: 1.524216
test acc on this client after 183 / 504 : 0.36
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 8
local mask changes: 2941234.0 / 11173962
choose client_indexes: [ 6  8 10 17 18], accoring to random
choose mask diff: [4551904.0, 2941234.0, 4554070.0, 4553886.0, 4551882.0]
Doing local aggregation!
test acc on this client before 207 / 504 : 0.41
Client Index = 8	Epoch: 0	Loss: 1.848202
Client Index = 8	Epoch: 1	Loss: 1.580546
Client Index = 8	Epoch: 2	Loss: 1.559451
Client Index = 8	Epoch: 3	Loss: 1.501611
Client Index = 8	Epoch: 4	Loss: 1.522842
test acc on this client after 199 / 504 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 9
local mask changes: 2938276.0 / 11173962
choose client_indexes: [ 7  9 10 12 14], accoring to random
choose mask diff: [4554116.0, 2938276.0, 4553532.0, 4554546.0, 4552580.0]
Doing local aggregation!
test acc on this client before 106 / 504 : 0.21
Client Index = 9	Epoch: 0	Loss: 1.832201
Client Index = 9	Epoch: 1	Loss: 1.603297
Client Index = 9	Epoch: 2	Loss: 1.605735
Client Index = 9	Epoch: 3	Loss: 1.548432
Client Index = 9	Epoch: 4	Loss: 1.600467
test acc on this client after 186 / 504 : 0.37
-----------------------------------
training flops per data 2653328384.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 10
local mask changes: 2939566.0 / 11173962
choose client_indexes: [ 1  4 10 14 19], accoring to random
choose mask diff: [4552690.0, 4553578.0, 2939566.0, 4552464.0, 4553572.0]
Doing local aggregation!
test acc on this client before 164 / 503 : 0.33
Client Index = 10	Epoch: 0	Loss: 2.021964
Client Index = 10	Epoch: 1	Loss: 1.804517
Client Index = 10	Epoch: 2	Loss: 1.726688
Client Index = 10	Epoch: 3	Loss: 1.706737
Client Index = 10	Epoch: 4	Loss: 1.683523
test acc on this client after 93 / 503 : 0.18
-----------------------------------
training flops per data 2653320960.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 11
local mask changes: 2938374.0 / 11173962
choose client_indexes: [10 11 14 16 19], accoring to random
choose mask diff: [4551208.0, 2938374.0, 4553386.0, 4552106.0, 4554156.0]
Doing local aggregation!
test acc on this client before 167 / 504 : 0.33
Client Index = 11	Epoch: 0	Loss: 1.816963
Client Index = 11	Epoch: 1	Loss: 1.418733
Client Index = 11	Epoch: 2	Loss: 1.378614
Client Index = 11	Epoch: 3	Loss: 1.307711
Client Index = 11	Epoch: 4	Loss: 1.355365
test acc on this client after 234 / 504 : 0.46
-----------------------------------
training flops per data 2653331456.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 12
local mask changes: 2940946.0 / 11173962
choose client_indexes: [ 2  3  7 10 12], accoring to random
choose mask diff: [4556106.0, 4552304.0, 4553976.0, 4552148.0, 2940946.0]
Doing local aggregation!
test acc on this client before 22 / 504 : 0.04
Client Index = 12	Epoch: 0	Loss: 1.895362
Client Index = 12	Epoch: 1	Loss: 1.486153
Client Index = 12	Epoch: 2	Loss: 1.507599
Client Index = 12	Epoch: 3	Loss: 1.401775
Client Index = 12	Epoch: 4	Loss: 1.384310
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653329920.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 13
local mask changes: 2939914.0 / 11173962
choose client_indexes: [ 0  2  8 11 13], accoring to random
choose mask diff: [4552948.0, 4553374.0, 4553226.0, 4551462.0, 2939914.0]
Doing local aggregation!
test acc on this client before 129 / 503 : 0.26
Client Index = 13	Epoch: 0	Loss: 2.096535
Client Index = 13	Epoch: 1	Loss: 1.751720
Client Index = 13	Epoch: 2	Loss: 1.694345
Client Index = 13	Epoch: 3	Loss: 1.664418
Client Index = 13	Epoch: 4	Loss: 1.625078
test acc on this client after 124 / 503 : 0.25
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 14
local mask changes: 2939586.0 / 11173962
choose client_indexes: [ 1  2  5 14 17], accoring to random
choose mask diff: [4550494.0, 4551590.0, 4553006.0, 2939586.0, 4554122.0]
Doing local aggregation!
test acc on this client before 78 / 502 : 0.16
Client Index = 14	Epoch: 0	Loss: 2.132095
Client Index = 14	Epoch: 1	Loss: 1.866164
Client Index = 14	Epoch: 2	Loss: 1.832117
Client Index = 14	Epoch: 3	Loss: 1.768912
Client Index = 14	Epoch: 4	Loss: 1.721389
test acc on this client after 209 / 502 : 0.42
-----------------------------------
training flops per data 2653319424.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 15
local mask changes: 2941316.0 / 11173962
choose client_indexes: [ 8 11 13 15 17], accoring to random
choose mask diff: [4553772.0, 4551212.0, 4550136.0, 2941316.0, 4553404.0]
Doing local aggregation!
test acc on this client before 38 / 504 : 0.08
Client Index = 15	Epoch: 0	Loss: 2.164551
Client Index = 15	Epoch: 1	Loss: 1.691345
Client Index = 15	Epoch: 2	Loss: 1.572675
Client Index = 15	Epoch: 3	Loss: 1.545388
Client Index = 15	Epoch: 4	Loss: 1.464961
test acc on this client after 275 / 504 : 0.55
-----------------------------------
training flops per data 2653335040.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 16
local mask changes: 2939996.0 / 11173962
choose client_indexes: [ 0 13 15 16 17], accoring to random
choose mask diff: [4550636.0, 4551182.0, 4555248.0, 2939996.0, 4552052.0]
Doing local aggregation!
test acc on this client before 42 / 503 : 0.08
Client Index = 16	Epoch: 0	Loss: 1.885674
Client Index = 16	Epoch: 1	Loss: 1.576575
Client Index = 16	Epoch: 2	Loss: 1.548274
Client Index = 16	Epoch: 3	Loss: 1.463023
Client Index = 16	Epoch: 4	Loss: 1.450401
test acc on this client after 266 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 17
local mask changes: 2939442.0 / 11173962
choose client_indexes: [ 1  7 12 17 18], accoring to random
choose mask diff: [4554284.0, 4553594.0, 4555286.0, 2939442.0, 4551588.0]
Doing local aggregation!
test acc on this client before 143 / 505 : 0.28
Client Index = 17	Epoch: 0	Loss: 1.684923
Client Index = 17	Epoch: 1	Loss: 1.251550
Client Index = 17	Epoch: 2	Loss: 1.165792
Client Index = 17	Epoch: 3	Loss: 1.179675
Client Index = 17	Epoch: 4	Loss: 1.120826
test acc on this client after 271 / 505 : 0.54
-----------------------------------
training flops per data 2653331712.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 18
local mask changes: 2937824.0 / 11173962
choose client_indexes: [ 2  9 10 16 18], accoring to random
choose mask diff: [4553104.0, 4553374.0, 4552494.0, 4555906.0, 2937824.0]
Doing local aggregation!
test acc on this client before 208 / 504 : 0.41
Client Index = 18	Epoch: 0	Loss: 1.655012
Client Index = 18	Epoch: 1	Loss: 1.198829
Client Index = 18	Epoch: 2	Loss: 1.190378
Client Index = 18	Epoch: 3	Loss: 1.148688
Client Index = 18	Epoch: 4	Loss: 1.081699
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(1) with spasity 0.5: 19
local mask changes: 2941022.0 / 11173962
choose client_indexes: [ 0  5 10 15 19], accoring to random
choose mask diff: [4551772.0, 4553538.0, 4551828.0, 4552252.0, 2941022.0]
Doing local aggregation!
test acc on this client before 72 / 506 : 0.14
Client Index = 19	Epoch: 0	Loss: 1.928444
Client Index = 19	Epoch: 1	Loss: 1.563088
Client Index = 19	Epoch: 2	Loss: 1.524478
Client Index = 19	Epoch: 3	Loss: 1.408424
Client Index = 19	Epoch: 4	Loss: 1.453751
test acc on this client after 251 / 506 : 0.50
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 1
{'test_acc': 0.4591492084491569, 'test_loss': 1.491933918994265}
################local_test_on_all_clients before local training in communication round: 1
{'test_acc': 0.20791249845931858, 'test_loss': 2.0600410606087847}
################Communication round : 2
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 0
local mask changes: 2939286.0 / 11173962
choose client_indexes: [ 0  1 12 16 17], accoring to random
choose mask diff: [2939286.0, 4127434.0, 4130472.0, 4128866.0, 4128890.0]
Doing local aggregation!
test acc on this client before 133 / 504 : 0.26
Client Index = 0	Epoch: 0	Loss: 1.941711
Client Index = 0	Epoch: 1	Loss: 1.863714
Client Index = 0	Epoch: 2	Loss: 1.807525
Client Index = 0	Epoch: 3	Loss: 1.777271
Client Index = 0	Epoch: 4	Loss: 1.732733
test acc on this client after 173 / 504 : 0.34
-----------------------------------
training flops per data 2653338368.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 1
local mask changes: 2939640.0 / 11173962
choose client_indexes: [ 1  9 13 15 17], accoring to random
choose mask diff: [2939640.0, 4128596.0, 4125974.0, 4127484.0, 4129958.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 1	Epoch: 0	Loss: 1.483534
Client Index = 1	Epoch: 1	Loss: 1.261410
Client Index = 1	Epoch: 2	Loss: 1.174549
Client Index = 1	Epoch: 3	Loss: 1.162320
Client Index = 1	Epoch: 4	Loss: 1.105367
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 2
local mask changes: 2938696.0 / 11173962
choose client_indexes: [ 2  3  9 13 18], accoring to random
choose mask diff: [2938696.0, 4128728.0, 4127426.0, 4129378.0, 4128536.0]
Doing local aggregation!
test acc on this client before 41 / 502 : 0.08
Client Index = 2	Epoch: 0	Loss: 1.453507
Client Index = 2	Epoch: 1	Loss: 1.204054
Client Index = 2	Epoch: 2	Loss: 1.072315
Client Index = 2	Epoch: 3	Loss: 1.081028
Client Index = 2	Epoch: 4	Loss: 1.040600
test acc on this client after 363 / 502 : 0.72
-----------------------------------
training flops per data 2653335552.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 3
local mask changes: 2939924.0 / 11173962
choose client_indexes: [ 1  3  4 11 12], accoring to random
choose mask diff: [4129244.0, 2939924.0, 4130170.0, 4128758.0, 4128228.0]
Doing local aggregation!
test acc on this client before 211 / 504 : 0.42
Client Index = 3	Epoch: 0	Loss: 1.816419
Client Index = 3	Epoch: 1	Loss: 1.500069
Client Index = 3	Epoch: 2	Loss: 1.498432
Client Index = 3	Epoch: 3	Loss: 1.467621
Client Index = 3	Epoch: 4	Loss: 1.463160
test acc on this client after 215 / 504 : 0.43
-----------------------------------
training flops per data 2653336576.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 4
local mask changes: 2939672.0 / 11173962
choose client_indexes: [ 0  2  3  4 11], accoring to random
choose mask diff: [4092926.0, 4125350.0, 4128856.0, 2939672.0, 4127228.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 4	Epoch: 0	Loss: 1.480863
Client Index = 4	Epoch: 1	Loss: 1.174487
Client Index = 4	Epoch: 2	Loss: 1.107036
Client Index = 4	Epoch: 3	Loss: 1.072266
Client Index = 4	Epoch: 4	Loss: 1.081376
test acc on this client after 337 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 5
local mask changes: 2937576.0 / 11173962
choose client_indexes: [ 4  5  8 13 17], accoring to random
choose mask diff: [4129054.0, 2937576.0, 4128286.0, 4129060.0, 4130278.0]
Doing local aggregation!
test acc on this client before 109 / 504 : 0.22
Client Index = 5	Epoch: 0	Loss: 1.615774
Client Index = 5	Epoch: 1	Loss: 1.391042
Client Index = 5	Epoch: 2	Loss: 1.312659
Client Index = 5	Epoch: 3	Loss: 1.327064
Client Index = 5	Epoch: 4	Loss: 1.244201
test acc on this client after 274 / 504 : 0.54
-----------------------------------
training flops per data 2653320192.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 6
local mask changes: 2940300.0 / 11173962
choose client_indexes: [ 4  6  8 12 15], accoring to random
choose mask diff: [4128938.0, 2940300.0, 4129152.0, 4095794.0, 4127838.0]
Doing local aggregation!
test acc on this client before 107 / 505 : 0.21
Client Index = 6	Epoch: 0	Loss: 1.776990
Client Index = 6	Epoch: 1	Loss: 1.674864
Client Index = 6	Epoch: 2	Loss: 1.648386
Client Index = 6	Epoch: 3	Loss: 1.667139
Client Index = 6	Epoch: 4	Loss: 1.584647
test acc on this client after 181 / 505 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 7
local mask changes: 2936516.0 / 11173962
choose client_indexes: [ 5  7 13 17 19], accoring to random
choose mask diff: [4128082.0, 2936516.0, 4093214.0, 4130236.0, 4092374.0]
Doing local aggregation!
test acc on this client before 47 / 504 : 0.09
Client Index = 7	Epoch: 0	Loss: 1.833000
Client Index = 7	Epoch: 1	Loss: 1.549695
Client Index = 7	Epoch: 2	Loss: 1.572061
Client Index = 7	Epoch: 3	Loss: 1.479535
Client Index = 7	Epoch: 4	Loss: 1.481227
test acc on this client after 203 / 504 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 8
local mask changes: 2938748.0 / 11173962
choose client_indexes: [ 8  9 10 14 17], accoring to random
choose mask diff: [2938748.0, 4126836.0, 4091370.0, 4128562.0, 4092316.0]
Doing local aggregation!
test acc on this client before 119 / 504 : 0.24
Client Index = 8	Epoch: 0	Loss: 1.799707
Client Index = 8	Epoch: 1	Loss: 1.511869
Client Index = 8	Epoch: 2	Loss: 1.517345
Client Index = 8	Epoch: 3	Loss: 1.500910
Client Index = 8	Epoch: 4	Loss: 1.469484
test acc on this client after 241 / 504 : 0.48
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 9
local mask changes: 2938986.0 / 11173962
choose client_indexes: [ 1  2  9 12 16], accoring to random
choose mask diff: [4127042.0, 4131364.0, 2938986.0, 4094772.0, 4129358.0]
Doing local aggregation!
test acc on this client before 95 / 504 : 0.19
Client Index = 9	Epoch: 0	Loss: 1.794775
Client Index = 9	Epoch: 1	Loss: 1.493102
Client Index = 9	Epoch: 2	Loss: 1.422093
Client Index = 9	Epoch: 3	Loss: 1.413776
Client Index = 9	Epoch: 4	Loss: 1.424749
test acc on this client after 204 / 504 : 0.40
-----------------------------------
training flops per data 2653330432.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 10
local mask changes: 2938974.0 / 11173962
choose client_indexes: [ 0  4  5 10 13], accoring to random
choose mask diff: [4128854.0, 4095398.0, 4127900.0, 2938974.0, 4127596.0]
Doing local aggregation!
test acc on this client before 81 / 503 : 0.16
Client Index = 10	Epoch: 0	Loss: 1.864834
Client Index = 10	Epoch: 1	Loss: 1.723187
Client Index = 10	Epoch: 2	Loss: 1.654331
Client Index = 10	Epoch: 3	Loss: 1.644176
Client Index = 10	Epoch: 4	Loss: 1.604428
test acc on this client after 219 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 11
local mask changes: 2937788.0 / 11173962
choose client_indexes: [ 0  1 11 12 14], accoring to random
choose mask diff: [4128168.0, 4128256.0, 2937788.0, 4128862.0, 4095490.0]
Doing local aggregation!
test acc on this client before 241 / 504 : 0.48
Client Index = 11	Epoch: 0	Loss: 1.620577
Client Index = 11	Epoch: 1	Loss: 1.345524
Client Index = 11	Epoch: 2	Loss: 1.248125
Client Index = 11	Epoch: 3	Loss: 1.248150
Client Index = 11	Epoch: 4	Loss: 1.183716
test acc on this client after 272 / 504 : 0.54
-----------------------------------
training flops per data 2653316608.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 12
local mask changes: 2938406.0 / 11173962
choose client_indexes: [ 0 10 12 16 18], accoring to random
choose mask diff: [4128514.0, 4095794.0, 2938406.0, 4128144.0, 4129922.0]
Doing local aggregation!
test acc on this client before 14 / 504 : 0.03
Client Index = 12	Epoch: 0	Loss: 1.684537
Client Index = 12	Epoch: 1	Loss: 1.517924
Client Index = 12	Epoch: 2	Loss: 1.331472
Client Index = 12	Epoch: 3	Loss: 1.333174
Client Index = 12	Epoch: 4	Loss: 1.278457
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653317632.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 13
local mask changes: 2938212.0 / 11173962
choose client_indexes: [ 6  7 13 14 15], accoring to random
choose mask diff: [4129130.0, 4129032.0, 2938212.0, 4128400.0, 4129556.0]
Doing local aggregation!
test acc on this client before 89 / 503 : 0.18
Client Index = 13	Epoch: 0	Loss: 1.866428
Client Index = 13	Epoch: 1	Loss: 1.661574
Client Index = 13	Epoch: 2	Loss: 1.634040
Client Index = 13	Epoch: 3	Loss: 1.599424
Client Index = 13	Epoch: 4	Loss: 1.503912
test acc on this client after 221 / 503 : 0.44
-----------------------------------
training flops per data 2653323776.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 14
local mask changes: 2937628.0 / 11173962
choose client_indexes: [ 0  9 10 14 17], accoring to random
choose mask diff: [4128580.0, 4128772.0, 4129592.0, 2937628.0, 4095780.0]
Doing local aggregation!
test acc on this client before 94 / 502 : 0.19
Client Index = 14	Epoch: 0	Loss: 1.970106
Client Index = 14	Epoch: 1	Loss: 1.732126
Client Index = 14	Epoch: 2	Loss: 1.705866
Client Index = 14	Epoch: 3	Loss: 1.644066
Client Index = 14	Epoch: 4	Loss: 1.627556
test acc on this client after 193 / 502 : 0.38
-----------------------------------
training flops per data 2653319168.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 15
local mask changes: 2937726.0 / 11173962
choose client_indexes: [ 5 11 14 15 17], accoring to random
choose mask diff: [4126654.0, 4094704.0, 4129806.0, 2937726.0, 4094506.0]
Doing local aggregation!
test acc on this client before 45 / 504 : 0.09
Client Index = 15	Epoch: 0	Loss: 1.835425
Client Index = 15	Epoch: 1	Loss: 1.449884
Client Index = 15	Epoch: 2	Loss: 1.452544
Client Index = 15	Epoch: 3	Loss: 1.445419
Client Index = 15	Epoch: 4	Loss: 1.326353
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 16
local mask changes: 2936336.0 / 11173962
choose client_indexes: [ 8 12 15 16 17], accoring to random
choose mask diff: [4128488.0, 4131308.0, 4093070.0, 2936336.0, 4096136.0]
Doing local aggregation!
test acc on this client before 79 / 503 : 0.16
Client Index = 16	Epoch: 0	Loss: 1.698222
Client Index = 16	Epoch: 1	Loss: 1.438014
Client Index = 16	Epoch: 2	Loss: 1.438756
Client Index = 16	Epoch: 3	Loss: 1.344407
Client Index = 16	Epoch: 4	Loss: 1.346398
test acc on this client after 284 / 503 : 0.56
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 17
local mask changes: 2938870.0 / 11173962
choose client_indexes: [ 2 10 12 16 17], accoring to random
choose mask diff: [4130348.0, 4130698.0, 4093724.0, 4128982.0, 2938870.0]
Doing local aggregation!
test acc on this client before 172 / 505 : 0.34
Client Index = 17	Epoch: 0	Loss: 1.445458
Client Index = 17	Epoch: 1	Loss: 1.098764
Client Index = 17	Epoch: 2	Loss: 1.153587
Client Index = 17	Epoch: 3	Loss: 1.086441
Client Index = 17	Epoch: 4	Loss: 1.030150
test acc on this client after 238 / 505 : 0.47
-----------------------------------
training flops per data 2653326336.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 18
local mask changes: 2939516.0 / 11173962
choose client_indexes: [ 5  8  9 13 18], accoring to random
choose mask diff: [4129268.0, 4130604.0, 4094358.0, 4129720.0, 2939516.0]
Doing local aggregation!
test acc on this client before 297 / 504 : 0.59
Client Index = 18	Epoch: 0	Loss: 1.492401
Client Index = 18	Epoch: 1	Loss: 1.121382
Client Index = 18	Epoch: 2	Loss: 1.037172
Client Index = 18	Epoch: 3	Loss: 1.068019
Client Index = 18	Epoch: 4	Loss: 1.042559
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653326848.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(2) with spasity 0.5: 19
local mask changes: 2938542.0 / 11173962
choose client_indexes: [ 0  1 11 16 19], accoring to random
choose mask diff: [4096250.0, 4129626.0, 4129438.0, 4129162.0, 2938542.0]
Doing local aggregation!
test acc on this client before 69 / 506 : 0.14
Client Index = 19	Epoch: 0	Loss: 1.655282
Client Index = 19	Epoch: 1	Loss: 1.437250
Client Index = 19	Epoch: 2	Loss: 1.431936
Client Index = 19	Epoch: 3	Loss: 1.342281
Client Index = 19	Epoch: 4	Loss: 1.339245
test acc on this client after 262 / 506 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 2
{'test_acc': 0.5072471877593074, 'test_loss': 1.3804773761824567}
################local_test_on_all_clients before local training in communication round: 2
{'test_acc': 0.2596574246940814, 'test_loss': 2.004400878660196}
################Communication round : 3
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 0
local mask changes: 2937706.0 / 11173962
choose client_indexes: [ 0  5  7  9 10], accoring to random
choose mask diff: [2937706.0, 3839600.0, 3858518.0, 3885950.0, 3879924.0]
Doing local aggregation!
test acc on this client before 93 / 504 : 0.18
Client Index = 0	Epoch: 0	Loss: 1.927378
Client Index = 0	Epoch: 1	Loss: 1.766952
Client Index = 0	Epoch: 2	Loss: 1.745605
Client Index = 0	Epoch: 3	Loss: 1.660676
Client Index = 0	Epoch: 4	Loss: 1.682248
test acc on this client after 146 / 504 : 0.29
-----------------------------------
training flops per data 2653329408.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 1
local mask changes: 2936238.0 / 11173962
choose client_indexes: [ 1  9 12 13 14], accoring to random
choose mask diff: [2936238.0, 3848684.0, 3868726.0, 3840206.0, 3856004.0]
Doing local aggregation!
test acc on this client before 264 / 503 : 0.52
Client Index = 1	Epoch: 0	Loss: 1.277028
Client Index = 1	Epoch: 1	Loss: 1.168387
Client Index = 1	Epoch: 2	Loss: 1.105498
Client Index = 1	Epoch: 3	Loss: 1.132309
Client Index = 1	Epoch: 4	Loss: 1.071068
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653343232.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 2
local mask changes: 2937056.0 / 11173962
choose client_indexes: [ 0  2  4 13 18], accoring to random
choose mask diff: [3880110.0, 2937056.0, 3889034.0, 3834144.0, 3834344.0]
Doing local aggregation!
test acc on this client before 97 / 502 : 0.19
Client Index = 2	Epoch: 0	Loss: 1.327022
Client Index = 2	Epoch: 1	Loss: 1.072720
Client Index = 2	Epoch: 2	Loss: 1.018105
Client Index = 2	Epoch: 3	Loss: 1.012981
Client Index = 2	Epoch: 4	Loss: 0.985437
test acc on this client after 350 / 502 : 0.70
-----------------------------------
training flops per data 2653333248.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 3
local mask changes: 2935370.0 / 11173962
choose client_indexes: [ 0  3  7 10 11], accoring to random
choose mask diff: [3854236.0, 2935370.0, 3876558.0, 3842254.0, 3848256.0]
Doing local aggregation!
test acc on this client before 29 / 504 : 0.06
Client Index = 3	Epoch: 0	Loss: 1.618723
Client Index = 3	Epoch: 1	Loss: 1.458121
Client Index = 3	Epoch: 2	Loss: 1.423852
Client Index = 3	Epoch: 3	Loss: 1.376340
Client Index = 3	Epoch: 4	Loss: 1.450979
test acc on this client after 147 / 504 : 0.29
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 4
local mask changes: 2936432.0 / 11173962
choose client_indexes: [ 4  9 11 17 18], accoring to random
choose mask diff: [2936432.0, 3884316.0, 3850012.0, 3884764.0, 3889904.0]
Doing local aggregation!
test acc on this client before 143 / 503 : 0.28
Client Index = 4	Epoch: 0	Loss: 1.366839
Client Index = 4	Epoch: 1	Loss: 1.115223
Client Index = 4	Epoch: 2	Loss: 1.052184
Client Index = 4	Epoch: 3	Loss: 1.017601
Client Index = 4	Epoch: 4	Loss: 1.001348
test acc on this client after 268 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 5
local mask changes: 2938202.0 / 11173962
choose client_indexes: [ 3  5  7  8 18], accoring to random
choose mask diff: [3886220.0, 2938202.0, 3880846.0, 3836964.0, 3867932.0]
Doing local aggregation!
test acc on this client before 115 / 504 : 0.23
Client Index = 5	Epoch: 0	Loss: 1.429637
Client Index = 5	Epoch: 1	Loss: 1.317405
Client Index = 5	Epoch: 2	Loss: 1.279229
Client Index = 5	Epoch: 3	Loss: 1.201229
Client Index = 5	Epoch: 4	Loss: 1.341824
test acc on this client after 271 / 504 : 0.54
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 6
local mask changes: 2937800.0 / 11173962
choose client_indexes: [ 1  3  6  8 15], accoring to random
choose mask diff: [3887970.0, 3857230.0, 2937800.0, 3823292.0, 3852318.0]
Doing local aggregation!
test acc on this client before 110 / 505 : 0.22
Client Index = 6	Epoch: 0	Loss: 1.776174
Client Index = 6	Epoch: 1	Loss: 1.645148
Client Index = 6	Epoch: 2	Loss: 1.567154
Client Index = 6	Epoch: 3	Loss: 1.606906
Client Index = 6	Epoch: 4	Loss: 1.605156
test acc on this client after 205 / 505 : 0.41
-----------------------------------
training flops per data 2653334528.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 7
local mask changes: 2935798.0 / 11173962
choose client_indexes: [ 5  7  8 12 17], accoring to random
choose mask diff: [3842000.0, 2935798.0, 3880754.0, 3863614.0, 3836796.0]
Doing local aggregation!
test acc on this client before 197 / 504 : 0.39
Client Index = 7	Epoch: 0	Loss: 1.583004
Client Index = 7	Epoch: 1	Loss: 1.513008
Client Index = 7	Epoch: 2	Loss: 1.494654
Client Index = 7	Epoch: 3	Loss: 1.472917
Client Index = 7	Epoch: 4	Loss: 1.384014
test acc on this client after 246 / 504 : 0.49
-----------------------------------
training flops per data 2653327360.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 8
local mask changes: 2936516.0 / 11173962
choose client_indexes: [ 1  4  8 11 14], accoring to random
choose mask diff: [3857194.0, 3878076.0, 2936516.0, 3884700.0, 3826984.0]
Doing local aggregation!
test acc on this client before 86 / 504 : 0.17
Client Index = 8	Epoch: 0	Loss: 1.695422
Client Index = 8	Epoch: 1	Loss: 1.490872
Client Index = 8	Epoch: 2	Loss: 1.481400
Client Index = 8	Epoch: 3	Loss: 1.454091
Client Index = 8	Epoch: 4	Loss: 1.396792
test acc on this client after 223 / 504 : 0.44
-----------------------------------
training flops per data 2653338112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 9
local mask changes: 2936252.0 / 11173962
choose client_indexes: [ 5  8  9 11 12], accoring to random
choose mask diff: [3860208.0, 3878358.0, 2936252.0, 3886720.0, 3821770.0]
Doing local aggregation!
test acc on this client before 204 / 504 : 0.40
Client Index = 9	Epoch: 0	Loss: 1.555000
Client Index = 9	Epoch: 1	Loss: 1.402325
Client Index = 9	Epoch: 2	Loss: 1.356135
Client Index = 9	Epoch: 3	Loss: 1.323869
Client Index = 9	Epoch: 4	Loss: 1.289049
test acc on this client after 265 / 504 : 0.53
-----------------------------------
training flops per data 2653315072.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 10
local mask changes: 2936576.0 / 11173962
choose client_indexes: [ 1  6  9 10 15], accoring to random
choose mask diff: [3865394.0, 3873654.0, 3860910.0, 2936576.0, 3881150.0]
Doing local aggregation!
test acc on this client before 148 / 503 : 0.29
Client Index = 10	Epoch: 0	Loss: 1.673069
Client Index = 10	Epoch: 1	Loss: 1.670005
Client Index = 10	Epoch: 2	Loss: 1.555489
Client Index = 10	Epoch: 3	Loss: 1.535497
Client Index = 10	Epoch: 4	Loss: 1.605495
test acc on this client after 198 / 503 : 0.39
-----------------------------------
training flops per data 2653339392.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 11
local mask changes: 2937672.0 / 11173962
choose client_indexes: [ 1  7 10 11 16], accoring to random
choose mask diff: [3840928.0, 3868772.0, 3850460.0, 2937672.0, 3869488.0]
Doing local aggregation!
test acc on this client before 258 / 504 : 0.51
Client Index = 11	Epoch: 0	Loss: 1.454403
Client Index = 11	Epoch: 1	Loss: 1.232331
Client Index = 11	Epoch: 2	Loss: 1.255236
Client Index = 11	Epoch: 3	Loss: 1.113426
Client Index = 11	Epoch: 4	Loss: 1.362057
test acc on this client after 298 / 504 : 0.59
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 12
local mask changes: 2937728.0 / 11173962
choose client_indexes: [ 5 12 16 18 19], accoring to random
choose mask diff: [3875762.0, 2937728.0, 3844038.0, 3846054.0, 3863336.0]
Doing local aggregation!
test acc on this client before 63 / 504 : 0.12
Client Index = 12	Epoch: 0	Loss: 1.506219
Client Index = 12	Epoch: 1	Loss: 1.380370
Client Index = 12	Epoch: 2	Loss: 1.291758
Client Index = 12	Epoch: 3	Loss: 1.238661
Client Index = 12	Epoch: 4	Loss: 1.243679
test acc on this client after 311 / 504 : 0.62
-----------------------------------
training flops per data 2653282816.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 13
local mask changes: 2938138.0 / 11173962
choose client_indexes: [ 6  7 13 14 15], accoring to random
choose mask diff: [3852692.0, 3827418.0, 2938138.0, 3852512.0, 3834230.0]
Doing local aggregation!
test acc on this client before 156 / 503 : 0.31
Client Index = 13	Epoch: 0	Loss: 1.703764
Client Index = 13	Epoch: 1	Loss: 1.591858
Client Index = 13	Epoch: 2	Loss: 1.568435
Client Index = 13	Epoch: 3	Loss: 1.456821
Client Index = 13	Epoch: 4	Loss: 1.514836
test acc on this client after 182 / 503 : 0.36
-----------------------------------
training flops per data 2653332736.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 14
local mask changes: 2935672.0 / 11173962
choose client_indexes: [ 2  3  6 14 15], accoring to random
choose mask diff: [3866834.0, 3853288.0, 3875846.0, 2935672.0, 3894754.0]
Doing local aggregation!
test acc on this client before 105 / 502 : 0.21
Client Index = 14	Epoch: 0	Loss: 1.707648
Client Index = 14	Epoch: 1	Loss: 1.686981
Client Index = 14	Epoch: 2	Loss: 1.625609
Client Index = 14	Epoch: 3	Loss: 1.561457
Client Index = 14	Epoch: 4	Loss: 1.569410
test acc on this client after 213 / 502 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 15
local mask changes: 2937416.0 / 11173962
choose client_indexes: [ 1  2 11 15 19], accoring to random
choose mask diff: [3865792.0, 3872494.0, 3833724.0, 2937416.0, 3858468.0]
Doing local aggregation!
test acc on this client before 51 / 504 : 0.10
Client Index = 15	Epoch: 0	Loss: 1.591184
Client Index = 15	Epoch: 1	Loss: 1.365577
Client Index = 15	Epoch: 2	Loss: 1.379459
Client Index = 15	Epoch: 3	Loss: 1.267038
Client Index = 15	Epoch: 4	Loss: 1.282874
test acc on this client after 283 / 504 : 0.56
-----------------------------------
training flops per data 2653306880.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 16
local mask changes: 2936512.0 / 11173962
choose client_indexes: [ 5  9 12 16 17], accoring to random
choose mask diff: [3889740.0, 3887176.0, 3844740.0, 2936512.0, 3809676.0]
Doing local aggregation!
test acc on this client before 40 / 503 : 0.08
Client Index = 16	Epoch: 0	Loss: 1.608561
Client Index = 16	Epoch: 1	Loss: 1.373860
Client Index = 16	Epoch: 2	Loss: 1.347248
Client Index = 16	Epoch: 3	Loss: 1.289496
Client Index = 16	Epoch: 4	Loss: 1.425081
test acc on this client after 288 / 503 : 0.57
-----------------------------------
training flops per data 2653321216.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 17
local mask changes: 2935950.0 / 11173962
choose client_indexes: [ 0  1  2  6 17], accoring to random
choose mask diff: [3883966.0, 3852802.0, 3837220.0, 3881444.0, 2935950.0]
Doing local aggregation!
test acc on this client before 193 / 505 : 0.38
Client Index = 17	Epoch: 0	Loss: 1.232249
Client Index = 17	Epoch: 1	Loss: 1.178704
Client Index = 17	Epoch: 2	Loss: 1.044666
Client Index = 17	Epoch: 3	Loss: 0.999132
Client Index = 17	Epoch: 4	Loss: 1.011578
test acc on this client after 281 / 505 : 0.56
-----------------------------------
training flops per data 2653338112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 18
local mask changes: 2936526.0 / 11173962
choose client_indexes: [ 0  3  5 16 18], accoring to random
choose mask diff: [3869578.0, 3888138.0, 3845604.0, 3866922.0, 2936526.0]
Doing local aggregation!
test acc on this client before 147 / 504 : 0.29
Client Index = 18	Epoch: 0	Loss: 1.319445
Client Index = 18	Epoch: 1	Loss: 1.034670
Client Index = 18	Epoch: 2	Loss: 1.000080
Client Index = 18	Epoch: 3	Loss: 0.953141
Client Index = 18	Epoch: 4	Loss: 0.968612
test acc on this client after 316 / 504 : 0.63
-----------------------------------
training flops per data 2653331200.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(3) with spasity 0.5: 19
local mask changes: 2938328.0 / 11173962
choose client_indexes: [ 4  7 13 14 19], accoring to random
choose mask diff: [3885130.0, 3860038.0, 3878190.0, 3882828.0, 2938328.0]
Doing local aggregation!
test acc on this client before 104 / 506 : 0.21
Client Index = 19	Epoch: 0	Loss: 1.535675
Client Index = 19	Epoch: 1	Loss: 1.395749
Client Index = 19	Epoch: 2	Loss: 1.332747
Client Index = 19	Epoch: 3	Loss: 1.329913
Client Index = 19	Epoch: 4	Loss: 1.248513
test acc on this client after 279 / 506 : 0.55
-----------------------------------
training flops per data 2653325312.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 3
{'test_acc': 0.5030388060685015, 'test_loss': 1.4242632962468835}
################local_test_on_all_clients before local training in communication round: 3
{'test_acc': 0.258361781292889, 'test_loss': 1.9608786500188473}
################Communication round : 4
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 0
local mask changes: 2935554.0 / 11173962
choose client_indexes: [ 0  3 10 13 18], accoring to random
choose mask diff: [2935554.0, 3698236.0, 3669168.0, 3706722.0, 3708790.0]
Doing local aggregation!
test acc on this client before 120 / 504 : 0.24
Client Index = 0	Epoch: 0	Loss: 1.729559
Client Index = 0	Epoch: 1	Loss: 1.706347
Client Index = 0	Epoch: 2	Loss: 1.665257
Client Index = 0	Epoch: 3	Loss: 1.619960
Client Index = 0	Epoch: 4	Loss: 1.672556
test acc on this client after 186 / 504 : 0.37
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 1
local mask changes: 2933036.0 / 11173962
choose client_indexes: [ 1  3  5  9 18], accoring to random
choose mask diff: [2933036.0, 3706150.0, 3707062.0, 3659242.0, 3695928.0]
Doing local aggregation!
test acc on this client before 72 / 503 : 0.14
Client Index = 1	Epoch: 0	Loss: 1.262382
Client Index = 1	Epoch: 1	Loss: 1.144883
Client Index = 1	Epoch: 2	Loss: 1.118406
Client Index = 1	Epoch: 3	Loss: 1.136740
Client Index = 1	Epoch: 4	Loss: 1.050427
test acc on this client after 241 / 503 : 0.48
-----------------------------------
training flops per data 2653323264.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 2
local mask changes: 2935524.0 / 11173962
choose client_indexes: [ 2  3  4  8 17], accoring to random
choose mask diff: [2935524.0, 3701948.0, 3689366.0, 3702042.0, 3696376.0]
Doing local aggregation!
test acc on this client before 233 / 502 : 0.46
Client Index = 2	Epoch: 0	Loss: 1.235800
Client Index = 2	Epoch: 1	Loss: 0.972364
Client Index = 2	Epoch: 2	Loss: 1.041104
Client Index = 2	Epoch: 3	Loss: 1.001428
Client Index = 2	Epoch: 4	Loss: 0.968163
test acc on this client after 360 / 502 : 0.72
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 3
local mask changes: 2934770.0 / 11173962
choose client_indexes: [ 2  3  4  6 14], accoring to random
choose mask diff: [3706376.0, 2934770.0, 3675798.0, 3705234.0, 3694134.0]
Doing local aggregation!
test acc on this client before 186 / 504 : 0.37
Client Index = 3	Epoch: 0	Loss: 1.493256
Client Index = 3	Epoch: 1	Loss: 1.438288
Client Index = 3	Epoch: 2	Loss: 1.426552
Client Index = 3	Epoch: 3	Loss: 1.364190
Client Index = 3	Epoch: 4	Loss: 1.335724
test acc on this client after 253 / 504 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 4
local mask changes: 2933744.0 / 11173962
choose client_indexes: [ 3  4 15 17 19], accoring to random
choose mask diff: [3666072.0, 2933744.0, 3730720.0, 3684866.0, 3700606.0]
Doing local aggregation!
test acc on this client before 310 / 503 : 0.62
Client Index = 4	Epoch: 0	Loss: 1.151576
Client Index = 4	Epoch: 1	Loss: 1.107281
Client Index = 4	Epoch: 2	Loss: 1.005712
Client Index = 4	Epoch: 3	Loss: 0.983848
Client Index = 4	Epoch: 4	Loss: 0.953336
test acc on this client after 257 / 503 : 0.51
-----------------------------------
training flops per data 2653340928.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 5
local mask changes: 2935288.0 / 11173962
choose client_indexes: [ 4  5  9 13 18], accoring to random
choose mask diff: [3705872.0, 2935288.0, 3712924.0, 3701304.0, 3660396.0]
Doing local aggregation!
test acc on this client before 163 / 504 : 0.32
Client Index = 5	Epoch: 0	Loss: 1.409848
Client Index = 5	Epoch: 1	Loss: 1.194509
Client Index = 5	Epoch: 2	Loss: 1.281523
Client Index = 5	Epoch: 3	Loss: 1.262501
Client Index = 5	Epoch: 4	Loss: 1.164487
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653332480.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 6
local mask changes: 2934898.0 / 11173962
choose client_indexes: [ 6  9 12 15 17], accoring to random
choose mask diff: [2934898.0, 3718558.0, 3701274.0, 3673774.0, 3692220.0]
Doing local aggregation!
test acc on this client before 51 / 505 : 0.10
Client Index = 6	Epoch: 0	Loss: 1.715111
Client Index = 6	Epoch: 1	Loss: 1.568669
Client Index = 6	Epoch: 2	Loss: 1.554564
Client Index = 6	Epoch: 3	Loss: 1.553349
Client Index = 6	Epoch: 4	Loss: 1.545891
test acc on this client after 213 / 505 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 7
local mask changes: 2933484.0 / 11173962
choose client_indexes: [ 7 14 15 17 18], accoring to random
choose mask diff: [2933484.0, 3700432.0, 3710788.0, 3646762.0, 3703186.0]
Doing local aggregation!
test acc on this client before 180 / 504 : 0.36
Client Index = 7	Epoch: 0	Loss: 1.578106
Client Index = 7	Epoch: 1	Loss: 1.481094
Client Index = 7	Epoch: 2	Loss: 1.426453
Client Index = 7	Epoch: 3	Loss: 1.388010
Client Index = 7	Epoch: 4	Loss: 1.417273
test acc on this client after 247 / 504 : 0.49
-----------------------------------
training flops per data 2653341696.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 8
local mask changes: 2937024.0 / 11173962
choose client_indexes: [ 4  8  9 18 19], accoring to random
choose mask diff: [3697666.0, 2937024.0, 3701070.0, 3696586.0, 3721374.0]
Doing local aggregation!
test acc on this client before 156 / 504 : 0.31
Client Index = 8	Epoch: 0	Loss: 1.531816
Client Index = 8	Epoch: 1	Loss: 1.458322
Client Index = 8	Epoch: 2	Loss: 1.421375
Client Index = 8	Epoch: 3	Loss: 1.374332
Client Index = 8	Epoch: 4	Loss: 1.409821
test acc on this client after 230 / 504 : 0.46
-----------------------------------
training flops per data 2653340672.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 9
local mask changes: 2934742.0 / 11173962
choose client_indexes: [ 1  9 15 17 19], accoring to random
choose mask diff: [3678918.0, 2934742.0, 3725636.0, 3678244.0, 3708186.0]
Doing local aggregation!
test acc on this client before 181 / 504 : 0.36
Client Index = 9	Epoch: 0	Loss: 1.458952
Client Index = 9	Epoch: 1	Loss: 1.331160
Client Index = 9	Epoch: 2	Loss: 1.286338
Client Index = 9	Epoch: 3	Loss: 1.305760
Client Index = 9	Epoch: 4	Loss: 1.249017
test acc on this client after 202 / 504 : 0.40
-----------------------------------
training flops per data 2653342720.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 10
local mask changes: 2934180.0 / 11173962
choose client_indexes: [ 2  3  4 10 13], accoring to random
choose mask diff: [3688922.0, 3698174.0, 3683504.0, 2934180.0, 3699940.0]
Doing local aggregation!
test acc on this client before 84 / 503 : 0.17
Client Index = 10	Epoch: 0	Loss: 1.617542
Client Index = 10	Epoch: 1	Loss: 1.564050
Client Index = 10	Epoch: 2	Loss: 1.529803
Client Index = 10	Epoch: 3	Loss: 1.513891
Client Index = 10	Epoch: 4	Loss: 1.502759
test acc on this client after 222 / 503 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 11
local mask changes: 2936122.0 / 11173962
choose client_indexes: [ 0  3 11 15 19], accoring to random
choose mask diff: [3678796.0, 3687752.0, 2936122.0, 3677658.0, 3681634.0]
Doing local aggregation!
test acc on this client before 174 / 504 : 0.35
Client Index = 11	Epoch: 0	Loss: 1.217119
Client Index = 11	Epoch: 1	Loss: 1.235020
Client Index = 11	Epoch: 2	Loss: 1.186598
Client Index = 11	Epoch: 3	Loss: 1.100833
Client Index = 11	Epoch: 4	Loss: 1.092048
test acc on this client after 282 / 504 : 0.56
-----------------------------------
training flops per data 2653320704.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 12
local mask changes: 2932226.0 / 11173962
choose client_indexes: [ 0  6 12 14 16], accoring to random
choose mask diff: [3661200.0, 3694790.0, 2932226.0, 3707134.0, 3654848.0]
Doing local aggregation!
test acc on this client before 80 / 504 : 0.16
Client Index = 12	Epoch: 0	Loss: 1.406921
Client Index = 12	Epoch: 1	Loss: 1.295008
Client Index = 12	Epoch: 2	Loss: 1.244367
Client Index = 12	Epoch: 3	Loss: 1.247095
Client Index = 12	Epoch: 4	Loss: 1.236444
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653324032.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 13
local mask changes: 2934480.0 / 11173962
choose client_indexes: [ 1  7 12 13 16], accoring to random
choose mask diff: [3686126.0, 3651528.0, 3726914.0, 2934480.0, 3709248.0]
Doing local aggregation!
test acc on this client before 179 / 503 : 0.36
Client Index = 13	Epoch: 0	Loss: 1.547562
Client Index = 13	Epoch: 1	Loss: 1.540070
Client Index = 13	Epoch: 2	Loss: 1.511193
Client Index = 13	Epoch: 3	Loss: 1.459092
Client Index = 13	Epoch: 4	Loss: 1.389576
test acc on this client after 256 / 503 : 0.51
-----------------------------------
training flops per data 2653322752.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 14
local mask changes: 2934278.0 / 11173962
choose client_indexes: [ 1  3  4 10 14], accoring to random
choose mask diff: [3692256.0, 3668330.0, 3693730.0, 3690188.0, 2934278.0]
Doing local aggregation!
test acc on this client before 201 / 502 : 0.40
Client Index = 14	Epoch: 0	Loss: 1.662083
Client Index = 14	Epoch: 1	Loss: 1.614258
Client Index = 14	Epoch: 2	Loss: 1.589767
Client Index = 14	Epoch: 3	Loss: 1.549335
Client Index = 14	Epoch: 4	Loss: 1.482145
test acc on this client after 216 / 502 : 0.43
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 15
local mask changes: 2934846.0 / 11173962
choose client_indexes: [ 1  5 10 14 15], accoring to random
choose mask diff: [3651576.0, 3688196.0, 3716100.0, 3681694.0, 2934846.0]
Doing local aggregation!
test acc on this client before 121 / 504 : 0.24
Client Index = 15	Epoch: 0	Loss: 1.474781
Client Index = 15	Epoch: 1	Loss: 1.343858
Client Index = 15	Epoch: 2	Loss: 1.255492
Client Index = 15	Epoch: 3	Loss: 1.265216
Client Index = 15	Epoch: 4	Loss: 1.238310
test acc on this client after 299 / 504 : 0.59
-----------------------------------
training flops per data 2653324544.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 16
local mask changes: 2933356.0 / 11173962
choose client_indexes: [ 1  2 14 16 18], accoring to random
choose mask diff: [3706498.0, 3709912.0, 3720160.0, 2933356.0, 3706244.0]
Doing local aggregation!
test acc on this client before 288 / 503 : 0.57
Client Index = 16	Epoch: 0	Loss: 1.370768
Client Index = 16	Epoch: 1	Loss: 1.280644
Client Index = 16	Epoch: 2	Loss: 1.259704
Client Index = 16	Epoch: 3	Loss: 1.317635
Client Index = 16	Epoch: 4	Loss: 1.213928
test acc on this client after 266 / 503 : 0.53
-----------------------------------
training flops per data 2653331968.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 17
local mask changes: 2934916.0 / 11173962
choose client_indexes: [ 1  5  9 10 17], accoring to random
choose mask diff: [3660662.0, 3706762.0, 3685748.0, 3710720.0, 2934916.0]
Doing local aggregation!
test acc on this client before 231 / 505 : 0.46
Client Index = 17	Epoch: 0	Loss: 1.151609
Client Index = 17	Epoch: 1	Loss: 1.010595
Client Index = 17	Epoch: 2	Loss: 0.985294
Client Index = 17	Epoch: 3	Loss: 0.942830
Client Index = 17	Epoch: 4	Loss: 1.008625
test acc on this client after 308 / 505 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 18
local mask changes: 2934640.0 / 11173962
choose client_indexes: [ 6  9 10 17 18], accoring to random
choose mask diff: [3702610.0, 3689422.0, 3700298.0, 3696638.0, 2934640.0]
Doing local aggregation!
test acc on this client before 133 / 504 : 0.26
Client Index = 18	Epoch: 0	Loss: 1.211217
Client Index = 18	Epoch: 1	Loss: 1.004118
Client Index = 18	Epoch: 2	Loss: 0.902232
Client Index = 18	Epoch: 3	Loss: 0.926025
Client Index = 18	Epoch: 4	Loss: 0.903405
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(4) with spasity 0.5: 19
local mask changes: 2934768.0 / 11173962
choose client_indexes: [ 1  7  8 11 19], accoring to random
choose mask diff: [3705114.0, 3666386.0, 3731508.0, 3683078.0, 2934768.0]
Doing local aggregation!
test acc on this client before 92 / 506 : 0.18
Client Index = 19	Epoch: 0	Loss: 1.467481
Client Index = 19	Epoch: 1	Loss: 1.376017
Client Index = 19	Epoch: 2	Loss: 1.257540
Client Index = 19	Epoch: 3	Loss: 1.255176
Client Index = 19	Epoch: 4	Loss: 1.283007
test acc on this client after 270 / 506 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 4
{'test_acc': 0.5234786834090854, 'test_loss': 1.3881170717197713}
################local_test_on_all_clients before local training in communication round: 4
{'test_acc': 0.32119661728526455, 'test_loss': 1.912369983163512}
################Communication round : 5
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 0
local mask changes: 2929950.0 / 11173962
choose client_indexes: [ 0  1  7 15 19], accoring to random
choose mask diff: [2929950.0, 3555478.0, 3554062.0, 3573650.0, 3553242.0]
Doing local aggregation!
test acc on this client before 125 / 504 : 0.25
Client Index = 0	Epoch: 0	Loss: 1.668840
Client Index = 0	Epoch: 1	Loss: 1.757778
Client Index = 0	Epoch: 2	Loss: 1.594332
Client Index = 0	Epoch: 3	Loss: 1.628707
Client Index = 0	Epoch: 4	Loss: 1.610532
test acc on this client after 226 / 504 : 0.45
-----------------------------------
training flops per data 2653341440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 1
local mask changes: 2932074.0 / 11173962
choose client_indexes: [ 0  1  5 15 17], accoring to random
choose mask diff: [3540436.0, 2932074.0, 3534956.0, 3555582.0, 3544552.0]
Doing local aggregation!
test acc on this client before 120 / 503 : 0.24
Client Index = 1	Epoch: 0	Loss: 1.105579
Client Index = 1	Epoch: 1	Loss: 1.128762
Client Index = 1	Epoch: 2	Loss: 1.012706
Client Index = 1	Epoch: 3	Loss: 1.126350
Client Index = 1	Epoch: 4	Loss: 1.026285
test acc on this client after 319 / 503 : 0.63
-----------------------------------
training flops per data 2653337344.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 2
local mask changes: 2932316.0 / 11173962
choose client_indexes: [ 0  2  6 16 18], accoring to random
choose mask diff: [3554546.0, 2932316.0, 3583194.0, 3582354.0, 3549702.0]
Doing local aggregation!
test acc on this client before 101 / 502 : 0.20
Client Index = 2	Epoch: 0	Loss: 1.080367
Client Index = 2	Epoch: 1	Loss: 0.952908
Client Index = 2	Epoch: 2	Loss: 0.953177
Client Index = 2	Epoch: 3	Loss: 0.983093
Client Index = 2	Epoch: 4	Loss: 0.946699
test acc on this client after 352 / 502 : 0.70
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 3
local mask changes: 2927914.0 / 11173962
choose client_indexes: [ 1  3  5  6 14], accoring to random
choose mask diff: [3569136.0, 2927914.0, 3554664.0, 3547540.0, 3529012.0]
Doing local aggregation!
test acc on this client before 143 / 504 : 0.28
Client Index = 3	Epoch: 0	Loss: 1.431249
Client Index = 3	Epoch: 1	Loss: 1.395783
Client Index = 3	Epoch: 2	Loss: 1.371079
Client Index = 3	Epoch: 3	Loss: 1.289403
Client Index = 3	Epoch: 4	Loss: 1.363989
test acc on this client after 248 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 4
local mask changes: 2931740.0 / 11173962
choose client_indexes: [ 0  4  7 12 14], accoring to random
choose mask diff: [3547370.0, 2931740.0, 3581758.0, 3572344.0, 3556960.0]
Doing local aggregation!
test acc on this client before 163 / 503 : 0.32
Client Index = 4	Epoch: 0	Loss: 1.172389
Client Index = 4	Epoch: 1	Loss: 0.945577
Client Index = 4	Epoch: 2	Loss: 0.944261
Client Index = 4	Epoch: 3	Loss: 0.971860
Client Index = 4	Epoch: 4	Loss: 0.976779
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 5
local mask changes: 2931596.0 / 11173962
choose client_indexes: [ 5  6  8 11 14], accoring to random
choose mask diff: [2931596.0, 3567242.0, 3558660.0, 3571210.0, 3559740.0]
Doing local aggregation!
test acc on this client before 215 / 504 : 0.43
Client Index = 5	Epoch: 0	Loss: 1.300341
Client Index = 5	Epoch: 1	Loss: 1.249158
Client Index = 5	Epoch: 2	Loss: 1.144799
Client Index = 5	Epoch: 3	Loss: 1.162648
Client Index = 5	Epoch: 4	Loss: 1.150240
test acc on this client after 259 / 504 : 0.51
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 6
local mask changes: 2929366.0 / 11173962
choose client_indexes: [ 1  6  8 10 17], accoring to random
choose mask diff: [3552598.0, 2929366.0, 3549274.0, 3553862.0, 3530076.0]
Doing local aggregation!
test acc on this client before 124 / 505 : 0.25
Client Index = 6	Epoch: 0	Loss: 1.633298
Client Index = 6	Epoch: 1	Loss: 1.545534
Client Index = 6	Epoch: 2	Loss: 1.484949
Client Index = 6	Epoch: 3	Loss: 1.532844
Client Index = 6	Epoch: 4	Loss: 1.471860
test acc on this client after 176 / 505 : 0.35
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 7
local mask changes: 2930378.0 / 11173962
choose client_indexes: [ 0  1  3  7 12], accoring to random
choose mask diff: [3545856.0, 3551952.0, 3570048.0, 2930378.0, 3559146.0]
Doing local aggregation!
test acc on this client before 179 / 504 : 0.36
Client Index = 7	Epoch: 0	Loss: 1.480115
Client Index = 7	Epoch: 1	Loss: 1.447828
Client Index = 7	Epoch: 2	Loss: 1.340072
Client Index = 7	Epoch: 3	Loss: 1.321873
Client Index = 7	Epoch: 4	Loss: 1.380057
test acc on this client after 239 / 504 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 8
local mask changes: 2931722.0 / 11173962
choose client_indexes: [ 3  8 15 18 19], accoring to random
choose mask diff: [3573900.0, 2931722.0, 3566016.0, 3547714.0, 3558094.0]
Doing local aggregation!
test acc on this client before 99 / 504 : 0.20
Client Index = 8	Epoch: 0	Loss: 1.548497
Client Index = 8	Epoch: 1	Loss: 1.396095
Client Index = 8	Epoch: 2	Loss: 1.423940
Client Index = 8	Epoch: 3	Loss: 1.356946
Client Index = 8	Epoch: 4	Loss: 1.304336
test acc on this client after 228 / 504 : 0.45
-----------------------------------
training flops per data 2653341440.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 9
local mask changes: 2932128.0 / 11173962
choose client_indexes: [3 4 6 8 9], accoring to random
choose mask diff: [3583402.0, 3568406.0, 3580890.0, 3551588.0, 2932128.0]
Doing local aggregation!
test acc on this client before 180 / 504 : 0.36
Client Index = 9	Epoch: 0	Loss: 1.441415
Client Index = 9	Epoch: 1	Loss: 1.284971
Client Index = 9	Epoch: 2	Loss: 1.306047
Client Index = 9	Epoch: 3	Loss: 1.198102
Client Index = 9	Epoch: 4	Loss: 1.212596
test acc on this client after 247 / 504 : 0.49
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 10
local mask changes: 2932986.0 / 11173962
choose client_indexes: [ 3  9 10 13 14], accoring to random
choose mask diff: [3542290.0, 3560788.0, 2932986.0, 3539884.0, 3547030.0]
Doing local aggregation!
test acc on this client before 124 / 503 : 0.25
Client Index = 10	Epoch: 0	Loss: 1.596064
Client Index = 10	Epoch: 1	Loss: 1.466561
Client Index = 10	Epoch: 2	Loss: 1.445244
Client Index = 10	Epoch: 3	Loss: 1.451088
Client Index = 10	Epoch: 4	Loss: 1.485771
test acc on this client after 217 / 503 : 0.43
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 11
local mask changes: 2931330.0 / 11173962
choose client_indexes: [ 1 10 11 12 14], accoring to random
choose mask diff: [3553730.0, 3552270.0, 2931330.0, 3574886.0, 3560476.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 11	Epoch: 0	Loss: 1.354847
Client Index = 11	Epoch: 1	Loss: 1.118332
Client Index = 11	Epoch: 2	Loss: 1.087183
Client Index = 11	Epoch: 3	Loss: 1.085912
Client Index = 11	Epoch: 4	Loss: 1.016321
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653331968.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 12
local mask changes: 2929928.0 / 11173962
choose client_indexes: [ 0  4 12 15 19], accoring to random
choose mask diff: [3527834.0, 3575152.0, 2929928.0, 3572148.0, 3573486.0]
Doing local aggregation!
test acc on this client before 278 / 504 : 0.55
Client Index = 12	Epoch: 0	Loss: 1.308694
Client Index = 12	Epoch: 1	Loss: 1.175811
Client Index = 12	Epoch: 2	Loss: 1.219128
Client Index = 12	Epoch: 3	Loss: 1.149413
Client Index = 12	Epoch: 4	Loss: 1.162548
test acc on this client after 324 / 504 : 0.64
-----------------------------------
training flops per data 2653325568.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 13
local mask changes: 2930482.0 / 11173962
choose client_indexes: [ 3 11 13 18 19], accoring to random
choose mask diff: [3596686.0, 3572206.0, 2930482.0, 3572556.0, 3559798.0]
Doing local aggregation!
test acc on this client before 144 / 503 : 0.29
Client Index = 13	Epoch: 0	Loss: 1.534366
Client Index = 13	Epoch: 1	Loss: 1.502558
Client Index = 13	Epoch: 2	Loss: 1.418110
Client Index = 13	Epoch: 3	Loss: 1.397838
Client Index = 13	Epoch: 4	Loss: 1.415448
test acc on this client after 256 / 503 : 0.51
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 14
local mask changes: 2930250.0 / 11173962
choose client_indexes: [ 2  6 13 14 17], accoring to random
choose mask diff: [3555350.0, 3552914.0, 3552754.0, 2930250.0, 3548328.0]
Doing local aggregation!
test acc on this client before 112 / 502 : 0.22
Client Index = 14	Epoch: 0	Loss: 1.606535
Client Index = 14	Epoch: 1	Loss: 1.547430
Client Index = 14	Epoch: 2	Loss: 1.526036
Client Index = 14	Epoch: 3	Loss: 1.461708
Client Index = 14	Epoch: 4	Loss: 1.464020
test acc on this client after 239 / 502 : 0.48
-----------------------------------
training flops per data 2653338112.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 15
local mask changes: 2931578.0 / 11173962
choose client_indexes: [ 0 11 12 13 15], accoring to random
choose mask diff: [3578516.0, 3549232.0, 3576244.0, 3544768.0, 2931578.0]
Doing local aggregation!
test acc on this client before 143 / 504 : 0.28
Client Index = 15	Epoch: 0	Loss: 1.361083
Client Index = 15	Epoch: 1	Loss: 1.350980
Client Index = 15	Epoch: 2	Loss: 1.185877
Client Index = 15	Epoch: 3	Loss: 1.203417
Client Index = 15	Epoch: 4	Loss: 1.203016
test acc on this client after 293 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 16
local mask changes: 2932384.0 / 11173962
choose client_indexes: [ 2  5  8 16 17], accoring to random
choose mask diff: [3549788.0, 3566974.0, 3579626.0, 2932384.0, 3525090.0]
Doing local aggregation!
test acc on this client before 83 / 503 : 0.17
Client Index = 16	Epoch: 0	Loss: 1.404559
Client Index = 16	Epoch: 1	Loss: 1.308112
Client Index = 16	Epoch: 2	Loss: 1.243107
Client Index = 16	Epoch: 3	Loss: 1.214383
Client Index = 16	Epoch: 4	Loss: 1.172136
test acc on this client after 307 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 17
local mask changes: 2931702.0 / 11173962
choose client_indexes: [ 1  9 13 17 19], accoring to random
choose mask diff: [3518890.0, 3529658.0, 3565886.0, 2931702.0, 3582666.0]
Doing local aggregation!
test acc on this client before 242 / 505 : 0.48
Client Index = 17	Epoch: 0	Loss: 1.107029
Client Index = 17	Epoch: 1	Loss: 0.941272
Client Index = 17	Epoch: 2	Loss: 0.960721
Client Index = 17	Epoch: 3	Loss: 0.925926
Client Index = 17	Epoch: 4	Loss: 0.924226
test acc on this client after 286 / 505 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 18
local mask changes: 2930196.0 / 11173962
choose client_indexes: [ 2  5 14 17 18], accoring to random
choose mask diff: [3545508.0, 3532424.0, 3564102.0, 3534330.0, 2930196.0]
Doing local aggregation!
test acc on this client before 83 / 504 : 0.16
Client Index = 18	Epoch: 0	Loss: 1.094267
Client Index = 18	Epoch: 1	Loss: 0.914631
Client Index = 18	Epoch: 2	Loss: 0.947341
Client Index = 18	Epoch: 3	Loss: 0.871090
Client Index = 18	Epoch: 4	Loss: 0.853199
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653333504.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(5) with spasity 0.5: 19
local mask changes: 2929182.0 / 11173962
choose client_indexes: [ 7  9 12 15 19], accoring to random
choose mask diff: [3537332.0, 3571568.0, 3566506.0, 3554846.0, 2929182.0]
Doing local aggregation!
test acc on this client before 213 / 506 : 0.42
Client Index = 19	Epoch: 0	Loss: 1.395652
Client Index = 19	Epoch: 1	Loss: 1.223325
Client Index = 19	Epoch: 2	Loss: 1.192465
Client Index = 19	Epoch: 3	Loss: 1.233667
Client Index = 19	Epoch: 4	Loss: 1.188686
test acc on this client after 295 / 506 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 5
{'test_acc': 0.549617312456286, 'test_loss': 1.2767405460587826}
################local_test_on_all_clients before local training in communication round: 5
{'test_acc': 0.31215698345684384, 'test_loss': 1.8273442213920952}
################Communication round : 6
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 0
local mask changes: 2926558.0 / 11173962
choose client_indexes: [ 0  3 10 13 18], accoring to random
choose mask diff: [2926558.0, 3436020.0, 3429000.0, 3449746.0, 3437894.0]
Doing local aggregation!
test acc on this client before 214 / 504 : 0.42
Client Index = 0	Epoch: 0	Loss: 1.603682
Client Index = 0	Epoch: 1	Loss: 1.586372
Client Index = 0	Epoch: 2	Loss: 1.567098
Client Index = 0	Epoch: 3	Loss: 1.555195
Client Index = 0	Epoch: 4	Loss: 1.533267
test acc on this client after 180 / 504 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 1
local mask changes: 2926768.0 / 11173962
choose client_indexes: [ 0  1  8 14 18], accoring to random
choose mask diff: [3421454.0, 2926768.0, 3438652.0, 3428148.0, 3430718.0]
Doing local aggregation!
test acc on this client before 79 / 503 : 0.16
Client Index = 1	Epoch: 0	Loss: 1.165022
Client Index = 1	Epoch: 1	Loss: 1.055945
Client Index = 1	Epoch: 2	Loss: 1.023780
Client Index = 1	Epoch: 3	Loss: 0.993425
Client Index = 1	Epoch: 4	Loss: 1.068583
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653342720.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 2
local mask changes: 2927468.0 / 11173962
choose client_indexes: [ 0  2  5  9 16], accoring to random
choose mask diff: [3432602.0, 2927468.0, 3446672.0, 3439300.0, 3435882.0]
Doing local aggregation!
test acc on this client before 95 / 502 : 0.19
Client Index = 2	Epoch: 0	Loss: 1.030373
Client Index = 2	Epoch: 1	Loss: 0.960829
Client Index = 2	Epoch: 2	Loss: 0.918535
Client Index = 2	Epoch: 3	Loss: 0.864028
Client Index = 2	Epoch: 4	Loss: 0.892311
test acc on this client after 361 / 502 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 3
local mask changes: 2927388.0 / 11173962
choose client_indexes: [ 2  3  9 13 16], accoring to random
choose mask diff: [3428918.0, 2927388.0, 3455784.0, 3474278.0, 3458082.0]
Doing local aggregation!
test acc on this client before 134 / 504 : 0.27
Client Index = 3	Epoch: 0	Loss: 1.400018
Client Index = 3	Epoch: 1	Loss: 1.285139
Client Index = 3	Epoch: 2	Loss: 1.273814
Client Index = 3	Epoch: 3	Loss: 1.318505
Client Index = 3	Epoch: 4	Loss: 1.272052
test acc on this client after 227 / 504 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 4
local mask changes: 2926724.0 / 11173962
choose client_indexes: [ 1  4  9 16 17], accoring to random
choose mask diff: [3450372.0, 2926724.0, 3445476.0, 3454972.0, 3436582.0]
Doing local aggregation!
test acc on this client before 81 / 503 : 0.16
Client Index = 4	Epoch: 0	Loss: 1.216946
Client Index = 4	Epoch: 1	Loss: 0.957935
Client Index = 4	Epoch: 2	Loss: 0.923302
Client Index = 4	Epoch: 3	Loss: 0.973240
Client Index = 4	Epoch: 4	Loss: 0.888651
test acc on this client after 324 / 503 : 0.64
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 5
local mask changes: 2925932.0 / 11173962
choose client_indexes: [ 0  5  6  8 10], accoring to random
choose mask diff: [3430634.0, 2925932.0, 3442148.0, 3423642.0, 3440760.0]
Doing local aggregation!
test acc on this client before 296 / 504 : 0.59
Client Index = 5	Epoch: 0	Loss: 1.243574
Client Index = 5	Epoch: 1	Loss: 1.145699
Client Index = 5	Epoch: 2	Loss: 1.142302
Client Index = 5	Epoch: 3	Loss: 1.090857
Client Index = 5	Epoch: 4	Loss: 1.078538
test acc on this client after 279 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 6
local mask changes: 2926888.0 / 11173962
choose client_indexes: [ 5  6 11 12 18], accoring to random
choose mask diff: [3436144.0, 2926888.0, 3457896.0, 3436056.0, 3431846.0]
Doing local aggregation!
test acc on this client before 138 / 505 : 0.27
Client Index = 6	Epoch: 0	Loss: 1.573894
Client Index = 6	Epoch: 1	Loss: 1.469052
Client Index = 6	Epoch: 2	Loss: 1.444917
Client Index = 6	Epoch: 3	Loss: 1.484662
Client Index = 6	Epoch: 4	Loss: 1.409792
test acc on this client after 222 / 505 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 7
local mask changes: 2927566.0 / 11173962
choose client_indexes: [ 4  7  8 15 17], accoring to random
choose mask diff: [3456746.0, 2927566.0, 3454358.0, 3450010.0, 3426122.0]
Doing local aggregation!
test acc on this client before 225 / 504 : 0.45
Client Index = 7	Epoch: 0	Loss: 1.401829
Client Index = 7	Epoch: 1	Loss: 1.359022
Client Index = 7	Epoch: 2	Loss: 1.283575
Client Index = 7	Epoch: 3	Loss: 1.275331
Client Index = 7	Epoch: 4	Loss: 1.270877
test acc on this client after 193 / 504 : 0.38
-----------------------------------
training flops per data 2653337600.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 8
local mask changes: 2927390.0 / 11173962
choose client_indexes: [ 0  4  8 15 16], accoring to random
choose mask diff: [3456024.0, 3441756.0, 2927390.0, 3437334.0, 3455574.0]
Doing local aggregation!
test acc on this client before 191 / 504 : 0.38
Client Index = 8	Epoch: 0	Loss: 1.433739
Client Index = 8	Epoch: 1	Loss: 1.367491
Client Index = 8	Epoch: 2	Loss: 1.338118
Client Index = 8	Epoch: 3	Loss: 1.317935
Client Index = 8	Epoch: 4	Loss: 1.302291
test acc on this client after 263 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 9
local mask changes: 2925490.0 / 11173962
choose client_indexes: [ 0  2  9 13 17], accoring to random
choose mask diff: [3452746.0, 3437946.0, 2925490.0, 3469128.0, 3421802.0]
Doing local aggregation!
test acc on this client before 193 / 504 : 0.38
Client Index = 9	Epoch: 0	Loss: 1.339068
Client Index = 9	Epoch: 1	Loss: 1.274138
Client Index = 9	Epoch: 2	Loss: 1.179131
Client Index = 9	Epoch: 3	Loss: 1.202307
Client Index = 9	Epoch: 4	Loss: 1.179875
test acc on this client after 253 / 504 : 0.50
-----------------------------------
training flops per data 2653336320.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 10
local mask changes: 2927274.0 / 11173962
choose client_indexes: [ 6  7  9 10 19], accoring to random
choose mask diff: [3453880.0, 3458922.0, 3437230.0, 2927274.0, 3456374.0]
Doing local aggregation!
test acc on this client before 220 / 503 : 0.44
Client Index = 10	Epoch: 0	Loss: 1.488580
Client Index = 10	Epoch: 1	Loss: 1.455105
Client Index = 10	Epoch: 2	Loss: 1.396795
Client Index = 10	Epoch: 3	Loss: 1.422055
Client Index = 10	Epoch: 4	Loss: 1.373074
test acc on this client after 261 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 11
local mask changes: 2927178.0 / 11173962
choose client_indexes: [ 2  5  6 11 15], accoring to random
choose mask diff: [3451230.0, 3446916.0, 3458824.0, 2927178.0, 3435478.0]
Doing local aggregation!
test acc on this client before 221 / 504 : 0.44
Client Index = 11	Epoch: 0	Loss: 1.186638
Client Index = 11	Epoch: 1	Loss: 1.015737
Client Index = 11	Epoch: 2	Loss: 1.041391
Client Index = 11	Epoch: 3	Loss: 1.048298
Client Index = 11	Epoch: 4	Loss: 0.976089
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 12
local mask changes: 2926134.0 / 11173962
choose client_indexes: [ 1  4 12 13 16], accoring to random
choose mask diff: [3436238.0, 3445966.0, 2926134.0, 3450210.0, 3427900.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 12	Epoch: 0	Loss: 1.272817
Client Index = 12	Epoch: 1	Loss: 1.166614
Client Index = 12	Epoch: 2	Loss: 1.160374
Client Index = 12	Epoch: 3	Loss: 1.127739
Client Index = 12	Epoch: 4	Loss: 1.164112
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653342208.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 13
local mask changes: 2927322.0 / 11173962
choose client_indexes: [ 5 12 13 18 19], accoring to random
choose mask diff: [3442730.0, 3446276.0, 2927322.0, 3450728.0, 3432956.0]
Doing local aggregation!
test acc on this client before 178 / 503 : 0.35
Client Index = 13	Epoch: 0	Loss: 1.434342
Client Index = 13	Epoch: 1	Loss: 1.418223
Client Index = 13	Epoch: 2	Loss: 1.393154
Client Index = 13	Epoch: 3	Loss: 1.335146
Client Index = 13	Epoch: 4	Loss: 1.369986
test acc on this client after 240 / 503 : 0.48
-----------------------------------
training flops per data 2653338624.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 14
local mask changes: 2927186.0 / 11173962
choose client_indexes: [ 3  7 12 13 14], accoring to random
choose mask diff: [3427366.0, 3449872.0, 3442738.0, 3438016.0, 2927186.0]
Doing local aggregation!
test acc on this client before 231 / 502 : 0.46
Client Index = 14	Epoch: 0	Loss: 1.503095
Client Index = 14	Epoch: 1	Loss: 1.539904
Client Index = 14	Epoch: 2	Loss: 1.438755
Client Index = 14	Epoch: 3	Loss: 1.345540
Client Index = 14	Epoch: 4	Loss: 1.430726
test acc on this client after 222 / 502 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 15
local mask changes: 2926620.0 / 11173962
choose client_indexes: [ 1 13 15 17 19], accoring to random
choose mask diff: [3429216.0, 3432726.0, 2926620.0, 3435688.0, 3451724.0]
Doing local aggregation!
test acc on this client before 158 / 504 : 0.31
Client Index = 15	Epoch: 0	Loss: 1.337274
Client Index = 15	Epoch: 1	Loss: 1.253440
Client Index = 15	Epoch: 2	Loss: 1.205132
Client Index = 15	Epoch: 3	Loss: 1.146712
Client Index = 15	Epoch: 4	Loss: 1.141518
test acc on this client after 307 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 16
local mask changes: 2926344.0 / 11173962
choose client_indexes: [ 6  7 13 15 16], accoring to random
choose mask diff: [3459396.0, 3448082.0, 3447736.0, 3454220.0, 2926344.0]
Doing local aggregation!
test acc on this client before 122 / 503 : 0.24
Client Index = 16	Epoch: 0	Loss: 1.284832
Client Index = 16	Epoch: 1	Loss: 1.216126
Client Index = 16	Epoch: 2	Loss: 1.146455
Client Index = 16	Epoch: 3	Loss: 1.172759
Client Index = 16	Epoch: 4	Loss: 1.115431
test acc on this client after 306 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 17
local mask changes: 2925096.0 / 11173962
choose client_indexes: [ 7  8 10 11 17], accoring to random
choose mask diff: [3426158.0, 3437014.0, 3443874.0, 3458508.0, 2925096.0]
Doing local aggregation!
test acc on this client before 105 / 505 : 0.21
Client Index = 17	Epoch: 0	Loss: 1.129319
Client Index = 17	Epoch: 1	Loss: 0.951058
Client Index = 17	Epoch: 2	Loss: 0.940253
Client Index = 17	Epoch: 3	Loss: 0.890978
Client Index = 17	Epoch: 4	Loss: 0.925164
test acc on this client after 226 / 505 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 18
local mask changes: 2926308.0 / 11173962
choose client_indexes: [ 1  6  9 10 18], accoring to random
choose mask diff: [3420408.0, 3437642.0, 3434334.0, 3436038.0, 2926308.0]
Doing local aggregation!
test acc on this client before 356 / 504 : 0.71
Client Index = 18	Epoch: 0	Loss: 1.042491
Client Index = 18	Epoch: 1	Loss: 0.867683
Client Index = 18	Epoch: 2	Loss: 0.839884
Client Index = 18	Epoch: 3	Loss: 1.030503
Client Index = 18	Epoch: 4	Loss: 0.825936
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(6) with spasity 0.5: 19
local mask changes: 2926074.0 / 11173962
choose client_indexes: [ 0  1  3 16 19], accoring to random
choose mask diff: [3442304.0, 3437946.0, 3462082.0, 3458612.0, 2926074.0]
Doing local aggregation!
test acc on this client before 155 / 506 : 0.31
Client Index = 19	Epoch: 0	Loss: 1.253781
Client Index = 19	Epoch: 1	Loss: 1.245784
Client Index = 19	Epoch: 2	Loss: 1.246660
Client Index = 19	Epoch: 3	Loss: 1.157582
Client Index = 19	Epoch: 4	Loss: 1.215129
test acc on this client after 244 / 506 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 6
{'test_acc': 0.5371406462509115, 'test_loss': 1.3090720053020084}
################local_test_on_all_clients before local training in communication round: 6
{'test_acc': 0.3618607993163406, 'test_loss': 1.7450216995381092}
################Communication round : 7
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 0
local mask changes: 2919300.0 / 11173962
choose client_indexes: [ 0  4  9 14 19], accoring to random
choose mask diff: [2919300.0, 3346872.0, 3356786.0, 3343072.0, 3348062.0]
Doing local aggregation!
test acc on this client before 155 / 504 : 0.31
Client Index = 0	Epoch: 0	Loss: 1.546067
Client Index = 0	Epoch: 1	Loss: 1.558064
Client Index = 0	Epoch: 2	Loss: 1.545383
Client Index = 0	Epoch: 3	Loss: 1.496099
Client Index = 0	Epoch: 4	Loss: 1.476380
test acc on this client after 220 / 504 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 1
local mask changes: 2921842.0 / 11173962
choose client_indexes: [ 1  7 13 14 16], accoring to random
choose mask diff: [2921842.0, 3345090.0, 3349414.0, 3326120.0, 3347432.0]
Doing local aggregation!
test acc on this client before 125 / 503 : 0.25
Client Index = 1	Epoch: 0	Loss: 1.128943
Client Index = 1	Epoch: 1	Loss: 0.983150
Client Index = 1	Epoch: 2	Loss: 0.990622
Client Index = 1	Epoch: 3	Loss: 1.039001
Client Index = 1	Epoch: 4	Loss: 1.013273
test acc on this client after 314 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 2
local mask changes: 2921956.0 / 11173962
choose client_indexes: [ 2  4  9 17 19], accoring to random
choose mask diff: [2921956.0, 3340704.0, 3331300.0, 3341690.0, 3363188.0]
Doing local aggregation!
test acc on this client before 347 / 502 : 0.69
Client Index = 2	Epoch: 0	Loss: 1.037354
Client Index = 2	Epoch: 1	Loss: 0.885703
Client Index = 2	Epoch: 2	Loss: 0.877118
Client Index = 2	Epoch: 3	Loss: 0.903788
Client Index = 2	Epoch: 4	Loss: 0.874657
test acc on this client after 349 / 502 : 0.70
-----------------------------------
training flops per data 2653342464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 3
local mask changes: 2923122.0 / 11173962
choose client_indexes: [ 0  3  6  8 11], accoring to random
choose mask diff: [3345964.0, 2923122.0, 3343610.0, 3347086.0, 3345666.0]
Doing local aggregation!
test acc on this client before 255 / 504 : 0.51
Client Index = 3	Epoch: 0	Loss: 1.341191
Client Index = 3	Epoch: 1	Loss: 1.305391
Client Index = 3	Epoch: 2	Loss: 1.271095
Client Index = 3	Epoch: 3	Loss: 1.252965
Client Index = 3	Epoch: 4	Loss: 1.216190
test acc on this client after 261 / 504 : 0.52
-----------------------------------
training flops per data 2653341696.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 4
local mask changes: 2922048.0 / 11173962
choose client_indexes: [0 4 5 7 8], accoring to random
choose mask diff: [3337638.0, 2922048.0, 3343600.0, 3348446.0, 3350430.0]
Doing local aggregation!
test acc on this client before 158 / 503 : 0.31
Client Index = 4	Epoch: 0	Loss: 1.140138
Client Index = 4	Epoch: 1	Loss: 0.908028
Client Index = 4	Epoch: 2	Loss: 0.964955
Client Index = 4	Epoch: 3	Loss: 0.874655
Client Index = 4	Epoch: 4	Loss: 0.889501
test acc on this client after 289 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 5
local mask changes: 2919392.0 / 11173962
choose client_indexes: [ 1  5  9 14 16], accoring to random
choose mask diff: [3331054.0, 2919392.0, 3345578.0, 3340494.0, 3350936.0]
Doing local aggregation!
test acc on this client before 221 / 504 : 0.44
Client Index = 5	Epoch: 0	Loss: 1.185150
Client Index = 5	Epoch: 1	Loss: 1.163344
Client Index = 5	Epoch: 2	Loss: 1.068198
Client Index = 5	Epoch: 3	Loss: 1.088299
Client Index = 5	Epoch: 4	Loss: 1.053403
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 6
local mask changes: 2921690.0 / 11173962
choose client_indexes: [ 6  8 14 16 18], accoring to random
choose mask diff: [2921690.0, 3341492.0, 3336562.0, 3354172.0, 3334722.0]
Doing local aggregation!
test acc on this client before 187 / 505 : 0.37
Client Index = 6	Epoch: 0	Loss: 1.456978
Client Index = 6	Epoch: 1	Loss: 1.492294
Client Index = 6	Epoch: 2	Loss: 1.390183
Client Index = 6	Epoch: 3	Loss: 1.396645
Client Index = 6	Epoch: 4	Loss: 1.375238
test acc on this client after 199 / 505 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 7
local mask changes: 2919918.0 / 11173962
choose client_indexes: [ 2  7 10 14 18], accoring to random
choose mask diff: [3353102.0, 2919918.0, 3356326.0, 3351054.0, 3357372.0]
Doing local aggregation!
test acc on this client before 230 / 504 : 0.46
Client Index = 7	Epoch: 0	Loss: 1.350942
Client Index = 7	Epoch: 1	Loss: 1.338437
Client Index = 7	Epoch: 2	Loss: 1.263604
Client Index = 7	Epoch: 3	Loss: 1.254368
Client Index = 7	Epoch: 4	Loss: 1.256571
test acc on this client after 269 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 8
local mask changes: 2922118.0 / 11173962
choose client_indexes: [ 1  3  8  9 15], accoring to random
choose mask diff: [3340322.0, 3352126.0, 2922118.0, 3343220.0, 3340098.0]
Doing local aggregation!
test acc on this client before 225 / 504 : 0.45
Client Index = 8	Epoch: 0	Loss: 1.430822
Client Index = 8	Epoch: 1	Loss: 1.346430
Client Index = 8	Epoch: 2	Loss: 1.317634
Client Index = 8	Epoch: 3	Loss: 1.281486
Client Index = 8	Epoch: 4	Loss: 1.291141
test acc on this client after 236 / 504 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 9
local mask changes: 2922964.0 / 11173962
choose client_indexes: [ 1  3  4  9 15], accoring to random
choose mask diff: [3338170.0, 3353586.0, 3351882.0, 2922964.0, 3353262.0]
Doing local aggregation!
test acc on this client before 252 / 504 : 0.50
Client Index = 9	Epoch: 0	Loss: 1.304198
Client Index = 9	Epoch: 1	Loss: 1.149838
Client Index = 9	Epoch: 2	Loss: 1.162661
Client Index = 9	Epoch: 3	Loss: 1.142462
Client Index = 9	Epoch: 4	Loss: 1.096707
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 10
local mask changes: 2921282.0 / 11173962
choose client_indexes: [ 4 10 12 14 15], accoring to random
choose mask diff: [3344274.0, 2921282.0, 3347392.0, 3334390.0, 3349516.0]
Doing local aggregation!
test acc on this client before 164 / 503 : 0.33
Client Index = 10	Epoch: 0	Loss: 1.430607
Client Index = 10	Epoch: 1	Loss: 1.379028
Client Index = 10	Epoch: 2	Loss: 1.348619
Client Index = 10	Epoch: 3	Loss: 1.334815
Client Index = 10	Epoch: 4	Loss: 1.343916
test acc on this client after 200 / 503 : 0.40
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 11
local mask changes: 2921224.0 / 11173962
choose client_indexes: [ 1  8 10 11 18], accoring to random
choose mask diff: [3341904.0, 3358678.0, 3347018.0, 2921224.0, 3355144.0]
Doing local aggregation!
test acc on this client before 280 / 504 : 0.56
Client Index = 11	Epoch: 0	Loss: 1.182074
Client Index = 11	Epoch: 1	Loss: 1.059019
Client Index = 11	Epoch: 2	Loss: 1.024086
Client Index = 11	Epoch: 3	Loss: 0.944511
Client Index = 11	Epoch: 4	Loss: 0.897614
test acc on this client after 331 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 12
local mask changes: 2919964.0 / 11173962
choose client_indexes: [ 1  3  6 12 19], accoring to random
choose mask diff: [3333300.0, 3352354.0, 3351230.0, 2919964.0, 3343850.0]
Doing local aggregation!
test acc on this client before 313 / 504 : 0.62
Client Index = 12	Epoch: 0	Loss: 1.205146
Client Index = 12	Epoch: 1	Loss: 1.147578
Client Index = 12	Epoch: 2	Loss: 1.123660
Client Index = 12	Epoch: 3	Loss: 1.123671
Client Index = 12	Epoch: 4	Loss: 1.083034
test acc on this client after 325 / 504 : 0.64
-----------------------------------
training flops per data 2653342464.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 13
local mask changes: 2921686.0 / 11173962
choose client_indexes: [ 1  6  8 10 13], accoring to random
choose mask diff: [3344672.0, 3357942.0, 3355254.0, 3342610.0, 2921686.0]
Doing local aggregation!
test acc on this client before 221 / 503 : 0.44
Client Index = 13	Epoch: 0	Loss: 1.426089
Client Index = 13	Epoch: 1	Loss: 1.349983
Client Index = 13	Epoch: 2	Loss: 1.372292
Client Index = 13	Epoch: 3	Loss: 1.268035
Client Index = 13	Epoch: 4	Loss: 1.300977
test acc on this client after 275 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 14
local mask changes: 2920022.0 / 11173962
choose client_indexes: [ 0  7 14 16 18], accoring to random
choose mask diff: [3346660.0, 3345754.0, 2920022.0, 3356678.0, 3349810.0]
Doing local aggregation!
test acc on this client before 247 / 502 : 0.49
Client Index = 14	Epoch: 0	Loss: 1.397794
Client Index = 14	Epoch: 1	Loss: 1.434185
Client Index = 14	Epoch: 2	Loss: 1.367370
Client Index = 14	Epoch: 3	Loss: 1.407468
Client Index = 14	Epoch: 4	Loss: 1.346685
test acc on this client after 258 / 502 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 15
local mask changes: 2921816.0 / 11173962
choose client_indexes: [ 7 10 11 15 16], accoring to random
choose mask diff: [3353422.0, 3346310.0, 3346724.0, 2921816.0, 3363360.0]
Doing local aggregation!
test acc on this client before 155 / 504 : 0.31
Client Index = 15	Epoch: 0	Loss: 1.337875
Client Index = 15	Epoch: 1	Loss: 1.153171
Client Index = 15	Epoch: 2	Loss: 1.168840
Client Index = 15	Epoch: 3	Loss: 1.093976
Client Index = 15	Epoch: 4	Loss: 1.162643
test acc on this client after 311 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 16
local mask changes: 2920650.0 / 11173962
choose client_indexes: [ 0  2 11 15 16], accoring to random
choose mask diff: [3346026.0, 3339554.0, 3356624.0, 3348722.0, 2920650.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 16	Epoch: 0	Loss: 1.198156
Client Index = 16	Epoch: 1	Loss: 1.218163
Client Index = 16	Epoch: 2	Loss: 1.137151
Client Index = 16	Epoch: 3	Loss: 1.065558
Client Index = 16	Epoch: 4	Loss: 1.068195
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 17
local mask changes: 2920670.0 / 11173962
choose client_indexes: [ 1  3 11 16 17], accoring to random
choose mask diff: [3319706.0, 3348388.0, 3346652.0, 3340992.0, 2920670.0]
Doing local aggregation!
test acc on this client before 248 / 505 : 0.49
Client Index = 17	Epoch: 0	Loss: 1.047506
Client Index = 17	Epoch: 1	Loss: 0.946892
Client Index = 17	Epoch: 2	Loss: 0.875050
Client Index = 17	Epoch: 3	Loss: 0.890784
Client Index = 17	Epoch: 4	Loss: 0.873444
test acc on this client after 292 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 18
local mask changes: 2922374.0 / 11173962
choose client_indexes: [ 6  7  9 14 18], accoring to random
choose mask diff: [3335066.0, 3354698.0, 3333752.0, 3338442.0, 2922374.0]
Doing local aggregation!
test acc on this client before 255 / 504 : 0.51
Client Index = 18	Epoch: 0	Loss: 0.939141
Client Index = 18	Epoch: 1	Loss: 0.832462
Client Index = 18	Epoch: 2	Loss: 0.879382
Client Index = 18	Epoch: 3	Loss: 0.771233
Client Index = 18	Epoch: 4	Loss: 0.827807
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653341696.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(7) with spasity 0.5: 19
local mask changes: 2923156.0 / 11173962
choose client_indexes: [ 0  1  2 16 19], accoring to random
choose mask diff: [3326278.0, 3333470.0, 3363000.0, 3356204.0, 2923156.0]
Doing local aggregation!
test acc on this client before 110 / 506 : 0.22
Client Index = 19	Epoch: 0	Loss: 1.274413
Client Index = 19	Epoch: 1	Loss: 1.213502
Client Index = 19	Epoch: 2	Loss: 1.129688
Client Index = 19	Epoch: 3	Loss: 1.155402
Client Index = 19	Epoch: 4	Loss: 1.114015
test acc on this client after 255 / 506 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 7
{'test_acc': 0.5606386259026326, 'test_loss': 1.230887276667381}
################local_test_on_all_clients before local training in communication round: 7
{'test_acc': 0.44415143931134776, 'test_loss': 1.5902207225187914}
################Communication round : 8
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 0
local mask changes: 2914742.0 / 11173962
choose client_indexes: [ 0  2  7  9 17], accoring to random
choose mask diff: [2914742.0, 3268664.0, 3270646.0, 3262040.0, 3267652.0]
Doing local aggregation!
test acc on this client before 152 / 504 : 0.30
Client Index = 0	Epoch: 0	Loss: 1.565728
Client Index = 0	Epoch: 1	Loss: 1.528003
Client Index = 0	Epoch: 2	Loss: 1.507104
Client Index = 0	Epoch: 3	Loss: 1.450423
Client Index = 0	Epoch: 4	Loss: 1.426859
test acc on this client after 261 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 1
local mask changes: 2915736.0 / 11173962
choose client_indexes: [ 1  9 13 17 19], accoring to random
choose mask diff: [2915736.0, 3269782.0, 3260462.0, 3251396.0, 3266780.0]
Doing local aggregation!
test acc on this client before 213 / 503 : 0.42
Client Index = 1	Epoch: 0	Loss: 1.045473
Client Index = 1	Epoch: 1	Loss: 0.957393
Client Index = 1	Epoch: 2	Loss: 1.026621
Client Index = 1	Epoch: 3	Loss: 0.916883
Client Index = 1	Epoch: 4	Loss: 1.010031
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 2
local mask changes: 2915036.0 / 11173962
choose client_indexes: [ 2  6  7 15 17], accoring to random
choose mask diff: [2915036.0, 3272670.0, 3272056.0, 3280450.0, 3255360.0]
Doing local aggregation!
test acc on this client before 318 / 502 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.893592
Client Index = 2	Epoch: 1	Loss: 0.902536
Client Index = 2	Epoch: 2	Loss: 0.869853
Client Index = 2	Epoch: 3	Loss: 0.856432
Client Index = 2	Epoch: 4	Loss: 0.829036
test acc on this client after 358 / 502 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 3
local mask changes: 2913738.0 / 11173962
choose client_indexes: [ 1  3  4 14 18], accoring to random
choose mask diff: [3267014.0, 2913738.0, 3267508.0, 3256736.0, 3270766.0]
Doing local aggregation!
test acc on this client before 119 / 504 : 0.24
Client Index = 3	Epoch: 0	Loss: 1.327467
Client Index = 3	Epoch: 1	Loss: 1.240996
Client Index = 3	Epoch: 2	Loss: 1.239011
Client Index = 3	Epoch: 3	Loss: 1.181777
Client Index = 3	Epoch: 4	Loss: 1.216322
test acc on this client after 263 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 4
local mask changes: 2915742.0 / 11173962
choose client_indexes: [ 1  4  9 11 19], accoring to random
choose mask diff: [3262292.0, 2915742.0, 3266636.0, 3272568.0, 3272250.0]
Doing local aggregation!
test acc on this client before 195 / 503 : 0.39
Client Index = 4	Epoch: 0	Loss: 1.010313
Client Index = 4	Epoch: 1	Loss: 0.929522
Client Index = 4	Epoch: 2	Loss: 0.904390
Client Index = 4	Epoch: 3	Loss: 0.847158
Client Index = 4	Epoch: 4	Loss: 0.892629
test acc on this client after 351 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 5
local mask changes: 2914216.0 / 11173962
choose client_indexes: [ 5  6  7 14 18], accoring to random
choose mask diff: [2914216.0, 3262700.0, 3267376.0, 3258524.0, 3265346.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 5	Epoch: 0	Loss: 1.105697
Client Index = 5	Epoch: 1	Loss: 1.082063
Client Index = 5	Epoch: 2	Loss: 1.097984
Client Index = 5	Epoch: 3	Loss: 1.070016
Client Index = 5	Epoch: 4	Loss: 1.010015
test acc on this client after 312 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 6
local mask changes: 2916538.0 / 11173962
choose client_indexes: [ 6  8 11 14 15], accoring to random
choose mask diff: [2916538.0, 3262668.0, 3268934.0, 3255460.0, 3277620.0]
Doing local aggregation!
test acc on this client before 171 / 505 : 0.34
Client Index = 6	Epoch: 0	Loss: 1.482168
Client Index = 6	Epoch: 1	Loss: 1.381860
Client Index = 6	Epoch: 2	Loss: 1.357889
Client Index = 6	Epoch: 3	Loss: 1.359929
Client Index = 6	Epoch: 4	Loss: 1.386507
test acc on this client after 213 / 505 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 7
local mask changes: 2914244.0 / 11173962
choose client_indexes: [ 0  7 10 12 18], accoring to random
choose mask diff: [3266268.0, 2914244.0, 3263902.0, 3270252.0, 3274064.0]
Doing local aggregation!
test acc on this client before 229 / 504 : 0.45
Client Index = 7	Epoch: 0	Loss: 1.348301
Client Index = 7	Epoch: 1	Loss: 1.235633
Client Index = 7	Epoch: 2	Loss: 1.287218
Client Index = 7	Epoch: 3	Loss: 1.188235
Client Index = 7	Epoch: 4	Loss: 1.205761
test acc on this client after 247 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 8
local mask changes: 2913172.0 / 11173962
choose client_indexes: [ 1  6  8 14 19], accoring to random
choose mask diff: [3255000.0, 3276172.0, 2913172.0, 3269230.0, 3274630.0]
Doing local aggregation!
test acc on this client before 196 / 504 : 0.39
Client Index = 8	Epoch: 0	Loss: 1.373227
Client Index = 8	Epoch: 1	Loss: 1.296178
Client Index = 8	Epoch: 2	Loss: 1.277450
Client Index = 8	Epoch: 3	Loss: 1.227978
Client Index = 8	Epoch: 4	Loss: 1.279577
test acc on this client after 245 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 9
local mask changes: 2914872.0 / 11173962
choose client_indexes: [ 0  1  9 15 17], accoring to random
choose mask diff: [3269738.0, 3259204.0, 2914872.0, 3266608.0, 3261184.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 9	Epoch: 0	Loss: 1.191894
Client Index = 9	Epoch: 1	Loss: 1.131214
Client Index = 9	Epoch: 2	Loss: 1.114350
Client Index = 9	Epoch: 3	Loss: 1.111427
Client Index = 9	Epoch: 4	Loss: 1.047342
test acc on this client after 280 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 10
local mask changes: 2915190.0 / 11173962
choose client_indexes: [ 4  6 10 11 14], accoring to random
choose mask diff: [3261918.0, 3273902.0, 2915190.0, 3279214.0, 3258086.0]
Doing local aggregation!
test acc on this client before 106 / 503 : 0.21
Client Index = 10	Epoch: 0	Loss: 1.434906
Client Index = 10	Epoch: 1	Loss: 1.390487
Client Index = 10	Epoch: 2	Loss: 1.324577
Client Index = 10	Epoch: 3	Loss: 1.340816
Client Index = 10	Epoch: 4	Loss: 1.304342
test acc on this client after 280 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 11
local mask changes: 2913626.0 / 11173962
choose client_indexes: [ 3  4 11 16 17], accoring to random
choose mask diff: [3268282.0, 3272738.0, 2913626.0, 3271544.0, 3271404.0]
Doing local aggregation!
test acc on this client before 208 / 504 : 0.41
Client Index = 11	Epoch: 0	Loss: 1.128585
Client Index = 11	Epoch: 1	Loss: 0.954916
Client Index = 11	Epoch: 2	Loss: 0.927253
Client Index = 11	Epoch: 3	Loss: 0.898477
Client Index = 11	Epoch: 4	Loss: 0.937257
test acc on this client after 318 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 12
local mask changes: 2914910.0 / 11173962
choose client_indexes: [ 9 12 13 16 18], accoring to random
choose mask diff: [3273158.0, 2914910.0, 3266016.0, 3261992.0, 3268646.0]
Doing local aggregation!
test acc on this client before 251 / 504 : 0.50
Client Index = 12	Epoch: 0	Loss: 1.217584
Client Index = 12	Epoch: 1	Loss: 1.113051
Client Index = 12	Epoch: 2	Loss: 1.073043
Client Index = 12	Epoch: 3	Loss: 1.137059
Client Index = 12	Epoch: 4	Loss: 1.063380
test acc on this client after 334 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 13
local mask changes: 2914022.0 / 11173962
choose client_indexes: [ 0  4 10 13 18], accoring to random
choose mask diff: [3265228.0, 3283056.0, 3264518.0, 2914022.0, 3275202.0]
Doing local aggregation!
test acc on this client before 214 / 503 : 0.43
Client Index = 13	Epoch: 0	Loss: 1.382073
Client Index = 13	Epoch: 1	Loss: 1.269063
Client Index = 13	Epoch: 2	Loss: 1.311575
Client Index = 13	Epoch: 3	Loss: 1.235908
Client Index = 13	Epoch: 4	Loss: 1.259324
test acc on this client after 286 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 14
local mask changes: 2916022.0 / 11173962
choose client_indexes: [ 4 10 12 14 16], accoring to random
choose mask diff: [3270996.0, 3264226.0, 3266308.0, 2916022.0, 3264988.0]
Doing local aggregation!
test acc on this client before 228 / 502 : 0.45
Client Index = 14	Epoch: 0	Loss: 1.461384
Client Index = 14	Epoch: 1	Loss: 1.385557
Client Index = 14	Epoch: 2	Loss: 1.318078
Client Index = 14	Epoch: 3	Loss: 1.334811
Client Index = 14	Epoch: 4	Loss: 1.289794
test acc on this client after 280 / 502 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 15
local mask changes: 2914232.0 / 11173962
choose client_indexes: [ 3  4  5 10 15], accoring to random
choose mask diff: [3284004.0, 3282572.0, 3271982.0, 3265368.0, 2914232.0]
Doing local aggregation!
test acc on this client before 281 / 504 : 0.56
Client Index = 15	Epoch: 0	Loss: 1.224382
Client Index = 15	Epoch: 1	Loss: 1.158309
Client Index = 15	Epoch: 2	Loss: 1.149372
Client Index = 15	Epoch: 3	Loss: 1.070393
Client Index = 15	Epoch: 4	Loss: 1.097354
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 16
local mask changes: 2916160.0 / 11173962
choose client_indexes: [ 0  2 15 16 17], accoring to random
choose mask diff: [3260800.0, 3256382.0, 3265134.0, 2916160.0, 3265858.0]
Doing local aggregation!
test acc on this client before 216 / 503 : 0.43
Client Index = 16	Epoch: 0	Loss: 1.220145
Client Index = 16	Epoch: 1	Loss: 1.093479
Client Index = 16	Epoch: 2	Loss: 1.079947
Client Index = 16	Epoch: 3	Loss: 1.093948
Client Index = 16	Epoch: 4	Loss: 1.046655
test acc on this client after 315 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 17
local mask changes: 2916046.0 / 11173962
choose client_indexes: [ 3  9 10 14 17], accoring to random
choose mask diff: [3259720.0, 3258988.0, 3263910.0, 3258710.0, 2916046.0]
Doing local aggregation!
test acc on this client before 273 / 505 : 0.54
Client Index = 17	Epoch: 0	Loss: 1.008353
Client Index = 17	Epoch: 1	Loss: 0.924126
Client Index = 17	Epoch: 2	Loss: 0.856011
Client Index = 17	Epoch: 3	Loss: 0.879664
Client Index = 17	Epoch: 4	Loss: 0.878716
test acc on this client after 331 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 18
local mask changes: 2913778.0 / 11173962
choose client_indexes: [ 0  9 13 17 18], accoring to random
choose mask diff: [3260502.0, 3258366.0, 3273878.0, 3259384.0, 2913778.0]
Doing local aggregation!
test acc on this client before 111 / 504 : 0.22
Client Index = 18	Epoch: 0	Loss: 0.932441
Client Index = 18	Epoch: 1	Loss: 0.825085
Client Index = 18	Epoch: 2	Loss: 0.787074
Client Index = 18	Epoch: 3	Loss: 0.772213
Client Index = 18	Epoch: 4	Loss: 0.725424
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(8) with spasity 0.5: 19
local mask changes: 2911510.0 / 11173962
choose client_indexes: [ 1  4 12 17 19], accoring to random
choose mask diff: [3255664.0, 3272628.0, 3265846.0, 3267644.0, 2911510.0]
Doing local aggregation!
test acc on this client before 301 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 1.138983
Client Index = 19	Epoch: 1	Loss: 1.170701
Client Index = 19	Epoch: 2	Loss: 1.086875
Client Index = 19	Epoch: 3	Loss: 1.095473
Client Index = 19	Epoch: 4	Loss: 1.071230
test acc on this client after 274 / 506 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 8
{'test_acc': 0.5952873917802652, 'test_loss': 1.1435302348974647}
################local_test_on_all_clients before local training in communication round: 8
{'test_acc': 0.4279745145958785, 'test_loss': 1.5493203603317816}
################Communication round : 9
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 0
local mask changes: 2905596.0 / 11173962
choose client_indexes: [ 0  1  5 13 18], accoring to random
choose mask diff: [2905596.0, 3200186.0, 3203680.0, 3213842.0, 3205558.0]
Doing local aggregation!
test acc on this client before 243 / 504 : 0.48
Client Index = 0	Epoch: 0	Loss: 1.507285
Client Index = 0	Epoch: 1	Loss: 1.466398
Client Index = 0	Epoch: 2	Loss: 1.429522
Client Index = 0	Epoch: 3	Loss: 1.392408
Client Index = 0	Epoch: 4	Loss: 1.435361
test acc on this client after 172 / 504 : 0.34
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 1
local mask changes: 2907246.0 / 11173962
choose client_indexes: [ 1  5 12 14 18], accoring to random
choose mask diff: [2907246.0, 3197864.0, 3196596.0, 3197950.0, 3199874.0]
Doing local aggregation!
test acc on this client before 162 / 503 : 0.32
Client Index = 1	Epoch: 0	Loss: 1.028387
Client Index = 1	Epoch: 1	Loss: 0.932616
Client Index = 1	Epoch: 2	Loss: 0.891176
Client Index = 1	Epoch: 3	Loss: 0.883983
Client Index = 1	Epoch: 4	Loss: 0.907976
test acc on this client after 321 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 2
local mask changes: 2904896.0 / 11173962
choose client_indexes: [ 1  2  3 11 14], accoring to random
choose mask diff: [3197826.0, 2904896.0, 3199464.0, 3211272.0, 3203404.0]
Doing local aggregation!
test acc on this client before 276 / 502 : 0.55
Client Index = 2	Epoch: 0	Loss: 0.892056
Client Index = 2	Epoch: 1	Loss: 0.840535
Client Index = 2	Epoch: 2	Loss: 0.829592
Client Index = 2	Epoch: 3	Loss: 0.782323
Client Index = 2	Epoch: 4	Loss: 0.887029
test acc on this client after 366 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 3
local mask changes: 2907550.0 / 11173962
choose client_indexes: [ 3  5  7 14 17], accoring to random
choose mask diff: [2907550.0, 3203166.0, 3208640.0, 3188234.0, 3201276.0]
Doing local aggregation!
test acc on this client before 165 / 504 : 0.33
Client Index = 3	Epoch: 0	Loss: 1.315845
Client Index = 3	Epoch: 1	Loss: 1.208041
Client Index = 3	Epoch: 2	Loss: 1.277104
Client Index = 3	Epoch: 3	Loss: 1.183357
Client Index = 3	Epoch: 4	Loss: 1.197331
test acc on this client after 230 / 504 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 4
local mask changes: 2907114.0 / 11173962
choose client_indexes: [ 2  4 12 15 18], accoring to random
choose mask diff: [3199856.0, 2907114.0, 3200990.0, 3209010.0, 3205472.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 4	Epoch: 0	Loss: 0.989410
Client Index = 4	Epoch: 1	Loss: 0.855347
Client Index = 4	Epoch: 2	Loss: 0.905753
Client Index = 4	Epoch: 3	Loss: 0.860139
Client Index = 4	Epoch: 4	Loss: 0.836742
test acc on this client after 358 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 5
local mask changes: 2906268.0 / 11173962
choose client_indexes: [ 3  5  7  8 11], accoring to random
choose mask diff: [3206912.0, 2906268.0, 3197376.0, 3203078.0, 3211760.0]
Doing local aggregation!
test acc on this client before 227 / 504 : 0.45
Client Index = 5	Epoch: 0	Loss: 1.159859
Client Index = 5	Epoch: 1	Loss: 1.051395
Client Index = 5	Epoch: 2	Loss: 1.066193
Client Index = 5	Epoch: 3	Loss: 1.002845
Client Index = 5	Epoch: 4	Loss: 0.980572
test acc on this client after 286 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 6
local mask changes: 2907128.0 / 11173962
choose client_indexes: [ 0  3  6 10 15], accoring to random
choose mask diff: [3211448.0, 3202688.0, 2907128.0, 3210192.0, 3205924.0]
Doing local aggregation!
test acc on this client before 221 / 505 : 0.44
Client Index = 6	Epoch: 0	Loss: 1.391294
Client Index = 6	Epoch: 1	Loss: 1.359879
Client Index = 6	Epoch: 2	Loss: 1.363317
Client Index = 6	Epoch: 3	Loss: 1.359836
Client Index = 6	Epoch: 4	Loss: 1.322084
test acc on this client after 229 / 505 : 0.45
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 7
local mask changes: 2907750.0 / 11173962
choose client_indexes: [ 7 15 16 18 19], accoring to random
choose mask diff: [2907750.0, 3209550.0, 3213968.0, 3203844.0, 3215526.0]
Doing local aggregation!
test acc on this client before 263 / 504 : 0.52
Client Index = 7	Epoch: 0	Loss: 1.338136
Client Index = 7	Epoch: 1	Loss: 1.235215
Client Index = 7	Epoch: 2	Loss: 1.214622
Client Index = 7	Epoch: 3	Loss: 1.178148
Client Index = 7	Epoch: 4	Loss: 1.148679
test acc on this client after 283 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 8
local mask changes: 2907588.0 / 11173962
choose client_indexes: [ 2  8  9 13 14], accoring to random
choose mask diff: [3209136.0, 2907588.0, 3205764.0, 3211014.0, 3197740.0]
Doing local aggregation!
test acc on this client before 212 / 504 : 0.42
Client Index = 8	Epoch: 0	Loss: 1.360594
Client Index = 8	Epoch: 1	Loss: 1.289656
Client Index = 8	Epoch: 2	Loss: 1.246028
Client Index = 8	Epoch: 3	Loss: 1.239848
Client Index = 8	Epoch: 4	Loss: 1.210798
test acc on this client after 269 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 9
local mask changes: 2906750.0 / 11173962
choose client_indexes: [ 1  6  9 12 14], accoring to random
choose mask diff: [3197294.0, 3215962.0, 2906750.0, 3208046.0, 3205810.0]
Doing local aggregation!
test acc on this client before 278 / 504 : 0.55
Client Index = 9	Epoch: 0	Loss: 1.142432
Client Index = 9	Epoch: 1	Loss: 1.075881
Client Index = 9	Epoch: 2	Loss: 1.109605
Client Index = 9	Epoch: 3	Loss: 0.981025
Client Index = 9	Epoch: 4	Loss: 1.073759
test acc on this client after 259 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 10
local mask changes: 2907466.0 / 11173962
choose client_indexes: [ 2 10 11 18 19], accoring to random
choose mask diff: [3215620.0, 2907466.0, 3204870.0, 3204682.0, 3212950.0]
Doing local aggregation!
test acc on this client before 209 / 503 : 0.42
Client Index = 10	Epoch: 0	Loss: 1.382106
Client Index = 10	Epoch: 1	Loss: 1.316085
Client Index = 10	Epoch: 2	Loss: 1.319467
Client Index = 10	Epoch: 3	Loss: 1.241424
Client Index = 10	Epoch: 4	Loss: 1.295842
test acc on this client after 253 / 503 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 11
local mask changes: 2907342.0 / 11173962
choose client_indexes: [ 1  4  9 11 17], accoring to random
choose mask diff: [3206956.0, 3203330.0, 3217984.0, 2907342.0, 3200952.0]
Doing local aggregation!
test acc on this client before 249 / 504 : 0.49
Client Index = 11	Epoch: 0	Loss: 1.061513
Client Index = 11	Epoch: 1	Loss: 0.876172
Client Index = 11	Epoch: 2	Loss: 0.901690
Client Index = 11	Epoch: 3	Loss: 0.914943
Client Index = 11	Epoch: 4	Loss: 0.815868
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 12
local mask changes: 2906762.0 / 11173962
choose client_indexes: [ 4  8  9 11 12], accoring to random
choose mask diff: [3203762.0, 3207600.0, 3198896.0, 3211386.0, 2906762.0]
Doing local aggregation!
test acc on this client before 238 / 504 : 0.47
Client Index = 12	Epoch: 0	Loss: 1.150357
Client Index = 12	Epoch: 1	Loss: 1.076851
Client Index = 12	Epoch: 2	Loss: 1.044641
Client Index = 12	Epoch: 3	Loss: 1.074809
Client Index = 12	Epoch: 4	Loss: 1.059054
test acc on this client after 315 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 13
local mask changes: 2907736.0 / 11173962
choose client_indexes: [ 0  2 11 13 16], accoring to random
choose mask diff: [3197648.0, 3213996.0, 3214790.0, 2907736.0, 3213042.0]
Doing local aggregation!
test acc on this client before 196 / 503 : 0.39
Client Index = 13	Epoch: 0	Loss: 1.297794
Client Index = 13	Epoch: 1	Loss: 1.292539
Client Index = 13	Epoch: 2	Loss: 1.266396
Client Index = 13	Epoch: 3	Loss: 1.192997
Client Index = 13	Epoch: 4	Loss: 1.224177
test acc on this client after 287 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 14
local mask changes: 2907752.0 / 11173962
choose client_indexes: [ 7 12 13 14 17], accoring to random
choose mask diff: [3203974.0, 3200744.0, 3206298.0, 2907752.0, 3203004.0]
Doing local aggregation!
test acc on this client before 242 / 502 : 0.48
Client Index = 14	Epoch: 0	Loss: 1.397589
Client Index = 14	Epoch: 1	Loss: 1.317289
Client Index = 14	Epoch: 2	Loss: 1.299427
Client Index = 14	Epoch: 3	Loss: 1.302326
Client Index = 14	Epoch: 4	Loss: 1.269612
test acc on this client after 287 / 502 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 15
local mask changes: 2908066.0 / 11173962
choose client_indexes: [ 2  5  6  8 15], accoring to random
choose mask diff: [3219374.0, 3203038.0, 3212948.0, 3205580.0, 2908066.0]
Doing local aggregation!
test acc on this client before 189 / 504 : 0.38
Client Index = 15	Epoch: 0	Loss: 1.238330
Client Index = 15	Epoch: 1	Loss: 1.064893
Client Index = 15	Epoch: 2	Loss: 1.072382
Client Index = 15	Epoch: 3	Loss: 1.069838
Client Index = 15	Epoch: 4	Loss: 1.023561
test acc on this client after 329 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 16
local mask changes: 2907606.0 / 11173962
choose client_indexes: [ 1 10 13 15 16], accoring to random
choose mask diff: [3204360.0, 3214716.0, 3216428.0, 3203654.0, 2907606.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 16	Epoch: 0	Loss: 1.155676
Client Index = 16	Epoch: 1	Loss: 1.085621
Client Index = 16	Epoch: 2	Loss: 1.054332
Client Index = 16	Epoch: 3	Loss: 1.006897
Client Index = 16	Epoch: 4	Loss: 0.963270
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 17
local mask changes: 2907498.0 / 11173962
choose client_indexes: [ 6  8  9 14 17], accoring to random
choose mask diff: [3200808.0, 3202322.0, 3192206.0, 3191252.0, 2907498.0]
Doing local aggregation!
test acc on this client before 245 / 505 : 0.49
Client Index = 17	Epoch: 0	Loss: 0.979406
Client Index = 17	Epoch: 1	Loss: 0.872661
Client Index = 17	Epoch: 2	Loss: 0.864572
Client Index = 17	Epoch: 3	Loss: 0.874600
Client Index = 17	Epoch: 4	Loss: 0.848659
test acc on this client after 344 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 18
local mask changes: 2907068.0 / 11173962
choose client_indexes: [ 2  4  5 11 18], accoring to random
choose mask diff: [3205190.0, 3205462.0, 3202616.0, 3207522.0, 2907068.0]
Doing local aggregation!
test acc on this client before 332 / 504 : 0.66
Client Index = 18	Epoch: 0	Loss: 0.894509
Client Index = 18	Epoch: 1	Loss: 0.763400
Client Index = 18	Epoch: 2	Loss: 0.782018
Client Index = 18	Epoch: 3	Loss: 0.730193
Client Index = 18	Epoch: 4	Loss: 0.748905
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(9) with spasity 0.5: 19
local mask changes: 2908096.0 / 11173962
choose client_indexes: [ 4  5 10 11 19], accoring to random
choose mask diff: [3200634.0, 3207130.0, 3211106.0, 3212130.0, 2908096.0]
Doing local aggregation!
test acc on this client before 274 / 506 : 0.54
Client Index = 19	Epoch: 0	Loss: 1.139146
Client Index = 19	Epoch: 1	Loss: 1.119777
Client Index = 19	Epoch: 2	Loss: 1.199120
Client Index = 19	Epoch: 3	Loss: 1.065078
Client Index = 19	Epoch: 4	Loss: 1.047631
test acc on this client after 318 / 506 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 9
{'test_acc': 0.5899092827265661, 'test_loss': 1.1664655107329736}
################local_test_on_all_clients before local training in communication round: 9
{'test_acc': 0.47513000534519706, 'test_loss': 1.5236417672741067}
################Communication round : 10
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 0
local mask changes: 2898134.0 / 11173962
choose client_indexes: [ 0  1  5  6 10], accoring to random
choose mask diff: [2898134.0, 3147084.0, 3152270.0, 3164606.0, 3156192.0]
Doing local aggregation!
test acc on this client before 192 / 504 : 0.38
Client Index = 0	Epoch: 0	Loss: 1.477251
Client Index = 0	Epoch: 1	Loss: 1.456835
Client Index = 0	Epoch: 2	Loss: 1.387615
Client Index = 0	Epoch: 3	Loss: 1.407136
Client Index = 0	Epoch: 4	Loss: 1.377326
test acc on this client after 243 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 1
local mask changes: 2897952.0 / 11173962
choose client_indexes: [ 0  1  6 10 12], accoring to random
choose mask diff: [3148362.0, 2897952.0, 3158060.0, 3151086.0, 3140642.0]
Doing local aggregation!
test acc on this client before 242 / 503 : 0.48
Client Index = 1	Epoch: 0	Loss: 0.996335
Client Index = 1	Epoch: 1	Loss: 0.901108
Client Index = 1	Epoch: 2	Loss: 0.943478
Client Index = 1	Epoch: 3	Loss: 0.900725
Client Index = 1	Epoch: 4	Loss: 0.870159
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 2
local mask changes: 2898804.0 / 11173962
choose client_indexes: [ 2  5  7 10 16], accoring to random
choose mask diff: [2898804.0, 3155234.0, 3154466.0, 3154550.0, 3148250.0]
Doing local aggregation!
test acc on this client before 180 / 502 : 0.36
Client Index = 2	Epoch: 0	Loss: 0.929006
Client Index = 2	Epoch: 1	Loss: 0.796339
Client Index = 2	Epoch: 2	Loss: 0.789321
Client Index = 2	Epoch: 3	Loss: 0.785411
Client Index = 2	Epoch: 4	Loss: 0.820602
test acc on this client after 375 / 502 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 3
local mask changes: 2899010.0 / 11173962
choose client_indexes: [ 0  3  4 10 18], accoring to random
choose mask diff: [3149178.0, 2899010.0, 3151154.0, 3155866.0, 3153210.0]
Doing local aggregation!
test acc on this client before 253 / 504 : 0.50
Client Index = 3	Epoch: 0	Loss: 1.261383
Client Index = 3	Epoch: 1	Loss: 1.164026
Client Index = 3	Epoch: 2	Loss: 1.158173
Client Index = 3	Epoch: 3	Loss: 1.171424
Client Index = 3	Epoch: 4	Loss: 1.175730
test acc on this client after 241 / 504 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 4
local mask changes: 2900338.0 / 11173962
choose client_indexes: [ 4  5 13 14 19], accoring to random
choose mask diff: [2900338.0, 3157170.0, 3153488.0, 3148264.0, 3147610.0]
Doing local aggregation!
test acc on this client before 316 / 503 : 0.63
Client Index = 4	Epoch: 0	Loss: 0.957331
Client Index = 4	Epoch: 1	Loss: 0.814418
Client Index = 4	Epoch: 2	Loss: 0.862078
Client Index = 4	Epoch: 3	Loss: 0.790683
Client Index = 4	Epoch: 4	Loss: 0.836483
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 5
local mask changes: 2898724.0 / 11173962
choose client_indexes: [ 2  4  5  9 14], accoring to random
choose mask diff: [3158268.0, 3159130.0, 2898724.0, 3157106.0, 3147252.0]
Doing local aggregation!
test acc on this client before 206 / 504 : 0.41
Client Index = 5	Epoch: 0	Loss: 1.116900
Client Index = 5	Epoch: 1	Loss: 1.010034
Client Index = 5	Epoch: 2	Loss: 0.974212
Client Index = 5	Epoch: 3	Loss: 1.052579
Client Index = 5	Epoch: 4	Loss: 0.974566
test acc on this client after 311 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 6
local mask changes: 2898822.0 / 11173962
choose client_indexes: [ 4  6  9 15 16], accoring to random
choose mask diff: [3158510.0, 2898822.0, 3162148.0, 3150592.0, 3160832.0]
Doing local aggregation!
test acc on this client before 221 / 505 : 0.44
Client Index = 6	Epoch: 0	Loss: 1.410310
Client Index = 6	Epoch: 1	Loss: 1.335111
Client Index = 6	Epoch: 2	Loss: 1.320316
Client Index = 6	Epoch: 3	Loss: 1.344840
Client Index = 6	Epoch: 4	Loss: 1.306230
test acc on this client after 196 / 505 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 7
local mask changes: 2899258.0 / 11173962
choose client_indexes: [0 4 6 7 9], accoring to random
choose mask diff: [3148560.0, 3155424.0, 3157652.0, 2899258.0, 3158772.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 7	Epoch: 0	Loss: 1.248936
Client Index = 7	Epoch: 1	Loss: 1.189403
Client Index = 7	Epoch: 2	Loss: 1.221092
Client Index = 7	Epoch: 3	Loss: 1.128961
Client Index = 7	Epoch: 4	Loss: 1.183747
test acc on this client after 230 / 504 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 8
local mask changes: 2897582.0 / 11173962
choose client_indexes: [ 3  5  8 14 17], accoring to random
choose mask diff: [3157516.0, 3150654.0, 2897582.0, 3144206.0, 3154680.0]
Doing local aggregation!
test acc on this client before 226 / 504 : 0.45
Client Index = 8	Epoch: 0	Loss: 1.334577
Client Index = 8	Epoch: 1	Loss: 1.246760
Client Index = 8	Epoch: 2	Loss: 1.196699
Client Index = 8	Epoch: 3	Loss: 1.195978
Client Index = 8	Epoch: 4	Loss: 1.179945
test acc on this client after 219 / 504 : 0.43
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 9
local mask changes: 2898160.0 / 11173962
choose client_indexes: [ 4  7  9 11 13], accoring to random
choose mask diff: [3157136.0, 3160684.0, 2898160.0, 3165156.0, 3160878.0]
Doing local aggregation!
test acc on this client before 235 / 504 : 0.47
Client Index = 9	Epoch: 0	Loss: 1.157714
Client Index = 9	Epoch: 1	Loss: 1.038271
Client Index = 9	Epoch: 2	Loss: 1.039192
Client Index = 9	Epoch: 3	Loss: 0.966999
Client Index = 9	Epoch: 4	Loss: 1.025279
test acc on this client after 275 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 10
local mask changes: 2898428.0 / 11173962
choose client_indexes: [ 5 10 12 15 19], accoring to random
choose mask diff: [3156000.0, 2898428.0, 3155796.0, 3152582.0, 3157578.0]
Doing local aggregation!
test acc on this client before 223 / 503 : 0.44
Client Index = 10	Epoch: 0	Loss: 1.338175
Client Index = 10	Epoch: 1	Loss: 1.256741
Client Index = 10	Epoch: 2	Loss: 1.293875
Client Index = 10	Epoch: 3	Loss: 1.272147
Client Index = 10	Epoch: 4	Loss: 1.261182
test acc on this client after 267 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 11
local mask changes: 2897728.0 / 11173962
choose client_indexes: [ 0  3  8 11 14], accoring to random
choose mask diff: [3154228.0, 3153516.0, 3165230.0, 2897728.0, 3153426.0]
Doing local aggregation!
test acc on this client before 294 / 504 : 0.58
Client Index = 11	Epoch: 0	Loss: 0.986344
Client Index = 11	Epoch: 1	Loss: 0.920272
Client Index = 11	Epoch: 2	Loss: 0.782153
Client Index = 11	Epoch: 3	Loss: 0.910318
Client Index = 11	Epoch: 4	Loss: 0.819608
test acc on this client after 331 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 12
local mask changes: 2898818.0 / 11173962
choose client_indexes: [ 5  7 10 12 14], accoring to random
choose mask diff: [3157788.0, 3157608.0, 3154570.0, 2898818.0, 3148164.0]
Doing local aggregation!
test acc on this client before 190 / 504 : 0.38
Client Index = 12	Epoch: 0	Loss: 1.184736
Client Index = 12	Epoch: 1	Loss: 1.028251
Client Index = 12	Epoch: 2	Loss: 1.065338
Client Index = 12	Epoch: 3	Loss: 1.033551
Client Index = 12	Epoch: 4	Loss: 0.988861
test acc on this client after 337 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 13
local mask changes: 2899430.0 / 11173962
choose client_indexes: [ 1  4  5  8 13], accoring to random
choose mask diff: [3149954.0, 3156014.0, 3160674.0, 3166196.0, 2899430.0]
Doing local aggregation!
test acc on this client before 283 / 503 : 0.56
Client Index = 13	Epoch: 0	Loss: 1.305017
Client Index = 13	Epoch: 1	Loss: 1.229545
Client Index = 13	Epoch: 2	Loss: 1.167913
Client Index = 13	Epoch: 3	Loss: 1.254938
Client Index = 13	Epoch: 4	Loss: 1.172922
test acc on this client after 292 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 14
local mask changes: 2900188.0 / 11173962
choose client_indexes: [ 4  6  8 12 14], accoring to random
choose mask diff: [3153240.0, 3152740.0, 3155614.0, 3147142.0, 2900188.0]
Doing local aggregation!
test acc on this client before 243 / 502 : 0.48
Client Index = 14	Epoch: 0	Loss: 1.307703
Client Index = 14	Epoch: 1	Loss: 1.297303
Client Index = 14	Epoch: 2	Loss: 1.296264
Client Index = 14	Epoch: 3	Loss: 1.215544
Client Index = 14	Epoch: 4	Loss: 1.226351
test acc on this client after 296 / 502 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 15
local mask changes: 2895654.0 / 11173962
choose client_indexes: [ 5  6  8 10 15], accoring to random
choose mask diff: [3151286.0, 3147364.0, 3148220.0, 3148264.0, 2895654.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 15	Epoch: 0	Loss: 1.211415
Client Index = 15	Epoch: 1	Loss: 1.066335
Client Index = 15	Epoch: 2	Loss: 1.053771
Client Index = 15	Epoch: 3	Loss: 1.036339
Client Index = 15	Epoch: 4	Loss: 1.015127
test acc on this client after 249 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 16
local mask changes: 2897130.0 / 11173962
choose client_indexes: [12 14 15 16 19], accoring to random
choose mask diff: [3152542.0, 3148192.0, 3151186.0, 2897130.0, 3159532.0]
Doing local aggregation!
test acc on this client before 243 / 503 : 0.48
Client Index = 16	Epoch: 0	Loss: 1.196316
Client Index = 16	Epoch: 1	Loss: 1.022921
Client Index = 16	Epoch: 2	Loss: 1.002460
Client Index = 16	Epoch: 3	Loss: 1.020558
Client Index = 16	Epoch: 4	Loss: 0.939341
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 17
local mask changes: 2898710.0 / 11173962
choose client_indexes: [ 4  5  9 14 17], accoring to random
choose mask diff: [3151706.0, 3149712.0, 3139882.0, 3138684.0, 2898710.0]
Doing local aggregation!
test acc on this client before 255 / 505 : 0.50
Client Index = 17	Epoch: 0	Loss: 0.930852
Client Index = 17	Epoch: 1	Loss: 0.861847
Client Index = 17	Epoch: 2	Loss: 0.799598
Client Index = 17	Epoch: 3	Loss: 0.868410
Client Index = 17	Epoch: 4	Loss: 0.810675
test acc on this client after 356 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 18
local mask changes: 2899818.0 / 11173962
choose client_indexes: [ 4  5  7 10 18], accoring to random
choose mask diff: [3150494.0, 3144952.0, 3155056.0, 3155170.0, 2899818.0]
Doing local aggregation!
test acc on this client before 281 / 504 : 0.56
Client Index = 18	Epoch: 0	Loss: 0.798212
Client Index = 18	Epoch: 1	Loss: 0.762628
Client Index = 18	Epoch: 2	Loss: 0.795363
Client Index = 18	Epoch: 3	Loss: 0.689713
Client Index = 18	Epoch: 4	Loss: 0.714644
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(10) with spasity 0.5: 19
local mask changes: 2895654.0 / 11173962
choose client_indexes: [ 4  8 11 13 19], accoring to random
choose mask diff: [3147552.0, 3158912.0, 3157012.0, 3157980.0, 2895654.0]
Doing local aggregation!
test acc on this client before 188 / 506 : 0.37
Client Index = 19	Epoch: 0	Loss: 1.121765
Client Index = 19	Epoch: 1	Loss: 1.154664
Client Index = 19	Epoch: 2	Loss: 1.038628
Client Index = 19	Epoch: 3	Loss: 0.993630
Client Index = 19	Epoch: 4	Loss: 1.074719
test acc on this client after 290 / 506 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 10
{'test_acc': 0.5853711655031251, 'test_loss': 1.1772732733991444}
################local_test_on_all_clients before local training in communication round: 10
{'test_acc': 0.4787299614330861, 'test_loss': 1.4593043902469354}
################Communication round : 11
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 0
local mask changes: 2887218.0 / 11173962
choose client_indexes: [ 0  2  4  9 17], accoring to random
choose mask diff: [2887218.0, 3114772.0, 3111024.0, 3115694.0, 3113988.0]
Doing local aggregation!
test acc on this client before 205 / 504 : 0.41
Client Index = 0	Epoch: 0	Loss: 1.482757
Client Index = 0	Epoch: 1	Loss: 1.383497
Client Index = 0	Epoch: 2	Loss: 1.363861
Client Index = 0	Epoch: 3	Loss: 1.380244
Client Index = 0	Epoch: 4	Loss: 1.368510
test acc on this client after 211 / 504 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 1
local mask changes: 2889096.0 / 11173962
choose client_indexes: [ 1  5 10 11 17], accoring to random
choose mask diff: [2889096.0, 3108906.0, 3100608.0, 3115280.0, 3103720.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 1	Epoch: 0	Loss: 0.940198
Client Index = 1	Epoch: 1	Loss: 0.883700
Client Index = 1	Epoch: 2	Loss: 0.900094
Client Index = 1	Epoch: 3	Loss: 0.887279
Client Index = 1	Epoch: 4	Loss: 0.844989
test acc on this client after 288 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 2
local mask changes: 2890372.0 / 11173962
choose client_indexes: [ 1  2  3  5 15], accoring to random
choose mask diff: [3105248.0, 2890372.0, 3106580.0, 3107354.0, 3116366.0]
Doing local aggregation!
test acc on this client before 319 / 502 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.842774
Client Index = 2	Epoch: 1	Loss: 0.919763
Client Index = 2	Epoch: 2	Loss: 0.784377
Client Index = 2	Epoch: 3	Loss: 0.765234
Client Index = 2	Epoch: 4	Loss: 0.785442
test acc on this client after 377 / 502 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 3
local mask changes: 2887572.0 / 11173962
choose client_indexes: [ 3  8 10 12 17], accoring to random
choose mask diff: [2887572.0, 3117916.0, 3109552.0, 3113728.0, 3108444.0]
Doing local aggregation!
test acc on this client before 204 / 504 : 0.40
Client Index = 3	Epoch: 0	Loss: 1.254159
Client Index = 3	Epoch: 1	Loss: 1.199915
Client Index = 3	Epoch: 2	Loss: 1.164264
Client Index = 3	Epoch: 3	Loss: 1.122150
Client Index = 3	Epoch: 4	Loss: 1.085278
test acc on this client after 198 / 504 : 0.39
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 4
local mask changes: 2889648.0 / 11173962
choose client_indexes: [ 1  4  7 12 13], accoring to random
choose mask diff: [3110256.0, 2889648.0, 3109484.0, 3102148.0, 3107252.0]
Doing local aggregation!
test acc on this client before 169 / 503 : 0.34
Client Index = 4	Epoch: 0	Loss: 0.919332
Client Index = 4	Epoch: 1	Loss: 0.812438
Client Index = 4	Epoch: 2	Loss: 0.785909
Client Index = 4	Epoch: 3	Loss: 0.820676
Client Index = 4	Epoch: 4	Loss: 0.789261
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 5
local mask changes: 2889712.0 / 11173962
choose client_indexes: [ 3  5  6 12 15], accoring to random
choose mask diff: [3107084.0, 2889712.0, 3110352.0, 3113662.0, 3111016.0]
Doing local aggregation!
test acc on this client before 241 / 504 : 0.48
Client Index = 5	Epoch: 0	Loss: 1.093146
Client Index = 5	Epoch: 1	Loss: 1.027809
Client Index = 5	Epoch: 2	Loss: 0.998351
Client Index = 5	Epoch: 3	Loss: 0.956749
Client Index = 5	Epoch: 4	Loss: 0.895956
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 6
local mask changes: 2888290.0 / 11173962
choose client_indexes: [ 0  6  7 12 15], accoring to random
choose mask diff: [3117442.0, 2888290.0, 3114928.0, 3115516.0, 3103490.0]
Doing local aggregation!
test acc on this client before 242 / 505 : 0.48
Client Index = 6	Epoch: 0	Loss: 1.318844
Client Index = 6	Epoch: 1	Loss: 1.317795
Client Index = 6	Epoch: 2	Loss: 1.282696
Client Index = 6	Epoch: 3	Loss: 1.269101
Client Index = 6	Epoch: 4	Loss: 1.278763
test acc on this client after 251 / 505 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 7
local mask changes: 2887130.0 / 11173962
choose client_indexes: [ 0  3  7  9 14], accoring to random
choose mask diff: [3108192.0, 3113646.0, 2887130.0, 3114050.0, 3107572.0]
Doing local aggregation!
test acc on this client before 253 / 504 : 0.50
Client Index = 7	Epoch: 0	Loss: 1.235907
Client Index = 7	Epoch: 1	Loss: 1.198017
Client Index = 7	Epoch: 2	Loss: 1.113890
Client Index = 7	Epoch: 3	Loss: 1.110437
Client Index = 7	Epoch: 4	Loss: 1.166972
test acc on this client after 287 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 8
local mask changes: 2888680.0 / 11173962
choose client_indexes: [ 2  4  5  8 16], accoring to random
choose mask diff: [3115384.0, 3116824.0, 3102712.0, 2888680.0, 3119110.0]
Doing local aggregation!
test acc on this client before 223 / 504 : 0.44
Client Index = 8	Epoch: 0	Loss: 1.297189
Client Index = 8	Epoch: 1	Loss: 1.224613
Client Index = 8	Epoch: 2	Loss: 1.216742
Client Index = 8	Epoch: 3	Loss: 1.210154
Client Index = 8	Epoch: 4	Loss: 1.173948
test acc on this client after 254 / 504 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 9
local mask changes: 2888932.0 / 11173962
choose client_indexes: [ 0  7  9 12 17], accoring to random
choose mask diff: [3111960.0, 3113450.0, 2888932.0, 3105378.0, 3105270.0]
Doing local aggregation!
test acc on this client before 287 / 504 : 0.57
Client Index = 9	Epoch: 0	Loss: 1.126255
Client Index = 9	Epoch: 1	Loss: 1.045083
Client Index = 9	Epoch: 2	Loss: 1.018570
Client Index = 9	Epoch: 3	Loss: 0.963345
Client Index = 9	Epoch: 4	Loss: 1.000521
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 10
local mask changes: 2889300.0 / 11173962
choose client_indexes: [ 0  2  5 10 17], accoring to random
choose mask diff: [3112168.0, 3111874.0, 3107978.0, 2889300.0, 3110928.0]
Doing local aggregation!
test acc on this client before 257 / 503 : 0.51
Client Index = 10	Epoch: 0	Loss: 1.288087
Client Index = 10	Epoch: 1	Loss: 1.254036
Client Index = 10	Epoch: 2	Loss: 1.250363
Client Index = 10	Epoch: 3	Loss: 1.225716
Client Index = 10	Epoch: 4	Loss: 1.176785
test acc on this client after 268 / 503 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 11
local mask changes: 2887688.0 / 11173962
choose client_indexes: [ 3  4  7 11 13], accoring to random
choose mask diff: [3109646.0, 3111998.0, 3123122.0, 2887688.0, 3116784.0]
Doing local aggregation!
test acc on this client before 261 / 504 : 0.52
Client Index = 11	Epoch: 0	Loss: 1.008034
Client Index = 11	Epoch: 1	Loss: 0.873542
Client Index = 11	Epoch: 2	Loss: 0.813699
Client Index = 11	Epoch: 3	Loss: 0.817997
Client Index = 11	Epoch: 4	Loss: 0.783591
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 12
local mask changes: 2888854.0 / 11173962
choose client_indexes: [ 7  9 12 18 19], accoring to random
choose mask diff: [3108750.0, 3108198.0, 2888854.0, 3110308.0, 3106704.0]
Doing local aggregation!
test acc on this client before 309 / 504 : 0.61
Client Index = 12	Epoch: 0	Loss: 1.087371
Client Index = 12	Epoch: 1	Loss: 1.007562
Client Index = 12	Epoch: 2	Loss: 1.006130
Client Index = 12	Epoch: 3	Loss: 1.059443
Client Index = 12	Epoch: 4	Loss: 0.993470
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 13
local mask changes: 2887992.0 / 11173962
choose client_indexes: [ 1  6 11 13 16], accoring to random
choose mask diff: [3103822.0, 3119044.0, 3121760.0, 2887992.0, 3112374.0]
Doing local aggregation!
test acc on this client before 235 / 503 : 0.47
Client Index = 13	Epoch: 0	Loss: 1.224733
Client Index = 13	Epoch: 1	Loss: 1.201165
Client Index = 13	Epoch: 2	Loss: 1.182978
Client Index = 13	Epoch: 3	Loss: 1.173466
Client Index = 13	Epoch: 4	Loss: 1.157128
test acc on this client after 270 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 14
local mask changes: 2888416.0 / 11173962
choose client_indexes: [ 1  3  6 14 16], accoring to random
choose mask diff: [3110210.0, 3105064.0, 3105612.0, 2888416.0, 3111442.0]
Doing local aggregation!
test acc on this client before 273 / 502 : 0.54
Client Index = 14	Epoch: 0	Loss: 1.212570
Client Index = 14	Epoch: 1	Loss: 1.286637
Client Index = 14	Epoch: 2	Loss: 1.206175
Client Index = 14	Epoch: 3	Loss: 1.206765
Client Index = 14	Epoch: 4	Loss: 1.269544
test acc on this client after 282 / 502 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 15
local mask changes: 2890034.0 / 11173962
choose client_indexes: [ 3  5  9 10 15], accoring to random
choose mask diff: [3118734.0, 3107110.0, 3112516.0, 3104674.0, 2890034.0]
Doing local aggregation!
test acc on this client before 217 / 504 : 0.43
Client Index = 15	Epoch: 0	Loss: 1.116707
Client Index = 15	Epoch: 1	Loss: 1.024666
Client Index = 15	Epoch: 2	Loss: 1.085502
Client Index = 15	Epoch: 3	Loss: 0.978797
Client Index = 15	Epoch: 4	Loss: 1.036550
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 16
local mask changes: 2889214.0 / 11173962
choose client_indexes: [ 6 10 15 16 17], accoring to random
choose mask diff: [3116324.0, 3112272.0, 3110176.0, 2889214.0, 3112138.0]
Doing local aggregation!
test acc on this client before 186 / 503 : 0.37
Client Index = 16	Epoch: 0	Loss: 1.052787
Client Index = 16	Epoch: 1	Loss: 1.054566
Client Index = 16	Epoch: 2	Loss: 0.971718
Client Index = 16	Epoch: 3	Loss: 0.989680
Client Index = 16	Epoch: 4	Loss: 0.986984
test acc on this client after 299 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 17
local mask changes: 2888330.0 / 11173962
choose client_indexes: [ 0  4  5 11 17], accoring to random
choose mask diff: [3110694.0, 3106050.0, 3102574.0, 3113642.0, 2888330.0]
Doing local aggregation!
test acc on this client before 249 / 505 : 0.49
Client Index = 17	Epoch: 0	Loss: 0.964666
Client Index = 17	Epoch: 1	Loss: 0.829568
Client Index = 17	Epoch: 2	Loss: 0.817471
Client Index = 17	Epoch: 3	Loss: 0.757629
Client Index = 17	Epoch: 4	Loss: 0.800124
test acc on this client after 299 / 505 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 18
local mask changes: 2886044.0 / 11173962
choose client_indexes: [ 1  4  8 16 18], accoring to random
choose mask diff: [3103016.0, 3100530.0, 3115988.0, 3112514.0, 2886044.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.778255
Client Index = 18	Epoch: 1	Loss: 0.777859
Client Index = 18	Epoch: 2	Loss: 0.681784
Client Index = 18	Epoch: 3	Loss: 0.742032
Client Index = 18	Epoch: 4	Loss: 0.652145
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(11) with spasity 0.5: 19
local mask changes: 2888866.0 / 11173962
choose client_indexes: [11 13 17 18 19], accoring to random
choose mask diff: [3108478.0, 3109442.0, 3109690.0, 3111794.0, 2888866.0]
Doing local aggregation!
test acc on this client before 298 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 1.061061
Client Index = 19	Epoch: 1	Loss: 1.055983
Client Index = 19	Epoch: 2	Loss: 1.050433
Client Index = 19	Epoch: 3	Loss: 1.058144
Client Index = 19	Epoch: 4	Loss: 0.968806
test acc on this client after 315 / 506 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 11
{'test_acc': 0.5858311517588309, 'test_loss': 1.2374023184661853}
################local_test_on_all_clients before local training in communication round: 11
{'test_acc': 0.5054016844798335, 'test_loss': 1.4016165973796018}
################Communication round : 12
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 0
local mask changes: 2880292.0 / 11173962
choose client_indexes: [ 0  2  3 16 18], accoring to random
choose mask diff: [2880292.0, 3075582.0, 3071016.0, 3074546.0, 3075762.0]
Doing local aggregation!
test acc on this client before 160 / 504 : 0.32
Client Index = 0	Epoch: 0	Loss: 1.391382
Client Index = 0	Epoch: 1	Loss: 1.399522
Client Index = 0	Epoch: 2	Loss: 1.351658
Client Index = 0	Epoch: 3	Loss: 1.328806
Client Index = 0	Epoch: 4	Loss: 1.365776
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 1
local mask changes: 2875514.0 / 11173962
choose client_indexes: [ 1  3  6  8 15], accoring to random
choose mask diff: [2875514.0, 3074520.0, 3079884.0, 3079778.0, 3076138.0]
Doing local aggregation!
test acc on this client before 241 / 503 : 0.48
Client Index = 1	Epoch: 0	Loss: 0.978265
Client Index = 1	Epoch: 1	Loss: 0.868989
Client Index = 1	Epoch: 2	Loss: 0.884559
Client Index = 1	Epoch: 3	Loss: 0.857317
Client Index = 1	Epoch: 4	Loss: 0.814958
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 2
local mask changes: 2878042.0 / 11173962
choose client_indexes: [ 0  1  2  6 14], accoring to random
choose mask diff: [3076070.0, 3066068.0, 2878042.0, 3078200.0, 3077146.0]
Doing local aggregation!
test acc on this client before 243 / 502 : 0.48
Client Index = 2	Epoch: 0	Loss: 0.819891
Client Index = 2	Epoch: 1	Loss: 0.827601
Client Index = 2	Epoch: 2	Loss: 0.742722
Client Index = 2	Epoch: 3	Loss: 0.725609
Client Index = 2	Epoch: 4	Loss: 0.745260
test acc on this client after 388 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 3
local mask changes: 2879002.0 / 11173962
choose client_indexes: [ 2  3  5  6 13], accoring to random
choose mask diff: [3075730.0, 2879002.0, 3073328.0, 3078106.0, 3080530.0]
Doing local aggregation!
test acc on this client before 161 / 504 : 0.32
Client Index = 3	Epoch: 0	Loss: 1.212371
Client Index = 3	Epoch: 1	Loss: 1.147163
Client Index = 3	Epoch: 2	Loss: 1.135561
Client Index = 3	Epoch: 3	Loss: 1.068978
Client Index = 3	Epoch: 4	Loss: 1.112682
test acc on this client after 255 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 4
local mask changes: 2880396.0 / 11173962
choose client_indexes: [ 4  6 15 16 18], accoring to random
choose mask diff: [2880396.0, 3073900.0, 3077778.0, 3077220.0, 3071416.0]
Doing local aggregation!
test acc on this client before 307 / 503 : 0.61
Client Index = 4	Epoch: 0	Loss: 0.927850
Client Index = 4	Epoch: 1	Loss: 0.825636
Client Index = 4	Epoch: 2	Loss: 0.796964
Client Index = 4	Epoch: 3	Loss: 0.815837
Client Index = 4	Epoch: 4	Loss: 0.794931
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 5
local mask changes: 2878572.0 / 11173962
choose client_indexes: [ 2  5  6 11 16], accoring to random
choose mask diff: [3073786.0, 2878572.0, 3071254.0, 3085960.0, 3077636.0]
Doing local aggregation!
test acc on this client before 246 / 504 : 0.49
Client Index = 5	Epoch: 0	Loss: 1.139508
Client Index = 5	Epoch: 1	Loss: 0.939601
Client Index = 5	Epoch: 2	Loss: 0.890474
Client Index = 5	Epoch: 3	Loss: 1.027978
Client Index = 5	Epoch: 4	Loss: 0.893430
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 6
local mask changes: 2877306.0 / 11173962
choose client_indexes: [ 4  6  8  9 15], accoring to random
choose mask diff: [3079168.0, 2877306.0, 3074852.0, 3082270.0, 3066766.0]
Doing local aggregation!
test acc on this client before 230 / 505 : 0.46
Client Index = 6	Epoch: 0	Loss: 1.373761
Client Index = 6	Epoch: 1	Loss: 1.269679
Client Index = 6	Epoch: 2	Loss: 1.279695
Client Index = 6	Epoch: 3	Loss: 1.289610
Client Index = 6	Epoch: 4	Loss: 1.225510
test acc on this client after 233 / 505 : 0.46
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 7
local mask changes: 2879018.0 / 11173962
choose client_indexes: [ 0  3  7 17 19], accoring to random
choose mask diff: [3071534.0, 3075598.0, 2879018.0, 3074792.0, 3083344.0]
Doing local aggregation!
test acc on this client before 178 / 504 : 0.35
Client Index = 7	Epoch: 0	Loss: 1.243944
Client Index = 7	Epoch: 1	Loss: 1.164727
Client Index = 7	Epoch: 2	Loss: 1.096391
Client Index = 7	Epoch: 3	Loss: 1.137241
Client Index = 7	Epoch: 4	Loss: 1.076725
test acc on this client after 249 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 8
local mask changes: 2880004.0 / 11173962
choose client_indexes: [ 0  8 11 12 14], accoring to random
choose mask diff: [3080654.0, 2880004.0, 3084352.0, 3078066.0, 3065568.0]
Doing local aggregation!
test acc on this client before 191 / 504 : 0.38
Client Index = 8	Epoch: 0	Loss: 1.271678
Client Index = 8	Epoch: 1	Loss: 1.205033
Client Index = 8	Epoch: 2	Loss: 1.179743
Client Index = 8	Epoch: 3	Loss: 1.154025
Client Index = 8	Epoch: 4	Loss: 1.149740
test acc on this client after 279 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 9
local mask changes: 2878776.0 / 11173962
choose client_indexes: [ 0  9 11 14 17], accoring to random
choose mask diff: [3073846.0, 2878776.0, 3081018.0, 3070944.0, 3066616.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 9	Epoch: 0	Loss: 1.018053
Client Index = 9	Epoch: 1	Loss: 1.070806
Client Index = 9	Epoch: 2	Loss: 0.983680
Client Index = 9	Epoch: 3	Loss: 0.993594
Client Index = 9	Epoch: 4	Loss: 0.908346
test acc on this client after 216 / 504 : 0.43
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 10
local mask changes: 2877944.0 / 11173962
choose client_indexes: [ 2  7 10 14 15], accoring to random
choose mask diff: [3071740.0, 3078822.0, 2877944.0, 3075320.0, 3069982.0]
Doing local aggregation!
test acc on this client before 244 / 503 : 0.49
Client Index = 10	Epoch: 0	Loss: 1.243153
Client Index = 10	Epoch: 1	Loss: 1.195403
Client Index = 10	Epoch: 2	Loss: 1.260792
Client Index = 10	Epoch: 3	Loss: 1.216548
Client Index = 10	Epoch: 4	Loss: 1.133639
test acc on this client after 275 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 11
local mask changes: 2879298.0 / 11173962
choose client_indexes: [ 1 11 12 18 19], accoring to random
choose mask diff: [3079608.0, 2879298.0, 3079348.0, 3076844.0, 3078028.0]
Doing local aggregation!
test acc on this client before 264 / 504 : 0.52
Client Index = 11	Epoch: 0	Loss: 0.958577
Client Index = 11	Epoch: 1	Loss: 0.792873
Client Index = 11	Epoch: 2	Loss: 0.813919
Client Index = 11	Epoch: 3	Loss: 0.770557
Client Index = 11	Epoch: 4	Loss: 0.750331
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 12
local mask changes: 2878630.0 / 11173962
choose client_indexes: [ 0  1  8 12 13], accoring to random
choose mask diff: [3072808.0, 3066976.0, 3080846.0, 2878630.0, 3069802.0]
Doing local aggregation!
test acc on this client before 298 / 504 : 0.59
Client Index = 12	Epoch: 0	Loss: 1.112218
Client Index = 12	Epoch: 1	Loss: 1.019105
Client Index = 12	Epoch: 2	Loss: 0.975313
Client Index = 12	Epoch: 3	Loss: 0.997180
Client Index = 12	Epoch: 4	Loss: 0.995399
test acc on this client after 329 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 13
local mask changes: 2878418.0 / 11173962
choose client_indexes: [ 2  9 13 17 19], accoring to random
choose mask diff: [3078356.0, 3076704.0, 2878418.0, 3077868.0, 3076996.0]
Doing local aggregation!
test acc on this client before 257 / 503 : 0.51
Client Index = 13	Epoch: 0	Loss: 1.241786
Client Index = 13	Epoch: 1	Loss: 1.154769
Client Index = 13	Epoch: 2	Loss: 1.222832
Client Index = 13	Epoch: 3	Loss: 1.162651
Client Index = 13	Epoch: 4	Loss: 1.114993
test acc on this client after 261 / 503 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 14
local mask changes: 2878668.0 / 11173962
choose client_indexes: [ 1  2  7  9 14], accoring to random
choose mask diff: [3073980.0, 3079384.0, 3073168.0, 3076018.0, 2878668.0]
Doing local aggregation!
test acc on this client before 295 / 502 : 0.59
Client Index = 14	Epoch: 0	Loss: 1.245691
Client Index = 14	Epoch: 1	Loss: 1.239917
Client Index = 14	Epoch: 2	Loss: 1.188484
Client Index = 14	Epoch: 3	Loss: 1.204001
Client Index = 14	Epoch: 4	Loss: 1.186069
test acc on this client after 310 / 502 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 15
local mask changes: 2879314.0 / 11173962
choose client_indexes: [ 1  3  9 15 18], accoring to random
choose mask diff: [3075418.0, 3077874.0, 3075112.0, 2879314.0, 3080818.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 15	Epoch: 0	Loss: 1.135580
Client Index = 15	Epoch: 1	Loss: 0.964576
Client Index = 15	Epoch: 2	Loss: 0.942741
Client Index = 15	Epoch: 3	Loss: 0.980890
Client Index = 15	Epoch: 4	Loss: 0.950870
test acc on this client after 312 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 16
local mask changes: 2876362.0 / 11173962
choose client_indexes: [ 1 10 14 15 16], accoring to random
choose mask diff: [3076070.0, 3072912.0, 3069586.0, 3073464.0, 2876362.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 16	Epoch: 0	Loss: 1.014154
Client Index = 16	Epoch: 1	Loss: 0.943408
Client Index = 16	Epoch: 2	Loss: 0.980827
Client Index = 16	Epoch: 3	Loss: 0.967608
Client Index = 16	Epoch: 4	Loss: 0.978547
test acc on this client after 331 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 17
local mask changes: 2878224.0 / 11173962
choose client_indexes: [ 5  7 12 17 18], accoring to random
choose mask diff: [3060078.0, 3073668.0, 3070212.0, 2878224.0, 3073840.0]
Doing local aggregation!
test acc on this client before 278 / 505 : 0.55
Client Index = 17	Epoch: 0	Loss: 0.946069
Client Index = 17	Epoch: 1	Loss: 0.846066
Client Index = 17	Epoch: 2	Loss: 0.738369
Client Index = 17	Epoch: 3	Loss: 0.833240
Client Index = 17	Epoch: 4	Loss: 0.754490
test acc on this client after 285 / 505 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 18
local mask changes: 2878148.0 / 11173962
choose client_indexes: [ 3  5 16 17 18], accoring to random
choose mask diff: [3070678.0, 3070132.0, 3070246.0, 3072450.0, 2878148.0]
Doing local aggregation!
test acc on this client before 161 / 504 : 0.32
Client Index = 18	Epoch: 0	Loss: 0.817033
Client Index = 18	Epoch: 1	Loss: 0.708967
Client Index = 18	Epoch: 2	Loss: 0.701504
Client Index = 18	Epoch: 3	Loss: 0.705203
Client Index = 18	Epoch: 4	Loss: 0.643403
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(12) with spasity 0.5: 19
local mask changes: 2877336.0 / 11173962
choose client_indexes: [ 3  9 15 17 19], accoring to random
choose mask diff: [3075556.0, 3076750.0, 3078984.0, 3070982.0, 2877336.0]
Doing local aggregation!
test acc on this client before 317 / 506 : 0.63
Client Index = 19	Epoch: 0	Loss: 1.080626
Client Index = 19	Epoch: 1	Loss: 1.009628
Client Index = 19	Epoch: 2	Loss: 1.046335
Client Index = 19	Epoch: 3	Loss: 0.960240
Client Index = 19	Epoch: 4	Loss: 0.948709
test acc on this client after 336 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 12
{'test_acc': 0.6059121099891456, 'test_loss': 1.1335673918809384}
################local_test_on_all_clients before local training in communication round: 12
{'test_acc': 0.48914862298446693, 'test_loss': 1.412975360583616}
################Communication round : 13
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 0
local mask changes: 2866056.0 / 11173962
choose client_indexes: [ 0  1  4  9 15], accoring to random
choose mask diff: [2866056.0, 3039206.0, 3039028.0, 3043860.0, 3046914.0]
Doing local aggregation!
test acc on this client before 195 / 504 : 0.39
Client Index = 0	Epoch: 0	Loss: 1.425683
Client Index = 0	Epoch: 1	Loss: 1.318566
Client Index = 0	Epoch: 2	Loss: 1.326567
Client Index = 0	Epoch: 3	Loss: 1.303060
Client Index = 0	Epoch: 4	Loss: 1.293498
test acc on this client after 205 / 504 : 0.41
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 1
local mask changes: 2866616.0 / 11173962
choose client_indexes: [ 1  3 10 12 13], accoring to random
choose mask diff: [2866616.0, 3039858.0, 3034076.0, 3039492.0, 3041992.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.935614
Client Index = 1	Epoch: 1	Loss: 0.838486
Client Index = 1	Epoch: 2	Loss: 0.839620
Client Index = 1	Epoch: 3	Loss: 0.833362
Client Index = 1	Epoch: 4	Loss: 0.778651
test acc on this client after 333 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 2
local mask changes: 2867566.0 / 11173962
choose client_indexes: [ 2  3  4 14 18], accoring to random
choose mask diff: [2867566.0, 3038652.0, 3044344.0, 3038508.0, 3045884.0]
Doing local aggregation!
test acc on this client before 151 / 502 : 0.30
Client Index = 2	Epoch: 0	Loss: 0.914244
Client Index = 2	Epoch: 1	Loss: 0.753493
Client Index = 2	Epoch: 2	Loss: 0.742124
Client Index = 2	Epoch: 3	Loss: 0.741899
Client Index = 2	Epoch: 4	Loss: 0.730683
test acc on this client after 377 / 502 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 3
local mask changes: 2866044.0 / 11173962
choose client_indexes: [ 3  6 10 11 12], accoring to random
choose mask diff: [2866044.0, 3040136.0, 3044256.0, 3045224.0, 3044114.0]
Doing local aggregation!
test acc on this client before 186 / 504 : 0.37
Client Index = 3	Epoch: 0	Loss: 1.215741
Client Index = 3	Epoch: 1	Loss: 1.121132
Client Index = 3	Epoch: 2	Loss: 1.082063
Client Index = 3	Epoch: 3	Loss: 1.104738
Client Index = 3	Epoch: 4	Loss: 1.100236
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 4
local mask changes: 2865992.0 / 11173962
choose client_indexes: [ 0  4  7 14 15], accoring to random
choose mask diff: [3039018.0, 2865992.0, 3039464.0, 3038306.0, 3039292.0]
Doing local aggregation!
test acc on this client before 272 / 503 : 0.54
Client Index = 4	Epoch: 0	Loss: 0.829326
Client Index = 4	Epoch: 1	Loss: 0.811321
Client Index = 4	Epoch: 2	Loss: 0.784662
Client Index = 4	Epoch: 3	Loss: 0.691662
Client Index = 4	Epoch: 4	Loss: 0.807230
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 5
local mask changes: 2866738.0 / 11173962
choose client_indexes: [ 0  5  7 13 15], accoring to random
choose mask diff: [3044650.0, 2866738.0, 3040086.0, 3047228.0, 3038734.0]
Doing local aggregation!
test acc on this client before 260 / 504 : 0.52
Client Index = 5	Epoch: 0	Loss: 1.051629
Client Index = 5	Epoch: 1	Loss: 0.925392
Client Index = 5	Epoch: 2	Loss: 0.929036
Client Index = 5	Epoch: 3	Loss: 0.918024
Client Index = 5	Epoch: 4	Loss: 0.897807
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 6
local mask changes: 2869872.0 / 11173962
choose client_indexes: [ 6  7  8 14 15], accoring to random
choose mask diff: [2869872.0, 3038694.0, 3042314.0, 3037578.0, 3037628.0]
Doing local aggregation!
test acc on this client before 213 / 505 : 0.42
Client Index = 6	Epoch: 0	Loss: 1.314811
Client Index = 6	Epoch: 1	Loss: 1.242295
Client Index = 6	Epoch: 2	Loss: 1.258284
Client Index = 6	Epoch: 3	Loss: 1.280412
Client Index = 6	Epoch: 4	Loss: 1.224706
test acc on this client after 252 / 505 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 7
local mask changes: 2866708.0 / 11173962
choose client_indexes: [ 7  8  9 10 14], accoring to random
choose mask diff: [2866708.0, 3043620.0, 3039436.0, 3044738.0, 3039560.0]
Doing local aggregation!
test acc on this client before 261 / 504 : 0.52
Client Index = 7	Epoch: 0	Loss: 1.142450
Client Index = 7	Epoch: 1	Loss: 1.084546
Client Index = 7	Epoch: 2	Loss: 1.074791
Client Index = 7	Epoch: 3	Loss: 1.057466
Client Index = 7	Epoch: 4	Loss: 1.123707
test acc on this client after 272 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 8
local mask changes: 2864258.0 / 11173962
choose client_indexes: [ 0  5  8  9 19], accoring to random
choose mask diff: [3043864.0, 3035868.0, 2864258.0, 3045984.0, 3048494.0]
Doing local aggregation!
test acc on this client before 208 / 504 : 0.41
Client Index = 8	Epoch: 0	Loss: 1.253884
Client Index = 8	Epoch: 1	Loss: 1.215343
Client Index = 8	Epoch: 2	Loss: 1.141386
Client Index = 8	Epoch: 3	Loss: 1.128086
Client Index = 8	Epoch: 4	Loss: 1.099191
test acc on this client after 291 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 9
local mask changes: 2869102.0 / 11173962
choose client_indexes: [ 1  7  9 10 12], accoring to random
choose mask diff: [3042374.0, 3041662.0, 2869102.0, 3046822.0, 3039060.0]
Doing local aggregation!
test acc on this client before 248 / 504 : 0.49
Client Index = 9	Epoch: 0	Loss: 1.039438
Client Index = 9	Epoch: 1	Loss: 1.052107
Client Index = 9	Epoch: 2	Loss: 0.900685
Client Index = 9	Epoch: 3	Loss: 0.977132
Client Index = 9	Epoch: 4	Loss: 0.909735
test acc on this client after 239 / 504 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 10
local mask changes: 2866196.0 / 11173962
choose client_indexes: [ 2  4 10 11 14], accoring to random
choose mask diff: [3037896.0, 3047714.0, 2866196.0, 3054096.0, 3040444.0]
Doing local aggregation!
test acc on this client before 204 / 503 : 0.41
Client Index = 10	Epoch: 0	Loss: 1.237253
Client Index = 10	Epoch: 1	Loss: 1.194412
Client Index = 10	Epoch: 2	Loss: 1.196954
Client Index = 10	Epoch: 3	Loss: 1.165933
Client Index = 10	Epoch: 4	Loss: 1.119556
test acc on this client after 289 / 503 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 11
local mask changes: 2865786.0 / 11173962
choose client_indexes: [ 3 10 11 16 19], accoring to random
choose mask diff: [3044336.0, 3052414.0, 2865786.0, 3043272.0, 3038540.0]
Doing local aggregation!
test acc on this client before 287 / 504 : 0.57
Client Index = 11	Epoch: 0	Loss: 0.887180
Client Index = 11	Epoch: 1	Loss: 0.802089
Client Index = 11	Epoch: 2	Loss: 0.755004
Client Index = 11	Epoch: 3	Loss: 0.733999
Client Index = 11	Epoch: 4	Loss: 0.764076
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 12
local mask changes: 2865702.0 / 11173962
choose client_indexes: [ 5 10 12 15 18], accoring to random
choose mask diff: [3039976.0, 3042522.0, 2865702.0, 3043020.0, 3040038.0]
Doing local aggregation!
test acc on this client before 284 / 504 : 0.56
Client Index = 12	Epoch: 0	Loss: 1.062382
Client Index = 12	Epoch: 1	Loss: 1.018714
Client Index = 12	Epoch: 2	Loss: 0.965693
Client Index = 12	Epoch: 3	Loss: 1.005856
Client Index = 12	Epoch: 4	Loss: 0.962877
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 13
local mask changes: 2866418.0 / 11173962
choose client_indexes: [ 0  5 13 15 18], accoring to random
choose mask diff: [3043388.0, 3046468.0, 2866418.0, 3046014.0, 3047132.0]
Doing local aggregation!
test acc on this client before 214 / 503 : 0.43
Client Index = 13	Epoch: 0	Loss: 1.236627
Client Index = 13	Epoch: 1	Loss: 1.133848
Client Index = 13	Epoch: 2	Loss: 1.127434
Client Index = 13	Epoch: 3	Loss: 1.126210
Client Index = 13	Epoch: 4	Loss: 1.160245
test acc on this client after 282 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 14
local mask changes: 2866600.0 / 11173962
choose client_indexes: [ 3  5 13 14 17], accoring to random
choose mask diff: [3037962.0, 3041248.0, 3041926.0, 2866600.0, 3042630.0]
Doing local aggregation!
test acc on this client before 189 / 502 : 0.38
Client Index = 14	Epoch: 0	Loss: 1.222961
Client Index = 14	Epoch: 1	Loss: 1.224469
Client Index = 14	Epoch: 2	Loss: 1.186095
Client Index = 14	Epoch: 3	Loss: 1.146042
Client Index = 14	Epoch: 4	Loss: 1.113028
test acc on this client after 301 / 502 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 15
local mask changes: 2864732.0 / 11173962
choose client_indexes: [ 1  8 10 13 15], accoring to random
choose mask diff: [3038670.0, 3041766.0, 3038912.0, 3042832.0, 2864732.0]
Doing local aggregation!
test acc on this client before 309 / 504 : 0.61
Client Index = 15	Epoch: 0	Loss: 1.060763
Client Index = 15	Epoch: 1	Loss: 0.992497
Client Index = 15	Epoch: 2	Loss: 0.982743
Client Index = 15	Epoch: 3	Loss: 0.919634
Client Index = 15	Epoch: 4	Loss: 0.978085
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 16
local mask changes: 2866022.0 / 11173962
choose client_indexes: [ 0 11 16 17 19], accoring to random
choose mask diff: [3044914.0, 3045256.0, 2866022.0, 3044212.0, 3051634.0]
Doing local aggregation!
test acc on this client before 223 / 503 : 0.44
Client Index = 16	Epoch: 0	Loss: 0.971210
Client Index = 16	Epoch: 1	Loss: 0.971013
Client Index = 16	Epoch: 2	Loss: 0.884845
Client Index = 16	Epoch: 3	Loss: 0.982214
Client Index = 16	Epoch: 4	Loss: 0.931886
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 17
local mask changes: 2866486.0 / 11173962
choose client_indexes: [10 14 16 17 19], accoring to random
choose mask diff: [3041290.0, 3039478.0, 3044482.0, 2866486.0, 3042352.0]
Doing local aggregation!
test acc on this client before 273 / 505 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.934996
Client Index = 17	Epoch: 1	Loss: 0.826387
Client Index = 17	Epoch: 2	Loss: 0.832630
Client Index = 17	Epoch: 3	Loss: 0.773888
Client Index = 17	Epoch: 4	Loss: 0.751967
test acc on this client after 359 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 18
local mask changes: 2868066.0 / 11173962
choose client_indexes: [ 3  4 16 18 19], accoring to random
choose mask diff: [3035046.0, 3038698.0, 3035604.0, 2868066.0, 3041300.0]
Doing local aggregation!
test acc on this client before 341 / 504 : 0.68
Client Index = 18	Epoch: 0	Loss: 0.783737
Client Index = 18	Epoch: 1	Loss: 0.680637
Client Index = 18	Epoch: 2	Loss: 0.688591
Client Index = 18	Epoch: 3	Loss: 0.662139
Client Index = 18	Epoch: 4	Loss: 0.663275
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(13) with spasity 0.5: 19
local mask changes: 2866250.0 / 11173962
choose client_indexes: [ 2  8 10 12 19], accoring to random
choose mask diff: [3050344.0, 3052258.0, 3043980.0, 3035758.0, 2866250.0]
Doing local aggregation!
test acc on this client before 228 / 506 : 0.45
Client Index = 19	Epoch: 0	Loss: 1.130974
Client Index = 19	Epoch: 1	Loss: 0.966156
Client Index = 19	Epoch: 2	Loss: 0.993097
Client Index = 19	Epoch: 3	Loss: 0.988148
Client Index = 19	Epoch: 4	Loss: 0.922966
test acc on this client after 322 / 506 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 13
{'test_acc': 0.6217683855555196, 'test_loss': 1.079663457300288}
################local_test_on_all_clients before local training in communication round: 13
{'test_acc': 0.4831295920689082, 'test_loss': 1.392092654456189}
################Communication round : 14
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 0
local mask changes: 2854152.0 / 11173962
choose client_indexes: [ 0  3 10 12 17], accoring to random
choose mask diff: [2854152.0, 3011584.0, 3016216.0, 3012746.0, 3013688.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 0	Epoch: 0	Loss: 1.377705
Client Index = 0	Epoch: 1	Loss: 1.328256
Client Index = 0	Epoch: 2	Loss: 1.341748
Client Index = 0	Epoch: 3	Loss: 1.277291
Client Index = 0	Epoch: 4	Loss: 1.266382
test acc on this client after 268 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 1
local mask changes: 2853942.0 / 11173962
choose client_indexes: [ 1  5  7 16 18], accoring to random
choose mask diff: [2853942.0, 3013618.0, 3016266.0, 3014402.0, 3010980.0]
Doing local aggregation!
test acc on this client before 223 / 503 : 0.44
Client Index = 1	Epoch: 0	Loss: 0.899340
Client Index = 1	Epoch: 1	Loss: 0.836527
Client Index = 1	Epoch: 2	Loss: 0.811856
Client Index = 1	Epoch: 3	Loss: 0.841874
Client Index = 1	Epoch: 4	Loss: 0.812511
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 2
local mask changes: 2854368.0 / 11173962
choose client_indexes: [ 2  7  8 15 16], accoring to random
choose mask diff: [2854368.0, 3012878.0, 3015284.0, 3017824.0, 3014154.0]
Doing local aggregation!
test acc on this client before 314 / 502 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.858328
Client Index = 2	Epoch: 1	Loss: 0.747991
Client Index = 2	Epoch: 2	Loss: 0.744560
Client Index = 2	Epoch: 3	Loss: 0.733703
Client Index = 2	Epoch: 4	Loss: 0.706732
test acc on this client after 365 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 3
local mask changes: 2855716.0 / 11173962
choose client_indexes: [ 3  5  6 10 19], accoring to random
choose mask diff: [2855716.0, 3011776.0, 3010620.0, 3011112.0, 3014248.0]
Doing local aggregation!
test acc on this client before 222 / 504 : 0.44
Client Index = 3	Epoch: 0	Loss: 1.170711
Client Index = 3	Epoch: 1	Loss: 1.092039
Client Index = 3	Epoch: 2	Loss: 1.104925
Client Index = 3	Epoch: 3	Loss: 1.098606
Client Index = 3	Epoch: 4	Loss: 1.028343
test acc on this client after 297 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 4
local mask changes: 2853492.0 / 11173962
choose client_indexes: [ 1  4  6 17 19], accoring to random
choose mask diff: [3014240.0, 2853492.0, 3011056.0, 3012446.0, 3011160.0]
Doing local aggregation!
test acc on this client before 329 / 503 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.909908
Client Index = 4	Epoch: 1	Loss: 0.763939
Client Index = 4	Epoch: 2	Loss: 0.789366
Client Index = 4	Epoch: 3	Loss: 0.762309
Client Index = 4	Epoch: 4	Loss: 0.735527
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 5
local mask changes: 2854834.0 / 11173962
choose client_indexes: [ 0  1  5  8 15], accoring to random
choose mask diff: [3007936.0, 3010388.0, 2854834.0, 3012508.0, 3010102.0]
Doing local aggregation!
test acc on this client before 291 / 504 : 0.58
Client Index = 5	Epoch: 0	Loss: 1.050033
Client Index = 5	Epoch: 1	Loss: 0.937583
Client Index = 5	Epoch: 2	Loss: 0.878498
Client Index = 5	Epoch: 3	Loss: 0.876476
Client Index = 5	Epoch: 4	Loss: 0.893706
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 6
local mask changes: 2854524.0 / 11173962
choose client_indexes: [ 2  5  6  9 19], accoring to random
choose mask diff: [3014494.0, 3008266.0, 2854524.0, 3019388.0, 3020910.0]
Doing local aggregation!
test acc on this client before 221 / 505 : 0.44
Client Index = 6	Epoch: 0	Loss: 1.252571
Client Index = 6	Epoch: 1	Loss: 1.256134
Client Index = 6	Epoch: 2	Loss: 1.251532
Client Index = 6	Epoch: 3	Loss: 1.202989
Client Index = 6	Epoch: 4	Loss: 1.206651
test acc on this client after 274 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 7
local mask changes: 2856314.0 / 11173962
choose client_indexes: [ 0  1  7 10 14], accoring to random
choose mask diff: [3012416.0, 3013278.0, 2856314.0, 3012732.0, 3006100.0]
Doing local aggregation!
test acc on this client before 271 / 504 : 0.54
Client Index = 7	Epoch: 0	Loss: 1.169638
Client Index = 7	Epoch: 1	Loss: 1.138206
Client Index = 7	Epoch: 2	Loss: 1.061253
Client Index = 7	Epoch: 3	Loss: 1.067678
Client Index = 7	Epoch: 4	Loss: 0.968299
test acc on this client after 246 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 8
local mask changes: 2853994.0 / 11173962
choose client_indexes: [ 5  8  9 10 16], accoring to random
choose mask diff: [3006168.0, 2853994.0, 3013500.0, 3017762.0, 3017082.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 8	Epoch: 0	Loss: 1.238652
Client Index = 8	Epoch: 1	Loss: 1.208551
Client Index = 8	Epoch: 2	Loss: 1.104550
Client Index = 8	Epoch: 3	Loss: 1.110801
Client Index = 8	Epoch: 4	Loss: 1.060239
test acc on this client after 264 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 9
local mask changes: 2853722.0 / 11173962
choose client_indexes: [ 2  3  9 11 16], accoring to random
choose mask diff: [3018638.0, 3018798.0, 2853722.0, 3017604.0, 3015974.0]
Doing local aggregation!
test acc on this client before 221 / 504 : 0.44
Client Index = 9	Epoch: 0	Loss: 1.061414
Client Index = 9	Epoch: 1	Loss: 0.952018
Client Index = 9	Epoch: 2	Loss: 0.993906
Client Index = 9	Epoch: 3	Loss: 0.930309
Client Index = 9	Epoch: 4	Loss: 0.924068
test acc on this client after 324 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 10
local mask changes: 2855044.0 / 11173962
choose client_indexes: [ 0  1  2  6 10], accoring to random
choose mask diff: [3014170.0, 3005456.0, 3008618.0, 3016544.0, 2855044.0]
Doing local aggregation!
test acc on this client before 294 / 503 : 0.58
Client Index = 10	Epoch: 0	Loss: 1.169394
Client Index = 10	Epoch: 1	Loss: 1.208446
Client Index = 10	Epoch: 2	Loss: 1.167445
Client Index = 10	Epoch: 3	Loss: 1.112139
Client Index = 10	Epoch: 4	Loss: 1.138928
test acc on this client after 274 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 11
local mask changes: 2852942.0 / 11173962
choose client_indexes: [ 3  9 11 13 17], accoring to random
choose mask diff: [3012020.0, 3014918.0, 2852942.0, 3016820.0, 3017524.0]
Doing local aggregation!
test acc on this client before 204 / 504 : 0.40
Client Index = 11	Epoch: 0	Loss: 0.949385
Client Index = 11	Epoch: 1	Loss: 0.749192
Client Index = 11	Epoch: 2	Loss: 0.760188
Client Index = 11	Epoch: 3	Loss: 0.663106
Client Index = 11	Epoch: 4	Loss: 0.744005
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 12
local mask changes: 2854186.0 / 11173962
choose client_indexes: [ 6 12 13 18 19], accoring to random
choose mask diff: [3014404.0, 2854186.0, 3011372.0, 3007696.0, 3008976.0]
Doing local aggregation!
test acc on this client before 308 / 504 : 0.61
Client Index = 12	Epoch: 0	Loss: 1.005216
Client Index = 12	Epoch: 1	Loss: 0.982596
Client Index = 12	Epoch: 2	Loss: 0.993241
Client Index = 12	Epoch: 3	Loss: 0.953214
Client Index = 12	Epoch: 4	Loss: 0.936720
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 13
local mask changes: 2856400.0 / 11173962
choose client_indexes: [ 5  9 13 14 17], accoring to random
choose mask diff: [3012966.0, 3013832.0, 2856400.0, 3013968.0, 3014392.0]
Doing local aggregation!
test acc on this client before 271 / 503 : 0.54
Client Index = 13	Epoch: 0	Loss: 1.172761
Client Index = 13	Epoch: 1	Loss: 1.131402
Client Index = 13	Epoch: 2	Loss: 1.082745
Client Index = 13	Epoch: 3	Loss: 1.097082
Client Index = 13	Epoch: 4	Loss: 1.056452
test acc on this client after 282 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 14
local mask changes: 2855004.0 / 11173962
choose client_indexes: [ 9 13 14 15 16], accoring to random
choose mask diff: [3009198.0, 3011532.0, 2855004.0, 3012378.0, 3008034.0]
Doing local aggregation!
test acc on this client before 285 / 502 : 0.57
Client Index = 14	Epoch: 0	Loss: 1.200073
Client Index = 14	Epoch: 1	Loss: 1.191139
Client Index = 14	Epoch: 2	Loss: 1.073274
Client Index = 14	Epoch: 3	Loss: 1.123765
Client Index = 14	Epoch: 4	Loss: 1.128413
test acc on this client after 265 / 502 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 15
local mask changes: 2852168.0 / 11173962
choose client_indexes: [ 2  9 12 15 19], accoring to random
choose mask diff: [3020168.0, 3011592.0, 3010736.0, 2852168.0, 3014904.0]
Doing local aggregation!
test acc on this client before 303 / 504 : 0.60
Client Index = 15	Epoch: 0	Loss: 0.992483
Client Index = 15	Epoch: 1	Loss: 0.978009
Client Index = 15	Epoch: 2	Loss: 0.919175
Client Index = 15	Epoch: 3	Loss: 0.945935
Client Index = 15	Epoch: 4	Loss: 0.935782
test acc on this client after 289 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 16
local mask changes: 2851930.0 / 11173962
choose client_indexes: [ 2  7 11 12 16], accoring to random
choose mask diff: [3014676.0, 3017080.0, 3006758.0, 3013680.0, 2851930.0]
Doing local aggregation!
test acc on this client before 263 / 503 : 0.52
Client Index = 16	Epoch: 0	Loss: 0.944291
Client Index = 16	Epoch: 1	Loss: 0.926357
Client Index = 16	Epoch: 2	Loss: 0.870884
Client Index = 16	Epoch: 3	Loss: 0.880478
Client Index = 16	Epoch: 4	Loss: 0.900616
test acc on this client after 340 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 17
local mask changes: 2852632.0 / 11173962
choose client_indexes: [ 2 12 13 17 18], accoring to random
choose mask diff: [3011100.0, 3008798.0, 3012756.0, 2852632.0, 3010206.0]
Doing local aggregation!
test acc on this client before 315 / 505 : 0.62
Client Index = 17	Epoch: 0	Loss: 0.867493
Client Index = 17	Epoch: 1	Loss: 0.822089
Client Index = 17	Epoch: 2	Loss: 0.772793
Client Index = 17	Epoch: 3	Loss: 0.773812
Client Index = 17	Epoch: 4	Loss: 0.723956
test acc on this client after 368 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 18
local mask changes: 2853802.0 / 11173962
choose client_indexes: [ 0  6  7  9 18], accoring to random
choose mask diff: [3007262.0, 3015872.0, 3014444.0, 3014048.0, 2853802.0]
Doing local aggregation!
test acc on this client before 326 / 504 : 0.65
Client Index = 18	Epoch: 0	Loss: 0.707382
Client Index = 18	Epoch: 1	Loss: 0.713245
Client Index = 18	Epoch: 2	Loss: 0.670584
Client Index = 18	Epoch: 3	Loss: 0.694262
Client Index = 18	Epoch: 4	Loss: 0.606227
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(14) with spasity 0.5: 19
local mask changes: 2854792.0 / 11173962
choose client_indexes: [ 5  8 14 18 19], accoring to random
choose mask diff: [3018542.0, 3015774.0, 3012046.0, 3015306.0, 2854792.0]
Doing local aggregation!
test acc on this client before 264 / 506 : 0.52
Client Index = 19	Epoch: 0	Loss: 1.045535
Client Index = 19	Epoch: 1	Loss: 0.972261
Client Index = 19	Epoch: 2	Loss: 0.969987
Client Index = 19	Epoch: 3	Loss: 0.943599
Client Index = 19	Epoch: 4	Loss: 0.906680
test acc on this client after 292 / 506 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 14
{'test_acc': 0.6269132259981794, 'test_loss': 1.0906842976399986}
################local_test_on_all_clients before local training in communication round: 14
{'test_acc': 0.5417683659276963, 'test_loss': 1.2903626117048241}
################Communication round : 15
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 0
local mask changes: 2839800.0 / 11173962
choose client_indexes: [ 0  4 11 12 15], accoring to random
choose mask diff: [2839800.0, 2979628.0, 2986512.0, 2981122.0, 2984246.0]
Doing local aggregation!
test acc on this client before 203 / 504 : 0.40
Client Index = 0	Epoch: 0	Loss: 1.306076
Client Index = 0	Epoch: 1	Loss: 1.314434
Client Index = 0	Epoch: 2	Loss: 1.289027
Client Index = 0	Epoch: 3	Loss: 1.274489
Client Index = 0	Epoch: 4	Loss: 1.221945
test acc on this client after 286 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 1
local mask changes: 2840058.0 / 11173962
choose client_indexes: [ 1  2  5  7 17], accoring to random
choose mask diff: [2840058.0, 2979504.0, 2983858.0, 2986788.0, 2984206.0]
Doing local aggregation!
test acc on this client before 298 / 503 : 0.59
Client Index = 1	Epoch: 0	Loss: 0.901219
Client Index = 1	Epoch: 1	Loss: 0.835654
Client Index = 1	Epoch: 2	Loss: 0.866259
Client Index = 1	Epoch: 3	Loss: 0.737677
Client Index = 1	Epoch: 4	Loss: 0.749028
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 2
local mask changes: 2841292.0 / 11173962
choose client_indexes: [ 2  6 11 14 18], accoring to random
choose mask diff: [2841292.0, 2983904.0, 2988588.0, 2978218.0, 2986076.0]
Doing local aggregation!
test acc on this client before 204 / 502 : 0.41
Client Index = 2	Epoch: 0	Loss: 0.875589
Client Index = 2	Epoch: 1	Loss: 0.766814
Client Index = 2	Epoch: 2	Loss: 0.780180
Client Index = 2	Epoch: 3	Loss: 0.704527
Client Index = 2	Epoch: 4	Loss: 0.715686
test acc on this client after 378 / 502 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 3
local mask changes: 2839958.0 / 11173962
choose client_indexes: [ 1  3  8  9 14], accoring to random
choose mask diff: [2982936.0, 2839958.0, 2988950.0, 2989608.0, 2982348.0]
Doing local aggregation!
test acc on this client before 213 / 504 : 0.42
Client Index = 3	Epoch: 0	Loss: 1.223373
Client Index = 3	Epoch: 1	Loss: 1.058695
Client Index = 3	Epoch: 2	Loss: 1.066437
Client Index = 3	Epoch: 3	Loss: 1.088247
Client Index = 3	Epoch: 4	Loss: 1.036088
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 4
local mask changes: 2840768.0 / 11173962
choose client_indexes: [ 1  4  5  9 18], accoring to random
choose mask diff: [2985608.0, 2840768.0, 2986312.0, 2988572.0, 2982516.0]
Doing local aggregation!
test acc on this client before 145 / 503 : 0.29
Client Index = 4	Epoch: 0	Loss: 0.914596
Client Index = 4	Epoch: 1	Loss: 0.752120
Client Index = 4	Epoch: 2	Loss: 0.826593
Client Index = 4	Epoch: 3	Loss: 0.730352
Client Index = 4	Epoch: 4	Loss: 0.730133
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 5
local mask changes: 2841198.0 / 11173962
choose client_indexes: [ 5  9 10 15 18], accoring to random
choose mask diff: [2841198.0, 2983524.0, 2986978.0, 2981998.0, 2985664.0]
Doing local aggregation!
test acc on this client before 250 / 504 : 0.50
Client Index = 5	Epoch: 0	Loss: 0.990164
Client Index = 5	Epoch: 1	Loss: 0.862514
Client Index = 5	Epoch: 2	Loss: 0.918134
Client Index = 5	Epoch: 3	Loss: 0.837342
Client Index = 5	Epoch: 4	Loss: 0.805111
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 6
local mask changes: 2840514.0 / 11173962
choose client_indexes: [ 6  7  8 11 18], accoring to random
choose mask diff: [2840514.0, 2980306.0, 2981346.0, 2996586.0, 2990088.0]
Doing local aggregation!
test acc on this client before 249 / 505 : 0.49
Client Index = 6	Epoch: 0	Loss: 1.302870
Client Index = 6	Epoch: 1	Loss: 1.273032
Client Index = 6	Epoch: 2	Loss: 1.170402
Client Index = 6	Epoch: 3	Loss: 1.198070
Client Index = 6	Epoch: 4	Loss: 1.215262
test acc on this client after 256 / 505 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 7
local mask changes: 2841848.0 / 11173962
choose client_indexes: [ 0  5  7 10 11], accoring to random
choose mask diff: [2982734.0, 2981572.0, 2841848.0, 2982264.0, 2991132.0]
Doing local aggregation!
test acc on this client before 291 / 504 : 0.58
Client Index = 7	Epoch: 0	Loss: 1.151324
Client Index = 7	Epoch: 1	Loss: 1.100693
Client Index = 7	Epoch: 2	Loss: 1.006334
Client Index = 7	Epoch: 3	Loss: 1.050494
Client Index = 7	Epoch: 4	Loss: 1.045042
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 8
local mask changes: 2840838.0 / 11173962
choose client_indexes: [ 4  8  9 13 14], accoring to random
choose mask diff: [2987326.0, 2840838.0, 2982372.0, 2991704.0, 2982454.0]
Doing local aggregation!
test acc on this client before 250 / 504 : 0.50
Client Index = 8	Epoch: 0	Loss: 1.266852
Client Index = 8	Epoch: 1	Loss: 1.097731
Client Index = 8	Epoch: 2	Loss: 1.149425
Client Index = 8	Epoch: 3	Loss: 1.107849
Client Index = 8	Epoch: 4	Loss: 1.046598
test acc on this client after 292 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 9
local mask changes: 2839208.0 / 11173962
choose client_indexes: [ 1  2  6  9 19], accoring to random
choose mask diff: [2985414.0, 2988162.0, 2989062.0, 2839208.0, 2988348.0]
Doing local aggregation!
test acc on this client before 257 / 504 : 0.51
Client Index = 9	Epoch: 0	Loss: 1.024221
Client Index = 9	Epoch: 1	Loss: 0.905112
Client Index = 9	Epoch: 2	Loss: 0.895154
Client Index = 9	Epoch: 3	Loss: 0.897943
Client Index = 9	Epoch: 4	Loss: 0.864654
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 10
local mask changes: 2839098.0 / 11173962
choose client_indexes: [ 2  8 10 15 16], accoring to random
choose mask diff: [2977718.0, 2989570.0, 2839098.0, 2980474.0, 2988826.0]
Doing local aggregation!
test acc on this client before 230 / 503 : 0.46
Client Index = 10	Epoch: 0	Loss: 1.130770
Client Index = 10	Epoch: 1	Loss: 1.176963
Client Index = 10	Epoch: 2	Loss: 1.141920
Client Index = 10	Epoch: 3	Loss: 1.116154
Client Index = 10	Epoch: 4	Loss: 1.065289
test acc on this client after 240 / 503 : 0.48
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 11
local mask changes: 2841982.0 / 11173962
choose client_indexes: [ 2  3 10 11 18], accoring to random
choose mask diff: [2991272.0, 2980988.0, 2989668.0, 2841982.0, 2980208.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.782570
Client Index = 11	Epoch: 1	Loss: 0.786553
Client Index = 11	Epoch: 2	Loss: 0.704449
Client Index = 11	Epoch: 3	Loss: 0.734050
Client Index = 11	Epoch: 4	Loss: 0.655463
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 12
local mask changes: 2840608.0 / 11173962
choose client_indexes: [ 9 10 11 12 19], accoring to random
choose mask diff: [2982286.0, 2982436.0, 2987962.0, 2840608.0, 2976830.0]
Doing local aggregation!
test acc on this client before 331 / 504 : 0.66
Client Index = 12	Epoch: 0	Loss: 0.993280
Client Index = 12	Epoch: 1	Loss: 0.928535
Client Index = 12	Epoch: 2	Loss: 0.941668
Client Index = 12	Epoch: 3	Loss: 0.894971
Client Index = 12	Epoch: 4	Loss: 0.936116
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 13
local mask changes: 2841966.0 / 11173962
choose client_indexes: [10 11 13 15 17], accoring to random
choose mask diff: [2990084.0, 2987822.0, 2841966.0, 2984708.0, 2984918.0]
Doing local aggregation!
test acc on this client before 312 / 503 : 0.62
Client Index = 13	Epoch: 0	Loss: 1.129341
Client Index = 13	Epoch: 1	Loss: 1.076068
Client Index = 13	Epoch: 2	Loss: 1.073414
Client Index = 13	Epoch: 3	Loss: 1.106594
Client Index = 13	Epoch: 4	Loss: 0.987974
test acc on this client after 295 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 14
local mask changes: 2840530.0 / 11173962
choose client_indexes: [ 5 10 11 14 16], accoring to random
choose mask diff: [2980226.0, 2985728.0, 2984410.0, 2840530.0, 2977836.0]
Doing local aggregation!
test acc on this client before 299 / 502 : 0.60
Client Index = 14	Epoch: 0	Loss: 1.124006
Client Index = 14	Epoch: 1	Loss: 1.115728
Client Index = 14	Epoch: 2	Loss: 1.145759
Client Index = 14	Epoch: 3	Loss: 1.034359
Client Index = 14	Epoch: 4	Loss: 1.090618
test acc on this client after 316 / 502 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 15
local mask changes: 2840984.0 / 11173962
choose client_indexes: [ 4  9 11 15 18], accoring to random
choose mask diff: [2984486.0, 2979520.0, 2991340.0, 2840984.0, 2984886.0]
Doing local aggregation!
test acc on this client before 263 / 504 : 0.52
Client Index = 15	Epoch: 0	Loss: 1.041300
Client Index = 15	Epoch: 1	Loss: 0.919233
Client Index = 15	Epoch: 2	Loss: 0.913649
Client Index = 15	Epoch: 3	Loss: 0.901176
Client Index = 15	Epoch: 4	Loss: 0.873499
test acc on this client after 316 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 16
local mask changes: 2839214.0 / 11173962
choose client_indexes: [ 6  8 10 15 16], accoring to random
choose mask diff: [2989422.0, 2986792.0, 2986260.0, 2987456.0, 2839214.0]
Doing local aggregation!
test acc on this client before 284 / 503 : 0.56
Client Index = 16	Epoch: 0	Loss: 0.956794
Client Index = 16	Epoch: 1	Loss: 0.932374
Client Index = 16	Epoch: 2	Loss: 0.905758
Client Index = 16	Epoch: 3	Loss: 0.865449
Client Index = 16	Epoch: 4	Loss: 0.928433
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 17
local mask changes: 2839806.0 / 11173962
choose client_indexes: [ 4  6 10 16 17], accoring to random
choose mask diff: [2983016.0, 2985438.0, 2982938.0, 2981934.0, 2839806.0]
Doing local aggregation!
test acc on this client before 185 / 505 : 0.37
Client Index = 17	Epoch: 0	Loss: 0.940917
Client Index = 17	Epoch: 1	Loss: 0.768998
Client Index = 17	Epoch: 2	Loss: 0.774568
Client Index = 17	Epoch: 3	Loss: 0.748092
Client Index = 17	Epoch: 4	Loss: 0.699215
test acc on this client after 343 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 18
local mask changes: 2839398.0 / 11173962
choose client_indexes: [12 14 15 17 18], accoring to random
choose mask diff: [2981016.0, 2981234.0, 2983186.0, 2983542.0, 2839398.0]
Doing local aggregation!
test acc on this client before 193 / 504 : 0.38
Client Index = 18	Epoch: 0	Loss: 0.776209
Client Index = 18	Epoch: 1	Loss: 0.660883
Client Index = 18	Epoch: 2	Loss: 0.641836
Client Index = 18	Epoch: 3	Loss: 0.642999
Client Index = 18	Epoch: 4	Loss: 0.610693
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(15) with spasity 0.5: 19
local mask changes: 2840216.0 / 11173962
choose client_indexes: [ 0  3 13 15 19], accoring to random
choose mask diff: [2984628.0, 2982542.0, 2984052.0, 2984526.0, 2840216.0]
Doing local aggregation!
test acc on this client before 298 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 0.967189
Client Index = 19	Epoch: 1	Loss: 0.928148
Client Index = 19	Epoch: 2	Loss: 0.939463
Client Index = 19	Epoch: 3	Loss: 0.895189
Client Index = 19	Epoch: 4	Loss: 0.892767
test acc on this client after 312 / 506 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 15
{'test_acc': 0.6408207179191141, 'test_loss': 1.0424306246665302}
################local_test_on_all_clients before local training in communication round: 15
{'test_acc': 0.5105644419973774, 'test_loss': 1.3435293379883129}
################Communication round : 16
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 0
local mask changes: 2825590.0 / 11173962
choose client_indexes: [ 0  4 11 15 19], accoring to random
choose mask diff: [2825590.0, 2951886.0, 2953558.0, 2957128.0, 2955782.0]
Doing local aggregation!
test acc on this client before 228 / 504 : 0.45
Client Index = 0	Epoch: 0	Loss: 1.324857
Client Index = 0	Epoch: 1	Loss: 1.294411
Client Index = 0	Epoch: 2	Loss: 1.217590
Client Index = 0	Epoch: 3	Loss: 1.251778
Client Index = 0	Epoch: 4	Loss: 1.233250
test acc on this client after 271 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 1
local mask changes: 2825474.0 / 11173962
choose client_indexes: [ 1  2  4 10 17], accoring to random
choose mask diff: [2825474.0, 2949990.0, 2958826.0, 2950836.0, 2954916.0]
Doing local aggregation!
test acc on this client before 325 / 503 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.819503
Client Index = 1	Epoch: 1	Loss: 0.863648
Client Index = 1	Epoch: 2	Loss: 0.747555
Client Index = 1	Epoch: 3	Loss: 0.849214
Client Index = 1	Epoch: 4	Loss: 0.715564
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 2
local mask changes: 2824432.0 / 11173962
choose client_indexes: [ 0  2  5 11 19], accoring to random
choose mask diff: [2959432.0, 2824432.0, 2956242.0, 2958950.0, 2961050.0]
Doing local aggregation!
test acc on this client before 148 / 502 : 0.29
Client Index = 2	Epoch: 0	Loss: 0.845822
Client Index = 2	Epoch: 1	Loss: 0.760536
Client Index = 2	Epoch: 2	Loss: 0.698719
Client Index = 2	Epoch: 3	Loss: 0.739457
Client Index = 2	Epoch: 4	Loss: 0.674235
test acc on this client after 383 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 3
local mask changes: 2826890.0 / 11173962
choose client_indexes: [ 1  3  4 18 19], accoring to random
choose mask diff: [2957072.0, 2826890.0, 2956054.0, 2958108.0, 2956838.0]
Doing local aggregation!
test acc on this client before 284 / 504 : 0.56
Client Index = 3	Epoch: 0	Loss: 1.136925
Client Index = 3	Epoch: 1	Loss: 1.033896
Client Index = 3	Epoch: 2	Loss: 1.055932
Client Index = 3	Epoch: 3	Loss: 1.018828
Client Index = 3	Epoch: 4	Loss: 1.065774
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 4
local mask changes: 2827434.0 / 11173962
choose client_indexes: [ 3  4 12 15 17], accoring to random
choose mask diff: [2957886.0, 2827434.0, 2955580.0, 2955034.0, 2958462.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 4	Epoch: 0	Loss: 0.823702
Client Index = 4	Epoch: 1	Loss: 0.783132
Client Index = 4	Epoch: 2	Loss: 0.728381
Client Index = 4	Epoch: 3	Loss: 0.744247
Client Index = 4	Epoch: 4	Loss: 0.730385
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 5
local mask changes: 2825290.0 / 11173962
choose client_indexes: [ 2  5 10 16 19], accoring to random
choose mask diff: [2955774.0, 2825290.0, 2955062.0, 2958372.0, 2959758.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 5	Epoch: 0	Loss: 0.970380
Client Index = 5	Epoch: 1	Loss: 0.850068
Client Index = 5	Epoch: 2	Loss: 0.871642
Client Index = 5	Epoch: 3	Loss: 0.828036
Client Index = 5	Epoch: 4	Loss: 0.828555
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 6
local mask changes: 2825786.0 / 11173962
choose client_indexes: [ 0  1  6 10 19], accoring to random
choose mask diff: [2959770.0, 2960416.0, 2825786.0, 2957720.0, 2963460.0]
Doing local aggregation!
test acc on this client before 196 / 505 : 0.39
Client Index = 6	Epoch: 0	Loss: 1.260701
Client Index = 6	Epoch: 1	Loss: 1.193996
Client Index = 6	Epoch: 2	Loss: 1.220264
Client Index = 6	Epoch: 3	Loss: 1.186047
Client Index = 6	Epoch: 4	Loss: 1.153428
test acc on this client after 220 / 505 : 0.44
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 7
local mask changes: 2823924.0 / 11173962
choose client_indexes: [ 1  7 13 15 19], accoring to random
choose mask diff: [2958002.0, 2823924.0, 2959672.0, 2958622.0, 2962792.0]
Doing local aggregation!
test acc on this client before 267 / 504 : 0.53
Client Index = 7	Epoch: 0	Loss: 1.092926
Client Index = 7	Epoch: 1	Loss: 1.082226
Client Index = 7	Epoch: 2	Loss: 1.044472
Client Index = 7	Epoch: 3	Loss: 0.981512
Client Index = 7	Epoch: 4	Loss: 1.057405
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 8
local mask changes: 2825992.0 / 11173962
choose client_indexes: [ 5  8  9 10 13], accoring to random
choose mask diff: [2951266.0, 2825992.0, 2953942.0, 2957794.0, 2959766.0]
Doing local aggregation!
test acc on this client before 251 / 504 : 0.50
Client Index = 8	Epoch: 0	Loss: 1.163600
Client Index = 8	Epoch: 1	Loss: 1.148135
Client Index = 8	Epoch: 2	Loss: 1.066200
Client Index = 8	Epoch: 3	Loss: 1.077721
Client Index = 8	Epoch: 4	Loss: 0.994310
test acc on this client after 237 / 504 : 0.47
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 9
local mask changes: 2826268.0 / 11173962
choose client_indexes: [ 0  5  9 12 13], accoring to random
choose mask diff: [2959308.0, 2957688.0, 2826268.0, 2956568.0, 2959528.0]
Doing local aggregation!
test acc on this client before 333 / 504 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.951420
Client Index = 9	Epoch: 1	Loss: 0.884332
Client Index = 9	Epoch: 2	Loss: 0.901013
Client Index = 9	Epoch: 3	Loss: 0.892832
Client Index = 9	Epoch: 4	Loss: 0.838901
test acc on this client after 321 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 10
local mask changes: 2825254.0 / 11173962
choose client_indexes: [ 0  6 10 14 16], accoring to random
choose mask diff: [2956770.0, 2958902.0, 2825254.0, 2958756.0, 2957606.0]
Doing local aggregation!
test acc on this client before 192 / 503 : 0.38
Client Index = 10	Epoch: 0	Loss: 1.172493
Client Index = 10	Epoch: 1	Loss: 1.167797
Client Index = 10	Epoch: 2	Loss: 1.130459
Client Index = 10	Epoch: 3	Loss: 1.096317
Client Index = 10	Epoch: 4	Loss: 1.058371
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 11
local mask changes: 2824664.0 / 11173962
choose client_indexes: [ 0  2  8 11 14], accoring to random
choose mask diff: [2955322.0, 2957040.0, 2961276.0, 2824664.0, 2954584.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 11	Epoch: 0	Loss: 0.796038
Client Index = 11	Epoch: 1	Loss: 0.808881
Client Index = 11	Epoch: 2	Loss: 0.715391
Client Index = 11	Epoch: 3	Loss: 0.691062
Client Index = 11	Epoch: 4	Loss: 0.618207
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 12
local mask changes: 2828002.0 / 11173962
choose client_indexes: [ 1  2  6 11 12], accoring to random
choose mask diff: [2954604.0, 2959010.0, 2958484.0, 2955806.0, 2828002.0]
Doing local aggregation!
test acc on this client before 173 / 504 : 0.34
Client Index = 12	Epoch: 0	Loss: 1.028408
Client Index = 12	Epoch: 1	Loss: 0.952743
Client Index = 12	Epoch: 2	Loss: 0.930051
Client Index = 12	Epoch: 3	Loss: 0.922396
Client Index = 12	Epoch: 4	Loss: 0.895864
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 13
local mask changes: 2824774.0 / 11173962
choose client_indexes: [ 4  7 13 15 17], accoring to random
choose mask diff: [2958822.0, 2961438.0, 2824774.0, 2953900.0, 2953998.0]
Doing local aggregation!
test acc on this client before 329 / 503 : 0.65
Client Index = 13	Epoch: 0	Loss: 1.083312
Client Index = 13	Epoch: 1	Loss: 1.102919
Client Index = 13	Epoch: 2	Loss: 1.139102
Client Index = 13	Epoch: 3	Loss: 0.995345
Client Index = 13	Epoch: 4	Loss: 1.072166
test acc on this client after 275 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 14
local mask changes: 2826910.0 / 11173962
choose client_indexes: [ 0  1  4 14 18], accoring to random
choose mask diff: [2957786.0, 2959726.0, 2958656.0, 2826910.0, 2957546.0]
Doing local aggregation!
test acc on this client before 308 / 502 : 0.61
Client Index = 14	Epoch: 0	Loss: 1.125750
Client Index = 14	Epoch: 1	Loss: 1.142533
Client Index = 14	Epoch: 2	Loss: 1.110892
Client Index = 14	Epoch: 3	Loss: 1.107798
Client Index = 14	Epoch: 4	Loss: 1.113684
test acc on this client after 287 / 502 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 15
local mask changes: 2827130.0 / 11173962
choose client_indexes: [11 12 15 16 17], accoring to random
choose mask diff: [2959958.0, 2953396.0, 2827130.0, 2958892.0, 2960160.0]
Doing local aggregation!
test acc on this client before 224 / 504 : 0.44
Client Index = 15	Epoch: 0	Loss: 0.985524
Client Index = 15	Epoch: 1	Loss: 0.937276
Client Index = 15	Epoch: 2	Loss: 0.923993
Client Index = 15	Epoch: 3	Loss: 0.863769
Client Index = 15	Epoch: 4	Loss: 0.869516
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 16
local mask changes: 2825970.0 / 11173962
choose client_indexes: [ 0  1  7  9 16], accoring to random
choose mask diff: [2954492.0, 2957716.0, 2958560.0, 2954982.0, 2825970.0]
Doing local aggregation!
test acc on this client before 328 / 503 : 0.65
Client Index = 16	Epoch: 0	Loss: 0.934459
Client Index = 16	Epoch: 1	Loss: 0.851823
Client Index = 16	Epoch: 2	Loss: 0.948739
Client Index = 16	Epoch: 3	Loss: 0.854813
Client Index = 16	Epoch: 4	Loss: 0.802984
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 17
local mask changes: 2826352.0 / 11173962
choose client_indexes: [ 5  9 14 16 17], accoring to random
choose mask diff: [2954442.0, 2958956.0, 2956894.0, 2955402.0, 2826352.0]
Doing local aggregation!
test acc on this client before 281 / 505 : 0.56
Client Index = 17	Epoch: 0	Loss: 0.848683
Client Index = 17	Epoch: 1	Loss: 0.772917
Client Index = 17	Epoch: 2	Loss: 0.806342
Client Index = 17	Epoch: 3	Loss: 0.711952
Client Index = 17	Epoch: 4	Loss: 0.696513
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 18
local mask changes: 2824210.0 / 11173962
choose client_indexes: [ 2  7 11 13 18], accoring to random
choose mask diff: [2960148.0, 2960986.0, 2956648.0, 2956686.0, 2824210.0]
Doing local aggregation!
test acc on this client before 351 / 504 : 0.70
Client Index = 18	Epoch: 0	Loss: 0.826757
Client Index = 18	Epoch: 1	Loss: 0.623417
Client Index = 18	Epoch: 2	Loss: 0.669934
Client Index = 18	Epoch: 3	Loss: 0.647340
Client Index = 18	Epoch: 4	Loss: 0.591591
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(16) with spasity 0.5: 19
local mask changes: 2825904.0 / 11173962
choose client_indexes: [ 1  4  8 16 19], accoring to random
choose mask diff: [2957538.0, 2957758.0, 2960154.0, 2961978.0, 2825904.0]
Doing local aggregation!
test acc on this client before 229 / 506 : 0.45
Client Index = 19	Epoch: 0	Loss: 0.955538
Client Index = 19	Epoch: 1	Loss: 0.954256
Client Index = 19	Epoch: 2	Loss: 0.895953
Client Index = 19	Epoch: 3	Loss: 0.920675
Client Index = 19	Epoch: 4	Loss: 0.896890
test acc on this client after 335 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 16
{'test_acc': 0.6303821991966306, 'test_loss': 1.0640021136345748}
################local_test_on_all_clients before local training in communication round: 16
{'test_acc': 0.5459347922893193, 'test_loss': 1.2647478538087111}
################Communication round : 17
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 0
local mask changes: 2811490.0 / 11173962
choose client_indexes: [ 0  1 16 17 19], accoring to random
choose mask diff: [2811490.0, 2931610.0, 2929502.0, 2931534.0, 2925426.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 0	Epoch: 0	Loss: 1.253847
Client Index = 0	Epoch: 1	Loss: 1.259471
Client Index = 0	Epoch: 2	Loss: 1.273541
Client Index = 0	Epoch: 3	Loss: 1.218750
Client Index = 0	Epoch: 4	Loss: 1.229367
test acc on this client after 280 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 1
local mask changes: 2810460.0 / 11173962
choose client_indexes: [ 1  2  3  7 11], accoring to random
choose mask diff: [2810460.0, 2925878.0, 2931202.0, 2929280.0, 2934868.0]
Doing local aggregation!
test acc on this client before 258 / 503 : 0.51
Client Index = 1	Epoch: 0	Loss: 0.877516
Client Index = 1	Epoch: 1	Loss: 0.774438
Client Index = 1	Epoch: 2	Loss: 0.840597
Client Index = 1	Epoch: 3	Loss: 0.746617
Client Index = 1	Epoch: 4	Loss: 0.730714
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 2
local mask changes: 2809394.0 / 11173962
choose client_indexes: [ 0  2  6  8 18], accoring to random
choose mask diff: [2926576.0, 2809394.0, 2927262.0, 2932002.0, 2930066.0]
Doing local aggregation!
test acc on this client before 170 / 502 : 0.34
Client Index = 2	Epoch: 0	Loss: 0.838419
Client Index = 2	Epoch: 1	Loss: 0.699599
Client Index = 2	Epoch: 2	Loss: 0.711282
Client Index = 2	Epoch: 3	Loss: 0.699346
Client Index = 2	Epoch: 4	Loss: 0.663747
test acc on this client after 266 / 502 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 3
local mask changes: 2809924.0 / 11173962
choose client_indexes: [ 3  4  7 15 16], accoring to random
choose mask diff: [2809924.0, 2926728.0, 2932884.0, 2930694.0, 2931678.0]
Doing local aggregation!
test acc on this client before 230 / 504 : 0.46
Client Index = 3	Epoch: 0	Loss: 1.164100
Client Index = 3	Epoch: 1	Loss: 1.075285
Client Index = 3	Epoch: 2	Loss: 1.028037
Client Index = 3	Epoch: 3	Loss: 0.997926
Client Index = 3	Epoch: 4	Loss: 1.001876
test acc on this client after 293 / 504 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 4
local mask changes: 2808482.0 / 11173962
choose client_indexes: [ 2  4  7 10 19], accoring to random
choose mask diff: [2932308.0, 2808482.0, 2930190.0, 2931274.0, 2931700.0]
Doing local aggregation!
test acc on this client before 281 / 503 : 0.56
Client Index = 4	Epoch: 0	Loss: 0.887194
Client Index = 4	Epoch: 1	Loss: 0.732661
Client Index = 4	Epoch: 2	Loss: 0.703144
Client Index = 4	Epoch: 3	Loss: 0.695029
Client Index = 4	Epoch: 4	Loss: 0.758008
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 5
local mask changes: 2811866.0 / 11173962
choose client_indexes: [ 5 10 11 12 16], accoring to random
choose mask diff: [2811866.0, 2927224.0, 2934802.0, 2929800.0, 2926628.0]
Doing local aggregation!
test acc on this client before 315 / 504 : 0.62
Client Index = 5	Epoch: 0	Loss: 0.942523
Client Index = 5	Epoch: 1	Loss: 0.871279
Client Index = 5	Epoch: 2	Loss: 0.827364
Client Index = 5	Epoch: 3	Loss: 0.874212
Client Index = 5	Epoch: 4	Loss: 0.806876
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 6
local mask changes: 2808262.0 / 11173962
choose client_indexes: [ 1  6 10 12 16], accoring to random
choose mask diff: [2933996.0, 2808262.0, 2928596.0, 2931454.0, 2930676.0]
Doing local aggregation!
test acc on this client before 236 / 505 : 0.47
Client Index = 6	Epoch: 0	Loss: 1.264671
Client Index = 6	Epoch: 1	Loss: 1.235648
Client Index = 6	Epoch: 2	Loss: 1.170465
Client Index = 6	Epoch: 3	Loss: 1.140353
Client Index = 6	Epoch: 4	Loss: 1.155542
test acc on this client after 265 / 505 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 7
local mask changes: 2810534.0 / 11173962
choose client_indexes: [ 5  6  7  8 13], accoring to random
choose mask diff: [2923944.0, 2924804.0, 2810534.0, 2930460.0, 2929498.0]
Doing local aggregation!
test acc on this client before 294 / 504 : 0.58
Client Index = 7	Epoch: 0	Loss: 1.036683
Client Index = 7	Epoch: 1	Loss: 1.035389
Client Index = 7	Epoch: 2	Loss: 1.017538
Client Index = 7	Epoch: 3	Loss: 0.919560
Client Index = 7	Epoch: 4	Loss: 0.963093
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 8
local mask changes: 2811186.0 / 11173962
choose client_indexes: [ 2  8 13 15 19], accoring to random
choose mask diff: [2931612.0, 2811186.0, 2932492.0, 2928588.0, 2934838.0]
Doing local aggregation!
test acc on this client before 248 / 504 : 0.49
Client Index = 8	Epoch: 0	Loss: 1.176816
Client Index = 8	Epoch: 1	Loss: 1.180005
Client Index = 8	Epoch: 2	Loss: 1.079207
Client Index = 8	Epoch: 3	Loss: 1.011480
Client Index = 8	Epoch: 4	Loss: 1.112912
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 9
local mask changes: 2809692.0 / 11173962
choose client_indexes: [ 3  8  9 13 17], accoring to random
choose mask diff: [2930874.0, 2932248.0, 2809692.0, 2929214.0, 2932328.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 9	Epoch: 0	Loss: 0.978033
Client Index = 9	Epoch: 1	Loss: 0.951977
Client Index = 9	Epoch: 2	Loss: 0.846955
Client Index = 9	Epoch: 3	Loss: 0.850355
Client Index = 9	Epoch: 4	Loss: 0.795576
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 10
local mask changes: 2810418.0 / 11173962
choose client_indexes: [ 3 10 13 14 19], accoring to random
choose mask diff: [2929842.0, 2810418.0, 2932356.0, 2927434.0, 2932224.0]
Doing local aggregation!
test acc on this client before 217 / 503 : 0.43
Client Index = 10	Epoch: 0	Loss: 1.166657
Client Index = 10	Epoch: 1	Loss: 1.095833
Client Index = 10	Epoch: 2	Loss: 1.095059
Client Index = 10	Epoch: 3	Loss: 1.070929
Client Index = 10	Epoch: 4	Loss: 1.081185
test acc on this client after 278 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 11
local mask changes: 2809514.0 / 11173962
choose client_indexes: [ 6  7 10 11 12], accoring to random
choose mask diff: [2934794.0, 2934320.0, 2935080.0, 2809514.0, 2931148.0]
Doing local aggregation!
test acc on this client before 278 / 504 : 0.55
Client Index = 11	Epoch: 0	Loss: 0.938994
Client Index = 11	Epoch: 1	Loss: 0.696378
Client Index = 11	Epoch: 2	Loss: 0.695037
Client Index = 11	Epoch: 3	Loss: 0.699757
Client Index = 11	Epoch: 4	Loss: 0.721333
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 12
local mask changes: 2811888.0 / 11173962
choose client_indexes: [ 0  2  6 12 13], accoring to random
choose mask diff: [2927260.0, 2926644.0, 2926616.0, 2811888.0, 2924830.0]
Doing local aggregation!
test acc on this client before 130 / 504 : 0.26
Client Index = 12	Epoch: 0	Loss: 1.053214
Client Index = 12	Epoch: 1	Loss: 0.910338
Client Index = 12	Epoch: 2	Loss: 0.886813
Client Index = 12	Epoch: 3	Loss: 0.960940
Client Index = 12	Epoch: 4	Loss: 0.858567
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 13
local mask changes: 2808994.0 / 11173962
choose client_indexes: [ 5  6  9 12 13], accoring to random
choose mask diff: [2931914.0, 2932732.0, 2931382.0, 2925602.0, 2808994.0]
Doing local aggregation!
test acc on this client before 287 / 503 : 0.57
Client Index = 13	Epoch: 0	Loss: 1.120346
Client Index = 13	Epoch: 1	Loss: 1.002891
Client Index = 13	Epoch: 2	Loss: 0.978502
Client Index = 13	Epoch: 3	Loss: 1.046169
Client Index = 13	Epoch: 4	Loss: 0.930515
test acc on this client after 310 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 14
local mask changes: 2808600.0 / 11173962
choose client_indexes: [ 4  5  7 10 14], accoring to random
choose mask diff: [2927512.0, 2925642.0, 2927518.0, 2931860.0, 2808600.0]
Doing local aggregation!
test acc on this client before 271 / 502 : 0.54
Client Index = 14	Epoch: 0	Loss: 1.167714
Client Index = 14	Epoch: 1	Loss: 1.088466
Client Index = 14	Epoch: 2	Loss: 1.091147
Client Index = 14	Epoch: 3	Loss: 1.023154
Client Index = 14	Epoch: 4	Loss: 1.016174
test acc on this client after 285 / 502 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 15
local mask changes: 2808804.0 / 11173962
choose client_indexes: [ 2 10 12 13 15], accoring to random
choose mask diff: [2931432.0, 2926330.0, 2924458.0, 2929134.0, 2808804.0]
Doing local aggregation!
test acc on this client before 301 / 504 : 0.60
Client Index = 15	Epoch: 0	Loss: 0.928045
Client Index = 15	Epoch: 1	Loss: 0.867374
Client Index = 15	Epoch: 2	Loss: 0.913277
Client Index = 15	Epoch: 3	Loss: 0.846235
Client Index = 15	Epoch: 4	Loss: 0.821573
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 16
local mask changes: 2811374.0 / 11173962
choose client_indexes: [ 0  2 10 13 16], accoring to random
choose mask diff: [2926178.0, 2926076.0, 2929140.0, 2933348.0, 2811374.0]
Doing local aggregation!
test acc on this client before 306 / 503 : 0.61
Client Index = 16	Epoch: 0	Loss: 0.951818
Client Index = 16	Epoch: 1	Loss: 0.869450
Client Index = 16	Epoch: 2	Loss: 0.857070
Client Index = 16	Epoch: 3	Loss: 0.818959
Client Index = 16	Epoch: 4	Loss: 0.879474
test acc on this client after 337 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 17
local mask changes: 2809764.0 / 11173962
choose client_indexes: [ 0  5  8 17 18], accoring to random
choose mask diff: [2930990.0, 2924980.0, 2935118.0, 2809764.0, 2931562.0]
Doing local aggregation!
test acc on this client before 274 / 505 : 0.54
Client Index = 17	Epoch: 0	Loss: 0.862116
Client Index = 17	Epoch: 1	Loss: 0.776253
Client Index = 17	Epoch: 2	Loss: 0.706092
Client Index = 17	Epoch: 3	Loss: 0.698611
Client Index = 17	Epoch: 4	Loss: 0.656478
test acc on this client after 379 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 18
local mask changes: 2809908.0 / 11173962
choose client_indexes: [ 5  7 15 17 18], accoring to random
choose mask diff: [2928048.0, 2932220.0, 2926626.0, 2931188.0, 2809908.0]
Doing local aggregation!
test acc on this client before 247 / 504 : 0.49
Client Index = 18	Epoch: 0	Loss: 0.830111
Client Index = 18	Epoch: 1	Loss: 0.606824
Client Index = 18	Epoch: 2	Loss: 0.664406
Client Index = 18	Epoch: 3	Loss: 0.654526
Client Index = 18	Epoch: 4	Loss: 0.581760
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(17) with spasity 0.5: 19
local mask changes: 2810748.0 / 11173962
choose client_indexes: [ 0  4  8 12 19], accoring to random
choose mask diff: [2924960.0, 2927154.0, 2933626.0, 2925012.0, 2810748.0]
Doing local aggregation!
test acc on this client before 308 / 506 : 0.61
Client Index = 19	Epoch: 0	Loss: 0.965513
Client Index = 19	Epoch: 1	Loss: 0.903105
Client Index = 19	Epoch: 2	Loss: 0.896276
Client Index = 19	Epoch: 3	Loss: 0.898474
Client Index = 19	Epoch: 4	Loss: 0.857071
test acc on this client after 296 / 506 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 17
{'test_acc': 0.6453466217764043, 'test_loss': 1.0186547748270807}
################local_test_on_all_clients before local training in communication round: 17
{'test_acc': 0.5226400385283545, 'test_loss': 1.322206237773487}
################Communication round : 18
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 0
local mask changes: 2794342.0 / 11173962
choose client_indexes: [ 0  1  3  6 12], accoring to random
choose mask diff: [2794342.0, 2903320.0, 2900226.0, 2902094.0, 2901154.0]
Doing local aggregation!
test acc on this client before 284 / 504 : 0.56
Client Index = 0	Epoch: 0	Loss: 1.275917
Client Index = 0	Epoch: 1	Loss: 1.229689
Client Index = 0	Epoch: 2	Loss: 1.231015
Client Index = 0	Epoch: 3	Loss: 1.201688
Client Index = 0	Epoch: 4	Loss: 1.173561
test acc on this client after 266 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 1
local mask changes: 2794462.0 / 11173962
choose client_indexes: [ 0  1 10 18 19], accoring to random
choose mask diff: [2904548.0, 2794462.0, 2900134.0, 2901624.0, 2902604.0]
Doing local aggregation!
test acc on this client before 249 / 503 : 0.50
Client Index = 1	Epoch: 0	Loss: 0.824971
Client Index = 1	Epoch: 1	Loss: 0.737718
Client Index = 1	Epoch: 2	Loss: 0.723403
Client Index = 1	Epoch: 3	Loss: 0.691370
Client Index = 1	Epoch: 4	Loss: 0.785565
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 2
local mask changes: 2796742.0 / 11173962
choose client_indexes: [ 2  6 14 15 17], accoring to random
choose mask diff: [2796742.0, 2899476.0, 2901424.0, 2905818.0, 2905628.0]
Doing local aggregation!
test acc on this client before 322 / 502 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.775046
Client Index = 2	Epoch: 1	Loss: 0.759700
Client Index = 2	Epoch: 2	Loss: 0.668310
Client Index = 2	Epoch: 3	Loss: 0.664324
Client Index = 2	Epoch: 4	Loss: 0.658340
test acc on this client after 368 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 3
local mask changes: 2794208.0 / 11173962
choose client_indexes: [ 3  9 10 11 12], accoring to random
choose mask diff: [2794208.0, 2905684.0, 2905698.0, 2903950.0, 2902600.0]
Doing local aggregation!
test acc on this client before 257 / 504 : 0.51
Client Index = 3	Epoch: 0	Loss: 1.119563
Client Index = 3	Epoch: 1	Loss: 1.036809
Client Index = 3	Epoch: 2	Loss: 1.006523
Client Index = 3	Epoch: 3	Loss: 1.005509
Client Index = 3	Epoch: 4	Loss: 0.978336
test acc on this client after 324 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 4
local mask changes: 2794644.0 / 11173962
choose client_indexes: [ 1  4  5 10 13], accoring to random
choose mask diff: [2904818.0, 2794644.0, 2905498.0, 2901550.0, 2902514.0]
Doing local aggregation!
test acc on this client before 253 / 503 : 0.50
Client Index = 4	Epoch: 0	Loss: 0.918818
Client Index = 4	Epoch: 1	Loss: 0.666895
Client Index = 4	Epoch: 2	Loss: 0.748937
Client Index = 4	Epoch: 3	Loss: 0.788219
Client Index = 4	Epoch: 4	Loss: 0.697089
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 5
local mask changes: 2795818.0 / 11173962
choose client_indexes: [ 1  5  7 14 16], accoring to random
choose mask diff: [2903748.0, 2795818.0, 2898486.0, 2900646.0, 2900690.0]
Doing local aggregation!
test acc on this client before 268 / 504 : 0.53
Client Index = 5	Epoch: 0	Loss: 0.933954
Client Index = 5	Epoch: 1	Loss: 0.849422
Client Index = 5	Epoch: 2	Loss: 0.835044
Client Index = 5	Epoch: 3	Loss: 0.851688
Client Index = 5	Epoch: 4	Loss: 0.810483
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 6
local mask changes: 2794180.0 / 11173962
choose client_indexes: [ 1  6  9 12 16], accoring to random
choose mask diff: [2905804.0, 2794180.0, 2907746.0, 2902220.0, 2900296.0]
Doing local aggregation!
test acc on this client before 225 / 505 : 0.45
Client Index = 6	Epoch: 0	Loss: 1.208725
Client Index = 6	Epoch: 1	Loss: 1.182959
Client Index = 6	Epoch: 2	Loss: 1.214652
Client Index = 6	Epoch: 3	Loss: 1.139545
Client Index = 6	Epoch: 4	Loss: 1.131030
test acc on this client after 282 / 505 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 7
local mask changes: 2793388.0 / 11173962
choose client_indexes: [0 1 3 7 9], accoring to random
choose mask diff: [2905770.0, 2904678.0, 2905764.0, 2793388.0, 2904980.0]
Doing local aggregation!
test acc on this client before 291 / 504 : 0.58
Client Index = 7	Epoch: 0	Loss: 1.107793
Client Index = 7	Epoch: 1	Loss: 1.012363
Client Index = 7	Epoch: 2	Loss: 0.987405
Client Index = 7	Epoch: 3	Loss: 0.961130
Client Index = 7	Epoch: 4	Loss: 0.988221
test acc on this client after 312 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 8
local mask changes: 2791954.0 / 11173962
choose client_indexes: [ 8 10 14 17 19], accoring to random
choose mask diff: [2791954.0, 2903938.0, 2904798.0, 2905878.0, 2904692.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 8	Epoch: 0	Loss: 1.135876
Client Index = 8	Epoch: 1	Loss: 1.100170
Client Index = 8	Epoch: 2	Loss: 1.054544
Client Index = 8	Epoch: 3	Loss: 1.025561
Client Index = 8	Epoch: 4	Loss: 1.090453
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 9
local mask changes: 2792986.0 / 11173962
choose client_indexes: [ 1  7  9 11 12], accoring to random
choose mask diff: [2905018.0, 2905018.0, 2792986.0, 2906000.0, 2902640.0]
Doing local aggregation!
test acc on this client before 278 / 504 : 0.55
Client Index = 9	Epoch: 0	Loss: 0.937049
Client Index = 9	Epoch: 1	Loss: 0.869588
Client Index = 9	Epoch: 2	Loss: 0.929820
Client Index = 9	Epoch: 3	Loss: 0.797445
Client Index = 9	Epoch: 4	Loss: 0.751868
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 10
local mask changes: 2795038.0 / 11173962
choose client_indexes: [ 1  2  8 10 18], accoring to random
choose mask diff: [2899926.0, 2903318.0, 2904748.0, 2795038.0, 2905020.0]
Doing local aggregation!
test acc on this client before 276 / 503 : 0.55
Client Index = 10	Epoch: 0	Loss: 1.137156
Client Index = 10	Epoch: 1	Loss: 1.074069
Client Index = 10	Epoch: 2	Loss: 1.078589
Client Index = 10	Epoch: 3	Loss: 1.021032
Client Index = 10	Epoch: 4	Loss: 1.052014
test acc on this client after 294 / 503 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 11
local mask changes: 2793932.0 / 11173962
choose client_indexes: [ 2 11 16 18 19], accoring to random
choose mask diff: [2901290.0, 2793932.0, 2897524.0, 2901032.0, 2908332.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.769915
Client Index = 11	Epoch: 1	Loss: 0.651747
Client Index = 11	Epoch: 2	Loss: 0.764966
Client Index = 11	Epoch: 3	Loss: 0.643244
Client Index = 11	Epoch: 4	Loss: 0.643643
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 12
local mask changes: 2794444.0 / 11173962
choose client_indexes: [ 0  2 11 12 18], accoring to random
choose mask diff: [2896614.0, 2901052.0, 2903992.0, 2794444.0, 2900796.0]
Doing local aggregation!
test acc on this client before 169 / 504 : 0.34
Client Index = 12	Epoch: 0	Loss: 1.014517
Client Index = 12	Epoch: 1	Loss: 0.858224
Client Index = 12	Epoch: 2	Loss: 0.931197
Client Index = 12	Epoch: 3	Loss: 0.848012
Client Index = 12	Epoch: 4	Loss: 0.889218
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 13
local mask changes: 2793200.0 / 11173962
choose client_indexes: [11 13 14 17 19], accoring to random
choose mask diff: [2906652.0, 2793200.0, 2903412.0, 2903372.0, 2902528.0]
Doing local aggregation!
test acc on this client before 280 / 503 : 0.56
Client Index = 13	Epoch: 0	Loss: 1.125165
Client Index = 13	Epoch: 1	Loss: 1.005014
Client Index = 13	Epoch: 2	Loss: 1.023542
Client Index = 13	Epoch: 3	Loss: 0.971793
Client Index = 13	Epoch: 4	Loss: 0.962655
test acc on this client after 329 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 14
local mask changes: 2794302.0 / 11173962
choose client_indexes: [ 0  2  3  4 14], accoring to random
choose mask diff: [2901554.0, 2900016.0, 2900128.0, 2902186.0, 2794302.0]
Doing local aggregation!
test acc on this client before 307 / 502 : 0.61
Client Index = 14	Epoch: 0	Loss: 1.092780
Client Index = 14	Epoch: 1	Loss: 1.060328
Client Index = 14	Epoch: 2	Loss: 1.072301
Client Index = 14	Epoch: 3	Loss: 0.983601
Client Index = 14	Epoch: 4	Loss: 1.085003
test acc on this client after 316 / 502 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 15
local mask changes: 2793798.0 / 11173962
choose client_indexes: [ 8  9 11 15 18], accoring to random
choose mask diff: [2903236.0, 2900598.0, 2903882.0, 2793798.0, 2901616.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 15	Epoch: 0	Loss: 1.010375
Client Index = 15	Epoch: 1	Loss: 0.829736
Client Index = 15	Epoch: 2	Loss: 0.822882
Client Index = 15	Epoch: 3	Loss: 0.853456
Client Index = 15	Epoch: 4	Loss: 0.770410
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 16
local mask changes: 2794608.0 / 11173962
choose client_indexes: [ 3  7  8 16 17], accoring to random
choose mask diff: [2903936.0, 2901484.0, 2905198.0, 2794608.0, 2905626.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 16	Epoch: 0	Loss: 0.927042
Client Index = 16	Epoch: 1	Loss: 0.839513
Client Index = 16	Epoch: 2	Loss: 0.814052
Client Index = 16	Epoch: 3	Loss: 0.835287
Client Index = 16	Epoch: 4	Loss: 0.807568
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 17
local mask changes: 2795262.0 / 11173962
choose client_indexes: [ 0  1 13 17 18], accoring to random
choose mask diff: [2904328.0, 2905048.0, 2903988.0, 2795262.0, 2901548.0]
Doing local aggregation!
test acc on this client before 357 / 505 : 0.71
Client Index = 17	Epoch: 0	Loss: 0.833504
Client Index = 17	Epoch: 1	Loss: 0.723989
Client Index = 17	Epoch: 2	Loss: 0.697161
Client Index = 17	Epoch: 3	Loss: 0.646077
Client Index = 17	Epoch: 4	Loss: 0.636789
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 18
local mask changes: 2793220.0 / 11173962
choose client_indexes: [ 1  4  6 16 18], accoring to random
choose mask diff: [2900820.0, 2902950.0, 2904880.0, 2900924.0, 2793220.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.648008
Client Index = 18	Epoch: 1	Loss: 0.635205
Client Index = 18	Epoch: 2	Loss: 0.682303
Client Index = 18	Epoch: 3	Loss: 0.629267
Client Index = 18	Epoch: 4	Loss: 0.554714
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(18) with spasity 0.5: 19
local mask changes: 2792298.0 / 11173962
choose client_indexes: [ 1  3 14 15 19], accoring to random
choose mask diff: [2905156.0, 2899160.0, 2903994.0, 2899206.0, 2792298.0]
Doing local aggregation!
test acc on this client before 315 / 506 : 0.62
Client Index = 19	Epoch: 0	Loss: 0.993375
Client Index = 19	Epoch: 1	Loss: 0.838379
Client Index = 19	Epoch: 2	Loss: 0.861971
Client Index = 19	Epoch: 3	Loss: 0.863677
Client Index = 19	Epoch: 4	Loss: 0.800264
test acc on this client after 336 / 506 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 18
{'test_acc': 0.662446222473078, 'test_loss': 0.9490987805970932}
################local_test_on_all_clients before local training in communication round: 18
{'test_acc': 0.5723075329973446, 'test_loss': 1.2006882594896904}
################Communication round : 19
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 0
local mask changes: 2775736.0 / 11173962
choose client_indexes: [ 0  9 11 14 16], accoring to random
choose mask diff: [2775736.0, 2878976.0, 2876226.0, 2878222.0, 2875800.0]
Doing local aggregation!
test acc on this client before 204 / 504 : 0.40
Client Index = 0	Epoch: 0	Loss: 1.280056
Client Index = 0	Epoch: 1	Loss: 1.190519
Client Index = 0	Epoch: 2	Loss: 1.183857
Client Index = 0	Epoch: 3	Loss: 1.243136
Client Index = 0	Epoch: 4	Loss: 1.188088
test acc on this client after 286 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 1
local mask changes: 2776288.0 / 11173962
choose client_indexes: [ 1  2  7  9 14], accoring to random
choose mask diff: [2776288.0, 2873008.0, 2878176.0, 2879466.0, 2879732.0]
Doing local aggregation!
test acc on this client before 318 / 503 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.798917
Client Index = 1	Epoch: 1	Loss: 0.765448
Client Index = 1	Epoch: 2	Loss: 0.728298
Client Index = 1	Epoch: 3	Loss: 0.750885
Client Index = 1	Epoch: 4	Loss: 0.624321
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 2
local mask changes: 2774734.0 / 11173962
choose client_indexes: [ 2  5  7 14 15], accoring to random
choose mask diff: [2774734.0, 2875050.0, 2873526.0, 2873948.0, 2875874.0]
Doing local aggregation!
test acc on this client before 334 / 502 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.849423
Client Index = 2	Epoch: 1	Loss: 0.690945
Client Index = 2	Epoch: 2	Loss: 0.664861
Client Index = 2	Epoch: 3	Loss: 0.621865
Client Index = 2	Epoch: 4	Loss: 0.686029
test acc on this client after 389 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 3
local mask changes: 2775410.0 / 11173962
choose client_indexes: [ 3 13 15 17 18], accoring to random
choose mask diff: [2775410.0, 2878294.0, 2876056.0, 2880978.0, 2876698.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 3	Epoch: 0	Loss: 1.106080
Client Index = 3	Epoch: 1	Loss: 1.071061
Client Index = 3	Epoch: 2	Loss: 1.016783
Client Index = 3	Epoch: 3	Loss: 0.956689
Client Index = 3	Epoch: 4	Loss: 1.044931
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 4
local mask changes: 2775348.0 / 11173962
choose client_indexes: [ 4  7  9 12 19], accoring to random
choose mask diff: [2775348.0, 2879626.0, 2880192.0, 2873032.0, 2871546.0]
Doing local aggregation!
test acc on this client before 255 / 503 : 0.51
Client Index = 4	Epoch: 0	Loss: 0.845176
Client Index = 4	Epoch: 1	Loss: 0.739738
Client Index = 4	Epoch: 2	Loss: 0.692522
Client Index = 4	Epoch: 3	Loss: 0.729698
Client Index = 4	Epoch: 4	Loss: 0.636077
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 5
local mask changes: 2775480.0 / 11173962
choose client_indexes: [ 3  5  6  7 12], accoring to random
choose mask diff: [2879584.0, 2775480.0, 2875124.0, 2870220.0, 2874720.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.883888
Client Index = 5	Epoch: 1	Loss: 0.856162
Client Index = 5	Epoch: 2	Loss: 0.782960
Client Index = 5	Epoch: 3	Loss: 0.823738
Client Index = 5	Epoch: 4	Loss: 0.758984
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 6
local mask changes: 2775544.0 / 11173962
choose client_indexes: [ 0  2  6 12 13], accoring to random
choose mask diff: [2875866.0, 2873598.0, 2775544.0, 2873746.0, 2879222.0]
Doing local aggregation!
test acc on this client before 280 / 505 : 0.55
Client Index = 6	Epoch: 0	Loss: 1.193274
Client Index = 6	Epoch: 1	Loss: 1.193175
Client Index = 6	Epoch: 2	Loss: 1.174570
Client Index = 6	Epoch: 3	Loss: 1.137702
Client Index = 6	Epoch: 4	Loss: 1.074908
test acc on this client after 284 / 505 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 7
local mask changes: 2776142.0 / 11173962
choose client_indexes: [ 0  7 10 13 18], accoring to random
choose mask diff: [2877086.0, 2776142.0, 2877666.0, 2875540.0, 2876480.0]
Doing local aggregation!
test acc on this client before 299 / 504 : 0.59
Client Index = 7	Epoch: 0	Loss: 1.104289
Client Index = 7	Epoch: 1	Loss: 1.038954
Client Index = 7	Epoch: 2	Loss: 0.955533
Client Index = 7	Epoch: 3	Loss: 0.925857
Client Index = 7	Epoch: 4	Loss: 0.941228
test acc on this client after 300 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 8
local mask changes: 2778470.0 / 11173962
choose client_indexes: [ 0  1  8 16 18], accoring to random
choose mask diff: [2877294.0, 2881010.0, 2778470.0, 2879766.0, 2878086.0]
Doing local aggregation!
test acc on this client before 226 / 504 : 0.45
Client Index = 8	Epoch: 0	Loss: 1.171110
Client Index = 8	Epoch: 1	Loss: 1.031766
Client Index = 8	Epoch: 2	Loss: 1.047395
Client Index = 8	Epoch: 3	Loss: 1.143461
Client Index = 8	Epoch: 4	Loss: 0.977714
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 9
local mask changes: 2776556.0 / 11173962
choose client_indexes: [ 4  9 12 18 19], accoring to random
choose mask diff: [2881034.0, 2776556.0, 2873068.0, 2877736.0, 2878982.0]
Doing local aggregation!
test acc on this client before 307 / 504 : 0.61
Client Index = 9	Epoch: 0	Loss: 0.966542
Client Index = 9	Epoch: 1	Loss: 0.851988
Client Index = 9	Epoch: 2	Loss: 0.843175
Client Index = 9	Epoch: 3	Loss: 0.853728
Client Index = 9	Epoch: 4	Loss: 0.828860
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 10
local mask changes: 2777518.0 / 11173962
choose client_indexes: [ 1  3  9 10 16], accoring to random
choose mask diff: [2872102.0, 2878454.0, 2876074.0, 2777518.0, 2876632.0]
Doing local aggregation!
test acc on this client before 274 / 503 : 0.54
Client Index = 10	Epoch: 0	Loss: 1.129443
Client Index = 10	Epoch: 1	Loss: 1.032777
Client Index = 10	Epoch: 2	Loss: 1.090470
Client Index = 10	Epoch: 3	Loss: 1.059242
Client Index = 10	Epoch: 4	Loss: 0.966933
test acc on this client after 304 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 11
local mask changes: 2776486.0 / 11173962
choose client_indexes: [ 0  5  9 11 16], accoring to random
choose mask diff: [2873676.0, 2878636.0, 2877756.0, 2776486.0, 2870210.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 11	Epoch: 0	Loss: 0.741168
Client Index = 11	Epoch: 1	Loss: 0.636198
Client Index = 11	Epoch: 2	Loss: 0.681000
Client Index = 11	Epoch: 3	Loss: 0.643537
Client Index = 11	Epoch: 4	Loss: 0.605689
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 12
local mask changes: 2773882.0 / 11173962
choose client_indexes: [ 1  4  5 12 14], accoring to random
choose mask diff: [2875800.0, 2875022.0, 2874734.0, 2773882.0, 2876648.0]
Doing local aggregation!
test acc on this client before 262 / 504 : 0.52
Client Index = 12	Epoch: 0	Loss: 1.076852
Client Index = 12	Epoch: 1	Loss: 0.870599
Client Index = 12	Epoch: 2	Loss: 0.898996
Client Index = 12	Epoch: 3	Loss: 0.878483
Client Index = 12	Epoch: 4	Loss: 0.865864
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 13
local mask changes: 2776696.0 / 11173962
choose client_indexes: [ 5  6 11 13 17], accoring to random
choose mask diff: [2877010.0, 2878034.0, 2877156.0, 2776696.0, 2876280.0]
Doing local aggregation!
test acc on this client before 301 / 503 : 0.60
Client Index = 13	Epoch: 0	Loss: 1.054399
Client Index = 13	Epoch: 1	Loss: 1.019036
Client Index = 13	Epoch: 2	Loss: 1.006392
Client Index = 13	Epoch: 3	Loss: 0.953108
Client Index = 13	Epoch: 4	Loss: 0.937537
test acc on this client after 311 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 14
local mask changes: 2777986.0 / 11173962
choose client_indexes: [ 7 12 14 15 16], accoring to random
choose mask diff: [2874750.0, 2878518.0, 2777986.0, 2874624.0, 2870278.0]
Doing local aggregation!
test acc on this client before 318 / 502 : 0.63
Client Index = 14	Epoch: 0	Loss: 1.087786
Client Index = 14	Epoch: 1	Loss: 1.043894
Client Index = 14	Epoch: 2	Loss: 1.043989
Client Index = 14	Epoch: 3	Loss: 0.971568
Client Index = 14	Epoch: 4	Loss: 1.022655
test acc on this client after 293 / 502 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 15
local mask changes: 2776788.0 / 11173962
choose client_indexes: [ 7 13 14 15 19], accoring to random
choose mask diff: [2879152.0, 2875348.0, 2874846.0, 2776788.0, 2875684.0]
Doing local aggregation!
test acc on this client before 306 / 504 : 0.61
Client Index = 15	Epoch: 0	Loss: 0.874864
Client Index = 15	Epoch: 1	Loss: 0.907386
Client Index = 15	Epoch: 2	Loss: 0.788368
Client Index = 15	Epoch: 3	Loss: 0.857128
Client Index = 15	Epoch: 4	Loss: 0.787181
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 16
local mask changes: 2778164.0 / 11173962
choose client_indexes: [ 2 10 13 15 16], accoring to random
choose mask diff: [2874346.0, 2875038.0, 2877138.0, 2875398.0, 2778164.0]
Doing local aggregation!
test acc on this client before 318 / 503 : 0.63
Client Index = 16	Epoch: 0	Loss: 1.016781
Client Index = 16	Epoch: 1	Loss: 0.872608
Client Index = 16	Epoch: 2	Loss: 0.785619
Client Index = 16	Epoch: 3	Loss: 0.823233
Client Index = 16	Epoch: 4	Loss: 0.796748
test acc on this client after 360 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 17
local mask changes: 2778544.0 / 11173962
choose client_indexes: [ 0  6 10 17 18], accoring to random
choose mask diff: [2875662.0, 2877904.0, 2877220.0, 2778544.0, 2874594.0]
Doing local aggregation!
test acc on this client before 328 / 505 : 0.65
Client Index = 17	Epoch: 0	Loss: 0.883801
Client Index = 17	Epoch: 1	Loss: 0.677868
Client Index = 17	Epoch: 2	Loss: 0.669633
Client Index = 17	Epoch: 3	Loss: 0.685599
Client Index = 17	Epoch: 4	Loss: 0.690934
test acc on this client after 377 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 18
local mask changes: 2775402.0 / 11173962
choose client_indexes: [ 6  9 12 14 18], accoring to random
choose mask diff: [2875286.0, 2878818.0, 2875692.0, 2874092.0, 2775402.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 18	Epoch: 0	Loss: 0.647474
Client Index = 18	Epoch: 1	Loss: 0.563560
Client Index = 18	Epoch: 2	Loss: 0.623269
Client Index = 18	Epoch: 3	Loss: 0.580347
Client Index = 18	Epoch: 4	Loss: 0.591234
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(19) with spasity 0.5: 19
local mask changes: 2777098.0 / 11173962
choose client_indexes: [ 5  6 17 18 19], accoring to random
choose mask diff: [2877772.0, 2878742.0, 2878694.0, 2879124.0, 2777098.0]
Doing local aggregation!
test acc on this client before 327 / 506 : 0.65
Client Index = 19	Epoch: 0	Loss: 0.944667
Client Index = 19	Epoch: 1	Loss: 0.887707
Client Index = 19	Epoch: 2	Loss: 0.805182
Client Index = 19	Epoch: 3	Loss: 0.843881
Client Index = 19	Epoch: 4	Loss: 0.792681
test acc on this client after 344 / 506 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 19
{'test_acc': 0.6727654734301808, 'test_loss': 0.9537993561118349}
################local_test_on_all_clients before local training in communication round: 19
{'test_acc': 0.5932555230128573, 'test_loss': 1.1538084622853897}
################Communication round : 20
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 0
local mask changes: 2758220.0 / 11173962
choose client_indexes: [ 0  4  9 14 18], accoring to random
choose mask diff: [2758220.0, 2850046.0, 2849904.0, 2847826.0, 2849964.0]
Doing local aggregation!
test acc on this client before 218 / 504 : 0.43
Client Index = 0	Epoch: 0	Loss: 1.205342
Client Index = 0	Epoch: 1	Loss: 1.176905
Client Index = 0	Epoch: 2	Loss: 1.185494
Client Index = 0	Epoch: 3	Loss: 1.103434
Client Index = 0	Epoch: 4	Loss: 1.129786
test acc on this client after 277 / 504 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 1
local mask changes: 2757254.0 / 11173962
choose client_indexes: [ 0  1  5 16 18], accoring to random
choose mask diff: [2848434.0, 2757254.0, 2850652.0, 2850420.0, 2847264.0]
Doing local aggregation!
test acc on this client before 259 / 503 : 0.51
Client Index = 1	Epoch: 0	Loss: 0.894502
Client Index = 1	Epoch: 1	Loss: 0.758967
Client Index = 1	Epoch: 2	Loss: 0.671125
Client Index = 1	Epoch: 3	Loss: 0.722030
Client Index = 1	Epoch: 4	Loss: 0.677594
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 2
local mask changes: 2757716.0 / 11173962
choose client_indexes: [0 2 6 7 8], accoring to random
choose mask diff: [2849590.0, 2757716.0, 2847574.0, 2847216.0, 2850004.0]
Doing local aggregation!
test acc on this client before 232 / 502 : 0.46
Client Index = 2	Epoch: 0	Loss: 0.765428
Client Index = 2	Epoch: 1	Loss: 0.676539
Client Index = 2	Epoch: 2	Loss: 0.625922
Client Index = 2	Epoch: 3	Loss: 0.612158
Client Index = 2	Epoch: 4	Loss: 0.647705
test acc on this client after 395 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 3
local mask changes: 2758304.0 / 11173962
choose client_indexes: [ 0  3  4  9 18], accoring to random
choose mask diff: [2846550.0, 2758304.0, 2847166.0, 2850778.0, 2850734.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 3	Epoch: 0	Loss: 1.053000
Client Index = 3	Epoch: 1	Loss: 1.036833
Client Index = 3	Epoch: 2	Loss: 0.995111
Client Index = 3	Epoch: 3	Loss: 1.006032
Client Index = 3	Epoch: 4	Loss: 0.950974
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 4
local mask changes: 2758098.0 / 11173962
choose client_indexes: [ 0  3  4 15 19], accoring to random
choose mask diff: [2848658.0, 2847950.0, 2758098.0, 2848222.0, 2846282.0]
Doing local aggregation!
test acc on this client before 373 / 503 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.836520
Client Index = 4	Epoch: 1	Loss: 0.685196
Client Index = 4	Epoch: 2	Loss: 0.713399
Client Index = 4	Epoch: 3	Loss: 0.671634
Client Index = 4	Epoch: 4	Loss: 0.663036
test acc on this client after 375 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 5
local mask changes: 2758486.0 / 11173962
choose client_indexes: [ 5  7 13 15 17], accoring to random
choose mask diff: [2758486.0, 2845776.0, 2850882.0, 2850046.0, 2846346.0]
Doing local aggregation!
test acc on this client before 222 / 504 : 0.44
Client Index = 5	Epoch: 0	Loss: 0.863580
Client Index = 5	Epoch: 1	Loss: 0.836553
Client Index = 5	Epoch: 2	Loss: 0.774414
Client Index = 5	Epoch: 3	Loss: 0.924210
Client Index = 5	Epoch: 4	Loss: 0.735459
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 6
local mask changes: 2756916.0 / 11173962
choose client_indexes: [ 0  2  6 12 19], accoring to random
choose mask diff: [2848088.0, 2845670.0, 2756916.0, 2847996.0, 2850550.0]
Doing local aggregation!
test acc on this client before 286 / 505 : 0.57
Client Index = 6	Epoch: 0	Loss: 1.218586
Client Index = 6	Epoch: 1	Loss: 1.142181
Client Index = 6	Epoch: 2	Loss: 1.151432
Client Index = 6	Epoch: 3	Loss: 1.097224
Client Index = 6	Epoch: 4	Loss: 1.134861
test acc on this client after 278 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 7
local mask changes: 2759356.0 / 11173962
choose client_indexes: [ 0  7 11 13 19], accoring to random
choose mask diff: [2848850.0, 2759356.0, 2853894.0, 2851690.0, 2851942.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 7	Epoch: 0	Loss: 1.128476
Client Index = 7	Epoch: 1	Loss: 0.962174
Client Index = 7	Epoch: 2	Loss: 0.992392
Client Index = 7	Epoch: 3	Loss: 0.872097
Client Index = 7	Epoch: 4	Loss: 0.909476
test acc on this client after 297 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 8
local mask changes: 2757404.0 / 11173962
choose client_indexes: [ 2  5  8 11 14], accoring to random
choose mask diff: [2850650.0, 2849324.0, 2757404.0, 2853410.0, 2848074.0]
Doing local aggregation!
test acc on this client before 274 / 504 : 0.54
Client Index = 8	Epoch: 0	Loss: 1.162469
Client Index = 8	Epoch: 1	Loss: 0.980690
Client Index = 8	Epoch: 2	Loss: 0.985276
Client Index = 8	Epoch: 3	Loss: 1.034702
Client Index = 8	Epoch: 4	Loss: 0.990363
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 9
local mask changes: 2758296.0 / 11173962
choose client_indexes: [ 4  8  9 15 19], accoring to random
choose mask diff: [2850396.0, 2851248.0, 2758296.0, 2845988.0, 2848064.0]
Doing local aggregation!
test acc on this client before 321 / 504 : 0.64
Client Index = 9	Epoch: 0	Loss: 0.923231
Client Index = 9	Epoch: 1	Loss: 0.861543
Client Index = 9	Epoch: 2	Loss: 0.785902
Client Index = 9	Epoch: 3	Loss: 0.759565
Client Index = 9	Epoch: 4	Loss: 0.819186
test acc on this client after 326 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 10
local mask changes: 2757918.0 / 11173962
choose client_indexes: [ 7  8 10 15 19], accoring to random
choose mask diff: [2848976.0, 2850140.0, 2757918.0, 2848846.0, 2849246.0]
Doing local aggregation!
test acc on this client before 263 / 503 : 0.52
Client Index = 10	Epoch: 0	Loss: 1.060949
Client Index = 10	Epoch: 1	Loss: 1.040851
Client Index = 10	Epoch: 2	Loss: 1.007103
Client Index = 10	Epoch: 3	Loss: 0.987311
Client Index = 10	Epoch: 4	Loss: 1.013165
test acc on this client after 305 / 503 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 11
local mask changes: 2757418.0 / 11173962
choose client_indexes: [ 2  4  8 11 15], accoring to random
choose mask diff: [2849820.0, 2850890.0, 2854824.0, 2757418.0, 2850726.0]
Doing local aggregation!
test acc on this client before 337 / 504 : 0.67
Client Index = 11	Epoch: 0	Loss: 0.779064
Client Index = 11	Epoch: 1	Loss: 0.727344
Client Index = 11	Epoch: 2	Loss: 0.654676
Client Index = 11	Epoch: 3	Loss: 0.613722
Client Index = 11	Epoch: 4	Loss: 0.648591
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 12
local mask changes: 2756684.0 / 11173962
choose client_indexes: [ 3  6  8 11 12], accoring to random
choose mask diff: [2849764.0, 2849982.0, 2853962.0, 2848606.0, 2756684.0]
Doing local aggregation!
test acc on this client before 108 / 504 : 0.21
Client Index = 12	Epoch: 0	Loss: 1.007285
Client Index = 12	Epoch: 1	Loss: 0.914661
Client Index = 12	Epoch: 2	Loss: 0.838500
Client Index = 12	Epoch: 3	Loss: 0.834714
Client Index = 12	Epoch: 4	Loss: 0.795590
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 13
local mask changes: 2760008.0 / 11173962
choose client_indexes: [ 1  4 12 13 16], accoring to random
choose mask diff: [2851874.0, 2849740.0, 2847572.0, 2760008.0, 2851710.0]
Doing local aggregation!
test acc on this client before 329 / 503 : 0.65
Client Index = 13	Epoch: 0	Loss: 1.068025
Client Index = 13	Epoch: 1	Loss: 0.957998
Client Index = 13	Epoch: 2	Loss: 0.975398
Client Index = 13	Epoch: 3	Loss: 0.943277
Client Index = 13	Epoch: 4	Loss: 0.937475
test acc on this client after 279 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 14
local mask changes: 2756784.0 / 11173962
choose client_indexes: [ 4  7 13 14 19], accoring to random
choose mask diff: [2848866.0, 2846676.0, 2850796.0, 2756784.0, 2848196.0]
Doing local aggregation!
test acc on this client before 315 / 502 : 0.63
Client Index = 14	Epoch: 0	Loss: 1.076544
Client Index = 14	Epoch: 1	Loss: 1.019739
Client Index = 14	Epoch: 2	Loss: 0.966887
Client Index = 14	Epoch: 3	Loss: 1.035188
Client Index = 14	Epoch: 4	Loss: 0.980028
test acc on this client after 326 / 502 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 15
local mask changes: 2756724.0 / 11173962
choose client_indexes: [ 1  3 12 15 16], accoring to random
choose mask diff: [2852126.0, 2851476.0, 2846710.0, 2756724.0, 2849324.0]
Doing local aggregation!
test acc on this client before 268 / 504 : 0.53
Client Index = 15	Epoch: 0	Loss: 0.948057
Client Index = 15	Epoch: 1	Loss: 0.815005
Client Index = 15	Epoch: 2	Loss: 0.771525
Client Index = 15	Epoch: 3	Loss: 0.785663
Client Index = 15	Epoch: 4	Loss: 0.806900
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 16
local mask changes: 2760552.0 / 11173962
choose client_indexes: [ 6  7 15 16 18], accoring to random
choose mask diff: [2849778.0, 2848470.0, 2847650.0, 2760552.0, 2847918.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.888406
Client Index = 16	Epoch: 1	Loss: 0.822808
Client Index = 16	Epoch: 2	Loss: 0.808056
Client Index = 16	Epoch: 3	Loss: 0.805173
Client Index = 16	Epoch: 4	Loss: 0.765725
test acc on this client after 323 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 17
local mask changes: 2759892.0 / 11173962
choose client_indexes: [ 1  7  9 17 19], accoring to random
choose mask diff: [2846040.0, 2850010.0, 2848990.0, 2759892.0, 2848332.0]
Doing local aggregation!
test acc on this client before 355 / 505 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.798534
Client Index = 17	Epoch: 1	Loss: 0.706807
Client Index = 17	Epoch: 2	Loss: 0.662849
Client Index = 17	Epoch: 3	Loss: 0.628420
Client Index = 17	Epoch: 4	Loss: 0.633325
test acc on this client after 369 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 18
local mask changes: 2759006.0 / 11173962
choose client_indexes: [ 0  3 14 17 18], accoring to random
choose mask diff: [2848076.0, 2849176.0, 2843048.0, 2848154.0, 2759006.0]
Doing local aggregation!
test acc on this client before 167 / 504 : 0.33
Client Index = 18	Epoch: 0	Loss: 0.708095
Client Index = 18	Epoch: 1	Loss: 0.576345
Client Index = 18	Epoch: 2	Loss: 0.580190
Client Index = 18	Epoch: 3	Loss: 0.542954
Client Index = 18	Epoch: 4	Loss: 0.564196
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(20) with spasity 0.5: 19
local mask changes: 2758618.0 / 11173962
choose client_indexes: [ 3  7 12 16 19], accoring to random
choose mask diff: [2847014.0, 2850556.0, 2845766.0, 2853264.0, 2758618.0]
Doing local aggregation!
test acc on this client before 243 / 506 : 0.48
Client Index = 19	Epoch: 0	Loss: 0.909844
Client Index = 19	Epoch: 1	Loss: 0.847558
Client Index = 19	Epoch: 2	Loss: 0.856626
Client Index = 19	Epoch: 3	Loss: 0.767291
Client Index = 19	Epoch: 4	Loss: 0.831466
test acc on this client after 314 / 506 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 20
{'test_acc': 0.6673248521187076, 'test_loss': 0.9685233401088869}
################local_test_on_all_clients before local training in communication round: 20
{'test_acc': 0.5444532407380429, 'test_loss': 1.2325491040825038}
################Communication round : 21
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 0
local mask changes: 2739036.0 / 11173962
choose client_indexes: [ 0  1  5  6 18], accoring to random
choose mask diff: [2739036.0, 2822270.0, 2822578.0, 2823030.0, 2818358.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 0	Epoch: 0	Loss: 1.211564
Client Index = 0	Epoch: 1	Loss: 1.160259
Client Index = 0	Epoch: 2	Loss: 1.092624
Client Index = 0	Epoch: 3	Loss: 1.170029
Client Index = 0	Epoch: 4	Loss: 1.101215
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 1
local mask changes: 2738122.0 / 11173962
choose client_indexes: [ 1  5 12 13 18], accoring to random
choose mask diff: [2738122.0, 2821474.0, 2818712.0, 2824438.0, 2818808.0]
Doing local aggregation!
test acc on this client before 319 / 503 : 0.63
Client Index = 1	Epoch: 0	Loss: 0.815368
Client Index = 1	Epoch: 1	Loss: 0.740982
Client Index = 1	Epoch: 2	Loss: 0.702464
Client Index = 1	Epoch: 3	Loss: 0.645415
Client Index = 1	Epoch: 4	Loss: 0.659470
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 2
local mask changes: 2738344.0 / 11173962
choose client_indexes: [ 0  1  2  6 15], accoring to random
choose mask diff: [2820156.0, 2817954.0, 2738344.0, 2820360.0, 2822490.0]
Doing local aggregation!
test acc on this client before 331 / 502 : 0.66
Client Index = 2	Epoch: 0	Loss: 0.715578
Client Index = 2	Epoch: 1	Loss: 0.629558
Client Index = 2	Epoch: 2	Loss: 0.658623
Client Index = 2	Epoch: 3	Loss: 0.605850
Client Index = 2	Epoch: 4	Loss: 0.613794
test acc on this client after 327 / 502 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 3
local mask changes: 2736956.0 / 11173962
choose client_indexes: [ 3  5 10 14 17], accoring to random
choose mask diff: [2736956.0, 2822902.0, 2822846.0, 2820620.0, 2823394.0]
Doing local aggregation!
test acc on this client before 236 / 504 : 0.47
Client Index = 3	Epoch: 0	Loss: 1.095516
Client Index = 3	Epoch: 1	Loss: 0.995180
Client Index = 3	Epoch: 2	Loss: 0.989576
Client Index = 3	Epoch: 3	Loss: 0.913755
Client Index = 3	Epoch: 4	Loss: 0.920685
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 4
local mask changes: 2738502.0 / 11173962
choose client_indexes: [ 0  4  6  9 16], accoring to random
choose mask diff: [2818108.0, 2738502.0, 2820348.0, 2822988.0, 2824720.0]
Doing local aggregation!
test acc on this client before 305 / 503 : 0.61
Client Index = 4	Epoch: 0	Loss: 0.824922
Client Index = 4	Epoch: 1	Loss: 0.646743
Client Index = 4	Epoch: 2	Loss: 0.650361
Client Index = 4	Epoch: 3	Loss: 0.689885
Client Index = 4	Epoch: 4	Loss: 0.674582
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 5
local mask changes: 2737200.0 / 11173962
choose client_indexes: [ 5  9 10 11 16], accoring to random
choose mask diff: [2737200.0, 2819968.0, 2822020.0, 2821926.0, 2823460.0]
Doing local aggregation!
test acc on this client before 266 / 504 : 0.53
Client Index = 5	Epoch: 0	Loss: 0.889326
Client Index = 5	Epoch: 1	Loss: 0.812661
Client Index = 5	Epoch: 2	Loss: 0.750195
Client Index = 5	Epoch: 3	Loss: 0.756313
Client Index = 5	Epoch: 4	Loss: 0.851369
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 6
local mask changes: 2737560.0 / 11173962
choose client_indexes: [ 1  4  6  9 17], accoring to random
choose mask diff: [2822660.0, 2822476.0, 2737560.0, 2824254.0, 2823376.0]
Doing local aggregation!
test acc on this client before 210 / 505 : 0.42
Client Index = 6	Epoch: 0	Loss: 1.196665
Client Index = 6	Epoch: 1	Loss: 1.120538
Client Index = 6	Epoch: 2	Loss: 1.079196
Client Index = 6	Epoch: 3	Loss: 1.115195
Client Index = 6	Epoch: 4	Loss: 1.105492
test acc on this client after 266 / 505 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 7
local mask changes: 2739706.0 / 11173962
choose client_indexes: [ 1  4  7 10 19], accoring to random
choose mask diff: [2822632.0, 2824378.0, 2739706.0, 2823546.0, 2822382.0]
Doing local aggregation!
test acc on this client before 310 / 504 : 0.62
Client Index = 7	Epoch: 0	Loss: 1.061954
Client Index = 7	Epoch: 1	Loss: 0.961090
Client Index = 7	Epoch: 2	Loss: 0.934364
Client Index = 7	Epoch: 3	Loss: 0.914870
Client Index = 7	Epoch: 4	Loss: 0.892525
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 8
local mask changes: 2738702.0 / 11173962
choose client_indexes: [ 3  7  8 14 16], accoring to random
choose mask diff: [2824138.0, 2820648.0, 2738702.0, 2818882.0, 2822174.0]
Doing local aggregation!
test acc on this client before 282 / 504 : 0.56
Client Index = 8	Epoch: 0	Loss: 1.132193
Client Index = 8	Epoch: 1	Loss: 1.005313
Client Index = 8	Epoch: 2	Loss: 0.977345
Client Index = 8	Epoch: 3	Loss: 1.096014
Client Index = 8	Epoch: 4	Loss: 0.886768
test acc on this client after 288 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 9
local mask changes: 2739604.0 / 11173962
choose client_indexes: [ 0  3  8  9 19], accoring to random
choose mask diff: [2821134.0, 2824114.0, 2823290.0, 2739604.0, 2820036.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 9	Epoch: 0	Loss: 0.846924
Client Index = 9	Epoch: 1	Loss: 0.805961
Client Index = 9	Epoch: 2	Loss: 0.799556
Client Index = 9	Epoch: 3	Loss: 0.754842
Client Index = 9	Epoch: 4	Loss: 0.744013
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 10
local mask changes: 2738924.0 / 11173962
choose client_indexes: [10 11 14 17 18], accoring to random
choose mask diff: [2738924.0, 2824556.0, 2822858.0, 2822666.0, 2822898.0]
Doing local aggregation!
test acc on this client before 210 / 503 : 0.42
Client Index = 10	Epoch: 0	Loss: 1.108553
Client Index = 10	Epoch: 1	Loss: 1.045318
Client Index = 10	Epoch: 2	Loss: 1.018389
Client Index = 10	Epoch: 3	Loss: 1.029575
Client Index = 10	Epoch: 4	Loss: 0.941989
test acc on this client after 274 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 11
local mask changes: 2738570.0 / 11173962
choose client_indexes: [ 6  7 11 13 18], accoring to random
choose mask diff: [2824112.0, 2823294.0, 2738570.0, 2821080.0, 2821014.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 11	Epoch: 0	Loss: 0.736497
Client Index = 11	Epoch: 1	Loss: 0.584457
Client Index = 11	Epoch: 2	Loss: 0.761913
Client Index = 11	Epoch: 3	Loss: 0.608917
Client Index = 11	Epoch: 4	Loss: 0.567254
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 12
local mask changes: 2740634.0 / 11173962
choose client_indexes: [ 2  3  4 12 18], accoring to random
choose mask diff: [2823086.0, 2821246.0, 2820604.0, 2740634.0, 2819148.0]
Doing local aggregation!
test acc on this client before 206 / 504 : 0.41
Client Index = 12	Epoch: 0	Loss: 0.953378
Client Index = 12	Epoch: 1	Loss: 0.867518
Client Index = 12	Epoch: 2	Loss: 0.853761
Client Index = 12	Epoch: 3	Loss: 0.895634
Client Index = 12	Epoch: 4	Loss: 0.804547
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 13
local mask changes: 2738770.0 / 11173962
choose client_indexes: [ 4 13 14 15 19], accoring to random
choose mask diff: [2818742.0, 2738770.0, 2824124.0, 2821556.0, 2821276.0]
Doing local aggregation!
test acc on this client before 282 / 503 : 0.56
Client Index = 13	Epoch: 0	Loss: 0.996083
Client Index = 13	Epoch: 1	Loss: 0.977080
Client Index = 13	Epoch: 2	Loss: 0.927957
Client Index = 13	Epoch: 3	Loss: 0.971391
Client Index = 13	Epoch: 4	Loss: 0.875804
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 14
local mask changes: 2738392.0 / 11173962
choose client_indexes: [ 3  6  8 13 14], accoring to random
choose mask diff: [2821418.0, 2824162.0, 2820758.0, 2821446.0, 2738392.0]
Doing local aggregation!
test acc on this client before 299 / 502 : 0.60
Client Index = 14	Epoch: 0	Loss: 1.023915
Client Index = 14	Epoch: 1	Loss: 1.027196
Client Index = 14	Epoch: 2	Loss: 0.951264
Client Index = 14	Epoch: 3	Loss: 1.039662
Client Index = 14	Epoch: 4	Loss: 0.935036
test acc on this client after 323 / 502 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 15
local mask changes: 2739076.0 / 11173962
choose client_indexes: [ 8  9 13 15 17], accoring to random
choose mask diff: [2822518.0, 2820152.0, 2820372.0, 2739076.0, 2824072.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 15	Epoch: 0	Loss: 0.913374
Client Index = 15	Epoch: 1	Loss: 0.809576
Client Index = 15	Epoch: 2	Loss: 0.766774
Client Index = 15	Epoch: 3	Loss: 0.838272
Client Index = 15	Epoch: 4	Loss: 0.703040
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 16
local mask changes: 2737842.0 / 11173962
choose client_indexes: [ 2 11 13 15 16], accoring to random
choose mask diff: [2822488.0, 2818704.0, 2821082.0, 2819706.0, 2737842.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.858804
Client Index = 16	Epoch: 1	Loss: 0.881780
Client Index = 16	Epoch: 2	Loss: 0.764204
Client Index = 16	Epoch: 3	Loss: 0.770759
Client Index = 16	Epoch: 4	Loss: 0.743978
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 17
local mask changes: 2737198.0 / 11173962
choose client_indexes: [ 0  5  8 17 19], accoring to random
choose mask diff: [2821422.0, 2820556.0, 2824122.0, 2737198.0, 2821912.0]
Doing local aggregation!
test acc on this client before 294 / 505 : 0.58
Client Index = 17	Epoch: 0	Loss: 0.821739
Client Index = 17	Epoch: 1	Loss: 0.679785
Client Index = 17	Epoch: 2	Loss: 0.695865
Client Index = 17	Epoch: 3	Loss: 0.640554
Client Index = 17	Epoch: 4	Loss: 0.636813
test acc on this client after 383 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 18
local mask changes: 2737376.0 / 11173962
choose client_indexes: [10 12 15 16 18], accoring to random
choose mask diff: [2823392.0, 2819636.0, 2821320.0, 2820054.0, 2737376.0]
Doing local aggregation!
test acc on this client before 365 / 504 : 0.72
Client Index = 18	Epoch: 0	Loss: 0.663138
Client Index = 18	Epoch: 1	Loss: 0.634025
Client Index = 18	Epoch: 2	Loss: 0.547100
Client Index = 18	Epoch: 3	Loss: 0.560782
Client Index = 18	Epoch: 4	Loss: 0.545057
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(21) with spasity 0.5: 19
local mask changes: 2739356.0 / 11173962
choose client_indexes: [11 12 16 18 19], accoring to random
choose mask diff: [2824014.0, 2819380.0, 2822930.0, 2822590.0, 2739356.0]
Doing local aggregation!
test acc on this client before 276 / 506 : 0.55
Client Index = 19	Epoch: 0	Loss: 0.941495
Client Index = 19	Epoch: 1	Loss: 0.843917
Client Index = 19	Epoch: 2	Loss: 0.812428
Client Index = 19	Epoch: 3	Loss: 0.787252
Client Index = 19	Epoch: 4	Loss: 0.857417
test acc on this client after 356 / 506 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 21
{'test_acc': 0.6607413813315223, 'test_loss': 0.9644907676017176}
################local_test_on_all_clients before local training in communication round: 21
{'test_acc': 0.576124163496607, 'test_loss': 1.1920206156837931}
################Communication round : 22
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 0
local mask changes: 2717832.0 / 11173962
choose client_indexes: [ 0  1  7 13 15], accoring to random
choose mask diff: [2717832.0, 2794918.0, 2795738.0, 2796616.0, 2796874.0]
Doing local aggregation!
test acc on this client before 195 / 504 : 0.39
Client Index = 0	Epoch: 0	Loss: 1.218873
Client Index = 0	Epoch: 1	Loss: 1.179478
Client Index = 0	Epoch: 2	Loss: 1.069286
Client Index = 0	Epoch: 3	Loss: 1.124045
Client Index = 0	Epoch: 4	Loss: 1.099084
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 1
local mask changes: 2717780.0 / 11173962
choose client_indexes: [ 1  4  6  7 13], accoring to random
choose mask diff: [2717780.0, 2798054.0, 2795494.0, 2794712.0, 2794792.0]
Doing local aggregation!
test acc on this client before 258 / 503 : 0.51
Client Index = 1	Epoch: 0	Loss: 0.813120
Client Index = 1	Epoch: 1	Loss: 0.758430
Client Index = 1	Epoch: 2	Loss: 0.629244
Client Index = 1	Epoch: 3	Loss: 0.679312
Client Index = 1	Epoch: 4	Loss: 0.674726
test acc on this client after 357 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 2
local mask changes: 2719064.0 / 11173962
choose client_indexes: [ 2  3  7 12 16], accoring to random
choose mask diff: [2719064.0, 2794322.0, 2791680.0, 2795494.0, 2792982.0]
Doing local aggregation!
test acc on this client before 375 / 502 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.721832
Client Index = 2	Epoch: 1	Loss: 0.614504
Client Index = 2	Epoch: 2	Loss: 0.607910
Client Index = 2	Epoch: 3	Loss: 0.636883
Client Index = 2	Epoch: 4	Loss: 0.562662
test acc on this client after 351 / 502 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 3
local mask changes: 2719456.0 / 11173962
choose client_indexes: [ 3  7  8  9 10], accoring to random
choose mask diff: [2719456.0, 2796406.0, 2799804.0, 2793884.0, 2795764.0]
Doing local aggregation!
test acc on this client before 178 / 504 : 0.35
Client Index = 3	Epoch: 0	Loss: 1.099582
Client Index = 3	Epoch: 1	Loss: 0.990272
Client Index = 3	Epoch: 2	Loss: 0.914462
Client Index = 3	Epoch: 3	Loss: 0.956374
Client Index = 3	Epoch: 4	Loss: 0.904458
test acc on this client after 308 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 4
local mask changes: 2718266.0 / 11173962
choose client_indexes: [ 4  7  9 17 18], accoring to random
choose mask diff: [2718266.0, 2794968.0, 2794244.0, 2797196.0, 2795388.0]
Doing local aggregation!
test acc on this client before 187 / 503 : 0.37
Client Index = 4	Epoch: 0	Loss: 0.885817
Client Index = 4	Epoch: 1	Loss: 0.692704
Client Index = 4	Epoch: 2	Loss: 0.707899
Client Index = 4	Epoch: 3	Loss: 0.637716
Client Index = 4	Epoch: 4	Loss: 0.701854
test acc on this client after 384 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 5
local mask changes: 2718690.0 / 11173962
choose client_indexes: [ 0  5 15 17 19], accoring to random
choose mask diff: [2794676.0, 2718690.0, 2794782.0, 2795276.0, 2794086.0]
Doing local aggregation!
test acc on this client before 310 / 504 : 0.62
Client Index = 5	Epoch: 0	Loss: 0.880131
Client Index = 5	Epoch: 1	Loss: 0.774025
Client Index = 5	Epoch: 2	Loss: 0.769981
Client Index = 5	Epoch: 3	Loss: 0.715289
Client Index = 5	Epoch: 4	Loss: 0.760101
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 6
local mask changes: 2715322.0 / 11173962
choose client_indexes: [ 6  9 13 15 19], accoring to random
choose mask diff: [2715322.0, 2795144.0, 2795508.0, 2795862.0, 2795856.0]
Doing local aggregation!
test acc on this client before 209 / 505 : 0.41
Client Index = 6	Epoch: 0	Loss: 1.172869
Client Index = 6	Epoch: 1	Loss: 1.115380
Client Index = 6	Epoch: 2	Loss: 1.113606
Client Index = 6	Epoch: 3	Loss: 1.093292
Client Index = 6	Epoch: 4	Loss: 1.092534
test acc on this client after 277 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 7
local mask changes: 2716410.0 / 11173962
choose client_indexes: [ 6  7  8 12 15], accoring to random
choose mask diff: [2791940.0, 2716410.0, 2796912.0, 2797364.0, 2795992.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.969630
Client Index = 7	Epoch: 1	Loss: 0.970844
Client Index = 7	Epoch: 2	Loss: 0.889054
Client Index = 7	Epoch: 3	Loss: 0.861661
Client Index = 7	Epoch: 4	Loss: 0.957982
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 8
local mask changes: 2719046.0 / 11173962
choose client_indexes: [ 8 10 12 15 18], accoring to random
choose mask diff: [2719046.0, 2795912.0, 2797632.0, 2795304.0, 2795992.0]
Doing local aggregation!
test acc on this client before 302 / 504 : 0.60
Client Index = 8	Epoch: 0	Loss: 1.175587
Client Index = 8	Epoch: 1	Loss: 1.033959
Client Index = 8	Epoch: 2	Loss: 0.988576
Client Index = 8	Epoch: 3	Loss: 1.023785
Client Index = 8	Epoch: 4	Loss: 0.920164
test acc on this client after 286 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 9
local mask changes: 2718070.0 / 11173962
choose client_indexes: [ 0  3  9 11 15], accoring to random
choose mask diff: [2793280.0, 2794810.0, 2718070.0, 2795660.0, 2796608.0]
Doing local aggregation!
test acc on this client before 335 / 504 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.847572
Client Index = 9	Epoch: 1	Loss: 0.807813
Client Index = 9	Epoch: 2	Loss: 0.771585
Client Index = 9	Epoch: 3	Loss: 0.685847
Client Index = 9	Epoch: 4	Loss: 0.794209
test acc on this client after 331 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 10
local mask changes: 2718022.0 / 11173962
choose client_indexes: [ 2  3 10 13 18], accoring to random
choose mask diff: [2794366.0, 2796404.0, 2718022.0, 2798558.0, 2795066.0]
Doing local aggregation!
test acc on this client before 215 / 503 : 0.43
Client Index = 10	Epoch: 0	Loss: 1.133805
Client Index = 10	Epoch: 1	Loss: 1.026490
Client Index = 10	Epoch: 2	Loss: 0.968301
Client Index = 10	Epoch: 3	Loss: 1.023869
Client Index = 10	Epoch: 4	Loss: 0.957815
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 11
local mask changes: 2718090.0 / 11173962
choose client_indexes: [ 3  7  9 11 19], accoring to random
choose mask diff: [2796266.0, 2795358.0, 2794650.0, 2718090.0, 2797024.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 11	Epoch: 0	Loss: 0.756629
Client Index = 11	Epoch: 1	Loss: 0.642493
Client Index = 11	Epoch: 2	Loss: 0.587347
Client Index = 11	Epoch: 3	Loss: 0.582660
Client Index = 11	Epoch: 4	Loss: 0.614426
test acc on this client after 363 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 12
local mask changes: 2717574.0 / 11173962
choose client_indexes: [ 1  9 10 12 16], accoring to random
choose mask diff: [2795118.0, 2794028.0, 2795988.0, 2717574.0, 2797714.0]
Doing local aggregation!
test acc on this client before 311 / 504 : 0.62
Client Index = 12	Epoch: 0	Loss: 0.902859
Client Index = 12	Epoch: 1	Loss: 0.894151
Client Index = 12	Epoch: 2	Loss: 0.797118
Client Index = 12	Epoch: 3	Loss: 0.825599
Client Index = 12	Epoch: 4	Loss: 0.779707
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 13
local mask changes: 2718296.0 / 11173962
choose client_indexes: [ 0  1  7  8 13], accoring to random
choose mask diff: [2797180.0, 2795820.0, 2794410.0, 2797678.0, 2718296.0]
Doing local aggregation!
test acc on this client before 296 / 503 : 0.59
Client Index = 13	Epoch: 0	Loss: 0.994536
Client Index = 13	Epoch: 1	Loss: 0.967058
Client Index = 13	Epoch: 2	Loss: 0.900227
Client Index = 13	Epoch: 3	Loss: 0.919683
Client Index = 13	Epoch: 4	Loss: 0.914314
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 14
local mask changes: 2720160.0 / 11173962
choose client_indexes: [ 2  8  9 14 19], accoring to random
choose mask diff: [2794546.0, 2794368.0, 2796986.0, 2720160.0, 2794004.0]
Doing local aggregation!
test acc on this client before 330 / 502 : 0.66
Client Index = 14	Epoch: 0	Loss: 1.062104
Client Index = 14	Epoch: 1	Loss: 0.995421
Client Index = 14	Epoch: 2	Loss: 0.955753
Client Index = 14	Epoch: 3	Loss: 0.939734
Client Index = 14	Epoch: 4	Loss: 0.914233
test acc on this client after 303 / 502 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 15
local mask changes: 2717582.0 / 11173962
choose client_indexes: [ 6 10 11 15 18], accoring to random
choose mask diff: [2797802.0, 2795436.0, 2795948.0, 2717582.0, 2796860.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 15	Epoch: 0	Loss: 0.816342
Client Index = 15	Epoch: 1	Loss: 0.758879
Client Index = 15	Epoch: 2	Loss: 0.854031
Client Index = 15	Epoch: 3	Loss: 0.776335
Client Index = 15	Epoch: 4	Loss: 0.689785
test acc on this client after 363 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 16
local mask changes: 2716512.0 / 11173962
choose client_indexes: [ 0  3  5 14 16], accoring to random
choose mask diff: [2795680.0, 2795412.0, 2794376.0, 2792466.0, 2716512.0]
Doing local aggregation!
test acc on this client before 314 / 503 : 0.62
Client Index = 16	Epoch: 0	Loss: 0.798228
Client Index = 16	Epoch: 1	Loss: 0.774169
Client Index = 16	Epoch: 2	Loss: 0.769298
Client Index = 16	Epoch: 3	Loss: 0.767872
Client Index = 16	Epoch: 4	Loss: 0.731008
test acc on this client after 345 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 17
local mask changes: 2718502.0 / 11173962
choose client_indexes: [ 5  9 11 17 18], accoring to random
choose mask diff: [2791318.0, 2796562.0, 2797496.0, 2718502.0, 2791436.0]
Doing local aggregation!
test acc on this client before 315 / 505 : 0.62
Client Index = 17	Epoch: 0	Loss: 0.845665
Client Index = 17	Epoch: 1	Loss: 0.684512
Client Index = 17	Epoch: 2	Loss: 0.688424
Client Index = 17	Epoch: 3	Loss: 0.617297
Client Index = 17	Epoch: 4	Loss: 0.627064
test acc on this client after 347 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 18
local mask changes: 2717956.0 / 11173962
choose client_indexes: [ 2  9 12 16 18], accoring to random
choose mask diff: [2795366.0, 2795140.0, 2794332.0, 2792652.0, 2717956.0]
Doing local aggregation!
test acc on this client before 364 / 504 : 0.72
Client Index = 18	Epoch: 0	Loss: 0.654083
Client Index = 18	Epoch: 1	Loss: 0.597520
Client Index = 18	Epoch: 2	Loss: 0.547280
Client Index = 18	Epoch: 3	Loss: 0.547954
Client Index = 18	Epoch: 4	Loss: 0.513265
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(22) with spasity 0.5: 19
local mask changes: 2718202.0 / 11173962
choose client_indexes: [ 4 11 12 14 19], accoring to random
choose mask diff: [2793266.0, 2794366.0, 2792514.0, 2793938.0, 2718202.0]
Doing local aggregation!
test acc on this client before 267 / 506 : 0.53
Client Index = 19	Epoch: 0	Loss: 0.908007
Client Index = 19	Epoch: 1	Loss: 0.820529
Client Index = 19	Epoch: 2	Loss: 0.763869
Client Index = 19	Epoch: 3	Loss: 0.831266
Client Index = 19	Epoch: 4	Loss: 0.775356
test acc on this client after 362 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 22
{'test_acc': 0.6708720631281628, 'test_loss': 0.9519697341364426}
################local_test_on_all_clients before local training in communication round: 22
{'test_acc': 0.5628214936611224, 'test_loss': 1.2094724287187053}
################Communication round : 23
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 0
local mask changes: 2696204.0 / 11173962
choose client_indexes: [ 0  1  2  5 12], accoring to random
choose mask diff: [2696204.0, 2766688.0, 2768186.0, 2770734.0, 2769136.0]
Doing local aggregation!
test acc on this client before 274 / 504 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.159761
Client Index = 0	Epoch: 1	Loss: 1.116645
Client Index = 0	Epoch: 2	Loss: 1.146643
Client Index = 0	Epoch: 3	Loss: 1.131531
Client Index = 0	Epoch: 4	Loss: 1.077481
test acc on this client after 287 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 1
local mask changes: 2697470.0 / 11173962
choose client_indexes: [ 1  3  6 10 19], accoring to random
choose mask diff: [2697470.0, 2771984.0, 2769040.0, 2767308.0, 2769698.0]
Doing local aggregation!
test acc on this client before 278 / 503 : 0.55
Client Index = 1	Epoch: 0	Loss: 0.842285
Client Index = 1	Epoch: 1	Loss: 0.770375
Client Index = 1	Epoch: 2	Loss: 0.659629
Client Index = 1	Epoch: 3	Loss: 0.709602
Client Index = 1	Epoch: 4	Loss: 0.591017
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 2
local mask changes: 2695910.0 / 11173962
choose client_indexes: [ 2  4  5 12 18], accoring to random
choose mask diff: [2695910.0, 2768276.0, 2768760.0, 2768928.0, 2770326.0]
Doing local aggregation!
test acc on this client before 227 / 502 : 0.45
Client Index = 2	Epoch: 0	Loss: 0.778630
Client Index = 2	Epoch: 1	Loss: 0.660401
Client Index = 2	Epoch: 2	Loss: 0.619540
Client Index = 2	Epoch: 3	Loss: 0.577809
Client Index = 2	Epoch: 4	Loss: 0.600046
test acc on this client after 398 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 3
local mask changes: 2697088.0 / 11173962
choose client_indexes: [ 1  2  3 13 19], accoring to random
choose mask diff: [2770922.0, 2769890.0, 2697088.0, 2771518.0, 2770082.0]
Doing local aggregation!
test acc on this client before 283 / 504 : 0.56
Client Index = 3	Epoch: 0	Loss: 1.032989
Client Index = 3	Epoch: 1	Loss: 0.972219
Client Index = 3	Epoch: 2	Loss: 0.917523
Client Index = 3	Epoch: 3	Loss: 0.948831
Client Index = 3	Epoch: 4	Loss: 0.863949
test acc on this client after 298 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 4
local mask changes: 2697214.0 / 11173962
choose client_indexes: [ 4  8  9 11 18], accoring to random
choose mask diff: [2697214.0, 2769334.0, 2767592.0, 2769486.0, 2768312.0]
Doing local aggregation!
test acc on this client before 237 / 503 : 0.47
Client Index = 4	Epoch: 0	Loss: 0.903372
Client Index = 4	Epoch: 1	Loss: 0.669146
Client Index = 4	Epoch: 2	Loss: 0.662781
Client Index = 4	Epoch: 3	Loss: 0.627987
Client Index = 4	Epoch: 4	Loss: 0.720308
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 5
local mask changes: 2696772.0 / 11173962
choose client_indexes: [ 2  5  8 11 15], accoring to random
choose mask diff: [2770052.0, 2696772.0, 2770758.0, 2769138.0, 2769280.0]
Doing local aggregation!
test acc on this client before 270 / 504 : 0.54
Client Index = 5	Epoch: 0	Loss: 0.894577
Client Index = 5	Epoch: 1	Loss: 0.731540
Client Index = 5	Epoch: 2	Loss: 0.728265
Client Index = 5	Epoch: 3	Loss: 0.784227
Client Index = 5	Epoch: 4	Loss: 0.685967
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 6
local mask changes: 2695718.0 / 11173962
choose client_indexes: [ 5  6 11 15 19], accoring to random
choose mask diff: [2769678.0, 2695718.0, 2771910.0, 2768624.0, 2770596.0]
Doing local aggregation!
test acc on this client before 263 / 505 : 0.52
Client Index = 6	Epoch: 0	Loss: 1.130533
Client Index = 6	Epoch: 1	Loss: 1.071568
Client Index = 6	Epoch: 2	Loss: 1.079358
Client Index = 6	Epoch: 3	Loss: 1.091571
Client Index = 6	Epoch: 4	Loss: 1.035433
test acc on this client after 301 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 7
local mask changes: 2696458.0 / 11173962
choose client_indexes: [ 4  6  7  9 19], accoring to random
choose mask diff: [2767456.0, 2767078.0, 2696458.0, 2771100.0, 2771522.0]
Doing local aggregation!
test acc on this client before 296 / 504 : 0.59
Client Index = 7	Epoch: 0	Loss: 0.987253
Client Index = 7	Epoch: 1	Loss: 0.920711
Client Index = 7	Epoch: 2	Loss: 0.858437
Client Index = 7	Epoch: 3	Loss: 0.885656
Client Index = 7	Epoch: 4	Loss: 0.890358
test acc on this client after 298 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 8
local mask changes: 2695828.0 / 11173962
choose client_indexes: [ 1  5  8 12 13], accoring to random
choose mask diff: [2770220.0, 2768574.0, 2695828.0, 2770226.0, 2771434.0]
Doing local aggregation!
test acc on this client before 292 / 504 : 0.58
Client Index = 8	Epoch: 0	Loss: 1.104219
Client Index = 8	Epoch: 1	Loss: 0.961281
Client Index = 8	Epoch: 2	Loss: 1.026139
Client Index = 8	Epoch: 3	Loss: 0.947098
Client Index = 8	Epoch: 4	Loss: 0.926168
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 9
local mask changes: 2696788.0 / 11173962
choose client_indexes: [ 6  7  9 12 16], accoring to random
choose mask diff: [2770750.0, 2772174.0, 2696788.0, 2767918.0, 2770120.0]
Doing local aggregation!
test acc on this client before 281 / 504 : 0.56
Client Index = 9	Epoch: 0	Loss: 0.831538
Client Index = 9	Epoch: 1	Loss: 0.836950
Client Index = 9	Epoch: 2	Loss: 0.723206
Client Index = 9	Epoch: 3	Loss: 0.752345
Client Index = 9	Epoch: 4	Loss: 0.708285
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 10
local mask changes: 2696478.0 / 11173962
choose client_indexes: [ 5  7  9 10 15], accoring to random
choose mask diff: [2768048.0, 2769200.0, 2768468.0, 2696478.0, 2768184.0]
Doing local aggregation!
test acc on this client before 241 / 503 : 0.48
Client Index = 10	Epoch: 0	Loss: 1.029540
Client Index = 10	Epoch: 1	Loss: 0.983210
Client Index = 10	Epoch: 2	Loss: 0.977494
Client Index = 10	Epoch: 3	Loss: 0.919782
Client Index = 10	Epoch: 4	Loss: 0.861331
test acc on this client after 276 / 503 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 11
local mask changes: 2698102.0 / 11173962
choose client_indexes: [ 0  7  8 11 19], accoring to random
choose mask diff: [2770280.0, 2768710.0, 2770756.0, 2698102.0, 2768150.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 11	Epoch: 0	Loss: 0.721422
Client Index = 11	Epoch: 1	Loss: 0.626573
Client Index = 11	Epoch: 2	Loss: 0.587516
Client Index = 11	Epoch: 3	Loss: 0.555989
Client Index = 11	Epoch: 4	Loss: 0.570903
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 12
local mask changes: 2696760.0 / 11173962
choose client_indexes: [ 0  2  3 12 18], accoring to random
choose mask diff: [2767978.0, 2770874.0, 2767808.0, 2696760.0, 2767030.0]
Doing local aggregation!
test acc on this client before 227 / 504 : 0.45
Client Index = 12	Epoch: 0	Loss: 1.005194
Client Index = 12	Epoch: 1	Loss: 0.830632
Client Index = 12	Epoch: 2	Loss: 0.924452
Client Index = 12	Epoch: 3	Loss: 0.751406
Client Index = 12	Epoch: 4	Loss: 0.783932
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 13
local mask changes: 2696000.0 / 11173962
choose client_indexes: [ 1  7 11 12 13], accoring to random
choose mask diff: [2769670.0, 2768060.0, 2769956.0, 2769210.0, 2696000.0]
Doing local aggregation!
test acc on this client before 314 / 503 : 0.62
Client Index = 13	Epoch: 0	Loss: 0.994397
Client Index = 13	Epoch: 1	Loss: 0.921750
Client Index = 13	Epoch: 2	Loss: 0.867154
Client Index = 13	Epoch: 3	Loss: 0.893479
Client Index = 13	Epoch: 4	Loss: 0.874031
test acc on this client after 312 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 14
local mask changes: 2697550.0 / 11173962
choose client_indexes: [ 2  7 14 15 18], accoring to random
choose mask diff: [2767640.0, 2771214.0, 2697550.0, 2768914.0, 2768014.0]
Doing local aggregation!
test acc on this client before 341 / 502 : 0.68
Client Index = 14	Epoch: 0	Loss: 0.999205
Client Index = 14	Epoch: 1	Loss: 0.953589
Client Index = 14	Epoch: 2	Loss: 1.009095
Client Index = 14	Epoch: 3	Loss: 0.904940
Client Index = 14	Epoch: 4	Loss: 0.907126
test acc on this client after 300 / 502 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 15
local mask changes: 2696380.0 / 11173962
choose client_indexes: [ 5  9 11 15 17], accoring to random
choose mask diff: [2769666.0, 2768364.0, 2768048.0, 2696380.0, 2770756.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 15	Epoch: 0	Loss: 0.963481
Client Index = 15	Epoch: 1	Loss: 0.764299
Client Index = 15	Epoch: 2	Loss: 0.712438
Client Index = 15	Epoch: 3	Loss: 0.742953
Client Index = 15	Epoch: 4	Loss: 0.672051
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 16
local mask changes: 2695762.0 / 11173962
choose client_indexes: [ 9 11 16 17 19], accoring to random
choose mask diff: [2770690.0, 2767182.0, 2695762.0, 2769614.0, 2770266.0]
Doing local aggregation!
test acc on this client before 297 / 503 : 0.59
Client Index = 16	Epoch: 0	Loss: 0.782806
Client Index = 16	Epoch: 1	Loss: 0.792223
Client Index = 16	Epoch: 2	Loss: 0.752384
Client Index = 16	Epoch: 3	Loss: 0.728098
Client Index = 16	Epoch: 4	Loss: 0.770373
test acc on this client after 364 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 17
local mask changes: 2698286.0 / 11173962
choose client_indexes: [ 7 10 13 17 19], accoring to random
choose mask diff: [2769124.0, 2768436.0, 2770310.0, 2698286.0, 2766820.0]
Doing local aggregation!
test acc on this client before 327 / 505 : 0.65
Client Index = 17	Epoch: 0	Loss: 0.798614
Client Index = 17	Epoch: 1	Loss: 0.713318
Client Index = 17	Epoch: 2	Loss: 0.623647
Client Index = 17	Epoch: 3	Loss: 0.590159
Client Index = 17	Epoch: 4	Loss: 0.575739
test acc on this client after 388 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 18
local mask changes: 2696388.0 / 11173962
choose client_indexes: [ 0  1  8 11 18], accoring to random
choose mask diff: [2768096.0, 2767306.0, 2770748.0, 2767430.0, 2696388.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.631568
Client Index = 18	Epoch: 1	Loss: 0.555112
Client Index = 18	Epoch: 2	Loss: 0.548160
Client Index = 18	Epoch: 3	Loss: 0.537507
Client Index = 18	Epoch: 4	Loss: 0.521525
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(23) with spasity 0.5: 19
local mask changes: 2697292.0 / 11173962
choose client_indexes: [ 2  3  4 11 19], accoring to random
choose mask diff: [2771522.0, 2769384.0, 2766988.0, 2767486.0, 2697292.0]
Doing local aggregation!
test acc on this client before 173 / 506 : 0.34
Client Index = 19	Epoch: 0	Loss: 0.897439
Client Index = 19	Epoch: 1	Loss: 0.790533
Client Index = 19	Epoch: 2	Loss: 0.803669
Client Index = 19	Epoch: 3	Loss: 0.804800
Client Index = 19	Epoch: 4	Loss: 0.758929
test acc on this client after 338 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 23
{'test_acc': 0.6664123429057607, 'test_loss': 0.9590904553512246}
################local_test_on_all_clients before local training in communication round: 23
{'test_acc': 0.557453227256554, 'test_loss': 1.2230195895131886}
################Communication round : 24
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 0
local mask changes: 2673220.0 / 11173962
choose client_indexes: [ 0  6 15 16 19], accoring to random
choose mask diff: [2673220.0, 2744562.0, 2746046.0, 2743812.0, 2745320.0]
Doing local aggregation!
test acc on this client before 285 / 504 : 0.57
Client Index = 0	Epoch: 0	Loss: 1.118566
Client Index = 0	Epoch: 1	Loss: 1.204066
Client Index = 0	Epoch: 2	Loss: 1.034271
Client Index = 0	Epoch: 3	Loss: 1.129371
Client Index = 0	Epoch: 4	Loss: 1.027683
test acc on this client after 285 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 1
local mask changes: 2674704.0 / 11173962
choose client_indexes: [ 1  3 10 12 13], accoring to random
choose mask diff: [2674704.0, 2744756.0, 2743586.0, 2745092.0, 2744144.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 1	Epoch: 0	Loss: 0.744403
Client Index = 1	Epoch: 1	Loss: 0.645498
Client Index = 1	Epoch: 2	Loss: 0.662757
Client Index = 1	Epoch: 3	Loss: 0.680328
Client Index = 1	Epoch: 4	Loss: 0.631772
test acc on this client after 363 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 2
local mask changes: 2673738.0 / 11173962
choose client_indexes: [ 2  6  7 12 15], accoring to random
choose mask diff: [2673738.0, 2743316.0, 2744146.0, 2741410.0, 2743112.0]
Doing local aggregation!
test acc on this client before 296 / 502 : 0.59
Client Index = 2	Epoch: 0	Loss: 0.765493
Client Index = 2	Epoch: 1	Loss: 0.691816
Client Index = 2	Epoch: 2	Loss: 0.554003
Client Index = 2	Epoch: 3	Loss: 0.605949
Client Index = 2	Epoch: 4	Loss: 0.593994
test acc on this client after 406 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 3
local mask changes: 2674066.0 / 11173962
choose client_indexes: [ 3  4  6  7 14], accoring to random
choose mask diff: [2674066.0, 2745102.0, 2745852.0, 2745688.0, 2742648.0]
Doing local aggregation!
test acc on this client before 228 / 504 : 0.45
Client Index = 3	Epoch: 0	Loss: 1.038414
Client Index = 3	Epoch: 1	Loss: 0.923839
Client Index = 3	Epoch: 2	Loss: 0.943516
Client Index = 3	Epoch: 3	Loss: 0.872010
Client Index = 3	Epoch: 4	Loss: 0.884939
test acc on this client after 307 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 4
local mask changes: 2673362.0 / 11173962
choose client_indexes: [ 4  5  9 10 15], accoring to random
choose mask diff: [2673362.0, 2745882.0, 2741250.0, 2745700.0, 2743208.0]
Doing local aggregation!
test acc on this client before 206 / 503 : 0.41
Client Index = 4	Epoch: 0	Loss: 0.869306
Client Index = 4	Epoch: 1	Loss: 0.692316
Client Index = 4	Epoch: 2	Loss: 0.637811
Client Index = 4	Epoch: 3	Loss: 0.601495
Client Index = 4	Epoch: 4	Loss: 0.625584
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 5
local mask changes: 2674262.0 / 11173962
choose client_indexes: [ 2  3  4  5 17], accoring to random
choose mask diff: [2743486.0, 2745434.0, 2743982.0, 2674262.0, 2742232.0]
Doing local aggregation!
test acc on this client before 265 / 504 : 0.53
Client Index = 5	Epoch: 0	Loss: 0.929399
Client Index = 5	Epoch: 1	Loss: 0.734914
Client Index = 5	Epoch: 2	Loss: 0.729343
Client Index = 5	Epoch: 3	Loss: 0.728215
Client Index = 5	Epoch: 4	Loss: 0.725311
test acc on this client after 323 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 6
local mask changes: 2673560.0 / 11173962
choose client_indexes: [ 3  5  6 10 19], accoring to random
choose mask diff: [2744116.0, 2744264.0, 2673560.0, 2743466.0, 2742314.0]
Doing local aggregation!
test acc on this client before 265 / 505 : 0.52
Client Index = 6	Epoch: 0	Loss: 1.129436
Client Index = 6	Epoch: 1	Loss: 1.106624
Client Index = 6	Epoch: 2	Loss: 1.060136
Client Index = 6	Epoch: 3	Loss: 1.054431
Client Index = 6	Epoch: 4	Loss: 1.018214
test acc on this client after 275 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 7
local mask changes: 2673360.0 / 11173962
choose client_indexes: [ 3  4  5  7 16], accoring to random
choose mask diff: [2743812.0, 2743030.0, 2743048.0, 2673360.0, 2745828.0]
Doing local aggregation!
test acc on this client before 313 / 504 : 0.62
Client Index = 7	Epoch: 0	Loss: 0.971466
Client Index = 7	Epoch: 1	Loss: 0.896649
Client Index = 7	Epoch: 2	Loss: 0.858167
Client Index = 7	Epoch: 3	Loss: 0.884732
Client Index = 7	Epoch: 4	Loss: 0.831879
test acc on this client after 304 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 8
local mask changes: 2673624.0 / 11173962
choose client_indexes: [0 2 4 7 8], accoring to random
choose mask diff: [2746290.0, 2744600.0, 2744430.0, 2743198.0, 2673624.0]
Doing local aggregation!
test acc on this client before 295 / 504 : 0.59
Client Index = 8	Epoch: 0	Loss: 1.043900
Client Index = 8	Epoch: 1	Loss: 0.976758
Client Index = 8	Epoch: 2	Loss: 1.041601
Client Index = 8	Epoch: 3	Loss: 0.883694
Client Index = 8	Epoch: 4	Loss: 0.904348
test acc on this client after 181 / 504 : 0.36
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 9
local mask changes: 2673386.0 / 11173962
choose client_indexes: [ 3  4  9 12 15], accoring to random
choose mask diff: [2744520.0, 2743778.0, 2673386.0, 2742446.0, 2744634.0]
Doing local aggregation!
test acc on this client before 336 / 504 : 0.67
Client Index = 9	Epoch: 0	Loss: 0.776683
Client Index = 9	Epoch: 1	Loss: 0.785456
Client Index = 9	Epoch: 2	Loss: 0.743202
Client Index = 9	Epoch: 3	Loss: 0.727826
Client Index = 9	Epoch: 4	Loss: 0.678194
test acc on this client after 343 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 10
local mask changes: 2675452.0 / 11173962
choose client_indexes: [ 4  7  9 10 18], accoring to random
choose mask diff: [2745360.0, 2742506.0, 2742782.0, 2675452.0, 2744312.0]
Doing local aggregation!
test acc on this client before 261 / 503 : 0.52
Client Index = 10	Epoch: 0	Loss: 1.012350
Client Index = 10	Epoch: 1	Loss: 1.031236
Client Index = 10	Epoch: 2	Loss: 0.918080
Client Index = 10	Epoch: 3	Loss: 0.985359
Client Index = 10	Epoch: 4	Loss: 0.923841
test acc on this client after 302 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 11
local mask changes: 2673562.0 / 11173962
choose client_indexes: [ 0  1  6 11 16], accoring to random
choose mask diff: [2742410.0, 2745710.0, 2744140.0, 2673562.0, 2742970.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 11	Epoch: 0	Loss: 0.650325
Client Index = 11	Epoch: 1	Loss: 0.568792
Client Index = 11	Epoch: 2	Loss: 0.630258
Client Index = 11	Epoch: 3	Loss: 0.598229
Client Index = 11	Epoch: 4	Loss: 0.539379
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 12
local mask changes: 2673926.0 / 11173962
choose client_indexes: [ 9 12 14 15 17], accoring to random
choose mask diff: [2743838.0, 2673926.0, 2746242.0, 2743634.0, 2743266.0]
Doing local aggregation!
test acc on this client before 310 / 504 : 0.62
Client Index = 12	Epoch: 0	Loss: 0.922836
Client Index = 12	Epoch: 1	Loss: 0.839199
Client Index = 12	Epoch: 2	Loss: 0.843778
Client Index = 12	Epoch: 3	Loss: 0.777454
Client Index = 12	Epoch: 4	Loss: 0.757658
test acc on this client after 337 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 13
local mask changes: 2672524.0 / 11173962
choose client_indexes: [ 5  7  9 10 13], accoring to random
choose mask diff: [2745054.0, 2744792.0, 2746976.0, 2745418.0, 2672524.0]
Doing local aggregation!
test acc on this client before 308 / 503 : 0.61
Client Index = 13	Epoch: 0	Loss: 0.988492
Client Index = 13	Epoch: 1	Loss: 0.902109
Client Index = 13	Epoch: 2	Loss: 0.876601
Client Index = 13	Epoch: 3	Loss: 0.870272
Client Index = 13	Epoch: 4	Loss: 0.855843
test acc on this client after 334 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 14
local mask changes: 2676616.0 / 11173962
choose client_indexes: [ 1  5  7 11 14], accoring to random
choose mask diff: [2744562.0, 2744690.0, 2743222.0, 2745082.0, 2676616.0]
Doing local aggregation!
test acc on this client before 328 / 502 : 0.65
Client Index = 14	Epoch: 0	Loss: 1.026391
Client Index = 14	Epoch: 1	Loss: 0.952110
Client Index = 14	Epoch: 2	Loss: 0.885025
Client Index = 14	Epoch: 3	Loss: 0.969909
Client Index = 14	Epoch: 4	Loss: 0.938126
test acc on this client after 334 / 502 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 15
local mask changes: 2673904.0 / 11173962
choose client_indexes: [ 2  6  7 11 15], accoring to random
choose mask diff: [2746902.0, 2743818.0, 2743898.0, 2743852.0, 2673904.0]
Doing local aggregation!
test acc on this client before 187 / 504 : 0.37
Client Index = 15	Epoch: 0	Loss: 0.930159
Client Index = 15	Epoch: 1	Loss: 0.741130
Client Index = 15	Epoch: 2	Loss: 0.697144
Client Index = 15	Epoch: 3	Loss: 0.826094
Client Index = 15	Epoch: 4	Loss: 0.696027
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 16
local mask changes: 2675520.0 / 11173962
choose client_indexes: [ 0  5 11 16 19], accoring to random
choose mask diff: [2745664.0, 2743712.0, 2741064.0, 2675520.0, 2745300.0]
Doing local aggregation!
test acc on this client before 347 / 503 : 0.69
Client Index = 16	Epoch: 0	Loss: 0.806611
Client Index = 16	Epoch: 1	Loss: 0.769884
Client Index = 16	Epoch: 2	Loss: 0.720635
Client Index = 16	Epoch: 3	Loss: 0.720141
Client Index = 16	Epoch: 4	Loss: 0.686527
test acc on this client after 328 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 17
local mask changes: 2675302.0 / 11173962
choose client_indexes: [ 3 11 13 14 17], accoring to random
choose mask diff: [2745102.0, 2744766.0, 2742804.0, 2746154.0, 2675302.0]
Doing local aggregation!
test acc on this client before 324 / 505 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.827371
Client Index = 17	Epoch: 1	Loss: 0.706023
Client Index = 17	Epoch: 2	Loss: 0.633577
Client Index = 17	Epoch: 3	Loss: 0.603601
Client Index = 17	Epoch: 4	Loss: 0.565834
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 18
local mask changes: 2673488.0 / 11173962
choose client_indexes: [ 0  1  9 12 18], accoring to random
choose mask diff: [2742934.0, 2742464.0, 2743560.0, 2742556.0, 2673488.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 18	Epoch: 0	Loss: 0.631479
Client Index = 18	Epoch: 1	Loss: 0.562789
Client Index = 18	Epoch: 2	Loss: 0.534566
Client Index = 18	Epoch: 3	Loss: 0.517040
Client Index = 18	Epoch: 4	Loss: 0.530663
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(24) with spasity 0.5: 19
local mask changes: 2674658.0 / 11173962
choose client_indexes: [12 13 14 17 19], accoring to random
choose mask diff: [2744270.0, 2746362.0, 2744810.0, 2744522.0, 2674658.0]
Doing local aggregation!
test acc on this client before 338 / 506 : 0.67
Client Index = 19	Epoch: 0	Loss: 0.823103
Client Index = 19	Epoch: 1	Loss: 0.767689
Client Index = 19	Epoch: 2	Loss: 0.771428
Client Index = 19	Epoch: 3	Loss: 0.722483
Client Index = 19	Epoch: 4	Loss: 0.776378
test acc on this client after 362 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 24
{'test_acc': 0.666231759823009, 'test_loss': 0.9626685371449696}
################local_test_on_all_clients before local training in communication round: 24
{'test_acc': 0.5878873241965239, 'test_loss': 1.177346305489253}
################Communication round : 25
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 0
local mask changes: 2650824.0 / 11173962
choose client_indexes: [ 0  3 11 12 14], accoring to random
choose mask diff: [2650824.0, 2719572.0, 2720676.0, 2719706.0, 2721784.0]
Doing local aggregation!
test acc on this client before 265 / 504 : 0.53
Client Index = 0	Epoch: 0	Loss: 1.138679
Client Index = 0	Epoch: 1	Loss: 1.134367
Client Index = 0	Epoch: 2	Loss: 1.044556
Client Index = 0	Epoch: 3	Loss: 1.007652
Client Index = 0	Epoch: 4	Loss: 0.974499
test acc on this client after 274 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 1
local mask changes: 2650126.0 / 11173962
choose client_indexes: [ 1  2 11 13 16], accoring to random
choose mask diff: [2650126.0, 2720044.0, 2721774.0, 2719582.0, 2721750.0]
Doing local aggregation!
test acc on this client before 277 / 503 : 0.55
Client Index = 1	Epoch: 0	Loss: 0.707622
Client Index = 1	Epoch: 1	Loss: 0.720405
Client Index = 1	Epoch: 2	Loss: 0.662250
Client Index = 1	Epoch: 3	Loss: 0.622559
Client Index = 1	Epoch: 4	Loss: 0.597148
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 2
local mask changes: 2651786.0 / 11173962
choose client_indexes: [ 0  1  2  8 18], accoring to random
choose mask diff: [2718298.0, 2722146.0, 2651786.0, 2719112.0, 2719552.0]
Doing local aggregation!
test acc on this client before 222 / 502 : 0.44
Client Index = 2	Epoch: 0	Loss: 0.728881
Client Index = 2	Epoch: 1	Loss: 0.645070
Client Index = 2	Epoch: 2	Loss: 0.608892
Client Index = 2	Epoch: 3	Loss: 0.584961
Client Index = 2	Epoch: 4	Loss: 0.578397
test acc on this client after 412 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 3
local mask changes: 2651992.0 / 11173962
choose client_indexes: [ 3 11 12 16 19], accoring to random
choose mask diff: [2651992.0, 2719024.0, 2719954.0, 2721426.0, 2720502.0]
Doing local aggregation!
test acc on this client before 290 / 504 : 0.58
Client Index = 3	Epoch: 0	Loss: 1.044032
Client Index = 3	Epoch: 1	Loss: 0.911940
Client Index = 3	Epoch: 2	Loss: 0.914935
Client Index = 3	Epoch: 3	Loss: 0.873513
Client Index = 3	Epoch: 4	Loss: 0.917410
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 4
local mask changes: 2650402.0 / 11173962
choose client_indexes: [ 3  4 11 12 19], accoring to random
choose mask diff: [2719846.0, 2650402.0, 2721026.0, 2719092.0, 2716516.0]
Doing local aggregation!
test acc on this client before 339 / 503 : 0.67
Client Index = 4	Epoch: 0	Loss: 0.736936
Client Index = 4	Epoch: 1	Loss: 0.720051
Client Index = 4	Epoch: 2	Loss: 0.613606
Client Index = 4	Epoch: 3	Loss: 0.667496
Client Index = 4	Epoch: 4	Loss: 0.605441
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 5
local mask changes: 2651288.0 / 11173962
choose client_indexes: [ 5  7 10 15 18], accoring to random
choose mask diff: [2651288.0, 2720816.0, 2720410.0, 2718396.0, 2721080.0]
Doing local aggregation!
test acc on this client before 262 / 504 : 0.52
Client Index = 5	Epoch: 0	Loss: 0.794925
Client Index = 5	Epoch: 1	Loss: 0.753917
Client Index = 5	Epoch: 2	Loss: 0.778659
Client Index = 5	Epoch: 3	Loss: 0.688752
Client Index = 5	Epoch: 4	Loss: 0.689161
test acc on this client after 343 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 6
local mask changes: 2651700.0 / 11173962
choose client_indexes: [ 5  6  8  9 18], accoring to random
choose mask diff: [2718182.0, 2651700.0, 2720518.0, 2721524.0, 2721168.0]
Doing local aggregation!
test acc on this client before 261 / 505 : 0.52
Client Index = 6	Epoch: 0	Loss: 1.088016
Client Index = 6	Epoch: 1	Loss: 1.097896
Client Index = 6	Epoch: 2	Loss: 1.072460
Client Index = 6	Epoch: 3	Loss: 1.004716
Client Index = 6	Epoch: 4	Loss: 1.035121
test acc on this client after 291 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 7
local mask changes: 2651694.0 / 11173962
choose client_indexes: [ 1  2  7 17 19], accoring to random
choose mask diff: [2721790.0, 2720198.0, 2651694.0, 2719166.0, 2720658.0]
Doing local aggregation!
test acc on this client before 293 / 504 : 0.58
Client Index = 7	Epoch: 0	Loss: 0.978803
Client Index = 7	Epoch: 1	Loss: 0.943264
Client Index = 7	Epoch: 2	Loss: 0.871040
Client Index = 7	Epoch: 3	Loss: 0.870272
Client Index = 7	Epoch: 4	Loss: 0.782778
test acc on this client after 281 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 8
local mask changes: 2652580.0 / 11173962
choose client_indexes: [ 2  3  8 16 17], accoring to random
choose mask diff: [2718628.0, 2721380.0, 2652580.0, 2720672.0, 2722166.0]
Doing local aggregation!
test acc on this client before 239 / 504 : 0.47
Client Index = 8	Epoch: 0	Loss: 1.138492
Client Index = 8	Epoch: 1	Loss: 1.013678
Client Index = 8	Epoch: 2	Loss: 0.922676
Client Index = 8	Epoch: 3	Loss: 0.928008
Client Index = 8	Epoch: 4	Loss: 0.931949
test acc on this client after 267 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 9
local mask changes: 2649822.0 / 11173962
choose client_indexes: [ 3  9 14 18 19], accoring to random
choose mask diff: [2721266.0, 2649822.0, 2720798.0, 2721330.0, 2722024.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.829353
Client Index = 9	Epoch: 1	Loss: 0.731789
Client Index = 9	Epoch: 2	Loss: 0.686394
Client Index = 9	Epoch: 3	Loss: 0.726304
Client Index = 9	Epoch: 4	Loss: 0.664947
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 10
local mask changes: 2651728.0 / 11173962
choose client_indexes: [ 2 10 15 18 19], accoring to random
choose mask diff: [2721444.0, 2651728.0, 2718828.0, 2719000.0, 2723716.0]
Doing local aggregation!
test acc on this client before 286 / 503 : 0.57
Client Index = 10	Epoch: 0	Loss: 1.020047
Client Index = 10	Epoch: 1	Loss: 0.917023
Client Index = 10	Epoch: 2	Loss: 0.973361
Client Index = 10	Epoch: 3	Loss: 0.942109
Client Index = 10	Epoch: 4	Loss: 0.915592
test acc on this client after 274 / 503 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 11
local mask changes: 2650294.0 / 11173962
choose client_indexes: [ 4  8  9 11 16], accoring to random
choose mask diff: [2719364.0, 2720882.0, 2719732.0, 2650294.0, 2717734.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.637182
Client Index = 11	Epoch: 1	Loss: 0.595398
Client Index = 11	Epoch: 2	Loss: 0.570193
Client Index = 11	Epoch: 3	Loss: 0.597178
Client Index = 11	Epoch: 4	Loss: 0.547022
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 12
local mask changes: 2651242.0 / 11173962
choose client_indexes: [ 0  6 10 11 12], accoring to random
choose mask diff: [2720356.0, 2720414.0, 2720580.0, 2719778.0, 2651242.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 12	Epoch: 0	Loss: 0.841319
Client Index = 12	Epoch: 1	Loss: 0.833710
Client Index = 12	Epoch: 2	Loss: 0.796656
Client Index = 12	Epoch: 3	Loss: 0.774761
Client Index = 12	Epoch: 4	Loss: 0.720557
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 13
local mask changes: 2652634.0 / 11173962
choose client_indexes: [ 5  8 13 15 16], accoring to random
choose mask diff: [2721470.0, 2721030.0, 2652634.0, 2720558.0, 2721082.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.951591
Client Index = 13	Epoch: 1	Loss: 0.931574
Client Index = 13	Epoch: 2	Loss: 0.902392
Client Index = 13	Epoch: 3	Loss: 0.844739
Client Index = 13	Epoch: 4	Loss: 0.823200
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 14
local mask changes: 2649126.0 / 11173962
choose client_indexes: [ 3  4  6 14 17], accoring to random
choose mask diff: [2721172.0, 2722058.0, 2719878.0, 2649126.0, 2723308.0]
Doing local aggregation!
test acc on this client before 289 / 502 : 0.58
Client Index = 14	Epoch: 0	Loss: 1.002950
Client Index = 14	Epoch: 1	Loss: 0.904365
Client Index = 14	Epoch: 2	Loss: 0.938770
Client Index = 14	Epoch: 3	Loss: 0.880591
Client Index = 14	Epoch: 4	Loss: 0.897068
test acc on this client after 323 / 502 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 15
local mask changes: 2650062.0 / 11173962
choose client_indexes: [ 8 11 13 15 19], accoring to random
choose mask diff: [2718916.0, 2719212.0, 2720330.0, 2650062.0, 2722068.0]
Doing local aggregation!
test acc on this client before 309 / 504 : 0.61
Client Index = 15	Epoch: 0	Loss: 0.813143
Client Index = 15	Epoch: 1	Loss: 0.729670
Client Index = 15	Epoch: 2	Loss: 0.725460
Client Index = 15	Epoch: 3	Loss: 0.686628
Client Index = 15	Epoch: 4	Loss: 0.718200
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 16
local mask changes: 2650882.0 / 11173962
choose client_indexes: [ 2  3  4 14 16], accoring to random
choose mask diff: [2720450.0, 2722242.0, 2720204.0, 2719434.0, 2650882.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 16	Epoch: 0	Loss: 0.793177
Client Index = 16	Epoch: 1	Loss: 0.733231
Client Index = 16	Epoch: 2	Loss: 0.811897
Client Index = 16	Epoch: 3	Loss: 0.674325
Client Index = 16	Epoch: 4	Loss: 0.771858
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 17
local mask changes: 2650678.0 / 11173962
choose client_indexes: [ 7  8 10 15 17], accoring to random
choose mask diff: [2719658.0, 2721530.0, 2720924.0, 2721400.0, 2650678.0]
Doing local aggregation!
test acc on this client before 195 / 505 : 0.39
Client Index = 17	Epoch: 0	Loss: 0.837281
Client Index = 17	Epoch: 1	Loss: 0.646642
Client Index = 17	Epoch: 2	Loss: 0.627565
Client Index = 17	Epoch: 3	Loss: 0.574312
Client Index = 17	Epoch: 4	Loss: 0.573055
test acc on this client after 383 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 18
local mask changes: 2649770.0 / 11173962
choose client_indexes: [ 0  2 15 17 18], accoring to random
choose mask diff: [2716392.0, 2718626.0, 2720882.0, 2719330.0, 2649770.0]
Doing local aggregation!
test acc on this client before 294 / 504 : 0.58
Client Index = 18	Epoch: 0	Loss: 0.672647
Client Index = 18	Epoch: 1	Loss: 0.509359
Client Index = 18	Epoch: 2	Loss: 0.507428
Client Index = 18	Epoch: 3	Loss: 0.490432
Client Index = 18	Epoch: 4	Loss: 0.536463
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(25) with spasity 0.5: 19
local mask changes: 2649670.0 / 11173962
choose client_indexes: [ 4 12 14 16 19], accoring to random
choose mask diff: [2719348.0, 2718116.0, 2718650.0, 2720338.0, 2649670.0]
Doing local aggregation!
test acc on this client before 311 / 506 : 0.61
Client Index = 19	Epoch: 0	Loss: 0.831683
Client Index = 19	Epoch: 1	Loss: 0.749909
Client Index = 19	Epoch: 2	Loss: 0.733987
Client Index = 19	Epoch: 3	Loss: 0.769031
Client Index = 19	Epoch: 4	Loss: 0.692236
test acc on this client after 284 / 506 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 25
{'test_acc': 0.6589238310578427, 'test_loss': 0.9938594274623738}
################local_test_on_all_clients before local training in communication round: 25
{'test_acc': 0.5816492965903396, 'test_loss': 1.171919933474103}
################Communication round : 26
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 0
local mask changes: 2627016.0 / 11173962
choose client_indexes: [ 0  8  9 14 16], accoring to random
choose mask diff: [2627016.0, 2699484.0, 2700444.0, 2697216.0, 2697698.0]
Doing local aggregation!
test acc on this client before 202 / 504 : 0.40
Client Index = 0	Epoch: 0	Loss: 1.118591
Client Index = 0	Epoch: 1	Loss: 1.106968
Client Index = 0	Epoch: 2	Loss: 1.094632
Client Index = 0	Epoch: 3	Loss: 0.995113
Client Index = 0	Epoch: 4	Loss: 1.001795
test acc on this client after 274 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 1
local mask changes: 2625566.0 / 11173962
choose client_indexes: [ 1  3  7 10 11], accoring to random
choose mask diff: [2625566.0, 2698474.0, 2697700.0, 2697810.0, 2698272.0]
Doing local aggregation!
test acc on this client before 320 / 503 : 0.64
Client Index = 1	Epoch: 0	Loss: 0.738896
Client Index = 1	Epoch: 1	Loss: 0.608937
Client Index = 1	Epoch: 2	Loss: 0.623278
Client Index = 1	Epoch: 3	Loss: 0.593359
Client Index = 1	Epoch: 4	Loss: 0.575204
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 2
local mask changes: 2625662.0 / 11173962
choose client_indexes: [ 2  5  6 10 12], accoring to random
choose mask diff: [2625662.0, 2697192.0, 2697432.0, 2698102.0, 2696998.0]
Doing local aggregation!
test acc on this client before 302 / 502 : 0.60
Client Index = 2	Epoch: 0	Loss: 0.704113
Client Index = 2	Epoch: 1	Loss: 0.632288
Client Index = 2	Epoch: 2	Loss: 0.585630
Client Index = 2	Epoch: 3	Loss: 0.510759
Client Index = 2	Epoch: 4	Loss: 0.614569
test acc on this client after 406 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 3
local mask changes: 2626548.0 / 11173962
choose client_indexes: [ 3  4  7 10 16], accoring to random
choose mask diff: [2626548.0, 2698874.0, 2697636.0, 2699224.0, 2698704.0]
Doing local aggregation!
test acc on this client before 222 / 504 : 0.44
Client Index = 3	Epoch: 0	Loss: 1.005991
Client Index = 3	Epoch: 1	Loss: 0.908877
Client Index = 3	Epoch: 2	Loss: 0.929607
Client Index = 3	Epoch: 3	Loss: 0.842009
Client Index = 3	Epoch: 4	Loss: 0.885263
test acc on this client after 343 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 4
local mask changes: 2627964.0 / 11173962
choose client_indexes: [ 2  4  7 13 17], accoring to random
choose mask diff: [2698646.0, 2627964.0, 2698614.0, 2698600.0, 2700234.0]
Doing local aggregation!
test acc on this client before 240 / 503 : 0.48
Client Index = 4	Epoch: 0	Loss: 0.831543
Client Index = 4	Epoch: 1	Loss: 0.589687
Client Index = 4	Epoch: 2	Loss: 0.707217
Client Index = 4	Epoch: 3	Loss: 0.654440
Client Index = 4	Epoch: 4	Loss: 0.601003
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 5
local mask changes: 2626130.0 / 11173962
choose client_indexes: [ 1  5  9 13 16], accoring to random
choose mask diff: [2698366.0, 2626130.0, 2698934.0, 2699252.0, 2697010.0]
Doing local aggregation!
test acc on this client before 254 / 504 : 0.50
Client Index = 5	Epoch: 0	Loss: 0.827324
Client Index = 5	Epoch: 1	Loss: 0.737996
Client Index = 5	Epoch: 2	Loss: 0.765494
Client Index = 5	Epoch: 3	Loss: 0.678342
Client Index = 5	Epoch: 4	Loss: 0.702546
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 6
local mask changes: 2626138.0 / 11173962
choose client_indexes: [ 1  6  8  9 16], accoring to random
choose mask diff: [2699300.0, 2626138.0, 2697758.0, 2696252.0, 2698654.0]
Doing local aggregation!
test acc on this client before 251 / 505 : 0.50
Client Index = 6	Epoch: 0	Loss: 1.101756
Client Index = 6	Epoch: 1	Loss: 1.009483
Client Index = 6	Epoch: 2	Loss: 1.030618
Client Index = 6	Epoch: 3	Loss: 1.019283
Client Index = 6	Epoch: 4	Loss: 0.988495
test acc on this client after 312 / 505 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 7
local mask changes: 2626732.0 / 11173962
choose client_indexes: [ 3  7  8 11 19], accoring to random
choose mask diff: [2696214.0, 2626732.0, 2697538.0, 2697672.0, 2698298.0]
Doing local aggregation!
test acc on this client before 280 / 504 : 0.56
Client Index = 7	Epoch: 0	Loss: 0.908965
Client Index = 7	Epoch: 1	Loss: 0.916397
Client Index = 7	Epoch: 2	Loss: 0.873789
Client Index = 7	Epoch: 3	Loss: 0.803952
Client Index = 7	Epoch: 4	Loss: 0.801623
test acc on this client after 313 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 8
local mask changes: 2627410.0 / 11173962
choose client_indexes: [ 6  8 14 17 18], accoring to random
choose mask diff: [2699026.0, 2627410.0, 2697080.0, 2699398.0, 2698150.0]
Doing local aggregation!
test acc on this client before 306 / 504 : 0.61
Client Index = 8	Epoch: 0	Loss: 1.020798
Client Index = 8	Epoch: 1	Loss: 0.927284
Client Index = 8	Epoch: 2	Loss: 0.943888
Client Index = 8	Epoch: 3	Loss: 0.880808
Client Index = 8	Epoch: 4	Loss: 0.857671
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 9
local mask changes: 2626178.0 / 11173962
choose client_indexes: [ 4  9 14 17 18], accoring to random
choose mask diff: [2695922.0, 2626178.0, 2697386.0, 2698422.0, 2696502.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.795199
Client Index = 9	Epoch: 1	Loss: 0.704874
Client Index = 9	Epoch: 2	Loss: 0.693424
Client Index = 9	Epoch: 3	Loss: 0.672706
Client Index = 9	Epoch: 4	Loss: 0.690257
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 10
local mask changes: 2628498.0 / 11173962
choose client_indexes: [ 0  1  3 10 19], accoring to random
choose mask diff: [2700072.0, 2699634.0, 2698662.0, 2628498.0, 2698508.0]
Doing local aggregation!
test acc on this client before 309 / 503 : 0.61
Client Index = 10	Epoch: 0	Loss: 1.013872
Client Index = 10	Epoch: 1	Loss: 0.877247
Client Index = 10	Epoch: 2	Loss: 0.961531
Client Index = 10	Epoch: 3	Loss: 0.910116
Client Index = 10	Epoch: 4	Loss: 0.838055
test acc on this client after 298 / 503 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 11
local mask changes: 2624550.0 / 11173962
choose client_indexes: [ 3  7 11 13 19], accoring to random
choose mask diff: [2697546.0, 2694948.0, 2624550.0, 2697446.0, 2699716.0]
Doing local aggregation!
test acc on this client before 328 / 504 : 0.65
Client Index = 11	Epoch: 0	Loss: 0.766440
Client Index = 11	Epoch: 1	Loss: 0.579013
Client Index = 11	Epoch: 2	Loss: 0.545123
Client Index = 11	Epoch: 3	Loss: 0.558263
Client Index = 11	Epoch: 4	Loss: 0.523712
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 12
local mask changes: 2626890.0 / 11173962
choose client_indexes: [ 0  7 10 11 12], accoring to random
choose mask diff: [2695230.0, 2696588.0, 2697588.0, 2695274.0, 2626890.0]
Doing local aggregation!
test acc on this client before 299 / 504 : 0.59
Client Index = 12	Epoch: 0	Loss: 0.829179
Client Index = 12	Epoch: 1	Loss: 0.818705
Client Index = 12	Epoch: 2	Loss: 0.769788
Client Index = 12	Epoch: 3	Loss: 0.734156
Client Index = 12	Epoch: 4	Loss: 0.773550
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 13
local mask changes: 2626106.0 / 11173962
choose client_indexes: [ 8  9 13 16 19], accoring to random
choose mask diff: [2697918.0, 2699032.0, 2626106.0, 2697412.0, 2698030.0]
Doing local aggregation!
test acc on this client before 314 / 503 : 0.62
Client Index = 13	Epoch: 0	Loss: 0.936661
Client Index = 13	Epoch: 1	Loss: 0.877203
Client Index = 13	Epoch: 2	Loss: 0.803591
Client Index = 13	Epoch: 3	Loss: 0.855896
Client Index = 13	Epoch: 4	Loss: 0.822673
test acc on this client after 317 / 503 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 14
local mask changes: 2627344.0 / 11173962
choose client_indexes: [ 9 10 14 17 18], accoring to random
choose mask diff: [2698082.0, 2699198.0, 2627344.0, 2697342.0, 2697968.0]
Doing local aggregation!
test acc on this client before 250 / 502 : 0.50
Client Index = 14	Epoch: 0	Loss: 0.929191
Client Index = 14	Epoch: 1	Loss: 0.949984
Client Index = 14	Epoch: 2	Loss: 0.896014
Client Index = 14	Epoch: 3	Loss: 0.839677
Client Index = 14	Epoch: 4	Loss: 0.898515
test acc on this client after 327 / 502 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 15
local mask changes: 2627064.0 / 11173962
choose client_indexes: [ 0  3  4  5 15], accoring to random
choose mask diff: [2696874.0, 2700632.0, 2699232.0, 2698636.0, 2627064.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 15	Epoch: 0	Loss: 0.940999
Client Index = 15	Epoch: 1	Loss: 0.703643
Client Index = 15	Epoch: 2	Loss: 0.723513
Client Index = 15	Epoch: 3	Loss: 0.764289
Client Index = 15	Epoch: 4	Loss: 0.652341
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 16
local mask changes: 2627998.0 / 11173962
choose client_indexes: [ 4 10 16 18 19], accoring to random
choose mask diff: [2697598.0, 2698476.0, 2627998.0, 2696844.0, 2698624.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 16	Epoch: 0	Loss: 0.826887
Client Index = 16	Epoch: 1	Loss: 0.703717
Client Index = 16	Epoch: 2	Loss: 0.728823
Client Index = 16	Epoch: 3	Loss: 0.656589
Client Index = 16	Epoch: 4	Loss: 0.699770
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 17
local mask changes: 2626344.0 / 11173962
choose client_indexes: [ 1  2  5 12 17], accoring to random
choose mask diff: [2699790.0, 2698906.0, 2698804.0, 2697414.0, 2626344.0]
Doing local aggregation!
test acc on this client before 287 / 505 : 0.57
Client Index = 17	Epoch: 0	Loss: 0.790160
Client Index = 17	Epoch: 1	Loss: 0.644624
Client Index = 17	Epoch: 2	Loss: 0.630761
Client Index = 17	Epoch: 3	Loss: 0.625667
Client Index = 17	Epoch: 4	Loss: 0.545505
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 18
local mask changes: 2628106.0 / 11173962
choose client_indexes: [ 1  6 13 15 18], accoring to random
choose mask diff: [2696298.0, 2698398.0, 2698198.0, 2696110.0, 2628106.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 18	Epoch: 0	Loss: 0.598121
Client Index = 18	Epoch: 1	Loss: 0.632599
Client Index = 18	Epoch: 2	Loss: 0.533945
Client Index = 18	Epoch: 3	Loss: 0.500853
Client Index = 18	Epoch: 4	Loss: 0.475828
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(26) with spasity 0.5: 19
local mask changes: 2627278.0 / 11173962
choose client_indexes: [ 2  5  6 10 19], accoring to random
choose mask diff: [2697326.0, 2697566.0, 2697182.0, 2699924.0, 2627278.0]
Doing local aggregation!
test acc on this client before 267 / 506 : 0.53
Client Index = 19	Epoch: 0	Loss: 0.904902
Client Index = 19	Epoch: 1	Loss: 0.690037
Client Index = 19	Epoch: 2	Loss: 0.742175
Client Index = 19	Epoch: 3	Loss: 0.745786
Client Index = 19	Epoch: 4	Loss: 0.684572
test acc on this client after 309 / 506 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 26
{'test_acc': 0.6870921782275561, 'test_loss': 0.923795870054606}
################local_test_on_all_clients before local training in communication round: 26
{'test_acc': 0.5685585881347158, 'test_loss': 1.1920435643203708}
################Communication round : 27
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 0
local mask changes: 2601990.0 / 11173962
choose client_indexes: [ 0  2  8 16 18], accoring to random
choose mask diff: [2601990.0, 2677114.0, 2676882.0, 2675474.0, 2675334.0]
Doing local aggregation!
test acc on this client before 231 / 504 : 0.46
Client Index = 0	Epoch: 0	Loss: 1.150132
Client Index = 0	Epoch: 1	Loss: 1.049769
Client Index = 0	Epoch: 2	Loss: 1.090516
Client Index = 0	Epoch: 3	Loss: 1.028131
Client Index = 0	Epoch: 4	Loss: 0.947890
test acc on this client after 246 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 1
local mask changes: 2602092.0 / 11173962
choose client_indexes: [ 0  1  6  8 13], accoring to random
choose mask diff: [2678826.0, 2602092.0, 2678224.0, 2676502.0, 2674868.0]
Doing local aggregation!
test acc on this client before 333 / 503 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.802043
Client Index = 1	Epoch: 1	Loss: 0.639694
Client Index = 1	Epoch: 2	Loss: 0.615901
Client Index = 1	Epoch: 3	Loss: 0.614736
Client Index = 1	Epoch: 4	Loss: 0.567358
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 2
local mask changes: 2603128.0 / 11173962
choose client_indexes: [ 2  4 12 13 15], accoring to random
choose mask diff: [2603128.0, 2678370.0, 2673120.0, 2677340.0, 2677978.0]
Doing local aggregation!
test acc on this client before 322 / 502 : 0.64
Client Index = 2	Epoch: 0	Loss: 0.716057
Client Index = 2	Epoch: 1	Loss: 0.603747
Client Index = 2	Epoch: 2	Loss: 0.540468
Client Index = 2	Epoch: 3	Loss: 0.541582
Client Index = 2	Epoch: 4	Loss: 0.597075
test acc on this client after 416 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 3
local mask changes: 2600978.0 / 11173962
choose client_indexes: [ 3  7  8 10 18], accoring to random
choose mask diff: [2600978.0, 2676304.0, 2677652.0, 2675122.0, 2679746.0]
Doing local aggregation!
test acc on this client before 198 / 504 : 0.39
Client Index = 3	Epoch: 0	Loss: 0.984642
Client Index = 3	Epoch: 1	Loss: 0.891593
Client Index = 3	Epoch: 2	Loss: 0.888777
Client Index = 3	Epoch: 3	Loss: 0.870031
Client Index = 3	Epoch: 4	Loss: 0.831765
test acc on this client after 311 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 4
local mask changes: 2601690.0 / 11173962
choose client_indexes: [ 0  4 10 18 19], accoring to random
choose mask diff: [2675764.0, 2601690.0, 2677610.0, 2677598.0, 2675130.0]
Doing local aggregation!
test acc on this client before 268 / 503 : 0.53
Client Index = 4	Epoch: 0	Loss: 0.730177
Client Index = 4	Epoch: 1	Loss: 0.664006
Client Index = 4	Epoch: 2	Loss: 0.652186
Client Index = 4	Epoch: 3	Loss: 0.545575
Client Index = 4	Epoch: 4	Loss: 0.628606
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 5
local mask changes: 2600088.0 / 11173962
choose client_indexes: [ 5  9 11 12 19], accoring to random
choose mask diff: [2600088.0, 2674588.0, 2676458.0, 2677692.0, 2677726.0]
Doing local aggregation!
test acc on this client before 331 / 504 : 0.66
Client Index = 5	Epoch: 0	Loss: 0.797500
Client Index = 5	Epoch: 1	Loss: 0.775501
Client Index = 5	Epoch: 2	Loss: 0.640719
Client Index = 5	Epoch: 3	Loss: 0.669131
Client Index = 5	Epoch: 4	Loss: 0.632726
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 6
local mask changes: 2600034.0 / 11173962
choose client_indexes: [1 2 5 6 8], accoring to random
choose mask diff: [2675544.0, 2676180.0, 2675970.0, 2600034.0, 2674068.0]
Doing local aggregation!
test acc on this client before 263 / 505 : 0.52
Client Index = 6	Epoch: 0	Loss: 1.060589
Client Index = 6	Epoch: 1	Loss: 1.029065
Client Index = 6	Epoch: 2	Loss: 0.982787
Client Index = 6	Epoch: 3	Loss: 0.982821
Client Index = 6	Epoch: 4	Loss: 0.963258
test acc on this client after 298 / 505 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 7
local mask changes: 2601266.0 / 11173962
choose client_indexes: [ 7  9 11 16 19], accoring to random
choose mask diff: [2601266.0, 2678716.0, 2674646.0, 2675176.0, 2674228.0]
Doing local aggregation!
test acc on this client before 294 / 504 : 0.58
Client Index = 7	Epoch: 0	Loss: 0.934349
Client Index = 7	Epoch: 1	Loss: 0.845679
Client Index = 7	Epoch: 2	Loss: 0.851318
Client Index = 7	Epoch: 3	Loss: 0.871507
Client Index = 7	Epoch: 4	Loss: 0.784908
test acc on this client after 314 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 8
local mask changes: 2601744.0 / 11173962
choose client_indexes: [ 1  2  8 13 14], accoring to random
choose mask diff: [2678326.0, 2674060.0, 2601744.0, 2677708.0, 2676416.0]
Doing local aggregation!
test acc on this client before 274 / 504 : 0.54
Client Index = 8	Epoch: 0	Loss: 1.047211
Client Index = 8	Epoch: 1	Loss: 0.932437
Client Index = 8	Epoch: 2	Loss: 0.885480
Client Index = 8	Epoch: 3	Loss: 0.892858
Client Index = 8	Epoch: 4	Loss: 0.838608
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 9
local mask changes: 2600992.0 / 11173962
choose client_indexes: [ 2  9 10 17 18], accoring to random
choose mask diff: [2679120.0, 2600992.0, 2678518.0, 2675136.0, 2672256.0]
Doing local aggregation!
test acc on this client before 350 / 504 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.831474
Client Index = 9	Epoch: 1	Loss: 0.721170
Client Index = 9	Epoch: 2	Loss: 0.682768
Client Index = 9	Epoch: 3	Loss: 0.597992
Client Index = 9	Epoch: 4	Loss: 0.713792
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 10
local mask changes: 2599958.0 / 11173962
choose client_indexes: [ 5 10 14 15 17], accoring to random
choose mask diff: [2677970.0, 2599958.0, 2677030.0, 2678374.0, 2677500.0]
Doing local aggregation!
test acc on this client before 264 / 503 : 0.52
Client Index = 10	Epoch: 0	Loss: 0.950954
Client Index = 10	Epoch: 1	Loss: 0.913611
Client Index = 10	Epoch: 2	Loss: 0.873440
Client Index = 10	Epoch: 3	Loss: 0.844448
Client Index = 10	Epoch: 4	Loss: 0.896769
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 11
local mask changes: 2602144.0 / 11173962
choose client_indexes: [ 2  3  5 11 16], accoring to random
choose mask diff: [2677520.0, 2674470.0, 2677492.0, 2602144.0, 2673676.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.713046
Client Index = 11	Epoch: 1	Loss: 0.578945
Client Index = 11	Epoch: 2	Loss: 0.533055
Client Index = 11	Epoch: 3	Loss: 0.545270
Client Index = 11	Epoch: 4	Loss: 0.496171
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 12
local mask changes: 2600904.0 / 11173962
choose client_indexes: [ 1  5 12 18 19], accoring to random
choose mask diff: [2677764.0, 2678226.0, 2600904.0, 2675248.0, 2674160.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 12	Epoch: 0	Loss: 0.814136
Client Index = 12	Epoch: 1	Loss: 0.720636
Client Index = 12	Epoch: 2	Loss: 0.783539
Client Index = 12	Epoch: 3	Loss: 0.723197
Client Index = 12	Epoch: 4	Loss: 0.756830
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 13
local mask changes: 2601926.0 / 11173962
choose client_indexes: [ 1  4  5  9 13], accoring to random
choose mask diff: [2676822.0, 2679188.0, 2677088.0, 2676304.0, 2601926.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 13	Epoch: 0	Loss: 0.908288
Client Index = 13	Epoch: 1	Loss: 0.864953
Client Index = 13	Epoch: 2	Loss: 0.859598
Client Index = 13	Epoch: 3	Loss: 0.826308
Client Index = 13	Epoch: 4	Loss: 0.788400
test acc on this client after 303 / 503 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 14
local mask changes: 2599696.0 / 11173962
choose client_indexes: [ 4  5  6 14 18], accoring to random
choose mask diff: [2676152.0, 2676538.0, 2676492.0, 2599696.0, 2677500.0]
Doing local aggregation!
test acc on this client before 346 / 502 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.924697
Client Index = 14	Epoch: 1	Loss: 0.913027
Client Index = 14	Epoch: 2	Loss: 0.872126
Client Index = 14	Epoch: 3	Loss: 0.831912
Client Index = 14	Epoch: 4	Loss: 0.878143
test acc on this client after 361 / 502 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 15
local mask changes: 2602170.0 / 11173962
choose client_indexes: [ 0  1 10 14 15], accoring to random
choose mask diff: [2675758.0, 2678210.0, 2676176.0, 2676716.0, 2602170.0]
Doing local aggregation!
test acc on this client before 302 / 504 : 0.60
Client Index = 15	Epoch: 0	Loss: 0.818873
Client Index = 15	Epoch: 1	Loss: 0.643135
Client Index = 15	Epoch: 2	Loss: 0.751930
Client Index = 15	Epoch: 3	Loss: 0.671272
Client Index = 15	Epoch: 4	Loss: 0.640852
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 16
local mask changes: 2603570.0 / 11173962
choose client_indexes: [ 1  7 14 15 16], accoring to random
choose mask diff: [2677480.0, 2678050.0, 2674272.0, 2676360.0, 2603570.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 16	Epoch: 0	Loss: 0.768500
Client Index = 16	Epoch: 1	Loss: 0.764176
Client Index = 16	Epoch: 2	Loss: 0.684144
Client Index = 16	Epoch: 3	Loss: 0.694908
Client Index = 16	Epoch: 4	Loss: 0.636010
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 17
local mask changes: 2601070.0 / 11173962
choose client_indexes: [ 3  4  9 12 17], accoring to random
choose mask diff: [2676532.0, 2675564.0, 2678988.0, 2674598.0, 2601070.0]
Doing local aggregation!
test acc on this client before 345 / 505 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.760243
Client Index = 17	Epoch: 1	Loss: 0.618854
Client Index = 17	Epoch: 2	Loss: 0.585185
Client Index = 17	Epoch: 3	Loss: 0.549132
Client Index = 17	Epoch: 4	Loss: 0.560826
test acc on this client after 391 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 18
local mask changes: 2601514.0 / 11173962
choose client_indexes: [ 0  1 11 17 18], accoring to random
choose mask diff: [2677554.0, 2674548.0, 2678532.0, 2677312.0, 2601514.0]
Doing local aggregation!
test acc on this client before 325 / 504 : 0.64
Client Index = 18	Epoch: 0	Loss: 0.583869
Client Index = 18	Epoch: 1	Loss: 0.563796
Client Index = 18	Epoch: 2	Loss: 0.491253
Client Index = 18	Epoch: 3	Loss: 0.539730
Client Index = 18	Epoch: 4	Loss: 0.469060
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(27) with spasity 0.5: 19
local mask changes: 2601950.0 / 11173962
choose client_indexes: [ 3  9 16 18 19], accoring to random
choose mask diff: [2674888.0, 2675090.0, 2676188.0, 2676222.0, 2601950.0]
Doing local aggregation!
test acc on this client before 323 / 506 : 0.64
Client Index = 19	Epoch: 0	Loss: 0.829210
Client Index = 19	Epoch: 1	Loss: 0.784051
Client Index = 19	Epoch: 2	Loss: 0.669645
Client Index = 19	Epoch: 3	Loss: 0.733108
Client Index = 19	Epoch: 4	Loss: 0.669276
test acc on this client after 369 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 27
{'test_acc': 0.6870773769731753, 'test_loss': 0.9342177884293683}
################local_test_on_all_clients before local training in communication round: 27
{'test_acc': 0.6156025946138447, 'test_loss': 1.0871579984595647}
################Communication round : 28
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 0
local mask changes: 2574834.0 / 11173962
choose client_indexes: [ 0  7 10 15 16], accoring to random
choose mask diff: [2574834.0, 2658076.0, 2658316.0, 2654906.0, 2652602.0]
Doing local aggregation!
test acc on this client before 256 / 504 : 0.51
Client Index = 0	Epoch: 0	Loss: 1.144261
Client Index = 0	Epoch: 1	Loss: 0.995079
Client Index = 0	Epoch: 2	Loss: 1.029828
Client Index = 0	Epoch: 3	Loss: 0.999153
Client Index = 0	Epoch: 4	Loss: 1.016503
test acc on this client after 301 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 1
local mask changes: 2575178.0 / 11173962
choose client_indexes: [ 1  3 11 14 18], accoring to random
choose mask diff: [2575178.0, 2655258.0, 2655248.0, 2659116.0, 2654508.0]
Doing local aggregation!
test acc on this client before 200 / 503 : 0.40
Client Index = 1	Epoch: 0	Loss: 0.886425
Client Index = 1	Epoch: 1	Loss: 0.595143
Client Index = 1	Epoch: 2	Loss: 0.582976
Client Index = 1	Epoch: 3	Loss: 0.565433
Client Index = 1	Epoch: 4	Loss: 0.542634
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 2
local mask changes: 2574996.0 / 11173962
choose client_indexes: [ 2  4  5  6 13], accoring to random
choose mask diff: [2574996.0, 2653398.0, 2654304.0, 2654760.0, 2655462.0]
Doing local aggregation!
test acc on this client before 317 / 502 : 0.63
Client Index = 2	Epoch: 0	Loss: 0.772006
Client Index = 2	Epoch: 1	Loss: 0.536485
Client Index = 2	Epoch: 2	Loss: 0.552371
Client Index = 2	Epoch: 3	Loss: 0.517657
Client Index = 2	Epoch: 4	Loss: 0.595388
test acc on this client after 403 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 3
local mask changes: 2574680.0 / 11173962
choose client_indexes: [ 2  3 12 13 16], accoring to random
choose mask diff: [2658010.0, 2574680.0, 2655406.0, 2657240.0, 2654544.0]
Doing local aggregation!
test acc on this client before 229 / 504 : 0.45
Client Index = 3	Epoch: 0	Loss: 0.980720
Client Index = 3	Epoch: 1	Loss: 0.846558
Client Index = 3	Epoch: 2	Loss: 0.896846
Client Index = 3	Epoch: 3	Loss: 0.869569
Client Index = 3	Epoch: 4	Loss: 0.839846
test acc on this client after 331 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 4
local mask changes: 2575950.0 / 11173962
choose client_indexes: [ 2  4  7  9 14], accoring to random
choose mask diff: [2656166.0, 2575950.0, 2655478.0, 2655088.0, 2656216.0]
Doing local aggregation!
test acc on this client before 226 / 503 : 0.45
Client Index = 4	Epoch: 0	Loss: 0.831155
Client Index = 4	Epoch: 1	Loss: 0.570098
Client Index = 4	Epoch: 2	Loss: 0.744624
Client Index = 4	Epoch: 3	Loss: 0.537133
Client Index = 4	Epoch: 4	Loss: 0.576420
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 5
local mask changes: 2574324.0 / 11173962
choose client_indexes: [ 4  5  6 10 13], accoring to random
choose mask diff: [2657226.0, 2574324.0, 2653478.0, 2655542.0, 2654032.0]
Doing local aggregation!
test acc on this client before 280 / 504 : 0.56
Client Index = 5	Epoch: 0	Loss: 0.778423
Client Index = 5	Epoch: 1	Loss: 0.723843
Client Index = 5	Epoch: 2	Loss: 0.679257
Client Index = 5	Epoch: 3	Loss: 0.662482
Client Index = 5	Epoch: 4	Loss: 0.611987
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 6
local mask changes: 2576014.0 / 11173962
choose client_indexes: [ 4  6  7 16 17], accoring to random
choose mask diff: [2657242.0, 2576014.0, 2656804.0, 2654990.0, 2657550.0]
Doing local aggregation!
test acc on this client before 277 / 505 : 0.55
Client Index = 6	Epoch: 0	Loss: 1.078167
Client Index = 6	Epoch: 1	Loss: 1.020824
Client Index = 6	Epoch: 2	Loss: 0.995347
Client Index = 6	Epoch: 3	Loss: 0.930072
Client Index = 6	Epoch: 4	Loss: 0.984838
test acc on this client after 256 / 505 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 7
local mask changes: 2574892.0 / 11173962
choose client_indexes: [ 2  5  7 12 17], accoring to random
choose mask diff: [2656052.0, 2656238.0, 2574892.0, 2654606.0, 2656786.0]
Doing local aggregation!
test acc on this client before 329 / 504 : 0.65
Client Index = 7	Epoch: 0	Loss: 0.891435
Client Index = 7	Epoch: 1	Loss: 0.887562
Client Index = 7	Epoch: 2	Loss: 0.722501
Client Index = 7	Epoch: 3	Loss: 0.797933
Client Index = 7	Epoch: 4	Loss: 0.832388
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 8
local mask changes: 2576222.0 / 11173962
choose client_indexes: [ 0  3  8 17 18], accoring to random
choose mask diff: [2655180.0, 2656016.0, 2576222.0, 2654644.0, 2654576.0]
Doing local aggregation!
test acc on this client before 301 / 504 : 0.60
Client Index = 8	Epoch: 0	Loss: 0.965143
Client Index = 8	Epoch: 1	Loss: 0.963261
Client Index = 8	Epoch: 2	Loss: 0.936111
Client Index = 8	Epoch: 3	Loss: 0.837708
Client Index = 8	Epoch: 4	Loss: 0.831497
test acc on this client after 319 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 9
local mask changes: 2574340.0 / 11173962
choose client_indexes: [ 4  8  9 18 19], accoring to random
choose mask diff: [2655402.0, 2655962.0, 2574340.0, 2653906.0, 2656124.0]
Doing local aggregation!
test acc on this client before 325 / 504 : 0.64
Client Index = 9	Epoch: 0	Loss: 0.770718
Client Index = 9	Epoch: 1	Loss: 0.732903
Client Index = 9	Epoch: 2	Loss: 0.701819
Client Index = 9	Epoch: 3	Loss: 0.636735
Client Index = 9	Epoch: 4	Loss: 0.655465
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 10
local mask changes: 2576802.0 / 11173962
choose client_indexes: [ 2  6 10 17 18], accoring to random
choose mask diff: [2655054.0, 2657576.0, 2576802.0, 2654364.0, 2656532.0]
Doing local aggregation!
test acc on this client before 308 / 503 : 0.61
Client Index = 10	Epoch: 0	Loss: 0.945972
Client Index = 10	Epoch: 1	Loss: 0.904485
Client Index = 10	Epoch: 2	Loss: 0.926098
Client Index = 10	Epoch: 3	Loss: 0.817503
Client Index = 10	Epoch: 4	Loss: 0.827259
test acc on this client after 325 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 11
local mask changes: 2577102.0 / 11173962
choose client_indexes: [ 7 11 13 14 16], accoring to random
choose mask diff: [2655108.0, 2577102.0, 2655998.0, 2654122.0, 2650036.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.628869
Client Index = 11	Epoch: 1	Loss: 0.531410
Client Index = 11	Epoch: 2	Loss: 0.527570
Client Index = 11	Epoch: 3	Loss: 0.543477
Client Index = 11	Epoch: 4	Loss: 0.447009
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 12
local mask changes: 2577112.0 / 11173962
choose client_indexes: [ 1  9 11 12 18], accoring to random
choose mask diff: [2653818.0, 2658560.0, 2655540.0, 2577112.0, 2654578.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 12	Epoch: 0	Loss: 0.904008
Client Index = 12	Epoch: 1	Loss: 0.763924
Client Index = 12	Epoch: 2	Loss: 0.761767
Client Index = 12	Epoch: 3	Loss: 0.730357
Client Index = 12	Epoch: 4	Loss: 0.684961
test acc on this client after 359 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 13
local mask changes: 2575830.0 / 11173962
choose client_indexes: [ 3 12 13 14 15], accoring to random
choose mask diff: [2658638.0, 2657108.0, 2575830.0, 2655948.0, 2655634.0]
Doing local aggregation!
test acc on this client before 337 / 503 : 0.67
Client Index = 13	Epoch: 0	Loss: 0.925058
Client Index = 13	Epoch: 1	Loss: 0.809993
Client Index = 13	Epoch: 2	Loss: 0.812760
Client Index = 13	Epoch: 3	Loss: 0.743051
Client Index = 13	Epoch: 4	Loss: 0.855731
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 14
local mask changes: 2574816.0 / 11173962
choose client_indexes: [ 1  6 11 13 14], accoring to random
choose mask diff: [2657690.0, 2653622.0, 2656070.0, 2656440.0, 2574816.0]
Doing local aggregation!
test acc on this client before 349 / 502 : 0.70
Client Index = 14	Epoch: 0	Loss: 0.916848
Client Index = 14	Epoch: 1	Loss: 0.849823
Client Index = 14	Epoch: 2	Loss: 0.869869
Client Index = 14	Epoch: 3	Loss: 0.801112
Client Index = 14	Epoch: 4	Loss: 0.807703
test acc on this client after 311 / 502 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 15
local mask changes: 2575798.0 / 11173962
choose client_indexes: [ 3  8 13 15 17], accoring to random
choose mask diff: [2655768.0, 2656360.0, 2654856.0, 2575798.0, 2656038.0]
Doing local aggregation!
test acc on this client before 311 / 504 : 0.62
Client Index = 15	Epoch: 0	Loss: 0.742159
Client Index = 15	Epoch: 1	Loss: 0.646937
Client Index = 15	Epoch: 2	Loss: 0.686894
Client Index = 15	Epoch: 3	Loss: 0.694556
Client Index = 15	Epoch: 4	Loss: 0.638302
test acc on this client after 334 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 16
local mask changes: 2574360.0 / 11173962
choose client_indexes: [ 4  5 14 16 17], accoring to random
choose mask diff: [2655792.0, 2655114.0, 2650840.0, 2574360.0, 2657466.0]
Doing local aggregation!
test acc on this client before 295 / 503 : 0.59
Client Index = 16	Epoch: 0	Loss: 0.826211
Client Index = 16	Epoch: 1	Loss: 0.710295
Client Index = 16	Epoch: 2	Loss: 0.689879
Client Index = 16	Epoch: 3	Loss: 0.696321
Client Index = 16	Epoch: 4	Loss: 0.716968
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 17
local mask changes: 2575190.0 / 11173962
choose client_indexes: [ 1 10 15 17 18], accoring to random
choose mask diff: [2656110.0, 2655760.0, 2658390.0, 2575190.0, 2655584.0]
Doing local aggregation!
test acc on this client before 339 / 505 : 0.67
Client Index = 17	Epoch: 0	Loss: 0.740486
Client Index = 17	Epoch: 1	Loss: 0.646082
Client Index = 17	Epoch: 2	Loss: 0.603245
Client Index = 17	Epoch: 3	Loss: 0.548655
Client Index = 17	Epoch: 4	Loss: 0.531862
test acc on this client after 400 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 18
local mask changes: 2575458.0 / 11173962
choose client_indexes: [ 0  4  6 12 18], accoring to random
choose mask diff: [2653664.0, 2657112.0, 2655026.0, 2653058.0, 2575458.0]
Doing local aggregation!
test acc on this client before 351 / 504 : 0.70
Client Index = 18	Epoch: 0	Loss: 0.579500
Client Index = 18	Epoch: 1	Loss: 0.513400
Client Index = 18	Epoch: 2	Loss: 0.486685
Client Index = 18	Epoch: 3	Loss: 0.518002
Client Index = 18	Epoch: 4	Loss: 0.461859
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(28) with spasity 0.5: 19
local mask changes: 2575214.0 / 11173962
choose client_indexes: [ 8  9 11 14 19], accoring to random
choose mask diff: [2656974.0, 2654126.0, 2655152.0, 2654544.0, 2575214.0]
Doing local aggregation!
test acc on this client before 228 / 506 : 0.45
Client Index = 19	Epoch: 0	Loss: 0.822058
Client Index = 19	Epoch: 1	Loss: 0.742227
Client Index = 19	Epoch: 2	Loss: 0.706077
Client Index = 19	Epoch: 3	Loss: 0.680662
Client Index = 19	Epoch: 4	Loss: 0.641650
test acc on this client after 363 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 28
{'test_acc': 0.6955971999331674, 'test_loss': 0.8781879218744282}
################local_test_on_all_clients before local training in communication round: 28
{'test_acc': 0.5879214389353812, 'test_loss': 1.1480021143137928}
################Communication round : 29
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 0
local mask changes: 2548806.0 / 11173962
choose client_indexes: [ 0  6 10 13 15], accoring to random
choose mask diff: [2548806.0, 2634696.0, 2635082.0, 2637210.0, 2631178.0]
Doing local aggregation!
test acc on this client before 237 / 504 : 0.47
Client Index = 0	Epoch: 0	Loss: 1.051871
Client Index = 0	Epoch: 1	Loss: 1.005074
Client Index = 0	Epoch: 2	Loss: 0.992832
Client Index = 0	Epoch: 3	Loss: 1.014035
Client Index = 0	Epoch: 4	Loss: 0.930733
test acc on this client after 322 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 1
local mask changes: 2547584.0 / 11173962
choose client_indexes: [ 1  5  8 15 19], accoring to random
choose mask diff: [2547584.0, 2636212.0, 2631940.0, 2633268.0, 2635958.0]
Doing local aggregation!
test acc on this client before 300 / 503 : 0.60
Client Index = 1	Epoch: 0	Loss: 0.705516
Client Index = 1	Epoch: 1	Loss: 0.668893
Client Index = 1	Epoch: 2	Loss: 0.550224
Client Index = 1	Epoch: 3	Loss: 0.644646
Client Index = 1	Epoch: 4	Loss: 0.497949
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 2
local mask changes: 2548484.0 / 11173962
choose client_indexes: [ 2  3 15 16 18], accoring to random
choose mask diff: [2548484.0, 2636442.0, 2635146.0, 2635724.0, 2634264.0]
Doing local aggregation!
test acc on this client before 313 / 502 : 0.62
Client Index = 2	Epoch: 0	Loss: 0.677873
Client Index = 2	Epoch: 1	Loss: 0.580062
Client Index = 2	Epoch: 2	Loss: 0.529922
Client Index = 2	Epoch: 3	Loss: 0.508269
Client Index = 2	Epoch: 4	Loss: 0.521083
test acc on this client after 420 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 3
local mask changes: 2548428.0 / 11173962
choose client_indexes: [ 1  3 11 17 19], accoring to random
choose mask diff: [2633708.0, 2548428.0, 2632658.0, 2635044.0, 2632776.0]
Doing local aggregation!
test acc on this client before 271 / 504 : 0.54
Client Index = 3	Epoch: 0	Loss: 0.930410
Client Index = 3	Epoch: 1	Loss: 0.889506
Client Index = 3	Epoch: 2	Loss: 0.834923
Client Index = 3	Epoch: 3	Loss: 0.813582
Client Index = 3	Epoch: 4	Loss: 0.781030
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 4
local mask changes: 2547370.0 / 11173962
choose client_indexes: [ 4  7  8 12 13], accoring to random
choose mask diff: [2547370.0, 2632978.0, 2636474.0, 2635424.0, 2633598.0]
Doing local aggregation!
test acc on this client before 262 / 503 : 0.52
Client Index = 4	Epoch: 0	Loss: 0.758688
Client Index = 4	Epoch: 1	Loss: 0.619661
Client Index = 4	Epoch: 2	Loss: 0.692141
Client Index = 4	Epoch: 3	Loss: 0.564030
Client Index = 4	Epoch: 4	Loss: 0.518374
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 5
local mask changes: 2546570.0 / 11173962
choose client_indexes: [ 5 12 13 14 15], accoring to random
choose mask diff: [2546570.0, 2632438.0, 2630074.0, 2633416.0, 2637678.0]
Doing local aggregation!
test acc on this client before 246 / 504 : 0.49
Client Index = 5	Epoch: 0	Loss: 0.835222
Client Index = 5	Epoch: 1	Loss: 0.714870
Client Index = 5	Epoch: 2	Loss: 0.622817
Client Index = 5	Epoch: 3	Loss: 0.715287
Client Index = 5	Epoch: 4	Loss: 0.612893
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 6
local mask changes: 2546818.0 / 11173962
choose client_indexes: [ 4  6 12 18 19], accoring to random
choose mask diff: [2633484.0, 2546818.0, 2634684.0, 2636396.0, 2634480.0]
Doing local aggregation!
test acc on this client before 323 / 505 : 0.64
Client Index = 6	Epoch: 0	Loss: 1.095217
Client Index = 6	Epoch: 1	Loss: 1.010210
Client Index = 6	Epoch: 2	Loss: 0.978205
Client Index = 6	Epoch: 3	Loss: 1.007493
Client Index = 6	Epoch: 4	Loss: 0.893703
test acc on this client after 299 / 505 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 7
local mask changes: 2546434.0 / 11173962
choose client_indexes: [ 7 11 12 15 19], accoring to random
choose mask diff: [2546434.0, 2631638.0, 2631066.0, 2636784.0, 2631720.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.912975
Client Index = 7	Epoch: 1	Loss: 0.805650
Client Index = 7	Epoch: 2	Loss: 0.760659
Client Index = 7	Epoch: 3	Loss: 0.791434
Client Index = 7	Epoch: 4	Loss: 0.702967
test acc on this client after 321 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 8
local mask changes: 2548512.0 / 11173962
choose client_indexes: [ 1  5  6  8 10], accoring to random
choose mask diff: [2632670.0, 2634746.0, 2632778.0, 2548512.0, 2637376.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 8	Epoch: 0	Loss: 0.945646
Client Index = 8	Epoch: 1	Loss: 0.872441
Client Index = 8	Epoch: 2	Loss: 0.875987
Client Index = 8	Epoch: 3	Loss: 0.870282
Client Index = 8	Epoch: 4	Loss: 0.812690
test acc on this client after 335 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 9
local mask changes: 2548722.0 / 11173962
choose client_indexes: [ 1  9 10 12 13], accoring to random
choose mask diff: [2636388.0, 2548722.0, 2635052.0, 2634112.0, 2634542.0]
Doing local aggregation!
test acc on this client before 333 / 504 : 0.66
Client Index = 9	Epoch: 0	Loss: 0.777467
Client Index = 9	Epoch: 1	Loss: 0.719364
Client Index = 9	Epoch: 2	Loss: 0.624608
Client Index = 9	Epoch: 3	Loss: 0.669701
Client Index = 9	Epoch: 4	Loss: 0.633970
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 10
local mask changes: 2549702.0 / 11173962
choose client_indexes: [ 1  4  9 10 17], accoring to random
choose mask diff: [2633920.0, 2633106.0, 2634100.0, 2549702.0, 2629402.0]
Doing local aggregation!
test acc on this client before 310 / 503 : 0.62
Client Index = 10	Epoch: 0	Loss: 0.930411
Client Index = 10	Epoch: 1	Loss: 0.868514
Client Index = 10	Epoch: 2	Loss: 0.802183
Client Index = 10	Epoch: 3	Loss: 0.920330
Client Index = 10	Epoch: 4	Loss: 0.762433
test acc on this client after 283 / 503 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 11
local mask changes: 2548102.0 / 11173962
choose client_indexes: [ 5  7 10 11 13], accoring to random
choose mask diff: [2631818.0, 2629766.0, 2636354.0, 2548102.0, 2629140.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 11	Epoch: 0	Loss: 0.703230
Client Index = 11	Epoch: 1	Loss: 0.558686
Client Index = 11	Epoch: 2	Loss: 0.520582
Client Index = 11	Epoch: 3	Loss: 0.517363
Client Index = 11	Epoch: 4	Loss: 0.466480
test acc on this client after 379 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 12
local mask changes: 2548744.0 / 11173962
choose client_indexes: [ 1  5  9 12 14], accoring to random
choose mask diff: [2630986.0, 2632630.0, 2631538.0, 2548744.0, 2636318.0]
Doing local aggregation!
test acc on this client before 327 / 504 : 0.65
Client Index = 12	Epoch: 0	Loss: 0.863705
Client Index = 12	Epoch: 1	Loss: 0.770536
Client Index = 12	Epoch: 2	Loss: 0.716955
Client Index = 12	Epoch: 3	Loss: 0.718583
Client Index = 12	Epoch: 4	Loss: 0.658668
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 13
local mask changes: 2549842.0 / 11173962
choose client_indexes: [ 8 10 13 17 19], accoring to random
choose mask diff: [2635396.0, 2634888.0, 2549842.0, 2634148.0, 2635108.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.864904
Client Index = 13	Epoch: 1	Loss: 0.807781
Client Index = 13	Epoch: 2	Loss: 0.801333
Client Index = 13	Epoch: 3	Loss: 0.759211
Client Index = 13	Epoch: 4	Loss: 0.711797
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 14
local mask changes: 2548664.0 / 11173962
choose client_indexes: [ 2  5 10 14 15], accoring to random
choose mask diff: [2636578.0, 2634312.0, 2634926.0, 2548664.0, 2634252.0]
Doing local aggregation!
test acc on this client before 303 / 502 : 0.60
Client Index = 14	Epoch: 0	Loss: 0.893707
Client Index = 14	Epoch: 1	Loss: 0.880148
Client Index = 14	Epoch: 2	Loss: 0.804052
Client Index = 14	Epoch: 3	Loss: 0.827564
Client Index = 14	Epoch: 4	Loss: 0.837601
test acc on this client after 323 / 502 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 15
local mask changes: 2547626.0 / 11173962
choose client_indexes: [ 3  4  9 11 15], accoring to random
choose mask diff: [2631956.0, 2634802.0, 2635498.0, 2635342.0, 2547626.0]
Doing local aggregation!
test acc on this client before 287 / 504 : 0.57
Client Index = 15	Epoch: 0	Loss: 0.797726
Client Index = 15	Epoch: 1	Loss: 0.655942
Client Index = 15	Epoch: 2	Loss: 0.647060
Client Index = 15	Epoch: 3	Loss: 0.725836
Client Index = 15	Epoch: 4	Loss: 0.588799
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 16
local mask changes: 2547012.0 / 11173962
choose client_indexes: [ 0  1  7 16 19], accoring to random
choose mask diff: [2633398.0, 2635426.0, 2632408.0, 2547012.0, 2634688.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 16	Epoch: 0	Loss: 0.742045
Client Index = 16	Epoch: 1	Loss: 0.707811
Client Index = 16	Epoch: 2	Loss: 0.657814
Client Index = 16	Epoch: 3	Loss: 0.658992
Client Index = 16	Epoch: 4	Loss: 0.618612
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 17
local mask changes: 2547994.0 / 11173962
choose client_indexes: [10 11 17 18 19], accoring to random
choose mask diff: [2631004.0, 2636710.0, 2547994.0, 2632104.0, 2635788.0]
Doing local aggregation!
test acc on this client before 315 / 505 : 0.62
Client Index = 17	Epoch: 0	Loss: 0.784038
Client Index = 17	Epoch: 1	Loss: 0.624310
Client Index = 17	Epoch: 2	Loss: 0.506753
Client Index = 17	Epoch: 3	Loss: 0.555523
Client Index = 17	Epoch: 4	Loss: 0.522239
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 18
local mask changes: 2549166.0 / 11173962
choose client_indexes: [ 3  8 11 15 18], accoring to random
choose mask diff: [2634416.0, 2633952.0, 2633428.0, 2634080.0, 2549166.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.560340
Client Index = 18	Epoch: 1	Loss: 0.525375
Client Index = 18	Epoch: 2	Loss: 0.455777
Client Index = 18	Epoch: 3	Loss: 0.563023
Client Index = 18	Epoch: 4	Loss: 0.429485
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(29) with spasity 0.5: 19
local mask changes: 2547514.0 / 11173962
choose client_indexes: [ 2  7 12 15 19], accoring to random
choose mask diff: [2633928.0, 2632496.0, 2633298.0, 2638340.0, 2547514.0]
Doing local aggregation!
test acc on this client before 270 / 506 : 0.53
Client Index = 19	Epoch: 0	Loss: 0.794700
Client Index = 19	Epoch: 1	Loss: 0.664834
Client Index = 19	Epoch: 2	Loss: 0.711561
Client Index = 19	Epoch: 3	Loss: 0.703107
Client Index = 19	Epoch: 4	Loss: 0.608637
test acc on this client after 349 / 506 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 29
{'test_acc': 0.7003603007689124, 'test_loss': 0.8818966018963665}
################local_test_on_all_clients before local training in communication round: 29
{'test_acc': 0.6113342134685869, 'test_loss': 1.1027502473102813}
################Communication round : 30
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 0
local mask changes: 2519466.0 / 11173962
choose client_indexes: [ 0  2  7 14 17], accoring to random
choose mask diff: [2519466.0, 2615424.0, 2614950.0, 2614188.0, 2617128.0]
Doing local aggregation!
test acc on this client before 245 / 504 : 0.49
Client Index = 0	Epoch: 0	Loss: 1.034875
Client Index = 0	Epoch: 1	Loss: 1.023779
Client Index = 0	Epoch: 2	Loss: 0.975739
Client Index = 0	Epoch: 3	Loss: 0.941673
Client Index = 0	Epoch: 4	Loss: 0.995065
test acc on this client after 285 / 504 : 0.57
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 1
local mask changes: 2520562.0 / 11173962
choose client_indexes: [ 0  1  4 11 13], accoring to random
choose mask diff: [2613098.0, 2520562.0, 2615704.0, 2612468.0, 2613508.0]
Doing local aggregation!
test acc on this client before 303 / 503 : 0.60
Client Index = 1	Epoch: 0	Loss: 0.676357
Client Index = 1	Epoch: 1	Loss: 0.593222
Client Index = 1	Epoch: 2	Loss: 0.593354
Client Index = 1	Epoch: 3	Loss: 0.530187
Client Index = 1	Epoch: 4	Loss: 0.505276
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 2
local mask changes: 2521428.0 / 11173962
choose client_indexes: [ 2  5  7 10 11], accoring to random
choose mask diff: [2521428.0, 2610076.0, 2612984.0, 2610958.0, 2613056.0]
Doing local aggregation!
test acc on this client before 372 / 502 : 0.74
Client Index = 2	Epoch: 0	Loss: 0.632143
Client Index = 2	Epoch: 1	Loss: 0.606242
Client Index = 2	Epoch: 2	Loss: 0.489090
Client Index = 2	Epoch: 3	Loss: 0.493525
Client Index = 2	Epoch: 4	Loss: 0.475573
test acc on this client after 401 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 3
local mask changes: 2520844.0 / 11173962
choose client_indexes: [2 3 4 5 8], accoring to random
choose mask diff: [2611510.0, 2520844.0, 2614692.0, 2615282.0, 2614068.0]
Doing local aggregation!
test acc on this client before 269 / 504 : 0.53
Client Index = 3	Epoch: 0	Loss: 0.963207
Client Index = 3	Epoch: 1	Loss: 0.859648
Client Index = 3	Epoch: 2	Loss: 0.865507
Client Index = 3	Epoch: 3	Loss: 0.781480
Client Index = 3	Epoch: 4	Loss: 0.751515
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 4
local mask changes: 2519024.0 / 11173962
choose client_indexes: [ 0  4  5  9 11], accoring to random
choose mask diff: [2615452.0, 2519024.0, 2613580.0, 2611386.0, 2611082.0]
Doing local aggregation!
test acc on this client before 304 / 503 : 0.60
Client Index = 4	Epoch: 0	Loss: 0.768902
Client Index = 4	Epoch: 1	Loss: 0.557500
Client Index = 4	Epoch: 2	Loss: 0.592918
Client Index = 4	Epoch: 3	Loss: 0.564124
Client Index = 4	Epoch: 4	Loss: 0.545296
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 5
local mask changes: 2519356.0 / 11173962
choose client_indexes: [ 0  5  8 15 16], accoring to random
choose mask diff: [2615812.0, 2519356.0, 2615030.0, 2609904.0, 2612162.0]
Doing local aggregation!
test acc on this client before 329 / 504 : 0.65
Client Index = 5	Epoch: 0	Loss: 0.732606
Client Index = 5	Epoch: 1	Loss: 0.651165
Client Index = 5	Epoch: 2	Loss: 0.634742
Client Index = 5	Epoch: 3	Loss: 0.671714
Client Index = 5	Epoch: 4	Loss: 0.572911
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 6
local mask changes: 2520928.0 / 11173962
choose client_indexes: [ 1  2  3  6 16], accoring to random
choose mask diff: [2613548.0, 2612152.0, 2614232.0, 2520928.0, 2611564.0]
Doing local aggregation!
test acc on this client before 326 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 1.051041
Client Index = 6	Epoch: 1	Loss: 0.953525
Client Index = 6	Epoch: 2	Loss: 0.980209
Client Index = 6	Epoch: 3	Loss: 0.954374
Client Index = 6	Epoch: 4	Loss: 0.938336
test acc on this client after 275 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 7
local mask changes: 2521630.0 / 11173962
choose client_indexes: [ 4  7  9 18 19], accoring to random
choose mask diff: [2613888.0, 2521630.0, 2614112.0, 2616688.0, 2609562.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.949739
Client Index = 7	Epoch: 1	Loss: 0.795612
Client Index = 7	Epoch: 2	Loss: 0.709078
Client Index = 7	Epoch: 3	Loss: 0.756247
Client Index = 7	Epoch: 4	Loss: 0.733051
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 8
local mask changes: 2517786.0 / 11173962
choose client_indexes: [ 8 11 13 16 19], accoring to random
choose mask diff: [2517786.0, 2615516.0, 2613706.0, 2615300.0, 2615302.0]
Doing local aggregation!
test acc on this client before 326 / 504 : 0.65
Client Index = 8	Epoch: 0	Loss: 0.994767
Client Index = 8	Epoch: 1	Loss: 0.839638
Client Index = 8	Epoch: 2	Loss: 0.872567
Client Index = 8	Epoch: 3	Loss: 0.774906
Client Index = 8	Epoch: 4	Loss: 0.805785
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 9
local mask changes: 2521360.0 / 11173962
choose client_indexes: [ 9 15 17 18 19], accoring to random
choose mask diff: [2521360.0, 2612140.0, 2612294.0, 2611312.0, 2610230.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 9	Epoch: 0	Loss: 0.707946
Client Index = 9	Epoch: 1	Loss: 0.723241
Client Index = 9	Epoch: 2	Loss: 0.615677
Client Index = 9	Epoch: 3	Loss: 0.606858
Client Index = 9	Epoch: 4	Loss: 0.610615
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 10
local mask changes: 2522040.0 / 11173962
choose client_indexes: [ 3  7 10 13 18], accoring to random
choose mask diff: [2614764.0, 2616550.0, 2522040.0, 2613956.0, 2611164.0]
Doing local aggregation!
test acc on this client before 276 / 503 : 0.55
Client Index = 10	Epoch: 0	Loss: 0.916386
Client Index = 10	Epoch: 1	Loss: 0.844951
Client Index = 10	Epoch: 2	Loss: 0.814050
Client Index = 10	Epoch: 3	Loss: 0.795216
Client Index = 10	Epoch: 4	Loss: 0.839975
test acc on this client after 326 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 11
local mask changes: 2519500.0 / 11173962
choose client_indexes: [ 1  9 10 11 19], accoring to random
choose mask diff: [2612356.0, 2613908.0, 2611868.0, 2519500.0, 2612654.0]
Doing local aggregation!
test acc on this client before 297 / 504 : 0.59
Client Index = 11	Epoch: 0	Loss: 0.643480
Client Index = 11	Epoch: 1	Loss: 0.599164
Client Index = 11	Epoch: 2	Loss: 0.463947
Client Index = 11	Epoch: 3	Loss: 0.479761
Client Index = 11	Epoch: 4	Loss: 0.493128
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 12
local mask changes: 2520138.0 / 11173962
choose client_indexes: [ 6  8 12 15 17], accoring to random
choose mask diff: [2614278.0, 2614040.0, 2520138.0, 2610878.0, 2609500.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 12	Epoch: 0	Loss: 0.816739
Client Index = 12	Epoch: 1	Loss: 0.764100
Client Index = 12	Epoch: 2	Loss: 0.693547
Client Index = 12	Epoch: 3	Loss: 0.645248
Client Index = 12	Epoch: 4	Loss: 0.619693
test acc on this client after 255 / 504 : 0.51
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 13
local mask changes: 2520096.0 / 11173962
choose client_indexes: [ 7  9 13 15 19], accoring to random
choose mask diff: [2615410.0, 2613678.0, 2520096.0, 2611264.0, 2613808.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.791110
Client Index = 13	Epoch: 1	Loss: 0.756436
Client Index = 13	Epoch: 2	Loss: 0.790156
Client Index = 13	Epoch: 3	Loss: 0.761104
Client Index = 13	Epoch: 4	Loss: 0.829735
test acc on this client after 327 / 503 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 14
local mask changes: 2520588.0 / 11173962
choose client_indexes: [ 0  6 14 17 19], accoring to random
choose mask diff: [2615348.0, 2611488.0, 2520588.0, 2615686.0, 2613026.0]
Doing local aggregation!
test acc on this client before 235 / 502 : 0.47
Client Index = 14	Epoch: 0	Loss: 0.930435
Client Index = 14	Epoch: 1	Loss: 0.867881
Client Index = 14	Epoch: 2	Loss: 0.799403
Client Index = 14	Epoch: 3	Loss: 0.833056
Client Index = 14	Epoch: 4	Loss: 0.776235
test acc on this client after 306 / 502 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 15
local mask changes: 2521826.0 / 11173962
choose client_indexes: [ 8  9 15 16 19], accoring to random
choose mask diff: [2611740.0, 2610264.0, 2521826.0, 2610834.0, 2612814.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 15	Epoch: 0	Loss: 0.703911
Client Index = 15	Epoch: 1	Loss: 0.632850
Client Index = 15	Epoch: 2	Loss: 0.651196
Client Index = 15	Epoch: 3	Loss: 0.583211
Client Index = 15	Epoch: 4	Loss: 0.559634
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 16
local mask changes: 2520126.0 / 11173962
choose client_indexes: [ 0  6  8 13 16], accoring to random
choose mask diff: [2607188.0, 2612388.0, 2615208.0, 2613234.0, 2520126.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 16	Epoch: 0	Loss: 0.710984
Client Index = 16	Epoch: 1	Loss: 0.692414
Client Index = 16	Epoch: 2	Loss: 0.633620
Client Index = 16	Epoch: 3	Loss: 0.655526
Client Index = 16	Epoch: 4	Loss: 0.665418
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 17
local mask changes: 2521322.0 / 11173962
choose client_indexes: [ 0  5 13 17 18], accoring to random
choose mask diff: [2614692.0, 2612112.0, 2613838.0, 2521322.0, 2608798.0]
Doing local aggregation!
test acc on this client before 347 / 505 : 0.69
Client Index = 17	Epoch: 0	Loss: 0.703451
Client Index = 17	Epoch: 1	Loss: 0.602686
Client Index = 17	Epoch: 2	Loss: 0.575501
Client Index = 17	Epoch: 3	Loss: 0.491795
Client Index = 17	Epoch: 4	Loss: 0.547656
test acc on this client after 397 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 18
local mask changes: 2520798.0 / 11173962
choose client_indexes: [ 2  4  9 18 19], accoring to random
choose mask diff: [2614090.0, 2612578.0, 2610542.0, 2520798.0, 2613506.0]
Doing local aggregation!
test acc on this client before 334 / 504 : 0.66
Client Index = 18	Epoch: 0	Loss: 0.677890
Client Index = 18	Epoch: 1	Loss: 0.468186
Client Index = 18	Epoch: 2	Loss: 0.481728
Client Index = 18	Epoch: 3	Loss: 0.481178
Client Index = 18	Epoch: 4	Loss: 0.433980
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(30) with spasity 0.5: 19
local mask changes: 2520194.0 / 11173962
choose client_indexes: [ 2 10 12 14 19], accoring to random
choose mask diff: [2611166.0, 2613964.0, 2610192.0, 2614498.0, 2520194.0]
Doing local aggregation!
test acc on this client before 292 / 506 : 0.58
Client Index = 19	Epoch: 0	Loss: 0.811785
Client Index = 19	Epoch: 1	Loss: 0.692840
Client Index = 19	Epoch: 2	Loss: 0.608120
Client Index = 19	Epoch: 3	Loss: 0.698253
Client Index = 19	Epoch: 4	Loss: 0.645959
test acc on this client after 339 / 506 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 30
{'test_acc': 0.6920302585049332, 'test_loss': 0.8712813815054335}
################local_test_on_all_clients before local training in communication round: 30
{'test_acc': 0.6296744426543558, 'test_loss': 1.0479880686562955}
################Communication round : 31
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 0
local mask changes: 2490444.0 / 11173962
choose client_indexes: [ 0  3  4 15 17], accoring to random
choose mask diff: [2490444.0, 2593984.0, 2592778.0, 2590164.0, 2589320.0]
Doing local aggregation!
test acc on this client before 302 / 504 : 0.60
Client Index = 0	Epoch: 0	Loss: 1.045915
Client Index = 0	Epoch: 1	Loss: 0.979167
Client Index = 0	Epoch: 2	Loss: 0.914226
Client Index = 0	Epoch: 3	Loss: 0.963253
Client Index = 0	Epoch: 4	Loss: 0.900347
test acc on this client after 247 / 504 : 0.49
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 1
local mask changes: 2490222.0 / 11173962
choose client_indexes: [ 1  2  6 14 18], accoring to random
choose mask diff: [2490222.0, 2593438.0, 2591972.0, 2590180.0, 2588430.0]
Doing local aggregation!
test acc on this client before 325 / 503 : 0.65
Client Index = 1	Epoch: 0	Loss: 0.689575
Client Index = 1	Epoch: 1	Loss: 0.607895
Client Index = 1	Epoch: 2	Loss: 0.514777
Client Index = 1	Epoch: 3	Loss: 0.537686
Client Index = 1	Epoch: 4	Loss: 0.531279
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 2
local mask changes: 2492200.0 / 11173962
choose client_indexes: [ 1  2  8 13 16], accoring to random
choose mask diff: [2590844.0, 2492200.0, 2592066.0, 2589074.0, 2590376.0]
Doing local aggregation!
test acc on this client before 375 / 502 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.558802
Client Index = 2	Epoch: 1	Loss: 0.514192
Client Index = 2	Epoch: 2	Loss: 0.492220
Client Index = 2	Epoch: 3	Loss: 0.550276
Client Index = 2	Epoch: 4	Loss: 0.499919
test acc on this client after 405 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 3
local mask changes: 2491186.0 / 11173962
choose client_indexes: [ 0  3 14 16 18], accoring to random
choose mask diff: [2593756.0, 2491186.0, 2590138.0, 2589810.0, 2589454.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 3	Epoch: 0	Loss: 0.936554
Client Index = 3	Epoch: 1	Loss: 0.888137
Client Index = 3	Epoch: 2	Loss: 0.801660
Client Index = 3	Epoch: 3	Loss: 0.812086
Client Index = 3	Epoch: 4	Loss: 0.820484
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 4
local mask changes: 2491302.0 / 11173962
choose client_indexes: [ 0  4  6 12 19], accoring to random
choose mask diff: [2590284.0, 2491302.0, 2587964.0, 2589038.0, 2590860.0]
Doing local aggregation!
test acc on this client before 326 / 503 : 0.65
Client Index = 4	Epoch: 0	Loss: 0.687084
Client Index = 4	Epoch: 1	Loss: 0.602703
Client Index = 4	Epoch: 2	Loss: 0.559796
Client Index = 4	Epoch: 3	Loss: 0.530548
Client Index = 4	Epoch: 4	Loss: 0.536754
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 5
local mask changes: 2491704.0 / 11173962
choose client_indexes: [ 5  7  9 12 16], accoring to random
choose mask diff: [2491704.0, 2589398.0, 2593812.0, 2588248.0, 2588824.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 5	Epoch: 0	Loss: 0.748995
Client Index = 5	Epoch: 1	Loss: 0.624876
Client Index = 5	Epoch: 2	Loss: 0.797423
Client Index = 5	Epoch: 3	Loss: 0.597048
Client Index = 5	Epoch: 4	Loss: 0.571617
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 6
local mask changes: 2491986.0 / 11173962
choose client_indexes: [ 0  6  7 13 18], accoring to random
choose mask diff: [2591310.0, 2491986.0, 2590894.0, 2594540.0, 2589908.0]
Doing local aggregation!
test acc on this client before 319 / 505 : 0.63
Client Index = 6	Epoch: 0	Loss: 1.013195
Client Index = 6	Epoch: 1	Loss: 0.977020
Client Index = 6	Epoch: 2	Loss: 0.967773
Client Index = 6	Epoch: 3	Loss: 0.931135
Client Index = 6	Epoch: 4	Loss: 0.898252
test acc on this client after 318 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 7
local mask changes: 2491862.0 / 11173962
choose client_indexes: [ 0  7  9 13 16], accoring to random
choose mask diff: [2594762.0, 2491862.0, 2589782.0, 2592056.0, 2589408.0]
Doing local aggregation!
test acc on this client before 323 / 504 : 0.64
Client Index = 7	Epoch: 0	Loss: 0.882550
Client Index = 7	Epoch: 1	Loss: 0.724020
Client Index = 7	Epoch: 2	Loss: 0.777366
Client Index = 7	Epoch: 3	Loss: 0.685652
Client Index = 7	Epoch: 4	Loss: 0.769737
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 8
local mask changes: 2492462.0 / 11173962
choose client_indexes: [ 4  8  9 16 17], accoring to random
choose mask diff: [2593054.0, 2492462.0, 2593742.0, 2589224.0, 2591526.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 8	Epoch: 0	Loss: 0.959477
Client Index = 8	Epoch: 1	Loss: 0.926390
Client Index = 8	Epoch: 2	Loss: 0.835224
Client Index = 8	Epoch: 3	Loss: 0.778995
Client Index = 8	Epoch: 4	Loss: 0.784919
test acc on this client after 337 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 9
local mask changes: 2491270.0 / 11173962
choose client_indexes: [ 5  8  9 14 15], accoring to random
choose mask diff: [2590758.0, 2591680.0, 2491270.0, 2591530.0, 2584846.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.664715
Client Index = 9	Epoch: 1	Loss: 0.658305
Client Index = 9	Epoch: 2	Loss: 0.606797
Client Index = 9	Epoch: 3	Loss: 0.580105
Client Index = 9	Epoch: 4	Loss: 0.511056
test acc on this client after 265 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 10
local mask changes: 2491574.0 / 11173962
choose client_indexes: [ 4  5  6  9 10], accoring to random
choose mask diff: [2592856.0, 2591354.0, 2590962.0, 2588532.0, 2491574.0]
Doing local aggregation!
test acc on this client before 301 / 503 : 0.60
Client Index = 10	Epoch: 0	Loss: 0.887555
Client Index = 10	Epoch: 1	Loss: 0.816794
Client Index = 10	Epoch: 2	Loss: 0.844584
Client Index = 10	Epoch: 3	Loss: 0.788309
Client Index = 10	Epoch: 4	Loss: 0.743863
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 11
local mask changes: 2491398.0 / 11173962
choose client_indexes: [ 1  5 11 14 15], accoring to random
choose mask diff: [2587330.0, 2589676.0, 2491398.0, 2588378.0, 2589324.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 11	Epoch: 0	Loss: 0.615536
Client Index = 11	Epoch: 1	Loss: 0.500490
Client Index = 11	Epoch: 2	Loss: 0.498632
Client Index = 11	Epoch: 3	Loss: 0.507235
Client Index = 11	Epoch: 4	Loss: 0.485583
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 12
local mask changes: 2491000.0 / 11173962
choose client_indexes: [ 0  4 12 14 18], accoring to random
choose mask diff: [2593754.0, 2589324.0, 2491000.0, 2592508.0, 2590374.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 12	Epoch: 0	Loss: 0.794511
Client Index = 12	Epoch: 1	Loss: 0.775275
Client Index = 12	Epoch: 2	Loss: 0.712068
Client Index = 12	Epoch: 3	Loss: 0.719152
Client Index = 12	Epoch: 4	Loss: 0.640193
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 13
local mask changes: 2489590.0 / 11173962
choose client_indexes: [ 0  2  4  9 13], accoring to random
choose mask diff: [2592926.0, 2591688.0, 2590046.0, 2586358.0, 2489590.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.798809
Client Index = 13	Epoch: 1	Loss: 0.788774
Client Index = 13	Epoch: 2	Loss: 0.742518
Client Index = 13	Epoch: 3	Loss: 0.693351
Client Index = 13	Epoch: 4	Loss: 0.794127
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 14
local mask changes: 2491142.0 / 11173962
choose client_indexes: [ 1  6  8 11 14], accoring to random
choose mask diff: [2591828.0, 2586444.0, 2590548.0, 2590156.0, 2491142.0]
Doing local aggregation!
test acc on this client before 343 / 502 : 0.68
Client Index = 14	Epoch: 0	Loss: 0.837655
Client Index = 14	Epoch: 1	Loss: 0.774336
Client Index = 14	Epoch: 2	Loss: 0.846970
Client Index = 14	Epoch: 3	Loss: 0.792942
Client Index = 14	Epoch: 4	Loss: 0.807832
test acc on this client after 357 / 502 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 15
local mask changes: 2491628.0 / 11173962
choose client_indexes: [ 4  7 13 15 16], accoring to random
choose mask diff: [2589956.0, 2592026.0, 2588122.0, 2491628.0, 2588532.0]
Doing local aggregation!
test acc on this client before 303 / 504 : 0.60
Client Index = 15	Epoch: 0	Loss: 0.679839
Client Index = 15	Epoch: 1	Loss: 0.633743
Client Index = 15	Epoch: 2	Loss: 0.792796
Client Index = 15	Epoch: 3	Loss: 0.603747
Client Index = 15	Epoch: 4	Loss: 0.553896
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 16
local mask changes: 2490790.0 / 11173962
choose client_indexes: [ 2  3 14 15 16], accoring to random
choose mask diff: [2591494.0, 2591828.0, 2589584.0, 2592652.0, 2490790.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 16	Epoch: 0	Loss: 0.792198
Client Index = 16	Epoch: 1	Loss: 0.634441
Client Index = 16	Epoch: 2	Loss: 0.645582
Client Index = 16	Epoch: 3	Loss: 0.658829
Client Index = 16	Epoch: 4	Loss: 0.548657
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 17
local mask changes: 2493176.0 / 11173962
choose client_indexes: [ 3  6 11 13 17], accoring to random
choose mask diff: [2590472.0, 2592512.0, 2591180.0, 2586464.0, 2493176.0]
Doing local aggregation!
test acc on this client before 332 / 505 : 0.66
Client Index = 17	Epoch: 0	Loss: 0.758530
Client Index = 17	Epoch: 1	Loss: 0.554362
Client Index = 17	Epoch: 2	Loss: 0.569514
Client Index = 17	Epoch: 3	Loss: 0.500800
Client Index = 17	Epoch: 4	Loss: 0.534004
test acc on this client after 409 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 18
local mask changes: 2491538.0 / 11173962
choose client_indexes: [ 1  2  5 18 19], accoring to random
choose mask diff: [2589292.0, 2585918.0, 2593154.0, 2491538.0, 2586180.0]
Doing local aggregation!
test acc on this client before 336 / 504 : 0.67
Client Index = 18	Epoch: 0	Loss: 0.574574
Client Index = 18	Epoch: 1	Loss: 0.475796
Client Index = 18	Epoch: 2	Loss: 0.467078
Client Index = 18	Epoch: 3	Loss: 0.581207
Client Index = 18	Epoch: 4	Loss: 0.404723
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(31) with spasity 0.5: 19
local mask changes: 2491550.0 / 11173962
choose client_indexes: [ 3  4  5 16 19], accoring to random
choose mask diff: [2592072.0, 2590138.0, 2590138.0, 2590922.0, 2491550.0]
Doing local aggregation!
test acc on this client before 344 / 506 : 0.68
Client Index = 19	Epoch: 0	Loss: 0.736109
Client Index = 19	Epoch: 1	Loss: 0.676668
Client Index = 19	Epoch: 2	Loss: 0.646591
Client Index = 19	Epoch: 3	Loss: 0.592283
Client Index = 19	Epoch: 4	Loss: 0.692838
test acc on this client after 377 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 31
{'test_acc': 0.7144676357372088, 'test_loss': 0.8597876213016532}
################local_test_on_all_clients before local training in communication round: 31
{'test_acc': 0.6544206029353589, 'test_loss': 0.9769647126143305}
################Communication round : 32
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 0
local mask changes: 2462294.0 / 11173962
choose client_indexes: [ 0  1  9 15 18], accoring to random
choose mask diff: [2462294.0, 2567422.0, 2570364.0, 2564462.0, 2568696.0]
Doing local aggregation!
test acc on this client before 250 / 504 : 0.50
Client Index = 0	Epoch: 0	Loss: 1.047275
Client Index = 0	Epoch: 1	Loss: 0.926787
Client Index = 0	Epoch: 2	Loss: 0.929828
Client Index = 0	Epoch: 3	Loss: 0.925148
Client Index = 0	Epoch: 4	Loss: 0.914378
test acc on this client after 282 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 1
local mask changes: 2461868.0 / 11173962
choose client_indexes: [ 1  8 10 11 17], accoring to random
choose mask diff: [2461868.0, 2566532.0, 2567192.0, 2563938.0, 2568784.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 1	Epoch: 0	Loss: 0.682237
Client Index = 1	Epoch: 1	Loss: 0.539677
Client Index = 1	Epoch: 2	Loss: 0.531772
Client Index = 1	Epoch: 3	Loss: 0.560489
Client Index = 1	Epoch: 4	Loss: 0.433164
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 2
local mask changes: 2461730.0 / 11173962
choose client_indexes: [ 2  5  8 10 16], accoring to random
choose mask diff: [2461730.0, 2565568.0, 2564916.0, 2567142.0, 2563520.0]
Doing local aggregation!
test acc on this client before 300 / 502 : 0.60
Client Index = 2	Epoch: 0	Loss: 0.603033
Client Index = 2	Epoch: 1	Loss: 0.536990
Client Index = 2	Epoch: 2	Loss: 0.498187
Client Index = 2	Epoch: 3	Loss: 0.511876
Client Index = 2	Epoch: 4	Loss: 0.410113
test acc on this client after 403 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 3
local mask changes: 2463488.0 / 11173962
choose client_indexes: [ 3 12 14 16 17], accoring to random
choose mask diff: [2463488.0, 2570008.0, 2566482.0, 2564630.0, 2565742.0]
Doing local aggregation!
test acc on this client before 305 / 504 : 0.61
Client Index = 3	Epoch: 0	Loss: 0.889864
Client Index = 3	Epoch: 1	Loss: 0.803868
Client Index = 3	Epoch: 2	Loss: 0.841284
Client Index = 3	Epoch: 3	Loss: 0.811485
Client Index = 3	Epoch: 4	Loss: 0.707974
test acc on this client after 346 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 4
local mask changes: 2461786.0 / 11173962
choose client_indexes: [ 0  1  2  4 18], accoring to random
choose mask diff: [2561872.0, 2569144.0, 2566892.0, 2461786.0, 2565432.0]
Doing local aggregation!
test acc on this client before 235 / 503 : 0.47
Client Index = 4	Epoch: 0	Loss: 0.770093
Client Index = 4	Epoch: 1	Loss: 0.617124
Client Index = 4	Epoch: 2	Loss: 0.569590
Client Index = 4	Epoch: 3	Loss: 0.545834
Client Index = 4	Epoch: 4	Loss: 0.495820
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 5
local mask changes: 2460398.0 / 11173962
choose client_indexes: [ 5  6  9 16 18], accoring to random
choose mask diff: [2460398.0, 2569516.0, 2565692.0, 2564018.0, 2568806.0]
Doing local aggregation!
test acc on this client before 291 / 504 : 0.58
Client Index = 5	Epoch: 0	Loss: 0.716226
Client Index = 5	Epoch: 1	Loss: 0.556769
Client Index = 5	Epoch: 2	Loss: 0.656241
Client Index = 5	Epoch: 3	Loss: 0.629097
Client Index = 5	Epoch: 4	Loss: 0.545736
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 6
local mask changes: 2461684.0 / 11173962
choose client_indexes: [ 1  6 12 13 19], accoring to random
choose mask diff: [2569188.0, 2461684.0, 2568106.0, 2567714.0, 2568160.0]
Doing local aggregation!
test acc on this client before 308 / 505 : 0.61
Client Index = 6	Epoch: 0	Loss: 1.068831
Client Index = 6	Epoch: 1	Loss: 0.915735
Client Index = 6	Epoch: 2	Loss: 0.943551
Client Index = 6	Epoch: 3	Loss: 0.887699
Client Index = 6	Epoch: 4	Loss: 0.921579
test acc on this client after 342 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 7
local mask changes: 2462808.0 / 11173962
choose client_indexes: [ 0  1  6  7 15], accoring to random
choose mask diff: [2566446.0, 2570228.0, 2570996.0, 2462808.0, 2566540.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.841161
Client Index = 7	Epoch: 1	Loss: 0.783694
Client Index = 7	Epoch: 2	Loss: 0.687079
Client Index = 7	Epoch: 3	Loss: 0.709643
Client Index = 7	Epoch: 4	Loss: 0.626403
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 8
local mask changes: 2463542.0 / 11173962
choose client_indexes: [ 6  8 11 18 19], accoring to random
choose mask diff: [2565856.0, 2463542.0, 2569654.0, 2568446.0, 2569774.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 8	Epoch: 0	Loss: 0.963232
Client Index = 8	Epoch: 1	Loss: 0.787036
Client Index = 8	Epoch: 2	Loss: 0.843721
Client Index = 8	Epoch: 3	Loss: 0.781243
Client Index = 8	Epoch: 4	Loss: 0.767390
test acc on this client after 296 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 9
local mask changes: 2459826.0 / 11173962
choose client_indexes: [ 0  9 12 18 19], accoring to random
choose mask diff: [2571176.0, 2459826.0, 2566132.0, 2565032.0, 2566618.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 9	Epoch: 0	Loss: 0.734874
Client Index = 9	Epoch: 1	Loss: 0.625715
Client Index = 9	Epoch: 2	Loss: 0.633108
Client Index = 9	Epoch: 3	Loss: 0.557070
Client Index = 9	Epoch: 4	Loss: 0.568323
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 10
local mask changes: 2461580.0 / 11173962
choose client_indexes: [ 0  3 10 17 19], accoring to random
choose mask diff: [2568564.0, 2565882.0, 2461580.0, 2565468.0, 2567616.0]
Doing local aggregation!
test acc on this client before 303 / 503 : 0.60
Client Index = 10	Epoch: 0	Loss: 0.870637
Client Index = 10	Epoch: 1	Loss: 0.864836
Client Index = 10	Epoch: 2	Loss: 0.852847
Client Index = 10	Epoch: 3	Loss: 0.760528
Client Index = 10	Epoch: 4	Loss: 0.726107
test acc on this client after 332 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 11
local mask changes: 2463388.0 / 11173962
choose client_indexes: [10 11 12 15 19], accoring to random
choose mask diff: [2567668.0, 2463388.0, 2568894.0, 2562864.0, 2567632.0]
Doing local aggregation!
test acc on this client before 322 / 504 : 0.64
Client Index = 11	Epoch: 0	Loss: 0.657351
Client Index = 11	Epoch: 1	Loss: 0.457315
Client Index = 11	Epoch: 2	Loss: 0.525860
Client Index = 11	Epoch: 3	Loss: 0.413750
Client Index = 11	Epoch: 4	Loss: 0.513492
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 12
local mask changes: 2460426.0 / 11173962
choose client_indexes: [ 3 12 13 15 19], accoring to random
choose mask diff: [2569472.0, 2460426.0, 2568192.0, 2566334.0, 2565852.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.799457
Client Index = 12	Epoch: 1	Loss: 0.659923
Client Index = 12	Epoch: 2	Loss: 0.633772
Client Index = 12	Epoch: 3	Loss: 0.707690
Client Index = 12	Epoch: 4	Loss: 0.622159
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 13
local mask changes: 2462216.0 / 11173962
choose client_indexes: [ 2  7  8 13 18], accoring to random
choose mask diff: [2565662.0, 2564276.0, 2569184.0, 2462216.0, 2566056.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 13	Epoch: 0	Loss: 0.779913
Client Index = 13	Epoch: 1	Loss: 0.729974
Client Index = 13	Epoch: 2	Loss: 0.720994
Client Index = 13	Epoch: 3	Loss: 0.714646
Client Index = 13	Epoch: 4	Loss: 0.644665
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 14
local mask changes: 2462154.0 / 11173962
choose client_indexes: [ 4  8 12 14 18], accoring to random
choose mask diff: [2568970.0, 2563088.0, 2567660.0, 2462154.0, 2569498.0]
Doing local aggregation!
test acc on this client before 351 / 502 : 0.70
Client Index = 14	Epoch: 0	Loss: 0.879104
Client Index = 14	Epoch: 1	Loss: 0.789962
Client Index = 14	Epoch: 2	Loss: 0.773159
Client Index = 14	Epoch: 3	Loss: 0.774304
Client Index = 14	Epoch: 4	Loss: 0.754317
test acc on this client after 336 / 502 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 15
local mask changes: 2462430.0 / 11173962
choose client_indexes: [ 1 11 12 13 15], accoring to random
choose mask diff: [2568406.0, 2568006.0, 2565850.0, 2559896.0, 2462430.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 15	Epoch: 0	Loss: 0.655823
Client Index = 15	Epoch: 1	Loss: 0.616182
Client Index = 15	Epoch: 2	Loss: 0.646456
Client Index = 15	Epoch: 3	Loss: 0.578298
Client Index = 15	Epoch: 4	Loss: 0.552332
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 16
local mask changes: 2462912.0 / 11173962
choose client_indexes: [ 1 12 16 17 18], accoring to random
choose mask diff: [2569618.0, 2571298.0, 2462912.0, 2570082.0, 2569534.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 16	Epoch: 0	Loss: 0.762015
Client Index = 16	Epoch: 1	Loss: 0.639603
Client Index = 16	Epoch: 2	Loss: 0.633300
Client Index = 16	Epoch: 3	Loss: 0.582391
Client Index = 16	Epoch: 4	Loss: 0.601206
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 17
local mask changes: 2461810.0 / 11173962
choose client_indexes: [ 0 11 14 16 17], accoring to random
choose mask diff: [2568144.0, 2567036.0, 2566690.0, 2570240.0, 2461810.0]
Doing local aggregation!
test acc on this client before 281 / 505 : 0.56
Client Index = 17	Epoch: 0	Loss: 0.721735
Client Index = 17	Epoch: 1	Loss: 0.632582
Client Index = 17	Epoch: 2	Loss: 0.568849
Client Index = 17	Epoch: 3	Loss: 0.527265
Client Index = 17	Epoch: 4	Loss: 0.486382
test acc on this client after 405 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 18
local mask changes: 2460590.0 / 11173962
choose client_indexes: [ 2 10 13 16 18], accoring to random
choose mask diff: [2561248.0, 2567114.0, 2569314.0, 2569068.0, 2460590.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.572990
Client Index = 18	Epoch: 1	Loss: 0.498116
Client Index = 18	Epoch: 2	Loss: 0.467554
Client Index = 18	Epoch: 3	Loss: 0.454100
Client Index = 18	Epoch: 4	Loss: 0.417579
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(32) with spasity 0.5: 19
local mask changes: 2461860.0 / 11173962
choose client_indexes: [ 7  8  9 10 19], accoring to random
choose mask diff: [2567956.0, 2568854.0, 2567570.0, 2566378.0, 2461860.0]
Doing local aggregation!
test acc on this client before 298 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 0.685161
Client Index = 19	Epoch: 1	Loss: 0.657114
Client Index = 19	Epoch: 2	Loss: 0.678964
Client Index = 19	Epoch: 3	Loss: 0.619468
Client Index = 19	Epoch: 4	Loss: 0.628714
test acc on this client after 377 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 32
{'test_acc': 0.7249663473513442, 'test_loss': 0.8188169647694041}
################local_test_on_all_clients before local training in communication round: 32
{'test_acc': 0.6349629327005434, 'test_loss': 1.052989441466239}
################Communication round : 33
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 0
local mask changes: 2431484.0 / 11173962
choose client_indexes: [ 0  6  9 15 18], accoring to random
choose mask diff: [2431484.0, 2542428.0, 2542434.0, 2537764.0, 2541582.0]
Doing local aggregation!
test acc on this client before 271 / 504 : 0.54
Client Index = 0	Epoch: 0	Loss: 1.014362
Client Index = 0	Epoch: 1	Loss: 0.937214
Client Index = 0	Epoch: 2	Loss: 0.906903
Client Index = 0	Epoch: 3	Loss: 0.931600
Client Index = 0	Epoch: 4	Loss: 0.876986
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 1
local mask changes: 2430796.0 / 11173962
choose client_indexes: [ 1  7 10 16 19], accoring to random
choose mask diff: [2430796.0, 2545548.0, 2540728.0, 2544838.0, 2545544.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 1	Epoch: 0	Loss: 0.604941
Client Index = 1	Epoch: 1	Loss: 0.596958
Client Index = 1	Epoch: 2	Loss: 0.463687
Client Index = 1	Epoch: 3	Loss: 0.509260
Client Index = 1	Epoch: 4	Loss: 0.427388
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 2
local mask changes: 2431346.0 / 11173962
choose client_indexes: [ 2  5  9 12 15], accoring to random
choose mask diff: [2431346.0, 2539464.0, 2546642.0, 2547536.0, 2543000.0]
Doing local aggregation!
test acc on this client before 334 / 502 : 0.67
Client Index = 2	Epoch: 0	Loss: 0.647591
Client Index = 2	Epoch: 1	Loss: 0.553898
Client Index = 2	Epoch: 2	Loss: 0.494742
Client Index = 2	Epoch: 3	Loss: 0.464181
Client Index = 2	Epoch: 4	Loss: 0.429886
test acc on this client after 396 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 3
local mask changes: 2431106.0 / 11173962
choose client_indexes: [ 1  3 13 17 19], accoring to random
choose mask diff: [2545700.0, 2431106.0, 2545974.0, 2540088.0, 2542108.0]
Doing local aggregation!
test acc on this client before 290 / 504 : 0.58
Client Index = 3	Epoch: 0	Loss: 0.924669
Client Index = 3	Epoch: 1	Loss: 0.865738
Client Index = 3	Epoch: 2	Loss: 0.790800
Client Index = 3	Epoch: 3	Loss: 0.792750
Client Index = 3	Epoch: 4	Loss: 0.721305
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 4
local mask changes: 2430524.0 / 11173962
choose client_indexes: [ 4  5  6 11 16], accoring to random
choose mask diff: [2430524.0, 2544818.0, 2543458.0, 2544740.0, 2545194.0]
Doing local aggregation!
test acc on this client before 302 / 503 : 0.60
Client Index = 4	Epoch: 0	Loss: 0.689002
Client Index = 4	Epoch: 1	Loss: 0.549411
Client Index = 4	Epoch: 2	Loss: 0.566959
Client Index = 4	Epoch: 3	Loss: 0.524644
Client Index = 4	Epoch: 4	Loss: 0.525534
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 5
local mask changes: 2431410.0 / 11173962
choose client_indexes: [ 0  5  7 12 18], accoring to random
choose mask diff: [2546158.0, 2431410.0, 2541022.0, 2542432.0, 2538842.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.705645
Client Index = 5	Epoch: 1	Loss: 0.690289
Client Index = 5	Epoch: 2	Loss: 0.593754
Client Index = 5	Epoch: 3	Loss: 0.575761
Client Index = 5	Epoch: 4	Loss: 0.617859
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 6
local mask changes: 2431842.0 / 11173962
choose client_indexes: [ 4  6 10 16 18], accoring to random
choose mask diff: [2541268.0, 2431842.0, 2544520.0, 2543946.0, 2543652.0]
Doing local aggregation!
test acc on this client before 334 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 1.001312
Client Index = 6	Epoch: 1	Loss: 0.908553
Client Index = 6	Epoch: 2	Loss: 0.923869
Client Index = 6	Epoch: 3	Loss: 0.858569
Client Index = 6	Epoch: 4	Loss: 0.854460
test acc on this client after 271 / 505 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 7
local mask changes: 2430958.0 / 11173962
choose client_indexes: [ 2  3  7 11 14], accoring to random
choose mask diff: [2543030.0, 2545252.0, 2430958.0, 2546144.0, 2546920.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 7	Epoch: 0	Loss: 0.871819
Client Index = 7	Epoch: 1	Loss: 0.742491
Client Index = 7	Epoch: 2	Loss: 0.731391
Client Index = 7	Epoch: 3	Loss: 0.720542
Client Index = 7	Epoch: 4	Loss: 0.683968
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 8
local mask changes: 2431026.0 / 11173962
choose client_indexes: [ 0  8 12 17 18], accoring to random
choose mask diff: [2545978.0, 2431026.0, 2544958.0, 2545948.0, 2539752.0]
Doing local aggregation!
test acc on this client before 299 / 504 : 0.59
Client Index = 8	Epoch: 0	Loss: 0.959891
Client Index = 8	Epoch: 1	Loss: 0.900387
Client Index = 8	Epoch: 2	Loss: 0.783946
Client Index = 8	Epoch: 3	Loss: 0.773226
Client Index = 8	Epoch: 4	Loss: 0.814089
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 9
local mask changes: 2432856.0 / 11173962
choose client_indexes: [ 7  9 10 12 18], accoring to random
choose mask diff: [2543756.0, 2432856.0, 2543934.0, 2539500.0, 2537614.0]
Doing local aggregation!
test acc on this client before 341 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.711542
Client Index = 9	Epoch: 1	Loss: 0.557133
Client Index = 9	Epoch: 2	Loss: 0.604661
Client Index = 9	Epoch: 3	Loss: 0.558894
Client Index = 9	Epoch: 4	Loss: 0.511899
test acc on this client after 363 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 10
local mask changes: 2432782.0 / 11173962
choose client_indexes: [ 0  5  8 10 14], accoring to random
choose mask diff: [2542310.0, 2544578.0, 2543442.0, 2432782.0, 2546076.0]
Doing local aggregation!
test acc on this client before 315 / 503 : 0.63
Client Index = 10	Epoch: 0	Loss: 0.839817
Client Index = 10	Epoch: 1	Loss: 0.794594
Client Index = 10	Epoch: 2	Loss: 0.884799
Client Index = 10	Epoch: 3	Loss: 0.773803
Client Index = 10	Epoch: 4	Loss: 0.692867
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 11
local mask changes: 2430636.0 / 11173962
choose client_indexes: [ 7  8 10 11 17], accoring to random
choose mask diff: [2543970.0, 2546200.0, 2542534.0, 2430636.0, 2544846.0]
Doing local aggregation!
test acc on this client before 351 / 504 : 0.70
Client Index = 11	Epoch: 0	Loss: 0.606162
Client Index = 11	Epoch: 1	Loss: 0.473554
Client Index = 11	Epoch: 2	Loss: 0.450385
Client Index = 11	Epoch: 3	Loss: 0.481545
Client Index = 11	Epoch: 4	Loss: 0.378251
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 12
local mask changes: 2430584.0 / 11173962
choose client_indexes: [ 0  8 12 15 18], accoring to random
choose mask diff: [2542644.0, 2547216.0, 2430584.0, 2538992.0, 2542286.0]
Doing local aggregation!
test acc on this client before 362 / 504 : 0.72
Client Index = 12	Epoch: 0	Loss: 0.764326
Client Index = 12	Epoch: 1	Loss: 0.650402
Client Index = 12	Epoch: 2	Loss: 0.690710
Client Index = 12	Epoch: 3	Loss: 0.593770
Client Index = 12	Epoch: 4	Loss: 0.640365
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 13
local mask changes: 2430410.0 / 11173962
choose client_indexes: [ 5  7  9 13 15], accoring to random
choose mask diff: [2543662.0, 2538050.0, 2541812.0, 2430410.0, 2537934.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.747047
Client Index = 13	Epoch: 1	Loss: 0.774492
Client Index = 13	Epoch: 2	Loss: 0.708275
Client Index = 13	Epoch: 3	Loss: 0.677250
Client Index = 13	Epoch: 4	Loss: 0.644826
test acc on this client after 330 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 14
local mask changes: 2430902.0 / 11173962
choose client_indexes: [ 3  4 14 15 18], accoring to random
choose mask diff: [2543052.0, 2540844.0, 2430902.0, 2543832.0, 2541056.0]
Doing local aggregation!
test acc on this client before 355 / 502 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.852958
Client Index = 14	Epoch: 1	Loss: 0.759528
Client Index = 14	Epoch: 2	Loss: 0.829635
Client Index = 14	Epoch: 3	Loss: 0.710263
Client Index = 14	Epoch: 4	Loss: 0.755740
test acc on this client after 347 / 502 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 15
local mask changes: 2428866.0 / 11173962
choose client_indexes: [ 8  9 10 11 15], accoring to random
choose mask diff: [2541838.0, 2539118.0, 2544948.0, 2537110.0, 2428866.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 15	Epoch: 0	Loss: 0.683547
Client Index = 15	Epoch: 1	Loss: 0.598388
Client Index = 15	Epoch: 2	Loss: 0.631021
Client Index = 15	Epoch: 3	Loss: 0.628827
Client Index = 15	Epoch: 4	Loss: 0.582910
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 16
local mask changes: 2430166.0 / 11173962
choose client_indexes: [ 0 12 13 16 17], accoring to random
choose mask diff: [2543372.0, 2541790.0, 2545604.0, 2430166.0, 2542564.0]
Doing local aggregation!
test acc on this client before 290 / 503 : 0.58
Client Index = 16	Epoch: 0	Loss: 0.824492
Client Index = 16	Epoch: 1	Loss: 0.608729
Client Index = 16	Epoch: 2	Loss: 0.602417
Client Index = 16	Epoch: 3	Loss: 0.538408
Client Index = 16	Epoch: 4	Loss: 0.571314
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 17
local mask changes: 2431728.0 / 11173962
choose client_indexes: [ 3  7  8 16 17], accoring to random
choose mask diff: [2542250.0, 2546038.0, 2543168.0, 2540912.0, 2431728.0]
Doing local aggregation!
test acc on this client before 303 / 505 : 0.60
Client Index = 17	Epoch: 0	Loss: 0.725525
Client Index = 17	Epoch: 1	Loss: 0.520862
Client Index = 17	Epoch: 2	Loss: 0.508979
Client Index = 17	Epoch: 3	Loss: 0.496857
Client Index = 17	Epoch: 4	Loss: 0.463672
test acc on this client after 320 / 505 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 18
local mask changes: 2431216.0 / 11173962
choose client_indexes: [ 0  2  4 13 18], accoring to random
choose mask diff: [2543326.0, 2535680.0, 2544320.0, 2539008.0, 2431216.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.571783
Client Index = 18	Epoch: 1	Loss: 0.453685
Client Index = 18	Epoch: 2	Loss: 0.470635
Client Index = 18	Epoch: 3	Loss: 0.461238
Client Index = 18	Epoch: 4	Loss: 0.402701
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(33) with spasity 0.5: 19
local mask changes: 2430446.0 / 11173962
choose client_indexes: [14 16 17 18 19], accoring to random
choose mask diff: [2544656.0, 2542440.0, 2546292.0, 2541162.0, 2430446.0]
Doing local aggregation!
test acc on this client before 365 / 506 : 0.72
Client Index = 19	Epoch: 0	Loss: 0.686250
Client Index = 19	Epoch: 1	Loss: 0.640025
Client Index = 19	Epoch: 2	Loss: 0.607822
Client Index = 19	Epoch: 3	Loss: 0.641054
Client Index = 19	Epoch: 4	Loss: 0.664349
test acc on this client after 312 / 506 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 33
{'test_acc': 0.7079566253980413, 'test_loss': 0.8838310085497219}
################local_test_on_all_clients before local training in communication round: 33
{'test_acc': 0.6594537134051718, 'test_loss': 0.969579767700641}
################Communication round : 34
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 0
local mask changes: 2400296.0 / 11173962
choose client_indexes: [ 0  1  8 11 17], accoring to random
choose mask diff: [2400296.0, 2517334.0, 2520858.0, 2519134.0, 2517262.0]
Doing local aggregation!
test acc on this client before 293 / 504 : 0.58
Client Index = 0	Epoch: 0	Loss: 0.964315
Client Index = 0	Epoch: 1	Loss: 0.916029
Client Index = 0	Epoch: 2	Loss: 0.902717
Client Index = 0	Epoch: 3	Loss: 0.892523
Client Index = 0	Epoch: 4	Loss: 0.919909
test acc on this client after 262 / 504 : 0.52
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 1
local mask changes: 2399356.0 / 11173962
choose client_indexes: [ 1  4  5 13 14], accoring to random
choose mask diff: [2399356.0, 2518134.0, 2519304.0, 2518398.0, 2517926.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.756998
Client Index = 1	Epoch: 1	Loss: 0.530134
Client Index = 1	Epoch: 2	Loss: 0.422475
Client Index = 1	Epoch: 3	Loss: 0.513006
Client Index = 1	Epoch: 4	Loss: 0.515188
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 2
local mask changes: 2399652.0 / 11173962
choose client_indexes: [ 2  8  9 13 18], accoring to random
choose mask diff: [2399652.0, 2515774.0, 2515154.0, 2514740.0, 2513828.0]
Doing local aggregation!
test acc on this client before 344 / 502 : 0.69
Client Index = 2	Epoch: 0	Loss: 0.602647
Client Index = 2	Epoch: 1	Loss: 0.590506
Client Index = 2	Epoch: 2	Loss: 0.503466
Client Index = 2	Epoch: 3	Loss: 0.426725
Client Index = 2	Epoch: 4	Loss: 0.448312
test acc on this client after 415 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 3
local mask changes: 2399146.0 / 11173962
choose client_indexes: [ 1  3  4 16 19], accoring to random
choose mask diff: [2516470.0, 2399146.0, 2520896.0, 2513314.0, 2514984.0]
Doing local aggregation!
test acc on this client before 305 / 504 : 0.61
Client Index = 3	Epoch: 0	Loss: 0.861723
Client Index = 3	Epoch: 1	Loss: 0.806024
Client Index = 3	Epoch: 2	Loss: 0.753545
Client Index = 3	Epoch: 3	Loss: 0.721852
Client Index = 3	Epoch: 4	Loss: 0.739699
test acc on this client after 309 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 4
local mask changes: 2399574.0 / 11173962
choose client_indexes: [ 4  7 11 13 16], accoring to random
choose mask diff: [2399574.0, 2519550.0, 2516888.0, 2518634.0, 2517298.0]
Doing local aggregation!
test acc on this client before 263 / 503 : 0.52
Client Index = 4	Epoch: 0	Loss: 0.792620
Client Index = 4	Epoch: 1	Loss: 0.610607
Client Index = 4	Epoch: 2	Loss: 0.547516
Client Index = 4	Epoch: 3	Loss: 0.483489
Client Index = 4	Epoch: 4	Loss: 0.573457
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 5
local mask changes: 2399464.0 / 11173962
choose client_indexes: [ 2  4  5 15 19], accoring to random
choose mask diff: [2515564.0, 2520186.0, 2399464.0, 2516832.0, 2517068.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 5	Epoch: 0	Loss: 0.722996
Client Index = 5	Epoch: 1	Loss: 0.572338
Client Index = 5	Epoch: 2	Loss: 0.561489
Client Index = 5	Epoch: 3	Loss: 0.562234
Client Index = 5	Epoch: 4	Loss: 0.540261
test acc on this client after 323 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 6
local mask changes: 2398744.0 / 11173962
choose client_indexes: [ 4  5  6  9 19], accoring to random
choose mask diff: [2513848.0, 2517204.0, 2398744.0, 2522822.0, 2516396.0]
Doing local aggregation!
test acc on this client before 297 / 505 : 0.59
Client Index = 6	Epoch: 0	Loss: 0.990415
Client Index = 6	Epoch: 1	Loss: 0.963985
Client Index = 6	Epoch: 2	Loss: 0.855762
Client Index = 6	Epoch: 3	Loss: 0.915413
Client Index = 6	Epoch: 4	Loss: 0.822716
test acc on this client after 332 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 7
local mask changes: 2400536.0 / 11173962
choose client_indexes: [ 6  7  8 14 19], accoring to random
choose mask diff: [2515754.0, 2400536.0, 2517432.0, 2517620.0, 2519150.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 7	Epoch: 0	Loss: 0.818552
Client Index = 7	Epoch: 1	Loss: 0.738197
Client Index = 7	Epoch: 2	Loss: 0.677452
Client Index = 7	Epoch: 3	Loss: 0.714352
Client Index = 7	Epoch: 4	Loss: 0.693831
test acc on this client after 315 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 8
local mask changes: 2399078.0 / 11173962
choose client_indexes: [ 0  2  4  8 19], accoring to random
choose mask diff: [2517782.0, 2513786.0, 2520394.0, 2399078.0, 2517454.0]
Doing local aggregation!
test acc on this client before 321 / 504 : 0.64
Client Index = 8	Epoch: 0	Loss: 0.883516
Client Index = 8	Epoch: 1	Loss: 0.840042
Client Index = 8	Epoch: 2	Loss: 0.803778
Client Index = 8	Epoch: 3	Loss: 0.712185
Client Index = 8	Epoch: 4	Loss: 0.750401
test acc on this client after 210 / 504 : 0.42
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 9
local mask changes: 2399832.0 / 11173962
choose client_indexes: [ 1  5  9 12 19], accoring to random
choose mask diff: [2520268.0, 2514352.0, 2399832.0, 2512682.0, 2514546.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.711908
Client Index = 9	Epoch: 1	Loss: 0.549873
Client Index = 9	Epoch: 2	Loss: 0.581359
Client Index = 9	Epoch: 3	Loss: 0.571477
Client Index = 9	Epoch: 4	Loss: 0.471313
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 10
local mask changes: 2398778.0 / 11173962
choose client_indexes: [ 5  7  8  9 10], accoring to random
choose mask diff: [2515286.0, 2521616.0, 2516474.0, 2518642.0, 2398778.0]
Doing local aggregation!
test acc on this client before 336 / 503 : 0.67
Client Index = 10	Epoch: 0	Loss: 0.897769
Client Index = 10	Epoch: 1	Loss: 0.731121
Client Index = 10	Epoch: 2	Loss: 0.728270
Client Index = 10	Epoch: 3	Loss: 0.757223
Client Index = 10	Epoch: 4	Loss: 0.689448
test acc on this client after 313 / 503 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 11
local mask changes: 2401230.0 / 11173962
choose client_indexes: [ 2  7 11 14 15], accoring to random
choose mask diff: [2519926.0, 2517422.0, 2401230.0, 2514528.0, 2513234.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.587057
Client Index = 11	Epoch: 1	Loss: 0.475115
Client Index = 11	Epoch: 2	Loss: 0.451047
Client Index = 11	Epoch: 3	Loss: 0.475428
Client Index = 11	Epoch: 4	Loss: 0.377797
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 12
local mask changes: 2399320.0 / 11173962
choose client_indexes: [ 0  4  6 12 13], accoring to random
choose mask diff: [2513388.0, 2517792.0, 2518510.0, 2399320.0, 2517008.0]
Doing local aggregation!
test acc on this client before 340 / 504 : 0.67
Client Index = 12	Epoch: 0	Loss: 0.745274
Client Index = 12	Epoch: 1	Loss: 0.665756
Client Index = 12	Epoch: 2	Loss: 0.596378
Client Index = 12	Epoch: 3	Loss: 0.621985
Client Index = 12	Epoch: 4	Loss: 0.662700
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 13
local mask changes: 2400400.0 / 11173962
choose client_indexes: [ 8 13 14 16 19], accoring to random
choose mask diff: [2518172.0, 2400400.0, 2519960.0, 2521480.0, 2519860.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.793426
Client Index = 13	Epoch: 1	Loss: 0.757675
Client Index = 13	Epoch: 2	Loss: 0.656831
Client Index = 13	Epoch: 3	Loss: 0.693012
Client Index = 13	Epoch: 4	Loss: 0.672525
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 14
local mask changes: 2401518.0 / 11173962
choose client_indexes: [ 6  9 11 14 18], accoring to random
choose mask diff: [2517066.0, 2519222.0, 2515202.0, 2401518.0, 2514654.0]
Doing local aggregation!
test acc on this client before 354 / 502 : 0.71
Client Index = 14	Epoch: 0	Loss: 0.852440
Client Index = 14	Epoch: 1	Loss: 0.712701
Client Index = 14	Epoch: 2	Loss: 0.752736
Client Index = 14	Epoch: 3	Loss: 0.726682
Client Index = 14	Epoch: 4	Loss: 0.716149
test acc on this client after 364 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 15
local mask changes: 2398998.0 / 11173962
choose client_indexes: [ 0  7  8 11 15], accoring to random
choose mask diff: [2516290.0, 2517104.0, 2514538.0, 2508614.0, 2398998.0]
Doing local aggregation!
test acc on this client before 315 / 504 : 0.62
Client Index = 15	Epoch: 0	Loss: 0.612837
Client Index = 15	Epoch: 1	Loss: 0.632970
Client Index = 15	Epoch: 2	Loss: 0.594090
Client Index = 15	Epoch: 3	Loss: 0.539804
Client Index = 15	Epoch: 4	Loss: 0.524599
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 16
local mask changes: 2399732.0 / 11173962
choose client_indexes: [ 0 11 13 15 16], accoring to random
choose mask diff: [2515426.0, 2518070.0, 2516108.0, 2514812.0, 2399732.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 16	Epoch: 0	Loss: 0.710568
Client Index = 16	Epoch: 1	Loss: 0.582480
Client Index = 16	Epoch: 2	Loss: 0.619977
Client Index = 16	Epoch: 3	Loss: 0.640460
Client Index = 16	Epoch: 4	Loss: 0.539835
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 17
local mask changes: 2400976.0 / 11173962
choose client_indexes: [ 0 11 15 17 19], accoring to random
choose mask diff: [2517082.0, 2518100.0, 2518436.0, 2400976.0, 2520972.0]
Doing local aggregation!
test acc on this client before 322 / 505 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.655978
Client Index = 17	Epoch: 1	Loss: 0.633670
Client Index = 17	Epoch: 2	Loss: 0.537846
Client Index = 17	Epoch: 3	Loss: 0.466013
Client Index = 17	Epoch: 4	Loss: 0.468832
test acc on this client after 413 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 18
local mask changes: 2398940.0 / 11173962
choose client_indexes: [ 3 10 12 15 18], accoring to random
choose mask diff: [2518886.0, 2518034.0, 2519148.0, 2517098.0, 2398940.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 18	Epoch: 0	Loss: 0.592604
Client Index = 18	Epoch: 1	Loss: 0.448234
Client Index = 18	Epoch: 2	Loss: 0.469776
Client Index = 18	Epoch: 3	Loss: 0.445938
Client Index = 18	Epoch: 4	Loss: 0.377832
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(34) with spasity 0.5: 19
local mask changes: 2399820.0 / 11173962
choose client_indexes: [ 3  7 14 18 19], accoring to random
choose mask diff: [2517080.0, 2519498.0, 2514052.0, 2513670.0, 2399820.0]
Doing local aggregation!
test acc on this client before 300 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 0.726022
Client Index = 19	Epoch: 1	Loss: 0.635817
Client Index = 19	Epoch: 2	Loss: 0.609774
Client Index = 19	Epoch: 3	Loss: 0.556088
Client Index = 19	Epoch: 4	Loss: 0.563206
test acc on this client after 388 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 34
{'test_acc': 0.7022597855074356, 'test_loss': 0.8730115791920191}
################local_test_on_all_clients before local training in communication round: 34
{'test_acc': 0.6590914413664629, 'test_loss': 0.9970250974571593}
################Communication round : 35
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 0
local mask changes: 2366960.0 / 11173962
choose client_indexes: [ 0  6 14 17 18], accoring to random
choose mask diff: [2366960.0, 2489706.0, 2492430.0, 2489780.0, 2487928.0]
Doing local aggregation!
test acc on this client before 300 / 504 : 0.60
Client Index = 0	Epoch: 0	Loss: 0.934534
Client Index = 0	Epoch: 1	Loss: 0.895175
Client Index = 0	Epoch: 2	Loss: 0.808461
Client Index = 0	Epoch: 3	Loss: 0.831150
Client Index = 0	Epoch: 4	Loss: 0.862828
test acc on this client after 324 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 1
local mask changes: 2365974.0 / 11173962
choose client_indexes: [ 1  3 11 14 16], accoring to random
choose mask diff: [2365974.0, 2491478.0, 2491362.0, 2489778.0, 2489942.0]
Doing local aggregation!
test acc on this client before 275 / 503 : 0.55
Client Index = 1	Epoch: 0	Loss: 0.714210
Client Index = 1	Epoch: 1	Loss: 0.502130
Client Index = 1	Epoch: 2	Loss: 0.465906
Client Index = 1	Epoch: 3	Loss: 0.460998
Client Index = 1	Epoch: 4	Loss: 0.440561
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 2
local mask changes: 2366958.0 / 11173962
choose client_indexes: [ 2  7 13 17 19], accoring to random
choose mask diff: [2366958.0, 2491112.0, 2484650.0, 2495034.0, 2495636.0]
Doing local aggregation!
test acc on this client before 388 / 502 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.608277
Client Index = 2	Epoch: 1	Loss: 0.481949
Client Index = 2	Epoch: 2	Loss: 0.453009
Client Index = 2	Epoch: 3	Loss: 0.612989
Client Index = 2	Epoch: 4	Loss: 0.396273
test acc on this client after 413 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 3
local mask changes: 2366446.0 / 11173962
choose client_indexes: [ 3  7  9 15 18], accoring to random
choose mask diff: [2366446.0, 2494182.0, 2496180.0, 2495846.0, 2494514.0]
Doing local aggregation!
test acc on this client before 279 / 504 : 0.55
Client Index = 3	Epoch: 0	Loss: 0.869972
Client Index = 3	Epoch: 1	Loss: 0.768520
Client Index = 3	Epoch: 2	Loss: 0.783271
Client Index = 3	Epoch: 3	Loss: 0.723931
Client Index = 3	Epoch: 4	Loss: 0.751009
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 4
local mask changes: 2366652.0 / 11173962
choose client_indexes: [ 1  2  4  7 12], accoring to random
choose mask diff: [2492250.0, 2492218.0, 2366652.0, 2489566.0, 2492820.0]
Doing local aggregation!
test acc on this client before 275 / 503 : 0.55
Client Index = 4	Epoch: 0	Loss: 0.642350
Client Index = 4	Epoch: 1	Loss: 0.550629
Client Index = 4	Epoch: 2	Loss: 0.535585
Client Index = 4	Epoch: 3	Loss: 0.537251
Client Index = 4	Epoch: 4	Loss: 0.472755
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 5
local mask changes: 2369302.0 / 11173962
choose client_indexes: [ 4  5 11 12 13], accoring to random
choose mask diff: [2485652.0, 2369302.0, 2492850.0, 2488172.0, 2489160.0]
Doing local aggregation!
test acc on this client before 257 / 504 : 0.51
Client Index = 5	Epoch: 0	Loss: 0.701197
Client Index = 5	Epoch: 1	Loss: 0.599311
Client Index = 5	Epoch: 2	Loss: 0.654304
Client Index = 5	Epoch: 3	Loss: 0.557811
Client Index = 5	Epoch: 4	Loss: 0.535604
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 6
local mask changes: 2367866.0 / 11173962
choose client_indexes: [ 5  6  8 15 17], accoring to random
choose mask diff: [2488586.0, 2367866.0, 2489920.0, 2495226.0, 2492296.0]
Doing local aggregation!
test acc on this client before 310 / 505 : 0.61
Client Index = 6	Epoch: 0	Loss: 0.957751
Client Index = 6	Epoch: 1	Loss: 0.871139
Client Index = 6	Epoch: 2	Loss: 0.838732
Client Index = 6	Epoch: 3	Loss: 0.907234
Client Index = 6	Epoch: 4	Loss: 0.863125
test acc on this client after 346 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 7
local mask changes: 2367924.0 / 11173962
choose client_indexes: [ 0  2  7 16 17], accoring to random
choose mask diff: [2494106.0, 2492234.0, 2367924.0, 2493640.0, 2491016.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.823088
Client Index = 7	Epoch: 1	Loss: 0.699080
Client Index = 7	Epoch: 2	Loss: 0.710840
Client Index = 7	Epoch: 3	Loss: 0.642389
Client Index = 7	Epoch: 4	Loss: 0.622341
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 8
local mask changes: 2367422.0 / 11173962
choose client_indexes: [ 5  6  8  9 17], accoring to random
choose mask diff: [2488938.0, 2489980.0, 2367422.0, 2494488.0, 2491064.0]
Doing local aggregation!
test acc on this client before 319 / 504 : 0.63
Client Index = 8	Epoch: 0	Loss: 0.915833
Client Index = 8	Epoch: 1	Loss: 0.768309
Client Index = 8	Epoch: 2	Loss: 0.789251
Client Index = 8	Epoch: 3	Loss: 0.676549
Client Index = 8	Epoch: 4	Loss: 0.698584
test acc on this client after 310 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 9
local mask changes: 2366522.0 / 11173962
choose client_indexes: [ 3  4  8  9 18], accoring to random
choose mask diff: [2497118.0, 2494232.0, 2491296.0, 2366522.0, 2488164.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 9	Epoch: 0	Loss: 0.688169
Client Index = 9	Epoch: 1	Loss: 0.611254
Client Index = 9	Epoch: 2	Loss: 0.546257
Client Index = 9	Epoch: 3	Loss: 0.501601
Client Index = 9	Epoch: 4	Loss: 0.560401
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 10
local mask changes: 2365954.0 / 11173962
choose client_indexes: [ 6  8 10 12 15], accoring to random
choose mask diff: [2492410.0, 2487146.0, 2365954.0, 2493480.0, 2491488.0]
Doing local aggregation!
test acc on this client before 325 / 503 : 0.65
Client Index = 10	Epoch: 0	Loss: 0.808927
Client Index = 10	Epoch: 1	Loss: 0.787132
Client Index = 10	Epoch: 2	Loss: 0.720223
Client Index = 10	Epoch: 3	Loss: 0.712960
Client Index = 10	Epoch: 4	Loss: 0.805779
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 11
local mask changes: 2367596.0 / 11173962
choose client_indexes: [ 2 10 11 15 16], accoring to random
choose mask diff: [2488302.0, 2492190.0, 2367596.0, 2481204.0, 2492484.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.552963
Client Index = 11	Epoch: 1	Loss: 0.461669
Client Index = 11	Epoch: 2	Loss: 0.472634
Client Index = 11	Epoch: 3	Loss: 0.429830
Client Index = 11	Epoch: 4	Loss: 0.408218
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 12
local mask changes: 2367388.0 / 11173962
choose client_indexes: [ 7  8 11 12 18], accoring to random
choose mask diff: [2495402.0, 2489402.0, 2494376.0, 2367388.0, 2487656.0]
Doing local aggregation!
test acc on this client before 308 / 504 : 0.61
Client Index = 12	Epoch: 0	Loss: 0.828546
Client Index = 12	Epoch: 1	Loss: 0.604840
Client Index = 12	Epoch: 2	Loss: 0.631692
Client Index = 12	Epoch: 3	Loss: 0.598996
Client Index = 12	Epoch: 4	Loss: 0.586039
test acc on this client after 344 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 13
local mask changes: 2367072.0 / 11173962
choose client_indexes: [ 3 10 11 13 18], accoring to random
choose mask diff: [2491914.0, 2493732.0, 2494922.0, 2367072.0, 2485486.0]
Doing local aggregation!
test acc on this client before 332 / 503 : 0.66
Client Index = 13	Epoch: 0	Loss: 0.754835
Client Index = 13	Epoch: 1	Loss: 0.746779
Client Index = 13	Epoch: 2	Loss: 0.650467
Client Index = 13	Epoch: 3	Loss: 0.688384
Client Index = 13	Epoch: 4	Loss: 0.617092
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 14
local mask changes: 2367274.0 / 11173962
choose client_indexes: [ 0  3  7 14 17], accoring to random
choose mask diff: [2491954.0, 2489920.0, 2492880.0, 2367274.0, 2494772.0]
Doing local aggregation!
test acc on this client before 314 / 502 : 0.63
Client Index = 14	Epoch: 0	Loss: 0.768657
Client Index = 14	Epoch: 1	Loss: 0.760165
Client Index = 14	Epoch: 2	Loss: 0.754692
Client Index = 14	Epoch: 3	Loss: 0.738638
Client Index = 14	Epoch: 4	Loss: 0.659737
test acc on this client after 356 / 502 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 15
local mask changes: 2367622.0 / 11173962
choose client_indexes: [ 3  5  8 15 19], accoring to random
choose mask diff: [2495486.0, 2491940.0, 2484982.0, 2367622.0, 2493394.0]
Doing local aggregation!
test acc on this client before 314 / 504 : 0.62
Client Index = 15	Epoch: 0	Loss: 0.665218
Client Index = 15	Epoch: 1	Loss: 0.583550
Client Index = 15	Epoch: 2	Loss: 0.557625
Client Index = 15	Epoch: 3	Loss: 0.548175
Client Index = 15	Epoch: 4	Loss: 0.508510
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 16
local mask changes: 2365594.0 / 11173962
choose client_indexes: [ 0  3  9 16 18], accoring to random
choose mask diff: [2487716.0, 2491716.0, 2494576.0, 2365594.0, 2489466.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 16	Epoch: 0	Loss: 0.629220
Client Index = 16	Epoch: 1	Loss: 0.625424
Client Index = 16	Epoch: 2	Loss: 0.545618
Client Index = 16	Epoch: 3	Loss: 0.544706
Client Index = 16	Epoch: 4	Loss: 0.509263
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 17
local mask changes: 2366316.0 / 11173962
choose client_indexes: [ 7  9 11 12 17], accoring to random
choose mask diff: [2493198.0, 2494266.0, 2483704.0, 2493530.0, 2366316.0]
Doing local aggregation!
test acc on this client before 363 / 505 : 0.72
Client Index = 17	Epoch: 0	Loss: 0.723837
Client Index = 17	Epoch: 1	Loss: 0.545494
Client Index = 17	Epoch: 2	Loss: 0.479490
Client Index = 17	Epoch: 3	Loss: 0.508850
Client Index = 17	Epoch: 4	Loss: 0.494013
test acc on this client after 424 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 18
local mask changes: 2365772.0 / 11173962
choose client_indexes: [ 0  1  3 14 18], accoring to random
choose mask diff: [2485712.0, 2488340.0, 2489896.0, 2487208.0, 2365772.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.531626
Client Index = 18	Epoch: 1	Loss: 0.451514
Client Index = 18	Epoch: 2	Loss: 0.441678
Client Index = 18	Epoch: 3	Loss: 0.427804
Client Index = 18	Epoch: 4	Loss: 0.401074
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(35) with spasity 0.5: 19
local mask changes: 2368462.0 / 11173962
choose client_indexes: [ 2  5 10 13 19], accoring to random
choose mask diff: [2490974.0, 2493624.0, 2491062.0, 2492294.0, 2368462.0]
Doing local aggregation!
test acc on this client before 330 / 506 : 0.65
Client Index = 19	Epoch: 0	Loss: 0.702643
Client Index = 19	Epoch: 1	Loss: 0.595805
Client Index = 19	Epoch: 2	Loss: 0.558961
Client Index = 19	Epoch: 3	Loss: 0.624016
Client Index = 19	Epoch: 4	Loss: 0.504018
test acc on this client after 377 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 35
{'test_acc': 0.7365871405704072, 'test_loss': 0.7882753835232686}
################local_test_on_all_clients before local training in communication round: 35
{'test_acc': 0.6495336266533266, 'test_loss': 0.990244880024229}
################Communication round : 36
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 0
local mask changes: 2336014.0 / 11173962
choose client_indexes: [ 0  2  4 13 16], accoring to random
choose mask diff: [2336014.0, 2467084.0, 2464120.0, 2467278.0, 2461154.0]
Doing local aggregation!
test acc on this client before 275 / 504 : 0.55
Client Index = 0	Epoch: 0	Loss: 0.924457
Client Index = 0	Epoch: 1	Loss: 0.893515
Client Index = 0	Epoch: 2	Loss: 0.837505
Client Index = 0	Epoch: 3	Loss: 0.861201
Client Index = 0	Epoch: 4	Loss: 0.763436
test acc on this client after 330 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 1
local mask changes: 2333704.0 / 11173962
choose client_indexes: [ 1  3  6 12 13], accoring to random
choose mask diff: [2333704.0, 2459304.0, 2464890.0, 2466542.0, 2462516.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.717191
Client Index = 1	Epoch: 1	Loss: 0.495280
Client Index = 1	Epoch: 2	Loss: 0.515965
Client Index = 1	Epoch: 3	Loss: 0.419537
Client Index = 1	Epoch: 4	Loss: 0.445273
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 2
local mask changes: 2334102.0 / 11173962
choose client_indexes: [ 2  6 17 18 19], accoring to random
choose mask diff: [2334102.0, 2463674.0, 2462870.0, 2459016.0, 2461006.0]
Doing local aggregation!
test acc on this client before 327 / 502 : 0.65
Client Index = 2	Epoch: 0	Loss: 0.583563
Client Index = 2	Epoch: 1	Loss: 0.446477
Client Index = 2	Epoch: 2	Loss: 0.449726
Client Index = 2	Epoch: 3	Loss: 0.465379
Client Index = 2	Epoch: 4	Loss: 0.427095
test acc on this client after 412 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 3
local mask changes: 2332380.0 / 11173962
choose client_indexes: [ 3  5 10 13 18], accoring to random
choose mask diff: [2332380.0, 2466734.0, 2467522.0, 2465806.0, 2459818.0]
Doing local aggregation!
test acc on this client before 283 / 504 : 0.56
Client Index = 3	Epoch: 0	Loss: 0.881148
Client Index = 3	Epoch: 1	Loss: 0.795065
Client Index = 3	Epoch: 2	Loss: 0.761895
Client Index = 3	Epoch: 3	Loss: 0.693645
Client Index = 3	Epoch: 4	Loss: 0.637741
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 4
local mask changes: 2334596.0 / 11173962
choose client_indexes: [ 2  4 13 14 19], accoring to random
choose mask diff: [2461086.0, 2334596.0, 2459996.0, 2462652.0, 2464048.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.657527
Client Index = 4	Epoch: 1	Loss: 0.598051
Client Index = 4	Epoch: 2	Loss: 0.517267
Client Index = 4	Epoch: 3	Loss: 0.525313
Client Index = 4	Epoch: 4	Loss: 0.466452
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 5
local mask changes: 2332640.0 / 11173962
choose client_indexes: [ 3  5  7 11 14], accoring to random
choose mask diff: [2468946.0, 2332640.0, 2462488.0, 2461518.0, 2464472.0]
Doing local aggregation!
test acc on this client before 307 / 504 : 0.61
Client Index = 5	Epoch: 0	Loss: 0.710570
Client Index = 5	Epoch: 1	Loss: 0.565096
Client Index = 5	Epoch: 2	Loss: 0.556200
Client Index = 5	Epoch: 3	Loss: 0.526021
Client Index = 5	Epoch: 4	Loss: 0.570546
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 6
local mask changes: 2335418.0 / 11173962
choose client_indexes: [ 4  6 13 16 18], accoring to random
choose mask diff: [2458418.0, 2335418.0, 2467366.0, 2465156.0, 2466514.0]
Doing local aggregation!
test acc on this client before 331 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 0.946153
Client Index = 6	Epoch: 1	Loss: 0.935998
Client Index = 6	Epoch: 2	Loss: 0.821941
Client Index = 6	Epoch: 3	Loss: 0.849368
Client Index = 6	Epoch: 4	Loss: 0.821224
test acc on this client after 291 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 7
local mask changes: 2332620.0 / 11173962
choose client_indexes: [ 6  7  8  9 17], accoring to random
choose mask diff: [2463556.0, 2332620.0, 2461954.0, 2465970.0, 2461496.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 7	Epoch: 0	Loss: 0.716447
Client Index = 7	Epoch: 1	Loss: 0.738633
Client Index = 7	Epoch: 2	Loss: 0.632936
Client Index = 7	Epoch: 3	Loss: 0.617796
Client Index = 7	Epoch: 4	Loss: 0.593549
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 8
local mask changes: 2334622.0 / 11173962
choose client_indexes: [ 1  5  8 10 19], accoring to random
choose mask diff: [2465986.0, 2457872.0, 2334622.0, 2462988.0, 2463124.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 8	Epoch: 0	Loss: 0.838478
Client Index = 8	Epoch: 1	Loss: 0.790227
Client Index = 8	Epoch: 2	Loss: 0.656861
Client Index = 8	Epoch: 3	Loss: 0.765517
Client Index = 8	Epoch: 4	Loss: 0.718370
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 9
local mask changes: 2335046.0 / 11173962
choose client_indexes: [ 2  7  9 13 15], accoring to random
choose mask diff: [2464642.0, 2465724.0, 2335046.0, 2462846.0, 2460072.0]
Doing local aggregation!
test acc on this client before 329 / 504 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.634041
Client Index = 9	Epoch: 1	Loss: 0.608584
Client Index = 9	Epoch: 2	Loss: 0.552068
Client Index = 9	Epoch: 3	Loss: 0.510450
Client Index = 9	Epoch: 4	Loss: 0.493692
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 10
local mask changes: 2333998.0 / 11173962
choose client_indexes: [ 1 10 13 16 18], accoring to random
choose mask diff: [2463758.0, 2333998.0, 2468588.0, 2467396.0, 2462176.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.773985
Client Index = 10	Epoch: 1	Loss: 0.787524
Client Index = 10	Epoch: 2	Loss: 0.707665
Client Index = 10	Epoch: 3	Loss: 0.654562
Client Index = 10	Epoch: 4	Loss: 0.679159
test acc on this client after 348 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 11
local mask changes: 2334820.0 / 11173962
choose client_indexes: [ 1 11 12 18 19], accoring to random
choose mask diff: [2464062.0, 2334820.0, 2467372.0, 2464602.0, 2467242.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 11	Epoch: 0	Loss: 0.541215
Client Index = 11	Epoch: 1	Loss: 0.483710
Client Index = 11	Epoch: 2	Loss: 0.478641
Client Index = 11	Epoch: 3	Loss: 0.381469
Client Index = 11	Epoch: 4	Loss: 0.480018
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 12
local mask changes: 2334354.0 / 11173962
choose client_indexes: [ 2  5  9 11 12], accoring to random
choose mask diff: [2464392.0, 2463738.0, 2461488.0, 2466428.0, 2334354.0]
Doing local aggregation!
test acc on this client before 291 / 504 : 0.58
Client Index = 12	Epoch: 0	Loss: 0.783405
Client Index = 12	Epoch: 1	Loss: 0.637049
Client Index = 12	Epoch: 2	Loss: 0.574668
Client Index = 12	Epoch: 3	Loss: 0.544687
Client Index = 12	Epoch: 4	Loss: 0.622753
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 13
local mask changes: 2332770.0 / 11173962
choose client_indexes: [ 3  6 10 13 15], accoring to random
choose mask diff: [2460670.0, 2466282.0, 2463088.0, 2332770.0, 2461228.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.756848
Client Index = 13	Epoch: 1	Loss: 0.688814
Client Index = 13	Epoch: 2	Loss: 0.680903
Client Index = 13	Epoch: 3	Loss: 0.629291
Client Index = 13	Epoch: 4	Loss: 0.591174
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 14
local mask changes: 2333722.0 / 11173962
choose client_indexes: [ 2  7 14 17 19], accoring to random
choose mask diff: [2465954.0, 2459490.0, 2333722.0, 2463028.0, 2462054.0]
Doing local aggregation!
test acc on this client before 319 / 502 : 0.64
Client Index = 14	Epoch: 0	Loss: 0.922879
Client Index = 14	Epoch: 1	Loss: 0.768616
Client Index = 14	Epoch: 2	Loss: 0.711830
Client Index = 14	Epoch: 3	Loss: 0.717566
Client Index = 14	Epoch: 4	Loss: 0.703923
test acc on this client after 372 / 502 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 15
local mask changes: 2334106.0 / 11173962
choose client_indexes: [ 3  7 14 15 19], accoring to random
choose mask diff: [2463396.0, 2462692.0, 2463640.0, 2334106.0, 2459108.0]
Doing local aggregation!
test acc on this client before 317 / 504 : 0.63
Client Index = 15	Epoch: 0	Loss: 0.644023
Client Index = 15	Epoch: 1	Loss: 0.510799
Client Index = 15	Epoch: 2	Loss: 0.696226
Client Index = 15	Epoch: 3	Loss: 0.534467
Client Index = 15	Epoch: 4	Loss: 0.528224
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 16
local mask changes: 2333124.0 / 11173962
choose client_indexes: [ 1  3  4 12 16], accoring to random
choose mask diff: [2461646.0, 2457252.0, 2462258.0, 2462086.0, 2333124.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.696053
Client Index = 16	Epoch: 1	Loss: 0.583420
Client Index = 16	Epoch: 2	Loss: 0.510743
Client Index = 16	Epoch: 3	Loss: 0.558355
Client Index = 16	Epoch: 4	Loss: 0.506421
test acc on this client after 339 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 17
local mask changes: 2331654.0 / 11173962
choose client_indexes: [ 1  4  6 17 18], accoring to random
choose mask diff: [2461888.0, 2467278.0, 2466566.0, 2331654.0, 2464058.0]
Doing local aggregation!
test acc on this client before 246 / 505 : 0.49
Client Index = 17	Epoch: 0	Loss: 0.652532
Client Index = 17	Epoch: 1	Loss: 0.518563
Client Index = 17	Epoch: 2	Loss: 0.527675
Client Index = 17	Epoch: 3	Loss: 0.493845
Client Index = 17	Epoch: 4	Loss: 0.439830
test acc on this client after 417 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 18
local mask changes: 2334908.0 / 11173962
choose client_indexes: [ 1  2  7 16 18], accoring to random
choose mask diff: [2457122.0, 2459660.0, 2464280.0, 2462546.0, 2334908.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.486876
Client Index = 18	Epoch: 1	Loss: 0.469224
Client Index = 18	Epoch: 2	Loss: 0.420757
Client Index = 18	Epoch: 3	Loss: 0.408678
Client Index = 18	Epoch: 4	Loss: 0.379471
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(36) with spasity 0.5: 19
local mask changes: 2334450.0 / 11173962
choose client_indexes: [ 0  3  5 17 19], accoring to random
choose mask diff: [2466218.0, 2459396.0, 2458632.0, 2464650.0, 2334450.0]
Doing local aggregation!
test acc on this client before 367 / 506 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.677478
Client Index = 19	Epoch: 1	Loss: 0.599830
Client Index = 19	Epoch: 2	Loss: 0.508097
Client Index = 19	Epoch: 3	Loss: 0.516002
Client Index = 19	Epoch: 4	Loss: 0.513723
test acc on this client after 380 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 36
{'test_acc': 0.7428455918053634, 'test_loss': 0.7852569518545754}
################local_test_on_all_clients before local training in communication round: 36
{'test_acc': 0.6703069698145157, 'test_loss': 0.9254762953636076}
################Communication round : 37
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 0
local mask changes: 2299568.0 / 11173962
choose client_indexes: [ 0  3 12 16 17], accoring to random
choose mask diff: [2299568.0, 2437228.0, 2434978.0, 2427114.0, 2434264.0]
Doing local aggregation!
test acc on this client before 332 / 504 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.888953
Client Index = 0	Epoch: 1	Loss: 0.893181
Client Index = 0	Epoch: 2	Loss: 0.825331
Client Index = 0	Epoch: 3	Loss: 0.797886
Client Index = 0	Epoch: 4	Loss: 0.838723
test acc on this client after 344 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 1
local mask changes: 2299320.0 / 11173962
choose client_indexes: [ 1  7 12 13 18], accoring to random
choose mask diff: [2299320.0, 2436460.0, 2433230.0, 2431770.0, 2427362.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 1	Epoch: 0	Loss: 0.634544
Client Index = 1	Epoch: 1	Loss: 0.526849
Client Index = 1	Epoch: 2	Loss: 0.434342
Client Index = 1	Epoch: 3	Loss: 0.475774
Client Index = 1	Epoch: 4	Loss: 0.381221
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 2
local mask changes: 2300648.0 / 11173962
choose client_indexes: [ 2  3  4 10 12], accoring to random
choose mask diff: [2300648.0, 2437616.0, 2433836.0, 2437936.0, 2436026.0]
Doing local aggregation!
test acc on this client before 396 / 502 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.550714
Client Index = 2	Epoch: 1	Loss: 0.426286
Client Index = 2	Epoch: 2	Loss: 0.530489
Client Index = 2	Epoch: 3	Loss: 0.425092
Client Index = 2	Epoch: 4	Loss: 0.386051
test acc on this client after 396 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 3
local mask changes: 2298972.0 / 11173962
choose client_indexes: [ 0  3  9 11 15], accoring to random
choose mask diff: [2437110.0, 2298972.0, 2434188.0, 2436940.0, 2431928.0]
Doing local aggregation!
test acc on this client before 319 / 504 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.816779
Client Index = 3	Epoch: 1	Loss: 0.793107
Client Index = 3	Epoch: 2	Loss: 0.805002
Client Index = 3	Epoch: 3	Loss: 0.654524
Client Index = 3	Epoch: 4	Loss: 0.725367
test acc on this client after 353 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 4
local mask changes: 2299246.0 / 11173962
choose client_indexes: [ 4 11 17 18 19], accoring to random
choose mask diff: [2299246.0, 2436724.0, 2439850.0, 2436294.0, 2431708.0]
Doing local aggregation!
test acc on this client before 323 / 503 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.664741
Client Index = 4	Epoch: 1	Loss: 0.559248
Client Index = 4	Epoch: 2	Loss: 0.528757
Client Index = 4	Epoch: 3	Loss: 0.437054
Client Index = 4	Epoch: 4	Loss: 0.578826
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 5
local mask changes: 2301624.0 / 11173962
choose client_indexes: [ 0  5  6 11 17], accoring to random
choose mask diff: [2437618.0, 2301624.0, 2432762.0, 2428954.0, 2435186.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.675584
Client Index = 5	Epoch: 1	Loss: 0.577750
Client Index = 5	Epoch: 2	Loss: 0.550711
Client Index = 5	Epoch: 3	Loss: 0.599350
Client Index = 5	Epoch: 4	Loss: 0.496274
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 6
local mask changes: 2299060.0 / 11173962
choose client_indexes: [ 1  6  8 17 18], accoring to random
choose mask diff: [2436694.0, 2299060.0, 2428168.0, 2436338.0, 2431572.0]
Doing local aggregation!
test acc on this client before 302 / 505 : 0.60
Client Index = 6	Epoch: 0	Loss: 0.978609
Client Index = 6	Epoch: 1	Loss: 0.842414
Client Index = 6	Epoch: 2	Loss: 0.830161
Client Index = 6	Epoch: 3	Loss: 0.767846
Client Index = 6	Epoch: 4	Loss: 0.934337
test acc on this client after 338 / 505 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 7
local mask changes: 2299350.0 / 11173962
choose client_indexes: [ 3  6  7  9 19], accoring to random
choose mask diff: [2436294.0, 2428534.0, 2299350.0, 2434014.0, 2437322.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.771101
Client Index = 7	Epoch: 1	Loss: 0.705655
Client Index = 7	Epoch: 2	Loss: 0.715207
Client Index = 7	Epoch: 3	Loss: 0.642634
Client Index = 7	Epoch: 4	Loss: 0.552129
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 8
local mask changes: 2299748.0 / 11173962
choose client_indexes: [ 8 10 12 15 19], accoring to random
choose mask diff: [2299748.0, 2428646.0, 2436112.0, 2431514.0, 2431794.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 8	Epoch: 0	Loss: 0.873188
Client Index = 8	Epoch: 1	Loss: 0.733191
Client Index = 8	Epoch: 2	Loss: 0.759779
Client Index = 8	Epoch: 3	Loss: 0.724485
Client Index = 8	Epoch: 4	Loss: 0.732887
test acc on this client after 334 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 9
local mask changes: 2299098.0 / 11173962
choose client_indexes: [ 0  1  2  9 15], accoring to random
choose mask diff: [2435880.0, 2437060.0, 2432448.0, 2299098.0, 2429352.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.724214
Client Index = 9	Epoch: 1	Loss: 0.619689
Client Index = 9	Epoch: 2	Loss: 0.482239
Client Index = 9	Epoch: 3	Loss: 0.554281
Client Index = 9	Epoch: 4	Loss: 0.494909
test acc on this client after 349 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 10
local mask changes: 2298730.0 / 11173962
choose client_indexes: [ 0  2  6 10 15], accoring to random
choose mask diff: [2437372.0, 2437988.0, 2434922.0, 2298730.0, 2433442.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.730991
Client Index = 10	Epoch: 1	Loss: 0.710286
Client Index = 10	Epoch: 2	Loss: 0.668850
Client Index = 10	Epoch: 3	Loss: 0.667555
Client Index = 10	Epoch: 4	Loss: 0.718621
test acc on this client after 355 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 11
local mask changes: 2300346.0 / 11173962
choose client_indexes: [ 2  9 10 11 13], accoring to random
choose mask diff: [2433528.0, 2437258.0, 2437584.0, 2300346.0, 2433208.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 11	Epoch: 0	Loss: 0.661527
Client Index = 11	Epoch: 1	Loss: 0.399008
Client Index = 11	Epoch: 2	Loss: 0.393085
Client Index = 11	Epoch: 3	Loss: 0.447050
Client Index = 11	Epoch: 4	Loss: 0.428047
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 12
local mask changes: 2299746.0 / 11173962
choose client_indexes: [ 3  4  9 12 16], accoring to random
choose mask diff: [2438996.0, 2431990.0, 2428852.0, 2299746.0, 2435124.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 12	Epoch: 0	Loss: 0.738265
Client Index = 12	Epoch: 1	Loss: 0.646904
Client Index = 12	Epoch: 2	Loss: 0.601771
Client Index = 12	Epoch: 3	Loss: 0.596454
Client Index = 12	Epoch: 4	Loss: 0.567069
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 13
local mask changes: 2297690.0 / 11173962
choose client_indexes: [ 2  7  9 13 16], accoring to random
choose mask diff: [2434104.0, 2438392.0, 2433892.0, 2297690.0, 2434126.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.730591
Client Index = 13	Epoch: 1	Loss: 0.640889
Client Index = 13	Epoch: 2	Loss: 0.663055
Client Index = 13	Epoch: 3	Loss: 0.640717
Client Index = 13	Epoch: 4	Loss: 0.565214
test acc on this client after 338 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 14
local mask changes: 2298750.0 / 11173962
choose client_indexes: [ 6 10 12 14 15], accoring to random
choose mask diff: [2435496.0, 2439336.0, 2437872.0, 2298750.0, 2435566.0]
Doing local aggregation!
test acc on this client before 348 / 502 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.792782
Client Index = 14	Epoch: 1	Loss: 0.723491
Client Index = 14	Epoch: 2	Loss: 0.720818
Client Index = 14	Epoch: 3	Loss: 0.666752
Client Index = 14	Epoch: 4	Loss: 0.722346
test acc on this client after 346 / 502 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 15
local mask changes: 2300080.0 / 11173962
choose client_indexes: [ 7  9 11 13 15], accoring to random
choose mask diff: [2429178.0, 2433104.0, 2428432.0, 2431820.0, 2300080.0]
Doing local aggregation!
test acc on this client before 341 / 504 : 0.68
Client Index = 15	Epoch: 0	Loss: 0.583094
Client Index = 15	Epoch: 1	Loss: 0.567571
Client Index = 15	Epoch: 2	Loss: 0.557572
Client Index = 15	Epoch: 3	Loss: 0.477287
Client Index = 15	Epoch: 4	Loss: 0.483154
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 16
local mask changes: 2300008.0 / 11173962
choose client_indexes: [ 0 13 15 16 19], accoring to random
choose mask diff: [2433474.0, 2433918.0, 2433688.0, 2300008.0, 2438800.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 16	Epoch: 0	Loss: 0.695272
Client Index = 16	Epoch: 1	Loss: 0.523431
Client Index = 16	Epoch: 2	Loss: 0.558917
Client Index = 16	Epoch: 3	Loss: 0.499804
Client Index = 16	Epoch: 4	Loss: 0.598766
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 17
local mask changes: 2299772.0 / 11173962
choose client_indexes: [ 4 15 16 17 18], accoring to random
choose mask diff: [2433992.0, 2436124.0, 2433702.0, 2299772.0, 2431670.0]
Doing local aggregation!
test acc on this client before 238 / 505 : 0.47
Client Index = 17	Epoch: 0	Loss: 0.704841
Client Index = 17	Epoch: 1	Loss: 0.490377
Client Index = 17	Epoch: 2	Loss: 0.479108
Client Index = 17	Epoch: 3	Loss: 0.458766
Client Index = 17	Epoch: 4	Loss: 0.440446
test acc on this client after 397 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 18
local mask changes: 2300276.0 / 11173962
choose client_indexes: [ 0  2  5 16 18], accoring to random
choose mask diff: [2426220.0, 2430050.0, 2434188.0, 2427010.0, 2300276.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.475806
Client Index = 18	Epoch: 1	Loss: 0.494365
Client Index = 18	Epoch: 2	Loss: 0.406268
Client Index = 18	Epoch: 3	Loss: 0.404435
Client Index = 18	Epoch: 4	Loss: 0.394167
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(37) with spasity 0.5: 19
local mask changes: 2299298.0 / 11173962
choose client_indexes: [ 4 10 14 16 19], accoring to random
choose mask diff: [2437446.0, 2436504.0, 2433122.0, 2435874.0, 2299298.0]
Doing local aggregation!
test acc on this client before 278 / 506 : 0.55
Client Index = 19	Epoch: 0	Loss: 0.663259
Client Index = 19	Epoch: 1	Loss: 0.573753
Client Index = 19	Epoch: 2	Loss: 0.503346
Client Index = 19	Epoch: 3	Loss: 0.593739
Client Index = 19	Epoch: 4	Loss: 0.482178
test acc on this client after 367 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 37
{'test_acc': 0.7363868808665949, 'test_loss': 0.777285185203855}
################local_test_on_all_clients before local training in communication round: 37
{'test_acc': 0.6847574077755639, 'test_loss': 0.9018250192561812}
################Communication round : 38
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 0
local mask changes: 2265248.0 / 11173962
choose client_indexes: [ 0  6  7  8 10], accoring to random
choose mask diff: [2265248.0, 2404970.0, 2409008.0, 2408044.0, 2407692.0]
Doing local aggregation!
test acc on this client before 277 / 504 : 0.55
Client Index = 0	Epoch: 0	Loss: 0.908994
Client Index = 0	Epoch: 1	Loss: 0.806689
Client Index = 0	Epoch: 2	Loss: 0.823747
Client Index = 0	Epoch: 3	Loss: 0.832175
Client Index = 0	Epoch: 4	Loss: 0.794194
test acc on this client after 327 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 1
local mask changes: 2264800.0 / 11173962
choose client_indexes: [ 1  2  4  7 18], accoring to random
choose mask diff: [2264800.0, 2405048.0, 2406772.0, 2402794.0, 2394666.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 1	Epoch: 0	Loss: 0.554119
Client Index = 1	Epoch: 1	Loss: 0.489974
Client Index = 1	Epoch: 2	Loss: 0.532932
Client Index = 1	Epoch: 3	Loss: 0.373929
Client Index = 1	Epoch: 4	Loss: 0.399165
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 2
local mask changes: 2266592.0 / 11173962
choose client_indexes: [ 2  8 12 16 17], accoring to random
choose mask diff: [2266592.0, 2404976.0, 2401928.0, 2406790.0, 2404594.0]
Doing local aggregation!
test acc on this client before 394 / 502 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.533676
Client Index = 2	Epoch: 1	Loss: 0.462950
Client Index = 2	Epoch: 2	Loss: 0.420067
Client Index = 2	Epoch: 3	Loss: 0.414876
Client Index = 2	Epoch: 4	Loss: 0.410432
test acc on this client after 381 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 3
local mask changes: 2265156.0 / 11173962
choose client_indexes: [ 2  3  5 11 19], accoring to random
choose mask diff: [2408868.0, 2265156.0, 2405020.0, 2403700.0, 2401782.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.800702
Client Index = 3	Epoch: 1	Loss: 0.746562
Client Index = 3	Epoch: 2	Loss: 0.742108
Client Index = 3	Epoch: 3	Loss: 0.730164
Client Index = 3	Epoch: 4	Loss: 0.675953
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 4
local mask changes: 2264860.0 / 11173962
choose client_indexes: [ 2  4 11 12 18], accoring to random
choose mask diff: [2403776.0, 2264860.0, 2402034.0, 2404484.0, 2401388.0]
Doing local aggregation!
test acc on this client before 313 / 503 : 0.62
Client Index = 4	Epoch: 0	Loss: 0.662919
Client Index = 4	Epoch: 1	Loss: 0.495897
Client Index = 4	Epoch: 2	Loss: 0.541206
Client Index = 4	Epoch: 3	Loss: 0.488776
Client Index = 4	Epoch: 4	Loss: 0.417357
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 5
local mask changes: 2263748.0 / 11173962
choose client_indexes: [ 5  7  9 11 18], accoring to random
choose mask diff: [2263748.0, 2400144.0, 2407200.0, 2397104.0, 2403014.0]
Doing local aggregation!
test acc on this client before 290 / 504 : 0.58
Client Index = 5	Epoch: 0	Loss: 0.641982
Client Index = 5	Epoch: 1	Loss: 0.540259
Client Index = 5	Epoch: 2	Loss: 0.490680
Client Index = 5	Epoch: 3	Loss: 0.523198
Client Index = 5	Epoch: 4	Loss: 0.540691
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 6
local mask changes: 2265422.0 / 11173962
choose client_indexes: [ 1  3  6 15 19], accoring to random
choose mask diff: [2401120.0, 2407364.0, 2265422.0, 2409138.0, 2407584.0]
Doing local aggregation!
test acc on this client before 330 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 0.970196
Client Index = 6	Epoch: 1	Loss: 0.850647
Client Index = 6	Epoch: 2	Loss: 0.876119
Client Index = 6	Epoch: 3	Loss: 0.782099
Client Index = 6	Epoch: 4	Loss: 0.835532
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 7
local mask changes: 2263136.0 / 11173962
choose client_indexes: [ 1  2  4  7 11], accoring to random
choose mask diff: [2408386.0, 2403322.0, 2403682.0, 2263136.0, 2409382.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 7	Epoch: 0	Loss: 0.774829
Client Index = 7	Epoch: 1	Loss: 0.690193
Client Index = 7	Epoch: 2	Loss: 0.634575
Client Index = 7	Epoch: 3	Loss: 0.613539
Client Index = 7	Epoch: 4	Loss: 0.524173
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 8
local mask changes: 2265528.0 / 11173962
choose client_indexes: [ 0  3  4  8 19], accoring to random
choose mask diff: [2409796.0, 2409786.0, 2408268.0, 2265528.0, 2399234.0]
Doing local aggregation!
test acc on this client before 329 / 504 : 0.65
Client Index = 8	Epoch: 0	Loss: 0.955641
Client Index = 8	Epoch: 1	Loss: 0.706237
Client Index = 8	Epoch: 2	Loss: 0.679702
Client Index = 8	Epoch: 3	Loss: 0.726647
Client Index = 8	Epoch: 4	Loss: 0.656838
test acc on this client after 305 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 9
local mask changes: 2264402.0 / 11173962
choose client_indexes: [ 2  7  9 10 14], accoring to random
choose mask diff: [2400090.0, 2401122.0, 2264402.0, 2408570.0, 2406270.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.629398
Client Index = 9	Epoch: 1	Loss: 0.520430
Client Index = 9	Epoch: 2	Loss: 0.486902
Client Index = 9	Epoch: 3	Loss: 0.645774
Client Index = 9	Epoch: 4	Loss: 0.475274
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 10
local mask changes: 2265520.0 / 11173962
choose client_indexes: [ 2  7 10 11 18], accoring to random
choose mask diff: [2405446.0, 2409168.0, 2265520.0, 2407182.0, 2403284.0]
Doing local aggregation!
test acc on this client before 322 / 503 : 0.64
Client Index = 10	Epoch: 0	Loss: 0.823382
Client Index = 10	Epoch: 1	Loss: 0.683962
Client Index = 10	Epoch: 2	Loss: 0.664811
Client Index = 10	Epoch: 3	Loss: 0.737396
Client Index = 10	Epoch: 4	Loss: 0.636832
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 11
local mask changes: 2263732.0 / 11173962
choose client_indexes: [ 0  8 11 15 16], accoring to random
choose mask diff: [2406866.0, 2408830.0, 2263732.0, 2399714.0, 2403474.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.459556
Client Index = 11	Epoch: 1	Loss: 0.395276
Client Index = 11	Epoch: 2	Loss: 0.463264
Client Index = 11	Epoch: 3	Loss: 0.431982
Client Index = 11	Epoch: 4	Loss: 0.430630
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 12
local mask changes: 2263450.0 / 11173962
choose client_indexes: [ 5  7  8 10 12], accoring to random
choose mask diff: [2402356.0, 2407444.0, 2406158.0, 2406274.0, 2263450.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.663765
Client Index = 12	Epoch: 1	Loss: 0.698188
Client Index = 12	Epoch: 2	Loss: 0.571318
Client Index = 12	Epoch: 3	Loss: 0.526165
Client Index = 12	Epoch: 4	Loss: 0.694339
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 13
local mask changes: 2266728.0 / 11173962
choose client_indexes: [ 1  4  5 12 13], accoring to random
choose mask diff: [2404044.0, 2404582.0, 2404062.0, 2406006.0, 2266728.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 13	Epoch: 0	Loss: 0.710232
Client Index = 13	Epoch: 1	Loss: 0.622715
Client Index = 13	Epoch: 2	Loss: 0.595264
Client Index = 13	Epoch: 3	Loss: 0.654319
Client Index = 13	Epoch: 4	Loss: 0.589805
test acc on this client after 366 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 14
local mask changes: 2264826.0 / 11173962
choose client_indexes: [ 2  7 14 15 19], accoring to random
choose mask diff: [2405136.0, 2402386.0, 2264826.0, 2398696.0, 2402984.0]
Doing local aggregation!
test acc on this client before 362 / 502 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.730365
Client Index = 14	Epoch: 1	Loss: 0.724482
Client Index = 14	Epoch: 2	Loss: 0.730074
Client Index = 14	Epoch: 3	Loss: 0.694373
Client Index = 14	Epoch: 4	Loss: 0.670348
test acc on this client after 339 / 502 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 15
local mask changes: 2264038.0 / 11173962
choose client_indexes: [ 3 12 14 15 18], accoring to random
choose mask diff: [2403980.0, 2403552.0, 2402690.0, 2264038.0, 2403830.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 15	Epoch: 0	Loss: 0.611714
Client Index = 15	Epoch: 1	Loss: 0.535485
Client Index = 15	Epoch: 2	Loss: 0.505957
Client Index = 15	Epoch: 3	Loss: 0.475503
Client Index = 15	Epoch: 4	Loss: 0.479230
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 16
local mask changes: 2266428.0 / 11173962
choose client_indexes: [ 4 10 12 14 16], accoring to random
choose mask diff: [2405252.0, 2408260.0, 2403636.0, 2406336.0, 2266428.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 16	Epoch: 0	Loss: 0.607545
Client Index = 16	Epoch: 1	Loss: 0.509957
Client Index = 16	Epoch: 2	Loss: 0.595887
Client Index = 16	Epoch: 3	Loss: 0.515966
Client Index = 16	Epoch: 4	Loss: 0.465776
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 17
local mask changes: 2265516.0 / 11173962
choose client_indexes: [ 2  5  7  8 17], accoring to random
choose mask diff: [2401740.0, 2406718.0, 2399918.0, 2407932.0, 2265516.0]
Doing local aggregation!
test acc on this client before 254 / 505 : 0.50
Client Index = 17	Epoch: 0	Loss: 0.746701
Client Index = 17	Epoch: 1	Loss: 0.513064
Client Index = 17	Epoch: 2	Loss: 0.455692
Client Index = 17	Epoch: 3	Loss: 0.453639
Client Index = 17	Epoch: 4	Loss: 0.443323
test acc on this client after 406 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 18
local mask changes: 2264446.0 / 11173962
choose client_indexes: [ 5  6 16 18 19], accoring to random
choose mask diff: [2401410.0, 2404726.0, 2393862.0, 2264446.0, 2403050.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 18	Epoch: 0	Loss: 0.500210
Client Index = 18	Epoch: 1	Loss: 0.457028
Client Index = 18	Epoch: 2	Loss: 0.392801
Client Index = 18	Epoch: 3	Loss: 0.400826
Client Index = 18	Epoch: 4	Loss: 0.387074
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(38) with spasity 0.5: 19
local mask changes: 2264486.0 / 11173962
choose client_indexes: [ 0  5  6  9 19], accoring to random
choose mask diff: [2405618.0, 2402070.0, 2408190.0, 2407044.0, 2264486.0]
Doing local aggregation!
test acc on this client before 371 / 506 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.666938
Client Index = 19	Epoch: 1	Loss: 0.546511
Client Index = 19	Epoch: 2	Loss: 0.519633
Client Index = 19	Epoch: 3	Loss: 0.490926
Client Index = 19	Epoch: 4	Loss: 0.494398
test acc on this client after 366 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 38
{'test_acc': 0.7330980771295755, 'test_loss': 0.8047764888073706}
################local_test_on_all_clients before local training in communication round: 38
{'test_acc': 0.682130180037427, 'test_loss': 0.9067742467082807}
################Communication round : 39
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 0
local mask changes: 2228742.0 / 11173962
choose client_indexes: [ 0  3  5  7 19], accoring to random
choose mask diff: [2228742.0, 2372650.0, 2373938.0, 2374270.0, 2374916.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.829118
Client Index = 0	Epoch: 1	Loss: 0.858557
Client Index = 0	Epoch: 2	Loss: 0.831095
Client Index = 0	Epoch: 3	Loss: 0.726763
Client Index = 0	Epoch: 4	Loss: 0.737100
test acc on this client after 331 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 1
local mask changes: 2228650.0 / 11173962
choose client_indexes: [ 0  1 11 14 18], accoring to random
choose mask diff: [2374146.0, 2228650.0, 2370876.0, 2376006.0, 2362644.0]
Doing local aggregation!
test acc on this client before 290 / 503 : 0.58
Client Index = 1	Epoch: 0	Loss: 0.553083
Client Index = 1	Epoch: 1	Loss: 0.427687
Client Index = 1	Epoch: 2	Loss: 0.445286
Client Index = 1	Epoch: 3	Loss: 0.417978
Client Index = 1	Epoch: 4	Loss: 0.491365
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 2
local mask changes: 2228148.0 / 11173962
choose client_indexes: [ 1  2  5  7 15], accoring to random
choose mask diff: [2374414.0, 2228148.0, 2373586.0, 2375068.0, 2376644.0]
Doing local aggregation!
test acc on this client before 357 / 502 : 0.71
Client Index = 2	Epoch: 0	Loss: 0.521504
Client Index = 2	Epoch: 1	Loss: 0.412944
Client Index = 2	Epoch: 2	Loss: 0.489696
Client Index = 2	Epoch: 3	Loss: 0.361246
Client Index = 2	Epoch: 4	Loss: 0.335505
test acc on this client after 401 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 3
local mask changes: 2227566.0 / 11173962
choose client_indexes: [ 0  1  3  7 19], accoring to random
choose mask diff: [2372000.0, 2374872.0, 2227566.0, 2375188.0, 2369318.0]
Doing local aggregation!
test acc on this client before 316 / 504 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.817557
Client Index = 3	Epoch: 1	Loss: 0.743436
Client Index = 3	Epoch: 2	Loss: 0.726711
Client Index = 3	Epoch: 3	Loss: 0.699174
Client Index = 3	Epoch: 4	Loss: 0.714055
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 4
local mask changes: 2229124.0 / 11173962
choose client_indexes: [ 4  6 13 16 18], accoring to random
choose mask diff: [2229124.0, 2374396.0, 2373764.0, 2375098.0, 2366020.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.571116
Client Index = 4	Epoch: 1	Loss: 0.503148
Client Index = 4	Epoch: 2	Loss: 0.450964
Client Index = 4	Epoch: 3	Loss: 0.489568
Client Index = 4	Epoch: 4	Loss: 0.413283
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 5
local mask changes: 2229408.0 / 11173962
choose client_indexes: [ 1  4  5 17 18], accoring to random
choose mask diff: [2374516.0, 2375958.0, 2229408.0, 2376252.0, 2365360.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.635660
Client Index = 5	Epoch: 1	Loss: 0.611723
Client Index = 5	Epoch: 2	Loss: 0.561744
Client Index = 5	Epoch: 3	Loss: 0.468006
Client Index = 5	Epoch: 4	Loss: 0.527263
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 6
local mask changes: 2229478.0 / 11173962
choose client_indexes: [ 3  6  8  9 19], accoring to random
choose mask diff: [2372936.0, 2229478.0, 2373170.0, 2377164.0, 2373558.0]
Doing local aggregation!
test acc on this client before 303 / 505 : 0.60
Client Index = 6	Epoch: 0	Loss: 0.900318
Client Index = 6	Epoch: 1	Loss: 0.804717
Client Index = 6	Epoch: 2	Loss: 0.767323
Client Index = 6	Epoch: 3	Loss: 0.821869
Client Index = 6	Epoch: 4	Loss: 0.797862
test acc on this client after 301 / 505 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 7
local mask changes: 2228552.0 / 11173962
choose client_indexes: [ 5  6  7 11 16], accoring to random
choose mask diff: [2373388.0, 2371096.0, 2228552.0, 2374680.0, 2377916.0]
Doing local aggregation!
test acc on this client before 374 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.716779
Client Index = 7	Epoch: 1	Loss: 0.662501
Client Index = 7	Epoch: 2	Loss: 0.625690
Client Index = 7	Epoch: 3	Loss: 0.555504
Client Index = 7	Epoch: 4	Loss: 0.563636
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 8
local mask changes: 2229608.0 / 11173962
choose client_indexes: [ 0  3  6  8 17], accoring to random
choose mask diff: [2372828.0, 2372862.0, 2371780.0, 2229608.0, 2377662.0]
Doing local aggregation!
test acc on this client before 357 / 504 : 0.71
Client Index = 8	Epoch: 0	Loss: 0.821352
Client Index = 8	Epoch: 1	Loss: 0.736130
Client Index = 8	Epoch: 2	Loss: 0.692806
Client Index = 8	Epoch: 3	Loss: 0.656989
Client Index = 8	Epoch: 4	Loss: 0.673964
test acc on this client after 312 / 504 : 0.62
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 9
local mask changes: 2227954.0 / 11173962
choose client_indexes: [ 1  8  9 14 19], accoring to random
choose mask diff: [2374000.0, 2377172.0, 2227954.0, 2372218.0, 2375038.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 9	Epoch: 0	Loss: 0.562431
Client Index = 9	Epoch: 1	Loss: 0.532520
Client Index = 9	Epoch: 2	Loss: 0.521675
Client Index = 9	Epoch: 3	Loss: 0.450594
Client Index = 9	Epoch: 4	Loss: 0.511267
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 10
local mask changes: 2229352.0 / 11173962
choose client_indexes: [ 0  4 10 11 18], accoring to random
choose mask diff: [2373386.0, 2381014.0, 2229352.0, 2370296.0, 2371730.0]
Doing local aggregation!
test acc on this client before 308 / 503 : 0.61
Client Index = 10	Epoch: 0	Loss: 0.742275
Client Index = 10	Epoch: 1	Loss: 0.712478
Client Index = 10	Epoch: 2	Loss: 0.635989
Client Index = 10	Epoch: 3	Loss: 0.659765
Client Index = 10	Epoch: 4	Loss: 0.586777
test acc on this client after 354 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 11
local mask changes: 2228482.0 / 11173962
choose client_indexes: [ 2  7 11 15 16], accoring to random
choose mask diff: [2372374.0, 2377480.0, 2228482.0, 2363794.0, 2368810.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.418298
Client Index = 11	Epoch: 1	Loss: 0.373523
Client Index = 11	Epoch: 2	Loss: 0.485484
Client Index = 11	Epoch: 3	Loss: 0.392703
Client Index = 11	Epoch: 4	Loss: 0.359736
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 12
local mask changes: 2229324.0 / 11173962
choose client_indexes: [ 2  3  4  7 12], accoring to random
choose mask diff: [2373864.0, 2375722.0, 2373504.0, 2373872.0, 2229324.0]
Doing local aggregation!
test acc on this client before 252 / 504 : 0.50
Client Index = 12	Epoch: 0	Loss: 0.702909
Client Index = 12	Epoch: 1	Loss: 0.587169
Client Index = 12	Epoch: 2	Loss: 0.568356
Client Index = 12	Epoch: 3	Loss: 0.540272
Client Index = 12	Epoch: 4	Loss: 0.573966
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 13
local mask changes: 2228722.0 / 11173962
choose client_indexes: [ 8 11 13 16 17], accoring to random
choose mask diff: [2379102.0, 2372698.0, 2228722.0, 2371452.0, 2371798.0]
Doing local aggregation!
test acc on this client before 376 / 503 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.667624
Client Index = 13	Epoch: 1	Loss: 0.613276
Client Index = 13	Epoch: 2	Loss: 0.637682
Client Index = 13	Epoch: 3	Loss: 0.586779
Client Index = 13	Epoch: 4	Loss: 0.570612
test acc on this client after 358 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 14
local mask changes: 2229520.0 / 11173962
choose client_indexes: [ 2 12 13 14 16], accoring to random
choose mask diff: [2369908.0, 2377220.0, 2376266.0, 2229520.0, 2374550.0]
Doing local aggregation!
test acc on this client before 363 / 502 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.742204
Client Index = 14	Epoch: 1	Loss: 0.756074
Client Index = 14	Epoch: 2	Loss: 0.659377
Client Index = 14	Epoch: 3	Loss: 0.599593
Client Index = 14	Epoch: 4	Loss: 0.768751
test acc on this client after 373 / 502 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 15
local mask changes: 2229884.0 / 11173962
choose client_indexes: [ 3  5  6 13 15], accoring to random
choose mask diff: [2364804.0, 2373150.0, 2377690.0, 2371724.0, 2229884.0]
Doing local aggregation!
test acc on this client before 350 / 504 : 0.69
Client Index = 15	Epoch: 0	Loss: 0.622339
Client Index = 15	Epoch: 1	Loss: 0.512143
Client Index = 15	Epoch: 2	Loss: 0.480753
Client Index = 15	Epoch: 3	Loss: 0.481202
Client Index = 15	Epoch: 4	Loss: 0.512339
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 16
local mask changes: 2229408.0 / 11173962
choose client_indexes: [ 4  5 11 16 19], accoring to random
choose mask diff: [2371456.0, 2374234.0, 2372998.0, 2229408.0, 2372308.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.571968
Client Index = 16	Epoch: 1	Loss: 0.510732
Client Index = 16	Epoch: 2	Loss: 0.476216
Client Index = 16	Epoch: 3	Loss: 0.638404
Client Index = 16	Epoch: 4	Loss: 0.500063
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 17
local mask changes: 2229098.0 / 11173962
choose client_indexes: [ 0  2  8 17 19], accoring to random
choose mask diff: [2371164.0, 2369172.0, 2374144.0, 2229098.0, 2373710.0]
Doing local aggregation!
test acc on this client before 340 / 505 : 0.67
Client Index = 17	Epoch: 0	Loss: 0.641941
Client Index = 17	Epoch: 1	Loss: 0.570300
Client Index = 17	Epoch: 2	Loss: 0.441886
Client Index = 17	Epoch: 3	Loss: 0.454350
Client Index = 17	Epoch: 4	Loss: 0.448122
test acc on this client after 394 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 18
local mask changes: 2229972.0 / 11173962
choose client_indexes: [ 8 14 15 16 18], accoring to random
choose mask diff: [2376734.0, 2371346.0, 2374316.0, 2364448.0, 2229972.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.466173
Client Index = 18	Epoch: 1	Loss: 0.467233
Client Index = 18	Epoch: 2	Loss: 0.388548
Client Index = 18	Epoch: 3	Loss: 0.389367
Client Index = 18	Epoch: 4	Loss: 0.374010
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(39) with spasity 0.5: 19
local mask changes: 2228414.0 / 11173962
choose client_indexes: [ 2  7 12 15 19], accoring to random
choose mask diff: [2373398.0, 2375766.0, 2373418.0, 2373092.0, 2228414.0]
Doing local aggregation!
test acc on this client before 336 / 506 : 0.66
Client Index = 19	Epoch: 0	Loss: 0.620350
Client Index = 19	Epoch: 1	Loss: 0.593825
Client Index = 19	Epoch: 2	Loss: 0.585629
Client Index = 19	Epoch: 3	Loss: 0.543435
Client Index = 19	Epoch: 4	Loss: 0.478535
test acc on this client after 371 / 506 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 39
{'test_acc': 0.7365121247416438, 'test_loss': 0.7815045754753582}
################local_test_on_all_clients before local training in communication round: 39
{'test_acc': 0.6946129570297013, 'test_loss': 0.899119853248233}
################Communication round : 40
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 0
local mask changes: 2192450.0 / 11173962
choose client_indexes: [ 0  4 11 13 16], accoring to random
choose mask diff: [2192450.0, 2344694.0, 2342146.0, 2348278.0, 2342484.0]
Doing local aggregation!
test acc on this client before 308 / 504 : 0.61
Client Index = 0	Epoch: 0	Loss: 0.862748
Client Index = 0	Epoch: 1	Loss: 0.789189
Client Index = 0	Epoch: 2	Loss: 0.776809
Client Index = 0	Epoch: 3	Loss: 0.778648
Client Index = 0	Epoch: 4	Loss: 0.732518
test acc on this client after 295 / 504 : 0.59
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 1
local mask changes: 2193828.0 / 11173962
choose client_indexes: [ 1  3  5 15 16], accoring to random
choose mask diff: [2193828.0, 2344168.0, 2341360.0, 2344312.0, 2341506.0]
Doing local aggregation!
test acc on this client before 365 / 503 : 0.73
Client Index = 1	Epoch: 0	Loss: 0.526627
Client Index = 1	Epoch: 1	Loss: 0.438909
Client Index = 1	Epoch: 2	Loss: 0.377334
Client Index = 1	Epoch: 3	Loss: 0.416513
Client Index = 1	Epoch: 4	Loss: 0.356847
test acc on this client after 368 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 2
local mask changes: 2192240.0 / 11173962
choose client_indexes: [ 0  2  9 17 18], accoring to random
choose mask diff: [2345426.0, 2192240.0, 2340720.0, 2336824.0, 2337804.0]
Doing local aggregation!
test acc on this client before 309 / 502 : 0.62
Client Index = 2	Epoch: 0	Loss: 0.660879
Client Index = 2	Epoch: 1	Loss: 0.423173
Client Index = 2	Epoch: 2	Loss: 0.395739
Client Index = 2	Epoch: 3	Loss: 0.376366
Client Index = 2	Epoch: 4	Loss: 0.388806
test acc on this client after 413 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 3
local mask changes: 2193432.0 / 11173962
choose client_indexes: [ 1  3  7 12 19], accoring to random
choose mask diff: [2338770.0, 2193432.0, 2340200.0, 2345394.0, 2334806.0]
Doing local aggregation!
test acc on this client before 297 / 504 : 0.59
Client Index = 3	Epoch: 0	Loss: 0.858936
Client Index = 3	Epoch: 1	Loss: 0.727063
Client Index = 3	Epoch: 2	Loss: 0.679702
Client Index = 3	Epoch: 3	Loss: 0.738669
Client Index = 3	Epoch: 4	Loss: 0.655429
test acc on this client after 356 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 4
local mask changes: 2194934.0 / 11173962
choose client_indexes: [ 2  4  8 11 15], accoring to random
choose mask diff: [2338882.0, 2194934.0, 2346534.0, 2343048.0, 2344116.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.649866
Client Index = 4	Epoch: 1	Loss: 0.464958
Client Index = 4	Epoch: 2	Loss: 0.438678
Client Index = 4	Epoch: 3	Loss: 0.419888
Client Index = 4	Epoch: 4	Loss: 0.511503
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 5
local mask changes: 2192768.0 / 11173962
choose client_indexes: [ 0  4  5 10 19], accoring to random
choose mask diff: [2343444.0, 2339220.0, 2192768.0, 2344708.0, 2339806.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.611764
Client Index = 5	Epoch: 1	Loss: 0.530463
Client Index = 5	Epoch: 2	Loss: 0.532334
Client Index = 5	Epoch: 3	Loss: 0.524696
Client Index = 5	Epoch: 4	Loss: 0.430496
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 6
local mask changes: 2193022.0 / 11173962
choose client_indexes: [ 6  9 13 17 19], accoring to random
choose mask diff: [2193022.0, 2342302.0, 2346288.0, 2343492.0, 2336914.0]
Doing local aggregation!
test acc on this client before 255 / 505 : 0.50
Client Index = 6	Epoch: 0	Loss: 0.902994
Client Index = 6	Epoch: 1	Loss: 0.804162
Client Index = 6	Epoch: 2	Loss: 0.817020
Client Index = 6	Epoch: 3	Loss: 0.771839
Client Index = 6	Epoch: 4	Loss: 0.739339
test acc on this client after 358 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 7
local mask changes: 2193666.0 / 11173962
choose client_indexes: [ 2  4  7 14 19], accoring to random
choose mask diff: [2341598.0, 2343464.0, 2193666.0, 2339872.0, 2345570.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 7	Epoch: 0	Loss: 0.781627
Client Index = 7	Epoch: 1	Loss: 0.661278
Client Index = 7	Epoch: 2	Loss: 0.544817
Client Index = 7	Epoch: 3	Loss: 0.518309
Client Index = 7	Epoch: 4	Loss: 0.583064
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 8
local mask changes: 2191504.0 / 11173962
choose client_indexes: [ 0  2  5  8 16], accoring to random
choose mask diff: [2337188.0, 2343718.0, 2345304.0, 2191504.0, 2345424.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 8	Epoch: 0	Loss: 0.806128
Client Index = 8	Epoch: 1	Loss: 0.698077
Client Index = 8	Epoch: 2	Loss: 0.681353
Client Index = 8	Epoch: 3	Loss: 0.643461
Client Index = 8	Epoch: 4	Loss: 0.593550
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 9
local mask changes: 2192944.0 / 11173962
choose client_indexes: [ 4  9 11 12 15], accoring to random
choose mask diff: [2348244.0, 2192944.0, 2342912.0, 2342032.0, 2339224.0]
Doing local aggregation!
test acc on this client before 365 / 504 : 0.72
Client Index = 9	Epoch: 0	Loss: 0.603158
Client Index = 9	Epoch: 1	Loss: 0.552630
Client Index = 9	Epoch: 2	Loss: 0.478511
Client Index = 9	Epoch: 3	Loss: 0.424162
Client Index = 9	Epoch: 4	Loss: 0.426175
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 10
local mask changes: 2194338.0 / 11173962
choose client_indexes: [ 8 10 11 17 19], accoring to random
choose mask diff: [2341640.0, 2194338.0, 2337676.0, 2345132.0, 2343396.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.753179
Client Index = 10	Epoch: 1	Loss: 0.720984
Client Index = 10	Epoch: 2	Loss: 0.637938
Client Index = 10	Epoch: 3	Loss: 0.551317
Client Index = 10	Epoch: 4	Loss: 0.685375
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 11
local mask changes: 2192884.0 / 11173962
choose client_indexes: [ 2  9 11 14 19], accoring to random
choose mask diff: [2336616.0, 2343070.0, 2192884.0, 2341104.0, 2345774.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.449937
Client Index = 11	Epoch: 1	Loss: 0.442285
Client Index = 11	Epoch: 2	Loss: 0.331479
Client Index = 11	Epoch: 3	Loss: 0.480250
Client Index = 11	Epoch: 4	Loss: 0.291109
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 12
local mask changes: 2192266.0 / 11173962
choose client_indexes: [11 12 15 18 19], accoring to random
choose mask diff: [2343696.0, 2192266.0, 2341558.0, 2344272.0, 2343464.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.649763
Client Index = 12	Epoch: 1	Loss: 0.576024
Client Index = 12	Epoch: 2	Loss: 0.536785
Client Index = 12	Epoch: 3	Loss: 0.576619
Client Index = 12	Epoch: 4	Loss: 0.499894
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 13
local mask changes: 2192688.0 / 11173962
choose client_indexes: [ 2 10 11 13 16], accoring to random
choose mask diff: [2340172.0, 2344912.0, 2339608.0, 2192688.0, 2336588.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.808882
Client Index = 13	Epoch: 1	Loss: 0.598768
Client Index = 13	Epoch: 2	Loss: 0.612795
Client Index = 13	Epoch: 3	Loss: 0.594687
Client Index = 13	Epoch: 4	Loss: 0.566584
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 14
local mask changes: 2192566.0 / 11173962
choose client_indexes: [ 0  3  7  9 14], accoring to random
choose mask diff: [2346938.0, 2344316.0, 2340388.0, 2340504.0, 2192566.0]
Doing local aggregation!
test acc on this client before 348 / 502 : 0.69
Client Index = 14	Epoch: 0	Loss: 0.715038
Client Index = 14	Epoch: 1	Loss: 0.724021
Client Index = 14	Epoch: 2	Loss: 0.643232
Client Index = 14	Epoch: 3	Loss: 0.664935
Client Index = 14	Epoch: 4	Loss: 0.647111
test acc on this client after 333 / 502 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 15
local mask changes: 2191368.0 / 11173962
choose client_indexes: [ 8  9 12 14 15], accoring to random
choose mask diff: [2343350.0, 2339978.0, 2342310.0, 2337996.0, 2191368.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.592510
Client Index = 15	Epoch: 1	Loss: 0.465217
Client Index = 15	Epoch: 2	Loss: 0.523178
Client Index = 15	Epoch: 3	Loss: 0.433867
Client Index = 15	Epoch: 4	Loss: 0.455698
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 16
local mask changes: 2191762.0 / 11173962
choose client_indexes: [ 4  8 12 16 17], accoring to random
choose mask diff: [2337722.0, 2345446.0, 2340604.0, 2191762.0, 2342926.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 16	Epoch: 0	Loss: 0.563207
Client Index = 16	Epoch: 1	Loss: 0.528610
Client Index = 16	Epoch: 2	Loss: 0.538595
Client Index = 16	Epoch: 3	Loss: 0.495270
Client Index = 16	Epoch: 4	Loss: 0.496062
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 17
local mask changes: 2191494.0 / 11173962
choose client_indexes: [ 0  4  5  7 17], accoring to random
choose mask diff: [2338382.0, 2342660.0, 2339862.0, 2338206.0, 2191494.0]
Doing local aggregation!
test acc on this client before 336 / 505 : 0.67
Client Index = 17	Epoch: 0	Loss: 0.678320
Client Index = 17	Epoch: 1	Loss: 0.469139
Client Index = 17	Epoch: 2	Loss: 0.454041
Client Index = 17	Epoch: 3	Loss: 0.417932
Client Index = 17	Epoch: 4	Loss: 0.357317
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 18
local mask changes: 2190956.0 / 11173962
choose client_indexes: [ 5 11 14 17 18], accoring to random
choose mask diff: [2337014.0, 2339336.0, 2337086.0, 2340094.0, 2190956.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.507571
Client Index = 18	Epoch: 1	Loss: 0.400657
Client Index = 18	Epoch: 2	Loss: 0.379310
Client Index = 18	Epoch: 3	Loss: 0.412967
Client Index = 18	Epoch: 4	Loss: 0.337804
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(40) with spasity 0.5: 19
local mask changes: 2193240.0 / 11173962
choose client_indexes: [ 5  6 13 14 19], accoring to random
choose mask diff: [2339540.0, 2340000.0, 2344012.0, 2339544.0, 2193240.0]
Doing local aggregation!
test acc on this client before 351 / 506 : 0.69
Client Index = 19	Epoch: 0	Loss: 0.608425
Client Index = 19	Epoch: 1	Loss: 0.579708
Client Index = 19	Epoch: 2	Loss: 0.473878
Client Index = 19	Epoch: 3	Loss: 0.546696
Client Index = 19	Epoch: 4	Loss: 0.474458
test acc on this client after 394 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 40
{'test_acc': 0.7450100455120909, 'test_loss': 0.77977557479095}
################local_test_on_all_clients before local training in communication round: 40
{'test_acc': 0.7050368661403159, 'test_loss': 0.8679240572530379}
################Communication round : 41
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 0
local mask changes: 2155014.0 / 11173962
choose client_indexes: [ 0  5  6 14 15], accoring to random
choose mask diff: [2155014.0, 2310892.0, 2313490.0, 2315126.0, 2312428.0]
Doing local aggregation!
test acc on this client before 309 / 504 : 0.61
Client Index = 0	Epoch: 0	Loss: 0.845589
Client Index = 0	Epoch: 1	Loss: 0.816558
Client Index = 0	Epoch: 2	Loss: 0.757213
Client Index = 0	Epoch: 3	Loss: 0.716331
Client Index = 0	Epoch: 4	Loss: 0.746209
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 1
local mask changes: 2155658.0 / 11173962
choose client_indexes: [ 1  2  7 15 18], accoring to random
choose mask diff: [2155658.0, 2305866.0, 2307498.0, 2306186.0, 2301248.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.651509
Client Index = 1	Epoch: 1	Loss: 0.436913
Client Index = 1	Epoch: 2	Loss: 0.362651
Client Index = 1	Epoch: 3	Loss: 0.375663
Client Index = 1	Epoch: 4	Loss: 0.348686
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 2
local mask changes: 2155460.0 / 11173962
choose client_indexes: [ 2  5  9 18 19], accoring to random
choose mask diff: [2155460.0, 2307960.0, 2303796.0, 2304078.0, 2307450.0]
Doing local aggregation!
test acc on this client before 301 / 502 : 0.60
Client Index = 2	Epoch: 0	Loss: 0.648968
Client Index = 2	Epoch: 1	Loss: 0.441487
Client Index = 2	Epoch: 2	Loss: 0.403682
Client Index = 2	Epoch: 3	Loss: 0.380331
Client Index = 2	Epoch: 4	Loss: 0.372078
test acc on this client after 423 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 3
local mask changes: 2155180.0 / 11173962
choose client_indexes: [ 2  3  9 14 16], accoring to random
choose mask diff: [2307718.0, 2155180.0, 2313210.0, 2313168.0, 2309632.0]
Doing local aggregation!
test acc on this client before 284 / 504 : 0.56
Client Index = 3	Epoch: 0	Loss: 0.802009
Client Index = 3	Epoch: 1	Loss: 0.704534
Client Index = 3	Epoch: 2	Loss: 0.677487
Client Index = 3	Epoch: 3	Loss: 0.628895
Client Index = 3	Epoch: 4	Loss: 0.608705
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 4
local mask changes: 2156326.0 / 11173962
choose client_indexes: [ 4  8 10 13 16], accoring to random
choose mask diff: [2156326.0, 2309284.0, 2311294.0, 2306802.0, 2304380.0]
Doing local aggregation!
test acc on this client before 366 / 503 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.565836
Client Index = 4	Epoch: 1	Loss: 0.491944
Client Index = 4	Epoch: 2	Loss: 0.492865
Client Index = 4	Epoch: 3	Loss: 0.454482
Client Index = 4	Epoch: 4	Loss: 0.431825
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 5
local mask changes: 2156094.0 / 11173962
choose client_indexes: [ 5  8 14 15 17], accoring to random
choose mask diff: [2156094.0, 2311358.0, 2314164.0, 2308598.0, 2306614.0]
Doing local aggregation!
test acc on this client before 319 / 504 : 0.63
Client Index = 5	Epoch: 0	Loss: 0.618203
Client Index = 5	Epoch: 1	Loss: 0.532774
Client Index = 5	Epoch: 2	Loss: 0.522069
Client Index = 5	Epoch: 3	Loss: 0.437653
Client Index = 5	Epoch: 4	Loss: 0.416247
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 6
local mask changes: 2157464.0 / 11173962
choose client_indexes: [ 1  6  7 11 14], accoring to random
choose mask diff: [2311584.0, 2157464.0, 2308228.0, 2315718.0, 2311774.0]
Doing local aggregation!
test acc on this client before 332 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 0.900512
Client Index = 6	Epoch: 1	Loss: 0.831561
Client Index = 6	Epoch: 2	Loss: 0.745061
Client Index = 6	Epoch: 3	Loss: 0.762672
Client Index = 6	Epoch: 4	Loss: 0.733465
test acc on this client after 324 / 505 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 7
local mask changes: 2156122.0 / 11173962
choose client_indexes: [ 7 13 16 18 19], accoring to random
choose mask diff: [2156122.0, 2312680.0, 2309236.0, 2311500.0, 2306586.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.734974
Client Index = 7	Epoch: 1	Loss: 0.615633
Client Index = 7	Epoch: 2	Loss: 0.590760
Client Index = 7	Epoch: 3	Loss: 0.500342
Client Index = 7	Epoch: 4	Loss: 0.586472
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 8
local mask changes: 2155450.0 / 11173962
choose client_indexes: [ 1  8 10 17 18], accoring to random
choose mask diff: [2314624.0, 2155450.0, 2312174.0, 2309182.0, 2308982.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 8	Epoch: 0	Loss: 0.905843
Client Index = 8	Epoch: 1	Loss: 0.629488
Client Index = 8	Epoch: 2	Loss: 0.725511
Client Index = 8	Epoch: 3	Loss: 0.636793
Client Index = 8	Epoch: 4	Loss: 0.633363
test acc on this client after 359 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 9
local mask changes: 2154044.0 / 11173962
choose client_indexes: [ 1  3  6  9 14], accoring to random
choose mask diff: [2310166.0, 2311398.0, 2313204.0, 2154044.0, 2309588.0]
Doing local aggregation!
test acc on this client before 376 / 504 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.538590
Client Index = 9	Epoch: 1	Loss: 0.547563
Client Index = 9	Epoch: 2	Loss: 0.446176
Client Index = 9	Epoch: 3	Loss: 0.488734
Client Index = 9	Epoch: 4	Loss: 0.383978
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 10
local mask changes: 2157056.0 / 11173962
choose client_indexes: [ 7 10 13 15 18], accoring to random
choose mask diff: [2311440.0, 2157056.0, 2311384.0, 2312602.0, 2308650.0]
Doing local aggregation!
test acc on this client before 349 / 503 : 0.69
Client Index = 10	Epoch: 0	Loss: 0.700802
Client Index = 10	Epoch: 1	Loss: 0.718052
Client Index = 10	Epoch: 2	Loss: 0.620264
Client Index = 10	Epoch: 3	Loss: 0.618690
Client Index = 10	Epoch: 4	Loss: 0.590055
test acc on this client after 341 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 11
local mask changes: 2156000.0 / 11173962
choose client_indexes: [ 0  1  8 11 17], accoring to random
choose mask diff: [2313168.0, 2307438.0, 2312504.0, 2156000.0, 2313296.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.443132
Client Index = 11	Epoch: 1	Loss: 0.368360
Client Index = 11	Epoch: 2	Loss: 0.459188
Client Index = 11	Epoch: 3	Loss: 0.317353
Client Index = 11	Epoch: 4	Loss: 0.342617
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 12
local mask changes: 2155570.0 / 11173962
choose client_indexes: [ 0  2  7 10 12], accoring to random
choose mask diff: [2311864.0, 2306170.0, 2311886.0, 2313206.0, 2155570.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 12	Epoch: 0	Loss: 0.693323
Client Index = 12	Epoch: 1	Loss: 0.543557
Client Index = 12	Epoch: 2	Loss: 0.582174
Client Index = 12	Epoch: 3	Loss: 0.479636
Client Index = 12	Epoch: 4	Loss: 0.551215
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 13
local mask changes: 2155902.0 / 11173962
choose client_indexes: [ 3  4  6 13 19], accoring to random
choose mask diff: [2313238.0, 2307634.0, 2316352.0, 2155902.0, 2312662.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 13	Epoch: 0	Loss: 0.615667
Client Index = 13	Epoch: 1	Loss: 0.637583
Client Index = 13	Epoch: 2	Loss: 0.581873
Client Index = 13	Epoch: 3	Loss: 0.488477
Client Index = 13	Epoch: 4	Loss: 0.557562
test acc on this client after 356 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 14
local mask changes: 2155974.0 / 11173962
choose client_indexes: [ 3 11 12 14 18], accoring to random
choose mask diff: [2308514.0, 2308782.0, 2313034.0, 2155974.0, 2307322.0]
Doing local aggregation!
test acc on this client before 369 / 502 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.728770
Client Index = 14	Epoch: 1	Loss: 0.671584
Client Index = 14	Epoch: 2	Loss: 0.643563
Client Index = 14	Epoch: 3	Loss: 0.628450
Client Index = 14	Epoch: 4	Loss: 0.626912
test acc on this client after 364 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 15
local mask changes: 2156944.0 / 11173962
choose client_indexes: [ 8 15 16 18 19], accoring to random
choose mask diff: [2306412.0, 2156944.0, 2311038.0, 2305796.0, 2307524.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 15	Epoch: 0	Loss: 0.612108
Client Index = 15	Epoch: 1	Loss: 0.468242
Client Index = 15	Epoch: 2	Loss: 0.554102
Client Index = 15	Epoch: 3	Loss: 0.430307
Client Index = 15	Epoch: 4	Loss: 0.423645
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 16
local mask changes: 2155986.0 / 11173962
choose client_indexes: [ 0  2  4 16 19], accoring to random
choose mask diff: [2309260.0, 2307614.0, 2301932.0, 2155986.0, 2307642.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 16	Epoch: 0	Loss: 0.601606
Client Index = 16	Epoch: 1	Loss: 0.478518
Client Index = 16	Epoch: 2	Loss: 0.523747
Client Index = 16	Epoch: 3	Loss: 0.471108
Client Index = 16	Epoch: 4	Loss: 0.445756
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 17
local mask changes: 2154798.0 / 11173962
choose client_indexes: [ 3  7  9 17 19], accoring to random
choose mask diff: [2310692.0, 2305082.0, 2312182.0, 2154798.0, 2306274.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.620523
Client Index = 17	Epoch: 1	Loss: 0.478056
Client Index = 17	Epoch: 2	Loss: 0.459182
Client Index = 17	Epoch: 3	Loss: 0.388419
Client Index = 17	Epoch: 4	Loss: 0.423799
test acc on this client after 350 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 18
local mask changes: 2154544.0 / 11173962
choose client_indexes: [ 1  2 11 14 18], accoring to random
choose mask diff: [2302292.0, 2303632.0, 2302410.0, 2301696.0, 2154544.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.455819
Client Index = 18	Epoch: 1	Loss: 0.403030
Client Index = 18	Epoch: 2	Loss: 0.358120
Client Index = 18	Epoch: 3	Loss: 0.372918
Client Index = 18	Epoch: 4	Loss: 0.324440
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(41) with spasity 0.5: 19
local mask changes: 2154480.0 / 11173962
choose client_indexes: [ 0  6 13 14 19], accoring to random
choose mask diff: [2307424.0, 2304166.0, 2307940.0, 2305024.0, 2154480.0]
Doing local aggregation!
test acc on this client before 360 / 506 : 0.71
Client Index = 19	Epoch: 0	Loss: 0.558578
Client Index = 19	Epoch: 1	Loss: 0.538570
Client Index = 19	Epoch: 2	Loss: 0.515607
Client Index = 19	Epoch: 3	Loss: 0.459580
Client Index = 19	Epoch: 4	Loss: 0.409059
test acc on this client after 378 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 41
{'test_acc': 0.7511999997985376, 'test_loss': 0.7582827756676459}
################local_test_on_all_clients before local training in communication round: 41
{'test_acc': 0.7095740654060835, 'test_loss': 0.8443404037878244}
################Communication round : 42
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 0
local mask changes: 2116842.0 / 11173962
choose client_indexes: [ 0  4 12 17 19], accoring to random
choose mask diff: [2116842.0, 2277442.0, 2280118.0, 2275976.0, 2275796.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.841683
Client Index = 0	Epoch: 1	Loss: 0.785043
Client Index = 0	Epoch: 2	Loss: 0.746632
Client Index = 0	Epoch: 3	Loss: 0.799629
Client Index = 0	Epoch: 4	Loss: 0.682321
test acc on this client after 283 / 504 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 1
local mask changes: 2116862.0 / 11173962
choose client_indexes: [ 1  8  9 10 15], accoring to random
choose mask diff: [2116862.0, 2279750.0, 2276946.0, 2278970.0, 2272832.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.528253
Client Index = 1	Epoch: 1	Loss: 0.388136
Client Index = 1	Epoch: 2	Loss: 0.381996
Client Index = 1	Epoch: 3	Loss: 0.368456
Client Index = 1	Epoch: 4	Loss: 0.449689
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 2
local mask changes: 2116684.0 / 11173962
choose client_indexes: [ 1  2  3  8 18], accoring to random
choose mask diff: [2275494.0, 2116684.0, 2276968.0, 2275890.0, 2265556.0]
Doing local aggregation!
test acc on this client before 365 / 502 : 0.73
Client Index = 2	Epoch: 0	Loss: 0.497321
Client Index = 2	Epoch: 1	Loss: 0.373015
Client Index = 2	Epoch: 2	Loss: 0.404626
Client Index = 2	Epoch: 3	Loss: 0.348818
Client Index = 2	Epoch: 4	Loss: 0.346888
test acc on this client after 416 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 3
local mask changes: 2117306.0 / 11173962
choose client_indexes: [ 0  2  3  4 19], accoring to random
choose mask diff: [2274320.0, 2273878.0, 2117306.0, 2280408.0, 2273450.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.758447
Client Index = 3	Epoch: 1	Loss: 0.699843
Client Index = 3	Epoch: 2	Loss: 0.619025
Client Index = 3	Epoch: 3	Loss: 0.648152
Client Index = 3	Epoch: 4	Loss: 0.666686
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 4
local mask changes: 2117146.0 / 11173962
choose client_indexes: [ 4  6  8 15 17], accoring to random
choose mask diff: [2117146.0, 2279836.0, 2272038.0, 2276918.0, 2276314.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.602354
Client Index = 4	Epoch: 1	Loss: 0.487761
Client Index = 4	Epoch: 2	Loss: 0.424994
Client Index = 4	Epoch: 3	Loss: 0.487282
Client Index = 4	Epoch: 4	Loss: 0.388154
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 5
local mask changes: 2117430.0 / 11173962
choose client_indexes: [ 4  5  6 11 18], accoring to random
choose mask diff: [2274610.0, 2117430.0, 2276006.0, 2278014.0, 2270002.0]
Doing local aggregation!
test acc on this client before 303 / 504 : 0.60
Client Index = 5	Epoch: 0	Loss: 0.652961
Client Index = 5	Epoch: 1	Loss: 0.563060
Client Index = 5	Epoch: 2	Loss: 0.487494
Client Index = 5	Epoch: 3	Loss: 0.441827
Client Index = 5	Epoch: 4	Loss: 0.436267
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 6
local mask changes: 2117896.0 / 11173962
choose client_indexes: [ 2  6 17 18 19], accoring to random
choose mask diff: [2277654.0, 2117896.0, 2276724.0, 2278392.0, 2270580.0]
Doing local aggregation!
test acc on this client before 341 / 505 : 0.68
Client Index = 6	Epoch: 0	Loss: 0.960588
Client Index = 6	Epoch: 1	Loss: 0.748220
Client Index = 6	Epoch: 2	Loss: 0.736831
Client Index = 6	Epoch: 3	Loss: 0.768231
Client Index = 6	Epoch: 4	Loss: 0.873459
test acc on this client after 334 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 7
local mask changes: 2117666.0 / 11173962
choose client_indexes: [ 4  5  7  9 17], accoring to random
choose mask diff: [2276440.0, 2272540.0, 2117666.0, 2279354.0, 2274444.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.702246
Client Index = 7	Epoch: 1	Loss: 0.582949
Client Index = 7	Epoch: 2	Loss: 0.509692
Client Index = 7	Epoch: 3	Loss: 0.509644
Client Index = 7	Epoch: 4	Loss: 0.552170
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 8
local mask changes: 2118208.0 / 11173962
choose client_indexes: [ 2  4  8 13 15], accoring to random
choose mask diff: [2274656.0, 2277042.0, 2118208.0, 2279150.0, 2277990.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 0.814023
Client Index = 8	Epoch: 1	Loss: 0.723253
Client Index = 8	Epoch: 2	Loss: 0.614374
Client Index = 8	Epoch: 3	Loss: 0.653177
Client Index = 8	Epoch: 4	Loss: 0.610883
test acc on this client after 361 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 9
local mask changes: 2116582.0 / 11173962
choose client_indexes: [ 5  9 11 16 17], accoring to random
choose mask diff: [2280348.0, 2116582.0, 2272404.0, 2278230.0, 2280676.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 9	Epoch: 0	Loss: 0.552897
Client Index = 9	Epoch: 1	Loss: 0.448974
Client Index = 9	Epoch: 2	Loss: 0.558537
Client Index = 9	Epoch: 3	Loss: 0.409739
Client Index = 9	Epoch: 4	Loss: 0.425555
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 10
local mask changes: 2117686.0 / 11173962
choose client_indexes: [ 1  5  6 10 14], accoring to random
choose mask diff: [2278970.0, 2276606.0, 2280378.0, 2117686.0, 2282828.0]
Doing local aggregation!
test acc on this client before 356 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.721723
Client Index = 10	Epoch: 1	Loss: 0.581735
Client Index = 10	Epoch: 2	Loss: 0.616701
Client Index = 10	Epoch: 3	Loss: 0.573524
Client Index = 10	Epoch: 4	Loss: 0.532327
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 11
local mask changes: 2117608.0 / 11173962
choose client_indexes: [ 2  4 10 11 17], accoring to random
choose mask diff: [2270752.0, 2274306.0, 2274740.0, 2117608.0, 2275420.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 11	Epoch: 0	Loss: 0.448788
Client Index = 11	Epoch: 1	Loss: 0.393007
Client Index = 11	Epoch: 2	Loss: 0.494196
Client Index = 11	Epoch: 3	Loss: 0.350585
Client Index = 11	Epoch: 4	Loss: 0.321618
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 12
local mask changes: 2118138.0 / 11173962
choose client_indexes: [ 0  4  7  8 12], accoring to random
choose mask diff: [2277116.0, 2276948.0, 2274304.0, 2281752.0, 2118138.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 12	Epoch: 0	Loss: 0.733674
Client Index = 12	Epoch: 1	Loss: 0.522547
Client Index = 12	Epoch: 2	Loss: 0.505589
Client Index = 12	Epoch: 3	Loss: 0.543873
Client Index = 12	Epoch: 4	Loss: 0.498164
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 13
local mask changes: 2117694.0 / 11173962
choose client_indexes: [ 1  3 11 13 16], accoring to random
choose mask diff: [2278538.0, 2276376.0, 2275184.0, 2117694.0, 2273890.0]
Doing local aggregation!
test acc on this client before 342 / 503 : 0.68
Client Index = 13	Epoch: 0	Loss: 0.761670
Client Index = 13	Epoch: 1	Loss: 0.593837
Client Index = 13	Epoch: 2	Loss: 0.539735
Client Index = 13	Epoch: 3	Loss: 0.608818
Client Index = 13	Epoch: 4	Loss: 0.485074
test acc on this client after 347 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 14
local mask changes: 2117030.0 / 11173962
choose client_indexes: [ 3  7  8 14 16], accoring to random
choose mask diff: [2272434.0, 2273842.0, 2281412.0, 2117030.0, 2277752.0]
Doing local aggregation!
test acc on this client before 381 / 502 : 0.76
Client Index = 14	Epoch: 0	Loss: 0.710375
Client Index = 14	Epoch: 1	Loss: 0.627778
Client Index = 14	Epoch: 2	Loss: 0.659875
Client Index = 14	Epoch: 3	Loss: 0.626444
Client Index = 14	Epoch: 4	Loss: 0.654132
test acc on this client after 369 / 502 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 15
local mask changes: 2116786.0 / 11173962
choose client_indexes: [ 3  5 11 13 15], accoring to random
choose mask diff: [2275342.0, 2276534.0, 2272896.0, 2275632.0, 2116786.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 15	Epoch: 0	Loss: 0.637093
Client Index = 15	Epoch: 1	Loss: 0.484730
Client Index = 15	Epoch: 2	Loss: 0.487087
Client Index = 15	Epoch: 3	Loss: 0.488153
Client Index = 15	Epoch: 4	Loss: 0.417986
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 16
local mask changes: 2116802.0 / 11173962
choose client_indexes: [ 0  6 10 15 16], accoring to random
choose mask diff: [2270218.0, 2280234.0, 2278968.0, 2279084.0, 2116802.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.557003
Client Index = 16	Epoch: 1	Loss: 0.540997
Client Index = 16	Epoch: 2	Loss: 0.434916
Client Index = 16	Epoch: 3	Loss: 0.471595
Client Index = 16	Epoch: 4	Loss: 0.470753
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 17
local mask changes: 2116428.0 / 11173962
choose client_indexes: [ 0  8 12 17 18], accoring to random
choose mask diff: [2276272.0, 2276872.0, 2279508.0, 2116428.0, 2272836.0]
Doing local aggregation!
test acc on this client before 322 / 505 : 0.64
Client Index = 17	Epoch: 0	Loss: 0.677633
Client Index = 17	Epoch: 1	Loss: 0.427976
Client Index = 17	Epoch: 2	Loss: 0.452986
Client Index = 17	Epoch: 3	Loss: 0.447785
Client Index = 17	Epoch: 4	Loss: 0.419403
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 18
local mask changes: 2117994.0 / 11173962
choose client_indexes: [ 0  1 12 18 19], accoring to random
choose mask diff: [2276178.0, 2265732.0, 2275454.0, 2117994.0, 2274276.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 18	Epoch: 0	Loss: 0.509363
Client Index = 18	Epoch: 1	Loss: 0.359976
Client Index = 18	Epoch: 2	Loss: 0.440375
Client Index = 18	Epoch: 3	Loss: 0.354501
Client Index = 18	Epoch: 4	Loss: 0.343469
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(42) with spasity 0.5: 19
local mask changes: 2117792.0 / 11173962
choose client_indexes: [ 2  7 16 17 19], accoring to random
choose mask diff: [2275136.0, 2277388.0, 2278062.0, 2275096.0, 2117792.0]
Doing local aggregation!
test acc on this client before 311 / 506 : 0.61
Client Index = 19	Epoch: 0	Loss: 0.637210
Client Index = 19	Epoch: 1	Loss: 0.473446
Client Index = 19	Epoch: 2	Loss: 0.504506
Client Index = 19	Epoch: 3	Loss: 0.448259
Client Index = 19	Epoch: 4	Loss: 0.478493
test acc on this client after 355 / 506 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 42
{'test_acc': 0.7491144845421357, 'test_loss': 0.7522011569862224}
################local_test_on_all_clients before local training in communication round: 42
{'test_acc': 0.7109287303167432, 'test_loss': 0.8469266709259801}
################Communication round : 43
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 0
local mask changes: 2079064.0 / 11173962
choose client_indexes: [ 0  1  7  8 19], accoring to random
choose mask diff: [2079064.0, 2247014.0, 2245260.0, 2244920.0, 2236912.0]
Doing local aggregation!
test acc on this client before 304 / 504 : 0.60
Client Index = 0	Epoch: 0	Loss: 0.865278
Client Index = 0	Epoch: 1	Loss: 0.832138
Client Index = 0	Epoch: 2	Loss: 0.697714
Client Index = 0	Epoch: 3	Loss: 0.739866
Client Index = 0	Epoch: 4	Loss: 0.683059
test acc on this client after 317 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 1
local mask changes: 2079362.0 / 11173962
choose client_indexes: [ 0  1 15 17 18], accoring to random
choose mask diff: [2244438.0, 2079362.0, 2235764.0, 2242872.0, 2230318.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 1	Epoch: 0	Loss: 0.578654
Client Index = 1	Epoch: 1	Loss: 0.396644
Client Index = 1	Epoch: 2	Loss: 0.383190
Client Index = 1	Epoch: 3	Loss: 0.299677
Client Index = 1	Epoch: 4	Loss: 0.374711
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 2
local mask changes: 2078676.0 / 11173962
choose client_indexes: [ 2  9 11 12 19], accoring to random
choose mask diff: [2078676.0, 2240790.0, 2239394.0, 2240930.0, 2240942.0]
Doing local aggregation!
test acc on this client before 360 / 502 : 0.72
Client Index = 2	Epoch: 0	Loss: 0.494809
Client Index = 2	Epoch: 1	Loss: 0.385600
Client Index = 2	Epoch: 2	Loss: 0.372702
Client Index = 2	Epoch: 3	Loss: 0.416231
Client Index = 2	Epoch: 4	Loss: 0.307771
test acc on this client after 415 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 3
local mask changes: 2079406.0 / 11173962
choose client_indexes: [ 2  3  8 14 17], accoring to random
choose mask diff: [2237126.0, 2079406.0, 2249034.0, 2239994.0, 2242328.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.748159
Client Index = 3	Epoch: 1	Loss: 0.664201
Client Index = 3	Epoch: 2	Loss: 0.669778
Client Index = 3	Epoch: 3	Loss: 0.646904
Client Index = 3	Epoch: 4	Loss: 0.639900
test acc on this client after 340 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 4
local mask changes: 2079394.0 / 11173962
choose client_indexes: [ 3  4  6  7 13], accoring to random
choose mask diff: [2244890.0, 2079394.0, 2242886.0, 2242912.0, 2240252.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.483692
Client Index = 4	Epoch: 1	Loss: 0.498790
Client Index = 4	Epoch: 2	Loss: 0.436427
Client Index = 4	Epoch: 3	Loss: 0.409903
Client Index = 4	Epoch: 4	Loss: 0.358194
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 5
local mask changes: 2077818.0 / 11173962
choose client_indexes: [ 0  4  5 12 19], accoring to random
choose mask diff: [2237244.0, 2240614.0, 2077818.0, 2245820.0, 2239888.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.622982
Client Index = 5	Epoch: 1	Loss: 0.524635
Client Index = 5	Epoch: 2	Loss: 0.454260
Client Index = 5	Epoch: 3	Loss: 0.461767
Client Index = 5	Epoch: 4	Loss: 0.493214
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 6
local mask changes: 2080160.0 / 11173962
choose client_indexes: [ 0  2  5  6 19], accoring to random
choose mask diff: [2245722.0, 2239480.0, 2242830.0, 2080160.0, 2233250.0]
Doing local aggregation!
test acc on this client before 335 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 0.807233
Client Index = 6	Epoch: 1	Loss: 0.835641
Client Index = 6	Epoch: 2	Loss: 0.772889
Client Index = 6	Epoch: 3	Loss: 0.733337
Client Index = 6	Epoch: 4	Loss: 0.682952
test acc on this client after 371 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 7
local mask changes: 2076602.0 / 11173962
choose client_indexes: [ 3  6  7  9 10], accoring to random
choose mask diff: [2244674.0, 2240046.0, 2076602.0, 2240412.0, 2243958.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 7	Epoch: 0	Loss: 0.680794
Client Index = 7	Epoch: 1	Loss: 0.632562
Client Index = 7	Epoch: 2	Loss: 0.515726
Client Index = 7	Epoch: 3	Loss: 0.522063
Client Index = 7	Epoch: 4	Loss: 0.520527
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 8
local mask changes: 2077028.0 / 11173962
choose client_indexes: [ 4  5  8 17 18], accoring to random
choose mask diff: [2236722.0, 2239978.0, 2077028.0, 2243220.0, 2242760.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 8	Epoch: 0	Loss: 0.679244
Client Index = 8	Epoch: 1	Loss: 0.804163
Client Index = 8	Epoch: 2	Loss: 0.581673
Client Index = 8	Epoch: 3	Loss: 0.581986
Client Index = 8	Epoch: 4	Loss: 0.719795
test acc on this client after 345 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 9
local mask changes: 2079768.0 / 11173962
choose client_indexes: [ 1  4  9 14 18], accoring to random
choose mask diff: [2242638.0, 2250002.0, 2079768.0, 2241890.0, 2242500.0]
Doing local aggregation!
test acc on this client before 326 / 504 : 0.65
Client Index = 9	Epoch: 0	Loss: 0.616519
Client Index = 9	Epoch: 1	Loss: 0.486135
Client Index = 9	Epoch: 2	Loss: 0.413514
Client Index = 9	Epoch: 3	Loss: 0.385830
Client Index = 9	Epoch: 4	Loss: 0.425283
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 10
local mask changes: 2079098.0 / 11173962
choose client_indexes: [ 8 10 13 17 18], accoring to random
choose mask diff: [2240890.0, 2079098.0, 2244244.0, 2246972.0, 2239456.0]
Doing local aggregation!
test acc on this client before 368 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.720439
Client Index = 10	Epoch: 1	Loss: 0.645551
Client Index = 10	Epoch: 2	Loss: 0.625182
Client Index = 10	Epoch: 3	Loss: 0.540201
Client Index = 10	Epoch: 4	Loss: 0.576698
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 11
local mask changes: 2079148.0 / 11173962
choose client_indexes: [ 0  8  9 11 14], accoring to random
choose mask diff: [2241094.0, 2241582.0, 2244028.0, 2079148.0, 2240894.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.447731
Client Index = 11	Epoch: 1	Loss: 0.377863
Client Index = 11	Epoch: 2	Loss: 0.329281
Client Index = 11	Epoch: 3	Loss: 0.359405
Client Index = 11	Epoch: 4	Loss: 0.299807
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 12
local mask changes: 2079020.0 / 11173962
choose client_indexes: [ 5  7 12 15 17], accoring to random
choose mask diff: [2243536.0, 2239066.0, 2079020.0, 2240006.0, 2246010.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.643464
Client Index = 12	Epoch: 1	Loss: 0.537187
Client Index = 12	Epoch: 2	Loss: 0.544041
Client Index = 12	Epoch: 3	Loss: 0.483065
Client Index = 12	Epoch: 4	Loss: 0.468839
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 13
local mask changes: 2078600.0 / 11173962
choose client_indexes: [ 2  9 13 15 17], accoring to random
choose mask diff: [2241962.0, 2245486.0, 2078600.0, 2243106.0, 2244718.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.654910
Client Index = 13	Epoch: 1	Loss: 0.539975
Client Index = 13	Epoch: 2	Loss: 0.580822
Client Index = 13	Epoch: 3	Loss: 0.527839
Client Index = 13	Epoch: 4	Loss: 0.530565
test acc on this client after 335 / 503 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 14
local mask changes: 2078362.0 / 11173962
choose client_indexes: [ 8 11 14 16 17], accoring to random
choose mask diff: [2243106.0, 2239850.0, 2078362.0, 2241086.0, 2245938.0]
Doing local aggregation!
test acc on this client before 387 / 502 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.680107
Client Index = 14	Epoch: 1	Loss: 0.610275
Client Index = 14	Epoch: 2	Loss: 0.662999
Client Index = 14	Epoch: 3	Loss: 0.532458
Client Index = 14	Epoch: 4	Loss: 0.620530
test acc on this client after 381 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 15
local mask changes: 2078502.0 / 11173962
choose client_indexes: [ 0  3  7 15 17], accoring to random
choose mask diff: [2243572.0, 2238142.0, 2244860.0, 2078502.0, 2245066.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 15	Epoch: 0	Loss: 0.530289
Client Index = 15	Epoch: 1	Loss: 0.563680
Client Index = 15	Epoch: 2	Loss: 0.449647
Client Index = 15	Epoch: 3	Loss: 0.468944
Client Index = 15	Epoch: 4	Loss: 0.450032
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 16
local mask changes: 2077582.0 / 11173962
choose client_indexes: [ 2 16 17 18 19], accoring to random
choose mask diff: [2241522.0, 2077582.0, 2244964.0, 2238020.0, 2239156.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 16	Epoch: 0	Loss: 0.557645
Client Index = 16	Epoch: 1	Loss: 0.488039
Client Index = 16	Epoch: 2	Loss: 0.481989
Client Index = 16	Epoch: 3	Loss: 0.535176
Client Index = 16	Epoch: 4	Loss: 0.457593
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 17
local mask changes: 2079498.0 / 11173962
choose client_indexes: [10 11 13 15 17], accoring to random
choose mask diff: [2245218.0, 2241978.0, 2245790.0, 2245626.0, 2079498.0]
Doing local aggregation!
test acc on this client before 352 / 505 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.670817
Client Index = 17	Epoch: 1	Loss: 0.452660
Client Index = 17	Epoch: 2	Loss: 0.462498
Client Index = 17	Epoch: 3	Loss: 0.347647
Client Index = 17	Epoch: 4	Loss: 0.394777
test acc on this client after 371 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 18
local mask changes: 2081028.0 / 11173962
choose client_indexes: [ 7  8 10 18 19], accoring to random
choose mask diff: [2240362.0, 2240740.0, 2240648.0, 2081028.0, 2236764.0]
Doing local aggregation!
test acc on this client before 395 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.494593
Client Index = 18	Epoch: 1	Loss: 0.392959
Client Index = 18	Epoch: 2	Loss: 0.378064
Client Index = 18	Epoch: 3	Loss: 0.369228
Client Index = 18	Epoch: 4	Loss: 0.428307
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(43) with spasity 0.5: 19
local mask changes: 2080028.0 / 11173962
choose client_indexes: [ 3 12 15 18 19], accoring to random
choose mask diff: [2240660.0, 2242626.0, 2240880.0, 2241774.0, 2080028.0]
Doing local aggregation!
test acc on this client before 389 / 506 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.524190
Client Index = 19	Epoch: 1	Loss: 0.509309
Client Index = 19	Epoch: 2	Loss: 0.487987
Client Index = 19	Epoch: 3	Loss: 0.401685
Client Index = 19	Epoch: 4	Loss: 0.422344
test acc on this client after 350 / 506 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 43
{'test_acc': 0.7521914663065715, 'test_loss': 0.7551183448625107}
################local_test_on_all_clients before local training in communication round: 43
{'test_acc': 0.7310348838587362, 'test_loss': 0.7813413889053937}
################Communication round : 44
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 0
local mask changes: 2039948.0 / 11173962
choose client_indexes: [ 0  8  9 11 13], accoring to random
choose mask diff: [2039948.0, 2208182.0, 2213772.0, 2210700.0, 2214096.0]
Doing local aggregation!
test acc on this client before 282 / 504 : 0.56
Client Index = 0	Epoch: 0	Loss: 0.808083
Client Index = 0	Epoch: 1	Loss: 0.763932
Client Index = 0	Epoch: 2	Loss: 0.689364
Client Index = 0	Epoch: 3	Loss: 0.747944
Client Index = 0	Epoch: 4	Loss: 0.644282
test acc on this client after 334 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 1
local mask changes: 2038968.0 / 11173962
choose client_indexes: [ 1  3  8 11 16], accoring to random
choose mask diff: [2038968.0, 2210276.0, 2206254.0, 2203704.0, 2209000.0]
Doing local aggregation!
test acc on this client before 333 / 503 : 0.66
Client Index = 1	Epoch: 0	Loss: 0.567140
Client Index = 1	Epoch: 1	Loss: 0.366586
Client Index = 1	Epoch: 2	Loss: 0.342333
Client Index = 1	Epoch: 3	Loss: 0.387480
Client Index = 1	Epoch: 4	Loss: 0.309964
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 2
local mask changes: 2039142.0 / 11173962
choose client_indexes: [ 2  4 10 14 16], accoring to random
choose mask diff: [2039142.0, 2209342.0, 2209962.0, 2207910.0, 2208648.0]
Doing local aggregation!
test acc on this client before 376 / 502 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.451164
Client Index = 2	Epoch: 1	Loss: 0.446625
Client Index = 2	Epoch: 2	Loss: 0.345184
Client Index = 2	Epoch: 3	Loss: 0.331330
Client Index = 2	Epoch: 4	Loss: 0.392119
test acc on this client after 380 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 3
local mask changes: 2039544.0 / 11173962
choose client_indexes: [ 0  2  3  8 17], accoring to random
choose mask diff: [2207798.0, 2200674.0, 2039544.0, 2208060.0, 2205822.0]
Doing local aggregation!
test acc on this client before 354 / 504 : 0.70
Client Index = 3	Epoch: 0	Loss: 0.752173
Client Index = 3	Epoch: 1	Loss: 0.689985
Client Index = 3	Epoch: 2	Loss: 0.631667
Client Index = 3	Epoch: 3	Loss: 0.595641
Client Index = 3	Epoch: 4	Loss: 0.622355
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 4
local mask changes: 2039436.0 / 11173962
choose client_indexes: [ 2  4  7 11 19], accoring to random
choose mask diff: [2209922.0, 2039436.0, 2203008.0, 2205296.0, 2208362.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.623118
Client Index = 4	Epoch: 1	Loss: 0.492696
Client Index = 4	Epoch: 2	Loss: 0.410042
Client Index = 4	Epoch: 3	Loss: 0.495114
Client Index = 4	Epoch: 4	Loss: 0.333880
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 5
local mask changes: 2038520.0 / 11173962
choose client_indexes: [ 3  5  7 11 17], accoring to random
choose mask diff: [2210810.0, 2038520.0, 2202650.0, 2205730.0, 2202896.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.616564
Client Index = 5	Epoch: 1	Loss: 0.484551
Client Index = 5	Epoch: 2	Loss: 0.550691
Client Index = 5	Epoch: 3	Loss: 0.420630
Client Index = 5	Epoch: 4	Loss: 0.408879
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 6
local mask changes: 2037332.0 / 11173962
choose client_indexes: [ 0  3  6  7 12], accoring to random
choose mask diff: [2207202.0, 2209270.0, 2037332.0, 2207610.0, 2215298.0]
Doing local aggregation!
test acc on this client before 359 / 505 : 0.71
Client Index = 6	Epoch: 0	Loss: 0.805479
Client Index = 6	Epoch: 1	Loss: 0.736727
Client Index = 6	Epoch: 2	Loss: 0.732037
Client Index = 6	Epoch: 3	Loss: 0.680243
Client Index = 6	Epoch: 4	Loss: 0.676751
test acc on this client after 283 / 505 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 7
local mask changes: 2039182.0 / 11173962
choose client_indexes: [ 6  7  9 13 17], accoring to random
choose mask diff: [2201700.0, 2039182.0, 2201780.0, 2211332.0, 2203592.0]
Doing local aggregation!
test acc on this client before 363 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.609436
Client Index = 7	Epoch: 1	Loss: 0.614585
Client Index = 7	Epoch: 2	Loss: 0.569239
Client Index = 7	Epoch: 3	Loss: 0.470246
Client Index = 7	Epoch: 4	Loss: 0.527502
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 8
local mask changes: 2041046.0 / 11173962
choose client_indexes: [ 3  6  8 10 12], accoring to random
choose mask diff: [2214798.0, 2209520.0, 2041046.0, 2211042.0, 2210188.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 8	Epoch: 0	Loss: 0.720421
Client Index = 8	Epoch: 1	Loss: 0.688534
Client Index = 8	Epoch: 2	Loss: 0.591339
Client Index = 8	Epoch: 3	Loss: 0.504558
Client Index = 8	Epoch: 4	Loss: 0.564242
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 9
local mask changes: 2040098.0 / 11173962
choose client_indexes: [ 4  8  9 13 16], accoring to random
choose mask diff: [2207382.0, 2212764.0, 2040098.0, 2212302.0, 2209808.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.542505
Client Index = 9	Epoch: 1	Loss: 0.464826
Client Index = 9	Epoch: 2	Loss: 0.450342
Client Index = 9	Epoch: 3	Loss: 0.413842
Client Index = 9	Epoch: 4	Loss: 0.383400
test acc on this client after 359 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 10
local mask changes: 2040280.0 / 11173962
choose client_indexes: [ 7  9 10 15 18], accoring to random
choose mask diff: [2210778.0, 2216228.0, 2040280.0, 2209614.0, 2202968.0]
Doing local aggregation!
test acc on this client before 344 / 503 : 0.68
Client Index = 10	Epoch: 0	Loss: 0.693176
Client Index = 10	Epoch: 1	Loss: 0.677141
Client Index = 10	Epoch: 2	Loss: 0.536330
Client Index = 10	Epoch: 3	Loss: 0.592011
Client Index = 10	Epoch: 4	Loss: 0.540668
test acc on this client after 334 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 11
local mask changes: 2038320.0 / 11173962
choose client_indexes: [ 0  3  7 11 19], accoring to random
choose mask diff: [2203358.0, 2207856.0, 2208798.0, 2038320.0, 2208032.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 11	Epoch: 0	Loss: 0.446148
Client Index = 11	Epoch: 1	Loss: 0.449587
Client Index = 11	Epoch: 2	Loss: 0.333385
Client Index = 11	Epoch: 3	Loss: 0.307010
Client Index = 11	Epoch: 4	Loss: 0.243772
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 12
local mask changes: 2040074.0 / 11173962
choose client_indexes: [ 3 10 12 13 18], accoring to random
choose mask diff: [2210726.0, 2210270.0, 2040074.0, 2211568.0, 2205454.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.633356
Client Index = 12	Epoch: 1	Loss: 0.556323
Client Index = 12	Epoch: 2	Loss: 0.486444
Client Index = 12	Epoch: 3	Loss: 0.507914
Client Index = 12	Epoch: 4	Loss: 0.464811
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 13
local mask changes: 2038896.0 / 11173962
choose client_indexes: [ 3  8  9 13 19], accoring to random
choose mask diff: [2207996.0, 2211706.0, 2207840.0, 2038896.0, 2206774.0]
Doing local aggregation!
test acc on this client before 354 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.645264
Client Index = 13	Epoch: 1	Loss: 0.572981
Client Index = 13	Epoch: 2	Loss: 0.522187
Client Index = 13	Epoch: 3	Loss: 0.538985
Client Index = 13	Epoch: 4	Loss: 0.570293
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 14
local mask changes: 2039014.0 / 11173962
choose client_indexes: [ 2  3  6 11 14], accoring to random
choose mask diff: [2208746.0, 2205332.0, 2209564.0, 2203696.0, 2039014.0]
Doing local aggregation!
test acc on this client before 388 / 502 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.632831
Client Index = 14	Epoch: 1	Loss: 0.615926
Client Index = 14	Epoch: 2	Loss: 0.596130
Client Index = 14	Epoch: 3	Loss: 0.544603
Client Index = 14	Epoch: 4	Loss: 0.615839
test acc on this client after 367 / 502 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 15
local mask changes: 2037754.0 / 11173962
choose client_indexes: [ 4  5  9 10 15], accoring to random
choose mask diff: [2206724.0, 2205668.0, 2209478.0, 2211316.0, 2037754.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 15	Epoch: 0	Loss: 0.508482
Client Index = 15	Epoch: 1	Loss: 0.483109
Client Index = 15	Epoch: 2	Loss: 0.387934
Client Index = 15	Epoch: 3	Loss: 0.444701
Client Index = 15	Epoch: 4	Loss: 0.468190
test acc on this client after 337 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 16
local mask changes: 2039318.0 / 11173962
choose client_indexes: [ 1  2 10 14 16], accoring to random
choose mask diff: [2207566.0, 2201964.0, 2210948.0, 2208180.0, 2039318.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.492078
Client Index = 16	Epoch: 1	Loss: 0.485583
Client Index = 16	Epoch: 2	Loss: 0.538398
Client Index = 16	Epoch: 3	Loss: 0.489334
Client Index = 16	Epoch: 4	Loss: 0.376626
test acc on this client after 358 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 17
local mask changes: 2039752.0 / 11173962
choose client_indexes: [ 0  1  3 17 19], accoring to random
choose mask diff: [2206536.0, 2208010.0, 2209772.0, 2039752.0, 2205006.0]
Doing local aggregation!
test acc on this client before 380 / 505 : 0.75
Client Index = 17	Epoch: 0	Loss: 0.518217
Client Index = 17	Epoch: 1	Loss: 0.472551
Client Index = 17	Epoch: 2	Loss: 0.411210
Client Index = 17	Epoch: 3	Loss: 0.376355
Client Index = 17	Epoch: 4	Loss: 0.360868
test acc on this client after 417 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 18
local mask changes: 2038334.0 / 11173962
choose client_indexes: [ 6 10 13 18 19], accoring to random
choose mask diff: [2207344.0, 2203502.0, 2210806.0, 2038334.0, 2198086.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 18	Epoch: 0	Loss: 0.455394
Client Index = 18	Epoch: 1	Loss: 0.385388
Client Index = 18	Epoch: 2	Loss: 0.371779
Client Index = 18	Epoch: 3	Loss: 0.355074
Client Index = 18	Epoch: 4	Loss: 0.308951
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(44) with spasity 0.5: 19
local mask changes: 2039042.0 / 11173962
choose client_indexes: [ 7 12 13 17 19], accoring to random
choose mask diff: [2208228.0, 2203958.0, 2206404.0, 2205770.0, 2039042.0]
Doing local aggregation!
test acc on this client before 379 / 506 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.603175
Client Index = 19	Epoch: 1	Loss: 0.482456
Client Index = 19	Epoch: 2	Loss: 0.538620
Client Index = 19	Epoch: 3	Loss: 0.455353
Client Index = 19	Epoch: 4	Loss: 0.411055
test acc on this client after 388 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 44
{'test_acc': 0.738862331795607, 'test_loss': 0.8163165568934149}
################local_test_on_all_clients before local training in communication round: 44
{'test_acc': 0.7288356102725947, 'test_loss': 0.7982334317964314}
################Communication round : 45
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 0
local mask changes: 1999030.0 / 11173962
choose client_indexes: [ 0  1  4 11 17], accoring to random
choose mask diff: [1999030.0, 2172046.0, 2175966.0, 2167980.0, 2173080.0]
Doing local aggregation!
test acc on this client before 334 / 504 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.791225
Client Index = 0	Epoch: 1	Loss: 0.718700
Client Index = 0	Epoch: 2	Loss: 0.733733
Client Index = 0	Epoch: 3	Loss: 0.662458
Client Index = 0	Epoch: 4	Loss: 0.631637
test acc on this client after 339 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 1
local mask changes: 1999344.0 / 11173962
choose client_indexes: [ 1  2  7 18 19], accoring to random
choose mask diff: [1999344.0, 2167912.0, 2176268.0, 2162430.0, 2175434.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.450056
Client Index = 1	Epoch: 1	Loss: 0.433279
Client Index = 1	Epoch: 2	Loss: 0.348764
Client Index = 1	Epoch: 3	Loss: 0.389843
Client Index = 1	Epoch: 4	Loss: 0.297548
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 2
local mask changes: 1998876.0 / 11173962
choose client_indexes: [ 2  6 10 11 17], accoring to random
choose mask diff: [1998876.0, 2170434.0, 2169828.0, 2167980.0, 2170288.0]
Doing local aggregation!
test acc on this client before 410 / 502 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.448805
Client Index = 2	Epoch: 1	Loss: 0.392627
Client Index = 2	Epoch: 2	Loss: 0.337896
Client Index = 2	Epoch: 3	Loss: 0.306671
Client Index = 2	Epoch: 4	Loss: 0.290265
test acc on this client after 407 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 3
local mask changes: 1998132.0 / 11173962
choose client_indexes: [ 1  3  4 16 18], accoring to random
choose mask diff: [2175426.0, 1998132.0, 2173612.0, 2175426.0, 2173290.0]
Doing local aggregation!
test acc on this client before 276 / 504 : 0.55
Client Index = 3	Epoch: 0	Loss: 0.724501
Client Index = 3	Epoch: 1	Loss: 0.680536
Client Index = 3	Epoch: 2	Loss: 0.610015
Client Index = 3	Epoch: 3	Loss: 0.631889
Client Index = 3	Epoch: 4	Loss: 0.597238
test acc on this client after 373 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 4
local mask changes: 2000058.0 / 11173962
choose client_indexes: [ 0  4  6 10 18], accoring to random
choose mask diff: [2176712.0, 2000058.0, 2173534.0, 2179246.0, 2173906.0]
Doing local aggregation!
test acc on this client before 367 / 503 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.544360
Client Index = 4	Epoch: 1	Loss: 0.468608
Client Index = 4	Epoch: 2	Loss: 0.382602
Client Index = 4	Epoch: 3	Loss: 0.419423
Client Index = 4	Epoch: 4	Loss: 0.359775
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 5
local mask changes: 1998334.0 / 11173962
choose client_indexes: [ 2  5  7  9 18], accoring to random
choose mask diff: [2171618.0, 1998334.0, 2166204.0, 2172964.0, 2169162.0]
Doing local aggregation!
test acc on this client before 315 / 504 : 0.62
Client Index = 5	Epoch: 0	Loss: 0.590653
Client Index = 5	Epoch: 1	Loss: 0.452056
Client Index = 5	Epoch: 2	Loss: 0.532920
Client Index = 5	Epoch: 3	Loss: 0.401235
Client Index = 5	Epoch: 4	Loss: 0.415276
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 6
local mask changes: 1998444.0 / 11173962
choose client_indexes: [ 0  6 16 17 18], accoring to random
choose mask diff: [2171002.0, 1998444.0, 2175620.0, 2175470.0, 2176010.0]
Doing local aggregation!
test acc on this client before 329 / 505 : 0.65
Client Index = 6	Epoch: 0	Loss: 0.893165
Client Index = 6	Epoch: 1	Loss: 0.741925
Client Index = 6	Epoch: 2	Loss: 0.689460
Client Index = 6	Epoch: 3	Loss: 0.720984
Client Index = 6	Epoch: 4	Loss: 0.714019
test acc on this client after 356 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 7
local mask changes: 1998374.0 / 11173962
choose client_indexes: [ 1  2  7 14 18], accoring to random
choose mask diff: [2173640.0, 2171808.0, 1998374.0, 2174434.0, 2170642.0]
Doing local aggregation!
test acc on this client before 376 / 504 : 0.75
Client Index = 7	Epoch: 0	Loss: 0.717634
Client Index = 7	Epoch: 1	Loss: 0.526998
Client Index = 7	Epoch: 2	Loss: 0.517525
Client Index = 7	Epoch: 3	Loss: 0.481792
Client Index = 7	Epoch: 4	Loss: 0.515158
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 8
local mask changes: 2000314.0 / 11173962
choose client_indexes: [ 1  2  6  8 11], accoring to random
choose mask diff: [2172768.0, 2172496.0, 2172622.0, 2000314.0, 2173280.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 8	Epoch: 0	Loss: 0.823404
Client Index = 8	Epoch: 1	Loss: 0.578532
Client Index = 8	Epoch: 2	Loss: 0.638532
Client Index = 8	Epoch: 3	Loss: 0.611214
Client Index = 8	Epoch: 4	Loss: 0.519170
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 9
local mask changes: 1999226.0 / 11173962
choose client_indexes: [ 0  2  9 10 16], accoring to random
choose mask diff: [2180546.0, 2170206.0, 1999226.0, 2178966.0, 2172258.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 9	Epoch: 0	Loss: 0.574159
Client Index = 9	Epoch: 1	Loss: 0.435876
Client Index = 9	Epoch: 2	Loss: 0.520113
Client Index = 9	Epoch: 3	Loss: 0.376340
Client Index = 9	Epoch: 4	Loss: 0.392345
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 10
local mask changes: 1998448.0 / 11173962
choose client_indexes: [ 4  7  8 10 13], accoring to random
choose mask diff: [2178558.0, 2170080.0, 2173356.0, 1998448.0, 2175372.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 10	Epoch: 0	Loss: 0.699574
Client Index = 10	Epoch: 1	Loss: 0.576334
Client Index = 10	Epoch: 2	Loss: 0.550006
Client Index = 10	Epoch: 3	Loss: 0.551455
Client Index = 10	Epoch: 4	Loss: 0.543700
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 11
local mask changes: 1999546.0 / 11173962
choose client_indexes: [ 3  5  6 11 14], accoring to random
choose mask diff: [2169284.0, 2171564.0, 2175502.0, 1999546.0, 2166460.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.474702
Client Index = 11	Epoch: 1	Loss: 0.324806
Client Index = 11	Epoch: 2	Loss: 0.425945
Client Index = 11	Epoch: 3	Loss: 0.296880
Client Index = 11	Epoch: 4	Loss: 0.293757
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 12
local mask changes: 2000270.0 / 11173962
choose client_indexes: [10 12 14 15 16], accoring to random
choose mask diff: [2169742.0, 2000270.0, 2176094.0, 2168696.0, 2175262.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 12	Epoch: 0	Loss: 0.700052
Client Index = 12	Epoch: 1	Loss: 0.504499
Client Index = 12	Epoch: 2	Loss: 0.491703
Client Index = 12	Epoch: 3	Loss: 0.573123
Client Index = 12	Epoch: 4	Loss: 0.499516
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 13
local mask changes: 1997538.0 / 11173962
choose client_indexes: [ 1  9 10 12 13], accoring to random
choose mask diff: [2175212.0, 2171046.0, 2175730.0, 2176544.0, 1997538.0]
Doing local aggregation!
test acc on this client before 355 / 503 : 0.71
Client Index = 13	Epoch: 0	Loss: 0.615590
Client Index = 13	Epoch: 1	Loss: 0.562642
Client Index = 13	Epoch: 2	Loss: 0.525123
Client Index = 13	Epoch: 3	Loss: 0.529000
Client Index = 13	Epoch: 4	Loss: 0.466958
test acc on this client after 346 / 503 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 14
local mask changes: 1998780.0 / 11173962
choose client_indexes: [ 0  4  6 10 14], accoring to random
choose mask diff: [2177812.0, 2180670.0, 2172062.0, 2178908.0, 1998780.0]
Doing local aggregation!
test acc on this client before 379 / 502 : 0.75
Client Index = 14	Epoch: 0	Loss: 0.687175
Client Index = 14	Epoch: 1	Loss: 0.628515
Client Index = 14	Epoch: 2	Loss: 0.580913
Client Index = 14	Epoch: 3	Loss: 0.579983
Client Index = 14	Epoch: 4	Loss: 0.563720
test acc on this client after 355 / 502 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 15
local mask changes: 1998794.0 / 11173962
choose client_indexes: [ 2  4 13 15 17], accoring to random
choose mask diff: [2175994.0, 2171022.0, 2170692.0, 1998794.0, 2170506.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.509614
Client Index = 15	Epoch: 1	Loss: 0.488310
Client Index = 15	Epoch: 2	Loss: 0.430718
Client Index = 15	Epoch: 3	Loss: 0.424491
Client Index = 15	Epoch: 4	Loss: 0.534503
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 16
local mask changes: 1998102.0 / 11173962
choose client_indexes: [ 3  4  8  9 16], accoring to random
choose mask diff: [2174846.0, 2174284.0, 2174376.0, 2174394.0, 1998102.0]
Doing local aggregation!
test acc on this client before 380 / 503 : 0.76
Client Index = 16	Epoch: 0	Loss: 0.589834
Client Index = 16	Epoch: 1	Loss: 0.461622
Client Index = 16	Epoch: 2	Loss: 0.420755
Client Index = 16	Epoch: 3	Loss: 0.427426
Client Index = 16	Epoch: 4	Loss: 0.405606
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 17
local mask changes: 1998164.0 / 11173962
choose client_indexes: [ 1  6  8 16 17], accoring to random
choose mask diff: [2163730.0, 2174844.0, 2173178.0, 2171884.0, 1998164.0]
Doing local aggregation!
test acc on this client before 297 / 505 : 0.59
Client Index = 17	Epoch: 0	Loss: 0.623426
Client Index = 17	Epoch: 1	Loss: 0.452167
Client Index = 17	Epoch: 2	Loss: 0.428750
Client Index = 17	Epoch: 3	Loss: 0.412448
Client Index = 17	Epoch: 4	Loss: 0.371842
test acc on this client after 411 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 18
local mask changes: 1999098.0 / 11173962
choose client_indexes: [ 7 12 15 17 18], accoring to random
choose mask diff: [2172302.0, 2171374.0, 2171062.0, 2169834.0, 1999098.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 18	Epoch: 0	Loss: 0.503019
Client Index = 18	Epoch: 1	Loss: 0.385153
Client Index = 18	Epoch: 2	Loss: 0.346119
Client Index = 18	Epoch: 3	Loss: 0.353507
Client Index = 18	Epoch: 4	Loss: 0.296326
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(45) with spasity 0.5: 19
local mask changes: 1998358.0 / 11173962
choose client_indexes: [ 3  7 11 17 19], accoring to random
choose mask diff: [2172078.0, 2169284.0, 2173586.0, 2168334.0, 1998358.0]
Doing local aggregation!
test acc on this client before 379 / 506 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.511046
Client Index = 19	Epoch: 1	Loss: 0.507082
Client Index = 19	Epoch: 2	Loss: 0.404756
Client Index = 19	Epoch: 3	Loss: 0.472507
Client Index = 19	Epoch: 4	Loss: 0.356904
test acc on this client after 385 / 506 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 45
{'test_acc': 0.7560290318994223, 'test_loss': 0.7287123256755661}
################local_test_on_all_clients before local training in communication round: 45
{'test_acc': 0.7202489658685509, 'test_loss': 0.8035618293349398}
################Communication round : 46
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 0
local mask changes: 1959304.0 / 11173962
choose client_indexes: [ 0  3  4  5 14], accoring to random
choose mask diff: [1959304.0, 2137064.0, 2136170.0, 2139022.0, 2143208.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.737458
Client Index = 0	Epoch: 1	Loss: 0.739137
Client Index = 0	Epoch: 2	Loss: 0.681011
Client Index = 0	Epoch: 3	Loss: 0.677705
Client Index = 0	Epoch: 4	Loss: 0.694760
test acc on this client after 328 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 1
local mask changes: 1957032.0 / 11173962
choose client_indexes: [ 1  9 12 15 17], accoring to random
choose mask diff: [1957032.0, 2137392.0, 2139396.0, 2136546.0, 2129214.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.552156
Client Index = 1	Epoch: 1	Loss: 0.364158
Client Index = 1	Epoch: 2	Loss: 0.349992
Client Index = 1	Epoch: 3	Loss: 0.297322
Client Index = 1	Epoch: 4	Loss: 0.278419
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 2
local mask changes: 1958184.0 / 11173962
choose client_indexes: [ 2  4  7  8 15], accoring to random
choose mask diff: [1958184.0, 2134656.0, 2134910.0, 2137202.0, 2141066.0]
Doing local aggregation!
test acc on this client before 355 / 502 : 0.71
Client Index = 2	Epoch: 0	Loss: 0.478916
Client Index = 2	Epoch: 1	Loss: 0.338369
Client Index = 2	Epoch: 2	Loss: 0.348219
Client Index = 2	Epoch: 3	Loss: 0.280762
Client Index = 2	Epoch: 4	Loss: 0.245409
test acc on this client after 404 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 3
local mask changes: 1957982.0 / 11173962
choose client_indexes: [ 3  9 13 14 18], accoring to random
choose mask diff: [1957982.0, 2142848.0, 2137594.0, 2132788.0, 2135562.0]
Doing local aggregation!
test acc on this client before 312 / 504 : 0.62
Client Index = 3	Epoch: 0	Loss: 0.788783
Client Index = 3	Epoch: 1	Loss: 0.615862
Client Index = 3	Epoch: 2	Loss: 0.665091
Client Index = 3	Epoch: 3	Loss: 0.646816
Client Index = 3	Epoch: 4	Loss: 0.530083
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 4
local mask changes: 1957016.0 / 11173962
choose client_indexes: [ 0  4  9 13 14], accoring to random
choose mask diff: [2134206.0, 1957016.0, 2138402.0, 2138790.0, 2142048.0]
Doing local aggregation!
test acc on this client before 330 / 503 : 0.66
Client Index = 4	Epoch: 0	Loss: 0.606004
Client Index = 4	Epoch: 1	Loss: 0.455300
Client Index = 4	Epoch: 2	Loss: 0.351398
Client Index = 4	Epoch: 3	Loss: 0.427560
Client Index = 4	Epoch: 4	Loss: 0.337733
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 5
local mask changes: 1959944.0 / 11173962
choose client_indexes: [ 3  5  9 18 19], accoring to random
choose mask diff: [2137594.0, 1959944.0, 2133586.0, 2130944.0, 2135006.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 5	Epoch: 0	Loss: 0.599454
Client Index = 5	Epoch: 1	Loss: 0.502681
Client Index = 5	Epoch: 2	Loss: 0.477900
Client Index = 5	Epoch: 3	Loss: 0.419329
Client Index = 5	Epoch: 4	Loss: 0.388089
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 6
local mask changes: 1957016.0 / 11173962
choose client_indexes: [ 4  5  6  7 14], accoring to random
choose mask diff: [2140192.0, 2137910.0, 1957016.0, 2133790.0, 2140508.0]
Doing local aggregation!
test acc on this client before 363 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.804002
Client Index = 6	Epoch: 1	Loss: 0.697267
Client Index = 6	Epoch: 2	Loss: 0.664284
Client Index = 6	Epoch: 3	Loss: 0.686486
Client Index = 6	Epoch: 4	Loss: 0.681077
test acc on this client after 335 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 7
local mask changes: 1958640.0 / 11173962
choose client_indexes: [ 1  7  9 11 12], accoring to random
choose mask diff: [2136466.0, 1958640.0, 2135550.0, 2136560.0, 2140174.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.631719
Client Index = 7	Epoch: 1	Loss: 0.571663
Client Index = 7	Epoch: 2	Loss: 0.483506
Client Index = 7	Epoch: 3	Loss: 0.505377
Client Index = 7	Epoch: 4	Loss: 0.487055
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 8
local mask changes: 1958132.0 / 11173962
choose client_indexes: [ 4  7  8  9 19], accoring to random
choose mask diff: [2138334.0, 2142372.0, 1958132.0, 2143472.0, 2143994.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 8	Epoch: 0	Loss: 0.705089
Client Index = 8	Epoch: 1	Loss: 0.599444
Client Index = 8	Epoch: 2	Loss: 0.688738
Client Index = 8	Epoch: 3	Loss: 0.596291
Client Index = 8	Epoch: 4	Loss: 0.501645
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 9
local mask changes: 1958410.0 / 11173962
choose client_indexes: [ 4  7  9 13 18], accoring to random
choose mask diff: [2140048.0, 2137296.0, 1958410.0, 2135402.0, 2138776.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 9	Epoch: 0	Loss: 0.505324
Client Index = 9	Epoch: 1	Loss: 0.408231
Client Index = 9	Epoch: 2	Loss: 0.417396
Client Index = 9	Epoch: 3	Loss: 0.411569
Client Index = 9	Epoch: 4	Loss: 0.365687
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 10
local mask changes: 1957514.0 / 11173962
choose client_indexes: [ 4  6  9 10 18], accoring to random
choose mask diff: [2138524.0, 2145016.0, 2141806.0, 1957514.0, 2131572.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 10	Epoch: 0	Loss: 0.632264
Client Index = 10	Epoch: 1	Loss: 0.504872
Client Index = 10	Epoch: 2	Loss: 0.608801
Client Index = 10	Epoch: 3	Loss: 0.450250
Client Index = 10	Epoch: 4	Loss: 0.625220
test acc on this client after 379 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 11
local mask changes: 1958248.0 / 11173962
choose client_indexes: [ 1  3  4 11 19], accoring to random
choose mask diff: [2137644.0, 2129718.0, 2133330.0, 1958248.0, 2137174.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 11	Epoch: 0	Loss: 0.547055
Client Index = 11	Epoch: 1	Loss: 0.333277
Client Index = 11	Epoch: 2	Loss: 0.269483
Client Index = 11	Epoch: 3	Loss: 0.461639
Client Index = 11	Epoch: 4	Loss: 0.258098
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 12
local mask changes: 1957782.0 / 11173962
choose client_indexes: [ 2  3  5 12 16], accoring to random
choose mask diff: [2138878.0, 2140474.0, 2138100.0, 1957782.0, 2137212.0]
Doing local aggregation!
test acc on this client before 289 / 504 : 0.57
Client Index = 12	Epoch: 0	Loss: 0.786235
Client Index = 12	Epoch: 1	Loss: 0.500794
Client Index = 12	Epoch: 2	Loss: 0.485771
Client Index = 12	Epoch: 3	Loss: 0.465826
Client Index = 12	Epoch: 4	Loss: 0.457243
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 13
local mask changes: 1957376.0 / 11173962
choose client_indexes: [ 4  8  9 13 16], accoring to random
choose mask diff: [2139600.0, 2142624.0, 2131102.0, 1957376.0, 2140320.0]
Doing local aggregation!
test acc on this client before 362 / 503 : 0.72
Client Index = 13	Epoch: 0	Loss: 0.615730
Client Index = 13	Epoch: 1	Loss: 0.520625
Client Index = 13	Epoch: 2	Loss: 0.517189
Client Index = 13	Epoch: 3	Loss: 0.617198
Client Index = 13	Epoch: 4	Loss: 0.569505
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 14
local mask changes: 1958602.0 / 11173962
choose client_indexes: [ 7 11 12 14 17], accoring to random
choose mask diff: [2138822.0, 2132144.0, 2143718.0, 1958602.0, 2141502.0]
Doing local aggregation!
test acc on this client before 373 / 502 : 0.74
Client Index = 14	Epoch: 0	Loss: 0.616302
Client Index = 14	Epoch: 1	Loss: 0.665141
Client Index = 14	Epoch: 2	Loss: 0.539517
Client Index = 14	Epoch: 3	Loss: 0.537220
Client Index = 14	Epoch: 4	Loss: 0.566535
test acc on this client after 359 / 502 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 15
local mask changes: 1957474.0 / 11173962
choose client_indexes: [ 1  4 15 17 19], accoring to random
choose mask diff: [2135192.0, 2132018.0, 1957474.0, 2133472.0, 2136092.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.506923
Client Index = 15	Epoch: 1	Loss: 0.428490
Client Index = 15	Epoch: 2	Loss: 0.568073
Client Index = 15	Epoch: 3	Loss: 0.396887
Client Index = 15	Epoch: 4	Loss: 0.363630
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 16
local mask changes: 1957588.0 / 11173962
choose client_indexes: [ 3  9 10 15 16], accoring to random
choose mask diff: [2135208.0, 2132112.0, 2140966.0, 2140226.0, 1957588.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 16	Epoch: 0	Loss: 0.471908
Client Index = 16	Epoch: 1	Loss: 0.428580
Client Index = 16	Epoch: 2	Loss: 0.405437
Client Index = 16	Epoch: 3	Loss: 0.517870
Client Index = 16	Epoch: 4	Loss: 0.408772
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 17
local mask changes: 1959256.0 / 11173962
choose client_indexes: [ 4  9 10 13 17], accoring to random
choose mask diff: [2141244.0, 2139944.0, 2138810.0, 2137586.0, 1959256.0]
Doing local aggregation!
test acc on this client before 353 / 505 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.611809
Client Index = 17	Epoch: 1	Loss: 0.440039
Client Index = 17	Epoch: 2	Loss: 0.447016
Client Index = 17	Epoch: 3	Loss: 0.355080
Client Index = 17	Epoch: 4	Loss: 0.385045
test acc on this client after 418 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 18
local mask changes: 1957840.0 / 11173962
choose client_indexes: [ 2 12 16 17 18], accoring to random
choose mask diff: [2133890.0, 2129232.0, 2133618.0, 2129870.0, 1957840.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.527556
Client Index = 18	Epoch: 1	Loss: 0.376361
Client Index = 18	Epoch: 2	Loss: 0.344827
Client Index = 18	Epoch: 3	Loss: 0.330288
Client Index = 18	Epoch: 4	Loss: 0.325501
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(46) with spasity 0.5: 19
local mask changes: 1956944.0 / 11173962
choose client_indexes: [ 7 10 13 15 19], accoring to random
choose mask diff: [2131250.0, 2143984.0, 2133634.0, 2139020.0, 1956944.0]
Doing local aggregation!
test acc on this client before 343 / 506 : 0.68
Client Index = 19	Epoch: 0	Loss: 0.547005
Client Index = 19	Epoch: 1	Loss: 0.436813
Client Index = 19	Epoch: 2	Loss: 0.432261
Client Index = 19	Epoch: 3	Loss: 0.431888
Client Index = 19	Epoch: 4	Loss: 0.371485
test acc on this client after 379 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 46
{'test_acc': 0.7647694223725112, 'test_loss': 0.7380325175874864}
################local_test_on_all_clients before local training in communication round: 46
{'test_acc': 0.7163449468340051, 'test_loss': 0.8305103190936413}
################Communication round : 47
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 0
local mask changes: 1917184.0 / 11173962
choose client_indexes: [ 0  4  9 14 15], accoring to random
choose mask diff: [1917184.0, 2096734.0, 2107754.0, 2102354.0, 2107790.0]
Doing local aggregation!
test acc on this client before 314 / 504 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.797162
Client Index = 0	Epoch: 1	Loss: 0.668838
Client Index = 0	Epoch: 2	Loss: 0.637866
Client Index = 0	Epoch: 3	Loss: 0.644958
Client Index = 0	Epoch: 4	Loss: 0.643762
test acc on this client after 326 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 1
local mask changes: 1916916.0 / 11173962
choose client_indexes: [ 0  1  5 15 17], accoring to random
choose mask diff: [2101368.0, 1916916.0, 2101032.0, 2095876.0, 2090534.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.490185
Client Index = 1	Epoch: 1	Loss: 0.334315
Client Index = 1	Epoch: 2	Loss: 0.376140
Client Index = 1	Epoch: 3	Loss: 0.337009
Client Index = 1	Epoch: 4	Loss: 0.327195
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 2
local mask changes: 1917386.0 / 11173962
choose client_indexes: [ 2  9 11 12 17], accoring to random
choose mask diff: [1917386.0, 2101216.0, 2096614.0, 2103434.0, 2097958.0]
Doing local aggregation!
test acc on this client before 413 / 502 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.403898
Client Index = 2	Epoch: 1	Loss: 0.383787
Client Index = 2	Epoch: 2	Loss: 0.339892
Client Index = 2	Epoch: 3	Loss: 0.304996
Client Index = 2	Epoch: 4	Loss: 0.309959
test acc on this client after 424 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 3
local mask changes: 1915816.0 / 11173962
choose client_indexes: [ 3  6 12 15 18], accoring to random
choose mask diff: [1915816.0, 2105008.0, 2105722.0, 2103010.0, 2097804.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.739081
Client Index = 3	Epoch: 1	Loss: 0.649985
Client Index = 3	Epoch: 2	Loss: 0.621049
Client Index = 3	Epoch: 3	Loss: 0.564336
Client Index = 3	Epoch: 4	Loss: 0.546391
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 4
local mask changes: 1916828.0 / 11173962
choose client_indexes: [ 3  4  8 12 14], accoring to random
choose mask diff: [2101880.0, 1916828.0, 2103870.0, 2106390.0, 2098780.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.585579
Client Index = 4	Epoch: 1	Loss: 0.423096
Client Index = 4	Epoch: 2	Loss: 0.460984
Client Index = 4	Epoch: 3	Loss: 0.335798
Client Index = 4	Epoch: 4	Loss: 0.358254
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 5
local mask changes: 1916346.0 / 11173962
choose client_indexes: [ 2  4  5 15 16], accoring to random
choose mask diff: [2098578.0, 2103048.0, 1916346.0, 2101590.0, 2103120.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.684676
Client Index = 5	Epoch: 1	Loss: 0.490135
Client Index = 5	Epoch: 2	Loss: 0.427948
Client Index = 5	Epoch: 3	Loss: 0.465460
Client Index = 5	Epoch: 4	Loss: 0.371522
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 6
local mask changes: 1915954.0 / 11173962
choose client_indexes: [ 2  3  6  7 15], accoring to random
choose mask diff: [2099524.0, 2105424.0, 1915954.0, 2094840.0, 2110222.0]
Doing local aggregation!
test acc on this client before 363 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.803084
Client Index = 6	Epoch: 1	Loss: 0.665665
Client Index = 6	Epoch: 2	Loss: 0.697981
Client Index = 6	Epoch: 3	Loss: 0.591021
Client Index = 6	Epoch: 4	Loss: 0.640768
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 7
local mask changes: 1916956.0 / 11173962
choose client_indexes: [ 5  7  8 10 13], accoring to random
choose mask diff: [2095754.0, 1916956.0, 2102570.0, 2100674.0, 2105390.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 7	Epoch: 0	Loss: 0.614627
Client Index = 7	Epoch: 1	Loss: 0.478799
Client Index = 7	Epoch: 2	Loss: 0.453961
Client Index = 7	Epoch: 3	Loss: 0.453140
Client Index = 7	Epoch: 4	Loss: 0.452223
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 8
local mask changes: 1915612.0 / 11173962
choose client_indexes: [ 3  8  9 12 15], accoring to random
choose mask diff: [2103530.0, 1915612.0, 2103472.0, 2107410.0, 2104698.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.864977
Client Index = 8	Epoch: 1	Loss: 0.560007
Client Index = 8	Epoch: 2	Loss: 0.635106
Client Index = 8	Epoch: 3	Loss: 0.535057
Client Index = 8	Epoch: 4	Loss: 0.502591
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 9
local mask changes: 1916534.0 / 11173962
choose client_indexes: [ 4  6  8  9 13], accoring to random
choose mask diff: [2101208.0, 2108592.0, 2108752.0, 1916534.0, 2095124.0]
Doing local aggregation!
test acc on this client before 343 / 504 : 0.68
Client Index = 9	Epoch: 0	Loss: 0.490240
Client Index = 9	Epoch: 1	Loss: 0.414643
Client Index = 9	Epoch: 2	Loss: 0.413418
Client Index = 9	Epoch: 3	Loss: 0.365757
Client Index = 9	Epoch: 4	Loss: 0.488394
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 10
local mask changes: 1915750.0 / 11173962
choose client_indexes: [ 4  6  7 10 13], accoring to random
choose mask diff: [2099112.0, 2105636.0, 2103152.0, 1915750.0, 2102180.0]
Doing local aggregation!
test acc on this client before 351 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.600626
Client Index = 10	Epoch: 1	Loss: 0.549193
Client Index = 10	Epoch: 2	Loss: 0.522284
Client Index = 10	Epoch: 3	Loss: 0.580743
Client Index = 10	Epoch: 4	Loss: 0.453889
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 11
local mask changes: 1916494.0 / 11173962
choose client_indexes: [ 8 11 12 15 18], accoring to random
choose mask diff: [2100838.0, 1916494.0, 2106412.0, 2103496.0, 2098542.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.418187
Client Index = 11	Epoch: 1	Loss: 0.301541
Client Index = 11	Epoch: 2	Loss: 0.370268
Client Index = 11	Epoch: 3	Loss: 0.295096
Client Index = 11	Epoch: 4	Loss: 0.274240
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 12
local mask changes: 1915820.0 / 11173962
choose client_indexes: [ 8 12 16 17 19], accoring to random
choose mask diff: [2106422.0, 1915820.0, 2097832.0, 2102390.0, 2101198.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 12	Epoch: 0	Loss: 0.602989
Client Index = 12	Epoch: 1	Loss: 0.501996
Client Index = 12	Epoch: 2	Loss: 0.487710
Client Index = 12	Epoch: 3	Loss: 0.539450
Client Index = 12	Epoch: 4	Loss: 0.477229
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 13
local mask changes: 1916684.0 / 11173962
choose client_indexes: [ 2  3 11 13 16], accoring to random
choose mask diff: [2104628.0, 2105064.0, 2106344.0, 1916684.0, 2101716.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 13	Epoch: 0	Loss: 0.546865
Client Index = 13	Epoch: 1	Loss: 0.520499
Client Index = 13	Epoch: 2	Loss: 0.546453
Client Index = 13	Epoch: 3	Loss: 0.474100
Client Index = 13	Epoch: 4	Loss: 0.451952
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 14
local mask changes: 1916452.0 / 11173962
choose client_indexes: [ 9 13 14 15 18], accoring to random
choose mask diff: [2106956.0, 2109832.0, 1916452.0, 2107420.0, 2101830.0]
Doing local aggregation!
test acc on this client before 367 / 502 : 0.73
Client Index = 14	Epoch: 0	Loss: 0.635532
Client Index = 14	Epoch: 1	Loss: 0.605275
Client Index = 14	Epoch: 2	Loss: 0.532329
Client Index = 14	Epoch: 3	Loss: 0.500384
Client Index = 14	Epoch: 4	Loss: 0.590503
test acc on this client after 384 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 15
local mask changes: 1916556.0 / 11173962
choose client_indexes: [ 0  2  5 10 15], accoring to random
choose mask diff: [2103928.0, 2101582.0, 2102280.0, 2102700.0, 1916556.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.485399
Client Index = 15	Epoch: 1	Loss: 0.439181
Client Index = 15	Epoch: 2	Loss: 0.431284
Client Index = 15	Epoch: 3	Loss: 0.411381
Client Index = 15	Epoch: 4	Loss: 0.427297
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 16
local mask changes: 1916086.0 / 11173962
choose client_indexes: [ 1  5  6 15 16], accoring to random
choose mask diff: [2099818.0, 2103136.0, 2104754.0, 2100324.0, 1916086.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.529004
Client Index = 16	Epoch: 1	Loss: 0.475885
Client Index = 16	Epoch: 2	Loss: 0.414287
Client Index = 16	Epoch: 3	Loss: 0.400814
Client Index = 16	Epoch: 4	Loss: 0.346254
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 17
local mask changes: 1917634.0 / 11173962
choose client_indexes: [ 4  7 13 15 17], accoring to random
choose mask diff: [2100430.0, 2101460.0, 2099314.0, 2100200.0, 1917634.0]
Doing local aggregation!
test acc on this client before 320 / 505 : 0.63
Client Index = 17	Epoch: 0	Loss: 0.594398
Client Index = 17	Epoch: 1	Loss: 0.403768
Client Index = 17	Epoch: 2	Loss: 0.414806
Client Index = 17	Epoch: 3	Loss: 0.369920
Client Index = 17	Epoch: 4	Loss: 0.288876
test acc on this client after 399 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 18
local mask changes: 1915888.0 / 11173962
choose client_indexes: [ 4  7 13 16 18], accoring to random
choose mask diff: [2099462.0, 2096394.0, 2102596.0, 2094382.0, 1915888.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.400048
Client Index = 18	Epoch: 1	Loss: 0.401107
Client Index = 18	Epoch: 2	Loss: 0.374685
Client Index = 18	Epoch: 3	Loss: 0.323266
Client Index = 18	Epoch: 4	Loss: 0.310433
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(47) with spasity 0.5: 19
local mask changes: 1916392.0 / 11173962
choose client_indexes: [ 0  2 11 18 19], accoring to random
choose mask diff: [2102768.0, 2102970.0, 2101188.0, 2095082.0, 1916392.0]
Doing local aggregation!
test acc on this client before 321 / 506 : 0.63
Client Index = 19	Epoch: 0	Loss: 0.572297
Client Index = 19	Epoch: 1	Loss: 0.459365
Client Index = 19	Epoch: 2	Loss: 0.359844
Client Index = 19	Epoch: 3	Loss: 0.466094
Client Index = 19	Epoch: 4	Loss: 0.354837
test acc on this client after 382 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 47
{'test_acc': 0.7601221713127359, 'test_loss': 0.7572879454523347}
################local_test_on_all_clients before local training in communication round: 47
{'test_acc': 0.7315720003085311, 'test_loss': 0.7886082248296761}
################Communication round : 48
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 0
local mask changes: 1875090.0 / 11173962
choose client_indexes: [ 0  2  9 12 13], accoring to random
choose mask diff: [1875090.0, 2072462.0, 2067918.0, 2073960.0, 2073908.0]
Doing local aggregation!
test acc on this client before 318 / 504 : 0.63
Client Index = 0	Epoch: 0	Loss: 0.733168
Client Index = 0	Epoch: 1	Loss: 0.681027
Client Index = 0	Epoch: 2	Loss: 0.675205
Client Index = 0	Epoch: 3	Loss: 0.644871
Client Index = 0	Epoch: 4	Loss: 0.619245
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 1
local mask changes: 1874850.0 / 11173962
choose client_indexes: [ 1  3  7 14 16], accoring to random
choose mask diff: [1874850.0, 2064836.0, 2062582.0, 2070982.0, 2064878.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 1	Epoch: 0	Loss: 0.461363
Client Index = 1	Epoch: 1	Loss: 0.412021
Client Index = 1	Epoch: 2	Loss: 0.281300
Client Index = 1	Epoch: 3	Loss: 0.330669
Client Index = 1	Epoch: 4	Loss: 0.315510
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 2
local mask changes: 1873540.0 / 11173962
choose client_indexes: [ 2 10 12 14 17], accoring to random
choose mask diff: [1873540.0, 2064598.0, 2060532.0, 2065190.0, 2058828.0]
Doing local aggregation!
test acc on this client before 398 / 502 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.416485
Client Index = 2	Epoch: 1	Loss: 0.325173
Client Index = 2	Epoch: 2	Loss: 0.325586
Client Index = 2	Epoch: 3	Loss: 0.331653
Client Index = 2	Epoch: 4	Loss: 0.278026
test acc on this client after 427 / 502 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 3
local mask changes: 1873678.0 / 11173962
choose client_indexes: [ 3 11 12 17 19], accoring to random
choose mask diff: [1873678.0, 2062410.0, 2061716.0, 2064012.0, 2066308.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.741229
Client Index = 3	Epoch: 1	Loss: 0.638500
Client Index = 3	Epoch: 2	Loss: 0.539402
Client Index = 3	Epoch: 3	Loss: 0.635299
Client Index = 3	Epoch: 4	Loss: 0.573915
test acc on this client after 377 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 4
local mask changes: 1874400.0 / 11173962
choose client_indexes: [ 0  4  5  8 19], accoring to random
choose mask diff: [2061318.0, 1874400.0, 2068612.0, 2060246.0, 2069308.0]
Doing local aggregation!
test acc on this client before 360 / 503 : 0.72
Client Index = 4	Epoch: 0	Loss: 0.544893
Client Index = 4	Epoch: 1	Loss: 0.417984
Client Index = 4	Epoch: 2	Loss: 0.442650
Client Index = 4	Epoch: 3	Loss: 0.366775
Client Index = 4	Epoch: 4	Loss: 0.368914
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 5
local mask changes: 1874858.0 / 11173962
choose client_indexes: [ 5  7 12 14 15], accoring to random
choose mask diff: [1874858.0, 2060646.0, 2066120.0, 2071580.0, 2061784.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.584345
Client Index = 5	Epoch: 1	Loss: 0.407952
Client Index = 5	Epoch: 2	Loss: 0.478881
Client Index = 5	Epoch: 3	Loss: 0.450084
Client Index = 5	Epoch: 4	Loss: 0.395057
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 6
local mask changes: 1874124.0 / 11173962
choose client_indexes: [ 3  4  6 13 14], accoring to random
choose mask diff: [2066780.0, 2065454.0, 1874124.0, 2076260.0, 2065978.0]
Doing local aggregation!
test acc on this client before 361 / 505 : 0.71
Client Index = 6	Epoch: 0	Loss: 0.784759
Client Index = 6	Epoch: 1	Loss: 0.729943
Client Index = 6	Epoch: 2	Loss: 0.671887
Client Index = 6	Epoch: 3	Loss: 0.651253
Client Index = 6	Epoch: 4	Loss: 0.653714
test acc on this client after 368 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 7
local mask changes: 1874608.0 / 11173962
choose client_indexes: [ 0  2  7 12 17], accoring to random
choose mask diff: [2075456.0, 2061544.0, 1874608.0, 2068782.0, 2066814.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 7	Epoch: 0	Loss: 0.782344
Client Index = 7	Epoch: 1	Loss: 0.469556
Client Index = 7	Epoch: 2	Loss: 0.453208
Client Index = 7	Epoch: 3	Loss: 0.428727
Client Index = 7	Epoch: 4	Loss: 0.454100
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 8
local mask changes: 1873836.0 / 11173962
choose client_indexes: [ 2  8 12 13 18], accoring to random
choose mask diff: [2061484.0, 1873836.0, 2068808.0, 2067676.0, 2065210.0]
Doing local aggregation!
test acc on this client before 363 / 504 : 0.72
Client Index = 8	Epoch: 0	Loss: 0.859904
Client Index = 8	Epoch: 1	Loss: 0.542355
Client Index = 8	Epoch: 2	Loss: 0.546747
Client Index = 8	Epoch: 3	Loss: 0.554743
Client Index = 8	Epoch: 4	Loss: 0.542981
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 9
local mask changes: 1873914.0 / 11173962
choose client_indexes: [ 4  9 10 18 19], accoring to random
choose mask diff: [2059366.0, 1873914.0, 2066744.0, 2067048.0, 2072460.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.504473
Client Index = 9	Epoch: 1	Loss: 0.451046
Client Index = 9	Epoch: 2	Loss: 0.475080
Client Index = 9	Epoch: 3	Loss: 0.371705
Client Index = 9	Epoch: 4	Loss: 0.315004
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 10
local mask changes: 1874254.0 / 11173962
choose client_indexes: [ 0  8 10 12 19], accoring to random
choose mask diff: [2075666.0, 2065762.0, 1874254.0, 2069822.0, 2069652.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 10	Epoch: 0	Loss: 0.651403
Client Index = 10	Epoch: 1	Loss: 0.583163
Client Index = 10	Epoch: 2	Loss: 0.424374
Client Index = 10	Epoch: 3	Loss: 0.554699
Client Index = 10	Epoch: 4	Loss: 0.443779
test acc on this client after 377 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 11
local mask changes: 1875708.0 / 11173962
choose client_indexes: [ 6 11 13 15 19], accoring to random
choose mask diff: [2068742.0, 1875708.0, 2069058.0, 2060820.0, 2063034.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 11	Epoch: 0	Loss: 0.451439
Client Index = 11	Epoch: 1	Loss: 0.308289
Client Index = 11	Epoch: 2	Loss: 0.330826
Client Index = 11	Epoch: 3	Loss: 0.254523
Client Index = 11	Epoch: 4	Loss: 0.293398
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 12
local mask changes: 1873458.0 / 11173962
choose client_indexes: [ 1  2 12 14 15], accoring to random
choose mask diff: [2064604.0, 2065870.0, 1873458.0, 2069764.0, 2064980.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.531887
Client Index = 12	Epoch: 1	Loss: 0.586976
Client Index = 12	Epoch: 2	Loss: 0.442603
Client Index = 12	Epoch: 3	Loss: 0.488958
Client Index = 12	Epoch: 4	Loss: 0.469054
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 13
local mask changes: 1874516.0 / 11173962
choose client_indexes: [ 0  2 13 17 19], accoring to random
choose mask diff: [2073814.0, 2063392.0, 1874516.0, 2065718.0, 2066126.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.581364
Client Index = 13	Epoch: 1	Loss: 0.510222
Client Index = 13	Epoch: 2	Loss: 0.541851
Client Index = 13	Epoch: 3	Loss: 0.457635
Client Index = 13	Epoch: 4	Loss: 0.440819
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 14
local mask changes: 1875058.0 / 11173962
choose client_indexes: [ 5 10 14 15 18], accoring to random
choose mask diff: [2069668.0, 2072634.0, 1875058.0, 2065448.0, 2060662.0]
Doing local aggregation!
test acc on this client before 389 / 502 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.627869
Client Index = 14	Epoch: 1	Loss: 0.552325
Client Index = 14	Epoch: 2	Loss: 0.555220
Client Index = 14	Epoch: 3	Loss: 0.562709
Client Index = 14	Epoch: 4	Loss: 0.533382
test acc on this client after 387 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 15
local mask changes: 1874018.0 / 11173962
choose client_indexes: [ 2  3  4  6 15], accoring to random
choose mask diff: [2060898.0, 2068762.0, 2062970.0, 2073840.0, 1874018.0]
Doing local aggregation!
test acc on this client before 325 / 504 : 0.64
Client Index = 15	Epoch: 0	Loss: 0.521370
Client Index = 15	Epoch: 1	Loss: 0.437684
Client Index = 15	Epoch: 2	Loss: 0.388842
Client Index = 15	Epoch: 3	Loss: 0.420948
Client Index = 15	Epoch: 4	Loss: 0.360095
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 16
local mask changes: 1875692.0 / 11173962
choose client_indexes: [ 8 10 16 17 18], accoring to random
choose mask diff: [2067602.0, 2067788.0, 1875692.0, 2064092.0, 2060966.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 16	Epoch: 0	Loss: 0.568253
Client Index = 16	Epoch: 1	Loss: 0.420902
Client Index = 16	Epoch: 2	Loss: 0.390834
Client Index = 16	Epoch: 3	Loss: 0.399428
Client Index = 16	Epoch: 4	Loss: 0.327384
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 17
local mask changes: 1876364.0 / 11173962
choose client_indexes: [ 3  6  7 14 17], accoring to random
choose mask diff: [2064114.0, 2068804.0, 2062698.0, 2068628.0, 1876364.0]
Doing local aggregation!
test acc on this client before 375 / 505 : 0.74
Client Index = 17	Epoch: 0	Loss: 0.574597
Client Index = 17	Epoch: 1	Loss: 0.464406
Client Index = 17	Epoch: 2	Loss: 0.362458
Client Index = 17	Epoch: 3	Loss: 0.377416
Client Index = 17	Epoch: 4	Loss: 0.286709
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 18
local mask changes: 1874258.0 / 11173962
choose client_indexes: [ 5  9 10 13 18], accoring to random
choose mask diff: [2060234.0, 2062480.0, 2060676.0, 2062240.0, 1874258.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.432741
Client Index = 18	Epoch: 1	Loss: 0.350090
Client Index = 18	Epoch: 2	Loss: 0.354189
Client Index = 18	Epoch: 3	Loss: 0.318276
Client Index = 18	Epoch: 4	Loss: 0.319756
test acc on this client after 437 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(48) with spasity 0.5: 19
local mask changes: 1873984.0 / 11173962
choose client_indexes: [ 1  2  6 17 19], accoring to random
choose mask diff: [2065604.0, 2062642.0, 2070244.0, 2063450.0, 1873984.0]
Doing local aggregation!
test acc on this client before 384 / 506 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.533572
Client Index = 19	Epoch: 1	Loss: 0.450329
Client Index = 19	Epoch: 2	Loss: 0.392939
Client Index = 19	Epoch: 3	Loss: 0.439295
Client Index = 19	Epoch: 4	Loss: 0.352681
test acc on this client after 395 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 48
{'test_acc': 0.7797660575308518, 'test_loss': 0.6758617094638953}
################local_test_on_all_clients before local training in communication round: 48
{'test_acc': 0.7404668425300057, 'test_loss': 0.7676233504944225}
################Communication round : 49
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 0
local mask changes: 1832030.0 / 11173962
choose client_indexes: [ 0  2 11 16 17], accoring to random
choose mask diff: [1832030.0, 2031694.0, 2030736.0, 2037006.0, 2033138.0]
Doing local aggregation!
test acc on this client before 331 / 504 : 0.66
Client Index = 0	Epoch: 0	Loss: 0.747377
Client Index = 0	Epoch: 1	Loss: 0.696003
Client Index = 0	Epoch: 2	Loss: 0.745267
Client Index = 0	Epoch: 3	Loss: 0.637406
Client Index = 0	Epoch: 4	Loss: 0.691585
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 1
local mask changes: 1832828.0 / 11173962
choose client_indexes: [ 1  5 10 15 18], accoring to random
choose mask diff: [1832828.0, 2027080.0, 2031072.0, 2023718.0, 2021122.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.474787
Client Index = 1	Epoch: 1	Loss: 0.321565
Client Index = 1	Epoch: 2	Loss: 0.298007
Client Index = 1	Epoch: 3	Loss: 0.405495
Client Index = 1	Epoch: 4	Loss: 0.235587
test acc on this client after 435 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 2
local mask changes: 1831666.0 / 11173962
choose client_indexes: [ 0  2  4  7 17], accoring to random
choose mask diff: [2036960.0, 1831666.0, 2025590.0, 2024956.0, 2018996.0]
Doing local aggregation!
test acc on this client before 424 / 502 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.393288
Client Index = 2	Epoch: 1	Loss: 0.341181
Client Index = 2	Epoch: 2	Loss: 0.277062
Client Index = 2	Epoch: 3	Loss: 0.315484
Client Index = 2	Epoch: 4	Loss: 0.240052
test acc on this client after 422 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 3
local mask changes: 1832310.0 / 11173962
choose client_indexes: [ 1  3  7 14 15], accoring to random
choose mask diff: [2032720.0, 1832310.0, 2034112.0, 2029512.0, 2031506.0]
Doing local aggregation!
test acc on this client before 294 / 504 : 0.58
Client Index = 3	Epoch: 0	Loss: 0.726134
Client Index = 3	Epoch: 1	Loss: 0.605100
Client Index = 3	Epoch: 2	Loss: 0.572962
Client Index = 3	Epoch: 3	Loss: 0.520810
Client Index = 3	Epoch: 4	Loss: 0.568581
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 4
local mask changes: 1831112.0 / 11173962
choose client_indexes: [ 1  4 10 16 17], accoring to random
choose mask diff: [2033782.0, 1831112.0, 2029478.0, 2031230.0, 2028260.0]
Doing local aggregation!
test acc on this client before 321 / 503 : 0.64
Client Index = 4	Epoch: 0	Loss: 0.620861
Client Index = 4	Epoch: 1	Loss: 0.404919
Client Index = 4	Epoch: 2	Loss: 0.415525
Client Index = 4	Epoch: 3	Loss: 0.380609
Client Index = 4	Epoch: 4	Loss: 0.333532
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 5
local mask changes: 1833364.0 / 11173962
choose client_indexes: [ 5  6 12 14 18], accoring to random
choose mask diff: [1833364.0, 2033350.0, 2027128.0, 2027838.0, 2026008.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 5	Epoch: 0	Loss: 0.613110
Client Index = 5	Epoch: 1	Loss: 0.432253
Client Index = 5	Epoch: 2	Loss: 0.435908
Client Index = 5	Epoch: 3	Loss: 0.348351
Client Index = 5	Epoch: 4	Loss: 0.430794
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 6
local mask changes: 1831632.0 / 11173962
choose client_indexes: [ 6  7  8 14 19], accoring to random
choose mask diff: [1831632.0, 2027442.0, 2029382.0, 2026294.0, 2037210.0]
Doing local aggregation!
test acc on this client before 363 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.720140
Client Index = 6	Epoch: 1	Loss: 0.673951
Client Index = 6	Epoch: 2	Loss: 0.633979
Client Index = 6	Epoch: 3	Loss: 0.646971
Client Index = 6	Epoch: 4	Loss: 0.639492
test acc on this client after 373 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 7
local mask changes: 1832186.0 / 11173962
choose client_indexes: [ 4  7  9 11 16], accoring to random
choose mask diff: [2031956.0, 1832186.0, 2026980.0, 2030482.0, 2035230.0]
Doing local aggregation!
test acc on this client before 365 / 504 : 0.72
Client Index = 7	Epoch: 0	Loss: 0.711012
Client Index = 7	Epoch: 1	Loss: 0.481380
Client Index = 7	Epoch: 2	Loss: 0.515691
Client Index = 7	Epoch: 3	Loss: 0.424905
Client Index = 7	Epoch: 4	Loss: 0.456506
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 8
local mask changes: 1830760.0 / 11173962
choose client_indexes: [ 1  8 12 14 17], accoring to random
choose mask diff: [2030950.0, 1830760.0, 2024220.0, 2034764.0, 2029668.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 8	Epoch: 0	Loss: 0.736430
Client Index = 8	Epoch: 1	Loss: 0.639921
Client Index = 8	Epoch: 2	Loss: 0.475108
Client Index = 8	Epoch: 3	Loss: 0.569316
Client Index = 8	Epoch: 4	Loss: 0.532136
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 9
local mask changes: 1831394.0 / 11173962
choose client_indexes: [ 0  5  8  9 15], accoring to random
choose mask diff: [2034666.0, 2028812.0, 2026648.0, 1831394.0, 2033812.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.424332
Client Index = 9	Epoch: 1	Loss: 0.448438
Client Index = 9	Epoch: 2	Loss: 0.418266
Client Index = 9	Epoch: 3	Loss: 0.307218
Client Index = 9	Epoch: 4	Loss: 0.322880
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 10
local mask changes: 1832266.0 / 11173962
choose client_indexes: [ 0  7  9 10 11], accoring to random
choose mask diff: [2034636.0, 2027494.0, 2029934.0, 1832266.0, 2036428.0]
Doing local aggregation!
test acc on this client before 353 / 503 : 0.70
Client Index = 10	Epoch: 0	Loss: 0.633279
Client Index = 10	Epoch: 1	Loss: 0.534664
Client Index = 10	Epoch: 2	Loss: 0.540026
Client Index = 10	Epoch: 3	Loss: 0.460671
Client Index = 10	Epoch: 4	Loss: 0.423666
test acc on this client after 372 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 11
local mask changes: 1833194.0 / 11173962
choose client_indexes: [ 2 11 12 16 19], accoring to random
choose mask diff: [2020912.0, 1833194.0, 2030534.0, 2028426.0, 2021742.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.453877
Client Index = 11	Epoch: 1	Loss: 0.307088
Client Index = 11	Epoch: 2	Loss: 0.287758
Client Index = 11	Epoch: 3	Loss: 0.255702
Client Index = 11	Epoch: 4	Loss: 0.296323
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 12
local mask changes: 1831744.0 / 11173962
choose client_indexes: [ 2  7  8 12 19], accoring to random
choose mask diff: [2022262.0, 2033512.0, 2030012.0, 1831744.0, 2029016.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.601604
Client Index = 12	Epoch: 1	Loss: 0.476888
Client Index = 12	Epoch: 2	Loss: 0.410015
Client Index = 12	Epoch: 3	Loss: 0.467317
Client Index = 12	Epoch: 4	Loss: 0.452901
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 13
local mask changes: 1831816.0 / 11173962
choose client_indexes: [ 5  6  9 13 18], accoring to random
choose mask diff: [2035046.0, 2040404.0, 2025010.0, 1831816.0, 2027472.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 13	Epoch: 0	Loss: 0.575639
Client Index = 13	Epoch: 1	Loss: 0.461925
Client Index = 13	Epoch: 2	Loss: 0.517757
Client Index = 13	Epoch: 3	Loss: 0.444207
Client Index = 13	Epoch: 4	Loss: 0.387405
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 14
local mask changes: 1831446.0 / 11173962
choose client_indexes: [ 0  5  7 14 19], accoring to random
choose mask diff: [2031130.0, 2027894.0, 2029418.0, 1831446.0, 2034776.0]
Doing local aggregation!
test acc on this client before 363 / 502 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.624125
Client Index = 14	Epoch: 1	Loss: 0.530305
Client Index = 14	Epoch: 2	Loss: 0.610835
Client Index = 14	Epoch: 3	Loss: 0.466800
Client Index = 14	Epoch: 4	Loss: 0.648107
test acc on this client after 394 / 502 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 15
local mask changes: 1832746.0 / 11173962
choose client_indexes: [ 0  5  9 15 18], accoring to random
choose mask diff: [2031834.0, 2025430.0, 2031536.0, 1832746.0, 2029676.0]
Doing local aggregation!
test acc on this client before 376 / 504 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.431172
Client Index = 15	Epoch: 1	Loss: 0.459649
Client Index = 15	Epoch: 2	Loss: 0.419089
Client Index = 15	Epoch: 3	Loss: 0.363469
Client Index = 15	Epoch: 4	Loss: 0.403348
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 16
local mask changes: 1831716.0 / 11173962
choose client_indexes: [ 1  6  7 10 16], accoring to random
choose mask diff: [2027528.0, 2032274.0, 2029824.0, 2027804.0, 1831716.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.508630
Client Index = 16	Epoch: 1	Loss: 0.481504
Client Index = 16	Epoch: 2	Loss: 0.361860
Client Index = 16	Epoch: 3	Loss: 0.408618
Client Index = 16	Epoch: 4	Loss: 0.294219
test acc on this client after 389 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 17
local mask changes: 1831350.0 / 11173962
choose client_indexes: [10 11 15 17 19], accoring to random
choose mask diff: [2031076.0, 2030910.0, 2026930.0, 1831350.0, 2028228.0]
Doing local aggregation!
test acc on this client before 413 / 505 : 0.82
Client Index = 17	Epoch: 0	Loss: 0.632104
Client Index = 17	Epoch: 1	Loss: 0.454300
Client Index = 17	Epoch: 2	Loss: 0.295963
Client Index = 17	Epoch: 3	Loss: 0.431638
Client Index = 17	Epoch: 4	Loss: 0.293969
test acc on this client after 429 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 18
local mask changes: 1831342.0 / 11173962
choose client_indexes: [ 5  8  9 11 18], accoring to random
choose mask diff: [2020968.0, 2029504.0, 2021630.0, 2025420.0, 1831342.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.503825
Client Index = 18	Epoch: 1	Loss: 0.328703
Client Index = 18	Epoch: 2	Loss: 0.360077
Client Index = 18	Epoch: 3	Loss: 0.323170
Client Index = 18	Epoch: 4	Loss: 0.291223
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(49) with spasity 0.5: 19
local mask changes: 1832522.0 / 11173962
choose client_indexes: [ 4 11 14 15 19], accoring to random
choose mask diff: [2031564.0, 2026162.0, 2034432.0, 2026684.0, 1832522.0]
Doing local aggregation!
test acc on this client before 330 / 506 : 0.65
Client Index = 19	Epoch: 0	Loss: 0.516831
Client Index = 19	Epoch: 1	Loss: 0.427376
Client Index = 19	Epoch: 2	Loss: 0.398196
Client Index = 19	Epoch: 3	Loss: 0.388081
Client Index = 19	Epoch: 4	Loss: 0.387681
test acc on this client after 388 / 506 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 49
{'test_acc': 0.7812634171211132, 'test_loss': 0.6794120911916108}
################local_test_on_all_clients before local training in communication round: 49
{'test_acc': 0.7434539828033726, 'test_loss': 0.7480771506610103}
################Communication round : 50
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 0
local mask changes: 1789546.0 / 11173962
choose client_indexes: [ 0  3  7  9 19], accoring to random
choose mask diff: [1789546.0, 1998942.0, 1999098.0, 1996336.0, 1994730.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.699006
Client Index = 0	Epoch: 1	Loss: 0.687104
Client Index = 0	Epoch: 2	Loss: 0.669273
Client Index = 0	Epoch: 3	Loss: 0.613697
Client Index = 0	Epoch: 4	Loss: 0.619352
test acc on this client after 329 / 504 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 1
local mask changes: 1787792.0 / 11173962
choose client_indexes: [ 0  1  7 14 19], accoring to random
choose mask diff: [1997320.0, 1787792.0, 1990828.0, 1994468.0, 1992466.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 1	Epoch: 0	Loss: 0.518687
Client Index = 1	Epoch: 1	Loss: 0.321151
Client Index = 1	Epoch: 2	Loss: 0.290377
Client Index = 1	Epoch: 3	Loss: 0.370913
Client Index = 1	Epoch: 4	Loss: 0.342608
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 2
local mask changes: 1788856.0 / 11173962
choose client_indexes: [ 2 10 12 15 18], accoring to random
choose mask diff: [1788856.0, 1992858.0, 1985060.0, 1989382.0, 1989650.0]
Doing local aggregation!
test acc on this client before 399 / 502 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.438638
Client Index = 2	Epoch: 1	Loss: 0.322852
Client Index = 2	Epoch: 2	Loss: 0.294563
Client Index = 2	Epoch: 3	Loss: 0.273066
Client Index = 2	Epoch: 4	Loss: 0.242593
test acc on this client after 412 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 3
local mask changes: 1789390.0 / 11173962
choose client_indexes: [ 3  5  6 11 12], accoring to random
choose mask diff: [1789390.0, 1996062.0, 1992798.0, 1989564.0, 1993428.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.718840
Client Index = 3	Epoch: 1	Loss: 0.650111
Client Index = 3	Epoch: 2	Loss: 0.552894
Client Index = 3	Epoch: 3	Loss: 0.605218
Client Index = 3	Epoch: 4	Loss: 0.463395
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 4
local mask changes: 1788174.0 / 11173962
choose client_indexes: [ 2  3  4  6 11], accoring to random
choose mask diff: [1990874.0, 1993094.0, 1788174.0, 1992698.0, 1995280.0]
Doing local aggregation!
test acc on this client before 390 / 503 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.542483
Client Index = 4	Epoch: 1	Loss: 0.401953
Client Index = 4	Epoch: 2	Loss: 0.341109
Client Index = 4	Epoch: 3	Loss: 0.432060
Client Index = 4	Epoch: 4	Loss: 0.280987
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 5
local mask changes: 1788698.0 / 11173962
choose client_indexes: [ 5  9 11 14 17], accoring to random
choose mask diff: [1788698.0, 1994880.0, 1993932.0, 1985026.0, 1991798.0]
Doing local aggregation!
test acc on this client before 350 / 504 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.498737
Client Index = 5	Epoch: 1	Loss: 0.430849
Client Index = 5	Epoch: 2	Loss: 0.366504
Client Index = 5	Epoch: 3	Loss: 0.531967
Client Index = 5	Epoch: 4	Loss: 0.321761
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 6
local mask changes: 1789306.0 / 11173962
choose client_indexes: [ 1  2  6 12 17], accoring to random
choose mask diff: [2000034.0, 1993052.0, 1789306.0, 2000700.0, 1994626.0]
Doing local aggregation!
test acc on this client before 339 / 505 : 0.67
Client Index = 6	Epoch: 0	Loss: 0.839137
Client Index = 6	Epoch: 1	Loss: 0.701795
Client Index = 6	Epoch: 2	Loss: 0.630413
Client Index = 6	Epoch: 3	Loss: 0.663383
Client Index = 6	Epoch: 4	Loss: 0.605334
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 7
local mask changes: 1787894.0 / 11173962
choose client_indexes: [ 2  4  5  7 17], accoring to random
choose mask diff: [1987194.0, 1990528.0, 1986680.0, 1787894.0, 1986360.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 7	Epoch: 0	Loss: 0.536537
Client Index = 7	Epoch: 1	Loss: 0.465965
Client Index = 7	Epoch: 2	Loss: 0.462963
Client Index = 7	Epoch: 3	Loss: 0.443832
Client Index = 7	Epoch: 4	Loss: 0.482505
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 8
local mask changes: 1788496.0 / 11173962
choose client_indexes: [ 2  7  8 13 14], accoring to random
choose mask diff: [1988738.0, 1990216.0, 1788496.0, 1996926.0, 1993608.0]
Doing local aggregation!
test acc on this client before 375 / 504 : 0.74
Client Index = 8	Epoch: 0	Loss: 0.655023
Client Index = 8	Epoch: 1	Loss: 0.628176
Client Index = 8	Epoch: 2	Loss: 0.512124
Client Index = 8	Epoch: 3	Loss: 0.492096
Client Index = 8	Epoch: 4	Loss: 0.529021
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 9
local mask changes: 1789466.0 / 11173962
choose client_indexes: [ 0  5  9 13 17], accoring to random
choose mask diff: [1987468.0, 1989510.0, 1789466.0, 1989890.0, 1995894.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 9	Epoch: 0	Loss: 0.456144
Client Index = 9	Epoch: 1	Loss: 0.459767
Client Index = 9	Epoch: 2	Loss: 0.397958
Client Index = 9	Epoch: 3	Loss: 0.293026
Client Index = 9	Epoch: 4	Loss: 0.395532
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 10
local mask changes: 1789150.0 / 11173962
choose client_indexes: [10 16 17 18 19], accoring to random
choose mask diff: [1789150.0, 1995416.0, 1997470.0, 1990416.0, 1997600.0]
Doing local aggregation!
test acc on this client before 382 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.617302
Client Index = 10	Epoch: 1	Loss: 0.490793
Client Index = 10	Epoch: 2	Loss: 0.542295
Client Index = 10	Epoch: 3	Loss: 0.436064
Client Index = 10	Epoch: 4	Loss: 0.424680
test acc on this client after 383 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 11
local mask changes: 1788228.0 / 11173962
choose client_indexes: [ 1  3  6  9 11], accoring to random
choose mask diff: [1993050.0, 1989520.0, 1993722.0, 1997300.0, 1788228.0]
Doing local aggregation!
test acc on this client before 427 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.430920
Client Index = 11	Epoch: 1	Loss: 0.328914
Client Index = 11	Epoch: 2	Loss: 0.256097
Client Index = 11	Epoch: 3	Loss: 0.298413
Client Index = 11	Epoch: 4	Loss: 0.266904
test acc on this client after 460 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 12
local mask changes: 1787672.0 / 11173962
choose client_indexes: [ 5 12 14 16 19], accoring to random
choose mask diff: [1992174.0, 1787672.0, 1996324.0, 1994488.0, 1989536.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.655218
Client Index = 12	Epoch: 1	Loss: 0.491065
Client Index = 12	Epoch: 2	Loss: 0.416612
Client Index = 12	Epoch: 3	Loss: 0.433365
Client Index = 12	Epoch: 4	Loss: 0.398037
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 13
local mask changes: 1787808.0 / 11173962
choose client_indexes: [ 7 11 12 13 16], accoring to random
choose mask diff: [1994712.0, 1991546.0, 1998280.0, 1787808.0, 1994290.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.552884
Client Index = 13	Epoch: 1	Loss: 0.479440
Client Index = 13	Epoch: 2	Loss: 0.460963
Client Index = 13	Epoch: 3	Loss: 0.435839
Client Index = 13	Epoch: 4	Loss: 0.407191
test acc on this client after 320 / 503 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 14
local mask changes: 1789112.0 / 11173962
choose client_indexes: [ 2  6  9 14 15], accoring to random
choose mask diff: [1989844.0, 1994454.0, 1996168.0, 1789112.0, 1995332.0]
Doing local aggregation!
test acc on this client before 393 / 502 : 0.78
Client Index = 14	Epoch: 0	Loss: 0.601954
Client Index = 14	Epoch: 1	Loss: 0.561391
Client Index = 14	Epoch: 2	Loss: 0.500157
Client Index = 14	Epoch: 3	Loss: 0.512191
Client Index = 14	Epoch: 4	Loss: 0.461619
test acc on this client after 303 / 502 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 15
local mask changes: 1787748.0 / 11173962
choose client_indexes: [ 0  2  4 14 15], accoring to random
choose mask diff: [1992126.0, 1989284.0, 1990120.0, 1993080.0, 1787748.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.484903
Client Index = 15	Epoch: 1	Loss: 0.407395
Client Index = 15	Epoch: 2	Loss: 0.352267
Client Index = 15	Epoch: 3	Loss: 0.417107
Client Index = 15	Epoch: 4	Loss: 0.320168
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 16
local mask changes: 1787888.0 / 11173962
choose client_indexes: [ 0  2  5  7 16], accoring to random
choose mask diff: [1999606.0, 1990370.0, 1991488.0, 1990760.0, 1787888.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.503570
Client Index = 16	Epoch: 1	Loss: 0.369351
Client Index = 16	Epoch: 2	Loss: 0.361179
Client Index = 16	Epoch: 3	Loss: 0.363522
Client Index = 16	Epoch: 4	Loss: 0.394319
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 17
local mask changes: 1787770.0 / 11173962
choose client_indexes: [ 5  6 12 17 19], accoring to random
choose mask diff: [1995376.0, 1992344.0, 1993794.0, 1787770.0, 1983014.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.542389
Client Index = 17	Epoch: 1	Loss: 0.385694
Client Index = 17	Epoch: 2	Loss: 0.367360
Client Index = 17	Epoch: 3	Loss: 0.355687
Client Index = 17	Epoch: 4	Loss: 0.344858
test acc on this client after 416 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 18
local mask changes: 1788346.0 / 11173962
choose client_indexes: [ 0  9 11 14 18], accoring to random
choose mask diff: [1998062.0, 1980334.0, 1984908.0, 1987190.0, 1788346.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.423583
Client Index = 18	Epoch: 1	Loss: 0.382401
Client Index = 18	Epoch: 2	Loss: 0.285478
Client Index = 18	Epoch: 3	Loss: 0.283247
Client Index = 18	Epoch: 4	Loss: 0.294154
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(50) with spasity 0.5: 19
local mask changes: 1789168.0 / 11173962
choose client_indexes: [ 2  6  8 11 19], accoring to random
choose mask diff: [1991654.0, 1998362.0, 1997886.0, 1982160.0, 1789168.0]
Doing local aggregation!
test acc on this client before 286 / 506 : 0.57
Client Index = 19	Epoch: 0	Loss: 0.523321
Client Index = 19	Epoch: 1	Loss: 0.458126
Client Index = 19	Epoch: 2	Loss: 0.373569
Client Index = 19	Epoch: 3	Loss: 0.368636
Client Index = 19	Epoch: 4	Loss: 0.374523
test acc on this client after 366 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 50
{'test_acc': 0.7758649186157205, 'test_loss': 0.7143823039282446}
################local_test_on_all_clients before local training in communication round: 50
{'test_acc': 0.7511319932342261, 'test_loss': 0.7326880286268631}
################Communication round : 51
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 0
local mask changes: 1745246.0 / 11173962
choose client_indexes: [ 0  7 11 14 16], accoring to random
choose mask diff: [1745246.0, 1956740.0, 1955922.0, 1959230.0, 1962136.0]
Doing local aggregation!
test acc on this client before 298 / 504 : 0.59
Client Index = 0	Epoch: 0	Loss: 0.688945
Client Index = 0	Epoch: 1	Loss: 0.671304
Client Index = 0	Epoch: 2	Loss: 0.583037
Client Index = 0	Epoch: 3	Loss: 0.617877
Client Index = 0	Epoch: 4	Loss: 0.628134
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 1
local mask changes: 1745038.0 / 11173962
choose client_indexes: [ 1  9 11 14 16], accoring to random
choose mask diff: [1745038.0, 1956860.0, 1956542.0, 1952320.0, 1950070.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 1	Epoch: 0	Loss: 0.559808
Client Index = 1	Epoch: 1	Loss: 0.337897
Client Index = 1	Epoch: 2	Loss: 0.276172
Client Index = 1	Epoch: 3	Loss: 0.442154
Client Index = 1	Epoch: 4	Loss: 0.287340
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 2
local mask changes: 1744740.0 / 11173962
choose client_indexes: [ 2  3 10 11 13], accoring to random
choose mask diff: [1744740.0, 1957490.0, 1948892.0, 1950322.0, 1955270.0]
Doing local aggregation!
test acc on this client before 402 / 502 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.378207
Client Index = 2	Epoch: 1	Loss: 0.340481
Client Index = 2	Epoch: 2	Loss: 0.242711
Client Index = 2	Epoch: 3	Loss: 0.253774
Client Index = 2	Epoch: 4	Loss: 0.240961
test acc on this client after 420 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 3
local mask changes: 1746222.0 / 11173962
choose client_indexes: [ 0  3  9 13 15], accoring to random
choose mask diff: [1963458.0, 1746222.0, 1964090.0, 1961478.0, 1956534.0]
Doing local aggregation!
test acc on this client before 329 / 504 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.716624
Client Index = 3	Epoch: 1	Loss: 0.513106
Client Index = 3	Epoch: 2	Loss: 0.634966
Client Index = 3	Epoch: 3	Loss: 0.605971
Client Index = 3	Epoch: 4	Loss: 0.543898
test acc on this client after 358 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 4
local mask changes: 1745258.0 / 11173962
choose client_indexes: [ 0  2  4 11 14], accoring to random
choose mask diff: [1955614.0, 1946302.0, 1745258.0, 1953824.0, 1959504.0]
Doing local aggregation!
test acc on this client before 363 / 503 : 0.72
Client Index = 4	Epoch: 0	Loss: 0.606098
Client Index = 4	Epoch: 1	Loss: 0.445835
Client Index = 4	Epoch: 2	Loss: 0.328561
Client Index = 4	Epoch: 3	Loss: 0.316931
Client Index = 4	Epoch: 4	Loss: 0.372909
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 5
local mask changes: 1744744.0 / 11173962
choose client_indexes: [ 0  2  5  7 12], accoring to random
choose mask diff: [1963484.0, 1954972.0, 1744744.0, 1952792.0, 1952528.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.518631
Client Index = 5	Epoch: 1	Loss: 0.426168
Client Index = 5	Epoch: 2	Loss: 0.352069
Client Index = 5	Epoch: 3	Loss: 0.363300
Client Index = 5	Epoch: 4	Loss: 0.363872
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 6
local mask changes: 1744610.0 / 11173962
choose client_indexes: [ 1  6 14 17 18], accoring to random
choose mask diff: [1959792.0, 1744610.0, 1956130.0, 1952640.0, 1961456.0]
Doing local aggregation!
test acc on this client before 335 / 505 : 0.66
Client Index = 6	Epoch: 0	Loss: 0.773428
Client Index = 6	Epoch: 1	Loss: 0.650913
Client Index = 6	Epoch: 2	Loss: 0.566804
Client Index = 6	Epoch: 3	Loss: 0.578583
Client Index = 6	Epoch: 4	Loss: 0.660373
test acc on this client after 348 / 505 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 7
local mask changes: 1744062.0 / 11173962
choose client_indexes: [ 6  7  8 10 19], accoring to random
choose mask diff: [1954770.0, 1744062.0, 1956662.0, 1953610.0, 1959938.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 7	Epoch: 0	Loss: 0.523508
Client Index = 7	Epoch: 1	Loss: 0.471687
Client Index = 7	Epoch: 2	Loss: 0.363718
Client Index = 7	Epoch: 3	Loss: 0.442957
Client Index = 7	Epoch: 4	Loss: 0.362063
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 8
local mask changes: 1744398.0 / 11173962
choose client_indexes: [ 1  8 13 17 19], accoring to random
choose mask diff: [1959296.0, 1744398.0, 1955786.0, 1958690.0, 1963518.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 8	Epoch: 0	Loss: 0.704092
Client Index = 8	Epoch: 1	Loss: 0.537357
Client Index = 8	Epoch: 2	Loss: 0.519264
Client Index = 8	Epoch: 3	Loss: 0.546813
Client Index = 8	Epoch: 4	Loss: 0.487338
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 9
local mask changes: 1745152.0 / 11173962
choose client_indexes: [ 9 10 15 18 19], accoring to random
choose mask diff: [1745152.0, 1953120.0, 1950188.0, 1947450.0, 1960964.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.443789
Client Index = 9	Epoch: 1	Loss: 0.362840
Client Index = 9	Epoch: 2	Loss: 0.323457
Client Index = 9	Epoch: 3	Loss: 0.321506
Client Index = 9	Epoch: 4	Loss: 0.335764
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 10
local mask changes: 1746098.0 / 11173962
choose client_indexes: [ 0  2  7  9 10], accoring to random
choose mask diff: [1962888.0, 1955100.0, 1953402.0, 1955122.0, 1746098.0]
Doing local aggregation!
test acc on this client before 381 / 503 : 0.76
Client Index = 10	Epoch: 0	Loss: 0.565704
Client Index = 10	Epoch: 1	Loss: 0.544438
Client Index = 10	Epoch: 2	Loss: 0.423423
Client Index = 10	Epoch: 3	Loss: 0.429106
Client Index = 10	Epoch: 4	Loss: 0.439465
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 11
local mask changes: 1744802.0 / 11173962
choose client_indexes: [ 2  3  6 11 14], accoring to random
choose mask diff: [1950428.0, 1947692.0, 1952998.0, 1744802.0, 1954452.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.400925
Client Index = 11	Epoch: 1	Loss: 0.282527
Client Index = 11	Epoch: 2	Loss: 0.345732
Client Index = 11	Epoch: 3	Loss: 0.331905
Client Index = 11	Epoch: 4	Loss: 0.248912
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 12
local mask changes: 1745154.0 / 11173962
choose client_indexes: [ 7  9 10 12 16], accoring to random
choose mask diff: [1956908.0, 1964570.0, 1961212.0, 1745154.0, 1955346.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.568314
Client Index = 12	Epoch: 1	Loss: 0.459030
Client Index = 12	Epoch: 2	Loss: 0.427993
Client Index = 12	Epoch: 3	Loss: 0.485448
Client Index = 12	Epoch: 4	Loss: 0.364692
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 13
local mask changes: 1745166.0 / 11173962
choose client_indexes: [ 5  7 10 12 13], accoring to random
choose mask diff: [1960584.0, 1952664.0, 1960918.0, 1955920.0, 1745166.0]
Doing local aggregation!
test acc on this client before 395 / 503 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.514011
Client Index = 13	Epoch: 1	Loss: 0.504256
Client Index = 13	Epoch: 2	Loss: 0.494946
Client Index = 13	Epoch: 3	Loss: 0.424158
Client Index = 13	Epoch: 4	Loss: 0.402254
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 14
local mask changes: 1745690.0 / 11173962
choose client_indexes: [ 7  9 14 15 18], accoring to random
choose mask diff: [1957066.0, 1954420.0, 1745690.0, 1952810.0, 1955234.0]
Doing local aggregation!
test acc on this client before 386 / 502 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.599483
Client Index = 14	Epoch: 1	Loss: 0.579869
Client Index = 14	Epoch: 2	Loss: 0.494942
Client Index = 14	Epoch: 3	Loss: 0.519955
Client Index = 14	Epoch: 4	Loss: 0.524510
test acc on this client after 377 / 502 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 15
local mask changes: 1744236.0 / 11173962
choose client_indexes: [ 3  8 15 17 19], accoring to random
choose mask diff: [1956632.0, 1959538.0, 1744236.0, 1952636.0, 1955916.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 15	Epoch: 0	Loss: 0.503444
Client Index = 15	Epoch: 1	Loss: 0.402068
Client Index = 15	Epoch: 2	Loss: 0.386052
Client Index = 15	Epoch: 3	Loss: 0.357117
Client Index = 15	Epoch: 4	Loss: 0.337123
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 16
local mask changes: 1745634.0 / 11173962
choose client_indexes: [ 1  6  8  9 16], accoring to random
choose mask diff: [1952244.0, 1960102.0, 1960586.0, 1957996.0, 1745634.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.478891
Client Index = 16	Epoch: 1	Loss: 0.422782
Client Index = 16	Epoch: 2	Loss: 0.405205
Client Index = 16	Epoch: 3	Loss: 0.346307
Client Index = 16	Epoch: 4	Loss: 0.373504
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 17
local mask changes: 1744164.0 / 11173962
choose client_indexes: [ 0  6  9 16 17], accoring to random
choose mask diff: [1960800.0, 1951058.0, 1961808.0, 1958154.0, 1744164.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.546197
Client Index = 17	Epoch: 1	Loss: 0.439878
Client Index = 17	Epoch: 2	Loss: 0.397685
Client Index = 17	Epoch: 3	Loss: 0.299898
Client Index = 17	Epoch: 4	Loss: 0.276006
test acc on this client after 416 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 18
local mask changes: 1743660.0 / 11173962
choose client_indexes: [ 0  4 11 12 18], accoring to random
choose mask diff: [1955566.0, 1955240.0, 1946080.0, 1956548.0, 1743660.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.405040
Client Index = 18	Epoch: 1	Loss: 0.329568
Client Index = 18	Epoch: 2	Loss: 0.322961
Client Index = 18	Epoch: 3	Loss: 0.343201
Client Index = 18	Epoch: 4	Loss: 0.270685
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(51) with spasity 0.5: 19
local mask changes: 1744524.0 / 11173962
choose client_indexes: [ 0  3  7 10 19], accoring to random
choose mask diff: [1961902.0, 1957026.0, 1960116.0, 1962566.0, 1744524.0]
Doing local aggregation!
test acc on this client before 385 / 506 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.466752
Client Index = 19	Epoch: 1	Loss: 0.431648
Client Index = 19	Epoch: 2	Loss: 0.391412
Client Index = 19	Epoch: 3	Loss: 0.326687
Client Index = 19	Epoch: 4	Loss: 0.360792
test acc on this client after 399 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 51
{'test_acc': 0.7875118204003511, 'test_loss': 0.6488450400240732}
################local_test_on_all_clients before local training in communication round: 51
{'test_acc': 0.7597183935726789, 'test_loss': 0.7157100831308923}
################Communication round : 52
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 0
local mask changes: 1700064.0 / 11173962
choose client_indexes: [ 0  1  5  7 19], accoring to random
choose mask diff: [1700064.0, 1920926.0, 1925620.0, 1920078.0, 1923000.0]
Doing local aggregation!
test acc on this client before 353 / 504 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.693045
Client Index = 0	Epoch: 1	Loss: 0.613969
Client Index = 0	Epoch: 2	Loss: 0.622549
Client Index = 0	Epoch: 3	Loss: 0.543528
Client Index = 0	Epoch: 4	Loss: 0.571055
test acc on this client after 303 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 1
local mask changes: 1700844.0 / 11173962
choose client_indexes: [ 1  3  4 14 15], accoring to random
choose mask diff: [1700844.0, 1921082.0, 1921774.0, 1915350.0, 1914538.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.460442
Client Index = 1	Epoch: 1	Loss: 0.337563
Client Index = 1	Epoch: 2	Loss: 0.315413
Client Index = 1	Epoch: 3	Loss: 0.349870
Client Index = 1	Epoch: 4	Loss: 0.263756
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 2
local mask changes: 1700946.0 / 11173962
choose client_indexes: [ 2  4 15 16 19], accoring to random
choose mask diff: [1700946.0, 1914324.0, 1913176.0, 1917994.0, 1915660.0]
Doing local aggregation!
test acc on this client before 374 / 502 : 0.75
Client Index = 2	Epoch: 0	Loss: 0.509464
Client Index = 2	Epoch: 1	Loss: 0.270766
Client Index = 2	Epoch: 2	Loss: 0.247223
Client Index = 2	Epoch: 3	Loss: 0.345032
Client Index = 2	Epoch: 4	Loss: 0.194614
test acc on this client after 433 / 502 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 3
local mask changes: 1700586.0 / 11173962
choose client_indexes: [ 1  3  7  9 19], accoring to random
choose mask diff: [1922952.0, 1700586.0, 1923748.0, 1921770.0, 1920792.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.652251
Client Index = 3	Epoch: 1	Loss: 0.577774
Client Index = 3	Epoch: 2	Loss: 0.519892
Client Index = 3	Epoch: 3	Loss: 0.649075
Client Index = 3	Epoch: 4	Loss: 0.474717
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 4
local mask changes: 1700068.0 / 11173962
choose client_indexes: [ 4  5  6 16 17], accoring to random
choose mask diff: [1700068.0, 1922456.0, 1917700.0, 1922846.0, 1921062.0]
Doing local aggregation!
test acc on this client before 343 / 503 : 0.68
Client Index = 4	Epoch: 0	Loss: 0.513781
Client Index = 4	Epoch: 1	Loss: 0.469026
Client Index = 4	Epoch: 2	Loss: 0.329876
Client Index = 4	Epoch: 3	Loss: 0.396448
Client Index = 4	Epoch: 4	Loss: 0.329171
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 5
local mask changes: 1700718.0 / 11173962
choose client_indexes: [ 1  4  5 12 15], accoring to random
choose mask diff: [1916984.0, 1922788.0, 1700718.0, 1909526.0, 1916278.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 5	Epoch: 0	Loss: 0.620782
Client Index = 5	Epoch: 1	Loss: 0.416129
Client Index = 5	Epoch: 2	Loss: 0.396374
Client Index = 5	Epoch: 3	Loss: 0.379321
Client Index = 5	Epoch: 4	Loss: 0.345573
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 6
local mask changes: 1701042.0 / 11173962
choose client_indexes: [ 5  6 10 11 12], accoring to random
choose mask diff: [1920366.0, 1701042.0, 1927854.0, 1919968.0, 1924908.0]
Doing local aggregation!
test acc on this client before 371 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.713940
Client Index = 6	Epoch: 1	Loss: 0.637505
Client Index = 6	Epoch: 2	Loss: 0.699806
Client Index = 6	Epoch: 3	Loss: 0.567171
Client Index = 6	Epoch: 4	Loss: 0.552423
test acc on this client after 333 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 7
local mask changes: 1701190.0 / 11173962
choose client_indexes: [ 0  4  7  9 13], accoring to random
choose mask diff: [1925420.0, 1916476.0, 1701190.0, 1919572.0, 1922738.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.516783
Client Index = 7	Epoch: 1	Loss: 0.540495
Client Index = 7	Epoch: 2	Loss: 0.336210
Client Index = 7	Epoch: 3	Loss: 0.432768
Client Index = 7	Epoch: 4	Loss: 0.373455
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 8
local mask changes: 1701628.0 / 11173962
choose client_indexes: [ 0  8  9 10 13], accoring to random
choose mask diff: [1928828.0, 1701628.0, 1922360.0, 1922708.0, 1917914.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 8	Epoch: 0	Loss: 0.630101
Client Index = 8	Epoch: 1	Loss: 0.507775
Client Index = 8	Epoch: 2	Loss: 0.588590
Client Index = 8	Epoch: 3	Loss: 0.421041
Client Index = 8	Epoch: 4	Loss: 0.518096
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 9
local mask changes: 1700226.0 / 11173962
choose client_indexes: [ 9 10 13 17 19], accoring to random
choose mask diff: [1700226.0, 1913426.0, 1914922.0, 1919700.0, 1919218.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.443194
Client Index = 9	Epoch: 1	Loss: 0.360160
Client Index = 9	Epoch: 2	Loss: 0.429042
Client Index = 9	Epoch: 3	Loss: 0.277377
Client Index = 9	Epoch: 4	Loss: 0.332107
test acc on this client after 351 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 10
local mask changes: 1700318.0 / 11173962
choose client_indexes: [ 1  4  6  9 10], accoring to random
choose mask diff: [1921332.0, 1921740.0, 1926450.0, 1915484.0, 1700318.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 10	Epoch: 0	Loss: 0.495434
Client Index = 10	Epoch: 1	Loss: 0.493944
Client Index = 10	Epoch: 2	Loss: 0.541039
Client Index = 10	Epoch: 3	Loss: 0.464618
Client Index = 10	Epoch: 4	Loss: 0.419223
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 11
local mask changes: 1699024.0 / 11173962
choose client_indexes: [ 1 11 14 15 17], accoring to random
choose mask diff: [1916914.0, 1699024.0, 1913506.0, 1918866.0, 1918720.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 11	Epoch: 0	Loss: 0.451565
Client Index = 11	Epoch: 1	Loss: 0.282586
Client Index = 11	Epoch: 2	Loss: 0.277532
Client Index = 11	Epoch: 3	Loss: 0.331444
Client Index = 11	Epoch: 4	Loss: 0.217897
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 12
local mask changes: 1701418.0 / 11173962
choose client_indexes: [ 0  3  6 12 14], accoring to random
choose mask diff: [1927544.0, 1921086.0, 1926362.0, 1701418.0, 1923932.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.591688
Client Index = 12	Epoch: 1	Loss: 0.415069
Client Index = 12	Epoch: 2	Loss: 0.497544
Client Index = 12	Epoch: 3	Loss: 0.430463
Client Index = 12	Epoch: 4	Loss: 0.378124
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 13
local mask changes: 1700012.0 / 11173962
choose client_indexes: [ 8 13 14 16 19], accoring to random
choose mask diff: [1922096.0, 1700012.0, 1926436.0, 1920590.0, 1924074.0]
Doing local aggregation!
test acc on this client before 370 / 503 : 0.74
Client Index = 13	Epoch: 0	Loss: 0.545127
Client Index = 13	Epoch: 1	Loss: 0.431075
Client Index = 13	Epoch: 2	Loss: 0.420907
Client Index = 13	Epoch: 3	Loss: 0.415873
Client Index = 13	Epoch: 4	Loss: 0.447263
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 14
local mask changes: 1700326.0 / 11173962
choose client_indexes: [ 3 13 14 16 17], accoring to random
choose mask diff: [1924068.0, 1928746.0, 1700326.0, 1924870.0, 1922980.0]
Doing local aggregation!
test acc on this client before 360 / 502 : 0.72
Client Index = 14	Epoch: 0	Loss: 0.604360
Client Index = 14	Epoch: 1	Loss: 0.510148
Client Index = 14	Epoch: 2	Loss: 0.525988
Client Index = 14	Epoch: 3	Loss: 0.481101
Client Index = 14	Epoch: 4	Loss: 0.501803
test acc on this client after 373 / 502 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 15
local mask changes: 1699390.0 / 11173962
choose client_indexes: [ 5  7  8 10 15], accoring to random
choose mask diff: [1914826.0, 1921028.0, 1917120.0, 1923714.0, 1699390.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.462165
Client Index = 15	Epoch: 1	Loss: 0.407796
Client Index = 15	Epoch: 2	Loss: 0.351427
Client Index = 15	Epoch: 3	Loss: 0.313785
Client Index = 15	Epoch: 4	Loss: 0.602106
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 16
local mask changes: 1700142.0 / 11173962
choose client_indexes: [ 0  3  4 10 16], accoring to random
choose mask diff: [1921684.0, 1923402.0, 1920828.0, 1920154.0, 1700142.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 16	Epoch: 0	Loss: 0.452709
Client Index = 16	Epoch: 1	Loss: 0.426506
Client Index = 16	Epoch: 2	Loss: 0.386296
Client Index = 16	Epoch: 3	Loss: 0.316989
Client Index = 16	Epoch: 4	Loss: 0.342968
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 17
local mask changes: 1699770.0 / 11173962
choose client_indexes: [ 4 10 15 17 19], accoring to random
choose mask diff: [1918372.0, 1919832.0, 1920338.0, 1699770.0, 1914246.0]
Doing local aggregation!
test acc on this client before 385 / 505 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.544419
Client Index = 17	Epoch: 1	Loss: 0.391564
Client Index = 17	Epoch: 2	Loss: 0.347778
Client Index = 17	Epoch: 3	Loss: 0.341710
Client Index = 17	Epoch: 4	Loss: 0.255226
test acc on this client after 433 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 18
local mask changes: 1700002.0 / 11173962
choose client_indexes: [ 0  5  9 18 19], accoring to random
choose mask diff: [1913308.0, 1910680.0, 1909736.0, 1700002.0, 1917444.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 18	Epoch: 0	Loss: 0.593545
Client Index = 18	Epoch: 1	Loss: 0.358260
Client Index = 18	Epoch: 2	Loss: 0.323856
Client Index = 18	Epoch: 3	Loss: 0.269088
Client Index = 18	Epoch: 4	Loss: 0.334193
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(52) with spasity 0.5: 19
local mask changes: 1701476.0 / 11173962
choose client_indexes: [ 2  4  6 14 19], accoring to random
choose mask diff: [1917136.0, 1919044.0, 1919884.0, 1924212.0, 1701476.0]
Doing local aggregation!
test acc on this client before 300 / 506 : 0.59
Client Index = 19	Epoch: 0	Loss: 0.492312
Client Index = 19	Epoch: 1	Loss: 0.359115
Client Index = 19	Epoch: 2	Loss: 0.397035
Client Index = 19	Epoch: 3	Loss: 0.350507
Client Index = 19	Epoch: 4	Loss: 0.447311
test acc on this client after 384 / 506 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 52
{'test_acc': 0.7809789671057835, 'test_loss': 0.6748637349375072}
################local_test_on_all_clients before local training in communication round: 52
{'test_acc': 0.7396840141047459, 'test_loss': 0.7699428649010183}
################Communication round : 53
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 0
local mask changes: 1655464.0 / 11173962
choose client_indexes: [ 0  9 10 18 19], accoring to random
choose mask diff: [1655464.0, 1882726.0, 1887250.0, 1881868.0, 1879102.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.736496
Client Index = 0	Epoch: 1	Loss: 0.566769
Client Index = 0	Epoch: 2	Loss: 0.631776
Client Index = 0	Epoch: 3	Loss: 0.554878
Client Index = 0	Epoch: 4	Loss: 0.527158
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 1
local mask changes: 1655956.0 / 11173962
choose client_indexes: [ 0  1 13 14 16], accoring to random
choose mask diff: [1883008.0, 1655956.0, 1888740.0, 1873844.0, 1874932.0]
Doing local aggregation!
test acc on this client before 386 / 503 : 0.77
Client Index = 1	Epoch: 0	Loss: 0.446154
Client Index = 1	Epoch: 1	Loss: 0.273998
Client Index = 1	Epoch: 2	Loss: 0.320525
Client Index = 1	Epoch: 3	Loss: 0.335623
Client Index = 1	Epoch: 4	Loss: 0.253789
test acc on this client after 414 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 2
local mask changes: 1655744.0 / 11173962
choose client_indexes: [ 2  3 12 17 19], accoring to random
choose mask diff: [1655744.0, 1879266.0, 1878538.0, 1877100.0, 1873706.0]
Doing local aggregation!
test acc on this client before 406 / 502 : 0.81
Client Index = 2	Epoch: 0	Loss: 0.311133
Client Index = 2	Epoch: 1	Loss: 0.561345
Client Index = 2	Epoch: 2	Loss: 0.260261
Client Index = 2	Epoch: 3	Loss: 0.229693
Client Index = 2	Epoch: 4	Loss: 0.245132
test acc on this client after 430 / 502 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 3
local mask changes: 1656324.0 / 11173962
choose client_indexes: [ 3 10 13 15 17], accoring to random
choose mask diff: [1656324.0, 1891276.0, 1887886.0, 1880160.0, 1880718.0]
Doing local aggregation!
test acc on this client before 349 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.660889
Client Index = 3	Epoch: 1	Loss: 0.536743
Client Index = 3	Epoch: 2	Loss: 0.611173
Client Index = 3	Epoch: 3	Loss: 0.490822
Client Index = 3	Epoch: 4	Loss: 0.470262
test acc on this client after 379 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 4
local mask changes: 1655226.0 / 11173962
choose client_indexes: [ 4  9 16 17 19], accoring to random
choose mask diff: [1655226.0, 1884156.0, 1879496.0, 1877592.0, 1885180.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.524093
Client Index = 4	Epoch: 1	Loss: 0.377822
Client Index = 4	Epoch: 2	Loss: 0.396480
Client Index = 4	Epoch: 3	Loss: 0.307469
Client Index = 4	Epoch: 4	Loss: 0.274947
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 5
local mask changes: 1655586.0 / 11173962
choose client_indexes: [ 0  5  8  9 10], accoring to random
choose mask diff: [1885216.0, 1655586.0, 1887348.0, 1877772.0, 1886310.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.397477
Client Index = 5	Epoch: 1	Loss: 0.466934
Client Index = 5	Epoch: 2	Loss: 0.322772
Client Index = 5	Epoch: 3	Loss: 0.371901
Client Index = 5	Epoch: 4	Loss: 0.350681
test acc on this client after 333 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 6
local mask changes: 1656216.0 / 11173962
choose client_indexes: [ 0  4  6 16 18], accoring to random
choose mask diff: [1894230.0, 1885062.0, 1656216.0, 1885960.0, 1885918.0]
Doing local aggregation!
test acc on this client before 364 / 505 : 0.72
Client Index = 6	Epoch: 0	Loss: 0.667431
Client Index = 6	Epoch: 1	Loss: 0.694864
Client Index = 6	Epoch: 2	Loss: 0.550828
Client Index = 6	Epoch: 3	Loss: 0.611820
Client Index = 6	Epoch: 4	Loss: 0.561286
test acc on this client after 326 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 7
local mask changes: 1656010.0 / 11173962
choose client_indexes: [ 1  7  8  9 15], accoring to random
choose mask diff: [1882168.0, 1656010.0, 1876740.0, 1877884.0, 1885806.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 7	Epoch: 0	Loss: 0.492056
Client Index = 7	Epoch: 1	Loss: 0.411851
Client Index = 7	Epoch: 2	Loss: 0.442727
Client Index = 7	Epoch: 3	Loss: 0.447878
Client Index = 7	Epoch: 4	Loss: 0.289761
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 8
local mask changes: 1655288.0 / 11173962
choose client_indexes: [ 3  5  8  9 12], accoring to random
choose mask diff: [1891606.0, 1883834.0, 1655288.0, 1879980.0, 1885498.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 8	Epoch: 0	Loss: 0.671244
Client Index = 8	Epoch: 1	Loss: 0.558305
Client Index = 8	Epoch: 2	Loss: 0.506629
Client Index = 8	Epoch: 3	Loss: 0.414457
Client Index = 8	Epoch: 4	Loss: 0.582212
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 9
local mask changes: 1653268.0 / 11173962
choose client_indexes: [ 2  4  9 11 17], accoring to random
choose mask diff: [1880598.0, 1885718.0, 1653268.0, 1885636.0, 1874678.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 9	Epoch: 0	Loss: 0.480412
Client Index = 9	Epoch: 1	Loss: 0.361942
Client Index = 9	Epoch: 2	Loss: 0.351459
Client Index = 9	Epoch: 3	Loss: 0.265077
Client Index = 9	Epoch: 4	Loss: 0.345522
test acc on this client after 394 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 10
local mask changes: 1655694.0 / 11173962
choose client_indexes: [ 2  7  8  9 10], accoring to random
choose mask diff: [1875936.0, 1878424.0, 1890272.0, 1873008.0, 1655694.0]
Doing local aggregation!
test acc on this client before 388 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.502619
Client Index = 10	Epoch: 1	Loss: 0.523127
Client Index = 10	Epoch: 2	Loss: 0.428837
Client Index = 10	Epoch: 3	Loss: 0.368929
Client Index = 10	Epoch: 4	Loss: 0.518001
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 11
local mask changes: 1656360.0 / 11173962
choose client_indexes: [ 3  6  7 11 13], accoring to random
choose mask diff: [1877486.0, 1878716.0, 1882812.0, 1656360.0, 1886046.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.382513
Client Index = 11	Epoch: 1	Loss: 0.266859
Client Index = 11	Epoch: 2	Loss: 0.262550
Client Index = 11	Epoch: 3	Loss: 0.284096
Client Index = 11	Epoch: 4	Loss: 0.229656
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 12
local mask changes: 1655652.0 / 11173962
choose client_indexes: [ 1  9 10 12 15], accoring to random
choose mask diff: [1885438.0, 1884324.0, 1886134.0, 1655652.0, 1883952.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.491399
Client Index = 12	Epoch: 1	Loss: 0.453285
Client Index = 12	Epoch: 2	Loss: 0.408358
Client Index = 12	Epoch: 3	Loss: 0.412727
Client Index = 12	Epoch: 4	Loss: 0.422846
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 13
local mask changes: 1656706.0 / 11173962
choose client_indexes: [ 6  8 11 13 17], accoring to random
choose mask diff: [1891944.0, 1878996.0, 1885812.0, 1656706.0, 1882922.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.544049
Client Index = 13	Epoch: 1	Loss: 0.484022
Client Index = 13	Epoch: 2	Loss: 0.468795
Client Index = 13	Epoch: 3	Loss: 0.377501
Client Index = 13	Epoch: 4	Loss: 0.388286
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 14
local mask changes: 1656778.0 / 11173962
choose client_indexes: [ 1  2  8 13 14], accoring to random
choose mask diff: [1883112.0, 1882284.0, 1885586.0, 1884254.0, 1656778.0]
Doing local aggregation!
test acc on this client before 401 / 502 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.578513
Client Index = 14	Epoch: 1	Loss: 0.506504
Client Index = 14	Epoch: 2	Loss: 0.594167
Client Index = 14	Epoch: 3	Loss: 0.467437
Client Index = 14	Epoch: 4	Loss: 0.467940
test acc on this client after 320 / 502 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 15
local mask changes: 1656106.0 / 11173962
choose client_indexes: [ 2  6 14 15 17], accoring to random
choose mask diff: [1878688.0, 1888756.0, 1880114.0, 1656106.0, 1881284.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 15	Epoch: 0	Loss: 0.460846
Client Index = 15	Epoch: 1	Loss: 0.360832
Client Index = 15	Epoch: 2	Loss: 0.385291
Client Index = 15	Epoch: 3	Loss: 0.412401
Client Index = 15	Epoch: 4	Loss: 0.312452
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 16
local mask changes: 1655350.0 / 11173962
choose client_indexes: [ 2  5  6 16 17], accoring to random
choose mask diff: [1880080.0, 1882266.0, 1886154.0, 1655350.0, 1881958.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.513641
Client Index = 16	Epoch: 1	Loss: 0.398189
Client Index = 16	Epoch: 2	Loss: 0.312088
Client Index = 16	Epoch: 3	Loss: 0.418114
Client Index = 16	Epoch: 4	Loss: 0.302598
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 17
local mask changes: 1655938.0 / 11173962
choose client_indexes: [ 1  9 12 15 17], accoring to random
choose mask diff: [1878952.0, 1878368.0, 1881864.0, 1873938.0, 1655938.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.521757
Client Index = 17	Epoch: 1	Loss: 0.419962
Client Index = 17	Epoch: 2	Loss: 0.297786
Client Index = 17	Epoch: 3	Loss: 0.335377
Client Index = 17	Epoch: 4	Loss: 0.344429
test acc on this client after 424 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 18
local mask changes: 1655824.0 / 11173962
choose client_indexes: [ 8  9 15 16 18], accoring to random
choose mask diff: [1883236.0, 1865320.0, 1881568.0, 1880354.0, 1655824.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.386904
Client Index = 18	Epoch: 1	Loss: 0.346674
Client Index = 18	Epoch: 2	Loss: 0.302981
Client Index = 18	Epoch: 3	Loss: 0.324138
Client Index = 18	Epoch: 4	Loss: 0.271398
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(53) with spasity 0.5: 19
local mask changes: 1656682.0 / 11173962
choose client_indexes: [ 0  2  3  8 19], accoring to random
choose mask diff: [1882442.0, 1875374.0, 1881664.0, 1885216.0, 1656682.0]
Doing local aggregation!
test acc on this client before 341 / 506 : 0.67
Client Index = 19	Epoch: 0	Loss: 0.414405
Client Index = 19	Epoch: 1	Loss: 0.446204
Client Index = 19	Epoch: 2	Loss: 0.402266
Client Index = 19	Epoch: 3	Loss: 0.325095
Client Index = 19	Epoch: 4	Loss: 0.352687
test acc on this client after 375 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 53
{'test_acc': 0.7737129613164574, 'test_loss': 0.7059326230687988}
################local_test_on_all_clients before local training in communication round: 53
{'test_acc': 0.7651950045764779, 'test_loss': 0.7056372107998191}
################Communication round : 54
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 0
local mask changes: 1609946.0 / 11173962
choose client_indexes: [ 0  3  4 15 18], accoring to random
choose mask diff: [1609946.0, 1851216.0, 1846286.0, 1853146.0, 1836842.0]
Doing local aggregation!
test acc on this client before 352 / 504 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.707074
Client Index = 0	Epoch: 1	Loss: 0.583133
Client Index = 0	Epoch: 2	Loss: 0.613938
Client Index = 0	Epoch: 3	Loss: 0.593209
Client Index = 0	Epoch: 4	Loss: 0.540021
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 1
local mask changes: 1610852.0 / 11173962
choose client_indexes: [ 0  1  4  6 12], accoring to random
choose mask diff: [1839572.0, 1610852.0, 1844782.0, 1852382.0, 1846968.0]
Doing local aggregation!
test acc on this client before 394 / 503 : 0.78
Client Index = 1	Epoch: 0	Loss: 0.390321
Client Index = 1	Epoch: 1	Loss: 0.398170
Client Index = 1	Epoch: 2	Loss: 0.282230
Client Index = 1	Epoch: 3	Loss: 0.244194
Client Index = 1	Epoch: 4	Loss: 0.245393
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 2
local mask changes: 1610852.0 / 11173962
choose client_indexes: [ 1  2  8 12 14], accoring to random
choose mask diff: [1842380.0, 1610852.0, 1846688.0, 1839618.0, 1846042.0]
Doing local aggregation!
test acc on this client before 414 / 502 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.416886
Client Index = 2	Epoch: 1	Loss: 0.272813
Client Index = 2	Epoch: 2	Loss: 0.219584
Client Index = 2	Epoch: 3	Loss: 0.279102
Client Index = 2	Epoch: 4	Loss: 0.185548
test acc on this client after 437 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 3
local mask changes: 1611134.0 / 11173962
choose client_indexes: [ 3  4  7  8 18], accoring to random
choose mask diff: [1611134.0, 1848330.0, 1849610.0, 1854832.0, 1848770.0]
Doing local aggregation!
test acc on this client before 320 / 504 : 0.63
Client Index = 3	Epoch: 0	Loss: 0.688870
Client Index = 3	Epoch: 1	Loss: 0.566113
Client Index = 3	Epoch: 2	Loss: 0.571854
Client Index = 3	Epoch: 3	Loss: 0.526066
Client Index = 3	Epoch: 4	Loss: 0.438557
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 4
local mask changes: 1610566.0 / 11173962
choose client_indexes: [ 4  6 12 15 16], accoring to random
choose mask diff: [1610566.0, 1843440.0, 1851482.0, 1847334.0, 1837482.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.549356
Client Index = 4	Epoch: 1	Loss: 0.340861
Client Index = 4	Epoch: 2	Loss: 0.305107
Client Index = 4	Epoch: 3	Loss: 0.381500
Client Index = 4	Epoch: 4	Loss: 0.248837
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 5
local mask changes: 1609906.0 / 11173962
choose client_indexes: [ 5  6  8 12 16], accoring to random
choose mask diff: [1609906.0, 1847898.0, 1842706.0, 1839948.0, 1845810.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.484988
Client Index = 5	Epoch: 1	Loss: 0.417152
Client Index = 5	Epoch: 2	Loss: 0.352064
Client Index = 5	Epoch: 3	Loss: 0.282162
Client Index = 5	Epoch: 4	Loss: 0.326451
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 6
local mask changes: 1610368.0 / 11173962
choose client_indexes: [ 5  6  7 11 15], accoring to random
choose mask diff: [1848644.0, 1610368.0, 1846034.0, 1845820.0, 1854228.0]
Doing local aggregation!
test acc on this client before 370 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.748613
Client Index = 6	Epoch: 1	Loss: 0.560450
Client Index = 6	Epoch: 2	Loss: 0.561601
Client Index = 6	Epoch: 3	Loss: 0.607031
Client Index = 6	Epoch: 4	Loss: 0.491867
test acc on this client after 362 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 7
local mask changes: 1611332.0 / 11173962
choose client_indexes: [ 0  5  7  8 18], accoring to random
choose mask diff: [1843562.0, 1840634.0, 1611332.0, 1836474.0, 1846274.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 7	Epoch: 0	Loss: 0.484255
Client Index = 7	Epoch: 1	Loss: 0.389701
Client Index = 7	Epoch: 2	Loss: 0.434390
Client Index = 7	Epoch: 3	Loss: 0.359732
Client Index = 7	Epoch: 4	Loss: 0.356338
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 8
local mask changes: 1610952.0 / 11173962
choose client_indexes: [ 0  6  8 11 15], accoring to random
choose mask diff: [1854284.0, 1851140.0, 1610952.0, 1852316.0, 1846072.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 8	Epoch: 0	Loss: 0.585502
Client Index = 8	Epoch: 1	Loss: 0.532170
Client Index = 8	Epoch: 2	Loss: 0.529893
Client Index = 8	Epoch: 3	Loss: 0.440979
Client Index = 8	Epoch: 4	Loss: 0.412396
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 9
local mask changes: 1610612.0 / 11173962
choose client_indexes: [ 1  2  9 15 17], accoring to random
choose mask diff: [1843746.0, 1839858.0, 1610612.0, 1843438.0, 1830870.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 9	Epoch: 0	Loss: 0.449786
Client Index = 9	Epoch: 1	Loss: 0.334605
Client Index = 9	Epoch: 2	Loss: 0.311312
Client Index = 9	Epoch: 3	Loss: 0.363133
Client Index = 9	Epoch: 4	Loss: 0.329725
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 10
local mask changes: 1610002.0 / 11173962
choose client_indexes: [ 2  8 10 13 17], accoring to random
choose mask diff: [1837680.0, 1843472.0, 1610002.0, 1853286.0, 1843880.0]
Doing local aggregation!
test acc on this client before 385 / 503 : 0.77
Client Index = 10	Epoch: 0	Loss: 0.492858
Client Index = 10	Epoch: 1	Loss: 0.437094
Client Index = 10	Epoch: 2	Loss: 0.477158
Client Index = 10	Epoch: 3	Loss: 0.431894
Client Index = 10	Epoch: 4	Loss: 0.438251
test acc on this client after 380 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 11
local mask changes: 1609892.0 / 11173962
choose client_indexes: [ 4 10 11 16 19], accoring to random
choose mask diff: [1842212.0, 1849938.0, 1609892.0, 1843884.0, 1841160.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.353043
Client Index = 11	Epoch: 1	Loss: 0.326523
Client Index = 11	Epoch: 2	Loss: 0.213234
Client Index = 11	Epoch: 3	Loss: 0.283566
Client Index = 11	Epoch: 4	Loss: 0.204255
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 12
local mask changes: 1610116.0 / 11173962
choose client_indexes: [ 1  8 10 12 16], accoring to random
choose mask diff: [1842432.0, 1850910.0, 1843142.0, 1610116.0, 1848630.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.593898
Client Index = 12	Epoch: 1	Loss: 0.425382
Client Index = 12	Epoch: 2	Loss: 0.379365
Client Index = 12	Epoch: 3	Loss: 0.399206
Client Index = 12	Epoch: 4	Loss: 0.344193
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 13
local mask changes: 1610858.0 / 11173962
choose client_indexes: [ 4 13 15 16 17], accoring to random
choose mask diff: [1851766.0, 1610858.0, 1850792.0, 1848420.0, 1840868.0]
Doing local aggregation!
test acc on this client before 390 / 503 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.489029
Client Index = 13	Epoch: 1	Loss: 0.473985
Client Index = 13	Epoch: 2	Loss: 0.436095
Client Index = 13	Epoch: 3	Loss: 0.366303
Client Index = 13	Epoch: 4	Loss: 0.390592
test acc on this client after 371 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 14
local mask changes: 1609868.0 / 11173962
choose client_indexes: [ 3  4  7  9 14], accoring to random
choose mask diff: [1849406.0, 1847184.0, 1847388.0, 1844186.0, 1609868.0]
Doing local aggregation!
test acc on this client before 388 / 502 : 0.77
Client Index = 14	Epoch: 0	Loss: 0.543765
Client Index = 14	Epoch: 1	Loss: 0.631593
Client Index = 14	Epoch: 2	Loss: 0.480680
Client Index = 14	Epoch: 3	Loss: 0.447335
Client Index = 14	Epoch: 4	Loss: 0.473427
test acc on this client after 402 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 15
local mask changes: 1610586.0 / 11173962
choose client_indexes: [ 7 10 12 15 19], accoring to random
choose mask diff: [1845928.0, 1847984.0, 1848060.0, 1610586.0, 1846460.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.387192
Client Index = 15	Epoch: 1	Loss: 0.337760
Client Index = 15	Epoch: 2	Loss: 0.383682
Client Index = 15	Epoch: 3	Loss: 0.315818
Client Index = 15	Epoch: 4	Loss: 0.362381
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 16
local mask changes: 1610330.0 / 11173962
choose client_indexes: [ 1  2  3 13 16], accoring to random
choose mask diff: [1840002.0, 1835484.0, 1848716.0, 1846786.0, 1610330.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.466718
Client Index = 16	Epoch: 1	Loss: 0.408767
Client Index = 16	Epoch: 2	Loss: 0.340952
Client Index = 16	Epoch: 3	Loss: 0.321954
Client Index = 16	Epoch: 4	Loss: 0.358242
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 17
local mask changes: 1610590.0 / 11173962
choose client_indexes: [ 3  6 16 17 19], accoring to random
choose mask diff: [1845806.0, 1842048.0, 1846324.0, 1610590.0, 1838912.0]
Doing local aggregation!
test acc on this client before 399 / 505 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.466107
Client Index = 17	Epoch: 1	Loss: 0.365338
Client Index = 17	Epoch: 2	Loss: 0.371024
Client Index = 17	Epoch: 3	Loss: 0.406600
Client Index = 17	Epoch: 4	Loss: 0.249270
test acc on this client after 431 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 18
local mask changes: 1609708.0 / 11173962
choose client_indexes: [ 3  6 12 16 18], accoring to random
choose mask diff: [1846486.0, 1848848.0, 1844098.0, 1837046.0, 1609708.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.431622
Client Index = 18	Epoch: 1	Loss: 0.362942
Client Index = 18	Epoch: 2	Loss: 0.271071
Client Index = 18	Epoch: 3	Loss: 0.292251
Client Index = 18	Epoch: 4	Loss: 0.280132
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(54) with spasity 0.5: 19
local mask changes: 1610660.0 / 11173962
choose client_indexes: [ 3 10 15 18 19], accoring to random
choose mask diff: [1838578.0, 1847932.0, 1847726.0, 1843256.0, 1610660.0]
Doing local aggregation!
test acc on this client before 380 / 506 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.441991
Client Index = 19	Epoch: 1	Loss: 0.346183
Client Index = 19	Epoch: 2	Loss: 0.413430
Client Index = 19	Epoch: 3	Loss: 0.330450
Client Index = 19	Epoch: 4	Loss: 0.345919
test acc on this client after 363 / 506 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 54
{'test_acc': 0.7832632750266986, 'test_loss': 0.660050706094035}
################local_test_on_all_clients before local training in communication round: 54
{'test_acc': 0.7736236838280892, 'test_loss': 0.6738916001712012}
################Communication round : 55
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 0
local mask changes: 1563356.0 / 11173962
choose client_indexes: [ 0  2  3  8 11], accoring to random
choose mask diff: [1563356.0, 1811400.0, 1810438.0, 1818706.0, 1812654.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 0	Epoch: 0	Loss: 0.677618
Client Index = 0	Epoch: 1	Loss: 0.580855
Client Index = 0	Epoch: 2	Loss: 0.563291
Client Index = 0	Epoch: 3	Loss: 0.600257
Client Index = 0	Epoch: 4	Loss: 0.561862
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 1
local mask changes: 1564908.0 / 11173962
choose client_indexes: [ 1  6  7 14 19], accoring to random
choose mask diff: [1564908.0, 1808996.0, 1806428.0, 1801334.0, 1810138.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 1	Epoch: 0	Loss: 0.378246
Client Index = 1	Epoch: 1	Loss: 0.514127
Client Index = 1	Epoch: 2	Loss: 0.431688
Client Index = 1	Epoch: 3	Loss: 0.242529
Client Index = 1	Epoch: 4	Loss: 0.243195
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 2
local mask changes: 1564800.0 / 11173962
choose client_indexes: [ 0  2  4 18 19], accoring to random
choose mask diff: [1812308.0, 1564800.0, 1801126.0, 1805672.0, 1796494.0]
Doing local aggregation!
test acc on this client before 340 / 502 : 0.68
Client Index = 2	Epoch: 0	Loss: 0.435395
Client Index = 2	Epoch: 1	Loss: 0.248169
Client Index = 2	Epoch: 2	Loss: 0.247625
Client Index = 2	Epoch: 3	Loss: 0.357768
Client Index = 2	Epoch: 4	Loss: 0.230178
test acc on this client after 437 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 3
local mask changes: 1564840.0 / 11173962
choose client_indexes: [ 1  3  8 16 17], accoring to random
choose mask diff: [1808528.0, 1564840.0, 1808580.0, 1811960.0, 1806298.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.615170
Client Index = 3	Epoch: 1	Loss: 0.613689
Client Index = 3	Epoch: 2	Loss: 0.516339
Client Index = 3	Epoch: 3	Loss: 0.467959
Client Index = 3	Epoch: 4	Loss: 0.498355
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 4
local mask changes: 1564118.0 / 11173962
choose client_indexes: [ 4  5  6 15 18], accoring to random
choose mask diff: [1564118.0, 1809236.0, 1799498.0, 1803824.0, 1806162.0]
Doing local aggregation!
test acc on this client before 348 / 503 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.451819
Client Index = 4	Epoch: 1	Loss: 0.387989
Client Index = 4	Epoch: 2	Loss: 0.330392
Client Index = 4	Epoch: 3	Loss: 0.341825
Client Index = 4	Epoch: 4	Loss: 0.387519
test acc on this client after 373 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 5
local mask changes: 1564776.0 / 11173962
choose client_indexes: [ 4  5  8 14 18], accoring to random
choose mask diff: [1807880.0, 1564776.0, 1798122.0, 1808754.0, 1801888.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 5	Epoch: 0	Loss: 0.521965
Client Index = 5	Epoch: 1	Loss: 0.384324
Client Index = 5	Epoch: 2	Loss: 0.376907
Client Index = 5	Epoch: 3	Loss: 0.322758
Client Index = 5	Epoch: 4	Loss: 0.324710
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 6
local mask changes: 1565120.0 / 11173962
choose client_indexes: [ 6  8 10 13 18], accoring to random
choose mask diff: [1565120.0, 1817358.0, 1815936.0, 1817524.0, 1813204.0]
Doing local aggregation!
test acc on this client before 370 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.676854
Client Index = 6	Epoch: 1	Loss: 0.645215
Client Index = 6	Epoch: 2	Loss: 0.599556
Client Index = 6	Epoch: 3	Loss: 0.583622
Client Index = 6	Epoch: 4	Loss: 0.495373
test acc on this client after 383 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 7
local mask changes: 1565660.0 / 11173962
choose client_indexes: [ 4  6  7 12 15], accoring to random
choose mask diff: [1808932.0, 1812364.0, 1565660.0, 1809840.0, 1807834.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 7	Epoch: 0	Loss: 0.573075
Client Index = 7	Epoch: 1	Loss: 0.384807
Client Index = 7	Epoch: 2	Loss: 0.435616
Client Index = 7	Epoch: 3	Loss: 0.317415
Client Index = 7	Epoch: 4	Loss: 0.313968
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 8
local mask changes: 1565292.0 / 11173962
choose client_indexes: [ 4  8 10 12 13], accoring to random
choose mask diff: [1813984.0, 1565292.0, 1809216.0, 1811714.0, 1806066.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.637186
Client Index = 8	Epoch: 1	Loss: 0.498856
Client Index = 8	Epoch: 2	Loss: 0.553369
Client Index = 8	Epoch: 3	Loss: 0.434443
Client Index = 8	Epoch: 4	Loss: 0.362930
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 9
local mask changes: 1564508.0 / 11173962
choose client_indexes: [ 0  5  9 14 15], accoring to random
choose mask diff: [1807650.0, 1802980.0, 1564508.0, 1806276.0, 1799270.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.403731
Client Index = 9	Epoch: 1	Loss: 0.352685
Client Index = 9	Epoch: 2	Loss: 0.308800
Client Index = 9	Epoch: 3	Loss: 0.305809
Client Index = 9	Epoch: 4	Loss: 0.250856
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 10
local mask changes: 1565592.0 / 11173962
choose client_indexes: [ 2  4 10 11 17], accoring to random
choose mask diff: [1800252.0, 1812922.0, 1565592.0, 1816390.0, 1803212.0]
Doing local aggregation!
test acc on this client before 379 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.613216
Client Index = 10	Epoch: 1	Loss: 0.448710
Client Index = 10	Epoch: 2	Loss: 0.392532
Client Index = 10	Epoch: 3	Loss: 0.399370
Client Index = 10	Epoch: 4	Loss: 0.339181
test acc on this client after 382 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 11
local mask changes: 1564682.0 / 11173962
choose client_indexes: [ 2  8 11 14 15], accoring to random
choose mask diff: [1798022.0, 1813470.0, 1564682.0, 1804998.0, 1805902.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.444288
Client Index = 11	Epoch: 1	Loss: 0.249157
Client Index = 11	Epoch: 2	Loss: 0.231520
Client Index = 11	Epoch: 3	Loss: 0.265663
Client Index = 11	Epoch: 4	Loss: 0.210190
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 12
local mask changes: 1564756.0 / 11173962
choose client_indexes: [ 2 12 14 15 16], accoring to random
choose mask diff: [1804828.0, 1564756.0, 1811508.0, 1809740.0, 1804932.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.549003
Client Index = 12	Epoch: 1	Loss: 0.430551
Client Index = 12	Epoch: 2	Loss: 0.430529
Client Index = 12	Epoch: 3	Loss: 0.390795
Client Index = 12	Epoch: 4	Loss: 0.405143
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 13
local mask changes: 1564674.0 / 11173962
choose client_indexes: [ 5  6  8  9 13], accoring to random
choose mask diff: [1812150.0, 1815414.0, 1808494.0, 1803528.0, 1564674.0]
Doing local aggregation!
test acc on this client before 396 / 503 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.528566
Client Index = 13	Epoch: 1	Loss: 0.461713
Client Index = 13	Epoch: 2	Loss: 0.369936
Client Index = 13	Epoch: 3	Loss: 0.473461
Client Index = 13	Epoch: 4	Loss: 0.345845
test acc on this client after 344 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 14
local mask changes: 1565202.0 / 11173962
choose client_indexes: [ 3  9 14 16 18], accoring to random
choose mask diff: [1806882.0, 1801114.0, 1565202.0, 1809360.0, 1807430.0]
Doing local aggregation!
test acc on this client before 406 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.561459
Client Index = 14	Epoch: 1	Loss: 0.529572
Client Index = 14	Epoch: 2	Loss: 0.432437
Client Index = 14	Epoch: 3	Loss: 0.471710
Client Index = 14	Epoch: 4	Loss: 0.454622
test acc on this client after 341 / 502 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 15
local mask changes: 1565174.0 / 11173962
choose client_indexes: [ 3  9 10 15 19], accoring to random
choose mask diff: [1808514.0, 1804866.0, 1806502.0, 1565174.0, 1805184.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.372811
Client Index = 15	Epoch: 1	Loss: 0.422185
Client Index = 15	Epoch: 2	Loss: 0.300407
Client Index = 15	Epoch: 3	Loss: 0.322213
Client Index = 15	Epoch: 4	Loss: 0.325685
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 16
local mask changes: 1564838.0 / 11173962
choose client_indexes: [14 15 16 18 19], accoring to random
choose mask diff: [1807260.0, 1811060.0, 1564838.0, 1803850.0, 1813806.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.397582
Client Index = 16	Epoch: 1	Loss: 0.392969
Client Index = 16	Epoch: 2	Loss: 0.280309
Client Index = 16	Epoch: 3	Loss: 0.376952
Client Index = 16	Epoch: 4	Loss: 0.362495
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 17
local mask changes: 1564390.0 / 11173962
choose client_indexes: [ 4  6  8 12 17], accoring to random
choose mask diff: [1799034.0, 1805004.0, 1812970.0, 1804560.0, 1564390.0]
Doing local aggregation!
test acc on this client before 318 / 505 : 0.63
Client Index = 17	Epoch: 0	Loss: 0.519129
Client Index = 17	Epoch: 1	Loss: 0.422861
Client Index = 17	Epoch: 2	Loss: 0.361990
Client Index = 17	Epoch: 3	Loss: 0.259853
Client Index = 17	Epoch: 4	Loss: 0.325195
test acc on this client after 430 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 18
local mask changes: 1564628.0 / 11173962
choose client_indexes: [ 7 13 16 17 18], accoring to random
choose mask diff: [1805914.0, 1810534.0, 1796986.0, 1805066.0, 1564628.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 18	Epoch: 0	Loss: 0.455559
Client Index = 18	Epoch: 1	Loss: 0.299154
Client Index = 18	Epoch: 2	Loss: 0.330441
Client Index = 18	Epoch: 3	Loss: 0.321443
Client Index = 18	Epoch: 4	Loss: 0.257432
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(55) with spasity 0.5: 19
local mask changes: 1565668.0 / 11173962
choose client_indexes: [ 1  3  9 12 19], accoring to random
choose mask diff: [1811218.0, 1798930.0, 1806466.0, 1811312.0, 1565668.0]
Doing local aggregation!
test acc on this client before 413 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.464636
Client Index = 19	Epoch: 1	Loss: 0.415057
Client Index = 19	Epoch: 2	Loss: 0.288046
Client Index = 19	Epoch: 3	Loss: 0.343409
Client Index = 19	Epoch: 4	Loss: 0.416311
test acc on this client after 283 / 506 : 0.56
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 55
{'test_acc': 0.7644941216066299, 'test_loss': 0.7541237223403339}
################local_test_on_all_clients before local training in communication round: 55
{'test_acc': 0.7583160943263495, 'test_loss': 0.7269723145193504}
################Communication round : 56
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 0
local mask changes: 1518980.0 / 11173962
choose client_indexes: [ 0  2  6  7 18], accoring to random
choose mask diff: [1518980.0, 1772040.0, 1782418.0, 1772108.0, 1764984.0]
Doing local aggregation!
test acc on this client before 310 / 504 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.652300
Client Index = 0	Epoch: 1	Loss: 0.605744
Client Index = 0	Epoch: 2	Loss: 0.559545
Client Index = 0	Epoch: 3	Loss: 0.542192
Client Index = 0	Epoch: 4	Loss: 0.479459
test acc on this client after 341 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 1
local mask changes: 1519818.0 / 11173962
choose client_indexes: [ 0  1  5 14 19], accoring to random
choose mask diff: [1767792.0, 1519818.0, 1768620.0, 1763244.0, 1766548.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 1	Epoch: 0	Loss: 0.364080
Client Index = 1	Epoch: 1	Loss: 0.313424
Client Index = 1	Epoch: 2	Loss: 0.290676
Client Index = 1	Epoch: 3	Loss: 0.226020
Client Index = 1	Epoch: 4	Loss: 0.194349
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 2
local mask changes: 1520374.0 / 11173962
choose client_indexes: [ 0  2  4  9 12], accoring to random
choose mask diff: [1768238.0, 1520374.0, 1759720.0, 1763892.0, 1765114.0]
Doing local aggregation!
test acc on this client before 387 / 502 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.420769
Client Index = 2	Epoch: 1	Loss: 0.265258
Client Index = 2	Epoch: 2	Loss: 0.282076
Client Index = 2	Epoch: 3	Loss: 0.245772
Client Index = 2	Epoch: 4	Loss: 0.187911
test acc on this client after 442 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 3
local mask changes: 1520182.0 / 11173962
choose client_indexes: [ 3 11 12 18 19], accoring to random
choose mask diff: [1520182.0, 1766764.0, 1777066.0, 1766772.0, 1766666.0]
Doing local aggregation!
test acc on this client before 331 / 504 : 0.66
Client Index = 3	Epoch: 0	Loss: 0.635513
Client Index = 3	Epoch: 1	Loss: 0.472710
Client Index = 3	Epoch: 2	Loss: 0.559064
Client Index = 3	Epoch: 3	Loss: 0.496029
Client Index = 3	Epoch: 4	Loss: 0.487390
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 4
local mask changes: 1518500.0 / 11173962
choose client_indexes: [ 4  5  9 12 15], accoring to random
choose mask diff: [1518500.0, 1765786.0, 1769172.0, 1771914.0, 1764256.0]
Doing local aggregation!
test acc on this client before 345 / 503 : 0.69
Client Index = 4	Epoch: 0	Loss: 0.568133
Client Index = 4	Epoch: 1	Loss: 0.309032
Client Index = 4	Epoch: 2	Loss: 0.321908
Client Index = 4	Epoch: 3	Loss: 0.264767
Client Index = 4	Epoch: 4	Loss: 0.462227
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 5
local mask changes: 1519768.0 / 11173962
choose client_indexes: [ 4  5 14 17 19], accoring to random
choose mask diff: [1764706.0, 1519768.0, 1767504.0, 1768986.0, 1775310.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.539023
Client Index = 5	Epoch: 1	Loss: 0.357115
Client Index = 5	Epoch: 2	Loss: 0.448044
Client Index = 5	Epoch: 3	Loss: 0.355588
Client Index = 5	Epoch: 4	Loss: 0.334875
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 6
local mask changes: 1519110.0 / 11173962
choose client_indexes: [ 3  4  6 13 15], accoring to random
choose mask diff: [1780288.0, 1769200.0, 1519110.0, 1773938.0, 1775734.0]
Doing local aggregation!
test acc on this client before 369 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.647680
Client Index = 6	Epoch: 1	Loss: 0.547295
Client Index = 6	Epoch: 2	Loss: 0.548869
Client Index = 6	Epoch: 3	Loss: 0.552541
Client Index = 6	Epoch: 4	Loss: 0.466346
test acc on this client after 377 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 7
local mask changes: 1520222.0 / 11173962
choose client_indexes: [ 2  6  7 10 12], accoring to random
choose mask diff: [1770388.0, 1765246.0, 1520222.0, 1769254.0, 1766974.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.500016
Client Index = 7	Epoch: 1	Loss: 0.408586
Client Index = 7	Epoch: 2	Loss: 0.417422
Client Index = 7	Epoch: 3	Loss: 0.430121
Client Index = 7	Epoch: 4	Loss: 0.384918
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 8
local mask changes: 1517272.0 / 11173962
choose client_indexes: [ 6  8 16 17 18], accoring to random
choose mask diff: [1773620.0, 1517272.0, 1776502.0, 1774080.0, 1771288.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 8	Epoch: 0	Loss: 0.589381
Client Index = 8	Epoch: 1	Loss: 0.480674
Client Index = 8	Epoch: 2	Loss: 0.453806
Client Index = 8	Epoch: 3	Loss: 0.452616
Client Index = 8	Epoch: 4	Loss: 0.393447
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 9
local mask changes: 1518666.0 / 11173962
choose client_indexes: [ 4  6  9 12 17], accoring to random
choose mask diff: [1768820.0, 1779564.0, 1518666.0, 1769858.0, 1757804.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.401347
Client Index = 9	Epoch: 1	Loss: 0.422727
Client Index = 9	Epoch: 2	Loss: 0.386347
Client Index = 9	Epoch: 3	Loss: 0.286966
Client Index = 9	Epoch: 4	Loss: 0.266377
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 10
local mask changes: 1518456.0 / 11173962
choose client_indexes: [ 6  9 10 17 18], accoring to random
choose mask diff: [1779736.0, 1764762.0, 1518456.0, 1763664.0, 1773038.0]
Doing local aggregation!
test acc on this client before 372 / 503 : 0.74
Client Index = 10	Epoch: 0	Loss: 0.492163
Client Index = 10	Epoch: 1	Loss: 0.490703
Client Index = 10	Epoch: 2	Loss: 0.326628
Client Index = 10	Epoch: 3	Loss: 0.440204
Client Index = 10	Epoch: 4	Loss: 0.316197
test acc on this client after 362 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 11
local mask changes: 1518076.0 / 11173962
choose client_indexes: [ 1  5  7  8 11], accoring to random
choose mask diff: [1766676.0, 1771778.0, 1770766.0, 1766612.0, 1518076.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 11	Epoch: 0	Loss: 0.368133
Client Index = 11	Epoch: 1	Loss: 0.310709
Client Index = 11	Epoch: 2	Loss: 0.278883
Client Index = 11	Epoch: 3	Loss: 0.213167
Client Index = 11	Epoch: 4	Loss: 0.334662
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 12
local mask changes: 1519188.0 / 11173962
choose client_indexes: [ 0  3  8 12 15], accoring to random
choose mask diff: [1778998.0, 1776446.0, 1773012.0, 1519188.0, 1763388.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.491576
Client Index = 12	Epoch: 1	Loss: 0.410592
Client Index = 12	Epoch: 2	Loss: 0.617678
Client Index = 12	Epoch: 3	Loss: 0.374000
Client Index = 12	Epoch: 4	Loss: 0.328560
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 13
local mask changes: 1518490.0 / 11173962
choose client_indexes: [ 1  5  6  7 13], accoring to random
choose mask diff: [1776012.0, 1770276.0, 1774414.0, 1773456.0, 1518490.0]
Doing local aggregation!
test acc on this client before 387 / 503 : 0.77
Client Index = 13	Epoch: 0	Loss: 0.591310
Client Index = 13	Epoch: 1	Loss: 0.479795
Client Index = 13	Epoch: 2	Loss: 0.401026
Client Index = 13	Epoch: 3	Loss: 0.410361
Client Index = 13	Epoch: 4	Loss: 0.436697
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 14
local mask changes: 1519450.0 / 11173962
choose client_indexes: [ 6  8  9 14 16], accoring to random
choose mask diff: [1777634.0, 1775714.0, 1760862.0, 1519450.0, 1766380.0]
Doing local aggregation!
test acc on this client before 397 / 502 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.575037
Client Index = 14	Epoch: 1	Loss: 0.478652
Client Index = 14	Epoch: 2	Loss: 0.491450
Client Index = 14	Epoch: 3	Loss: 0.403940
Client Index = 14	Epoch: 4	Loss: 0.461578
test acc on this client after 388 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 15
local mask changes: 1518082.0 / 11173962
choose client_indexes: [ 6  7 12 15 17], accoring to random
choose mask diff: [1775520.0, 1767694.0, 1768596.0, 1518082.0, 1762790.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.397145
Client Index = 15	Epoch: 1	Loss: 0.367202
Client Index = 15	Epoch: 2	Loss: 0.289595
Client Index = 15	Epoch: 3	Loss: 0.438939
Client Index = 15	Epoch: 4	Loss: 0.321562
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 16
local mask changes: 1519486.0 / 11173962
choose client_indexes: [ 3  4  5 15 16], accoring to random
choose mask diff: [1770818.0, 1765358.0, 1768856.0, 1770246.0, 1519486.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 16	Epoch: 0	Loss: 0.431811
Client Index = 16	Epoch: 1	Loss: 0.371786
Client Index = 16	Epoch: 2	Loss: 0.340873
Client Index = 16	Epoch: 3	Loss: 0.285669
Client Index = 16	Epoch: 4	Loss: 0.387121
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 17
local mask changes: 1519430.0 / 11173962
choose client_indexes: [ 0  2  9 12 17], accoring to random
choose mask diff: [1773752.0, 1765402.0, 1756346.0, 1763800.0, 1519430.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 17	Epoch: 0	Loss: 0.531068
Client Index = 17	Epoch: 1	Loss: 0.406838
Client Index = 17	Epoch: 2	Loss: 0.317038
Client Index = 17	Epoch: 3	Loss: 0.254852
Client Index = 17	Epoch: 4	Loss: 0.325220
test acc on this client after 436 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 18
local mask changes: 1519724.0 / 11173962
choose client_indexes: [ 7 10 16 17 18], accoring to random
choose mask diff: [1760928.0, 1772286.0, 1755722.0, 1761478.0, 1519724.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 18	Epoch: 0	Loss: 0.408605
Client Index = 18	Epoch: 1	Loss: 0.338385
Client Index = 18	Epoch: 2	Loss: 0.278582
Client Index = 18	Epoch: 3	Loss: 0.357726
Client Index = 18	Epoch: 4	Loss: 0.275784
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(56) with spasity 0.5: 19
local mask changes: 1519112.0 / 11173962
choose client_indexes: [ 3  4 11 17 19], accoring to random
choose mask diff: [1761936.0, 1771878.0, 1768184.0, 1765570.0, 1519112.0]
Doing local aggregation!
test acc on this client before 375 / 506 : 0.74
Client Index = 19	Epoch: 0	Loss: 0.465572
Client Index = 19	Epoch: 1	Loss: 0.338077
Client Index = 19	Epoch: 2	Loss: 0.305006
Client Index = 19	Epoch: 3	Loss: 0.320610
Client Index = 19	Epoch: 4	Loss: 0.296884
test acc on this client after 379 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 56
{'test_acc': 0.7924782694006665, 'test_loss': 0.6494192508881985}
################local_test_on_all_clients before local training in communication round: 56
{'test_acc': 0.7657575718578198, 'test_loss': 0.7157107596620909}
################Communication round : 57
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 0
local mask changes: 1472734.0 / 11173962
choose client_indexes: [ 0  4  6  8 15], accoring to random
choose mask diff: [1472734.0, 1738534.0, 1740276.0, 1738606.0, 1740488.0]
Doing local aggregation!
test acc on this client before 315 / 504 : 0.62
Client Index = 0	Epoch: 0	Loss: 0.658023
Client Index = 0	Epoch: 1	Loss: 0.614487
Client Index = 0	Epoch: 2	Loss: 0.552101
Client Index = 0	Epoch: 3	Loss: 0.529672
Client Index = 0	Epoch: 4	Loss: 0.513482
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 1
local mask changes: 1473032.0 / 11173962
choose client_indexes: [ 0  1  3 13 17], accoring to random
choose mask diff: [1727556.0, 1473032.0, 1730954.0, 1737106.0, 1730896.0]
Doing local aggregation!
test acc on this client before 419 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.495683
Client Index = 1	Epoch: 1	Loss: 0.229804
Client Index = 1	Epoch: 2	Loss: 0.227196
Client Index = 1	Epoch: 3	Loss: 0.285893
Client Index = 1	Epoch: 4	Loss: 0.252636
test acc on this client after 401 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 2
local mask changes: 1472784.0 / 11173962
choose client_indexes: [ 0  2 16 17 19], accoring to random
choose mask diff: [1725114.0, 1472784.0, 1726256.0, 1728950.0, 1726042.0]
Doing local aggregation!
test acc on this client before 395 / 502 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.405508
Client Index = 2	Epoch: 1	Loss: 0.300245
Client Index = 2	Epoch: 2	Loss: 0.214135
Client Index = 2	Epoch: 3	Loss: 0.209037
Client Index = 2	Epoch: 4	Loss: 0.212212
test acc on this client after 430 / 502 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 3
local mask changes: 1472466.0 / 11173962
choose client_indexes: [ 3  8 11 13 17], accoring to random
choose mask diff: [1472466.0, 1735858.0, 1727470.0, 1740092.0, 1727186.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.627177
Client Index = 3	Epoch: 1	Loss: 0.496592
Client Index = 3	Epoch: 2	Loss: 0.511034
Client Index = 3	Epoch: 3	Loss: 0.513044
Client Index = 3	Epoch: 4	Loss: 0.551243
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 4
local mask changes: 1472616.0 / 11173962
choose client_indexes: [ 2  4 12 16 17], accoring to random
choose mask diff: [1727606.0, 1472616.0, 1731888.0, 1732386.0, 1726526.0]
Doing local aggregation!
test acc on this client before 352 / 503 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.519717
Client Index = 4	Epoch: 1	Loss: 0.299251
Client Index = 4	Epoch: 2	Loss: 0.327657
Client Index = 4	Epoch: 3	Loss: 0.286624
Client Index = 4	Epoch: 4	Loss: 0.217315
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 5
local mask changes: 1472698.0 / 11173962
choose client_indexes: [ 0  1  5  7 18], accoring to random
choose mask diff: [1737460.0, 1730962.0, 1472698.0, 1726156.0, 1724874.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.414834
Client Index = 5	Epoch: 1	Loss: 0.410792
Client Index = 5	Epoch: 2	Loss: 0.347074
Client Index = 5	Epoch: 3	Loss: 0.307407
Client Index = 5	Epoch: 4	Loss: 0.348286
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 6
local mask changes: 1472396.0 / 11173962
choose client_indexes: [ 4  6 14 16 19], accoring to random
choose mask diff: [1725552.0, 1472396.0, 1743334.0, 1738848.0, 1744970.0]
Doing local aggregation!
test acc on this client before 377 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.634186
Client Index = 6	Epoch: 1	Loss: 0.573268
Client Index = 6	Epoch: 2	Loss: 0.577340
Client Index = 6	Epoch: 3	Loss: 0.585911
Client Index = 6	Epoch: 4	Loss: 0.480155
test acc on this client after 279 / 505 : 0.55
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 7
local mask changes: 1473080.0 / 11173962
choose client_indexes: [ 0  1  4  7 14], accoring to random
choose mask diff: [1738386.0, 1729766.0, 1730846.0, 1473080.0, 1736694.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 7	Epoch: 0	Loss: 0.498784
Client Index = 7	Epoch: 1	Loss: 0.428066
Client Index = 7	Epoch: 2	Loss: 0.371603
Client Index = 7	Epoch: 3	Loss: 0.345137
Client Index = 7	Epoch: 4	Loss: 0.388408
test acc on this client after 375 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 8
local mask changes: 1472060.0 / 11173962
choose client_indexes: [ 8  9 15 16 19], accoring to random
choose mask diff: [1472060.0, 1737354.0, 1733032.0, 1734550.0, 1740816.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 8	Epoch: 0	Loss: 0.675962
Client Index = 8	Epoch: 1	Loss: 0.554801
Client Index = 8	Epoch: 2	Loss: 0.436311
Client Index = 8	Epoch: 3	Loss: 0.389540
Client Index = 8	Epoch: 4	Loss: 0.489307
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 9
local mask changes: 1472456.0 / 11173962
choose client_indexes: [ 0  6  9 17 18], accoring to random
choose mask diff: [1735566.0, 1735212.0, 1472456.0, 1718322.0, 1725432.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.488010
Client Index = 9	Epoch: 1	Loss: 0.425865
Client Index = 9	Epoch: 2	Loss: 0.294155
Client Index = 9	Epoch: 3	Loss: 0.331751
Client Index = 9	Epoch: 4	Loss: 0.258408
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 10
local mask changes: 1472502.0 / 11173962
choose client_indexes: [ 0  3 10 12 19], accoring to random
choose mask diff: [1743628.0, 1743028.0, 1472502.0, 1734746.0, 1738650.0]
Doing local aggregation!
test acc on this client before 405 / 503 : 0.81
Client Index = 10	Epoch: 0	Loss: 0.560012
Client Index = 10	Epoch: 1	Loss: 0.376863
Client Index = 10	Epoch: 2	Loss: 0.439811
Client Index = 10	Epoch: 3	Loss: 0.439541
Client Index = 10	Epoch: 4	Loss: 0.299928
test acc on this client after 359 / 503 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 11
local mask changes: 1473814.0 / 11173962
choose client_indexes: [ 0  4  7  9 11], accoring to random
choose mask diff: [1734190.0, 1730908.0, 1726886.0, 1731156.0, 1473814.0]
Doing local aggregation!
test acc on this client before 451 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.397251
Client Index = 11	Epoch: 1	Loss: 0.238363
Client Index = 11	Epoch: 2	Loss: 0.240807
Client Index = 11	Epoch: 3	Loss: 0.203819
Client Index = 11	Epoch: 4	Loss: 0.229529
test acc on this client after 454 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 12
local mask changes: 1472594.0 / 11173962
choose client_indexes: [10 12 17 18 19], accoring to random
choose mask diff: [1734212.0, 1472594.0, 1729872.0, 1732614.0, 1734522.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.445303
Client Index = 12	Epoch: 1	Loss: 0.427942
Client Index = 12	Epoch: 2	Loss: 0.660078
Client Index = 12	Epoch: 3	Loss: 0.355388
Client Index = 12	Epoch: 4	Loss: 0.323940
test acc on this client after 390 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 13
local mask changes: 1473072.0 / 11173962
choose client_indexes: [ 0 12 13 14 19], accoring to random
choose mask diff: [1749628.0, 1738176.0, 1473072.0, 1738146.0, 1742870.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.508392
Client Index = 13	Epoch: 1	Loss: 0.452460
Client Index = 13	Epoch: 2	Loss: 0.403954
Client Index = 13	Epoch: 3	Loss: 0.360642
Client Index = 13	Epoch: 4	Loss: 0.443003
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 14
local mask changes: 1472562.0 / 11173962
choose client_indexes: [ 0  1  2 14 19], accoring to random
choose mask diff: [1744422.0, 1730098.0, 1732598.0, 1472562.0, 1742366.0]
Doing local aggregation!
test acc on this client before 383 / 502 : 0.76
Client Index = 14	Epoch: 0	Loss: 0.580172
Client Index = 14	Epoch: 1	Loss: 0.488214
Client Index = 14	Epoch: 2	Loss: 0.483658
Client Index = 14	Epoch: 3	Loss: 0.467145
Client Index = 14	Epoch: 4	Loss: 0.438965
test acc on this client after 389 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 15
local mask changes: 1473316.0 / 11173962
choose client_indexes: [ 0  2  8 14 15], accoring to random
choose mask diff: [1739394.0, 1729872.0, 1732652.0, 1736554.0, 1473316.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 15	Epoch: 0	Loss: 0.396655
Client Index = 15	Epoch: 1	Loss: 0.302000
Client Index = 15	Epoch: 2	Loss: 0.390484
Client Index = 15	Epoch: 3	Loss: 0.279364
Client Index = 15	Epoch: 4	Loss: 0.324389
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 16
local mask changes: 1472558.0 / 11173962
choose client_indexes: [13 15 16 17 19], accoring to random
choose mask diff: [1735848.0, 1728368.0, 1472558.0, 1730128.0, 1737328.0]
Doing local aggregation!
test acc on this client before 374 / 503 : 0.74
Client Index = 16	Epoch: 0	Loss: 0.463206
Client Index = 16	Epoch: 1	Loss: 0.353030
Client Index = 16	Epoch: 2	Loss: 0.347136
Client Index = 16	Epoch: 3	Loss: 0.264138
Client Index = 16	Epoch: 4	Loss: 0.299507
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 17
local mask changes: 1473020.0 / 11173962
choose client_indexes: [ 6  8 10 15 17], accoring to random
choose mask diff: [1732074.0, 1733030.0, 1728324.0, 1726966.0, 1473020.0]
Doing local aggregation!
test acc on this client before 333 / 505 : 0.66
Client Index = 17	Epoch: 0	Loss: 0.532865
Client Index = 17	Epoch: 1	Loss: 0.312013
Client Index = 17	Epoch: 2	Loss: 0.336817
Client Index = 17	Epoch: 3	Loss: 0.244936
Client Index = 17	Epoch: 4	Loss: 0.310238
test acc on this client after 423 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 18
local mask changes: 1472700.0 / 11173962
choose client_indexes: [11 12 13 16 18], accoring to random
choose mask diff: [1727344.0, 1730924.0, 1733810.0, 1713912.0, 1472700.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 18	Epoch: 0	Loss: 0.417035
Client Index = 18	Epoch: 1	Loss: 0.331941
Client Index = 18	Epoch: 2	Loss: 0.304247
Client Index = 18	Epoch: 3	Loss: 0.257181
Client Index = 18	Epoch: 4	Loss: 0.254687
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(57) with spasity 0.5: 19
local mask changes: 1472686.0 / 11173962
choose client_indexes: [ 7 10 16 18 19], accoring to random
choose mask diff: [1738554.0, 1736998.0, 1736040.0, 1731436.0, 1472686.0]
Doing local aggregation!
test acc on this client before 371 / 506 : 0.73
Client Index = 19	Epoch: 0	Loss: 0.466234
Client Index = 19	Epoch: 1	Loss: 0.341976
Client Index = 19	Epoch: 2	Loss: 0.348653
Client Index = 19	Epoch: 3	Loss: 0.313241
Client Index = 19	Epoch: 4	Loss: 0.321681
test acc on this client after 374 / 506 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 57
{'test_acc': 0.7801929450930993, 'test_loss': 0.6869615039500866}
################local_test_on_all_clients before local training in communication round: 57
{'test_acc': 0.7683591527604745, 'test_loss': 0.680079453966454}
################Communication round : 58
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 0
local mask changes: 1425842.0 / 11173962
choose client_indexes: [ 0  5  9 12 18], accoring to random
choose mask diff: [1425842.0, 1702426.0, 1700104.0, 1702748.0, 1693082.0]
Doing local aggregation!
test acc on this client before 360 / 504 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.670808
Client Index = 0	Epoch: 1	Loss: 0.566665
Client Index = 0	Epoch: 2	Loss: 0.489799
Client Index = 0	Epoch: 3	Loss: 0.531010
Client Index = 0	Epoch: 4	Loss: 0.464322
test acc on this client after 322 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 1
local mask changes: 1425820.0 / 11173962
choose client_indexes: [ 1  2  8 10 11], accoring to random
choose mask diff: [1425820.0, 1689506.0, 1699936.0, 1700088.0, 1689824.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.336485
Client Index = 1	Epoch: 1	Loss: 0.474506
Client Index = 1	Epoch: 2	Loss: 0.291361
Client Index = 1	Epoch: 3	Loss: 0.216209
Client Index = 1	Epoch: 4	Loss: 0.197421
test acc on this client after 435 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 2
local mask changes: 1425840.0 / 11173962
choose client_indexes: [ 2  3 11 16 19], accoring to random
choose mask diff: [1425840.0, 1693622.0, 1690564.0, 1685256.0, 1684896.0]
Doing local aggregation!
test acc on this client before 395 / 502 : 0.79
Client Index = 2	Epoch: 0	Loss: 0.368464
Client Index = 2	Epoch: 1	Loss: 0.248959
Client Index = 2	Epoch: 2	Loss: 0.232193
Client Index = 2	Epoch: 3	Loss: 0.219920
Client Index = 2	Epoch: 4	Loss: 0.181652
test acc on this client after 440 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 3
local mask changes: 1426000.0 / 11173962
choose client_indexes: [ 3  5  6 12 17], accoring to random
choose mask diff: [1426000.0, 1700968.0, 1702500.0, 1695786.0, 1686648.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.634160
Client Index = 3	Epoch: 1	Loss: 0.550933
Client Index = 3	Epoch: 2	Loss: 0.507022
Client Index = 3	Epoch: 3	Loss: 0.426192
Client Index = 3	Epoch: 4	Loss: 0.487041
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 4
local mask changes: 1425352.0 / 11173962
choose client_indexes: [ 3  4  6 10 16], accoring to random
choose mask diff: [1699802.0, 1425352.0, 1694078.0, 1698606.0, 1685194.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.377340
Client Index = 4	Epoch: 1	Loss: 0.335427
Client Index = 4	Epoch: 2	Loss: 0.338264
Client Index = 4	Epoch: 3	Loss: 0.280764
Client Index = 4	Epoch: 4	Loss: 0.285618
test acc on this client after 421 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 5
local mask changes: 1427114.0 / 11173962
choose client_indexes: [ 0  5 11 15 18], accoring to random
choose mask diff: [1694236.0, 1427114.0, 1694190.0, 1696810.0, 1682300.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 5	Epoch: 0	Loss: 0.447608
Client Index = 5	Epoch: 1	Loss: 0.377952
Client Index = 5	Epoch: 2	Loss: 0.321993
Client Index = 5	Epoch: 3	Loss: 0.361088
Client Index = 5	Epoch: 4	Loss: 0.271114
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 6
local mask changes: 1426158.0 / 11173962
choose client_indexes: [ 4  6  7 13 17], accoring to random
choose mask diff: [1687792.0, 1426158.0, 1694570.0, 1695700.0, 1697314.0]
Doing local aggregation!
test acc on this client before 369 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.682481
Client Index = 6	Epoch: 1	Loss: 0.562486
Client Index = 6	Epoch: 2	Loss: 0.526932
Client Index = 6	Epoch: 3	Loss: 0.516959
Client Index = 6	Epoch: 4	Loss: 0.500955
test acc on this client after 386 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 7
local mask changes: 1426544.0 / 11173962
choose client_indexes: [ 0  1  7 14 15], accoring to random
choose mask diff: [1690500.0, 1689450.0, 1426544.0, 1693108.0, 1689526.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 7	Epoch: 0	Loss: 0.457105
Client Index = 7	Epoch: 1	Loss: 0.374982
Client Index = 7	Epoch: 2	Loss: 0.403905
Client Index = 7	Epoch: 3	Loss: 0.350989
Client Index = 7	Epoch: 4	Loss: 0.385812
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 8
local mask changes: 1426132.0 / 11173962
choose client_indexes: [ 7  8  9 10 12], accoring to random
choose mask diff: [1691132.0, 1426132.0, 1693256.0, 1695120.0, 1693846.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.738089
Client Index = 8	Epoch: 1	Loss: 0.477395
Client Index = 8	Epoch: 2	Loss: 0.408875
Client Index = 8	Epoch: 3	Loss: 0.406745
Client Index = 8	Epoch: 4	Loss: 0.426661
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 9
local mask changes: 1426220.0 / 11173962
choose client_indexes: [ 4  9 14 17 19], accoring to random
choose mask diff: [1687922.0, 1426220.0, 1689654.0, 1673684.0, 1695994.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 9	Epoch: 0	Loss: 0.445187
Client Index = 9	Epoch: 1	Loss: 0.308070
Client Index = 9	Epoch: 2	Loss: 0.313974
Client Index = 9	Epoch: 3	Loss: 0.319417
Client Index = 9	Epoch: 4	Loss: 0.234031
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 10
local mask changes: 1426734.0 / 11173962
choose client_indexes: [ 4  5  7 10 13], accoring to random
choose mask diff: [1701962.0, 1700636.0, 1693316.0, 1426734.0, 1703806.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 10	Epoch: 0	Loss: 0.434566
Client Index = 10	Epoch: 1	Loss: 0.437208
Client Index = 10	Epoch: 2	Loss: 0.455653
Client Index = 10	Epoch: 3	Loss: 0.346543
Client Index = 10	Epoch: 4	Loss: 0.352331
test acc on this client after 333 / 503 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 11
local mask changes: 1425884.0 / 11173962
choose client_indexes: [ 1  2  8 11 13], accoring to random
choose mask diff: [1689960.0, 1687452.0, 1692994.0, 1425884.0, 1696316.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.459022
Client Index = 11	Epoch: 1	Loss: 0.239091
Client Index = 11	Epoch: 2	Loss: 0.220277
Client Index = 11	Epoch: 3	Loss: 0.272570
Client Index = 11	Epoch: 4	Loss: 0.197524
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 12
local mask changes: 1425184.0 / 11173962
choose client_indexes: [ 1  3 10 12 14], accoring to random
choose mask diff: [1694454.0, 1693714.0, 1694078.0, 1425184.0, 1702800.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 12	Epoch: 0	Loss: 0.473590
Client Index = 12	Epoch: 1	Loss: 0.426181
Client Index = 12	Epoch: 2	Loss: 0.339983
Client Index = 12	Epoch: 3	Loss: 0.316615
Client Index = 12	Epoch: 4	Loss: 0.334510
test acc on this client after 304 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 13
local mask changes: 1426596.0 / 11173962
choose client_indexes: [ 0  7 10 13 19], accoring to random
choose mask diff: [1703896.0, 1697374.0, 1703868.0, 1426596.0, 1699800.0]
Doing local aggregation!
test acc on this client before 392 / 503 : 0.78
Client Index = 13	Epoch: 0	Loss: 0.439766
Client Index = 13	Epoch: 1	Loss: 0.479165
Client Index = 13	Epoch: 2	Loss: 0.384313
Client Index = 13	Epoch: 3	Loss: 0.412731
Client Index = 13	Epoch: 4	Loss: 0.357851
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 14
local mask changes: 1426170.0 / 11173962
choose client_indexes: [ 4  6 13 14 18], accoring to random
choose mask diff: [1697722.0, 1702384.0, 1700972.0, 1426170.0, 1692338.0]
Doing local aggregation!
test acc on this client before 399 / 502 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.536937
Client Index = 14	Epoch: 1	Loss: 0.445556
Client Index = 14	Epoch: 2	Loss: 0.491366
Client Index = 14	Epoch: 3	Loss: 0.447968
Client Index = 14	Epoch: 4	Loss: 0.437028
test acc on this client after 327 / 502 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 15
local mask changes: 1426680.0 / 11173962
choose client_indexes: [ 7  9 15 17 19], accoring to random
choose mask diff: [1687722.0, 1685016.0, 1426680.0, 1688898.0, 1694044.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.383904
Client Index = 15	Epoch: 1	Loss: 0.311754
Client Index = 15	Epoch: 2	Loss: 0.408108
Client Index = 15	Epoch: 3	Loss: 0.276126
Client Index = 15	Epoch: 4	Loss: 0.268700
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 16
local mask changes: 1426924.0 / 11173962
choose client_indexes: [ 0  8 10 16 18], accoring to random
choose mask diff: [1704228.0, 1697408.0, 1701200.0, 1426924.0, 1680682.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.538344
Client Index = 16	Epoch: 1	Loss: 0.315012
Client Index = 16	Epoch: 2	Loss: 0.294792
Client Index = 16	Epoch: 3	Loss: 0.261215
Client Index = 16	Epoch: 4	Loss: 0.303910
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 17
local mask changes: 1425922.0 / 11173962
choose client_indexes: [ 2 10 13 17 19], accoring to random
choose mask diff: [1687832.0, 1683542.0, 1696240.0, 1425922.0, 1689430.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.499342
Client Index = 17	Epoch: 1	Loss: 0.344398
Client Index = 17	Epoch: 2	Loss: 0.233033
Client Index = 17	Epoch: 3	Loss: 0.311882
Client Index = 17	Epoch: 4	Loss: 0.241047
test acc on this client after 437 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 18
local mask changes: 1425842.0 / 11173962
choose client_indexes: [ 2  4 15 17 18], accoring to random
choose mask diff: [1691150.0, 1691926.0, 1692976.0, 1686932.0, 1425842.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 18	Epoch: 0	Loss: 0.417083
Client Index = 18	Epoch: 1	Loss: 0.324102
Client Index = 18	Epoch: 2	Loss: 0.280043
Client Index = 18	Epoch: 3	Loss: 0.262754
Client Index = 18	Epoch: 4	Loss: 0.250457
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(58) with spasity 0.5: 19
local mask changes: 1426466.0 / 11173962
choose client_indexes: [ 2  3 12 18 19], accoring to random
choose mask diff: [1690606.0, 1686244.0, 1698486.0, 1688948.0, 1426466.0]
Doing local aggregation!
test acc on this client before 384 / 506 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.375333
Client Index = 19	Epoch: 1	Loss: 0.382346
Client Index = 19	Epoch: 2	Loss: 0.265651
Client Index = 19	Epoch: 3	Loss: 0.375972
Client Index = 19	Epoch: 4	Loss: 0.222611
test acc on this client after 400 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 58
{'test_acc': 0.7802354638569056, 'test_loss': 0.6932859199460346}
################local_test_on_all_clients before local training in communication round: 58
{'test_acc': 0.7827520485044629, 'test_loss': 0.6432322190840423}
################Communication round : 59
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 0
local mask changes: 1380246.0 / 11173962
choose client_indexes: [ 0  2  8 15 18], accoring to random
choose mask diff: [1380246.0, 1653200.0, 1665310.0, 1658746.0, 1651568.0]
Doing local aggregation!
test acc on this client before 351 / 504 : 0.70
Client Index = 0	Epoch: 0	Loss: 0.598009
Client Index = 0	Epoch: 1	Loss: 0.618236
Client Index = 0	Epoch: 2	Loss: 0.505146
Client Index = 0	Epoch: 3	Loss: 0.523514
Client Index = 0	Epoch: 4	Loss: 0.520378
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 1
local mask changes: 1379542.0 / 11173962
choose client_indexes: [ 1 10 14 16 17], accoring to random
choose mask diff: [1379542.0, 1654802.0, 1652802.0, 1654506.0, 1653518.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.357297
Client Index = 1	Epoch: 1	Loss: 0.282825
Client Index = 1	Epoch: 2	Loss: 0.239611
Client Index = 1	Epoch: 3	Loss: 0.226136
Client Index = 1	Epoch: 4	Loss: 0.218331
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 2
local mask changes: 1378912.0 / 11173962
choose client_indexes: [ 2  3 13 16 17], accoring to random
choose mask diff: [1378912.0, 1652892.0, 1661096.0, 1642434.0, 1648500.0]
Doing local aggregation!
test acc on this client before 433 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.567307
Client Index = 2	Epoch: 1	Loss: 0.216778
Client Index = 2	Epoch: 2	Loss: 0.273725
Client Index = 2	Epoch: 3	Loss: 0.180735
Client Index = 2	Epoch: 4	Loss: 0.158872
test acc on this client after 437 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 3
local mask changes: 1378704.0 / 11173962
choose client_indexes: [ 1  3  5  9 14], accoring to random
choose mask diff: [1655298.0, 1378704.0, 1658946.0, 1662164.0, 1661482.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.655604
Client Index = 3	Epoch: 1	Loss: 0.544360
Client Index = 3	Epoch: 2	Loss: 0.474581
Client Index = 3	Epoch: 3	Loss: 0.469064
Client Index = 3	Epoch: 4	Loss: 0.405708
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 4
local mask changes: 1380766.0 / 11173962
choose client_indexes: [ 2  4 12 13 14], accoring to random
choose mask diff: [1646814.0, 1380766.0, 1656024.0, 1663964.0, 1663094.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.450834
Client Index = 4	Epoch: 1	Loss: 0.315308
Client Index = 4	Epoch: 2	Loss: 0.266326
Client Index = 4	Epoch: 3	Loss: 0.259818
Client Index = 4	Epoch: 4	Loss: 0.325248
test acc on this client after 387 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 5
local mask changes: 1380366.0 / 11173962
choose client_indexes: [ 3  4  5  9 17], accoring to random
choose mask diff: [1665152.0, 1652510.0, 1380366.0, 1651728.0, 1655924.0]
Doing local aggregation!
test acc on this client before 370 / 504 : 0.73
Client Index = 5	Epoch: 0	Loss: 0.467887
Client Index = 5	Epoch: 1	Loss: 0.393671
Client Index = 5	Epoch: 2	Loss: 0.367392
Client Index = 5	Epoch: 3	Loss: 0.346934
Client Index = 5	Epoch: 4	Loss: 0.311400
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 6
local mask changes: 1379580.0 / 11173962
choose client_indexes: [ 5  6 14 18 19], accoring to random
choose mask diff: [1660428.0, 1379580.0, 1661800.0, 1664142.0, 1665252.0]
Doing local aggregation!
test acc on this client before 377 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.686190
Client Index = 6	Epoch: 1	Loss: 0.526271
Client Index = 6	Epoch: 2	Loss: 0.515960
Client Index = 6	Epoch: 3	Loss: 0.458815
Client Index = 6	Epoch: 4	Loss: 0.545296
test acc on this client after 365 / 505 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 7
local mask changes: 1379970.0 / 11173962
choose client_indexes: [ 3  4  7  8 15], accoring to random
choose mask diff: [1667054.0, 1656798.0, 1379970.0, 1655484.0, 1646492.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 7	Epoch: 0	Loss: 0.457675
Client Index = 7	Epoch: 1	Loss: 0.380925
Client Index = 7	Epoch: 2	Loss: 0.434364
Client Index = 7	Epoch: 3	Loss: 0.295391
Client Index = 7	Epoch: 4	Loss: 0.386380
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 8
local mask changes: 1379654.0 / 11173962
choose client_indexes: [ 5  6  8 11 17], accoring to random
choose mask diff: [1657122.0, 1659620.0, 1379654.0, 1658772.0, 1653112.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.560927
Client Index = 8	Epoch: 1	Loss: 0.463193
Client Index = 8	Epoch: 2	Loss: 0.484323
Client Index = 8	Epoch: 3	Loss: 0.358238
Client Index = 8	Epoch: 4	Loss: 0.399525
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 9
local mask changes: 1379062.0 / 11173962
choose client_indexes: [ 7  9 10 14 19], accoring to random
choose mask diff: [1655742.0, 1379062.0, 1655292.0, 1646254.0, 1653104.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 9	Epoch: 0	Loss: 0.404377
Client Index = 9	Epoch: 1	Loss: 0.312195
Client Index = 9	Epoch: 2	Loss: 0.321937
Client Index = 9	Epoch: 3	Loss: 0.244052
Client Index = 9	Epoch: 4	Loss: 0.266840
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 10
local mask changes: 1378342.0 / 11173962
choose client_indexes: [ 7  8 10 12 13], accoring to random
choose mask diff: [1653100.0, 1661234.0, 1378342.0, 1654448.0, 1661886.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 10	Epoch: 0	Loss: 0.485316
Client Index = 10	Epoch: 1	Loss: 0.439671
Client Index = 10	Epoch: 2	Loss: 0.359607
Client Index = 10	Epoch: 3	Loss: 0.322982
Client Index = 10	Epoch: 4	Loss: 0.367100
test acc on this client after 350 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 11
local mask changes: 1379516.0 / 11173962
choose client_indexes: [ 0  6 11 16 19], accoring to random
choose mask diff: [1657140.0, 1660008.0, 1379516.0, 1654230.0, 1655392.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.333831
Client Index = 11	Epoch: 1	Loss: 0.245217
Client Index = 11	Epoch: 2	Loss: 0.244671
Client Index = 11	Epoch: 3	Loss: 0.203242
Client Index = 11	Epoch: 4	Loss: 0.285606
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 12
local mask changes: 1379130.0 / 11173962
choose client_indexes: [ 1  6  7 12 13], accoring to random
choose mask diff: [1652576.0, 1673298.0, 1659100.0, 1379130.0, 1662334.0]
Doing local aggregation!
test acc on this client before 356 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.489214
Client Index = 12	Epoch: 1	Loss: 0.387113
Client Index = 12	Epoch: 2	Loss: 0.383927
Client Index = 12	Epoch: 3	Loss: 0.349286
Client Index = 12	Epoch: 4	Loss: 0.361273
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 13
local mask changes: 1379500.0 / 11173962
choose client_indexes: [ 4  6 10 13 16], accoring to random
choose mask diff: [1664064.0, 1660888.0, 1659740.0, 1379500.0, 1659038.0]
Doing local aggregation!
test acc on this client before 383 / 503 : 0.76
Client Index = 13	Epoch: 0	Loss: 0.472844
Client Index = 13	Epoch: 1	Loss: 0.412862
Client Index = 13	Epoch: 2	Loss: 0.358076
Client Index = 13	Epoch: 3	Loss: 0.359098
Client Index = 13	Epoch: 4	Loss: 0.413881
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 14
local mask changes: 1378990.0 / 11173962
choose client_indexes: [ 3  4 11 14 18], accoring to random
choose mask diff: [1663398.0, 1656982.0, 1658294.0, 1378990.0, 1652088.0]
Doing local aggregation!
test acc on this client before 410 / 502 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.480529
Client Index = 14	Epoch: 1	Loss: 0.462419
Client Index = 14	Epoch: 2	Loss: 0.447965
Client Index = 14	Epoch: 3	Loss: 0.455039
Client Index = 14	Epoch: 4	Loss: 0.438956
test acc on this client after 402 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 15
local mask changes: 1380344.0 / 11173962
choose client_indexes: [ 8  9 11 15 17], accoring to random
choose mask diff: [1649950.0, 1643814.0, 1659020.0, 1380344.0, 1643178.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.370484
Client Index = 15	Epoch: 1	Loss: 0.551946
Client Index = 15	Epoch: 2	Loss: 0.289512
Client Index = 15	Epoch: 3	Loss: 0.265590
Client Index = 15	Epoch: 4	Loss: 0.256652
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 16
local mask changes: 1379380.0 / 11173962
choose client_indexes: [ 4  6  7 10 16], accoring to random
choose mask diff: [1651696.0, 1658544.0, 1661588.0, 1658846.0, 1379380.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.531037
Client Index = 16	Epoch: 1	Loss: 0.313799
Client Index = 16	Epoch: 2	Loss: 0.303053
Client Index = 16	Epoch: 3	Loss: 0.247433
Client Index = 16	Epoch: 4	Loss: 0.260576
test acc on this client after 421 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 17
local mask changes: 1379880.0 / 11173962
choose client_indexes: [ 7 11 16 17 18], accoring to random
choose mask diff: [1658424.0, 1659484.0, 1650746.0, 1379880.0, 1652024.0]
Doing local aggregation!
test acc on this client before 354 / 505 : 0.70
Client Index = 17	Epoch: 0	Loss: 0.519945
Client Index = 17	Epoch: 1	Loss: 0.344905
Client Index = 17	Epoch: 2	Loss: 0.303336
Client Index = 17	Epoch: 3	Loss: 0.269797
Client Index = 17	Epoch: 4	Loss: 0.232713
test acc on this client after 431 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 18
local mask changes: 1379232.0 / 11173962
choose client_indexes: [ 0 16 17 18 19], accoring to random
choose mask diff: [1654072.0, 1639718.0, 1644808.0, 1379232.0, 1652698.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 18	Epoch: 0	Loss: 0.540739
Client Index = 18	Epoch: 1	Loss: 0.317777
Client Index = 18	Epoch: 2	Loss: 0.327962
Client Index = 18	Epoch: 3	Loss: 0.283311
Client Index = 18	Epoch: 4	Loss: 0.230583
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(59) with spasity 0.5: 19
local mask changes: 1379648.0 / 11173962
choose client_indexes: [ 0 13 14 17 19], accoring to random
choose mask diff: [1663782.0, 1663908.0, 1665070.0, 1651976.0, 1379648.0]
Doing local aggregation!
test acc on this client before 402 / 506 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.407887
Client Index = 19	Epoch: 1	Loss: 0.335137
Client Index = 19	Epoch: 2	Loss: 0.293137
Client Index = 19	Epoch: 3	Loss: 0.274514
Client Index = 19	Epoch: 4	Loss: 0.239050
test acc on this client after 404 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 59
{'test_acc': 0.7907809661117745, 'test_loss': 0.6534730882806354}
################local_test_on_all_clients before local training in communication round: 59
{'test_acc': 0.7869451979420423, 'test_loss': 0.6504042065601836}
################Communication round : 60
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 0
local mask changes: 1332142.0 / 11173962
choose client_indexes: [ 0  3  4 15 18], accoring to random
choose mask diff: [1332142.0, 1630698.0, 1625536.0, 1616556.0, 1611856.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.573692
Client Index = 0	Epoch: 1	Loss: 0.658907
Client Index = 0	Epoch: 2	Loss: 0.525424
Client Index = 0	Epoch: 3	Loss: 0.499250
Client Index = 0	Epoch: 4	Loss: 0.466711
test acc on this client after 323 / 504 : 0.64
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 1
local mask changes: 1332766.0 / 11173962
choose client_indexes: [ 1  6 15 18 19], accoring to random
choose mask diff: [1332766.0, 1627242.0, 1622616.0, 1615204.0, 1616974.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 1	Epoch: 0	Loss: 0.354402
Client Index = 1	Epoch: 1	Loss: 0.258506
Client Index = 1	Epoch: 2	Loss: 0.352464
Client Index = 1	Epoch: 3	Loss: 0.210454
Client Index = 1	Epoch: 4	Loss: 0.215216
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 2
local mask changes: 1332298.0 / 11173962
choose client_indexes: [ 2  3  8 12 13], accoring to random
choose mask diff: [1332298.0, 1611396.0, 1622720.0, 1616052.0, 1616468.0]
Doing local aggregation!
test acc on this client before 420 / 502 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.365142
Client Index = 2	Epoch: 1	Loss: 0.236629
Client Index = 2	Epoch: 2	Loss: 0.202283
Client Index = 2	Epoch: 3	Loss: 0.215494
Client Index = 2	Epoch: 4	Loss: 0.162693
test acc on this client after 403 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 3
local mask changes: 1331716.0 / 11173962
choose client_indexes: [ 3  5  7 17 19], accoring to random
choose mask diff: [1331716.0, 1619270.0, 1629268.0, 1612152.0, 1612508.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 3	Epoch: 0	Loss: 0.611076
Client Index = 3	Epoch: 1	Loss: 0.545784
Client Index = 3	Epoch: 2	Loss: 0.423052
Client Index = 3	Epoch: 3	Loss: 0.481801
Client Index = 3	Epoch: 4	Loss: 0.413576
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 4
local mask changes: 1332402.0 / 11173962
choose client_indexes: [ 2  4 11 13 16], accoring to random
choose mask diff: [1606312.0, 1332402.0, 1619570.0, 1619792.0, 1613818.0]
Doing local aggregation!
test acc on this client before 371 / 503 : 0.74
Client Index = 4	Epoch: 0	Loss: 0.498212
Client Index = 4	Epoch: 1	Loss: 0.292175
Client Index = 4	Epoch: 2	Loss: 0.296037
Client Index = 4	Epoch: 3	Loss: 0.266910
Client Index = 4	Epoch: 4	Loss: 0.330588
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 5
local mask changes: 1332716.0 / 11173962
choose client_indexes: [ 4  5 12 13 18], accoring to random
choose mask diff: [1611278.0, 1332716.0, 1622278.0, 1625216.0, 1608802.0]
Doing local aggregation!
test acc on this client before 378 / 504 : 0.75
Client Index = 5	Epoch: 0	Loss: 0.503440
Client Index = 5	Epoch: 1	Loss: 0.433749
Client Index = 5	Epoch: 2	Loss: 0.347788
Client Index = 5	Epoch: 3	Loss: 0.338907
Client Index = 5	Epoch: 4	Loss: 0.291286
test acc on this client after 394 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 6
local mask changes: 1332200.0 / 11173962
choose client_indexes: [ 0  6  7 14 16], accoring to random
choose mask diff: [1631164.0, 1332200.0, 1619562.0, 1616044.0, 1624486.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.556430
Client Index = 6	Epoch: 1	Loss: 0.499026
Client Index = 6	Epoch: 2	Loss: 0.501425
Client Index = 6	Epoch: 3	Loss: 0.651515
Client Index = 6	Epoch: 4	Loss: 0.480509
test acc on this client after 360 / 505 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 7
local mask changes: 1333622.0 / 11173962
choose client_indexes: [ 0  3  7  8 19], accoring to random
choose mask diff: [1619048.0, 1623104.0, 1333622.0, 1610034.0, 1625848.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 7	Epoch: 0	Loss: 0.516828
Client Index = 7	Epoch: 1	Loss: 0.328405
Client Index = 7	Epoch: 2	Loss: 0.355440
Client Index = 7	Epoch: 3	Loss: 0.540941
Client Index = 7	Epoch: 4	Loss: 0.320978
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 8
local mask changes: 1332574.0 / 11173962
choose client_indexes: [ 3  5  8 11 16], accoring to random
choose mask diff: [1623836.0, 1613594.0, 1332574.0, 1614222.0, 1619576.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.640745
Client Index = 8	Epoch: 1	Loss: 0.393853
Client Index = 8	Epoch: 2	Loss: 0.443705
Client Index = 8	Epoch: 3	Loss: 0.358648
Client Index = 8	Epoch: 4	Loss: 0.434382
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 9
local mask changes: 1332818.0 / 11173962
choose client_indexes: [ 2  3  9 13 18], accoring to random
choose mask diff: [1615210.0, 1624048.0, 1332818.0, 1621420.0, 1610842.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 9	Epoch: 0	Loss: 0.400539
Client Index = 9	Epoch: 1	Loss: 0.356796
Client Index = 9	Epoch: 2	Loss: 0.311423
Client Index = 9	Epoch: 3	Loss: 0.307847
Client Index = 9	Epoch: 4	Loss: 0.206472
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 10
local mask changes: 1332628.0 / 11173962
choose client_indexes: [ 2  7 10 15 18], accoring to random
choose mask diff: [1621634.0, 1615382.0, 1332628.0, 1623322.0, 1622302.0]
Doing local aggregation!
test acc on this client before 399 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.494185
Client Index = 10	Epoch: 1	Loss: 0.400677
Client Index = 10	Epoch: 2	Loss: 0.421905
Client Index = 10	Epoch: 3	Loss: 0.353431
Client Index = 10	Epoch: 4	Loss: 0.393251
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 11
local mask changes: 1333544.0 / 11173962
choose client_indexes: [ 2  5 11 12 18], accoring to random
choose mask diff: [1604930.0, 1616212.0, 1333544.0, 1624222.0, 1609766.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.325336
Client Index = 11	Epoch: 1	Loss: 0.353800
Client Index = 11	Epoch: 2	Loss: 0.205643
Client Index = 11	Epoch: 3	Loss: 0.186618
Client Index = 11	Epoch: 4	Loss: 0.380925
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 12
local mask changes: 1332190.0 / 11173962
choose client_indexes: [ 1  4  6  7 12], accoring to random
choose mask diff: [1612280.0, 1621620.0, 1627560.0, 1615948.0, 1332190.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 12	Epoch: 0	Loss: 0.459920
Client Index = 12	Epoch: 1	Loss: 0.481752
Client Index = 12	Epoch: 2	Loss: 0.330357
Client Index = 12	Epoch: 3	Loss: 0.344139
Client Index = 12	Epoch: 4	Loss: 0.283227
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 13
local mask changes: 1332640.0 / 11173962
choose client_indexes: [ 3  4  7 13 15], accoring to random
choose mask diff: [1628876.0, 1621556.0, 1621428.0, 1332640.0, 1626696.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.455378
Client Index = 13	Epoch: 1	Loss: 0.424583
Client Index = 13	Epoch: 2	Loss: 0.424743
Client Index = 13	Epoch: 3	Loss: 0.342611
Client Index = 13	Epoch: 4	Loss: 0.468603
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 14
local mask changes: 1332842.0 / 11173962
choose client_indexes: [ 3  8 13 14 17], accoring to random
choose mask diff: [1619082.0, 1626112.0, 1621542.0, 1332842.0, 1625790.0]
Doing local aggregation!
test acc on this client before 408 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.512839
Client Index = 14	Epoch: 1	Loss: 0.464215
Client Index = 14	Epoch: 2	Loss: 0.451148
Client Index = 14	Epoch: 3	Loss: 0.448956
Client Index = 14	Epoch: 4	Loss: 0.328017
test acc on this client after 396 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 15
local mask changes: 1332302.0 / 11173962
choose client_indexes: [ 0  1  8 10 15], accoring to random
choose mask diff: [1622690.0, 1623378.0, 1608516.0, 1622622.0, 1332302.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.372197
Client Index = 15	Epoch: 1	Loss: 0.326582
Client Index = 15	Epoch: 2	Loss: 0.286430
Client Index = 15	Epoch: 3	Loss: 0.252705
Client Index = 15	Epoch: 4	Loss: 0.305860
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 16
local mask changes: 1332836.0 / 11173962
choose client_indexes: [ 6 10 14 15 16], accoring to random
choose mask diff: [1615846.0, 1616516.0, 1619272.0, 1617702.0, 1332836.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.438072
Client Index = 16	Epoch: 1	Loss: 0.320738
Client Index = 16	Epoch: 2	Loss: 0.320898
Client Index = 16	Epoch: 3	Loss: 0.276343
Client Index = 16	Epoch: 4	Loss: 0.219326
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 17
local mask changes: 1332452.0 / 11173962
choose client_indexes: [11 12 14 16 17], accoring to random
choose mask diff: [1614328.0, 1613390.0, 1624480.0, 1609926.0, 1332452.0]
Doing local aggregation!
test acc on this client before 386 / 505 : 0.76
Client Index = 17	Epoch: 0	Loss: 0.499640
Client Index = 17	Epoch: 1	Loss: 0.353471
Client Index = 17	Epoch: 2	Loss: 0.312664
Client Index = 17	Epoch: 3	Loss: 0.274530
Client Index = 17	Epoch: 4	Loss: 0.224715
test acc on this client after 437 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 18
local mask changes: 1332522.0 / 11173962
choose client_indexes: [ 5  6  9 18 19], accoring to random
choose mask diff: [1609040.0, 1623656.0, 1610906.0, 1332522.0, 1605976.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.381860
Client Index = 18	Epoch: 1	Loss: 0.317485
Client Index = 18	Epoch: 2	Loss: 0.305895
Client Index = 18	Epoch: 3	Loss: 0.283713
Client Index = 18	Epoch: 4	Loss: 0.245867
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(60) with spasity 0.5: 19
local mask changes: 1333406.0 / 11173962
choose client_indexes: [ 0  5 16 18 19], accoring to random
choose mask diff: [1620040.0, 1625566.0, 1619728.0, 1612064.0, 1333406.0]
Doing local aggregation!
test acc on this client before 407 / 506 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.361105
Client Index = 19	Epoch: 1	Loss: 0.423390
Client Index = 19	Epoch: 2	Loss: 0.256037
Client Index = 19	Epoch: 3	Loss: 0.306543
Client Index = 19	Epoch: 4	Loss: 0.213551
test acc on this client after 405 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 60
{'test_acc': 0.7879923124100864, 'test_loss': 0.6641223507222412}
################local_test_on_all_clients before local training in communication round: 60
{'test_acc': 0.7859249672756825, 'test_loss': 0.6468827311722088}
################Communication round : 61
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 0
local mask changes: 1285838.0 / 11173962
choose client_indexes: [ 0  1  6  7 13], accoring to random
choose mask diff: [1285838.0, 1586508.0, 1594880.0, 1584984.0, 1595496.0]
Doing local aggregation!
test acc on this client before 346 / 504 : 0.69
Client Index = 0	Epoch: 0	Loss: 0.564723
Client Index = 0	Epoch: 1	Loss: 0.563607
Client Index = 0	Epoch: 2	Loss: 0.545429
Client Index = 0	Epoch: 3	Loss: 0.423032
Client Index = 0	Epoch: 4	Loss: 0.459744
test acc on this client after 352 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 1
local mask changes: 1286560.0 / 11173962
choose client_indexes: [ 1  2  8  9 19], accoring to random
choose mask diff: [1286560.0, 1573474.0, 1584140.0, 1577848.0, 1573106.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 1	Epoch: 0	Loss: 0.559765
Client Index = 1	Epoch: 1	Loss: 0.249523
Client Index = 1	Epoch: 2	Loss: 0.268440
Client Index = 1	Epoch: 3	Loss: 0.246089
Client Index = 1	Epoch: 4	Loss: 0.214645
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 2
local mask changes: 1286230.0 / 11173962
choose client_indexes: [ 2  3 11 16 17], accoring to random
choose mask diff: [1286230.0, 1570358.0, 1571540.0, 1570728.0, 1565680.0]
Doing local aggregation!
test acc on this client before 421 / 502 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.476294
Client Index = 2	Epoch: 1	Loss: 0.261715
Client Index = 2	Epoch: 2	Loss: 0.194876
Client Index = 2	Epoch: 3	Loss: 0.171141
Client Index = 2	Epoch: 4	Loss: 0.146743
test acc on this client after 444 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 3
local mask changes: 1284762.0 / 11173962
choose client_indexes: [ 3  5  7 11 19], accoring to random
choose mask diff: [1284762.0, 1572596.0, 1581886.0, 1582796.0, 1573230.0]
Doing local aggregation!
test acc on this client before 362 / 504 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.600422
Client Index = 3	Epoch: 1	Loss: 0.446767
Client Index = 3	Epoch: 2	Loss: 0.441339
Client Index = 3	Epoch: 3	Loss: 0.428331
Client Index = 3	Epoch: 4	Loss: 0.469479
test acc on this client after 370 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 4
local mask changes: 1284636.0 / 11173962
choose client_indexes: [ 4  8 13 16 17], accoring to random
choose mask diff: [1284636.0, 1588620.0, 1573114.0, 1565398.0, 1578594.0]
Doing local aggregation!
test acc on this client before 391 / 503 : 0.78
Client Index = 4	Epoch: 0	Loss: 0.508601
Client Index = 4	Epoch: 1	Loss: 0.300426
Client Index = 4	Epoch: 2	Loss: 0.338689
Client Index = 4	Epoch: 3	Loss: 0.277730
Client Index = 4	Epoch: 4	Loss: 0.188818
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 5
local mask changes: 1284776.0 / 11173962
choose client_indexes: [ 5  8 10 12 17], accoring to random
choose mask diff: [1284776.0, 1579672.0, 1585020.0, 1578662.0, 1574680.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.418893
Client Index = 5	Epoch: 1	Loss: 0.391612
Client Index = 5	Epoch: 2	Loss: 0.304055
Client Index = 5	Epoch: 3	Loss: 0.301653
Client Index = 5	Epoch: 4	Loss: 0.297071
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 6
local mask changes: 1285484.0 / 11173962
choose client_indexes: [ 5  6 12 15 19], accoring to random
choose mask diff: [1584778.0, 1285484.0, 1594534.0, 1588252.0, 1592550.0]
Doing local aggregation!
test acc on this client before 378 / 505 : 0.75
Client Index = 6	Epoch: 0	Loss: 0.600881
Client Index = 6	Epoch: 1	Loss: 0.528002
Client Index = 6	Epoch: 2	Loss: 0.512017
Client Index = 6	Epoch: 3	Loss: 0.479551
Client Index = 6	Epoch: 4	Loss: 0.510643
test acc on this client after 329 / 505 : 0.65
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 7
local mask changes: 1285410.0 / 11173962
choose client_indexes: [ 3  7  8 10 12], accoring to random
choose mask diff: [1581794.0, 1285410.0, 1569158.0, 1581844.0, 1581880.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 7	Epoch: 0	Loss: 0.499867
Client Index = 7	Epoch: 1	Loss: 0.343748
Client Index = 7	Epoch: 2	Loss: 0.297839
Client Index = 7	Epoch: 3	Loss: 0.343848
Client Index = 7	Epoch: 4	Loss: 0.327564
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 8
local mask changes: 1284774.0 / 11173962
choose client_indexes: [ 1  7  8 14 16], accoring to random
choose mask diff: [1585402.0, 1576172.0, 1284774.0, 1588246.0, 1576314.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.575816
Client Index = 8	Epoch: 1	Loss: 0.408982
Client Index = 8	Epoch: 2	Loss: 0.379465
Client Index = 8	Epoch: 3	Loss: 0.418681
Client Index = 8	Epoch: 4	Loss: 0.402337
test acc on this client after 376 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 9
local mask changes: 1286274.0 / 11173962
choose client_indexes: [ 2  5  9 16 19], accoring to random
choose mask diff: [1573674.0, 1574552.0, 1286274.0, 1580826.0, 1574516.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.401305
Client Index = 9	Epoch: 1	Loss: 0.290613
Client Index = 9	Epoch: 2	Loss: 0.248931
Client Index = 9	Epoch: 3	Loss: 0.300972
Client Index = 9	Epoch: 4	Loss: 0.267490
test acc on this client after 365 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 10
local mask changes: 1285488.0 / 11173962
choose client_indexes: [ 0  8 10 12 15], accoring to random
choose mask diff: [1592478.0, 1580202.0, 1285488.0, 1579070.0, 1580076.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.449815
Client Index = 10	Epoch: 1	Loss: 0.334823
Client Index = 10	Epoch: 2	Loss: 0.399683
Client Index = 10	Epoch: 3	Loss: 0.377889
Client Index = 10	Epoch: 4	Loss: 0.308059
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 11
local mask changes: 1285320.0 / 11173962
choose client_indexes: [ 3  4 11 16 17], accoring to random
choose mask diff: [1581052.0, 1581448.0, 1285320.0, 1574630.0, 1576438.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.265110
Client Index = 11	Epoch: 1	Loss: 0.301326
Client Index = 11	Epoch: 2	Loss: 0.251522
Client Index = 11	Epoch: 3	Loss: 0.199946
Client Index = 11	Epoch: 4	Loss: 0.173246
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 12
local mask changes: 1284590.0 / 11173962
choose client_indexes: [ 8 11 12 13 15], accoring to random
choose mask diff: [1584428.0, 1587130.0, 1284590.0, 1583718.0, 1581116.0]
Doing local aggregation!
test acc on this client before 347 / 504 : 0.69
Client Index = 12	Epoch: 0	Loss: 0.427562
Client Index = 12	Epoch: 1	Loss: 0.437827
Client Index = 12	Epoch: 2	Loss: 0.345049
Client Index = 12	Epoch: 3	Loss: 0.310493
Client Index = 12	Epoch: 4	Loss: 0.336124
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 13
local mask changes: 1285690.0 / 11173962
choose client_indexes: [ 0  5  9 12 13], accoring to random
choose mask diff: [1595066.0, 1589820.0, 1585790.0, 1584864.0, 1285690.0]
Doing local aggregation!
test acc on this client before 377 / 503 : 0.75
Client Index = 13	Epoch: 0	Loss: 0.471941
Client Index = 13	Epoch: 1	Loss: 0.357640
Client Index = 13	Epoch: 2	Loss: 0.409695
Client Index = 13	Epoch: 3	Loss: 0.270346
Client Index = 13	Epoch: 4	Loss: 0.306443
test acc on this client after 352 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 14
local mask changes: 1285254.0 / 11173962
choose client_indexes: [ 1  4  7 14 17], accoring to random
choose mask diff: [1578732.0, 1577942.0, 1583964.0, 1285254.0, 1582520.0]
Doing local aggregation!
test acc on this client before 399 / 502 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.537073
Client Index = 14	Epoch: 1	Loss: 0.432939
Client Index = 14	Epoch: 2	Loss: 0.385434
Client Index = 14	Epoch: 3	Loss: 0.439245
Client Index = 14	Epoch: 4	Loss: 0.427656
test acc on this client after 397 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 15
local mask changes: 1285658.0 / 11173962
choose client_indexes: [ 0  1  9 11 15], accoring to random
choose mask diff: [1575658.0, 1580424.0, 1571138.0, 1579732.0, 1285658.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.339135
Client Index = 15	Epoch: 1	Loss: 0.331998
Client Index = 15	Epoch: 2	Loss: 0.299188
Client Index = 15	Epoch: 3	Loss: 0.298691
Client Index = 15	Epoch: 4	Loss: 0.330218
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 16
local mask changes: 1285764.0 / 11173962
choose client_indexes: [ 3  7 14 15 16], accoring to random
choose mask diff: [1585964.0, 1581848.0, 1576516.0, 1576292.0, 1285764.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.546993
Client Index = 16	Epoch: 1	Loss: 0.307787
Client Index = 16	Epoch: 2	Loss: 0.348811
Client Index = 16	Epoch: 3	Loss: 0.253883
Client Index = 16	Epoch: 4	Loss: 0.221492
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 17
local mask changes: 1284962.0 / 11173962
choose client_indexes: [ 6 11 12 13 17], accoring to random
choose mask diff: [1581728.0, 1572094.0, 1571222.0, 1580490.0, 1284962.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.499629
Client Index = 17	Epoch: 1	Loss: 0.308119
Client Index = 17	Epoch: 2	Loss: 0.247548
Client Index = 17	Epoch: 3	Loss: 0.314522
Client Index = 17	Epoch: 4	Loss: 0.245273
test acc on this client after 399 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 18
local mask changes: 1285640.0 / 11173962
choose client_indexes: [ 1  5  8 18 19], accoring to random
choose mask diff: [1578350.0, 1567826.0, 1582900.0, 1285640.0, 1563756.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.367477
Client Index = 18	Epoch: 1	Loss: 0.296213
Client Index = 18	Epoch: 2	Loss: 0.290760
Client Index = 18	Epoch: 3	Loss: 0.300960
Client Index = 18	Epoch: 4	Loss: 0.218894
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(61) with spasity 0.5: 19
local mask changes: 1286002.0 / 11173962
choose client_indexes: [ 0  4  5  8 19], accoring to random
choose mask diff: [1577582.0, 1582472.0, 1579466.0, 1588508.0, 1286002.0]
Doing local aggregation!
test acc on this client before 397 / 506 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.412143
Client Index = 19	Epoch: 1	Loss: 0.300090
Client Index = 19	Epoch: 2	Loss: 0.400268
Client Index = 19	Epoch: 3	Loss: 0.232244
Client Index = 19	Epoch: 4	Loss: 0.330744
test acc on this client after 405 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 61
{'test_acc': 0.7851370026147614, 'test_loss': 0.6752311187576754}
################local_test_on_all_clients before local training in communication round: 61
{'test_acc': 0.7881070781398701, 'test_loss': 0.6343146250658569}
################Communication round : 62
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 0
local mask changes: 1237712.0 / 11173962
choose client_indexes: [ 0  2  6  7 12], accoring to random
choose mask diff: [1237712.0, 1546286.0, 1550188.0, 1539464.0, 1553912.0]
Doing local aggregation!
test acc on this client before 337 / 504 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.571098
Client Index = 0	Epoch: 1	Loss: 0.590233
Client Index = 0	Epoch: 2	Loss: 0.465128
Client Index = 0	Epoch: 3	Loss: 0.453871
Client Index = 0	Epoch: 4	Loss: 0.505110
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 1
local mask changes: 1238248.0 / 11173962
choose client_indexes: [1 3 4 5 7], accoring to random
choose mask diff: [1238248.0, 1542012.0, 1546686.0, 1539822.0, 1540510.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 1	Epoch: 0	Loss: 0.409058
Client Index = 1	Epoch: 1	Loss: 0.221115
Client Index = 1	Epoch: 2	Loss: 0.258096
Client Index = 1	Epoch: 3	Loss: 0.368297
Client Index = 1	Epoch: 4	Loss: 0.189684
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 2
local mask changes: 1238196.0 / 11173962
choose client_indexes: [ 1  2 15 16 17], accoring to random
choose mask diff: [1536554.0, 1238196.0, 1541790.0, 1529330.0, 1522226.0]
Doing local aggregation!
test acc on this client before 439 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.278494
Client Index = 2	Epoch: 1	Loss: 0.231512
Client Index = 2	Epoch: 2	Loss: 0.220328
Client Index = 2	Epoch: 3	Loss: 0.167654
Client Index = 2	Epoch: 4	Loss: 0.196786
test acc on this client after 430 / 502 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 3
local mask changes: 1237268.0 / 11173962
choose client_indexes: [ 3  6 10 15 18], accoring to random
choose mask diff: [1237268.0, 1554752.0, 1559004.0, 1551928.0, 1542312.0]
Doing local aggregation!
test acc on this client before 345 / 504 : 0.68
Client Index = 3	Epoch: 0	Loss: 0.573196
Client Index = 3	Epoch: 1	Loss: 0.524381
Client Index = 3	Epoch: 2	Loss: 0.514213
Client Index = 3	Epoch: 3	Loss: 0.486775
Client Index = 3	Epoch: 4	Loss: 0.409916
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 4
local mask changes: 1237594.0 / 11173962
choose client_indexes: [ 4  7 10 15 16], accoring to random
choose mask diff: [1237594.0, 1544682.0, 1547430.0, 1545606.0, 1527230.0]
Doing local aggregation!
test acc on this client before 359 / 503 : 0.71
Client Index = 4	Epoch: 0	Loss: 0.468470
Client Index = 4	Epoch: 1	Loss: 0.323226
Client Index = 4	Epoch: 2	Loss: 0.228985
Client Index = 4	Epoch: 3	Loss: 0.334916
Client Index = 4	Epoch: 4	Loss: 0.215519
test acc on this client after 404 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 5
local mask changes: 1238464.0 / 11173962
choose client_indexes: [ 5  6  8 11 19], accoring to random
choose mask diff: [1238464.0, 1547078.0, 1531658.0, 1537214.0, 1544018.0]
Doing local aggregation!
test acc on this client before 355 / 504 : 0.70
Client Index = 5	Epoch: 0	Loss: 0.408034
Client Index = 5	Epoch: 1	Loss: 0.335276
Client Index = 5	Epoch: 2	Loss: 0.283346
Client Index = 5	Epoch: 3	Loss: 0.350734
Client Index = 5	Epoch: 4	Loss: 0.262512
test acc on this client after 407 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 6
local mask changes: 1237694.0 / 11173962
choose client_indexes: [ 0  4  6 10 13], accoring to random
choose mask diff: [1554470.0, 1541976.0, 1237694.0, 1558332.0, 1552298.0]
Doing local aggregation!
test acc on this client before 390 / 505 : 0.77
Client Index = 6	Epoch: 0	Loss: 0.543482
Client Index = 6	Epoch: 1	Loss: 0.514634
Client Index = 6	Epoch: 2	Loss: 0.522137
Client Index = 6	Epoch: 3	Loss: 0.479609
Client Index = 6	Epoch: 4	Loss: 0.470261
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 7
local mask changes: 1238360.0 / 11173962
choose client_indexes: [ 5  7  9 18 19], accoring to random
choose mask diff: [1540392.0, 1238360.0, 1542580.0, 1544220.0, 1546370.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 7	Epoch: 0	Loss: 0.534570
Client Index = 7	Epoch: 1	Loss: 0.412493
Client Index = 7	Epoch: 2	Loss: 0.346161
Client Index = 7	Epoch: 3	Loss: 0.285510
Client Index = 7	Epoch: 4	Loss: 0.273511
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 8
local mask changes: 1237832.0 / 11173962
choose client_indexes: [ 1  2  8 11 12], accoring to random
choose mask diff: [1541574.0, 1544330.0, 1237832.0, 1540136.0, 1549496.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 8	Epoch: 0	Loss: 0.572388
Client Index = 8	Epoch: 1	Loss: 0.533327
Client Index = 8	Epoch: 2	Loss: 0.381697
Client Index = 8	Epoch: 3	Loss: 0.364147
Client Index = 8	Epoch: 4	Loss: 0.444913
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 9
local mask changes: 1238484.0 / 11173962
choose client_indexes: [ 2  3  4  9 14], accoring to random
choose mask diff: [1531144.0, 1541314.0, 1540278.0, 1238484.0, 1537882.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 9	Epoch: 0	Loss: 0.410486
Client Index = 9	Epoch: 1	Loss: 0.318947
Client Index = 9	Epoch: 2	Loss: 0.288212
Client Index = 9	Epoch: 3	Loss: 0.340002
Client Index = 9	Epoch: 4	Loss: 0.237546
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 10
local mask changes: 1238656.0 / 11173962
choose client_indexes: [ 5  7 10 15 18], accoring to random
choose mask diff: [1549576.0, 1542454.0, 1238656.0, 1534456.0, 1544408.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 10	Epoch: 0	Loss: 0.491668
Client Index = 10	Epoch: 1	Loss: 0.406949
Client Index = 10	Epoch: 2	Loss: 0.450996
Client Index = 10	Epoch: 3	Loss: 0.324700
Client Index = 10	Epoch: 4	Loss: 0.274073
test acc on this client after 388 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 11
local mask changes: 1238314.0 / 11173962
choose client_indexes: [ 8 11 12 14 18], accoring to random
choose mask diff: [1537172.0, 1238314.0, 1543274.0, 1541952.0, 1533498.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.273500
Client Index = 11	Epoch: 1	Loss: 0.283164
Client Index = 11	Epoch: 2	Loss: 0.307648
Client Index = 11	Epoch: 3	Loss: 0.186959
Client Index = 11	Epoch: 4	Loss: 0.206945
test acc on this client after 454 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 12
local mask changes: 1238326.0 / 11173962
choose client_indexes: [ 1  5  7 12 16], accoring to random
choose mask diff: [1536786.0, 1541606.0, 1541854.0, 1238326.0, 1547084.0]
Doing local aggregation!
test acc on this client before 371 / 504 : 0.74
Client Index = 12	Epoch: 0	Loss: 0.457830
Client Index = 12	Epoch: 1	Loss: 0.367449
Client Index = 12	Epoch: 2	Loss: 0.348144
Client Index = 12	Epoch: 3	Loss: 0.492490
Client Index = 12	Epoch: 4	Loss: 0.317206
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 13
local mask changes: 1237794.0 / 11173962
choose client_indexes: [ 2  4  5  7 13], accoring to random
choose mask diff: [1540406.0, 1535744.0, 1540716.0, 1545954.0, 1237794.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.438153
Client Index = 13	Epoch: 1	Loss: 0.352553
Client Index = 13	Epoch: 2	Loss: 0.335624
Client Index = 13	Epoch: 3	Loss: 0.422716
Client Index = 13	Epoch: 4	Loss: 0.285250
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 14
local mask changes: 1237172.0 / 11173962
choose client_indexes: [ 0  2  6 13 14], accoring to random
choose mask diff: [1557824.0, 1543980.0, 1543162.0, 1545428.0, 1237172.0]
Doing local aggregation!
test acc on this client before 415 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.463049
Client Index = 14	Epoch: 1	Loss: 0.409994
Client Index = 14	Epoch: 2	Loss: 0.423936
Client Index = 14	Epoch: 3	Loss: 0.369571
Client Index = 14	Epoch: 4	Loss: 0.405460
test acc on this client after 392 / 502 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 15
local mask changes: 1238266.0 / 11173962
choose client_indexes: [ 1  9 14 15 17], accoring to random
choose mask diff: [1534198.0, 1531162.0, 1551520.0, 1238266.0, 1535730.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 15	Epoch: 0	Loss: 0.346387
Client Index = 15	Epoch: 1	Loss: 0.321177
Client Index = 15	Epoch: 2	Loss: 0.313783
Client Index = 15	Epoch: 3	Loss: 0.272442
Client Index = 15	Epoch: 4	Loss: 0.213174
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 16
local mask changes: 1237896.0 / 11173962
choose client_indexes: [ 2  8 14 16 17], accoring to random
choose mask diff: [1536598.0, 1540648.0, 1534490.0, 1237896.0, 1533890.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.357250
Client Index = 16	Epoch: 1	Loss: 0.289667
Client Index = 16	Epoch: 2	Loss: 0.375784
Client Index = 16	Epoch: 3	Loss: 0.318821
Client Index = 16	Epoch: 4	Loss: 0.271424
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 17
local mask changes: 1238004.0 / 11173962
choose client_indexes: [ 4 14 15 17 18], accoring to random
choose mask diff: [1539474.0, 1540582.0, 1535352.0, 1238004.0, 1530096.0]
Doing local aggregation!
test acc on this client before 344 / 505 : 0.68
Client Index = 17	Epoch: 0	Loss: 0.488398
Client Index = 17	Epoch: 1	Loss: 0.349036
Client Index = 17	Epoch: 2	Loss: 0.314040
Client Index = 17	Epoch: 3	Loss: 0.273256
Client Index = 17	Epoch: 4	Loss: 0.192352
test acc on this client after 295 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 18
local mask changes: 1238564.0 / 11173962
choose client_indexes: [ 6  8 10 18 19], accoring to random
choose mask diff: [1542894.0, 1538956.0, 1544898.0, 1238564.0, 1519430.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.385680
Client Index = 18	Epoch: 1	Loss: 0.281489
Client Index = 18	Epoch: 2	Loss: 0.283474
Client Index = 18	Epoch: 3	Loss: 0.243866
Client Index = 18	Epoch: 4	Loss: 0.242958
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(62) with spasity 0.5: 19
local mask changes: 1237648.0 / 11173962
choose client_indexes: [ 1  6  9 13 19], accoring to random
choose mask diff: [1538868.0, 1553740.0, 1540972.0, 1548774.0, 1237648.0]
Doing local aggregation!
test acc on this client before 395 / 506 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.315975
Client Index = 19	Epoch: 1	Loss: 0.339726
Client Index = 19	Epoch: 2	Loss: 0.273326
Client Index = 19	Epoch: 3	Loss: 0.285364
Client Index = 19	Epoch: 4	Loss: 0.216636
test acc on this client after 383 / 506 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 62
{'test_acc': 0.7927943357781955, 'test_loss': 0.6566538284185127}
################local_test_on_all_clients before local training in communication round: 62
{'test_acc': 0.7767178660409759, 'test_loss': 0.6819431562323269}
################Communication round : 63
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 0
local mask changes: 1191362.0 / 11173962
choose client_indexes: [ 0  1  6 12 17], accoring to random
choose mask diff: [1191362.0, 1510512.0, 1509708.0, 1511914.0, 1514298.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 0	Epoch: 0	Loss: 0.523373
Client Index = 0	Epoch: 1	Loss: 0.534573
Client Index = 0	Epoch: 2	Loss: 0.535873
Client Index = 0	Epoch: 3	Loss: 0.441264
Client Index = 0	Epoch: 4	Loss: 0.467889
test acc on this client after 354 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 1
local mask changes: 1190156.0 / 11173962
choose client_indexes: [ 1  4  9 14 17], accoring to random
choose mask diff: [1190156.0, 1503402.0, 1500646.0, 1501224.0, 1496032.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.299518
Client Index = 1	Epoch: 1	Loss: 0.319119
Client Index = 1	Epoch: 2	Loss: 0.289391
Client Index = 1	Epoch: 3	Loss: 0.233136
Client Index = 1	Epoch: 4	Loss: 0.165105
test acc on this client after 443 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 2
local mask changes: 1190120.0 / 11173962
choose client_indexes: [ 2  7  9 15 17], accoring to random
choose mask diff: [1190120.0, 1504208.0, 1496008.0, 1498264.0, 1482648.0]
Doing local aggregation!
test acc on this client before 437 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.407730
Client Index = 2	Epoch: 1	Loss: 0.260457
Client Index = 2	Epoch: 2	Loss: 0.198039
Client Index = 2	Epoch: 3	Loss: 0.151490
Client Index = 2	Epoch: 4	Loss: 0.192788
test acc on this client after 449 / 502 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 3
local mask changes: 1191378.0 / 11173962
choose client_indexes: [ 0  1  3  9 12], accoring to random
choose mask diff: [1515790.0, 1507820.0, 1191378.0, 1506826.0, 1509660.0]
Doing local aggregation!
test acc on this client before 362 / 504 : 0.72
Client Index = 3	Epoch: 0	Loss: 0.537673
Client Index = 3	Epoch: 1	Loss: 0.481041
Client Index = 3	Epoch: 2	Loss: 0.495752
Client Index = 3	Epoch: 3	Loss: 0.429537
Client Index = 3	Epoch: 4	Loss: 0.396418
test acc on this client after 316 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 4
local mask changes: 1190476.0 / 11173962
choose client_indexes: [ 1  3  4  7 11], accoring to random
choose mask diff: [1508686.0, 1509366.0, 1190476.0, 1501166.0, 1497800.0]
Doing local aggregation!
test acc on this client before 357 / 503 : 0.71
Client Index = 4	Epoch: 0	Loss: 0.387281
Client Index = 4	Epoch: 1	Loss: 0.405685
Client Index = 4	Epoch: 2	Loss: 0.228077
Client Index = 4	Epoch: 3	Loss: 0.209686
Client Index = 4	Epoch: 4	Loss: 0.360293
test acc on this client after 421 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 5
local mask changes: 1191414.0 / 11173962
choose client_indexes: [ 5 10 11 13 16], accoring to random
choose mask diff: [1191414.0, 1508560.0, 1496172.0, 1508304.0, 1506324.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 5	Epoch: 0	Loss: 0.404276
Client Index = 5	Epoch: 1	Loss: 0.305799
Client Index = 5	Epoch: 2	Loss: 0.332000
Client Index = 5	Epoch: 3	Loss: 0.337477
Client Index = 5	Epoch: 4	Loss: 0.224477
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 6
local mask changes: 1190568.0 / 11173962
choose client_indexes: [ 3  6  8 11 19], accoring to random
choose mask diff: [1517986.0, 1190568.0, 1511192.0, 1515066.0, 1514256.0]
Doing local aggregation!
test acc on this client before 392 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.636471
Client Index = 6	Epoch: 1	Loss: 0.474526
Client Index = 6	Epoch: 2	Loss: 0.453549
Client Index = 6	Epoch: 3	Loss: 0.525026
Client Index = 6	Epoch: 4	Loss: 0.439356
test acc on this client after 397 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 7
local mask changes: 1190824.0 / 11173962
choose client_indexes: [ 2  4  7 16 17], accoring to random
choose mask diff: [1503984.0, 1508206.0, 1190824.0, 1503678.0, 1504568.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 7	Epoch: 0	Loss: 0.479435
Client Index = 7	Epoch: 1	Loss: 0.314617
Client Index = 7	Epoch: 2	Loss: 0.298184
Client Index = 7	Epoch: 3	Loss: 0.302598
Client Index = 7	Epoch: 4	Loss: 0.290388
test acc on this client after 302 / 504 : 0.60
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 8
local mask changes: 1190996.0 / 11173962
choose client_indexes: [ 3  4  8 14 15], accoring to random
choose mask diff: [1510754.0, 1507990.0, 1190996.0, 1505498.0, 1502166.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.540479
Client Index = 8	Epoch: 1	Loss: 0.414967
Client Index = 8	Epoch: 2	Loss: 0.346545
Client Index = 8	Epoch: 3	Loss: 0.375786
Client Index = 8	Epoch: 4	Loss: 0.439156
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 9
local mask changes: 1190202.0 / 11173962
choose client_indexes: [ 1  5  9 14 19], accoring to random
choose mask diff: [1501184.0, 1498020.0, 1190202.0, 1497448.0, 1499588.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.349374
Client Index = 9	Epoch: 1	Loss: 0.342601
Client Index = 9	Epoch: 2	Loss: 0.231685
Client Index = 9	Epoch: 3	Loss: 0.246557
Client Index = 9	Epoch: 4	Loss: 0.223689
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 10
local mask changes: 1191052.0 / 11173962
choose client_indexes: [ 5  8 10 14 17], accoring to random
choose mask diff: [1501350.0, 1504168.0, 1191052.0, 1522212.0, 1507446.0]
Doing local aggregation!
test acc on this client before 407 / 503 : 0.81
Client Index = 10	Epoch: 0	Loss: 0.454082
Client Index = 10	Epoch: 1	Loss: 0.403385
Client Index = 10	Epoch: 2	Loss: 0.319841
Client Index = 10	Epoch: 3	Loss: 0.417856
Client Index = 10	Epoch: 4	Loss: 0.260954
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 11
local mask changes: 1190200.0 / 11173962
choose client_indexes: [ 3  4 10 11 16], accoring to random
choose mask diff: [1499594.0, 1497148.0, 1516966.0, 1190200.0, 1497878.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.269370
Client Index = 11	Epoch: 1	Loss: 0.202634
Client Index = 11	Epoch: 2	Loss: 0.333882
Client Index = 11	Epoch: 3	Loss: 0.159671
Client Index = 11	Epoch: 4	Loss: 0.160044
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 12
local mask changes: 1191310.0 / 11173962
choose client_indexes: [ 8 12 14 17 18], accoring to random
choose mask diff: [1506412.0, 1191310.0, 1514058.0, 1496610.0, 1506048.0]
Doing local aggregation!
test acc on this client before 392 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.420280
Client Index = 12	Epoch: 1	Loss: 0.347849
Client Index = 12	Epoch: 2	Loss: 0.325958
Client Index = 12	Epoch: 3	Loss: 0.341746
Client Index = 12	Epoch: 4	Loss: 0.349066
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 13
local mask changes: 1191882.0 / 11173962
choose client_indexes: [ 3  6 10 12 13], accoring to random
choose mask diff: [1512704.0, 1514254.0, 1511746.0, 1501194.0, 1191882.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.469180
Client Index = 13	Epoch: 1	Loss: 0.385923
Client Index = 13	Epoch: 2	Loss: 0.320413
Client Index = 13	Epoch: 3	Loss: 0.274759
Client Index = 13	Epoch: 4	Loss: 0.396736
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 14
local mask changes: 1190488.0 / 11173962
choose client_indexes: [ 2  4  6 10 14], accoring to random
choose mask diff: [1500784.0, 1501432.0, 1502676.0, 1523010.0, 1190488.0]
Doing local aggregation!
test acc on this client before 407 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.514059
Client Index = 14	Epoch: 1	Loss: 0.463975
Client Index = 14	Epoch: 2	Loss: 0.417511
Client Index = 14	Epoch: 3	Loss: 0.414746
Client Index = 14	Epoch: 4	Loss: 0.426351
test acc on this client after 395 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 15
local mask changes: 1190986.0 / 11173962
choose client_indexes: [ 8 12 13 15 16], accoring to random
choose mask diff: [1500930.0, 1503302.0, 1511536.0, 1190986.0, 1501118.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.350161
Client Index = 15	Epoch: 1	Loss: 0.287514
Client Index = 15	Epoch: 2	Loss: 0.404955
Client Index = 15	Epoch: 3	Loss: 0.234003
Client Index = 15	Epoch: 4	Loss: 0.292916
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 16
local mask changes: 1191180.0 / 11173962
choose client_indexes: [ 1  5 11 14 16], accoring to random
choose mask diff: [1504294.0, 1507372.0, 1498206.0, 1493934.0, 1191180.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.303617
Client Index = 16	Epoch: 1	Loss: 0.358163
Client Index = 16	Epoch: 2	Loss: 0.222389
Client Index = 16	Epoch: 3	Loss: 0.208313
Client Index = 16	Epoch: 4	Loss: 0.361094
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 17
local mask changes: 1191404.0 / 11173962
choose client_indexes: [ 1  2  8 12 17], accoring to random
choose mask diff: [1496562.0, 1489522.0, 1505872.0, 1496684.0, 1191404.0]
Doing local aggregation!
test acc on this client before 368 / 505 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.439449
Client Index = 17	Epoch: 1	Loss: 0.326145
Client Index = 17	Epoch: 2	Loss: 0.313377
Client Index = 17	Epoch: 3	Loss: 0.235198
Client Index = 17	Epoch: 4	Loss: 0.267508
test acc on this client after 449 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 18
local mask changes: 1189750.0 / 11173962
choose client_indexes: [ 3  5 16 17 18], accoring to random
choose mask diff: [1506402.0, 1488556.0, 1496296.0, 1495634.0, 1189750.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 18	Epoch: 0	Loss: 0.395504
Client Index = 18	Epoch: 1	Loss: 0.258650
Client Index = 18	Epoch: 2	Loss: 0.255352
Client Index = 18	Epoch: 3	Loss: 0.233967
Client Index = 18	Epoch: 4	Loss: 0.256690
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(63) with spasity 0.5: 19
local mask changes: 1191244.0 / 11173962
choose client_indexes: [ 1  2 10 15 19], accoring to random
choose mask diff: [1494322.0, 1500900.0, 1514724.0, 1508752.0, 1191244.0]
Doing local aggregation!
test acc on this client before 379 / 506 : 0.75
Client Index = 19	Epoch: 0	Loss: 0.426908
Client Index = 19	Epoch: 1	Loss: 0.321713
Client Index = 19	Epoch: 2	Loss: 0.260106
Client Index = 19	Epoch: 3	Loss: 0.213375
Client Index = 19	Epoch: 4	Loss: 0.284411
test acc on this client after 398 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 63
{'test_acc': 0.7995310739555601, 'test_loss': 0.6619573034130687}
################local_test_on_all_clients before local training in communication round: 63
{'test_acc': 0.8001409926397838, 'test_loss': 0.6073139857858914}
################Communication round : 64
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 0
local mask changes: 1143640.0 / 11173962
choose client_indexes: [ 0  7 11 12 15], accoring to random
choose mask diff: [1143640.0, 1469986.0, 1476108.0, 1472628.0, 1469580.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 0	Epoch: 0	Loss: 0.555994
Client Index = 0	Epoch: 1	Loss: 0.530234
Client Index = 0	Epoch: 2	Loss: 0.458499
Client Index = 0	Epoch: 3	Loss: 0.465529
Client Index = 0	Epoch: 4	Loss: 0.476514
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 1
local mask changes: 1144206.0 / 11173962
choose client_indexes: [ 1  3  6  9 10], accoring to random
choose mask diff: [1144206.0, 1465646.0, 1476318.0, 1457522.0, 1467650.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.284057
Client Index = 1	Epoch: 1	Loss: 0.368281
Client Index = 1	Epoch: 2	Loss: 0.218592
Client Index = 1	Epoch: 3	Loss: 0.243936
Client Index = 1	Epoch: 4	Loss: 0.184121
test acc on this client after 418 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 2
local mask changes: 1143172.0 / 11173962
choose client_indexes: [ 2  3 11 12 13], accoring to random
choose mask diff: [1143172.0, 1463002.0, 1453158.0, 1465916.0, 1464426.0]
Doing local aggregation!
test acc on this client before 423 / 502 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.514126
Client Index = 2	Epoch: 1	Loss: 0.237142
Client Index = 2	Epoch: 2	Loss: 0.175061
Client Index = 2	Epoch: 3	Loss: 0.212956
Client Index = 2	Epoch: 4	Loss: 0.133037
test acc on this client after 408 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 3
local mask changes: 1143036.0 / 11173962
choose client_indexes: [ 0  3  8 13 19], accoring to random
choose mask diff: [1473062.0, 1143036.0, 1476100.0, 1478350.0, 1467150.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.523491
Client Index = 3	Epoch: 1	Loss: 0.470880
Client Index = 3	Epoch: 2	Loss: 0.400479
Client Index = 3	Epoch: 3	Loss: 0.371375
Client Index = 3	Epoch: 4	Loss: 0.435945
test acc on this client after 368 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 4
local mask changes: 1142340.0 / 11173962
choose client_indexes: [ 2  4  7 10 14], accoring to random
choose mask diff: [1459934.0, 1142340.0, 1460966.0, 1469606.0, 1466976.0]
Doing local aggregation!
test acc on this client before 375 / 503 : 0.75
Client Index = 4	Epoch: 0	Loss: 0.502289
Client Index = 4	Epoch: 1	Loss: 0.238298
Client Index = 4	Epoch: 2	Loss: 0.282440
Client Index = 4	Epoch: 3	Loss: 0.264590
Client Index = 4	Epoch: 4	Loss: 0.237703
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 5
local mask changes: 1143414.0 / 11173962
choose client_indexes: [ 5  7 10 12 15], accoring to random
choose mask diff: [1143414.0, 1459288.0, 1462266.0, 1461956.0, 1471258.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 5	Epoch: 0	Loss: 0.435279
Client Index = 5	Epoch: 1	Loss: 0.298600
Client Index = 5	Epoch: 2	Loss: 0.282577
Client Index = 5	Epoch: 3	Loss: 0.230746
Client Index = 5	Epoch: 4	Loss: 0.242036
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 6
local mask changes: 1145000.0 / 11173962
choose client_indexes: [ 0  2  6 11 13], accoring to random
choose mask diff: [1473264.0, 1478826.0, 1145000.0, 1472146.0, 1475158.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.543515
Client Index = 6	Epoch: 1	Loss: 0.545357
Client Index = 6	Epoch: 2	Loss: 0.477706
Client Index = 6	Epoch: 3	Loss: 0.437354
Client Index = 6	Epoch: 4	Loss: 0.461031
test acc on this client after 385 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 7
local mask changes: 1144038.0 / 11173962
choose client_indexes: [ 3  5  6  7 18], accoring to random
choose mask diff: [1466880.0, 1460848.0, 1472444.0, 1144038.0, 1464008.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 7	Epoch: 0	Loss: 0.493912
Client Index = 7	Epoch: 1	Loss: 0.344803
Client Index = 7	Epoch: 2	Loss: 0.319818
Client Index = 7	Epoch: 3	Loss: 0.324722
Client Index = 7	Epoch: 4	Loss: 0.225549
test acc on this client after 364 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 8
local mask changes: 1144388.0 / 11173962
choose client_indexes: [ 2  8 11 13 19], accoring to random
choose mask diff: [1466008.0, 1144388.0, 1458450.0, 1479562.0, 1475440.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.635846
Client Index = 8	Epoch: 1	Loss: 0.383369
Client Index = 8	Epoch: 2	Loss: 0.397689
Client Index = 8	Epoch: 3	Loss: 0.382293
Client Index = 8	Epoch: 4	Loss: 0.309421
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 9
local mask changes: 1143538.0 / 11173962
choose client_indexes: [ 0  7  9 14 18], accoring to random
choose mask diff: [1477636.0, 1465694.0, 1143538.0, 1456662.0, 1459138.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 9	Epoch: 0	Loss: 0.425673
Client Index = 9	Epoch: 1	Loss: 0.272908
Client Index = 9	Epoch: 2	Loss: 0.244121
Client Index = 9	Epoch: 3	Loss: 0.250331
Client Index = 9	Epoch: 4	Loss: 0.233774
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 10
local mask changes: 1143248.0 / 11173962
choose client_indexes: [ 2  5 10 14 17], accoring to random
choose mask diff: [1469818.0, 1462380.0, 1143248.0, 1478074.0, 1464790.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.473927
Client Index = 10	Epoch: 1	Loss: 0.340502
Client Index = 10	Epoch: 2	Loss: 0.303870
Client Index = 10	Epoch: 3	Loss: 0.326697
Client Index = 10	Epoch: 4	Loss: 0.285874
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 11
local mask changes: 1143058.0 / 11173962
choose client_indexes: [ 4  5 10 11 13], accoring to random
choose mask diff: [1456080.0, 1460950.0, 1468732.0, 1143058.0, 1471840.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.326649
Client Index = 11	Epoch: 1	Loss: 0.307554
Client Index = 11	Epoch: 2	Loss: 0.184910
Client Index = 11	Epoch: 3	Loss: 0.157369
Client Index = 11	Epoch: 4	Loss: 0.230986
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 12
local mask changes: 1144042.0 / 11173962
choose client_indexes: [ 3  6 12 17 18], accoring to random
choose mask diff: [1474226.0, 1476430.0, 1144042.0, 1457022.0, 1463910.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 12	Epoch: 0	Loss: 0.448204
Client Index = 12	Epoch: 1	Loss: 0.326722
Client Index = 12	Epoch: 2	Loss: 0.298151
Client Index = 12	Epoch: 3	Loss: 0.390415
Client Index = 12	Epoch: 4	Loss: 0.323457
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 13
local mask changes: 1143276.0 / 11173962
choose client_indexes: [ 0  6 13 15 17], accoring to random
choose mask diff: [1479692.0, 1467962.0, 1143276.0, 1476384.0, 1468018.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.432227
Client Index = 13	Epoch: 1	Loss: 0.320876
Client Index = 13	Epoch: 2	Loss: 0.361645
Client Index = 13	Epoch: 3	Loss: 0.306965
Client Index = 13	Epoch: 4	Loss: 0.269648
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 14
local mask changes: 1143616.0 / 11173962
choose client_indexes: [ 0  1  4 14 16], accoring to random
choose mask diff: [1477820.0, 1468644.0, 1461618.0, 1143616.0, 1461920.0]
Doing local aggregation!
test acc on this client before 409 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.453565
Client Index = 14	Epoch: 1	Loss: 0.415523
Client Index = 14	Epoch: 2	Loss: 0.404179
Client Index = 14	Epoch: 3	Loss: 0.351241
Client Index = 14	Epoch: 4	Loss: 0.379215
test acc on this client after 401 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 15
local mask changes: 1143462.0 / 11173962
choose client_indexes: [ 0  6 11 15 18], accoring to random
choose mask diff: [1470846.0, 1476512.0, 1467008.0, 1143462.0, 1467830.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 15	Epoch: 0	Loss: 0.345152
Client Index = 15	Epoch: 1	Loss: 0.302124
Client Index = 15	Epoch: 2	Loss: 0.245226
Client Index = 15	Epoch: 3	Loss: 0.509831
Client Index = 15	Epoch: 4	Loss: 0.240409
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 16
local mask changes: 1144440.0 / 11173962
choose client_indexes: [ 3  4  8 16 17], accoring to random
choose mask diff: [1472544.0, 1456452.0, 1460172.0, 1144440.0, 1458738.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.350737
Client Index = 16	Epoch: 1	Loss: 0.296894
Client Index = 16	Epoch: 2	Loss: 0.284786
Client Index = 16	Epoch: 3	Loss: 0.272039
Client Index = 16	Epoch: 4	Loss: 0.207454
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 17
local mask changes: 1143186.0 / 11173962
choose client_indexes: [ 2  4  8  9 17], accoring to random
choose mask diff: [1442496.0, 1457036.0, 1462108.0, 1459286.0, 1143186.0]
Doing local aggregation!
test acc on this client before 375 / 505 : 0.74
Client Index = 17	Epoch: 0	Loss: 0.480783
Client Index = 17	Epoch: 1	Loss: 0.349452
Client Index = 17	Epoch: 2	Loss: 0.221039
Client Index = 17	Epoch: 3	Loss: 0.283225
Client Index = 17	Epoch: 4	Loss: 0.223872
test acc on this client after 430 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 18
local mask changes: 1143102.0 / 11173962
choose client_indexes: [ 0  6  8 14 18], accoring to random
choose mask diff: [1467606.0, 1465182.0, 1460292.0, 1466314.0, 1143102.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.352254
Client Index = 18	Epoch: 1	Loss: 0.282379
Client Index = 18	Epoch: 2	Loss: 0.262141
Client Index = 18	Epoch: 3	Loss: 0.259231
Client Index = 18	Epoch: 4	Loss: 0.217039
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(64) with spasity 0.5: 19
local mask changes: 1142992.0 / 11173962
choose client_indexes: [ 3  5 16 18 19], accoring to random
choose mask diff: [1463790.0, 1462266.0, 1472614.0, 1449312.0, 1142992.0]
Doing local aggregation!
test acc on this client before 385 / 506 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.352451
Client Index = 19	Epoch: 1	Loss: 0.362026
Client Index = 19	Epoch: 2	Loss: 0.291983
Client Index = 19	Epoch: 3	Loss: 0.264382
Client Index = 19	Epoch: 4	Loss: 0.261243
test acc on this client after 401 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 64
{'test_acc': 0.8016966072160399, 'test_loss': 0.634231819599043}
################local_test_on_all_clients before local training in communication round: 64
{'test_acc': 0.7924910721038398, 'test_loss': 0.6194974252378037}
################Communication round : 65
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 0
local mask changes: 1095788.0 / 11173962
choose client_indexes: [ 0  1  8 12 13], accoring to random
choose mask diff: [1095788.0, 1435530.0, 1444124.0, 1431880.0, 1443244.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.546303
Client Index = 0	Epoch: 1	Loss: 0.510966
Client Index = 0	Epoch: 2	Loss: 0.467190
Client Index = 0	Epoch: 3	Loss: 0.464173
Client Index = 0	Epoch: 4	Loss: 0.505226
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 1
local mask changes: 1096508.0 / 11173962
choose client_indexes: [ 0  1  5 13 14], accoring to random
choose mask diff: [1434644.0, 1096508.0, 1426586.0, 1435752.0, 1426238.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.375909
Client Index = 1	Epoch: 1	Loss: 0.210433
Client Index = 1	Epoch: 2	Loss: 0.193087
Client Index = 1	Epoch: 3	Loss: 0.208059
Client Index = 1	Epoch: 4	Loss: 0.194591
test acc on this client after 395 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 2
local mask changes: 1096650.0 / 11173962
choose client_indexes: [ 0  1  2  7 13], accoring to random
choose mask diff: [1435784.0, 1416412.0, 1096650.0, 1421238.0, 1423558.0]
Doing local aggregation!
test acc on this client before 436 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.316133
Client Index = 2	Epoch: 1	Loss: 0.218745
Client Index = 2	Epoch: 2	Loss: 0.177002
Client Index = 2	Epoch: 3	Loss: 0.231557
Client Index = 2	Epoch: 4	Loss: 0.132452
test acc on this client after 440 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 3
local mask changes: 1095520.0 / 11173962
choose client_indexes: [ 3 11 14 18 19], accoring to random
choose mask diff: [1095520.0, 1428622.0, 1439546.0, 1427528.0, 1425804.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.606918
Client Index = 3	Epoch: 1	Loss: 0.495460
Client Index = 3	Epoch: 2	Loss: 0.404516
Client Index = 3	Epoch: 3	Loss: 0.433128
Client Index = 3	Epoch: 4	Loss: 0.409298
test acc on this client after 385 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 4
local mask changes: 1095960.0 / 11173962
choose client_indexes: [ 1  4  5  6 14], accoring to random
choose mask diff: [1421576.0, 1095960.0, 1429118.0, 1433326.0, 1421690.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.454950
Client Index = 4	Epoch: 1	Loss: 0.254294
Client Index = 4	Epoch: 2	Loss: 0.276663
Client Index = 4	Epoch: 3	Loss: 0.333783
Client Index = 4	Epoch: 4	Loss: 0.201678
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 5
local mask changes: 1095968.0 / 11173962
choose client_indexes: [ 5  8 14 15 19], accoring to random
choose mask diff: [1095968.0, 1422548.0, 1435500.0, 1427872.0, 1429486.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.423783
Client Index = 5	Epoch: 1	Loss: 0.318306
Client Index = 5	Epoch: 2	Loss: 0.320409
Client Index = 5	Epoch: 3	Loss: 0.269243
Client Index = 5	Epoch: 4	Loss: 0.323830
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 6
local mask changes: 1096284.0 / 11173962
choose client_indexes: [ 4  6 11 13 19], accoring to random
choose mask diff: [1433190.0, 1096284.0, 1432306.0, 1430152.0, 1436292.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.566199
Client Index = 6	Epoch: 1	Loss: 0.517334
Client Index = 6	Epoch: 2	Loss: 0.467279
Client Index = 6	Epoch: 3	Loss: 0.444823
Client Index = 6	Epoch: 4	Loss: 0.400697
test acc on this client after 370 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 7
local mask changes: 1096020.0 / 11173962
choose client_indexes: [ 3  7 10 17 18], accoring to random
choose mask diff: [1425640.0, 1096020.0, 1426734.0, 1425718.0, 1421278.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 7	Epoch: 0	Loss: 0.507672
Client Index = 7	Epoch: 1	Loss: 0.358366
Client Index = 7	Epoch: 2	Loss: 0.291297
Client Index = 7	Epoch: 3	Loss: 0.357215
Client Index = 7	Epoch: 4	Loss: 0.231162
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 8
local mask changes: 1096654.0 / 11173962
choose client_indexes: [ 2  8 15 16 18], accoring to random
choose mask diff: [1423656.0, 1096654.0, 1421236.0, 1426728.0, 1427148.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 8	Epoch: 0	Loss: 0.572697
Client Index = 8	Epoch: 1	Loss: 0.323713
Client Index = 8	Epoch: 2	Loss: 0.363521
Client Index = 8	Epoch: 3	Loss: 0.346994
Client Index = 8	Epoch: 4	Loss: 0.295671
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 9
local mask changes: 1096100.0 / 11173962
choose client_indexes: [ 0  9 17 18 19], accoring to random
choose mask diff: [1435520.0, 1096100.0, 1422316.0, 1418186.0, 1420522.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.325967
Client Index = 9	Epoch: 1	Loss: 0.400819
Client Index = 9	Epoch: 2	Loss: 0.267967
Client Index = 9	Epoch: 3	Loss: 0.204603
Client Index = 9	Epoch: 4	Loss: 0.220133
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 10
local mask changes: 1097018.0 / 11173962
choose client_indexes: [ 1  9 10 17 19], accoring to random
choose mask diff: [1431642.0, 1438160.0, 1097018.0, 1424566.0, 1436696.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 10	Epoch: 0	Loss: 0.483782
Client Index = 10	Epoch: 1	Loss: 0.341594
Client Index = 10	Epoch: 2	Loss: 0.363335
Client Index = 10	Epoch: 3	Loss: 0.282547
Client Index = 10	Epoch: 4	Loss: 0.277554
test acc on this client after 378 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 11
local mask changes: 1096022.0 / 11173962
choose client_indexes: [ 1 11 12 14 19], accoring to random
choose mask diff: [1426554.0, 1096022.0, 1428058.0, 1427728.0, 1433280.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.262586
Client Index = 11	Epoch: 1	Loss: 0.252050
Client Index = 11	Epoch: 2	Loss: 0.215407
Client Index = 11	Epoch: 3	Loss: 0.225866
Client Index = 11	Epoch: 4	Loss: 0.243466
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 12
local mask changes: 1096428.0 / 11173962
choose client_indexes: [ 9 10 11 12 15], accoring to random
choose mask diff: [1438568.0, 1432976.0, 1429258.0, 1096428.0, 1427558.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.426817
Client Index = 12	Epoch: 1	Loss: 0.339289
Client Index = 12	Epoch: 2	Loss: 0.427003
Client Index = 12	Epoch: 3	Loss: 0.326823
Client Index = 12	Epoch: 4	Loss: 0.245450
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 13
local mask changes: 1097280.0 / 11173962
choose client_indexes: [ 0 12 13 15 16], accoring to random
choose mask diff: [1437544.0, 1428990.0, 1097280.0, 1429840.0, 1439538.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.422778
Client Index = 13	Epoch: 1	Loss: 0.393275
Client Index = 13	Epoch: 2	Loss: 0.368378
Client Index = 13	Epoch: 3	Loss: 0.322552
Client Index = 13	Epoch: 4	Loss: 0.282371
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 14
local mask changes: 1096822.0 / 11173962
choose client_indexes: [ 6  9 14 16 18], accoring to random
choose mask diff: [1430212.0, 1425704.0, 1096822.0, 1416296.0, 1431048.0]
Doing local aggregation!
test acc on this client before 419 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.552264
Client Index = 14	Epoch: 1	Loss: 0.382407
Client Index = 14	Epoch: 2	Loss: 0.356398
Client Index = 14	Epoch: 3	Loss: 0.388371
Client Index = 14	Epoch: 4	Loss: 0.315688
test acc on this client after 404 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 15
local mask changes: 1095944.0 / 11173962
choose client_indexes: [ 0  1  4  7 15], accoring to random
choose mask diff: [1430956.0, 1426410.0, 1432264.0, 1430784.0, 1095944.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.320607
Client Index = 15	Epoch: 1	Loss: 0.334350
Client Index = 15	Epoch: 2	Loss: 0.305621
Client Index = 15	Epoch: 3	Loss: 0.221934
Client Index = 15	Epoch: 4	Loss: 0.245665
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 16
local mask changes: 1096742.0 / 11173962
choose client_indexes: [ 6 10 12 16 17], accoring to random
choose mask diff: [1436374.0, 1437164.0, 1434012.0, 1096742.0, 1417304.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.389607
Client Index = 16	Epoch: 1	Loss: 0.291855
Client Index = 16	Epoch: 2	Loss: 0.283498
Client Index = 16	Epoch: 3	Loss: 0.253117
Client Index = 16	Epoch: 4	Loss: 0.226549
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 17
local mask changes: 1096734.0 / 11173962
choose client_indexes: [ 0  1  9 17 19], accoring to random
choose mask diff: [1436880.0, 1410632.0, 1416608.0, 1096734.0, 1426838.0]
Doing local aggregation!
test acc on this client before 420 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.433492
Client Index = 17	Epoch: 1	Loss: 0.327450
Client Index = 17	Epoch: 2	Loss: 0.245401
Client Index = 17	Epoch: 3	Loss: 0.315572
Client Index = 17	Epoch: 4	Loss: 0.204547
test acc on this client after 422 / 505 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 18
local mask changes: 1095764.0 / 11173962
choose client_indexes: [ 2  6 12 13 18], accoring to random
choose mask diff: [1425750.0, 1422072.0, 1425554.0, 1436392.0, 1095764.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.326653
Client Index = 18	Epoch: 1	Loss: 0.309893
Client Index = 18	Epoch: 2	Loss: 0.245211
Client Index = 18	Epoch: 3	Loss: 0.209425
Client Index = 18	Epoch: 4	Loss: 0.486248
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(65) with spasity 0.5: 19
local mask changes: 1096622.0 / 11173962
choose client_indexes: [ 2  5  8 11 19], accoring to random
choose mask diff: [1423804.0, 1421942.0, 1438398.0, 1431182.0, 1096622.0]
Doing local aggregation!
test acc on this client before 355 / 506 : 0.70
Client Index = 19	Epoch: 0	Loss: 0.362903
Client Index = 19	Epoch: 1	Loss: 0.306746
Client Index = 19	Epoch: 2	Loss: 0.313252
Client Index = 19	Epoch: 3	Loss: 0.320255
Client Index = 19	Epoch: 4	Loss: 0.206849
test acc on this client after 402 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 65
{'test_acc': 0.8148076355324173, 'test_loss': 0.5898740602595722}
################local_test_on_all_clients before local training in communication round: 65
{'test_acc': 0.8066915640408834, 'test_loss': 0.5867502559276877}
################Communication round : 66
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 0
local mask changes: 1049294.0 / 11173962
choose client_indexes: [ 0  3  6 11 14], accoring to random
choose mask diff: [1049294.0, 1400504.0, 1398246.0, 1403500.0, 1404234.0]
Doing local aggregation!
test acc on this client before 356 / 504 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.560576
Client Index = 0	Epoch: 1	Loss: 0.504122
Client Index = 0	Epoch: 2	Loss: 0.502630
Client Index = 0	Epoch: 3	Loss: 0.450513
Client Index = 0	Epoch: 4	Loss: 0.389637
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 1
local mask changes: 1049080.0 / 11173962
choose client_indexes: [ 1 10 14 15 17], accoring to random
choose mask diff: [1049080.0, 1391176.0, 1380848.0, 1390192.0, 1378044.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.259270
Client Index = 1	Epoch: 1	Loss: 0.200815
Client Index = 1	Epoch: 2	Loss: 0.313221
Client Index = 1	Epoch: 3	Loss: 0.196693
Client Index = 1	Epoch: 4	Loss: 0.129754
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 2
local mask changes: 1049504.0 / 11173962
choose client_indexes: [ 2  4  7  8 15], accoring to random
choose mask diff: [1049504.0, 1383274.0, 1379596.0, 1387768.0, 1388684.0]
Doing local aggregation!
test acc on this client before 413 / 502 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.290503
Client Index = 2	Epoch: 1	Loss: 0.210604
Client Index = 2	Epoch: 2	Loss: 0.142664
Client Index = 2	Epoch: 3	Loss: 0.245508
Client Index = 2	Epoch: 4	Loss: 0.146383
test acc on this client after 438 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 3
local mask changes: 1049398.0 / 11173962
choose client_indexes: [ 3  6  7  8 12], accoring to random
choose mask diff: [1049398.0, 1401824.0, 1394484.0, 1396856.0, 1396588.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 3	Epoch: 0	Loss: 0.562077
Client Index = 3	Epoch: 1	Loss: 0.518100
Client Index = 3	Epoch: 2	Loss: 0.403142
Client Index = 3	Epoch: 3	Loss: 0.393146
Client Index = 3	Epoch: 4	Loss: 0.390677
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 4
local mask changes: 1050496.0 / 11173962
choose client_indexes: [ 2  4  7  9 14], accoring to random
choose mask diff: [1384724.0, 1050496.0, 1384630.0, 1393416.0, 1376786.0]
Doing local aggregation!
test acc on this client before 369 / 503 : 0.73
Client Index = 4	Epoch: 0	Loss: 0.485746
Client Index = 4	Epoch: 1	Loss: 0.299286
Client Index = 4	Epoch: 2	Loss: 0.270297
Client Index = 4	Epoch: 3	Loss: 0.199791
Client Index = 4	Epoch: 4	Loss: 0.434833
test acc on this client after 397 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 5
local mask changes: 1048998.0 / 11173962
choose client_indexes: [ 5  8 13 15 17], accoring to random
choose mask diff: [1048998.0, 1382466.0, 1394918.0, 1388034.0, 1389974.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.457430
Client Index = 5	Epoch: 1	Loss: 0.276010
Client Index = 5	Epoch: 2	Loss: 0.299395
Client Index = 5	Epoch: 3	Loss: 0.253615
Client Index = 5	Epoch: 4	Loss: 0.285444
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 6
local mask changes: 1049946.0 / 11173962
choose client_indexes: [ 1  4  5  6 13], accoring to random
choose mask diff: [1399714.0, 1392334.0, 1397564.0, 1049946.0, 1385922.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.578643
Client Index = 6	Epoch: 1	Loss: 0.449443
Client Index = 6	Epoch: 2	Loss: 0.500252
Client Index = 6	Epoch: 3	Loss: 0.412995
Client Index = 6	Epoch: 4	Loss: 0.501194
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 7
local mask changes: 1049470.0 / 11173962
choose client_indexes: [ 0  7 10 15 19], accoring to random
choose mask diff: [1396108.0, 1049470.0, 1386134.0, 1394808.0, 1397154.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 7	Epoch: 0	Loss: 0.450236
Client Index = 7	Epoch: 1	Loss: 0.381219
Client Index = 7	Epoch: 2	Loss: 0.249637
Client Index = 7	Epoch: 3	Loss: 0.270278
Client Index = 7	Epoch: 4	Loss: 0.345942
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 8
local mask changes: 1048718.0 / 11173962
choose client_indexes: [ 8 11 13 16 17], accoring to random
choose mask diff: [1048718.0, 1383764.0, 1402074.0, 1381118.0, 1387288.0]
Doing local aggregation!
test acc on this client before 406 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.621501
Client Index = 8	Epoch: 1	Loss: 0.442979
Client Index = 8	Epoch: 2	Loss: 0.352203
Client Index = 8	Epoch: 3	Loss: 0.271423
Client Index = 8	Epoch: 4	Loss: 0.358479
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 9
local mask changes: 1048672.0 / 11173962
choose client_indexes: [ 6  9 14 16 17], accoring to random
choose mask diff: [1405022.0, 1048672.0, 1384156.0, 1394082.0, 1377454.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.342689
Client Index = 9	Epoch: 1	Loss: 0.300555
Client Index = 9	Epoch: 2	Loss: 0.309155
Client Index = 9	Epoch: 3	Loss: 0.238794
Client Index = 9	Epoch: 4	Loss: 0.212472
test acc on this client after 406 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 10
local mask changes: 1049360.0 / 11173962
choose client_indexes: [ 3  8 10 11 13], accoring to random
choose mask diff: [1408930.0, 1392706.0, 1049360.0, 1394654.0, 1402320.0]
Doing local aggregation!
test acc on this client before 378 / 503 : 0.75
Client Index = 10	Epoch: 0	Loss: 0.441341
Client Index = 10	Epoch: 1	Loss: 0.384677
Client Index = 10	Epoch: 2	Loss: 0.411211
Client Index = 10	Epoch: 3	Loss: 0.312612
Client Index = 10	Epoch: 4	Loss: 0.243600
test acc on this client after 370 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 11
local mask changes: 1049302.0 / 11173962
choose client_indexes: [ 0  4  8  9 11], accoring to random
choose mask diff: [1399996.0, 1379222.0, 1383764.0, 1393746.0, 1049302.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.287317
Client Index = 11	Epoch: 1	Loss: 0.276943
Client Index = 11	Epoch: 2	Loss: 0.152629
Client Index = 11	Epoch: 3	Loss: 0.139610
Client Index = 11	Epoch: 4	Loss: 0.240576
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 12
local mask changes: 1050128.0 / 11173962
choose client_indexes: [ 1  3 12 13 15], accoring to random
choose mask diff: [1390224.0, 1395762.0, 1050128.0, 1393088.0, 1387192.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 12	Epoch: 0	Loss: 0.373988
Client Index = 12	Epoch: 1	Loss: 0.397989
Client Index = 12	Epoch: 2	Loss: 0.334526
Client Index = 12	Epoch: 3	Loss: 0.246962
Client Index = 12	Epoch: 4	Loss: 0.357476
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 13
local mask changes: 1049256.0 / 11173962
choose client_indexes: [ 3  4  9 11 13], accoring to random
choose mask diff: [1398248.0, 1394346.0, 1399818.0, 1397212.0, 1049256.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.391406
Client Index = 13	Epoch: 1	Loss: 0.332573
Client Index = 13	Epoch: 2	Loss: 0.357656
Client Index = 13	Epoch: 3	Loss: 0.340448
Client Index = 13	Epoch: 4	Loss: 0.266819
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 14
local mask changes: 1049240.0 / 11173962
choose client_indexes: [ 4  6  7 14 16], accoring to random
choose mask diff: [1384820.0, 1389664.0, 1399358.0, 1049240.0, 1378560.0]
Doing local aggregation!
test acc on this client before 407 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.439605
Client Index = 14	Epoch: 1	Loss: 0.440144
Client Index = 14	Epoch: 2	Loss: 0.357901
Client Index = 14	Epoch: 3	Loss: 0.315082
Client Index = 14	Epoch: 4	Loss: 0.327545
test acc on this client after 400 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 15
local mask changes: 1049448.0 / 11173962
choose client_indexes: [ 0  5  7  9 15], accoring to random
choose mask diff: [1385602.0, 1394542.0, 1388010.0, 1390056.0, 1049448.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.320849
Client Index = 15	Epoch: 1	Loss: 0.298624
Client Index = 15	Epoch: 2	Loss: 0.248200
Client Index = 15	Epoch: 3	Loss: 0.273590
Client Index = 15	Epoch: 4	Loss: 0.342157
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 16
local mask changes: 1048358.0 / 11173962
choose client_indexes: [ 1  5  8 11 16], accoring to random
choose mask diff: [1389310.0, 1389156.0, 1385232.0, 1381680.0, 1048358.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.349478
Client Index = 16	Epoch: 1	Loss: 0.253567
Client Index = 16	Epoch: 2	Loss: 0.270810
Client Index = 16	Epoch: 3	Loss: 0.236950
Client Index = 16	Epoch: 4	Loss: 0.173206
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 17
local mask changes: 1049660.0 / 11173962
choose client_indexes: [ 4  5  8 13 17], accoring to random
choose mask diff: [1381848.0, 1388112.0, 1388262.0, 1392056.0, 1049660.0]
Doing local aggregation!
test acc on this client before 375 / 505 : 0.74
Client Index = 17	Epoch: 0	Loss: 0.426469
Client Index = 17	Epoch: 1	Loss: 0.243894
Client Index = 17	Epoch: 2	Loss: 0.396260
Client Index = 17	Epoch: 3	Loss: 0.206704
Client Index = 17	Epoch: 4	Loss: 0.226202
test acc on this client after 446 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 18
local mask changes: 1049598.0 / 11173962
choose client_indexes: [ 4  6 13 18 19], accoring to random
choose mask diff: [1395036.0, 1384572.0, 1394068.0, 1049598.0, 1382238.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.318798
Client Index = 18	Epoch: 1	Loss: 0.271812
Client Index = 18	Epoch: 2	Loss: 0.250557
Client Index = 18	Epoch: 3	Loss: 0.234378
Client Index = 18	Epoch: 4	Loss: 0.222496
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(66) with spasity 0.5: 19
local mask changes: 1048642.0 / 11173962
choose client_indexes: [ 3 12 13 17 19], accoring to random
choose mask diff: [1387320.0, 1397832.0, 1400814.0, 1390358.0, 1048642.0]
Doing local aggregation!
test acc on this client before 405 / 506 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.391131
Client Index = 19	Epoch: 1	Loss: 0.259831
Client Index = 19	Epoch: 2	Loss: 0.287169
Client Index = 19	Epoch: 3	Loss: 0.181619
Client Index = 19	Epoch: 4	Loss: 0.316396
test acc on this client after 407 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 66
{'test_acc': 0.8130028360365269, 'test_loss': 0.5848390695182977}
################local_test_on_all_clients before local training in communication round: 66
{'test_acc': 0.7999152140428001, 'test_loss': 0.6159975953543108}
################Communication round : 67
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 0
local mask changes: 1002646.0 / 11173962
choose client_indexes: [ 0  7 10 12 18], accoring to random
choose mask diff: [1002646.0, 1366336.0, 1377708.0, 1361858.0, 1360392.0]
Doing local aggregation!
test acc on this client before 356 / 504 : 0.71
Client Index = 0	Epoch: 0	Loss: 0.565846
Client Index = 0	Epoch: 1	Loss: 0.484044
Client Index = 0	Epoch: 2	Loss: 0.440550
Client Index = 0	Epoch: 3	Loss: 0.464369
Client Index = 0	Epoch: 4	Loss: 0.452527
test acc on this client after 378 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 1
local mask changes: 1002616.0 / 11173962
choose client_indexes: [ 1  7  8 16 17], accoring to random
choose mask diff: [1002616.0, 1354024.0, 1358232.0, 1353380.0, 1332796.0]
Doing local aggregation!
test acc on this client before 436 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.419594
Client Index = 1	Epoch: 1	Loss: 0.315689
Client Index = 1	Epoch: 2	Loss: 0.185564
Client Index = 1	Epoch: 3	Loss: 0.149690
Client Index = 1	Epoch: 4	Loss: 0.137687
test acc on this client after 421 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 2
local mask changes: 1002856.0 / 11173962
choose client_indexes: [ 2  7 10 17 18], accoring to random
choose mask diff: [1002856.0, 1340510.0, 1356302.0, 1333788.0, 1348200.0]
Doing local aggregation!
test acc on this client before 440 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.310812
Client Index = 2	Epoch: 1	Loss: 0.186245
Client Index = 2	Epoch: 2	Loss: 0.173997
Client Index = 2	Epoch: 3	Loss: 0.146712
Client Index = 2	Epoch: 4	Loss: 0.131451
test acc on this client after 442 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 3
local mask changes: 1002976.0 / 11173962
choose client_indexes: [ 3  6  7 13 19], accoring to random
choose mask diff: [1002976.0, 1359310.0, 1348938.0, 1364994.0, 1350116.0]
Doing local aggregation!
test acc on this client before 380 / 504 : 0.75
Client Index = 3	Epoch: 0	Loss: 0.497345
Client Index = 3	Epoch: 1	Loss: 0.410015
Client Index = 3	Epoch: 2	Loss: 0.437110
Client Index = 3	Epoch: 3	Loss: 0.359194
Client Index = 3	Epoch: 4	Loss: 0.393748
test acc on this client after 373 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 4
local mask changes: 1002786.0 / 11173962
choose client_indexes: [ 3  4 10 17 19], accoring to random
choose mask diff: [1363364.0, 1002786.0, 1358652.0, 1348276.0, 1361622.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.373539
Client Index = 4	Epoch: 1	Loss: 0.248115
Client Index = 4	Epoch: 2	Loss: 0.345707
Client Index = 4	Epoch: 3	Loss: 0.246518
Client Index = 4	Epoch: 4	Loss: 0.188896
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 5
local mask changes: 1002242.0 / 11173962
choose client_indexes: [ 5  7  9 16 18], accoring to random
choose mask diff: [1002242.0, 1346802.0, 1351498.0, 1352046.0, 1347072.0]
Doing local aggregation!
test acc on this client before 387 / 504 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.435955
Client Index = 5	Epoch: 1	Loss: 0.280736
Client Index = 5	Epoch: 2	Loss: 0.260711
Client Index = 5	Epoch: 3	Loss: 0.225707
Client Index = 5	Epoch: 4	Loss: 0.346431
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 6
local mask changes: 1003776.0 / 11173962
choose client_indexes: [ 0  6 13 16 18], accoring to random
choose mask diff: [1365772.0, 1003776.0, 1349988.0, 1362242.0, 1353928.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.476095
Client Index = 6	Epoch: 1	Loss: 0.555463
Client Index = 6	Epoch: 2	Loss: 0.412260
Client Index = 6	Epoch: 3	Loss: 0.396444
Client Index = 6	Epoch: 4	Loss: 0.488818
test acc on this client after 378 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 7
local mask changes: 1002382.0 / 11173962
choose client_indexes: [ 6  7 10 13 19], accoring to random
choose mask diff: [1362428.0, 1002382.0, 1348186.0, 1363440.0, 1357098.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 7	Epoch: 0	Loss: 0.379565
Client Index = 7	Epoch: 1	Loss: 0.290166
Client Index = 7	Epoch: 2	Loss: 0.326820
Client Index = 7	Epoch: 3	Loss: 0.264045
Client Index = 7	Epoch: 4	Loss: 0.246535
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 8
local mask changes: 1002274.0 / 11173962
choose client_indexes: [ 0  8  9 12 13], accoring to random
choose mask diff: [1367736.0, 1002274.0, 1361964.0, 1357016.0, 1359494.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.595229
Client Index = 8	Epoch: 1	Loss: 0.379292
Client Index = 8	Epoch: 2	Loss: 0.349824
Client Index = 8	Epoch: 3	Loss: 0.379686
Client Index = 8	Epoch: 4	Loss: 0.303985
test acc on this client after 405 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 9
local mask changes: 1002256.0 / 11173962
choose client_indexes: [ 3  6  9 15 19], accoring to random
choose mask diff: [1358694.0, 1361424.0, 1002256.0, 1353788.0, 1348956.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.344617
Client Index = 9	Epoch: 1	Loss: 0.255025
Client Index = 9	Epoch: 2	Loss: 0.320347
Client Index = 9	Epoch: 3	Loss: 0.231085
Client Index = 9	Epoch: 4	Loss: 0.221238
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 10
local mask changes: 1002818.0 / 11173962
choose client_indexes: [ 1 10 11 13 19], accoring to random
choose mask diff: [1351892.0, 1002818.0, 1354032.0, 1362898.0, 1360202.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 10	Epoch: 0	Loss: 0.424402
Client Index = 10	Epoch: 1	Loss: 0.342282
Client Index = 10	Epoch: 2	Loss: 0.308511
Client Index = 10	Epoch: 3	Loss: 0.274960
Client Index = 10	Epoch: 4	Loss: 0.292946
test acc on this client after 376 / 503 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 11
local mask changes: 1002420.0 / 11173962
choose client_indexes: [ 0  1  9 11 19], accoring to random
choose mask diff: [1358294.0, 1348494.0, 1351664.0, 1002420.0, 1350040.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 11	Epoch: 0	Loss: 0.273788
Client Index = 11	Epoch: 1	Loss: 0.182226
Client Index = 11	Epoch: 2	Loss: 0.208197
Client Index = 11	Epoch: 3	Loss: 0.291668
Client Index = 11	Epoch: 4	Loss: 0.140202
test acc on this client after 444 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 12
local mask changes: 1002580.0 / 11173962
choose client_indexes: [ 1  5 12 14 15], accoring to random
choose mask diff: [1348260.0, 1353212.0, 1002580.0, 1366274.0, 1348138.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.402462
Client Index = 12	Epoch: 1	Loss: 0.373317
Client Index = 12	Epoch: 2	Loss: 0.277454
Client Index = 12	Epoch: 3	Loss: 0.313250
Client Index = 12	Epoch: 4	Loss: 0.253901
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 13
local mask changes: 1003130.0 / 11173962
choose client_indexes: [ 1  3  6 13 14], accoring to random
choose mask diff: [1356412.0, 1358276.0, 1355122.0, 1003130.0, 1365242.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.399916
Client Index = 13	Epoch: 1	Loss: 0.355394
Client Index = 13	Epoch: 2	Loss: 0.406033
Client Index = 13	Epoch: 3	Loss: 0.254204
Client Index = 13	Epoch: 4	Loss: 0.235825
test acc on this client after 367 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 14
local mask changes: 1002462.0 / 11173962
choose client_indexes: [ 1  4  8 14 16], accoring to random
choose mask diff: [1351202.0, 1340984.0, 1362154.0, 1002462.0, 1341280.0]
Doing local aggregation!
test acc on this client before 414 / 502 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.426307
Client Index = 14	Epoch: 1	Loss: 0.413841
Client Index = 14	Epoch: 2	Loss: 0.385796
Client Index = 14	Epoch: 3	Loss: 0.350421
Client Index = 14	Epoch: 4	Loss: 0.323935
test acc on this client after 344 / 502 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 15
local mask changes: 1002216.0 / 11173962
choose client_indexes: [ 7  8  9 14 15], accoring to random
choose mask diff: [1350278.0, 1350252.0, 1348694.0, 1365026.0, 1002216.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.310110
Client Index = 15	Epoch: 1	Loss: 0.288102
Client Index = 15	Epoch: 2	Loss: 0.243485
Client Index = 15	Epoch: 3	Loss: 0.214127
Client Index = 15	Epoch: 4	Loss: 0.238543
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 16
local mask changes: 1002630.0 / 11173962
choose client_indexes: [ 1  9 12 16 18], accoring to random
choose mask diff: [1347798.0, 1357894.0, 1355542.0, 1002630.0, 1350474.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.390565
Client Index = 16	Epoch: 1	Loss: 0.262710
Client Index = 16	Epoch: 2	Loss: 0.245438
Client Index = 16	Epoch: 3	Loss: 0.189560
Client Index = 16	Epoch: 4	Loss: 0.207677
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 17
local mask changes: 1002736.0 / 11173962
choose client_indexes: [ 0 11 12 16 17], accoring to random
choose mask diff: [1360716.0, 1348326.0, 1344046.0, 1343760.0, 1002736.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 17	Epoch: 0	Loss: 0.474208
Client Index = 17	Epoch: 1	Loss: 0.319653
Client Index = 17	Epoch: 2	Loss: 0.184318
Client Index = 17	Epoch: 3	Loss: 0.349299
Client Index = 17	Epoch: 4	Loss: 0.205789
test acc on this client after 420 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 18
local mask changes: 1002726.0 / 11173962
choose client_indexes: [ 1  8 14 18 19], accoring to random
choose mask diff: [1349612.0, 1348920.0, 1351718.0, 1002726.0, 1340082.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.345414
Client Index = 18	Epoch: 1	Loss: 0.295334
Client Index = 18	Epoch: 2	Loss: 0.220556
Client Index = 18	Epoch: 3	Loss: 0.245476
Client Index = 18	Epoch: 4	Loss: 0.256346
test acc on this client after 448 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(67) with spasity 0.5: 19
local mask changes: 1003206.0 / 11173962
choose client_indexes: [ 0  2  4 11 19], accoring to random
choose mask diff: [1367630.0, 1350192.0, 1362228.0, 1349544.0, 1003206.0]
Doing local aggregation!
test acc on this client before 383 / 506 : 0.76
Client Index = 19	Epoch: 0	Loss: 0.353684
Client Index = 19	Epoch: 1	Loss: 0.376800
Client Index = 19	Epoch: 2	Loss: 0.266466
Client Index = 19	Epoch: 3	Loss: 0.238898
Client Index = 19	Epoch: 4	Loss: 0.217290
test acc on this client after 385 / 506 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 67
{'test_acc': 0.8016864797499792, 'test_loss': 0.6520633532478413}
################local_test_on_all_clients before local training in communication round: 67
{'test_acc': 0.8149287032268395, 'test_loss': 0.5673953942512889}
################Communication round : 68
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 0
local mask changes: 956028.0 / 11173962
choose client_indexes: [ 0  1  2  7 19], accoring to random
choose mask diff: [956028.0, 1323958.0, 1327260.0, 1322380.0, 1333054.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.547870
Client Index = 0	Epoch: 1	Loss: 0.516413
Client Index = 0	Epoch: 2	Loss: 0.443370
Client Index = 0	Epoch: 3	Loss: 0.398000
Client Index = 0	Epoch: 4	Loss: 0.439636
test acc on this client after 341 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 1
local mask changes: 955576.0 / 11173962
choose client_indexes: [1 3 5 8 9], accoring to random
choose mask diff: [955576.0, 1322840.0, 1312732.0, 1313364.0, 1310878.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 1	Epoch: 0	Loss: 0.346216
Client Index = 1	Epoch: 1	Loss: 0.217088
Client Index = 1	Epoch: 2	Loss: 0.212858
Client Index = 1	Epoch: 3	Loss: 0.156340
Client Index = 1	Epoch: 4	Loss: 0.237280
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 2
local mask changes: 955196.0 / 11173962
choose client_indexes: [ 0  2  6  9 13], accoring to random
choose mask diff: [1326384.0, 955196.0, 1326994.0, 1314822.0, 1315784.0]
Doing local aggregation!
test acc on this client before 437 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.354456
Client Index = 2	Epoch: 1	Loss: 0.169280
Client Index = 2	Epoch: 2	Loss: 0.185962
Client Index = 2	Epoch: 3	Loss: 0.147807
Client Index = 2	Epoch: 4	Loss: 0.170642
test acc on this client after 448 / 502 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 3
local mask changes: 955472.0 / 11173962
choose client_indexes: [ 3  5  7  9 13], accoring to random
choose mask diff: [955472.0, 1326898.0, 1314268.0, 1326222.0, 1320586.0]
Doing local aggregation!
test acc on this client before 330 / 504 : 0.65
Client Index = 3	Epoch: 0	Loss: 0.591720
Client Index = 3	Epoch: 1	Loss: 0.413054
Client Index = 3	Epoch: 2	Loss: 0.485395
Client Index = 3	Epoch: 3	Loss: 0.311924
Client Index = 3	Epoch: 4	Loss: 0.445659
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 4
local mask changes: 955366.0 / 11173962
choose client_indexes: [ 4  5  6  8 17], accoring to random
choose mask diff: [955366.0, 1318808.0, 1315802.0, 1323562.0, 1303348.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.357841
Client Index = 4	Epoch: 1	Loss: 0.278287
Client Index = 4	Epoch: 2	Loss: 0.286208
Client Index = 4	Epoch: 3	Loss: 0.255655
Client Index = 4	Epoch: 4	Loss: 0.196243
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 5
local mask changes: 955436.0 / 11173962
choose client_indexes: [ 5  6  9 14 18], accoring to random
choose mask diff: [955436.0, 1321814.0, 1313252.0, 1323048.0, 1307260.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 5	Epoch: 0	Loss: 0.423748
Client Index = 5	Epoch: 1	Loss: 0.286766
Client Index = 5	Epoch: 2	Loss: 0.271097
Client Index = 5	Epoch: 3	Loss: 0.262354
Client Index = 5	Epoch: 4	Loss: 0.247166
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 6
local mask changes: 955012.0 / 11173962
choose client_indexes: [ 3  6  7 11 14], accoring to random
choose mask diff: [1328760.0, 955012.0, 1330238.0, 1324476.0, 1318868.0]
Doing local aggregation!
test acc on this client before 399 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.573593
Client Index = 6	Epoch: 1	Loss: 0.456600
Client Index = 6	Epoch: 2	Loss: 0.501540
Client Index = 6	Epoch: 3	Loss: 0.367182
Client Index = 6	Epoch: 4	Loss: 0.377841
test acc on this client after 397 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 7
local mask changes: 955072.0 / 11173962
choose client_indexes: [ 3  5  7 10 13], accoring to random
choose mask diff: [1316954.0, 1311268.0, 955072.0, 1311514.0, 1321092.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.365128
Client Index = 7	Epoch: 1	Loss: 0.259039
Client Index = 7	Epoch: 2	Loss: 0.310834
Client Index = 7	Epoch: 3	Loss: 0.208407
Client Index = 7	Epoch: 4	Loss: 0.437193
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 8
local mask changes: 955782.0 / 11173962
choose client_indexes: [ 7  8 12 15 18], accoring to random
choose mask diff: [1319706.0, 955782.0, 1319606.0, 1317026.0, 1315432.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.476742
Client Index = 8	Epoch: 1	Loss: 0.333908
Client Index = 8	Epoch: 2	Loss: 0.296054
Client Index = 8	Epoch: 3	Loss: 0.406646
Client Index = 8	Epoch: 4	Loss: 0.264076
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 9
local mask changes: 956064.0 / 11173962
choose client_indexes: [ 6  9 10 15 16], accoring to random
choose mask diff: [1323420.0, 956064.0, 1325218.0, 1310362.0, 1319086.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 9	Epoch: 0	Loss: 0.335159
Client Index = 9	Epoch: 1	Loss: 0.242305
Client Index = 9	Epoch: 2	Loss: 0.392755
Client Index = 9	Epoch: 3	Loss: 0.217536
Client Index = 9	Epoch: 4	Loss: 0.181364
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 10
local mask changes: 955364.0 / 11173962
choose client_indexes: [ 8 10 13 14 19], accoring to random
choose mask diff: [1319260.0, 955364.0, 1321208.0, 1331610.0, 1319516.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 10	Epoch: 0	Loss: 0.490557
Client Index = 10	Epoch: 1	Loss: 0.337083
Client Index = 10	Epoch: 2	Loss: 0.303959
Client Index = 10	Epoch: 3	Loss: 0.306375
Client Index = 10	Epoch: 4	Loss: 0.240484
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 11
local mask changes: 955818.0 / 11173962
choose client_indexes: [ 4  5 11 12 15], accoring to random
choose mask diff: [1308438.0, 1311894.0, 955818.0, 1315892.0, 1319348.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.297647
Client Index = 11	Epoch: 1	Loss: 0.204167
Client Index = 11	Epoch: 2	Loss: 0.149427
Client Index = 11	Epoch: 3	Loss: 0.234817
Client Index = 11	Epoch: 4	Loss: 0.131601
test acc on this client after 465 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 12
local mask changes: 954794.0 / 11173962
choose client_indexes: [ 0  1  4  6 12], accoring to random
choose mask diff: [1325890.0, 1309352.0, 1325868.0, 1331742.0, 954794.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 12	Epoch: 0	Loss: 0.410488
Client Index = 12	Epoch: 1	Loss: 0.373150
Client Index = 12	Epoch: 2	Loss: 0.293237
Client Index = 12	Epoch: 3	Loss: 0.249882
Client Index = 12	Epoch: 4	Loss: 0.299461
test acc on this client after 250 / 504 : 0.50
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 13
local mask changes: 955460.0 / 11173962
choose client_indexes: [ 1 10 13 14 16], accoring to random
choose mask diff: [1318394.0, 1328362.0, 955460.0, 1324848.0, 1325534.0]
Doing local aggregation!
test acc on this client before 397 / 503 : 0.79
Client Index = 13	Epoch: 0	Loss: 0.397947
Client Index = 13	Epoch: 1	Loss: 0.312612
Client Index = 13	Epoch: 2	Loss: 0.349073
Client Index = 13	Epoch: 3	Loss: 0.258846
Client Index = 13	Epoch: 4	Loss: 0.279111
test acc on this client after 394 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 14
local mask changes: 955268.0 / 11173962
choose client_indexes: [ 2  6  7 14 17], accoring to random
choose mask diff: [1321224.0, 1320270.0, 1325926.0, 955268.0, 1319370.0]
Doing local aggregation!
test acc on this client before 396 / 502 : 0.79
Client Index = 14	Epoch: 0	Loss: 0.536073
Client Index = 14	Epoch: 1	Loss: 0.391886
Client Index = 14	Epoch: 2	Loss: 0.331603
Client Index = 14	Epoch: 3	Loss: 0.406589
Client Index = 14	Epoch: 4	Loss: 0.324843
test acc on this client after 400 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 15
local mask changes: 954612.0 / 11173962
choose client_indexes: [ 2  6 10 15 18], accoring to random
choose mask diff: [1313198.0, 1331310.0, 1326818.0, 954612.0, 1321484.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.283785
Client Index = 15	Epoch: 1	Loss: 0.357285
Client Index = 15	Epoch: 2	Loss: 0.228115
Client Index = 15	Epoch: 3	Loss: 0.300059
Client Index = 15	Epoch: 4	Loss: 0.199703
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 16
local mask changes: 955880.0 / 11173962
choose client_indexes: [ 0  3 16 18 19], accoring to random
choose mask diff: [1336960.0, 1325424.0, 955880.0, 1309584.0, 1321860.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.416403
Client Index = 16	Epoch: 1	Loss: 0.264555
Client Index = 16	Epoch: 2	Loss: 0.234366
Client Index = 16	Epoch: 3	Loss: 0.343492
Client Index = 16	Epoch: 4	Loss: 0.220573
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 17
local mask changes: 956052.0 / 11173962
choose client_indexes: [ 0  3  5 14 17], accoring to random
choose mask diff: [1322348.0, 1321496.0, 1305948.0, 1319652.0, 956052.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.402091
Client Index = 17	Epoch: 1	Loss: 0.276744
Client Index = 17	Epoch: 2	Loss: 0.208538
Client Index = 17	Epoch: 3	Loss: 0.210825
Client Index = 17	Epoch: 4	Loss: 0.172262
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 18
local mask changes: 955882.0 / 11173962
choose client_indexes: [ 1  9 12 15 18], accoring to random
choose mask diff: [1308784.0, 1310398.0, 1313924.0, 1319688.0, 955882.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.368913
Client Index = 18	Epoch: 1	Loss: 0.249644
Client Index = 18	Epoch: 2	Loss: 0.270602
Client Index = 18	Epoch: 3	Loss: 0.219232
Client Index = 18	Epoch: 4	Loss: 0.274262
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(68) with spasity 0.5: 19
local mask changes: 955564.0 / 11173962
choose client_indexes: [ 3  5  9 13 19], accoring to random
choose mask diff: [1311964.0, 1312880.0, 1314312.0, 1324678.0, 955564.0]
Doing local aggregation!
test acc on this client before 396 / 506 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.285866
Client Index = 19	Epoch: 1	Loss: 0.346436
Client Index = 19	Epoch: 2	Loss: 0.278016
Client Index = 19	Epoch: 3	Loss: 0.208247
Client Index = 19	Epoch: 4	Loss: 0.250474
test acc on this client after 400 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 68
{'test_acc': 0.8017126220331535, 'test_loss': 0.6392673788862926}
################local_test_on_all_clients before local training in communication round: 68
{'test_acc': 0.8036973039417601, 'test_loss': 0.5997620407037401}
################Communication round : 69
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 0
local mask changes: 909304.0 / 11173962
choose client_indexes: [ 0  3  7  8 15], accoring to random
choose mask diff: [909304.0, 1296474.0, 1285094.0, 1297112.0, 1290138.0]
Doing local aggregation!
test acc on this client before 368 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.514439
Client Index = 0	Epoch: 1	Loss: 0.512954
Client Index = 0	Epoch: 2	Loss: 0.432490
Client Index = 0	Epoch: 3	Loss: 0.362287
Client Index = 0	Epoch: 4	Loss: 0.440034
test acc on this client after 265 / 504 : 0.53
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 1
local mask changes: 909438.0 / 11173962
choose client_indexes: [ 0  1  2 11 13], accoring to random
choose mask diff: [1290068.0, 909438.0, 1270916.0, 1273422.0, 1281686.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.263542
Client Index = 1	Epoch: 1	Loss: 0.264627
Client Index = 1	Epoch: 2	Loss: 0.231553
Client Index = 1	Epoch: 3	Loss: 0.164583
Client Index = 1	Epoch: 4	Loss: 0.207225
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 2
local mask changes: 910058.0 / 11173962
choose client_indexes: [ 2  3  9 10 11], accoring to random
choose mask diff: [910058.0, 1281772.0, 1276020.0, 1281694.0, 1275636.0]
Doing local aggregation!
test acc on this client before 424 / 502 : 0.84
Client Index = 2	Epoch: 0	Loss: 0.339451
Client Index = 2	Epoch: 1	Loss: 0.216514
Client Index = 2	Epoch: 2	Loss: 0.154649
Client Index = 2	Epoch: 3	Loss: 0.131440
Client Index = 2	Epoch: 4	Loss: 0.159445
test acc on this client after 380 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 3
local mask changes: 909434.0 / 11173962
choose client_indexes: [ 0  3  6 15 19], accoring to random
choose mask diff: [1297042.0, 909434.0, 1290892.0, 1299680.0, 1277888.0]
Doing local aggregation!
test acc on this client before 388 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.453567
Client Index = 3	Epoch: 1	Loss: 0.445118
Client Index = 3	Epoch: 2	Loss: 0.409089
Client Index = 3	Epoch: 3	Loss: 0.391840
Client Index = 3	Epoch: 4	Loss: 0.392594
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 4
local mask changes: 909298.0 / 11173962
choose client_indexes: [ 4  6  8 18 19], accoring to random
choose mask diff: [909298.0, 1277258.0, 1283064.0, 1280144.0, 1281460.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.391400
Client Index = 4	Epoch: 1	Loss: 0.268346
Client Index = 4	Epoch: 2	Loss: 0.274212
Client Index = 4	Epoch: 3	Loss: 0.175574
Client Index = 4	Epoch: 4	Loss: 0.344339
test acc on this client after 400 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 5
local mask changes: 910040.0 / 11173962
choose client_indexes: [ 5  7  8 15 17], accoring to random
choose mask diff: [910040.0, 1273370.0, 1276920.0, 1279812.0, 1274448.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.433971
Client Index = 5	Epoch: 1	Loss: 0.281838
Client Index = 5	Epoch: 2	Loss: 0.238451
Client Index = 5	Epoch: 3	Loss: 0.304891
Client Index = 5	Epoch: 4	Loss: 0.184178
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 6
local mask changes: 909180.0 / 11173962
choose client_indexes: [ 0  2  6 11 12], accoring to random
choose mask diff: [1292294.0, 1294580.0, 909180.0, 1285244.0, 1300878.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.599867
Client Index = 6	Epoch: 1	Loss: 0.444040
Client Index = 6	Epoch: 2	Loss: 0.418962
Client Index = 6	Epoch: 3	Loss: 0.416380
Client Index = 6	Epoch: 4	Loss: 0.396709
test acc on this client after 406 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 7
local mask changes: 909398.0 / 11173962
choose client_indexes: [ 1  7  8 10 18], accoring to random
choose mask diff: [1278760.0, 909398.0, 1283830.0, 1274452.0, 1282076.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 7	Epoch: 0	Loss: 0.456109
Client Index = 7	Epoch: 1	Loss: 0.296589
Client Index = 7	Epoch: 2	Loss: 0.253332
Client Index = 7	Epoch: 3	Loss: 0.265594
Client Index = 7	Epoch: 4	Loss: 0.186469
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 8
local mask changes: 908962.0 / 11173962
choose client_indexes: [ 8  9 11 13 14], accoring to random
choose mask diff: [908962.0, 1288850.0, 1276404.0, 1290044.0, 1287268.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 8	Epoch: 0	Loss: 0.502941
Client Index = 8	Epoch: 1	Loss: 0.365545
Client Index = 8	Epoch: 2	Loss: 0.375035
Client Index = 8	Epoch: 3	Loss: 0.270809
Client Index = 8	Epoch: 4	Loss: 0.310025
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 9
local mask changes: 909812.0 / 11173962
choose client_indexes: [ 9 13 15 17 19], accoring to random
choose mask diff: [909812.0, 1286824.0, 1268208.0, 1272042.0, 1278538.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 9	Epoch: 0	Loss: 0.321345
Client Index = 9	Epoch: 1	Loss: 0.275781
Client Index = 9	Epoch: 2	Loss: 0.253746
Client Index = 9	Epoch: 3	Loss: 0.253634
Client Index = 9	Epoch: 4	Loss: 0.190763
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 10
local mask changes: 910340.0 / 11173962
choose client_indexes: [ 6 10 12 14 17], accoring to random
choose mask diff: [1303786.0, 910340.0, 1289514.0, 1292284.0, 1283196.0]
Doing local aggregation!
test acc on this client before 401 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.445575
Client Index = 10	Epoch: 1	Loss: 0.303698
Client Index = 10	Epoch: 2	Loss: 0.351780
Client Index = 10	Epoch: 3	Loss: 0.233180
Client Index = 10	Epoch: 4	Loss: 0.293478
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 11
local mask changes: 908966.0 / 11173962
choose client_indexes: [ 0  4  5 11 14], accoring to random
choose mask diff: [1283198.0, 1267684.0, 1271524.0, 908966.0, 1279474.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.301176
Client Index = 11	Epoch: 1	Loss: 0.182422
Client Index = 11	Epoch: 2	Loss: 0.230329
Client Index = 11	Epoch: 3	Loss: 0.138582
Client Index = 11	Epoch: 4	Loss: 0.172153
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 12
local mask changes: 910160.0 / 11173962
choose client_indexes: [ 1  3  5  7 12], accoring to random
choose mask diff: [1272232.0, 1287778.0, 1281136.0, 1289084.0, 910160.0]
Doing local aggregation!
test acc on this client before 356 / 504 : 0.71
Client Index = 12	Epoch: 0	Loss: 0.432471
Client Index = 12	Epoch: 1	Loss: 0.302817
Client Index = 12	Epoch: 2	Loss: 0.289769
Client Index = 12	Epoch: 3	Loss: 0.305645
Client Index = 12	Epoch: 4	Loss: 0.285600
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 13
local mask changes: 909338.0 / 11173962
choose client_indexes: [ 4  9 11 13 17], accoring to random
choose mask diff: [1284278.0, 1287762.0, 1286036.0, 909338.0, 1281240.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.386522
Client Index = 13	Epoch: 1	Loss: 0.402901
Client Index = 13	Epoch: 2	Loss: 0.291890
Client Index = 13	Epoch: 3	Loss: 0.373100
Client Index = 13	Epoch: 4	Loss: 0.266988
test acc on this client after 392 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 14
local mask changes: 909764.0 / 11173962
choose client_indexes: [ 2 11 12 14 17], accoring to random
choose mask diff: [1281462.0, 1283040.0, 1292954.0, 909764.0, 1280054.0]
Doing local aggregation!
test acc on this client before 409 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.432532
Client Index = 14	Epoch: 1	Loss: 0.334197
Client Index = 14	Epoch: 2	Loss: 0.343914
Client Index = 14	Epoch: 3	Loss: 0.347832
Client Index = 14	Epoch: 4	Loss: 0.371635
test acc on this client after 392 / 502 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 15
local mask changes: 909306.0 / 11173962
choose client_indexes: [ 3  5  8  9 15], accoring to random
choose mask diff: [1298390.0, 1280300.0, 1279254.0, 1274368.0, 909306.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.290805
Client Index = 15	Epoch: 1	Loss: 0.251029
Client Index = 15	Epoch: 2	Loss: 0.239710
Client Index = 15	Epoch: 3	Loss: 0.261277
Client Index = 15	Epoch: 4	Loss: 0.190956
test acc on this client after 401 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 16
local mask changes: 908906.0 / 11173962
choose client_indexes: [ 0  2  3 16 18], accoring to random
choose mask diff: [1295550.0, 1278158.0, 1286406.0, 908906.0, 1267770.0]
Doing local aggregation!
test acc on this client before 436 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.319957
Client Index = 16	Epoch: 1	Loss: 0.357701
Client Index = 16	Epoch: 2	Loss: 0.214141
Client Index = 16	Epoch: 3	Loss: 0.245629
Client Index = 16	Epoch: 4	Loss: 0.215312
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 17
local mask changes: 909512.0 / 11173962
choose client_indexes: [ 1  6  7 11 17], accoring to random
choose mask diff: [1261992.0, 1291758.0, 1280648.0, 1271974.0, 909512.0]
Doing local aggregation!
test acc on this client before 366 / 505 : 0.72
Client Index = 17	Epoch: 0	Loss: 0.421321
Client Index = 17	Epoch: 1	Loss: 0.324954
Client Index = 17	Epoch: 2	Loss: 0.204841
Client Index = 17	Epoch: 3	Loss: 0.164581
Client Index = 17	Epoch: 4	Loss: 0.299426
test acc on this client after 443 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 18
local mask changes: 908712.0 / 11173962
choose client_indexes: [ 2  9 13 18 19], accoring to random
choose mask diff: [1273054.0, 1269752.0, 1282604.0, 908712.0, 1269626.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.335606
Client Index = 18	Epoch: 1	Loss: 0.345765
Client Index = 18	Epoch: 2	Loss: 0.241270
Client Index = 18	Epoch: 3	Loss: 0.210509
Client Index = 18	Epoch: 4	Loss: 0.214794
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(69) with spasity 0.5: 19
local mask changes: 909108.0 / 11173962
choose client_indexes: [ 7 13 14 17 19], accoring to random
choose mask diff: [1284182.0, 1284504.0, 1299500.0, 1278028.0, 909108.0]
Doing local aggregation!
test acc on this client before 402 / 506 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.350807
Client Index = 19	Epoch: 1	Loss: 0.290638
Client Index = 19	Epoch: 2	Loss: 0.253975
Client Index = 19	Epoch: 3	Loss: 0.212149
Client Index = 19	Epoch: 4	Loss: 0.461764
test acc on this client after 413 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 69
{'test_acc': 0.7957087505338307, 'test_loss': 0.6689987143173459}
################local_test_on_all_clients before local training in communication round: 69
{'test_acc': 0.8086688407935918, 'test_loss': 0.5835058257006479}
################Communication round : 70
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 0
local mask changes: 863272.0 / 11173962
choose client_indexes: [ 0  2  5 14 18], accoring to random
choose mask diff: [863272.0, 1250852.0, 1266916.0, 1268952.0, 1256074.0]
Doing local aggregation!
test acc on this client before 342 / 504 : 0.68
Client Index = 0	Epoch: 0	Loss: 0.621439
Client Index = 0	Epoch: 1	Loss: 0.467684
Client Index = 0	Epoch: 2	Loss: 0.393262
Client Index = 0	Epoch: 3	Loss: 0.454855
Client Index = 0	Epoch: 4	Loss: 0.411281
test acc on this client after 374 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 1
local mask changes: 863460.0 / 11173962
choose client_indexes: [ 1  4 15 16 19], accoring to random
choose mask diff: [863460.0, 1244240.0, 1244544.0, 1237926.0, 1245284.0]
Doing local aggregation!
test acc on this client before 408 / 503 : 0.81
Client Index = 1	Epoch: 0	Loss: 0.290265
Client Index = 1	Epoch: 1	Loss: 0.175022
Client Index = 1	Epoch: 2	Loss: 0.349202
Client Index = 1	Epoch: 3	Loss: 0.143839
Client Index = 1	Epoch: 4	Loss: 0.181820
test acc on this client after 450 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 2
local mask changes: 863268.0 / 11173962
choose client_indexes: [ 0  2 12 14 17], accoring to random
choose mask diff: [1250794.0, 863268.0, 1251570.0, 1248646.0, 1232084.0]
Doing local aggregation!
test acc on this client before 418 / 502 : 0.83
Client Index = 2	Epoch: 0	Loss: 0.253302
Client Index = 2	Epoch: 1	Loss: 0.213968
Client Index = 2	Epoch: 2	Loss: 0.190546
Client Index = 2	Epoch: 3	Loss: 0.267534
Client Index = 2	Epoch: 4	Loss: 0.115801
test acc on this client after 436 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 3
local mask changes: 863176.0 / 11173962
choose client_indexes: [ 3  4  7  9 18], accoring to random
choose mask diff: [863176.0, 1257620.0, 1238248.0, 1251386.0, 1253432.0]
Doing local aggregation!
test acc on this client before 359 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.535684
Client Index = 3	Epoch: 1	Loss: 0.427314
Client Index = 3	Epoch: 2	Loss: 0.425783
Client Index = 3	Epoch: 3	Loss: 0.332071
Client Index = 3	Epoch: 4	Loss: 0.357769
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 4
local mask changes: 863410.0 / 11173962
choose client_indexes: [ 4  6 10 11 15], accoring to random
choose mask diff: [863410.0, 1239746.0, 1254054.0, 1234934.0, 1253428.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.440024
Client Index = 4	Epoch: 1	Loss: 0.271570
Client Index = 4	Epoch: 2	Loss: 0.183252
Client Index = 4	Epoch: 3	Loss: 0.278860
Client Index = 4	Epoch: 4	Loss: 0.205536
test acc on this client after 374 / 503 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 5
local mask changes: 862898.0 / 11173962
choose client_indexes: [ 5 11 12 15 17], accoring to random
choose mask diff: [862898.0, 1240342.0, 1248616.0, 1240474.0, 1230608.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.327523
Client Index = 5	Epoch: 1	Loss: 0.283445
Client Index = 5	Epoch: 2	Loss: 0.228587
Client Index = 5	Epoch: 3	Loss: 0.221743
Client Index = 5	Epoch: 4	Loss: 0.200153
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 6
local mask changes: 862890.0 / 11173962
choose client_indexes: [ 0  3  6 17 19], accoring to random
choose mask diff: [1253826.0, 1254964.0, 862890.0, 1259422.0, 1260658.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.501894
Client Index = 6	Epoch: 1	Loss: 0.406573
Client Index = 6	Epoch: 2	Loss: 0.548377
Client Index = 6	Epoch: 3	Loss: 0.374936
Client Index = 6	Epoch: 4	Loss: 0.365965
test acc on this client after 380 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 7
local mask changes: 863794.0 / 11173962
choose client_indexes: [ 0  6  7  9 12], accoring to random
choose mask diff: [1254058.0, 1251840.0, 863794.0, 1251996.0, 1254502.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.502187
Client Index = 7	Epoch: 1	Loss: 0.249715
Client Index = 7	Epoch: 2	Loss: 0.269520
Client Index = 7	Epoch: 3	Loss: 0.327534
Client Index = 7	Epoch: 4	Loss: 0.224738
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 8
local mask changes: 863174.0 / 11173962
choose client_indexes: [ 5  6  8 17 18], accoring to random
choose mask diff: [1243944.0, 1258006.0, 863174.0, 1244356.0, 1239870.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.424445
Client Index = 8	Epoch: 1	Loss: 0.313099
Client Index = 8	Epoch: 2	Loss: 0.568946
Client Index = 8	Epoch: 3	Loss: 0.306542
Client Index = 8	Epoch: 4	Loss: 0.232784
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 9
local mask changes: 863426.0 / 11173962
choose client_indexes: [ 1  5  9 11 19], accoring to random
choose mask diff: [1237030.0, 1239492.0, 863426.0, 1242642.0, 1234670.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.353839
Client Index = 9	Epoch: 1	Loss: 0.323599
Client Index = 9	Epoch: 2	Loss: 0.212583
Client Index = 9	Epoch: 3	Loss: 0.206738
Client Index = 9	Epoch: 4	Loss: 0.178948
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 10
local mask changes: 863470.0 / 11173962
choose client_indexes: [ 2  4 10 12 15], accoring to random
choose mask diff: [1250464.0, 1254332.0, 863470.0, 1253758.0, 1256404.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 10	Epoch: 0	Loss: 0.355748
Client Index = 10	Epoch: 1	Loss: 0.414555
Client Index = 10	Epoch: 2	Loss: 0.270347
Client Index = 10	Epoch: 3	Loss: 0.343689
Client Index = 10	Epoch: 4	Loss: 0.211349
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 11
local mask changes: 863314.0 / 11173962
choose client_indexes: [ 4  8 11 15 17], accoring to random
choose mask diff: [1229010.0, 1241578.0, 863314.0, 1245892.0, 1234538.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.313018
Client Index = 11	Epoch: 1	Loss: 0.159153
Client Index = 11	Epoch: 2	Loss: 0.196930
Client Index = 11	Epoch: 3	Loss: 0.288558
Client Index = 11	Epoch: 4	Loss: 0.120462
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 12
local mask changes: 863318.0 / 11173962
choose client_indexes: [ 2  7 10 12 18], accoring to random
choose mask diff: [1250456.0, 1250562.0, 1256564.0, 863318.0, 1242754.0]
Doing local aggregation!
test acc on this client before 369 / 504 : 0.73
Client Index = 12	Epoch: 0	Loss: 0.491364
Client Index = 12	Epoch: 1	Loss: 0.321752
Client Index = 12	Epoch: 2	Loss: 0.273268
Client Index = 12	Epoch: 3	Loss: 0.261731
Client Index = 12	Epoch: 4	Loss: 0.277505
test acc on this client after 394 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 13
local mask changes: 863296.0 / 11173962
choose client_indexes: [ 0  2  8 13 17], accoring to random
choose mask diff: [1265328.0, 1244200.0, 1256590.0, 863296.0, 1241564.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 13	Epoch: 0	Loss: 0.371234
Client Index = 13	Epoch: 1	Loss: 0.326258
Client Index = 13	Epoch: 2	Loss: 0.303411
Client Index = 13	Epoch: 3	Loss: 0.276433
Client Index = 13	Epoch: 4	Loss: 0.218891
test acc on this client after 361 / 503 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 14
local mask changes: 863678.0 / 11173962
choose client_indexes: [ 2  3  5 14 17], accoring to random
choose mask diff: [1243874.0, 1262726.0, 1249934.0, 863678.0, 1237826.0]
Doing local aggregation!
test acc on this client before 409 / 502 : 0.81
Client Index = 14	Epoch: 0	Loss: 0.441307
Client Index = 14	Epoch: 1	Loss: 0.457118
Client Index = 14	Epoch: 2	Loss: 0.323206
Client Index = 14	Epoch: 3	Loss: 0.369679
Client Index = 14	Epoch: 4	Loss: 0.301206
test acc on this client after 425 / 502 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 15
local mask changes: 863478.0 / 11173962
choose client_indexes: [ 0  1  9 12 15], accoring to random
choose mask diff: [1259032.0, 1244562.0, 1232632.0, 1248622.0, 863478.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.309952
Client Index = 15	Epoch: 1	Loss: 0.312667
Client Index = 15	Epoch: 2	Loss: 0.213859
Client Index = 15	Epoch: 3	Loss: 0.202969
Client Index = 15	Epoch: 4	Loss: 0.172036
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 16
local mask changes: 863638.0 / 11173962
choose client_indexes: [ 7  9 10 12 16], accoring to random
choose mask diff: [1252802.0, 1243304.0, 1257222.0, 1251704.0, 863638.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 16	Epoch: 0	Loss: 0.314382
Client Index = 16	Epoch: 1	Loss: 0.277223
Client Index = 16	Epoch: 2	Loss: 0.221235
Client Index = 16	Epoch: 3	Loss: 0.199225
Client Index = 16	Epoch: 4	Loss: 0.380108
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 17
local mask changes: 863314.0 / 11173962
choose client_indexes: [ 5  6 10 14 17], accoring to random
choose mask diff: [1234926.0, 1250002.0, 1248178.0, 1242156.0, 863314.0]
Doing local aggregation!
test acc on this client before 365 / 505 : 0.72
Client Index = 17	Epoch: 0	Loss: 0.477913
Client Index = 17	Epoch: 1	Loss: 0.271223
Client Index = 17	Epoch: 2	Loss: 0.269125
Client Index = 17	Epoch: 3	Loss: 0.189686
Client Index = 17	Epoch: 4	Loss: 0.326329
test acc on this client after 447 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 18
local mask changes: 863058.0 / 11173962
choose client_indexes: [ 3  4  5  9 18], accoring to random
choose mask diff: [1250452.0, 1247606.0, 1234340.0, 1230600.0, 863058.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.336924
Client Index = 18	Epoch: 1	Loss: 0.295962
Client Index = 18	Epoch: 2	Loss: 0.237945
Client Index = 18	Epoch: 3	Loss: 0.198678
Client Index = 18	Epoch: 4	Loss: 0.212977
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(70) with spasity 0.5: 19
local mask changes: 864100.0 / 11173962
choose client_indexes: [ 4  6  7 16 19], accoring to random
choose mask diff: [1251250.0, 1260536.0, 1245166.0, 1252534.0, 864100.0]
Doing local aggregation!
test acc on this client before 347 / 506 : 0.69
Client Index = 19	Epoch: 0	Loss: 0.364622
Client Index = 19	Epoch: 1	Loss: 0.245795
Client Index = 19	Epoch: 2	Loss: 0.323601
Client Index = 19	Epoch: 3	Loss: 0.194940
Client Index = 19	Epoch: 4	Loss: 0.384584
test acc on this client after 409 / 506 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 70
{'test_acc': 0.8106321506139317, 'test_loss': 0.6053988651256973}
################local_test_on_all_clients before local training in communication round: 70
{'test_acc': 0.7969726211995033, 'test_loss': 0.6239531064170729}
################Communication round : 71
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 0
local mask changes: 817988.0 / 11173962
choose client_indexes: [ 0  5  8 14 18], accoring to random
choose mask diff: [817988.0, 1226938.0, 1229456.0, 1230758.0, 1217884.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.508851
Client Index = 0	Epoch: 1	Loss: 0.412292
Client Index = 0	Epoch: 2	Loss: 0.471746
Client Index = 0	Epoch: 3	Loss: 0.465482
Client Index = 0	Epoch: 4	Loss: 0.371891
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 1
local mask changes: 818264.0 / 11173962
choose client_indexes: [ 1  5  7 10 18], accoring to random
choose mask diff: [818264.0, 1206796.0, 1206464.0, 1210052.0, 1200786.0]
Doing local aggregation!
test acc on this client before 433 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.348340
Client Index = 1	Epoch: 1	Loss: 0.207851
Client Index = 1	Epoch: 2	Loss: 0.160656
Client Index = 1	Epoch: 3	Loss: 0.131551
Client Index = 1	Epoch: 4	Loss: 0.308104
test acc on this client after 447 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 2
local mask changes: 817608.0 / 11173962
choose client_indexes: [ 2  4  5  6 18], accoring to random
choose mask diff: [817608.0, 1208250.0, 1214832.0, 1215646.0, 1203600.0]
Doing local aggregation!
test acc on this client before 385 / 502 : 0.77
Client Index = 2	Epoch: 0	Loss: 0.389435
Client Index = 2	Epoch: 1	Loss: 0.188219
Client Index = 2	Epoch: 2	Loss: 0.188602
Client Index = 2	Epoch: 3	Loss: 0.139871
Client Index = 2	Epoch: 4	Loss: 0.157946
test acc on this client after 442 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 3
local mask changes: 817684.0 / 11173962
choose client_indexes: [ 3  9 15 18 19], accoring to random
choose mask diff: [817684.0, 1211180.0, 1222534.0, 1213116.0, 1205892.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.485086
Client Index = 3	Epoch: 1	Loss: 0.390183
Client Index = 3	Epoch: 2	Loss: 0.454849
Client Index = 3	Epoch: 3	Loss: 0.382255
Client Index = 3	Epoch: 4	Loss: 0.291326
test acc on this client after 404 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 4
local mask changes: 817654.0 / 11173962
choose client_indexes: [ 4  7 12 13 17], accoring to random
choose mask diff: [817654.0, 1213644.0, 1219782.0, 1212760.0, 1203334.0]
Doing local aggregation!
test acc on this client before 350 / 503 : 0.70
Client Index = 4	Epoch: 0	Loss: 0.482948
Client Index = 4	Epoch: 1	Loss: 0.277157
Client Index = 4	Epoch: 2	Loss: 0.237143
Client Index = 4	Epoch: 3	Loss: 0.191878
Client Index = 4	Epoch: 4	Loss: 0.171483
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 5
local mask changes: 818220.0 / 11173962
choose client_indexes: [ 5  8 12 13 18], accoring to random
choose mask diff: [818220.0, 1206374.0, 1205178.0, 1220192.0, 1202954.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 5	Epoch: 0	Loss: 0.353970
Client Index = 5	Epoch: 1	Loss: 0.257270
Client Index = 5	Epoch: 2	Loss: 0.296451
Client Index = 5	Epoch: 3	Loss: 0.200625
Client Index = 5	Epoch: 4	Loss: 0.274302
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 6
local mask changes: 817608.0 / 11173962
choose client_indexes: [ 3  5  6 13 19], accoring to random
choose mask diff: [1213166.0, 1221000.0, 817608.0, 1219274.0, 1224720.0]
Doing local aggregation!
test acc on this client before 388 / 505 : 0.77
Client Index = 6	Epoch: 0	Loss: 0.609949
Client Index = 6	Epoch: 1	Loss: 0.389052
Client Index = 6	Epoch: 2	Loss: 0.501523
Client Index = 6	Epoch: 3	Loss: 0.296558
Client Index = 6	Epoch: 4	Loss: 0.360182
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 7
local mask changes: 817642.0 / 11173962
choose client_indexes: [ 7  8 12 18 19], accoring to random
choose mask diff: [817642.0, 1208780.0, 1211718.0, 1209768.0, 1216356.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.357591
Client Index = 7	Epoch: 1	Loss: 0.390486
Client Index = 7	Epoch: 2	Loss: 0.240251
Client Index = 7	Epoch: 3	Loss: 0.207308
Client Index = 7	Epoch: 4	Loss: 0.376280
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 8
local mask changes: 818094.0 / 11173962
choose client_indexes: [ 0  2  8 13 14], accoring to random
choose mask diff: [1229310.0, 1214716.0, 818094.0, 1218534.0, 1216630.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.526923
Client Index = 8	Epoch: 1	Loss: 0.282589
Client Index = 8	Epoch: 2	Loss: 0.353301
Client Index = 8	Epoch: 3	Loss: 0.294996
Client Index = 8	Epoch: 4	Loss: 0.331220
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 9
local mask changes: 817484.0 / 11173962
choose client_indexes: [ 1  9 14 16 17], accoring to random
choose mask diff: [1199590.0, 817484.0, 1212882.0, 1211646.0, 1198332.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.316902
Client Index = 9	Epoch: 1	Loss: 0.271173
Client Index = 9	Epoch: 2	Loss: 0.241767
Client Index = 9	Epoch: 3	Loss: 0.197930
Client Index = 9	Epoch: 4	Loss: 0.162404
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 10
local mask changes: 818080.0 / 11173962
choose client_indexes: [ 1  9 10 16 17], accoring to random
choose mask diff: [1211122.0, 1222280.0, 818080.0, 1225558.0, 1213384.0]
Doing local aggregation!
test acc on this client before 400 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.388253
Client Index = 10	Epoch: 1	Loss: 0.330088
Client Index = 10	Epoch: 2	Loss: 0.252332
Client Index = 10	Epoch: 3	Loss: 0.254978
Client Index = 10	Epoch: 4	Loss: 0.360719
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 11
local mask changes: 817902.0 / 11173962
choose client_indexes: [ 0  6  8 11 17], accoring to random
choose mask diff: [1217342.0, 1213386.0, 1198540.0, 817902.0, 1192908.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.286605
Client Index = 11	Epoch: 1	Loss: 0.201842
Client Index = 11	Epoch: 2	Loss: 0.149130
Client Index = 11	Epoch: 3	Loss: 0.267126
Client Index = 11	Epoch: 4	Loss: 0.102899
test acc on this client after 462 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 12
local mask changes: 817226.0 / 11173962
choose client_indexes: [ 4  7 12 18 19], accoring to random
choose mask diff: [1220410.0, 1211224.0, 817226.0, 1206062.0, 1224206.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 12	Epoch: 0	Loss: 0.335062
Client Index = 12	Epoch: 1	Loss: 0.329856
Client Index = 12	Epoch: 2	Loss: 0.242047
Client Index = 12	Epoch: 3	Loss: 0.275969
Client Index = 12	Epoch: 4	Loss: 0.478215
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 13
local mask changes: 818078.0 / 11173962
choose client_indexes: [ 4  9 10 13 17], accoring to random
choose mask diff: [1213854.0, 1210550.0, 1218344.0, 818078.0, 1204538.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.352409
Client Index = 13	Epoch: 1	Loss: 0.373640
Client Index = 13	Epoch: 2	Loss: 0.286733
Client Index = 13	Epoch: 3	Loss: 0.460158
Client Index = 13	Epoch: 4	Loss: 0.214014
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 14
local mask changes: 818554.0 / 11173962
choose client_indexes: [ 3 10 13 14 15], accoring to random
choose mask diff: [1223584.0, 1222234.0, 1219898.0, 818554.0, 1223860.0]
Doing local aggregation!
test acc on this client before 419 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.459293
Client Index = 14	Epoch: 1	Loss: 0.360640
Client Index = 14	Epoch: 2	Loss: 0.309111
Client Index = 14	Epoch: 3	Loss: 0.375612
Client Index = 14	Epoch: 4	Loss: 0.453072
test acc on this client after 392 / 502 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 15
local mask changes: 818116.0 / 11173962
choose client_indexes: [ 2  9 10 15 17], accoring to random
choose mask diff: [1211408.0, 1192474.0, 1225074.0, 818116.0, 1213534.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.335906
Client Index = 15	Epoch: 1	Loss: 0.227541
Client Index = 15	Epoch: 2	Loss: 0.254487
Client Index = 15	Epoch: 3	Loss: 0.176870
Client Index = 15	Epoch: 4	Loss: 0.259014
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 16
local mask changes: 817636.0 / 11173962
choose client_indexes: [ 2  9 15 16 18], accoring to random
choose mask diff: [1208476.0, 1207130.0, 1222776.0, 817636.0, 1200356.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 16	Epoch: 0	Loss: 0.400050
Client Index = 16	Epoch: 1	Loss: 0.284368
Client Index = 16	Epoch: 2	Loss: 0.216574
Client Index = 16	Epoch: 3	Loss: 0.243261
Client Index = 16	Epoch: 4	Loss: 0.178091
test acc on this client after 419 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 17
local mask changes: 817686.0 / 11173962
choose client_indexes: [ 2  3  8  9 17], accoring to random
choose mask diff: [1200588.0, 1216934.0, 1213036.0, 1201072.0, 817686.0]
Doing local aggregation!
test acc on this client before 414 / 505 : 0.82
Client Index = 17	Epoch: 0	Loss: 0.439388
Client Index = 17	Epoch: 1	Loss: 0.274569
Client Index = 17	Epoch: 2	Loss: 0.175025
Client Index = 17	Epoch: 3	Loss: 0.248589
Client Index = 17	Epoch: 4	Loss: 0.146856
test acc on this client after 432 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 18
local mask changes: 817176.0 / 11173962
choose client_indexes: [ 2  3  4 13 18], accoring to random
choose mask diff: [1204256.0, 1210598.0, 1204608.0, 1210044.0, 817176.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.353749
Client Index = 18	Epoch: 1	Loss: 0.245272
Client Index = 18	Epoch: 2	Loss: 0.264212
Client Index = 18	Epoch: 3	Loss: 0.207052
Client Index = 18	Epoch: 4	Loss: 0.201463
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(71) with spasity 0.5: 19
local mask changes: 818198.0 / 11173962
choose client_indexes: [ 0 14 17 18 19], accoring to random
choose mask diff: [1226284.0, 1227862.0, 1208034.0, 1202120.0, 818198.0]
Doing local aggregation!
test acc on this client before 418 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.293320
Client Index = 19	Epoch: 1	Loss: 0.338906
Client Index = 19	Epoch: 2	Loss: 0.290079
Client Index = 19	Epoch: 3	Loss: 0.184070
Client Index = 19	Epoch: 4	Loss: 0.198536
test acc on this client after 398 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 71
{'test_acc': 0.8288963278512016, 'test_loss': 0.5402802220679843}
################local_test_on_all_clients before local training in communication round: 71
{'test_acc': 0.8121012685684729, 'test_loss': 0.5897958051092241}
################Communication round : 72
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 0
local mask changes: 772592.0 / 11173962
choose client_indexes: [ 0  6 10 12 16], accoring to random
choose mask diff: [772592.0, 1190534.0, 1207294.0, 1193646.0, 1199316.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.470463
Client Index = 0	Epoch: 1	Loss: 0.424258
Client Index = 0	Epoch: 2	Loss: 0.422969
Client Index = 0	Epoch: 3	Loss: 0.417330
Client Index = 0	Epoch: 4	Loss: 0.422576
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 1
local mask changes: 772482.0 / 11173962
choose client_indexes: [ 1 11 13 14 18], accoring to random
choose mask diff: [772482.0, 1168818.0, 1177082.0, 1178680.0, 1164106.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 1	Epoch: 0	Loss: 0.256973
Client Index = 1	Epoch: 1	Loss: 0.224536
Client Index = 1	Epoch: 2	Loss: 0.139145
Client Index = 1	Epoch: 3	Loss: 0.195279
Client Index = 1	Epoch: 4	Loss: 0.341119
test acc on this client after 433 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 2
local mask changes: 772886.0 / 11173962
choose client_indexes: [ 1  2  4 12 16], accoring to random
choose mask diff: [1167314.0, 772886.0, 1170270.0, 1176398.0, 1176488.0]
Doing local aggregation!
test acc on this client before 444 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.312460
Client Index = 2	Epoch: 1	Loss: 0.171958
Client Index = 2	Epoch: 2	Loss: 0.135367
Client Index = 2	Epoch: 3	Loss: 0.270535
Client Index = 2	Epoch: 4	Loss: 0.122374
test acc on this client after 450 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 3
local mask changes: 773276.0 / 11173962
choose client_indexes: [ 1  3  4  7 13], accoring to random
choose mask diff: [1183542.0, 773276.0, 1186272.0, 1175442.0, 1187894.0]
Doing local aggregation!
test acc on this client before 358 / 504 : 0.71
Client Index = 3	Epoch: 0	Loss: 0.524904
Client Index = 3	Epoch: 1	Loss: 0.377445
Client Index = 3	Epoch: 2	Loss: 0.398195
Client Index = 3	Epoch: 3	Loss: 0.427666
Client Index = 3	Epoch: 4	Loss: 0.360809
test acc on this client after 381 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 4
local mask changes: 772416.0 / 11173962
choose client_indexes: [ 4  7 10 14 16], accoring to random
choose mask diff: [772416.0, 1175822.0, 1179780.0, 1175948.0, 1185988.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.439455
Client Index = 4	Epoch: 1	Loss: 0.269933
Client Index = 4	Epoch: 2	Loss: 0.200277
Client Index = 4	Epoch: 3	Loss: 0.161392
Client Index = 4	Epoch: 4	Loss: 0.244899
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 5
local mask changes: 772692.0 / 11173962
choose client_indexes: [ 5  9 10 15 18], accoring to random
choose mask diff: [772692.0, 1169660.0, 1185484.0, 1171384.0, 1161926.0]
Doing local aggregation!
test acc on this client before 389 / 504 : 0.77
Client Index = 5	Epoch: 0	Loss: 0.515730
Client Index = 5	Epoch: 1	Loss: 0.241832
Client Index = 5	Epoch: 2	Loss: 0.276576
Client Index = 5	Epoch: 3	Loss: 0.208896
Client Index = 5	Epoch: 4	Loss: 0.182196
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 6
local mask changes: 772594.0 / 11173962
choose client_indexes: [ 3  6 14 16 19], accoring to random
choose mask diff: [1178524.0, 772594.0, 1185230.0, 1194006.0, 1182454.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.636530
Client Index = 6	Epoch: 1	Loss: 0.404627
Client Index = 6	Epoch: 2	Loss: 0.402231
Client Index = 6	Epoch: 3	Loss: 0.363923
Client Index = 6	Epoch: 4	Loss: 0.396547
test acc on this client after 335 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 7
local mask changes: 772598.0 / 11173962
choose client_indexes: [2 4 7 8 9], accoring to random
choose mask diff: [1174128.0, 1182978.0, 772598.0, 1172552.0, 1180258.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 7	Epoch: 0	Loss: 0.253083
Client Index = 7	Epoch: 1	Loss: 0.308465
Client Index = 7	Epoch: 2	Loss: 0.235148
Client Index = 7	Epoch: 3	Loss: 0.329747
Client Index = 7	Epoch: 4	Loss: 0.177180
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 8
local mask changes: 773356.0 / 11173962
choose client_indexes: [ 5  8  9 13 19], accoring to random
choose mask diff: [1172426.0, 773356.0, 1185292.0, 1178920.0, 1193658.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 8	Epoch: 0	Loss: 0.436959
Client Index = 8	Epoch: 1	Loss: 0.389546
Client Index = 8	Epoch: 2	Loss: 0.343608
Client Index = 8	Epoch: 3	Loss: 0.272780
Client Index = 8	Epoch: 4	Loss: 0.215958
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 9
local mask changes: 772184.0 / 11173962
choose client_indexes: [ 3  9 12 15 18], accoring to random
choose mask diff: [1179468.0, 772184.0, 1188400.0, 1162550.0, 1162562.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.307751
Client Index = 9	Epoch: 1	Loss: 0.261813
Client Index = 9	Epoch: 2	Loss: 0.210053
Client Index = 9	Epoch: 3	Loss: 0.327388
Client Index = 9	Epoch: 4	Loss: 0.229305
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 10
local mask changes: 772826.0 / 11173962
choose client_indexes: [ 2  8 10 11 16], accoring to random
choose mask diff: [1178206.0, 1187500.0, 772826.0, 1186406.0, 1184668.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.368846
Client Index = 10	Epoch: 1	Loss: 0.301520
Client Index = 10	Epoch: 2	Loss: 0.268061
Client Index = 10	Epoch: 3	Loss: 0.320171
Client Index = 10	Epoch: 4	Loss: 0.185597
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 11
local mask changes: 772766.0 / 11173962
choose client_indexes: [ 3  7 10 11 14], accoring to random
choose mask diff: [1185770.0, 1183900.0, 1186088.0, 772766.0, 1172014.0]
Doing local aggregation!
test acc on this client before 458 / 504 : 0.91
Client Index = 11	Epoch: 0	Loss: 0.358523
Client Index = 11	Epoch: 1	Loss: 0.214350
Client Index = 11	Epoch: 2	Loss: 0.171385
Client Index = 11	Epoch: 3	Loss: 0.130431
Client Index = 11	Epoch: 4	Loss: 0.127808
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 12
local mask changes: 773238.0 / 11173962
choose client_indexes: [10 12 14 17 18], accoring to random
choose mask diff: [1181330.0, 773238.0, 1192834.0, 1178248.0, 1171582.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 12	Epoch: 0	Loss: 0.346373
Client Index = 12	Epoch: 1	Loss: 0.309342
Client Index = 12	Epoch: 2	Loss: 0.267751
Client Index = 12	Epoch: 3	Loss: 0.304225
Client Index = 12	Epoch: 4	Loss: 0.331525
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 13
local mask changes: 772584.0 / 11173962
choose client_indexes: [ 4  5 13 16 19], accoring to random
choose mask diff: [1177394.0, 1187556.0, 772584.0, 1192394.0, 1187602.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.335315
Client Index = 13	Epoch: 1	Loss: 0.305772
Client Index = 13	Epoch: 2	Loss: 0.297902
Client Index = 13	Epoch: 3	Loss: 0.287462
Client Index = 13	Epoch: 4	Loss: 0.265980
test acc on this client after 407 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 14
local mask changes: 773190.0 / 11173962
choose client_indexes: [ 3 13 14 15 16], accoring to random
choose mask diff: [1187936.0, 1184332.0, 773190.0, 1187700.0, 1182062.0]
Doing local aggregation!
test acc on this client before 423 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.548078
Client Index = 14	Epoch: 1	Loss: 0.363312
Client Index = 14	Epoch: 2	Loss: 0.334110
Client Index = 14	Epoch: 3	Loss: 0.294487
Client Index = 14	Epoch: 4	Loss: 0.385692
test acc on this client after 403 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 15
local mask changes: 772724.0 / 11173962
choose client_indexes: [ 2  9 10 15 16], accoring to random
choose mask diff: [1173942.0, 1158158.0, 1181436.0, 772724.0, 1190062.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.354697
Client Index = 15	Epoch: 1	Loss: 0.226331
Client Index = 15	Epoch: 2	Loss: 0.188374
Client Index = 15	Epoch: 3	Loss: 0.186435
Client Index = 15	Epoch: 4	Loss: 0.193544
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 16
local mask changes: 772506.0 / 11173962
choose client_indexes: [ 5  9 12 13 16], accoring to random
choose mask diff: [1178448.0, 1170506.0, 1181922.0, 1189864.0, 772506.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.294073
Client Index = 16	Epoch: 1	Loss: 0.260238
Client Index = 16	Epoch: 2	Loss: 0.254761
Client Index = 16	Epoch: 3	Loss: 0.277650
Client Index = 16	Epoch: 4	Loss: 0.162032
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 17
local mask changes: 772548.0 / 11173962
choose client_indexes: [ 2  4 11 14 17], accoring to random
choose mask diff: [1157578.0, 1171232.0, 1163436.0, 1165876.0, 772548.0]
Doing local aggregation!
test acc on this client before 348 / 505 : 0.69
Client Index = 17	Epoch: 0	Loss: 0.497346
Client Index = 17	Epoch: 1	Loss: 0.240479
Client Index = 17	Epoch: 2	Loss: 0.283496
Client Index = 17	Epoch: 3	Loss: 0.210065
Client Index = 17	Epoch: 4	Loss: 0.189262
test acc on this client after 452 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 18
local mask changes: 772274.0 / 11173962
choose client_indexes: [ 3  7 13 18 19], accoring to random
choose mask diff: [1168436.0, 1175442.0, 1173080.0, 772274.0, 1169070.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 18	Epoch: 0	Loss: 0.338387
Client Index = 18	Epoch: 1	Loss: 0.261295
Client Index = 18	Epoch: 2	Loss: 0.226833
Client Index = 18	Epoch: 3	Loss: 0.209426
Client Index = 18	Epoch: 4	Loss: 0.172350
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(72) with spasity 0.5: 19
local mask changes: 773026.0 / 11173962
choose client_indexes: [ 3  5 13 17 19], accoring to random
choose mask diff: [1174016.0, 1179408.0, 1187742.0, 1171164.0, 773026.0]
Doing local aggregation!
test acc on this client before 417 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.295973
Client Index = 19	Epoch: 1	Loss: 0.389631
Client Index = 19	Epoch: 2	Loss: 0.200593
Client Index = 19	Epoch: 3	Loss: 0.185024
Client Index = 19	Epoch: 4	Loss: 0.176895
test acc on this client after 410 / 506 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 72
{'test_acc': 0.8138205246493533, 'test_loss': 0.6098022681421185}
################local_test_on_all_clients before local training in communication round: 72
{'test_acc': 0.8135280375025837, 'test_loss': 0.5696424770759072}
################Communication round : 73
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 0
local mask changes: 728650.0 / 11173962
choose client_indexes: [ 0  4  6 11 12], accoring to random
choose mask diff: [728650.0, 1168392.0, 1156994.0, 1151582.0, 1159124.0]
Doing local aggregation!
test acc on this client before 366 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.490887
Client Index = 0	Epoch: 1	Loss: 0.473401
Client Index = 0	Epoch: 2	Loss: 0.421050
Client Index = 0	Epoch: 3	Loss: 0.342902
Client Index = 0	Epoch: 4	Loss: 0.304962
test acc on this client after 342 / 504 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 1
local mask changes: 728796.0 / 11173962
choose client_indexes: [ 1  4 10 17 19], accoring to random
choose mask diff: [728796.0, 1141894.0, 1137122.0, 1129420.0, 1145588.0]
Doing local aggregation!
test acc on this client before 437 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.284331
Client Index = 1	Epoch: 1	Loss: 0.201308
Client Index = 1	Epoch: 2	Loss: 0.149584
Client Index = 1	Epoch: 3	Loss: 0.102272
Client Index = 1	Epoch: 4	Loss: 0.149925
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 2
local mask changes: 728046.0 / 11173962
choose client_indexes: [ 2  5  7 13 17], accoring to random
choose mask diff: [728046.0, 1144186.0, 1139808.0, 1143936.0, 1126556.0]
Doing local aggregation!
test acc on this client before 450 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.210063
Client Index = 2	Epoch: 1	Loss: 0.347017
Client Index = 2	Epoch: 2	Loss: 0.239444
Client Index = 2	Epoch: 3	Loss: 0.109202
Client Index = 2	Epoch: 4	Loss: 0.095239
test acc on this client after 440 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 3
local mask changes: 728540.0 / 11173962
choose client_indexes: [ 0  3  7 14 19], accoring to random
choose mask diff: [1164196.0, 728540.0, 1139894.0, 1158790.0, 1140418.0]
Doing local aggregation!
test acc on this client before 391 / 504 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.467630
Client Index = 3	Epoch: 1	Loss: 0.341782
Client Index = 3	Epoch: 2	Loss: 0.456943
Client Index = 3	Epoch: 3	Loss: 0.318886
Client Index = 3	Epoch: 4	Loss: 0.237227
test acc on this client after 332 / 504 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 4
local mask changes: 728188.0 / 11173962
choose client_indexes: [ 0  3  4 18 19], accoring to random
choose mask diff: [1168130.0, 1153790.0, 728188.0, 1137706.0, 1147816.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.326566
Client Index = 4	Epoch: 1	Loss: 0.189826
Client Index = 4	Epoch: 2	Loss: 0.276253
Client Index = 4	Epoch: 3	Loss: 0.200931
Client Index = 4	Epoch: 4	Loss: 0.224029
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 5
local mask changes: 728128.0 / 11173962
choose client_indexes: [ 0  2  4  5 12], accoring to random
choose mask diff: [1159170.0, 1143878.0, 1148480.0, 728128.0, 1142082.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 5	Epoch: 0	Loss: 0.444444
Client Index = 5	Epoch: 1	Loss: 0.257068
Client Index = 5	Epoch: 2	Loss: 0.209275
Client Index = 5	Epoch: 3	Loss: 0.252582
Client Index = 5	Epoch: 4	Loss: 0.220951
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 6
local mask changes: 727992.0 / 11173962
choose client_indexes: [ 0  3  6  8 17], accoring to random
choose mask diff: [1162718.0, 1145500.0, 727992.0, 1161458.0, 1150406.0]
Doing local aggregation!
test acc on this client before 396 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.480001
Client Index = 6	Epoch: 1	Loss: 0.414203
Client Index = 6	Epoch: 2	Loss: 0.438334
Client Index = 6	Epoch: 3	Loss: 0.350094
Client Index = 6	Epoch: 4	Loss: 0.329745
test acc on this client after 395 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 7
local mask changes: 728182.0 / 11173962
choose client_indexes: [ 1  5  7 10 12], accoring to random
choose mask diff: [1140080.0, 1135914.0, 728182.0, 1149802.0, 1138096.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 7	Epoch: 0	Loss: 0.427907
Client Index = 7	Epoch: 1	Loss: 0.305688
Client Index = 7	Epoch: 2	Loss: 0.243839
Client Index = 7	Epoch: 3	Loss: 0.222788
Client Index = 7	Epoch: 4	Loss: 0.294186
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 8
local mask changes: 728594.0 / 11173962
choose client_indexes: [ 5  8 11 12 15], accoring to random
choose mask diff: [1131972.0, 728594.0, 1135618.0, 1158964.0, 1147292.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.623484
Client Index = 8	Epoch: 1	Loss: 0.333651
Client Index = 8	Epoch: 2	Loss: 0.313485
Client Index = 8	Epoch: 3	Loss: 0.329623
Client Index = 8	Epoch: 4	Loss: 0.268381
test acc on this client after 336 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 9
local mask changes: 728222.0 / 11173962
choose client_indexes: [ 7  9 16 17 18], accoring to random
choose mask diff: [1148350.0, 728222.0, 1136340.0, 1127960.0, 1128046.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 9	Epoch: 0	Loss: 0.333133
Client Index = 9	Epoch: 1	Loss: 0.260825
Client Index = 9	Epoch: 2	Loss: 0.187214
Client Index = 9	Epoch: 3	Loss: 0.189546
Client Index = 9	Epoch: 4	Loss: 0.193505
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 10
local mask changes: 728964.0 / 11173962
choose client_indexes: [ 3  8 10 15 16], accoring to random
choose mask diff: [1167856.0, 1150228.0, 728964.0, 1150922.0, 1148180.0]
Doing local aggregation!
test acc on this client before 413 / 503 : 0.82
Client Index = 10	Epoch: 0	Loss: 0.356638
Client Index = 10	Epoch: 1	Loss: 0.296201
Client Index = 10	Epoch: 2	Loss: 0.309325
Client Index = 10	Epoch: 3	Loss: 0.248141
Client Index = 10	Epoch: 4	Loss: 0.197051
test acc on this client after 386 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 11
local mask changes: 728156.0 / 11173962
choose client_indexes: [ 0  1  4  8 11], accoring to random
choose mask diff: [1149634.0, 1137270.0, 1130838.0, 1135560.0, 728156.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.184055
Client Index = 11	Epoch: 1	Loss: 0.461950
Client Index = 11	Epoch: 2	Loss: 0.180695
Client Index = 11	Epoch: 3	Loss: 0.130650
Client Index = 11	Epoch: 4	Loss: 0.103481
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 12
local mask changes: 728782.0 / 11173962
choose client_indexes: [ 2  3 12 13 14], accoring to random
choose mask diff: [1146312.0, 1156350.0, 728782.0, 1155902.0, 1156322.0]
Doing local aggregation!
test acc on this client before 361 / 504 : 0.72
Client Index = 12	Epoch: 0	Loss: 0.364673
Client Index = 12	Epoch: 1	Loss: 0.345744
Client Index = 12	Epoch: 2	Loss: 0.247504
Client Index = 12	Epoch: 3	Loss: 0.246490
Client Index = 12	Epoch: 4	Loss: 0.224068
test acc on this client after 399 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 13
local mask changes: 727728.0 / 11173962
choose client_indexes: [ 1  2  8 13 16], accoring to random
choose mask diff: [1146700.0, 1145130.0, 1151950.0, 727728.0, 1154076.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 13	Epoch: 0	Loss: 0.344643
Client Index = 13	Epoch: 1	Loss: 0.249900
Client Index = 13	Epoch: 2	Loss: 0.244353
Client Index = 13	Epoch: 3	Loss: 0.231875
Client Index = 13	Epoch: 4	Loss: 0.203537
test acc on this client after 422 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 14
local mask changes: 727884.0 / 11173962
choose client_indexes: [ 0  7 14 15 18], accoring to random
choose mask diff: [1165820.0, 1159310.0, 727884.0, 1149128.0, 1147836.0]
Doing local aggregation!
test acc on this client before 419 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.457094
Client Index = 14	Epoch: 1	Loss: 0.339004
Client Index = 14	Epoch: 2	Loss: 0.360980
Client Index = 14	Epoch: 3	Loss: 0.337274
Client Index = 14	Epoch: 4	Loss: 0.287661
test acc on this client after 417 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 15
local mask changes: 728082.0 / 11173962
choose client_indexes: [ 2  6 12 15 19], accoring to random
choose mask diff: [1137500.0, 1165036.0, 1151078.0, 728082.0, 1161388.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.284343
Client Index = 15	Epoch: 1	Loss: 0.277280
Client Index = 15	Epoch: 2	Loss: 0.242997
Client Index = 15	Epoch: 3	Loss: 0.194625
Client Index = 15	Epoch: 4	Loss: 0.152096
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 16
local mask changes: 728424.0 / 11173962
choose client_indexes: [ 3  5 13 16 19], accoring to random
choose mask diff: [1154022.0, 1142514.0, 1153048.0, 728424.0, 1153228.0]
Doing local aggregation!
test acc on this client before 415 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.387038
Client Index = 16	Epoch: 1	Loss: 0.224322
Client Index = 16	Epoch: 2	Loss: 0.227081
Client Index = 16	Epoch: 3	Loss: 0.213501
Client Index = 16	Epoch: 4	Loss: 0.277292
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 17
local mask changes: 728404.0 / 11173962
choose client_indexes: [ 4  5  6 13 17], accoring to random
choose mask diff: [1129074.0, 1129532.0, 1147364.0, 1138942.0, 728404.0]
Doing local aggregation!
test acc on this client before 395 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.502671
Client Index = 17	Epoch: 1	Loss: 0.243844
Client Index = 17	Epoch: 2	Loss: 0.228910
Client Index = 17	Epoch: 3	Loss: 0.238812
Client Index = 17	Epoch: 4	Loss: 0.138573
test acc on this client after 436 / 505 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 18
local mask changes: 728494.0 / 11173962
choose client_indexes: [ 0  4  6  9 18], accoring to random
choose mask diff: [1150326.0, 1137306.0, 1150524.0, 1132118.0, 728494.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.388654
Client Index = 18	Epoch: 1	Loss: 0.242174
Client Index = 18	Epoch: 2	Loss: 0.222866
Client Index = 18	Epoch: 3	Loss: 0.213015
Client Index = 18	Epoch: 4	Loss: 0.220762
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(73) with spasity 0.5: 19
local mask changes: 728066.0 / 11173962
choose client_indexes: [ 4  6 16 17 19], accoring to random
choose mask diff: [1147390.0, 1150532.0, 1153016.0, 1135034.0, 728066.0]
Doing local aggregation!
test acc on this client before 392 / 506 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.323792
Client Index = 19	Epoch: 1	Loss: 0.259694
Client Index = 19	Epoch: 2	Loss: 0.238475
Client Index = 19	Epoch: 3	Loss: 0.170616
Client Index = 19	Epoch: 4	Loss: 0.168056
test acc on this client after 409 / 506 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 73
{'test_acc': 0.8076729218408024, 'test_loss': 0.6364253304843134}
################local_test_on_all_clients before local training in communication round: 73
{'test_acc': 0.822371178296492, 'test_loss': 0.5519421397588637}
################Communication round : 74
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 0
local mask changes: 684634.0 / 11173962
choose client_indexes: [ 0  3 10 12 14], accoring to random
choose mask diff: [684634.0, 1134750.0, 1140530.0, 1125290.0, 1137066.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 0	Epoch: 0	Loss: 0.489096
Client Index = 0	Epoch: 1	Loss: 0.466114
Client Index = 0	Epoch: 2	Loss: 0.400481
Client Index = 0	Epoch: 3	Loss: 0.374017
Client Index = 0	Epoch: 4	Loss: 0.379647
test acc on this client after 382 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 1
local mask changes: 684504.0 / 11173962
choose client_indexes: [ 1  3 10 17 19], accoring to random
choose mask diff: [684504.0, 1114892.0, 1100824.0, 1091610.0, 1106660.0]
Doing local aggregation!
test acc on this client before 443 / 503 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.346872
Client Index = 1	Epoch: 1	Loss: 0.193494
Client Index = 1	Epoch: 2	Loss: 0.163205
Client Index = 1	Epoch: 3	Loss: 0.119444
Client Index = 1	Epoch: 4	Loss: 0.217227
test acc on this client after 450 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 2
local mask changes: 684146.0 / 11173962
choose client_indexes: [ 2  8 11 14 19], accoring to random
choose mask diff: [684146.0, 1114276.0, 1106790.0, 1112502.0, 1116398.0]
Doing local aggregation!
test acc on this client before 391 / 502 : 0.78
Client Index = 2	Epoch: 0	Loss: 0.302346
Client Index = 2	Epoch: 1	Loss: 0.170225
Client Index = 2	Epoch: 2	Loss: 0.188930
Client Index = 2	Epoch: 3	Loss: 0.239564
Client Index = 2	Epoch: 4	Loss: 0.099495
test acc on this client after 450 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 3
local mask changes: 684368.0 / 11173962
choose client_indexes: [ 1  3  7 10 15], accoring to random
choose mask diff: [1117474.0, 684368.0, 1107106.0, 1136628.0, 1126768.0]
Doing local aggregation!
test acc on this client before 338 / 504 : 0.67
Client Index = 3	Epoch: 0	Loss: 0.522048
Client Index = 3	Epoch: 1	Loss: 0.479771
Client Index = 3	Epoch: 2	Loss: 0.342518
Client Index = 3	Epoch: 3	Loss: 0.329315
Client Index = 3	Epoch: 4	Loss: 0.284667
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 4
local mask changes: 684512.0 / 11173962
choose client_indexes: [ 3  4  5  6 16], accoring to random
choose mask diff: [1111486.0, 684512.0, 1118666.0, 1116658.0, 1118624.0]
Doing local aggregation!
test acc on this client before 389 / 503 : 0.77
Client Index = 4	Epoch: 0	Loss: 0.415959
Client Index = 4	Epoch: 1	Loss: 0.207020
Client Index = 4	Epoch: 2	Loss: 0.248378
Client Index = 4	Epoch: 3	Loss: 0.165911
Client Index = 4	Epoch: 4	Loss: 0.226996
test acc on this client after 435 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 5
local mask changes: 685000.0 / 11173962
choose client_indexes: [ 2  3  5 14 17], accoring to random
choose mask diff: [1108826.0, 1125774.0, 685000.0, 1121512.0, 1099100.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 5	Epoch: 0	Loss: 0.369623
Client Index = 5	Epoch: 1	Loss: 0.252953
Client Index = 5	Epoch: 2	Loss: 0.237586
Client Index = 5	Epoch: 3	Loss: 0.239450
Client Index = 5	Epoch: 4	Loss: 0.271989
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 6
local mask changes: 684280.0 / 11173962
choose client_indexes: [ 1  6 13 14 16], accoring to random
choose mask diff: [1130640.0, 684280.0, 1125908.0, 1122470.0, 1129718.0]
Doing local aggregation!
test acc on this client before 399 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.590013
Client Index = 6	Epoch: 1	Loss: 0.530094
Client Index = 6	Epoch: 2	Loss: 0.359694
Client Index = 6	Epoch: 3	Loss: 0.375414
Client Index = 6	Epoch: 4	Loss: 0.365910
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 7
local mask changes: 684376.0 / 11173962
choose client_indexes: [ 2  7 13 14 18], accoring to random
choose mask diff: [1105556.0, 684376.0, 1125236.0, 1126688.0, 1104170.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.382756
Client Index = 7	Epoch: 1	Loss: 0.264337
Client Index = 7	Epoch: 2	Loss: 0.287679
Client Index = 7	Epoch: 3	Loss: 0.223327
Client Index = 7	Epoch: 4	Loss: 0.305930
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 8
local mask changes: 684416.0 / 11173962
choose client_indexes: [ 1  8 15 17 18], accoring to random
choose mask diff: [1116816.0, 684416.0, 1112132.0, 1109834.0, 1110282.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 8	Epoch: 0	Loss: 0.458598
Client Index = 8	Epoch: 1	Loss: 0.355436
Client Index = 8	Epoch: 2	Loss: 0.381442
Client Index = 8	Epoch: 3	Loss: 0.377663
Client Index = 8	Epoch: 4	Loss: 0.224261
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 9
local mask changes: 684680.0 / 11173962
choose client_indexes: [ 0  1  5  9 19], accoring to random
choose mask diff: [1135320.0, 1102174.0, 1102482.0, 684680.0, 1108786.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 9	Epoch: 0	Loss: 0.304336
Client Index = 9	Epoch: 1	Loss: 0.262940
Client Index = 9	Epoch: 2	Loss: 0.219933
Client Index = 9	Epoch: 3	Loss: 0.259637
Client Index = 9	Epoch: 4	Loss: 0.164194
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 10
local mask changes: 684440.0 / 11173962
choose client_indexes: [ 4  5  8 10 14], accoring to random
choose mask diff: [1116570.0, 1118464.0, 1117040.0, 684440.0, 1126784.0]
Doing local aggregation!
test acc on this client before 409 / 503 : 0.81
Client Index = 10	Epoch: 0	Loss: 0.383131
Client Index = 10	Epoch: 1	Loss: 0.316624
Client Index = 10	Epoch: 2	Loss: 0.191089
Client Index = 10	Epoch: 3	Loss: 0.220404
Client Index = 10	Epoch: 4	Loss: 0.163358
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 11
local mask changes: 684514.0 / 11173962
choose client_indexes: [ 8 11 13 17 19], accoring to random
choose mask diff: [1101148.0, 684514.0, 1116028.0, 1093442.0, 1114586.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 11	Epoch: 0	Loss: 0.370305
Client Index = 11	Epoch: 1	Loss: 0.160930
Client Index = 11	Epoch: 2	Loss: 0.153962
Client Index = 11	Epoch: 3	Loss: 0.171491
Client Index = 11	Epoch: 4	Loss: 0.151545
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 12
local mask changes: 685114.0 / 11173962
choose client_indexes: [ 2  6 11 12 16], accoring to random
choose mask diff: [1106250.0, 1134478.0, 1119238.0, 685114.0, 1117206.0]
Doing local aggregation!
test acc on this client before 339 / 504 : 0.67
Client Index = 12	Epoch: 0	Loss: 0.381337
Client Index = 12	Epoch: 1	Loss: 0.280600
Client Index = 12	Epoch: 2	Loss: 0.251447
Client Index = 12	Epoch: 3	Loss: 0.295546
Client Index = 12	Epoch: 4	Loss: 0.225096
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 13
local mask changes: 684162.0 / 11173962
choose client_indexes: [ 3 10 13 14 17], accoring to random
choose mask diff: [1123108.0, 1122214.0, 684162.0, 1120014.0, 1108766.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.326699
Client Index = 13	Epoch: 1	Loss: 0.322161
Client Index = 13	Epoch: 2	Loss: 0.246823
Client Index = 13	Epoch: 3	Loss: 0.264043
Client Index = 13	Epoch: 4	Loss: 0.393833
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 14
local mask changes: 684578.0 / 11173962
choose client_indexes: [ 2  6 10 14 17], accoring to random
choose mask diff: [1113306.0, 1123150.0, 1126272.0, 684578.0, 1105904.0]
Doing local aggregation!
test acc on this client before 416 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.456877
Client Index = 14	Epoch: 1	Loss: 0.400603
Client Index = 14	Epoch: 2	Loss: 0.352869
Client Index = 14	Epoch: 3	Loss: 0.274571
Client Index = 14	Epoch: 4	Loss: 0.240315
test acc on this client after 410 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 15
local mask changes: 684270.0 / 11173962
choose client_indexes: [ 0  3  7 15 18], accoring to random
choose mask diff: [1128306.0, 1123686.0, 1117584.0, 684270.0, 1113134.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 15	Epoch: 0	Loss: 0.339257
Client Index = 15	Epoch: 1	Loss: 0.231259
Client Index = 15	Epoch: 2	Loss: 0.234182
Client Index = 15	Epoch: 3	Loss: 0.182898
Client Index = 15	Epoch: 4	Loss: 0.218892
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 16
local mask changes: 684312.0 / 11173962
choose client_indexes: [ 3  5  7 16 19], accoring to random
choose mask diff: [1117768.0, 1106462.0, 1120976.0, 684312.0, 1117434.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 16	Epoch: 0	Loss: 0.348886
Client Index = 16	Epoch: 1	Loss: 0.227837
Client Index = 16	Epoch: 2	Loss: 0.179840
Client Index = 16	Epoch: 3	Loss: 0.423511
Client Index = 16	Epoch: 4	Loss: 0.163860
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 17
local mask changes: 684628.0 / 11173962
choose client_indexes: [ 2  3  4  7 17], accoring to random
choose mask diff: [1092486.0, 1116736.0, 1094480.0, 1112036.0, 684628.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.411495
Client Index = 17	Epoch: 1	Loss: 0.224903
Client Index = 17	Epoch: 2	Loss: 0.237704
Client Index = 17	Epoch: 3	Loss: 0.131353
Client Index = 17	Epoch: 4	Loss: 0.195037
test acc on this client after 345 / 505 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 18
local mask changes: 684720.0 / 11173962
choose client_indexes: [ 5  6 11 14 18], accoring to random
choose mask diff: [1097998.0, 1113330.0, 1105802.0, 1115132.0, 684720.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 18	Epoch: 0	Loss: 0.304405
Client Index = 18	Epoch: 1	Loss: 0.242899
Client Index = 18	Epoch: 2	Loss: 0.229068
Client Index = 18	Epoch: 3	Loss: 0.184716
Client Index = 18	Epoch: 4	Loss: 0.197989
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(74) with spasity 0.5: 19
local mask changes: 684512.0 / 11173962
choose client_indexes: [ 3  6  8 17 19], accoring to random
choose mask diff: [1105356.0, 1112306.0, 1122930.0, 1100846.0, 684512.0]
Doing local aggregation!
test acc on this client before 404 / 506 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.332287
Client Index = 19	Epoch: 1	Loss: 0.209322
Client Index = 19	Epoch: 2	Loss: 0.254692
Client Index = 19	Epoch: 3	Loss: 0.180397
Client Index = 19	Epoch: 4	Loss: 0.178636
test acc on this client after 380 / 506 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 74
{'test_acc': 0.8239820560266233, 'test_loss': 0.5914108230380366}
################local_test_on_all_clients before local training in communication round: 74
{'test_acc': 0.8061670007672432, 'test_loss': 0.6230830661955411}
################Communication round : 75
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 0
local mask changes: 641282.0 / 11173962
choose client_indexes: [ 0  4 11 13 14], accoring to random
choose mask diff: [641282.0, 1099994.0, 1087706.0, 1111102.0, 1099182.0]
Doing local aggregation!
test acc on this client before 363 / 504 : 0.72
Client Index = 0	Epoch: 0	Loss: 0.466741
Client Index = 0	Epoch: 1	Loss: 0.474656
Client Index = 0	Epoch: 2	Loss: 0.371848
Client Index = 0	Epoch: 3	Loss: 0.363453
Client Index = 0	Epoch: 4	Loss: 0.372059
test acc on this client after 273 / 504 : 0.54
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 1
local mask changes: 641394.0 / 11173962
choose client_indexes: [0 1 5 6 9], accoring to random
choose mask diff: [1097334.0, 641394.0, 1076572.0, 1097294.0, 1071374.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.349077
Client Index = 1	Epoch: 1	Loss: 0.162940
Client Index = 1	Epoch: 2	Loss: 0.136240
Client Index = 1	Epoch: 3	Loss: 0.109072
Client Index = 1	Epoch: 4	Loss: 0.119489
test acc on this client after 439 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 2
local mask changes: 641326.0 / 11173962
choose client_indexes: [ 0  1  2  3 18], accoring to random
choose mask diff: [1093232.0, 1067538.0, 641326.0, 1088844.0, 1069928.0]
Doing local aggregation!
test acc on this client before 431 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.243226
Client Index = 2	Epoch: 1	Loss: 0.174821
Client Index = 2	Epoch: 2	Loss: 0.157877
Client Index = 2	Epoch: 3	Loss: 0.290157
Client Index = 2	Epoch: 4	Loss: 0.120917
test acc on this client after 438 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 3
local mask changes: 641254.0 / 11173962
choose client_indexes: [1 3 5 7 8], accoring to random
choose mask diff: [1082320.0, 641254.0, 1096432.0, 1076550.0, 1103548.0]
Doing local aggregation!
test acc on this client before 348 / 504 : 0.69
Client Index = 3	Epoch: 0	Loss: 0.531500
Client Index = 3	Epoch: 1	Loss: 0.426628
Client Index = 3	Epoch: 2	Loss: 0.307406
Client Index = 3	Epoch: 3	Loss: 0.328285
Client Index = 3	Epoch: 4	Loss: 0.332892
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 4
local mask changes: 641362.0 / 11173962
choose client_indexes: [ 3  4 10 17 19], accoring to random
choose mask diff: [1078158.0, 641362.0, 1089792.0, 1068570.0, 1076650.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.423299
Client Index = 4	Epoch: 1	Loss: 0.204941
Client Index = 4	Epoch: 2	Loss: 0.210725
Client Index = 4	Epoch: 3	Loss: 0.160764
Client Index = 4	Epoch: 4	Loss: 0.196663
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 5
local mask changes: 641294.0 / 11173962
choose client_indexes: [ 0  1  5 10 18], accoring to random
choose mask diff: [1096448.0, 1076470.0, 641294.0, 1088296.0, 1069176.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 5	Epoch: 0	Loss: 0.344764
Client Index = 5	Epoch: 1	Loss: 0.246178
Client Index = 5	Epoch: 2	Loss: 0.217620
Client Index = 5	Epoch: 3	Loss: 0.284346
Client Index = 5	Epoch: 4	Loss: 0.193199
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 6
local mask changes: 641598.0 / 11173962
choose client_indexes: [ 6  7 11 13 15], accoring to random
choose mask diff: [641598.0, 1095444.0, 1091220.0, 1092120.0, 1101550.0]
Doing local aggregation!
test acc on this client before 393 / 505 : 0.78
Client Index = 6	Epoch: 0	Loss: 0.483756
Client Index = 6	Epoch: 1	Loss: 0.409210
Client Index = 6	Epoch: 2	Loss: 0.391301
Client Index = 6	Epoch: 3	Loss: 0.315168
Client Index = 6	Epoch: 4	Loss: 0.512495
test acc on this client after 291 / 505 : 0.58
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 7
local mask changes: 641182.0 / 11173962
choose client_indexes: [ 0  7 10 16 18], accoring to random
choose mask diff: [1097828.0, 641182.0, 1084952.0, 1090534.0, 1069984.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 7	Epoch: 0	Loss: 0.355075
Client Index = 7	Epoch: 1	Loss: 0.308584
Client Index = 7	Epoch: 2	Loss: 0.331953
Client Index = 7	Epoch: 3	Loss: 0.192694
Client Index = 7	Epoch: 4	Loss: 0.152501
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 8
local mask changes: 641312.0 / 11173962
choose client_indexes: [ 1  8 10 11 13], accoring to random
choose mask diff: [1079942.0, 641312.0, 1086044.0, 1070218.0, 1084666.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.477741
Client Index = 8	Epoch: 1	Loss: 0.330226
Client Index = 8	Epoch: 2	Loss: 0.341840
Client Index = 8	Epoch: 3	Loss: 0.295333
Client Index = 8	Epoch: 4	Loss: 0.236566
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 9
local mask changes: 642086.0 / 11173962
choose client_indexes: [ 9 10 11 12 18], accoring to random
choose mask diff: [642086.0, 1090422.0, 1080336.0, 1089352.0, 1059706.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.269504
Client Index = 9	Epoch: 1	Loss: 0.222429
Client Index = 9	Epoch: 2	Loss: 0.238303
Client Index = 9	Epoch: 3	Loss: 0.264875
Client Index = 9	Epoch: 4	Loss: 0.139776
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 10
local mask changes: 640828.0 / 11173962
choose client_indexes: [ 0  4 10 15 16], accoring to random
choose mask diff: [1109842.0, 1082946.0, 640828.0, 1083704.0, 1088522.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.374819
Client Index = 10	Epoch: 1	Loss: 0.303609
Client Index = 10	Epoch: 2	Loss: 0.293661
Client Index = 10	Epoch: 3	Loss: 0.254815
Client Index = 10	Epoch: 4	Loss: 0.168565
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 11
local mask changes: 641494.0 / 11173962
choose client_indexes: [ 4  5  7 11 13], accoring to random
choose mask diff: [1065956.0, 1074928.0, 1084930.0, 641494.0, 1079868.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.294520
Client Index = 11	Epoch: 1	Loss: 0.162793
Client Index = 11	Epoch: 2	Loss: 0.215448
Client Index = 11	Epoch: 3	Loss: 0.137542
Client Index = 11	Epoch: 4	Loss: 0.120669
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 12
local mask changes: 641000.0 / 11173962
choose client_indexes: [ 0  4 11 12 19], accoring to random
choose mask diff: [1096554.0, 1086656.0, 1084990.0, 641000.0, 1093632.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 12	Epoch: 0	Loss: 0.344735
Client Index = 12	Epoch: 1	Loss: 0.298731
Client Index = 12	Epoch: 2	Loss: 0.236384
Client Index = 12	Epoch: 3	Loss: 0.255464
Client Index = 12	Epoch: 4	Loss: 0.217327
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 13
local mask changes: 641232.0 / 11173962
choose client_indexes: [ 5  7 10 13 14], accoring to random
choose mask diff: [1090110.0, 1097214.0, 1089844.0, 641232.0, 1088150.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.321599
Client Index = 13	Epoch: 1	Loss: 0.407594
Client Index = 13	Epoch: 2	Loss: 0.274535
Client Index = 13	Epoch: 3	Loss: 0.263022
Client Index = 13	Epoch: 4	Loss: 0.189451
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 14
local mask changes: 641868.0 / 11173962
choose client_indexes: [ 3  9 14 15 17], accoring to random
choose mask diff: [1090104.0, 1084568.0, 641868.0, 1087406.0, 1072388.0]
Doing local aggregation!
test acc on this client before 403 / 502 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.416423
Client Index = 14	Epoch: 1	Loss: 0.398351
Client Index = 14	Epoch: 2	Loss: 0.383773
Client Index = 14	Epoch: 3	Loss: 0.295052
Client Index = 14	Epoch: 4	Loss: 0.226838
test acc on this client after 411 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 15
local mask changes: 641218.0 / 11173962
choose client_indexes: [ 0  9 10 11 15], accoring to random
choose mask diff: [1094030.0, 1066446.0, 1086040.0, 1087500.0, 641218.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.273415
Client Index = 15	Epoch: 1	Loss: 0.217317
Client Index = 15	Epoch: 2	Loss: 0.266518
Client Index = 15	Epoch: 3	Loss: 0.162104
Client Index = 15	Epoch: 4	Loss: 0.166151
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 16
local mask changes: 641510.0 / 11173962
choose client_indexes: [ 9 11 16 17 18], accoring to random
choose mask diff: [1071132.0, 1084006.0, 641510.0, 1083738.0, 1073278.0]
Doing local aggregation!
test acc on this client before 426 / 503 : 0.85
Client Index = 16	Epoch: 0	Loss: 0.290121
Client Index = 16	Epoch: 1	Loss: 0.231215
Client Index = 16	Epoch: 2	Loss: 0.281871
Client Index = 16	Epoch: 3	Loss: 0.167998
Client Index = 16	Epoch: 4	Loss: 0.205603
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 17
local mask changes: 641318.0 / 11173962
choose client_indexes: [ 5  7  9 11 17], accoring to random
choose mask diff: [1064662.0, 1076180.0, 1065494.0, 1065268.0, 641318.0]
Doing local aggregation!
test acc on this client before 394 / 505 : 0.78
Client Index = 17	Epoch: 0	Loss: 0.417851
Client Index = 17	Epoch: 1	Loss: 0.164869
Client Index = 17	Epoch: 2	Loss: 0.251736
Client Index = 17	Epoch: 3	Loss: 0.143379
Client Index = 17	Epoch: 4	Loss: 0.114222
test acc on this client after 408 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 18
local mask changes: 641166.0 / 11173962
choose client_indexes: [ 6 13 16 17 18], accoring to random
choose mask diff: [1080122.0, 1080620.0, 1073792.0, 1075626.0, 641166.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 18	Epoch: 0	Loss: 0.328383
Client Index = 18	Epoch: 1	Loss: 0.279329
Client Index = 18	Epoch: 2	Loss: 0.205317
Client Index = 18	Epoch: 3	Loss: 0.187579
Client Index = 18	Epoch: 4	Loss: 0.196476
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(75) with spasity 0.5: 19
local mask changes: 641576.0 / 11173962
choose client_indexes: [ 3 13 15 18 19], accoring to random
choose mask diff: [1068868.0, 1087572.0, 1093926.0, 1070382.0, 641576.0]
Doing local aggregation!
test acc on this client before 416 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.343206
Client Index = 19	Epoch: 1	Loss: 0.219155
Client Index = 19	Epoch: 2	Loss: 0.283969
Client Index = 19	Epoch: 3	Loss: 0.198444
Client Index = 19	Epoch: 4	Loss: 0.168912
test acc on this client after 414 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 75
{'test_acc': 0.7992546822000262, 'test_loss': 0.6661730146829153}
################local_test_on_all_clients before local training in communication round: 75
{'test_acc': 0.8221583933595197, 'test_loss': 0.5608057027830303}
################Communication round : 76
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 0
local mask changes: 599184.0 / 11173962
choose client_indexes: [ 0  5  6 12 15], accoring to random
choose mask diff: [599184.0, 1073064.0, 1070802.0, 1070378.0, 1071508.0]
Doing local aggregation!
test acc on this client before 396 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.415394
Client Index = 0	Epoch: 1	Loss: 0.425381
Client Index = 0	Epoch: 2	Loss: 0.404977
Client Index = 0	Epoch: 3	Loss: 0.380311
Client Index = 0	Epoch: 4	Loss: 0.291987
test acc on this client after 350 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 1
local mask changes: 599462.0 / 11173962
choose client_indexes: [ 0  1  5  6 15], accoring to random
choose mask diff: [1064500.0, 599462.0, 1042318.0, 1058626.0, 1051340.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.248033
Client Index = 1	Epoch: 1	Loss: 0.238398
Client Index = 1	Epoch: 2	Loss: 0.132524
Client Index = 1	Epoch: 3	Loss: 0.136447
Client Index = 1	Epoch: 4	Loss: 0.096324
test acc on this client after 436 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 2
local mask changes: 598776.0 / 11173962
choose client_indexes: [ 2  3 14 17 19], accoring to random
choose mask diff: [598776.0, 1053846.0, 1046206.0, 1027320.0, 1052066.0]
Doing local aggregation!
test acc on this client before 441 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.221752
Client Index = 2	Epoch: 1	Loss: 0.168023
Client Index = 2	Epoch: 2	Loss: 0.241090
Client Index = 2	Epoch: 3	Loss: 0.100317
Client Index = 2	Epoch: 4	Loss: 0.079600
test acc on this client after 457 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 3
local mask changes: 598758.0 / 11173962
choose client_indexes: [ 3  4  5 14 15], accoring to random
choose mask diff: [598758.0, 1053308.0, 1058032.0, 1062362.0, 1059614.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.488866
Client Index = 3	Epoch: 1	Loss: 0.339115
Client Index = 3	Epoch: 2	Loss: 0.317387
Client Index = 3	Epoch: 3	Loss: 0.274669
Client Index = 3	Epoch: 4	Loss: 0.418079
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 4
local mask changes: 599536.0 / 11173962
choose client_indexes: [ 0  4 12 14 16], accoring to random
choose mask diff: [1071548.0, 599536.0, 1058274.0, 1055038.0, 1055180.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.368356
Client Index = 4	Epoch: 1	Loss: 0.202870
Client Index = 4	Epoch: 2	Loss: 0.167500
Client Index = 4	Epoch: 3	Loss: 0.353422
Client Index = 4	Epoch: 4	Loss: 0.139634
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 5
local mask changes: 598564.0 / 11173962
choose client_indexes: [ 5  6  7  9 18], accoring to random
choose mask diff: [598564.0, 1066482.0, 1044048.0, 1043150.0, 1033202.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 5	Epoch: 0	Loss: 0.289530
Client Index = 5	Epoch: 1	Loss: 0.385521
Client Index = 5	Epoch: 2	Loss: 0.214716
Client Index = 5	Epoch: 3	Loss: 0.189481
Client Index = 5	Epoch: 4	Loss: 0.169759
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 6
local mask changes: 598880.0 / 11173962
choose client_indexes: [ 1  6 11 13 17], accoring to random
choose mask diff: [1069078.0, 598880.0, 1060096.0, 1063122.0, 1058230.0]
Doing local aggregation!
test acc on this client before 371 / 505 : 0.73
Client Index = 6	Epoch: 0	Loss: 0.491220
Client Index = 6	Epoch: 1	Loss: 0.427316
Client Index = 6	Epoch: 2	Loss: 0.318465
Client Index = 6	Epoch: 3	Loss: 0.457912
Client Index = 6	Epoch: 4	Loss: 0.368516
test acc on this client after 356 / 505 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 7
local mask changes: 598612.0 / 11173962
choose client_indexes: [ 6  7  9 11 12], accoring to random
choose mask diff: [1065406.0, 598612.0, 1051352.0, 1056456.0, 1050528.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 7	Epoch: 0	Loss: 0.327231
Client Index = 7	Epoch: 1	Loss: 0.260380
Client Index = 7	Epoch: 2	Loss: 0.263862
Client Index = 7	Epoch: 3	Loss: 0.174755
Client Index = 7	Epoch: 4	Loss: 0.265611
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 8
local mask changes: 599498.0 / 11173962
choose client_indexes: [ 2  4  6  8 18], accoring to random
choose mask diff: [1051370.0, 1062032.0, 1067630.0, 599498.0, 1049818.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 8	Epoch: 0	Loss: 0.493933
Client Index = 8	Epoch: 1	Loss: 0.306709
Client Index = 8	Epoch: 2	Loss: 0.307720
Client Index = 8	Epoch: 3	Loss: 0.269122
Client Index = 8	Epoch: 4	Loss: 0.221932
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 9
local mask changes: 598960.0 / 11173962
choose client_indexes: [ 9 12 13 14 17], accoring to random
choose mask diff: [598960.0, 1055508.0, 1057122.0, 1055028.0, 1036768.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 9	Epoch: 0	Loss: 0.278926
Client Index = 9	Epoch: 1	Loss: 0.301191
Client Index = 9	Epoch: 2	Loss: 0.172279
Client Index = 9	Epoch: 3	Loss: 0.220661
Client Index = 9	Epoch: 4	Loss: 0.135116
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 10
local mask changes: 599098.0 / 11173962
choose client_indexes: [10 13 14 17 18], accoring to random
choose mask diff: [599098.0, 1062944.0, 1061066.0, 1056548.0, 1064400.0]
Doing local aggregation!
test acc on this client before 404 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.376567
Client Index = 10	Epoch: 1	Loss: 0.297855
Client Index = 10	Epoch: 2	Loss: 0.240849
Client Index = 10	Epoch: 3	Loss: 0.284982
Client Index = 10	Epoch: 4	Loss: 0.174827
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 11
local mask changes: 598958.0 / 11173962
choose client_indexes: [ 4 11 12 15 16], accoring to random
choose mask diff: [1033942.0, 598958.0, 1054526.0, 1057404.0, 1050808.0]
Doing local aggregation!
test acc on this client before 451 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.231684
Client Index = 11	Epoch: 1	Loss: 0.193452
Client Index = 11	Epoch: 2	Loss: 0.141070
Client Index = 11	Epoch: 3	Loss: 0.109535
Client Index = 11	Epoch: 4	Loss: 0.226049
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 12
local mask changes: 599188.0 / 11173962
choose client_indexes: [ 0  2 10 12 15], accoring to random
choose mask diff: [1061664.0, 1047496.0, 1062848.0, 599188.0, 1059774.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 12	Epoch: 0	Loss: 0.437161
Client Index = 12	Epoch: 1	Loss: 0.280865
Client Index = 12	Epoch: 2	Loss: 0.256763
Client Index = 12	Epoch: 3	Loss: 0.215358
Client Index = 12	Epoch: 4	Loss: 0.211866
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 13
local mask changes: 599228.0 / 11173962
choose client_indexes: [13 14 15 16 17], accoring to random
choose mask diff: [599228.0, 1055888.0, 1069988.0, 1058058.0, 1044538.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.343298
Client Index = 13	Epoch: 1	Loss: 0.318101
Client Index = 13	Epoch: 2	Loss: 0.338275
Client Index = 13	Epoch: 3	Loss: 0.198819
Client Index = 13	Epoch: 4	Loss: 0.206495
test acc on this client after 393 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 14
local mask changes: 598858.0 / 11173962
choose client_indexes: [ 3  4  7  9 14], accoring to random
choose mask diff: [1056448.0, 1055514.0, 1058810.0, 1053246.0, 598858.0]
Doing local aggregation!
test acc on this client before 423 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.464487
Client Index = 14	Epoch: 1	Loss: 0.333877
Client Index = 14	Epoch: 2	Loss: 0.317211
Client Index = 14	Epoch: 3	Loss: 0.268241
Client Index = 14	Epoch: 4	Loss: 0.292624
test acc on this client after 401 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 15
local mask changes: 598680.0 / 11173962
choose client_indexes: [ 2  7  8 14 15], accoring to random
choose mask diff: [1048952.0, 1055718.0, 1052114.0, 1059106.0, 598680.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 15	Epoch: 0	Loss: 0.360795
Client Index = 15	Epoch: 1	Loss: 0.246330
Client Index = 15	Epoch: 2	Loss: 0.181938
Client Index = 15	Epoch: 3	Loss: 0.162664
Client Index = 15	Epoch: 4	Loss: 0.143069
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 16
local mask changes: 598582.0 / 11173962
choose client_indexes: [ 1  4 11 15 16], accoring to random
choose mask diff: [1048274.0, 1053112.0, 1046888.0, 1060016.0, 598582.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 16	Epoch: 0	Loss: 0.314243
Client Index = 16	Epoch: 1	Loss: 0.235336
Client Index = 16	Epoch: 2	Loss: 0.169701
Client Index = 16	Epoch: 3	Loss: 0.212019
Client Index = 16	Epoch: 4	Loss: 0.328885
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 17
local mask changes: 598946.0 / 11173962
choose client_indexes: [ 5  7  8 11 17], accoring to random
choose mask diff: [1026990.0, 1041766.0, 1046874.0, 1027408.0, 598946.0]
Doing local aggregation!
test acc on this client before 369 / 505 : 0.73
Client Index = 17	Epoch: 0	Loss: 0.440774
Client Index = 17	Epoch: 1	Loss: 0.235192
Client Index = 17	Epoch: 2	Loss: 0.169441
Client Index = 17	Epoch: 3	Loss: 0.221786
Client Index = 17	Epoch: 4	Loss: 0.112131
test acc on this client after 439 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 18
local mask changes: 598882.0 / 11173962
choose client_indexes: [ 1  7  8 18 19], accoring to random
choose mask diff: [1039452.0, 1041830.0, 1048262.0, 598882.0, 1041470.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.300754
Client Index = 18	Epoch: 1	Loss: 0.226967
Client Index = 18	Epoch: 2	Loss: 0.227170
Client Index = 18	Epoch: 3	Loss: 0.180396
Client Index = 18	Epoch: 4	Loss: 0.284859
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(76) with spasity 0.5: 19
local mask changes: 598638.0 / 11173962
choose client_indexes: [ 1  3 10 18 19], accoring to random
choose mask diff: [1045100.0, 1038240.0, 1067510.0, 1038916.0, 598638.0]
Doing local aggregation!
test acc on this client before 410 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.329017
Client Index = 19	Epoch: 1	Loss: 0.237393
Client Index = 19	Epoch: 2	Loss: 0.195778
Client Index = 19	Epoch: 3	Loss: 0.251579
Client Index = 19	Epoch: 4	Loss: 0.186246
test acc on this client after 404 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 76
{'test_acc': 0.828415885116953, 'test_loss': 0.5494619673916189}
################local_test_on_all_clients before local training in communication round: 76
{'test_acc': 0.8215779202925748, 'test_loss': 0.5652391608076363}
################Communication round : 77
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 0
local mask changes: 557288.0 / 11173962
choose client_indexes: [ 0  2  8  9 16], accoring to random
choose mask diff: [557288.0, 1038316.0, 1053272.0, 1050266.0, 1053732.0]
Doing local aggregation!
test acc on this client before 367 / 504 : 0.73
Client Index = 0	Epoch: 0	Loss: 0.481602
Client Index = 0	Epoch: 1	Loss: 0.445027
Client Index = 0	Epoch: 2	Loss: 0.418152
Client Index = 0	Epoch: 3	Loss: 0.364838
Client Index = 0	Epoch: 4	Loss: 0.288028
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 1
local mask changes: 557078.0 / 11173962
choose client_indexes: [ 1  2  5  7 14], accoring to random
choose mask diff: [557078.0, 1007542.0, 1006478.0, 1019320.0, 1025608.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 1	Epoch: 0	Loss: 0.391199
Client Index = 1	Epoch: 1	Loss: 0.149607
Client Index = 1	Epoch: 2	Loss: 0.151671
Client Index = 1	Epoch: 3	Loss: 0.317670
Client Index = 1	Epoch: 4	Loss: 0.129237
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 2
local mask changes: 557310.0 / 11173962
choose client_indexes: [ 2 10 11 14 18], accoring to random
choose mask diff: [557310.0, 1027324.0, 1013144.0, 1013516.0, 1009640.0]
Doing local aggregation!
test acc on this client before 414 / 502 : 0.82
Client Index = 2	Epoch: 0	Loss: 0.225308
Client Index = 2	Epoch: 1	Loss: 0.264757
Client Index = 2	Epoch: 2	Loss: 0.163451
Client Index = 2	Epoch: 3	Loss: 0.122889
Client Index = 2	Epoch: 4	Loss: 0.119452
test acc on this client after 451 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 3
local mask changes: 557462.0 / 11173962
choose client_indexes: [ 2  3  4 12 14], accoring to random
choose mask diff: [1028696.0, 557462.0, 1017780.0, 1039520.0, 1027610.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.435061
Client Index = 3	Epoch: 1	Loss: 0.345052
Client Index = 3	Epoch: 2	Loss: 0.353836
Client Index = 3	Epoch: 3	Loss: 0.252108
Client Index = 3	Epoch: 4	Loss: 0.366976
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 4
local mask changes: 557286.0 / 11173962
choose client_indexes: [ 2  3  4  6 10], accoring to random
choose mask diff: [1018150.0, 1021622.0, 557286.0, 1032380.0, 1022056.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 4	Epoch: 0	Loss: 0.264832
Client Index = 4	Epoch: 1	Loss: 0.266265
Client Index = 4	Epoch: 2	Loss: 0.171020
Client Index = 4	Epoch: 3	Loss: 0.210386
Client Index = 4	Epoch: 4	Loss: 0.135755
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 5
local mask changes: 557678.0 / 11173962
choose client_indexes: [ 5  6  8 13 17], accoring to random
choose mask diff: [557678.0, 1035740.0, 1018856.0, 1029602.0, 1002044.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 5	Epoch: 0	Loss: 0.337765
Client Index = 5	Epoch: 1	Loss: 0.223352
Client Index = 5	Epoch: 2	Loss: 0.247436
Client Index = 5	Epoch: 3	Loss: 0.195788
Client Index = 5	Epoch: 4	Loss: 0.163702
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 6
local mask changes: 557052.0 / 11173962
choose client_indexes: [0 4 6 8 9], accoring to random
choose mask diff: [1048840.0, 1032886.0, 557052.0, 1042764.0, 1046384.0]
Doing local aggregation!
test acc on this client before 407 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.493629
Client Index = 6	Epoch: 1	Loss: 0.368008
Client Index = 6	Epoch: 2	Loss: 0.348604
Client Index = 6	Epoch: 3	Loss: 0.345330
Client Index = 6	Epoch: 4	Loss: 0.438393
test acc on this client after 387 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 7
local mask changes: 557552.0 / 11173962
choose client_indexes: [ 5  7 11 14 18], accoring to random
choose mask diff: [1016556.0, 557552.0, 1018184.0, 1030702.0, 1012762.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.329018
Client Index = 7	Epoch: 1	Loss: 0.218647
Client Index = 7	Epoch: 2	Loss: 0.174625
Client Index = 7	Epoch: 3	Loss: 0.482006
Client Index = 7	Epoch: 4	Loss: 0.170731
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 8
local mask changes: 556616.0 / 11173962
choose client_indexes: [ 2  7  8 14 18], accoring to random
choose mask diff: [1019872.0, 1023480.0, 556616.0, 1034798.0, 1017108.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 8	Epoch: 0	Loss: 0.473660
Client Index = 8	Epoch: 1	Loss: 0.263461
Client Index = 8	Epoch: 2	Loss: 0.276483
Client Index = 8	Epoch: 3	Loss: 0.273537
Client Index = 8	Epoch: 4	Loss: 0.279159
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 9
local mask changes: 557220.0 / 11173962
choose client_indexes: [ 0  1  8  9 15], accoring to random
choose mask diff: [1047706.0, 1007734.0, 1029562.0, 557220.0, 1007670.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.331475
Client Index = 9	Epoch: 1	Loss: 0.267413
Client Index = 9	Epoch: 2	Loss: 0.194664
Client Index = 9	Epoch: 3	Loss: 0.158040
Client Index = 9	Epoch: 4	Loss: 0.159534
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 10
local mask changes: 556920.0 / 11173962
choose client_indexes: [ 0  4 10 12 13], accoring to random
choose mask diff: [1049476.0, 1021982.0, 556920.0, 1036832.0, 1026874.0]
Doing local aggregation!
test acc on this client before 417 / 503 : 0.83
Client Index = 10	Epoch: 0	Loss: 0.428750
Client Index = 10	Epoch: 1	Loss: 0.289988
Client Index = 10	Epoch: 2	Loss: 0.253383
Client Index = 10	Epoch: 3	Loss: 0.176762
Client Index = 10	Epoch: 4	Loss: 0.154958
test acc on this client after 385 / 503 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 11
local mask changes: 557658.0 / 11173962
choose client_indexes: [ 0  6 11 15 17], accoring to random
choose mask diff: [1030222.0, 1031600.0, 557658.0, 1020554.0, 999780.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.312576
Client Index = 11	Epoch: 1	Loss: 0.147453
Client Index = 11	Epoch: 2	Loss: 0.109254
Client Index = 11	Epoch: 3	Loss: 0.400664
Client Index = 11	Epoch: 4	Loss: 0.124375
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 12
local mask changes: 557360.0 / 11173962
choose client_indexes: [ 1  2  9 12 16], accoring to random
choose mask diff: [1025906.0, 1017156.0, 1029926.0, 557360.0, 1031114.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 12	Epoch: 0	Loss: 0.466116
Client Index = 12	Epoch: 1	Loss: 0.297291
Client Index = 12	Epoch: 2	Loss: 0.232811
Client Index = 12	Epoch: 3	Loss: 0.205112
Client Index = 12	Epoch: 4	Loss: 0.221567
test acc on this client after 348 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 13
local mask changes: 557246.0 / 11173962
choose client_indexes: [ 6 13 15 16 19], accoring to random
choose mask diff: [1038084.0, 557246.0, 1037330.0, 1026418.0, 1030872.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.385067
Client Index = 13	Epoch: 1	Loss: 0.288848
Client Index = 13	Epoch: 2	Loss: 0.262882
Client Index = 13	Epoch: 3	Loss: 0.222222
Client Index = 13	Epoch: 4	Loss: 0.237634
test acc on this client after 418 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 14
local mask changes: 557042.0 / 11173962
choose client_indexes: [ 5 11 14 15 16], accoring to random
choose mask diff: [1030610.0, 1024932.0, 557042.0, 1028082.0, 1030788.0]
Doing local aggregation!
test acc on this client before 424 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.384971
Client Index = 14	Epoch: 1	Loss: 0.281716
Client Index = 14	Epoch: 2	Loss: 0.295460
Client Index = 14	Epoch: 3	Loss: 0.327735
Client Index = 14	Epoch: 4	Loss: 0.223241
test acc on this client after 402 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 15
local mask changes: 557622.0 / 11173962
choose client_indexes: [ 5  7 10 14 15], accoring to random
choose mask diff: [1023990.0, 1022322.0, 1021530.0, 1022560.0, 557622.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 15	Epoch: 0	Loss: 0.317390
Client Index = 15	Epoch: 1	Loss: 0.231829
Client Index = 15	Epoch: 2	Loss: 0.192522
Client Index = 15	Epoch: 3	Loss: 0.176593
Client Index = 15	Epoch: 4	Loss: 0.187193
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 16
local mask changes: 557190.0 / 11173962
choose client_indexes: [ 3  4  5 10 16], accoring to random
choose mask diff: [1030968.0, 1022180.0, 1019504.0, 1029356.0, 557190.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 16	Epoch: 0	Loss: 0.416946
Client Index = 16	Epoch: 1	Loss: 0.206692
Client Index = 16	Epoch: 2	Loss: 0.247347
Client Index = 16	Epoch: 3	Loss: 0.177819
Client Index = 16	Epoch: 4	Loss: 0.138404
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 17
local mask changes: 557370.0 / 11173962
choose client_indexes: [ 0  4  5 13 17], accoring to random
choose mask diff: [1043226.0, 1005460.0, 996416.0, 1015874.0, 557370.0]
Doing local aggregation!
test acc on this client before 407 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.438398
Client Index = 17	Epoch: 1	Loss: 0.219899
Client Index = 17	Epoch: 2	Loss: 0.230062
Client Index = 17	Epoch: 3	Loss: 0.135889
Client Index = 17	Epoch: 4	Loss: 0.392499
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 18
local mask changes: 557298.0 / 11173962
choose client_indexes: [ 3  4  5 17 18], accoring to random
choose mask diff: [1019206.0, 1014110.0, 1005886.0, 1012206.0, 557298.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.490856
Client Index = 18	Epoch: 1	Loss: 0.221979
Client Index = 18	Epoch: 2	Loss: 0.200584
Client Index = 18	Epoch: 3	Loss: 0.176303
Client Index = 18	Epoch: 4	Loss: 0.162322
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(77) with spasity 0.5: 19
local mask changes: 557714.0 / 11173962
choose client_indexes: [ 4 11 12 14 19], accoring to random
choose mask diff: [1017666.0, 1023708.0, 1034604.0, 1039348.0, 557714.0]
Doing local aggregation!
test acc on this client before 401 / 506 : 0.79
Client Index = 19	Epoch: 0	Loss: 0.323849
Client Index = 19	Epoch: 1	Loss: 0.250364
Client Index = 19	Epoch: 2	Loss: 0.449027
Client Index = 19	Epoch: 3	Loss: 0.187914
Client Index = 19	Epoch: 4	Loss: 0.150084
test acc on this client after 397 / 506 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 77
{'test_acc': 0.8162107218732665, 'test_loss': 0.5992302458249227}
################local_test_on_all_clients before local training in communication round: 77
{'test_acc': 0.8247377475915352, 'test_loss': 0.5463383726296631}
################Communication round : 78
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 0
local mask changes: 516776.0 / 11173962
choose client_indexes: [ 0  8 14 16 18], accoring to random
choose mask diff: [516776.0, 1022224.0, 1019372.0, 1022186.0, 1010540.0]
Doing local aggregation!
test acc on this client before 377 / 504 : 0.75
Client Index = 0	Epoch: 0	Loss: 0.490191
Client Index = 0	Epoch: 1	Loss: 0.386961
Client Index = 0	Epoch: 2	Loss: 0.480197
Client Index = 0	Epoch: 3	Loss: 0.312000
Client Index = 0	Epoch: 4	Loss: 0.381655
test acc on this client after 360 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 1
local mask changes: 516860.0 / 11173962
choose client_indexes: [ 0  1  3  4 17], accoring to random
choose mask diff: [1009680.0, 516860.0, 993778.0, 993646.0, 975830.0]
Doing local aggregation!
test acc on this client before 438 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.257229
Client Index = 1	Epoch: 1	Loss: 0.169709
Client Index = 1	Epoch: 2	Loss: 0.176485
Client Index = 1	Epoch: 3	Loss: 0.165289
Client Index = 1	Epoch: 4	Loss: 0.111230
test acc on this client after 454 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 2
local mask changes: 517062.0 / 11173962
choose client_indexes: [ 0  2  4  8 15], accoring to random
choose mask diff: [1011722.0, 517062.0, 989762.0, 992854.0, 989992.0]
Doing local aggregation!
test acc on this client before 404 / 502 : 0.80
Client Index = 2	Epoch: 0	Loss: 0.366340
Client Index = 2	Epoch: 1	Loss: 0.132203
Client Index = 2	Epoch: 2	Loss: 0.121715
Client Index = 2	Epoch: 3	Loss: 0.105874
Client Index = 2	Epoch: 4	Loss: 0.098298
test acc on this client after 450 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 3
local mask changes: 516988.0 / 11173962
choose client_indexes: [ 3  9 10 11 12], accoring to random
choose mask diff: [516988.0, 1002894.0, 1017178.0, 1007008.0, 1009926.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.509382
Client Index = 3	Epoch: 1	Loss: 0.344157
Client Index = 3	Epoch: 2	Loss: 0.373082
Client Index = 3	Epoch: 3	Loss: 0.235222
Client Index = 3	Epoch: 4	Loss: 0.345626
test acc on this client after 397 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 4
local mask changes: 516486.0 / 11173962
choose client_indexes: [0 4 6 8 9], accoring to random
choose mask diff: [1013116.0, 516486.0, 1001186.0, 1003970.0, 1004870.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.408555
Client Index = 4	Epoch: 1	Loss: 0.208216
Client Index = 4	Epoch: 2	Loss: 0.281109
Client Index = 4	Epoch: 3	Loss: 0.187541
Client Index = 4	Epoch: 4	Loss: 0.144412
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 5
local mask changes: 516992.0 / 11173962
choose client_indexes: [ 0  5  6 17 18], accoring to random
choose mask diff: [1013818.0, 516992.0, 1004732.0, 968418.0, 977388.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 5	Epoch: 0	Loss: 0.265329
Client Index = 5	Epoch: 1	Loss: 0.276799
Client Index = 5	Epoch: 2	Loss: 0.209701
Client Index = 5	Epoch: 3	Loss: 0.198173
Client Index = 5	Epoch: 4	Loss: 0.231465
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 6
local mask changes: 516508.0 / 11173962
choose client_indexes: [ 0  1  2  6 15], accoring to random
choose mask diff: [1014900.0, 1003588.0, 1013186.0, 516508.0, 1021080.0]
Doing local aggregation!
test acc on this client before 406 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.422446
Client Index = 6	Epoch: 1	Loss: 0.399230
Client Index = 6	Epoch: 2	Loss: 0.352466
Client Index = 6	Epoch: 3	Loss: 0.335114
Client Index = 6	Epoch: 4	Loss: 0.357133
test acc on this client after 416 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 7
local mask changes: 516820.0 / 11173962
choose client_indexes: [ 7  8 12 15 16], accoring to random
choose mask diff: [516820.0, 998834.0, 997758.0, 998146.0, 1000478.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 7	Epoch: 0	Loss: 0.269120
Client Index = 7	Epoch: 1	Loss: 0.308402
Client Index = 7	Epoch: 2	Loss: 0.205345
Client Index = 7	Epoch: 3	Loss: 0.234198
Client Index = 7	Epoch: 4	Loss: 0.172076
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 8
local mask changes: 516288.0 / 11173962
choose client_indexes: [ 3  8 12 14 15], accoring to random
choose mask diff: [1014894.0, 516288.0, 1013022.0, 1004434.0, 996660.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.496490
Client Index = 8	Epoch: 1	Loss: 0.295338
Client Index = 8	Epoch: 2	Loss: 0.382499
Client Index = 8	Epoch: 3	Loss: 0.312552
Client Index = 8	Epoch: 4	Loss: 0.231153
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 9
local mask changes: 516850.0 / 11173962
choose client_indexes: [ 0  3  9 12 15], accoring to random
choose mask diff: [1016638.0, 1002486.0, 516850.0, 999678.0, 978624.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 9	Epoch: 0	Loss: 0.402239
Client Index = 9	Epoch: 1	Loss: 0.189524
Client Index = 9	Epoch: 2	Loss: 0.185419
Client Index = 9	Epoch: 3	Loss: 0.200798
Client Index = 9	Epoch: 4	Loss: 0.123568
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 10
local mask changes: 516824.0 / 11173962
choose client_indexes: [ 1  6  9 10 19], accoring to random
choose mask diff: [992562.0, 1029138.0, 1004836.0, 516824.0, 1010702.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 10	Epoch: 0	Loss: 0.305646
Client Index = 10	Epoch: 1	Loss: 0.279161
Client Index = 10	Epoch: 2	Loss: 0.235379
Client Index = 10	Epoch: 3	Loss: 0.326485
Client Index = 10	Epoch: 4	Loss: 0.244656
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 11
local mask changes: 517166.0 / 11173962
choose client_indexes: [ 2  4  9 10 11], accoring to random
choose mask diff: [987208.0, 979244.0, 990746.0, 1003308.0, 517166.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.185791
Client Index = 11	Epoch: 1	Loss: 0.226829
Client Index = 11	Epoch: 2	Loss: 0.144433
Client Index = 11	Epoch: 3	Loss: 0.108647
Client Index = 11	Epoch: 4	Loss: 0.228422
test acc on this client after 467 / 504 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 12
local mask changes: 516528.0 / 11173962
choose client_indexes: [ 0  3 10 12 16], accoring to random
choose mask diff: [1005726.0, 1014150.0, 1006632.0, 516528.0, 1000396.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 12	Epoch: 0	Loss: 0.430457
Client Index = 12	Epoch: 1	Loss: 0.254082
Client Index = 12	Epoch: 2	Loss: 0.243646
Client Index = 12	Epoch: 3	Loss: 0.198918
Client Index = 12	Epoch: 4	Loss: 0.206286
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 13
local mask changes: 516720.0 / 11173962
choose client_indexes: [ 4  8 12 13 15], accoring to random
choose mask diff: [1002514.0, 1004590.0, 1012274.0, 516720.0, 1006252.0]
Doing local aggregation!
test acc on this client before 418 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.385043
Client Index = 13	Epoch: 1	Loss: 0.249716
Client Index = 13	Epoch: 2	Loss: 0.210980
Client Index = 13	Epoch: 3	Loss: 0.192763
Client Index = 13	Epoch: 4	Loss: 0.251013
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 14
local mask changes: 516398.0 / 11173962
choose client_indexes: [ 7  9 14 15 19], accoring to random
choose mask diff: [1001860.0, 991040.0, 516398.0, 994582.0, 1014392.0]
Doing local aggregation!
test acc on this client before 414 / 502 : 0.82
Client Index = 14	Epoch: 0	Loss: 0.383891
Client Index = 14	Epoch: 1	Loss: 0.305678
Client Index = 14	Epoch: 2	Loss: 0.311407
Client Index = 14	Epoch: 3	Loss: 0.236600
Client Index = 14	Epoch: 4	Loss: 0.214843
test acc on this client after 399 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 15
local mask changes: 516782.0 / 11173962
choose client_indexes: [ 1  6 10 15 18], accoring to random
choose mask diff: [992444.0, 1019930.0, 992722.0, 516782.0, 997144.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.300544
Client Index = 15	Epoch: 1	Loss: 0.205448
Client Index = 15	Epoch: 2	Loss: 0.212470
Client Index = 15	Epoch: 3	Loss: 0.170426
Client Index = 15	Epoch: 4	Loss: 0.161809
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 16
local mask changes: 516886.0 / 11173962
choose client_indexes: [ 3  9 13 16 17], accoring to random
choose mask diff: [1000182.0, 986084.0, 1001210.0, 516886.0, 993422.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.311888
Client Index = 16	Epoch: 1	Loss: 0.263920
Client Index = 16	Epoch: 2	Loss: 0.180250
Client Index = 16	Epoch: 3	Loss: 0.126862
Client Index = 16	Epoch: 4	Loss: 0.134130
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 17
local mask changes: 516744.0 / 11173962
choose client_indexes: [11 12 13 17 18], accoring to random
choose mask diff: [971362.0, 999068.0, 983344.0, 516744.0, 986660.0]
Doing local aggregation!
test acc on this client before 420 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.369788
Client Index = 17	Epoch: 1	Loss: 0.256590
Client Index = 17	Epoch: 2	Loss: 0.193726
Client Index = 17	Epoch: 3	Loss: 0.112908
Client Index = 17	Epoch: 4	Loss: 0.267689
test acc on this client after 444 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 18
local mask changes: 517318.0 / 11173962
choose client_indexes: [ 1  5 12 13 18], accoring to random
choose mask diff: [979486.0, 970602.0, 996258.0, 996142.0, 517318.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.298970
Client Index = 18	Epoch: 1	Loss: 0.251651
Client Index = 18	Epoch: 2	Loss: 0.175994
Client Index = 18	Epoch: 3	Loss: 0.187484
Client Index = 18	Epoch: 4	Loss: 0.191352
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(78) with spasity 0.5: 19
local mask changes: 516846.0 / 11173962
choose client_indexes: [ 4 14 16 18 19], accoring to random
choose mask diff: [987752.0, 1008476.0, 999294.0, 979472.0, 516846.0]
Doing local aggregation!
test acc on this client before 397 / 506 : 0.78
Client Index = 19	Epoch: 0	Loss: 0.387863
Client Index = 19	Epoch: 1	Loss: 0.243764
Client Index = 19	Epoch: 2	Loss: 0.182138
Client Index = 19	Epoch: 3	Loss: 0.284364
Client Index = 19	Epoch: 4	Loss: 0.129675
test acc on this client after 420 / 506 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 78
{'test_acc': 0.8425857096799891, 'test_loss': 0.5234842914660701}
################local_test_on_all_clients before local training in communication round: 78
{'test_acc': 0.8327651625487459, 'test_loss': 0.5335168537763819}
################Communication round : 79
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 0
local mask changes: 476978.0 / 11173962
choose client_indexes: [ 0  2  4 12 17], accoring to random
choose mask diff: [476978.0, 985498.0, 989438.0, 984886.0, 990650.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.387035
Client Index = 0	Epoch: 1	Loss: 0.430135
Client Index = 0	Epoch: 2	Loss: 0.370954
Client Index = 0	Epoch: 3	Loss: 0.348617
Client Index = 0	Epoch: 4	Loss: 0.273712
test acc on this client after 307 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 1
local mask changes: 476938.0 / 11173962
choose client_indexes: [ 0  1  5  7 12], accoring to random
choose mask diff: [978764.0, 476938.0, 953720.0, 964280.0, 968784.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.469478
Client Index = 1	Epoch: 1	Loss: 0.170217
Client Index = 1	Epoch: 2	Loss: 0.129853
Client Index = 1	Epoch: 3	Loss: 0.121993
Client Index = 1	Epoch: 4	Loss: 0.116647
test acc on this client after 443 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 2
local mask changes: 476764.0 / 11173962
choose client_indexes: [ 2 10 11 12 15], accoring to random
choose mask diff: [476764.0, 970556.0, 957560.0, 963940.0, 960854.0]
Doing local aggregation!
test acc on this client before 433 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.246583
Client Index = 2	Epoch: 1	Loss: 0.149479
Client Index = 2	Epoch: 2	Loss: 0.128006
Client Index = 2	Epoch: 3	Loss: 0.158003
Client Index = 2	Epoch: 4	Loss: 0.079109
test acc on this client after 453 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 3
local mask changes: 477456.0 / 11173962
choose client_indexes: [ 2  3  4  9 11], accoring to random
choose mask diff: [969590.0, 477456.0, 962206.0, 974748.0, 978436.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 3	Epoch: 0	Loss: 0.395864
Client Index = 3	Epoch: 1	Loss: 0.383005
Client Index = 3	Epoch: 2	Loss: 0.330897
Client Index = 3	Epoch: 3	Loss: 0.282047
Client Index = 3	Epoch: 4	Loss: 0.291407
test acc on this client after 338 / 504 : 0.67
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 4
local mask changes: 477160.0 / 11173962
choose client_indexes: [ 4  5 13 18 19], accoring to random
choose mask diff: [477160.0, 975412.0, 978304.0, 958870.0, 965106.0]
Doing local aggregation!
test acc on this client before 398 / 503 : 0.79
Client Index = 4	Epoch: 0	Loss: 0.330245
Client Index = 4	Epoch: 1	Loss: 0.187541
Client Index = 4	Epoch: 2	Loss: 0.179365
Client Index = 4	Epoch: 3	Loss: 0.134434
Client Index = 4	Epoch: 4	Loss: 0.188254
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 5
local mask changes: 477524.0 / 11173962
choose client_indexes: [ 4  5 12 14 16], accoring to random
choose mask diff: [974596.0, 477524.0, 976746.0, 977694.0, 966394.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 5	Epoch: 0	Loss: 0.300663
Client Index = 5	Epoch: 1	Loss: 0.242225
Client Index = 5	Epoch: 2	Loss: 0.251607
Client Index = 5	Epoch: 3	Loss: 0.171545
Client Index = 5	Epoch: 4	Loss: 0.154070
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 6
local mask changes: 477252.0 / 11173962
choose client_indexes: [ 0  6 10 11 19], accoring to random
choose mask diff: [986802.0, 477252.0, 1004022.0, 975770.0, 986828.0]
Doing local aggregation!
test acc on this client before 415 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.399637
Client Index = 6	Epoch: 1	Loss: 0.337917
Client Index = 6	Epoch: 2	Loss: 0.431369
Client Index = 6	Epoch: 3	Loss: 0.341980
Client Index = 6	Epoch: 4	Loss: 0.280113
test acc on this client after 333 / 505 : 0.66
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 7
local mask changes: 477412.0 / 11173962
choose client_indexes: [ 5  7  8 13 19], accoring to random
choose mask diff: [958784.0, 477412.0, 963874.0, 983004.0, 982020.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.392211
Client Index = 7	Epoch: 1	Loss: 0.252157
Client Index = 7	Epoch: 2	Loss: 0.232505
Client Index = 7	Epoch: 3	Loss: 0.188049
Client Index = 7	Epoch: 4	Loss: 0.317728
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 8
local mask changes: 477160.0 / 11173962
choose client_indexes: [ 5  8  9 16 18], accoring to random
choose mask diff: [965582.0, 477160.0, 974024.0, 983278.0, 960924.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.490780
Client Index = 8	Epoch: 1	Loss: 0.331915
Client Index = 8	Epoch: 2	Loss: 0.318075
Client Index = 8	Epoch: 3	Loss: 0.289958
Client Index = 8	Epoch: 4	Loss: 0.181252
test acc on this client after 408 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 9
local mask changes: 477428.0 / 11173962
choose client_indexes: [ 9 10 13 17 18], accoring to random
choose mask diff: [477428.0, 979156.0, 975600.0, 953938.0, 953772.0]
Doing local aggregation!
test acc on this client before 427 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.389731
Client Index = 9	Epoch: 1	Loss: 0.217341
Client Index = 9	Epoch: 2	Loss: 0.180985
Client Index = 9	Epoch: 3	Loss: 0.169363
Client Index = 9	Epoch: 4	Loss: 0.143462
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 10
local mask changes: 477292.0 / 11173962
choose client_indexes: [ 2  9 10 14 17], accoring to random
choose mask diff: [972744.0, 975602.0, 477292.0, 982742.0, 974724.0]
Doing local aggregation!
test acc on this client before 406 / 503 : 0.81
Client Index = 10	Epoch: 0	Loss: 0.508954
Client Index = 10	Epoch: 1	Loss: 0.217699
Client Index = 10	Epoch: 2	Loss: 0.205983
Client Index = 10	Epoch: 3	Loss: 0.254954
Client Index = 10	Epoch: 4	Loss: 0.151087
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 11
local mask changes: 477372.0 / 11173962
choose client_indexes: [ 4  6 11 13 17], accoring to random
choose mask diff: [950802.0, 974614.0, 477372.0, 971642.0, 944348.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.256381
Client Index = 11	Epoch: 1	Loss: 0.178974
Client Index = 11	Epoch: 2	Loss: 0.173656
Client Index = 11	Epoch: 3	Loss: 0.124978
Client Index = 11	Epoch: 4	Loss: 0.097226
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 12
local mask changes: 477170.0 / 11173962
choose client_indexes: [ 5  9 11 12 13], accoring to random
choose mask diff: [978162.0, 972332.0, 973572.0, 477170.0, 988194.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.349149
Client Index = 12	Epoch: 1	Loss: 0.298469
Client Index = 12	Epoch: 2	Loss: 0.240110
Client Index = 12	Epoch: 3	Loss: 0.343163
Client Index = 12	Epoch: 4	Loss: 0.190075
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 13
local mask changes: 477170.0 / 11173962
choose client_indexes: [ 2  3  4  9 13], accoring to random
choose mask diff: [971828.0, 988430.0, 973448.0, 974186.0, 477170.0]
Doing local aggregation!
test acc on this client before 422 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.326401
Client Index = 13	Epoch: 1	Loss: 0.301396
Client Index = 13	Epoch: 2	Loss: 0.257553
Client Index = 13	Epoch: 3	Loss: 0.201023
Client Index = 13	Epoch: 4	Loss: 0.171931
test acc on this client after 390 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 14
local mask changes: 477154.0 / 11173962
choose client_indexes: [ 2  6  8 14 19], accoring to random
choose mask diff: [962950.0, 987912.0, 981774.0, 477154.0, 980768.0]
Doing local aggregation!
test acc on this client before 429 / 502 : 0.85
Client Index = 14	Epoch: 0	Loss: 0.401217
Client Index = 14	Epoch: 1	Loss: 0.291807
Client Index = 14	Epoch: 2	Loss: 0.296122
Client Index = 14	Epoch: 3	Loss: 0.241382
Client Index = 14	Epoch: 4	Loss: 0.229958
test acc on this client after 398 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 15
local mask changes: 477364.0 / 11173962
choose client_indexes: [ 1  8 10 12 15], accoring to random
choose mask diff: [963828.0, 972764.0, 964842.0, 977910.0, 477364.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.256994
Client Index = 15	Epoch: 1	Loss: 0.243349
Client Index = 15	Epoch: 2	Loss: 0.353778
Client Index = 15	Epoch: 3	Loss: 0.173293
Client Index = 15	Epoch: 4	Loss: 0.170279
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 16
local mask changes: 477004.0 / 11173962
choose client_indexes: [ 1  3  5  9 16], accoring to random
choose mask diff: [967334.0, 971754.0, 965478.0, 958114.0, 477004.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.286704
Client Index = 16	Epoch: 1	Loss: 0.328945
Client Index = 16	Epoch: 2	Loss: 0.180089
Client Index = 16	Epoch: 3	Loss: 0.152665
Client Index = 16	Epoch: 4	Loss: 0.189510
test acc on this client after 432 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 17
local mask changes: 476874.0 / 11173962
choose client_indexes: [ 4  8 12 13 17], accoring to random
choose mask diff: [952864.0, 967098.0, 967832.0, 954954.0, 476874.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.390304
Client Index = 17	Epoch: 1	Loss: 0.211215
Client Index = 17	Epoch: 2	Loss: 0.235106
Client Index = 17	Epoch: 3	Loss: 0.162159
Client Index = 17	Epoch: 4	Loss: 0.110994
test acc on this client after 427 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 18
local mask changes: 477304.0 / 11173962
choose client_indexes: [ 2  5  6 17 18], accoring to random
choose mask diff: [953134.0, 943102.0, 976056.0, 955442.0, 477304.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.284530
Client Index = 18	Epoch: 1	Loss: 0.196270
Client Index = 18	Epoch: 2	Loss: 0.228324
Client Index = 18	Epoch: 3	Loss: 0.158676
Client Index = 18	Epoch: 4	Loss: 0.138743
test acc on this client after 455 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(79) with spasity 0.5: 19
local mask changes: 477280.0 / 11173962
choose client_indexes: [ 1  4 15 18 19], accoring to random
choose mask diff: [966554.0, 958668.0, 983012.0, 950298.0, 477280.0]
Doing local aggregation!
test acc on this client before 410 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.324384
Client Index = 19	Epoch: 1	Loss: 0.184751
Client Index = 19	Epoch: 2	Loss: 0.268382
Client Index = 19	Epoch: 3	Loss: 0.166443
Client Index = 19	Epoch: 4	Loss: 0.180719
test acc on this client after 406 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 79
{'test_acc': 0.8173110571823987, 'test_loss': 0.6269797119766898}
################local_test_on_all_clients before local training in communication round: 79
{'test_acc': 0.8386278675741906, 'test_loss': 0.5129670383161246}
################Communication round : 80
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 0
local mask changes: 438696.0 / 11173962
choose client_indexes: [ 0  3  6  7 17], accoring to random
choose mask diff: [438696.0, 975844.0, 968384.0, 971670.0, 964712.0]
Doing local aggregation!
test acc on this client before 372 / 504 : 0.74
Client Index = 0	Epoch: 0	Loss: 0.459432
Client Index = 0	Epoch: 1	Loss: 0.389849
Client Index = 0	Epoch: 2	Loss: 0.333027
Client Index = 0	Epoch: 3	Loss: 0.485642
Client Index = 0	Epoch: 4	Loss: 0.270807
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 1
local mask changes: 438466.0 / 11173962
choose client_indexes: [ 1  2  3  8 16], accoring to random
choose mask diff: [438466.0, 928366.0, 943380.0, 948340.0, 941546.0]
Doing local aggregation!
test acc on this client before 441 / 503 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.252260
Client Index = 1	Epoch: 1	Loss: 0.164161
Client Index = 1	Epoch: 2	Loss: 0.129986
Client Index = 1	Epoch: 3	Loss: 0.388549
Client Index = 1	Epoch: 4	Loss: 0.101547
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 2
local mask changes: 438774.0 / 11173962
choose client_indexes: [ 2  3  4  5 19], accoring to random
choose mask diff: [438774.0, 945728.0, 933678.0, 942942.0, 945542.0]
Doing local aggregation!
test acc on this client before 433 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.465142
Client Index = 2	Epoch: 1	Loss: 0.172711
Client Index = 2	Epoch: 2	Loss: 0.123208
Client Index = 2	Epoch: 3	Loss: 0.108694
Client Index = 2	Epoch: 4	Loss: 0.079455
test acc on this client after 449 / 502 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 3
local mask changes: 438352.0 / 11173962
choose client_indexes: [ 3  4  5 10 19], accoring to random
choose mask diff: [438352.0, 936640.0, 959946.0, 965384.0, 942712.0]
Doing local aggregation!
test acc on this client before 398 / 504 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.462772
Client Index = 3	Epoch: 1	Loss: 0.387096
Client Index = 3	Epoch: 2	Loss: 0.283082
Client Index = 3	Epoch: 3	Loss: 0.332820
Client Index = 3	Epoch: 4	Loss: 0.250815
test acc on this client after 402 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 4
local mask changes: 438574.0 / 11173962
choose client_indexes: [ 4  5 10 15 17], accoring to random
choose mask diff: [438574.0, 946432.0, 944028.0, 957298.0, 929894.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.437699
Client Index = 4	Epoch: 1	Loss: 0.168519
Client Index = 4	Epoch: 2	Loss: 0.190959
Client Index = 4	Epoch: 3	Loss: 0.171616
Client Index = 4	Epoch: 4	Loss: 0.120905
test acc on this client after 439 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 5
local mask changes: 438882.0 / 11173962
choose client_indexes: [ 0  4  5  7 16], accoring to random
choose mask diff: [960462.0, 945476.0, 438882.0, 936630.0, 937714.0]
Doing local aggregation!
test acc on this client before 411 / 504 : 0.82
Client Index = 5	Epoch: 0	Loss: 0.262871
Client Index = 5	Epoch: 1	Loss: 0.285273
Client Index = 5	Epoch: 2	Loss: 0.179427
Client Index = 5	Epoch: 3	Loss: 0.174969
Client Index = 5	Epoch: 4	Loss: 0.143604
test acc on this client after 400 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 6
local mask changes: 438436.0 / 11173962
choose client_indexes: [ 4  5  6  9 12], accoring to random
choose mask diff: [948506.0, 955676.0, 438436.0, 967950.0, 976728.0]
Doing local aggregation!
test acc on this client before 404 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.537826
Client Index = 6	Epoch: 1	Loss: 0.360202
Client Index = 6	Epoch: 2	Loss: 0.340330
Client Index = 6	Epoch: 3	Loss: 0.261169
Client Index = 6	Epoch: 4	Loss: 0.235882
test acc on this client after 407 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 7
local mask changes: 438726.0 / 11173962
choose client_indexes: [ 1  6  7  9 13], accoring to random
choose mask diff: [942100.0, 961472.0, 438726.0, 946898.0, 954546.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.374190
Client Index = 7	Epoch: 1	Loss: 0.232373
Client Index = 7	Epoch: 2	Loss: 0.283824
Client Index = 7	Epoch: 3	Loss: 0.156962
Client Index = 7	Epoch: 4	Loss: 0.225745
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 8
local mask changes: 438430.0 / 11173962
choose client_indexes: [ 6  8 11 12 16], accoring to random
choose mask diff: [962152.0, 438430.0, 939502.0, 962102.0, 954388.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 8	Epoch: 0	Loss: 0.482525
Client Index = 8	Epoch: 1	Loss: 0.295013
Client Index = 8	Epoch: 2	Loss: 0.274560
Client Index = 8	Epoch: 3	Loss: 0.228461
Client Index = 8	Epoch: 4	Loss: 0.205722
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 9
local mask changes: 438552.0 / 11173962
choose client_indexes: [ 1  9 13 16 19], accoring to random
choose mask diff: [929948.0, 438552.0, 946316.0, 934846.0, 947394.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.241945
Client Index = 9	Epoch: 1	Loss: 0.291833
Client Index = 9	Epoch: 2	Loss: 0.159789
Client Index = 9	Epoch: 3	Loss: 0.162415
Client Index = 9	Epoch: 4	Loss: 0.152539
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 10
local mask changes: 438596.0 / 11173962
choose client_indexes: [ 5 10 12 16 17], accoring to random
choose mask diff: [953140.0, 438596.0, 952334.0, 954170.0, 946064.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.430129
Client Index = 10	Epoch: 1	Loss: 0.264655
Client Index = 10	Epoch: 2	Loss: 0.243235
Client Index = 10	Epoch: 3	Loss: 0.220264
Client Index = 10	Epoch: 4	Loss: 0.186221
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 11
local mask changes: 438558.0 / 11173962
choose client_indexes: [ 1  8  9 11 13], accoring to random
choose mask diff: [934628.0, 938378.0, 937096.0, 438558.0, 942276.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 11	Epoch: 0	Loss: 0.248117
Client Index = 11	Epoch: 1	Loss: 0.175482
Client Index = 11	Epoch: 2	Loss: 0.231551
Client Index = 11	Epoch: 3	Loss: 0.104517
Client Index = 11	Epoch: 4	Loss: 0.072139
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 12
local mask changes: 438774.0 / 11173962
choose client_indexes: [ 6  7 12 18 19], accoring to random
choose mask diff: [975272.0, 948006.0, 438774.0, 945144.0, 959114.0]
Doing local aggregation!
test acc on this client before 404 / 504 : 0.80
Client Index = 12	Epoch: 0	Loss: 0.317990
Client Index = 12	Epoch: 1	Loss: 0.274924
Client Index = 12	Epoch: 2	Loss: 0.280627
Client Index = 12	Epoch: 3	Loss: 0.216877
Client Index = 12	Epoch: 4	Loss: 0.425429
test acc on this client after 413 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 13
local mask changes: 438610.0 / 11173962
choose client_indexes: [ 7 10 11 13 18], accoring to random
choose mask diff: [958650.0, 952772.0, 947698.0, 438610.0, 943702.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.330871
Client Index = 13	Epoch: 1	Loss: 0.247092
Client Index = 13	Epoch: 2	Loss: 0.240689
Client Index = 13	Epoch: 3	Loss: 0.368758
Client Index = 13	Epoch: 4	Loss: 0.182511
test acc on this client after 398 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 14
local mask changes: 438590.0 / 11173962
choose client_indexes: [ 5  7 14 17 19], accoring to random
choose mask diff: [956422.0, 946868.0, 438590.0, 946484.0, 950684.0]
Doing local aggregation!
test acc on this client before 400 / 502 : 0.80
Client Index = 14	Epoch: 0	Loss: 0.380655
Client Index = 14	Epoch: 1	Loss: 0.283501
Client Index = 14	Epoch: 2	Loss: 0.276130
Client Index = 14	Epoch: 3	Loss: 0.326957
Client Index = 14	Epoch: 4	Loss: 0.207188
test acc on this client after 396 / 502 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 15
local mask changes: 438596.0 / 11173962
choose client_indexes: [ 3  5 10 15 16], accoring to random
choose mask diff: [957200.0, 947786.0, 938530.0, 438596.0, 955612.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.313020
Client Index = 15	Epoch: 1	Loss: 0.186253
Client Index = 15	Epoch: 2	Loss: 0.259188
Client Index = 15	Epoch: 3	Loss: 0.153813
Client Index = 15	Epoch: 4	Loss: 0.125301
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 16
local mask changes: 438694.0 / 11173962
choose client_indexes: [ 2 10 15 16 17], accoring to random
choose mask diff: [945090.0, 954152.0, 954652.0, 438694.0, 939998.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.479906
Client Index = 16	Epoch: 1	Loss: 0.214889
Client Index = 16	Epoch: 2	Loss: 0.165427
Client Index = 16	Epoch: 3	Loss: 0.157074
Client Index = 16	Epoch: 4	Loss: 0.137409
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 17
local mask changes: 438210.0 / 11173962
choose client_indexes: [ 5  6  9 12 17], accoring to random
choose mask diff: [917622.0, 955038.0, 929012.0, 940116.0, 438210.0]
Doing local aggregation!
test acc on this client before 404 / 505 : 0.80
Client Index = 17	Epoch: 0	Loss: 0.461045
Client Index = 17	Epoch: 1	Loss: 0.301916
Client Index = 17	Epoch: 2	Loss: 0.177329
Client Index = 17	Epoch: 3	Loss: 0.128793
Client Index = 17	Epoch: 4	Loss: 0.148757
test acc on this client after 387 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 18
local mask changes: 438558.0 / 11173962
choose client_indexes: [ 3 12 13 16 18], accoring to random
choose mask diff: [944542.0, 944486.0, 942294.0, 933164.0, 438558.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 18	Epoch: 0	Loss: 0.364842
Client Index = 18	Epoch: 1	Loss: 0.244109
Client Index = 18	Epoch: 2	Loss: 0.179715
Client Index = 18	Epoch: 3	Loss: 0.173734
Client Index = 18	Epoch: 4	Loss: 0.148227
test acc on this client after 453 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(80) with spasity 0.5: 19
local mask changes: 438184.0 / 11173962
choose client_indexes: [ 4 10 12 17 19], accoring to random
choose mask diff: [933034.0, 956790.0, 957820.0, 939582.0, 438184.0]
Doing local aggregation!
test acc on this client before 420 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.271426
Client Index = 19	Epoch: 1	Loss: 0.222407
Client Index = 19	Epoch: 2	Loss: 0.189110
Client Index = 19	Epoch: 3	Loss: 0.179169
Client Index = 19	Epoch: 4	Loss: 0.214898
test acc on this client after 416 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 80
{'test_acc': 0.8230427837527697, 'test_loss': 0.5766994747591964}
################local_test_on_all_clients before local training in communication round: 80
{'test_acc': 0.8284999327373566, 'test_loss': 0.5475805956302258}
################Communication round : 81
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 0
local mask changes: 401060.0 / 11173962
choose client_indexes: [ 0  4 10 12 15], accoring to random
choose mask diff: [401060.0, 939706.0, 955212.0, 937968.0, 948210.0]
Doing local aggregation!
test acc on this client before 382 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.475035
Client Index = 0	Epoch: 1	Loss: 0.394116
Client Index = 0	Epoch: 2	Loss: 0.312891
Client Index = 0	Epoch: 3	Loss: 0.341567
Client Index = 0	Epoch: 4	Loss: 0.348080
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 1
local mask changes: 400870.0 / 11173962
choose client_indexes: [ 1  7 13 14 16], accoring to random
choose mask diff: [400870.0, 915490.0, 927494.0, 928238.0, 911444.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.261079
Client Index = 1	Epoch: 1	Loss: 0.174751
Client Index = 1	Epoch: 2	Loss: 0.145735
Client Index = 1	Epoch: 3	Loss: 0.233928
Client Index = 1	Epoch: 4	Loss: 0.110054
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 2
local mask changes: 401194.0 / 11173962
choose client_indexes: [ 2  4 10 15 19], accoring to random
choose mask diff: [401194.0, 906700.0, 917038.0, 912440.0, 917850.0]
Doing local aggregation!
test acc on this client before 426 / 502 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.277035
Client Index = 2	Epoch: 1	Loss: 0.201999
Client Index = 2	Epoch: 2	Loss: 0.124088
Client Index = 2	Epoch: 3	Loss: 0.092242
Client Index = 2	Epoch: 4	Loss: 0.106148
test acc on this client after 453 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 3
local mask changes: 400914.0 / 11173962
choose client_indexes: [ 3  7 12 13 16], accoring to random
choose mask diff: [400914.0, 932820.0, 935152.0, 938050.0, 924232.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.515804
Client Index = 3	Epoch: 1	Loss: 0.347253
Client Index = 3	Epoch: 2	Loss: 0.334599
Client Index = 3	Epoch: 3	Loss: 0.288595
Client Index = 3	Epoch: 4	Loss: 0.289967
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 4
local mask changes: 401620.0 / 11173962
choose client_indexes: [ 0  3  4 11 17], accoring to random
choose mask diff: [936750.0, 916136.0, 401620.0, 902064.0, 899306.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.410652
Client Index = 4	Epoch: 1	Loss: 0.181129
Client Index = 4	Epoch: 2	Loss: 0.163130
Client Index = 4	Epoch: 3	Loss: 0.124479
Client Index = 4	Epoch: 4	Loss: 0.361097
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 5
local mask changes: 401212.0 / 11173962
choose client_indexes: [ 0  1  5  9 19], accoring to random
choose mask diff: [935488.0, 906180.0, 401212.0, 915686.0, 930124.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 5	Epoch: 0	Loss: 0.343496
Client Index = 5	Epoch: 1	Loss: 0.224156
Client Index = 5	Epoch: 2	Loss: 0.205348
Client Index = 5	Epoch: 3	Loss: 0.190657
Client Index = 5	Epoch: 4	Loss: 0.157921
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 6
local mask changes: 401080.0 / 11173962
choose client_indexes: [ 4  6 10 13 19], accoring to random
choose mask diff: [922218.0, 401080.0, 949180.0, 940142.0, 938208.0]
Doing local aggregation!
test acc on this client before 412 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.438329
Client Index = 6	Epoch: 1	Loss: 0.396689
Client Index = 6	Epoch: 2	Loss: 0.333193
Client Index = 6	Epoch: 3	Loss: 0.333565
Client Index = 6	Epoch: 4	Loss: 0.324105
test acc on this client after 399 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 7
local mask changes: 401242.0 / 11173962
choose client_indexes: [ 2  4  7 13 14], accoring to random
choose mask diff: [916934.0, 926384.0, 401242.0, 928378.0, 926994.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 7	Epoch: 0	Loss: 0.367427
Client Index = 7	Epoch: 1	Loss: 0.200687
Client Index = 7	Epoch: 2	Loss: 0.243979
Client Index = 7	Epoch: 3	Loss: 0.371306
Client Index = 7	Epoch: 4	Loss: 0.158289
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 8
local mask changes: 401102.0 / 11173962
choose client_indexes: [ 7  8  9 11 13], accoring to random
choose mask diff: [916342.0, 401102.0, 923502.0, 913294.0, 931590.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.496019
Client Index = 8	Epoch: 1	Loss: 0.245119
Client Index = 8	Epoch: 2	Loss: 0.293194
Client Index = 8	Epoch: 3	Loss: 0.250587
Client Index = 8	Epoch: 4	Loss: 0.304846
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 9
local mask changes: 401480.0 / 11173962
choose client_indexes: [ 1  8  9 18 19], accoring to random
choose mask diff: [904844.0, 923730.0, 401480.0, 902694.0, 919898.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.263966
Client Index = 9	Epoch: 1	Loss: 0.223276
Client Index = 9	Epoch: 2	Loss: 0.167216
Client Index = 9	Epoch: 3	Loss: 0.230555
Client Index = 9	Epoch: 4	Loss: 0.148126
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 10
local mask changes: 401342.0 / 11173962
choose client_indexes: [ 3  6  9 10 15], accoring to random
choose mask diff: [942156.0, 950962.0, 921368.0, 401342.0, 918430.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.263684
Client Index = 10	Epoch: 1	Loss: 0.427517
Client Index = 10	Epoch: 2	Loss: 0.182634
Client Index = 10	Epoch: 3	Loss: 0.199663
Client Index = 10	Epoch: 4	Loss: 0.130825
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 11
local mask changes: 400936.0 / 11173962
choose client_indexes: [ 2 11 12 13 19], accoring to random
choose mask diff: [903496.0, 400936.0, 921014.0, 914726.0, 922336.0]
Doing local aggregation!
test acc on this client before 452 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.243000
Client Index = 11	Epoch: 1	Loss: 0.153996
Client Index = 11	Epoch: 2	Loss: 0.119217
Client Index = 11	Epoch: 3	Loss: 0.121695
Client Index = 11	Epoch: 4	Loss: 0.085985
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 12
local mask changes: 401382.0 / 11173962
choose client_indexes: [ 1  3  5 12 17], accoring to random
choose mask diff: [922024.0, 936008.0, 925114.0, 401382.0, 919904.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 12	Epoch: 0	Loss: 0.298926
Client Index = 12	Epoch: 1	Loss: 0.249090
Client Index = 12	Epoch: 2	Loss: 0.247509
Client Index = 12	Epoch: 3	Loss: 0.194821
Client Index = 12	Epoch: 4	Loss: 0.352064
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 13
local mask changes: 401382.0 / 11173962
choose client_indexes: [ 1  3 13 15 19], accoring to random
choose mask diff: [928998.0, 938876.0, 401382.0, 933808.0, 934108.0]
Doing local aggregation!
test acc on this client before 414 / 503 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.332833
Client Index = 13	Epoch: 1	Loss: 0.314286
Client Index = 13	Epoch: 2	Loss: 0.262651
Client Index = 13	Epoch: 3	Loss: 0.190138
Client Index = 13	Epoch: 4	Loss: 0.243299
test acc on this client after 406 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 14
local mask changes: 401292.0 / 11173962
choose client_indexes: [ 2  6  7 13 14], accoring to random
choose mask diff: [916702.0, 939966.0, 923288.0, 936126.0, 401292.0]
Doing local aggregation!
test acc on this client before 421 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.380242
Client Index = 14	Epoch: 1	Loss: 0.286630
Client Index = 14	Epoch: 2	Loss: 0.313581
Client Index = 14	Epoch: 3	Loss: 0.252206
Client Index = 14	Epoch: 4	Loss: 0.398326
test acc on this client after 387 / 502 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 15
local mask changes: 401400.0 / 11173962
choose client_indexes: [ 0 11 12 15 16], accoring to random
choose mask diff: [945096.0, 922036.0, 929404.0, 401400.0, 928816.0]
Doing local aggregation!
test acc on this client before 423 / 504 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.234874
Client Index = 15	Epoch: 1	Loss: 0.212326
Client Index = 15	Epoch: 2	Loss: 0.205124
Client Index = 15	Epoch: 3	Loss: 0.164957
Client Index = 15	Epoch: 4	Loss: 0.135852
test acc on this client after 396 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 16
local mask changes: 400914.0 / 11173962
choose client_indexes: [ 9 12 13 14 16], accoring to random
choose mask diff: [909180.0, 927126.0, 925500.0, 931006.0, 400914.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 16	Epoch: 0	Loss: 0.303706
Client Index = 16	Epoch: 1	Loss: 0.240859
Client Index = 16	Epoch: 2	Loss: 0.196714
Client Index = 16	Epoch: 3	Loss: 0.140920
Client Index = 16	Epoch: 4	Loss: 0.127543
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 17
local mask changes: 400856.0 / 11173962
choose client_indexes: [ 0  1  6 12 17], accoring to random
choose mask diff: [939408.0, 903080.0, 929068.0, 913042.0, 400856.0]
Doing local aggregation!
test acc on this client before 434 / 505 : 0.86
Client Index = 17	Epoch: 0	Loss: 0.375574
Client Index = 17	Epoch: 1	Loss: 0.249368
Client Index = 17	Epoch: 2	Loss: 0.159417
Client Index = 17	Epoch: 3	Loss: 0.130221
Client Index = 17	Epoch: 4	Loss: 0.301717
test acc on this client after 451 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 18
local mask changes: 401060.0 / 11173962
choose client_indexes: [ 3  9 10 15 18], accoring to random
choose mask diff: [918148.0, 902324.0, 931738.0, 920700.0, 401060.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 18	Epoch: 0	Loss: 0.534506
Client Index = 18	Epoch: 1	Loss: 0.242716
Client Index = 18	Epoch: 2	Loss: 0.181712
Client Index = 18	Epoch: 3	Loss: 0.230136
Client Index = 18	Epoch: 4	Loss: 0.176745
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(81) with spasity 0.5: 19
local mask changes: 401274.0 / 11173962
choose client_indexes: [ 7  8 14 15 19], accoring to random
choose mask diff: [932542.0, 937698.0, 930094.0, 932790.0, 401274.0]
Doing local aggregation!
test acc on this client before 391 / 506 : 0.77
Client Index = 19	Epoch: 0	Loss: 0.458162
Client Index = 19	Epoch: 1	Loss: 0.219330
Client Index = 19	Epoch: 2	Loss: 0.160371
Client Index = 19	Epoch: 3	Loss: 0.217983
Client Index = 19	Epoch: 4	Loss: 0.117066
test acc on this client after 427 / 506 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 81
{'test_acc': 0.8350401117484155, 'test_loss': 0.5323314264291408}
################local_test_on_all_clients before local training in communication round: 81
{'test_acc': 0.8339631578309268, 'test_loss': 0.5158238181217216}
################Communication round : 82
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 0
local mask changes: 364776.0 / 11173962
choose client_indexes: [ 0 11 13 16 19], accoring to random
choose mask diff: [364776.0, 918150.0, 942358.0, 932560.0, 933584.0]
Doing local aggregation!
test acc on this client before 394 / 504 : 0.78
Client Index = 0	Epoch: 0	Loss: 0.438680
Client Index = 0	Epoch: 1	Loss: 0.364460
Client Index = 0	Epoch: 2	Loss: 0.422930
Client Index = 0	Epoch: 3	Loss: 0.253854
Client Index = 0	Epoch: 4	Loss: 0.487893
test acc on this client after 392 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 1
local mask changes: 365296.0 / 11173962
choose client_indexes: [ 1  3 10 12 18], accoring to random
choose mask diff: [365296.0, 898378.0, 897216.0, 901148.0, 881996.0]
Doing local aggregation!
test acc on this client before 446 / 503 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.191286
Client Index = 1	Epoch: 1	Loss: 0.158269
Client Index = 1	Epoch: 2	Loss: 0.156683
Client Index = 1	Epoch: 3	Loss: 0.131990
Client Index = 1	Epoch: 4	Loss: 0.111404
test acc on this client after 453 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 2
local mask changes: 365352.0 / 11173962
choose client_indexes: [2 3 5 7 9], accoring to random
choose mask diff: [365352.0, 894932.0, 894566.0, 896528.0, 899202.0]
Doing local aggregation!
test acc on this client before 442 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.187939
Client Index = 2	Epoch: 1	Loss: 0.128138
Client Index = 2	Epoch: 2	Loss: 0.121635
Client Index = 2	Epoch: 3	Loss: 0.102182
Client Index = 2	Epoch: 4	Loss: 0.071486
test acc on this client after 441 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 3
local mask changes: 364980.0 / 11173962
choose client_indexes: [ 0  3 15 16 17], accoring to random
choose mask diff: [931518.0, 364980.0, 911280.0, 901380.0, 906966.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 3	Epoch: 0	Loss: 0.440479
Client Index = 3	Epoch: 1	Loss: 0.327086
Client Index = 3	Epoch: 2	Loss: 0.365394
Client Index = 3	Epoch: 3	Loss: 0.299950
Client Index = 3	Epoch: 4	Loss: 0.240309
test acc on this client after 366 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 4
local mask changes: 365200.0 / 11173962
choose client_indexes: [ 1  4 12 13 19], accoring to random
choose mask diff: [897268.0, 365200.0, 908240.0, 899400.0, 885664.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.290035
Client Index = 4	Epoch: 1	Loss: 0.181307
Client Index = 4	Epoch: 2	Loss: 0.188680
Client Index = 4	Epoch: 3	Loss: 0.128952
Client Index = 4	Epoch: 4	Loss: 0.090183
test acc on this client after 381 / 503 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 5
local mask changes: 364880.0 / 11173962
choose client_indexes: [ 0  1  5 10 14], accoring to random
choose mask diff: [912720.0, 881926.0, 364880.0, 905814.0, 906072.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 5	Epoch: 0	Loss: 0.291488
Client Index = 5	Epoch: 1	Loss: 0.305224
Client Index = 5	Epoch: 2	Loss: 0.167174
Client Index = 5	Epoch: 3	Loss: 0.262581
Client Index = 5	Epoch: 4	Loss: 0.172110
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 6
local mask changes: 364884.0 / 11173962
choose client_indexes: [ 0  6 10 11 17], accoring to random
choose mask diff: [924404.0, 364884.0, 926270.0, 904338.0, 909120.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.451760
Client Index = 6	Epoch: 1	Loss: 0.339668
Client Index = 6	Epoch: 2	Loss: 0.311457
Client Index = 6	Epoch: 3	Loss: 0.424792
Client Index = 6	Epoch: 4	Loss: 0.234017
test acc on this client after 403 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 7
local mask changes: 364986.0 / 11173962
choose client_indexes: [ 4  7 11 14 16], accoring to random
choose mask diff: [901254.0, 364986.0, 899284.0, 899812.0, 907390.0]
Doing local aggregation!
test acc on this client before 418 / 504 : 0.83
Client Index = 7	Epoch: 0	Loss: 0.305273
Client Index = 7	Epoch: 1	Loss: 0.230924
Client Index = 7	Epoch: 2	Loss: 0.258966
Client Index = 7	Epoch: 3	Loss: 0.227040
Client Index = 7	Epoch: 4	Loss: 0.152099
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 8
local mask changes: 365050.0 / 11173962
choose client_indexes: [ 2  3  5  8 12], accoring to random
choose mask diff: [898648.0, 921334.0, 896488.0, 365050.0, 916516.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.375897
Client Index = 8	Epoch: 1	Loss: 0.299957
Client Index = 8	Epoch: 2	Loss: 0.208200
Client Index = 8	Epoch: 3	Loss: 0.309087
Client Index = 8	Epoch: 4	Loss: 0.202019
test acc on this client after 369 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 9
local mask changes: 365348.0 / 11173962
choose client_indexes: [ 0  3  4  9 18], accoring to random
choose mask diff: [923712.0, 900408.0, 904808.0, 365348.0, 877082.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.243753
Client Index = 9	Epoch: 1	Loss: 0.202579
Client Index = 9	Epoch: 2	Loss: 0.199680
Client Index = 9	Epoch: 3	Loss: 0.135190
Client Index = 9	Epoch: 4	Loss: 0.118554
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 10
local mask changes: 364920.0 / 11173962
choose client_indexes: [ 1  3  9 10 11], accoring to random
choose mask diff: [898832.0, 913968.0, 898370.0, 364920.0, 907554.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 10	Epoch: 0	Loss: 0.306218
Client Index = 10	Epoch: 1	Loss: 0.229606
Client Index = 10	Epoch: 2	Loss: 0.316690
Client Index = 10	Epoch: 3	Loss: 0.225032
Client Index = 10	Epoch: 4	Loss: 0.130343
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 11
local mask changes: 365216.0 / 11173962
choose client_indexes: [ 1  2  3 11 16], accoring to random
choose mask diff: [886444.0, 878694.0, 904854.0, 365216.0, 892430.0]
Doing local aggregation!
test acc on this client before 462 / 504 : 0.92
Client Index = 11	Epoch: 0	Loss: 0.235941
Client Index = 11	Epoch: 1	Loss: 0.169730
Client Index = 11	Epoch: 2	Loss: 0.113815
Client Index = 11	Epoch: 3	Loss: 0.124127
Client Index = 11	Epoch: 4	Loss: 0.100778
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 12
local mask changes: 365150.0 / 11173962
choose client_indexes: [ 1  3 12 17 18], accoring to random
choose mask diff: [898944.0, 913216.0, 365150.0, 893422.0, 896896.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.303505
Client Index = 12	Epoch: 1	Loss: 0.265748
Client Index = 12	Epoch: 2	Loss: 0.222178
Client Index = 12	Epoch: 3	Loss: 0.225726
Client Index = 12	Epoch: 4	Loss: 0.193741
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 13
local mask changes: 365402.0 / 11173962
choose client_indexes: [ 5  8 10 12 13], accoring to random
choose mask diff: [913200.0, 913684.0, 908352.0, 915120.0, 365402.0]
Doing local aggregation!
test acc on this client before 412 / 503 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.381935
Client Index = 13	Epoch: 1	Loss: 0.229064
Client Index = 13	Epoch: 2	Loss: 0.223921
Client Index = 13	Epoch: 3	Loss: 0.150305
Client Index = 13	Epoch: 4	Loss: 0.176348
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 14
local mask changes: 364844.0 / 11173962
choose client_indexes: [ 1  4  9 12 14], accoring to random
choose mask diff: [910444.0, 906662.0, 904028.0, 928092.0, 364844.0]
Doing local aggregation!
test acc on this client before 421 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.357140
Client Index = 14	Epoch: 1	Loss: 0.315775
Client Index = 14	Epoch: 2	Loss: 0.360385
Client Index = 14	Epoch: 3	Loss: 0.201565
Client Index = 14	Epoch: 4	Loss: 0.272408
test acc on this client after 372 / 502 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 15
local mask changes: 365004.0 / 11173962
choose client_indexes: [ 0  3  7 13 15], accoring to random
choose mask diff: [923194.0, 910860.0, 903426.0, 913298.0, 365004.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 15	Epoch: 0	Loss: 0.270332
Client Index = 15	Epoch: 1	Loss: 0.179513
Client Index = 15	Epoch: 2	Loss: 0.399208
Client Index = 15	Epoch: 3	Loss: 0.151327
Client Index = 15	Epoch: 4	Loss: 0.126731
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 16
local mask changes: 365048.0 / 11173962
choose client_indexes: [ 1  3 10 16 17], accoring to random
choose mask diff: [891850.0, 904336.0, 903470.0, 365048.0, 893086.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.369140
Client Index = 16	Epoch: 1	Loss: 0.202928
Client Index = 16	Epoch: 2	Loss: 0.136144
Client Index = 16	Epoch: 3	Loss: 0.152494
Client Index = 16	Epoch: 4	Loss: 0.322446
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 17
local mask changes: 364832.0 / 11173962
choose client_indexes: [ 1 11 14 16 17], accoring to random
choose mask diff: [879160.0, 871742.0, 899804.0, 893912.0, 364832.0]
Doing local aggregation!
test acc on this client before 391 / 505 : 0.77
Client Index = 17	Epoch: 0	Loss: 0.416434
Client Index = 17	Epoch: 1	Loss: 0.206942
Client Index = 17	Epoch: 2	Loss: 0.255383
Client Index = 17	Epoch: 3	Loss: 0.139187
Client Index = 17	Epoch: 4	Loss: 0.119076
test acc on this client after 429 / 505 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 18
local mask changes: 365218.0 / 11173962
choose client_indexes: [ 3 10 14 16 18], accoring to random
choose mask diff: [892702.0, 906172.0, 904072.0, 886118.0, 365218.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.316227
Client Index = 18	Epoch: 1	Loss: 0.244513
Client Index = 18	Epoch: 2	Loss: 0.188059
Client Index = 18	Epoch: 3	Loss: 0.202751
Client Index = 18	Epoch: 4	Loss: 0.133355
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(82) with spasity 0.5: 19
local mask changes: 364968.0 / 11173962
choose client_indexes: [ 4 11 12 13 19], accoring to random
choose mask diff: [885136.0, 901768.0, 908302.0, 911800.0, 364968.0]
Doing local aggregation!
test acc on this client before 407 / 506 : 0.80
Client Index = 19	Epoch: 0	Loss: 0.231064
Client Index = 19	Epoch: 1	Loss: 0.257095
Client Index = 19	Epoch: 2	Loss: 0.292008
Client Index = 19	Epoch: 3	Loss: 0.133356
Client Index = 19	Epoch: 4	Loss: 0.153698
test acc on this client after 418 / 506 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 82
{'test_acc': 0.8227276205100879, 'test_loss': 0.5964883201468358}
################local_test_on_all_clients before local training in communication round: 82
{'test_acc': 0.837545842534239, 'test_loss': 0.49761013133412313}
################Communication round : 83
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 0
local mask changes: 330310.0 / 11173962
choose client_indexes: [ 0  8 11 15 17], accoring to random
choose mask diff: [330310.0, 916366.0, 896218.0, 903760.0, 898564.0]
Doing local aggregation!
test acc on this client before 379 / 504 : 0.75
Client Index = 0	Epoch: 0	Loss: 0.413784
Client Index = 0	Epoch: 1	Loss: 0.392419
Client Index = 0	Epoch: 2	Loss: 0.334066
Client Index = 0	Epoch: 3	Loss: 0.338366
Client Index = 0	Epoch: 4	Loss: 0.250874
test acc on this client after 371 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 1
local mask changes: 329984.0 / 11173962
choose client_indexes: [ 1 13 16 17 18], accoring to random
choose mask diff: [329984.0, 880570.0, 868200.0, 860104.0, 858770.0]
Doing local aggregation!
test acc on this client before 447 / 503 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.218942
Client Index = 1	Epoch: 1	Loss: 0.134985
Client Index = 1	Epoch: 2	Loss: 0.299316
Client Index = 1	Epoch: 3	Loss: 0.130507
Client Index = 1	Epoch: 4	Loss: 0.084766
test acc on this client after 453 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 2
local mask changes: 330498.0 / 11173962
choose client_indexes: [ 2  9 12 15 16], accoring to random
choose mask diff: [330498.0, 875008.0, 879518.0, 870350.0, 875838.0]
Doing local aggregation!
test acc on this client before 442 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.244644
Client Index = 2	Epoch: 1	Loss: 0.168375
Client Index = 2	Epoch: 2	Loss: 0.112796
Client Index = 2	Epoch: 3	Loss: 0.310042
Client Index = 2	Epoch: 4	Loss: 0.089496
test acc on this client after 456 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 3
local mask changes: 330274.0 / 11173962
choose client_indexes: [ 3  8 12 14 16], accoring to random
choose mask diff: [330274.0, 903650.0, 891938.0, 896930.0, 879812.0]
Doing local aggregation!
test acc on this client before 390 / 504 : 0.77
Client Index = 3	Epoch: 0	Loss: 0.492930
Client Index = 3	Epoch: 1	Loss: 0.305117
Client Index = 3	Epoch: 2	Loss: 0.288607
Client Index = 3	Epoch: 3	Loss: 0.247598
Client Index = 3	Epoch: 4	Loss: 0.295378
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 4
local mask changes: 329914.0 / 11173962
choose client_indexes: [ 3  4 10 11 19], accoring to random
choose mask diff: [870918.0, 329914.0, 880436.0, 859348.0, 863770.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.264238
Client Index = 4	Epoch: 1	Loss: 0.228484
Client Index = 4	Epoch: 2	Loss: 0.167887
Client Index = 4	Epoch: 3	Loss: 0.130920
Client Index = 4	Epoch: 4	Loss: 0.092764
test acc on this client after 353 / 503 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 5
local mask changes: 330380.0 / 11173962
choose client_indexes: [ 2  5  8 10 18], accoring to random
choose mask diff: [875956.0, 330380.0, 878200.0, 882902.0, 857118.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.270778
Client Index = 5	Epoch: 1	Loss: 0.183588
Client Index = 5	Epoch: 2	Loss: 0.247271
Client Index = 5	Epoch: 3	Loss: 0.154292
Client Index = 5	Epoch: 4	Loss: 0.212386
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 6
local mask changes: 330182.0 / 11173962
choose client_indexes: [ 5  6  8 11 13], accoring to random
choose mask diff: [893484.0, 330182.0, 900210.0, 882658.0, 900300.0]
Doing local aggregation!
test acc on this client before 410 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.465682
Client Index = 6	Epoch: 1	Loss: 0.290301
Client Index = 6	Epoch: 2	Loss: 0.306303
Client Index = 6	Epoch: 3	Loss: 0.410919
Client Index = 6	Epoch: 4	Loss: 0.238434
test acc on this client after 400 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 7
local mask changes: 330152.0 / 11173962
choose client_indexes: [ 1  5  7 12 15], accoring to random
choose mask diff: [869506.0, 868744.0, 330152.0, 887368.0, 884978.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.340096
Client Index = 7	Epoch: 1	Loss: 0.193181
Client Index = 7	Epoch: 2	Loss: 0.307217
Client Index = 7	Epoch: 3	Loss: 0.160566
Client Index = 7	Epoch: 4	Loss: 0.138645
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 8
local mask changes: 330224.0 / 11173962
choose client_indexes: [ 1  8 16 18 19], accoring to random
choose mask diff: [881324.0, 330224.0, 888968.0, 874282.0, 894514.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 8	Epoch: 0	Loss: 0.406977
Client Index = 8	Epoch: 1	Loss: 0.270080
Client Index = 8	Epoch: 2	Loss: 0.383744
Client Index = 8	Epoch: 3	Loss: 0.221919
Client Index = 8	Epoch: 4	Loss: 0.166752
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 9
local mask changes: 330198.0 / 11173962
choose client_indexes: [ 3  4  9 13 19], accoring to random
choose mask diff: [877098.0, 882300.0, 330198.0, 878320.0, 876350.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 9	Epoch: 0	Loss: 0.315316
Client Index = 9	Epoch: 1	Loss: 0.193674
Client Index = 9	Epoch: 2	Loss: 0.164833
Client Index = 9	Epoch: 3	Loss: 0.296568
Client Index = 9	Epoch: 4	Loss: 0.142189
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 10
local mask changes: 330258.0 / 11173962
choose client_indexes: [ 0  3  8 10 16], accoring to random
choose mask diff: [914062.0, 892144.0, 893616.0, 330258.0, 884494.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 10	Epoch: 0	Loss: 0.264490
Client Index = 10	Epoch: 1	Loss: 0.248607
Client Index = 10	Epoch: 2	Loss: 0.223344
Client Index = 10	Epoch: 3	Loss: 0.154503
Client Index = 10	Epoch: 4	Loss: 0.185816
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 11
local mask changes: 330470.0 / 11173962
choose client_indexes: [ 1 11 16 17 19], accoring to random
choose mask diff: [862954.0, 330470.0, 868142.0, 852612.0, 877058.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.241541
Client Index = 11	Epoch: 1	Loss: 0.147739
Client Index = 11	Epoch: 2	Loss: 0.207256
Client Index = 11	Epoch: 3	Loss: 0.080170
Client Index = 11	Epoch: 4	Loss: 0.119263
test acc on this client after 456 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 12
local mask changes: 330190.0 / 11173962
choose client_indexes: [ 7  8 11 12 13], accoring to random
choose mask diff: [887846.0, 899610.0, 881226.0, 330190.0, 897012.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 12	Epoch: 0	Loss: 0.309718
Client Index = 12	Epoch: 1	Loss: 0.226244
Client Index = 12	Epoch: 2	Loss: 0.220801
Client Index = 12	Epoch: 3	Loss: 0.174151
Client Index = 12	Epoch: 4	Loss: 0.160019
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 13
local mask changes: 330420.0 / 11173962
choose client_indexes: [ 0  6 11 13 18], accoring to random
choose mask diff: [921992.0, 899450.0, 871492.0, 330420.0, 875520.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 13	Epoch: 0	Loss: 0.291756
Client Index = 13	Epoch: 1	Loss: 0.252978
Client Index = 13	Epoch: 2	Loss: 0.185113
Client Index = 13	Epoch: 3	Loss: 0.172030
Client Index = 13	Epoch: 4	Loss: 0.202353
test acc on this client after 405 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 14
local mask changes: 330414.0 / 11173962
choose client_indexes: [ 0  3  7 14 18], accoring to random
choose mask diff: [916370.0, 895232.0, 880658.0, 330414.0, 887552.0]
Doing local aggregation!
test acc on this client before 424 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.302847
Client Index = 14	Epoch: 1	Loss: 0.265802
Client Index = 14	Epoch: 2	Loss: 0.252343
Client Index = 14	Epoch: 3	Loss: 0.256163
Client Index = 14	Epoch: 4	Loss: 0.222475
test acc on this client after 419 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 15
local mask changes: 330194.0 / 11173962
choose client_indexes: [ 4  8 12 13 15], accoring to random
choose mask diff: [890996.0, 884800.0, 890164.0, 888056.0, 330194.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.244191
Client Index = 15	Epoch: 1	Loss: 0.209296
Client Index = 15	Epoch: 2	Loss: 0.185211
Client Index = 15	Epoch: 3	Loss: 0.167132
Client Index = 15	Epoch: 4	Loss: 0.211694
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 16
local mask changes: 330514.0 / 11173962
choose client_indexes: [ 4 11 14 15 16], accoring to random
choose mask diff: [881446.0, 873626.0, 889576.0, 881542.0, 330514.0]
Doing local aggregation!
test acc on this client before 445 / 503 : 0.88
Client Index = 16	Epoch: 0	Loss: 0.240087
Client Index = 16	Epoch: 1	Loss: 0.201572
Client Index = 16	Epoch: 2	Loss: 0.216000
Client Index = 16	Epoch: 3	Loss: 0.185835
Client Index = 16	Epoch: 4	Loss: 0.161563
test acc on this client after 434 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 17
local mask changes: 330400.0 / 11173962
choose client_indexes: [ 5 10 14 15 17], accoring to random
choose mask diff: [854178.0, 880146.0, 877822.0, 885488.0, 330400.0]
Doing local aggregation!
test acc on this client before 420 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.437332
Client Index = 17	Epoch: 1	Loss: 0.226902
Client Index = 17	Epoch: 2	Loss: 0.179704
Client Index = 17	Epoch: 3	Loss: 0.180907
Client Index = 17	Epoch: 4	Loss: 0.175046
test acc on this client after 450 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 18
local mask changes: 330306.0 / 11173962
choose client_indexes: [ 0  2  8 17 18], accoring to random
choose mask diff: [900530.0, 862616.0, 873928.0, 862236.0, 330306.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.262805
Client Index = 18	Epoch: 1	Loss: 0.215307
Client Index = 18	Epoch: 2	Loss: 0.198153
Client Index = 18	Epoch: 3	Loss: 0.152375
Client Index = 18	Epoch: 4	Loss: 0.464677
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(83) with spasity 0.5: 19
local mask changes: 330486.0 / 11173962
choose client_indexes: [ 8 12 14 18 19], accoring to random
choose mask diff: [893344.0, 886928.0, 887104.0, 866344.0, 330486.0]
Doing local aggregation!
test acc on this client before 415 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.324770
Client Index = 19	Epoch: 1	Loss: 0.186926
Client Index = 19	Epoch: 2	Loss: 0.145542
Client Index = 19	Epoch: 3	Loss: 0.140705
Client Index = 19	Epoch: 4	Loss: 0.343458
test acc on this client after 409 / 506 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 83
{'test_acc': 0.8322690251733216, 'test_loss': 0.5503160823778176}
################local_test_on_all_clients before local training in communication round: 83
{'test_acc': 0.8393302207147064, 'test_loss': 0.5071850902802267}
################Communication round : 84
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 0
local mask changes: 296766.0 / 11173962
choose client_indexes: [ 0  3 10 13 17], accoring to random
choose mask diff: [296766.0, 893262.0, 898066.0, 901948.0, 878444.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.403191
Client Index = 0	Epoch: 1	Loss: 0.377592
Client Index = 0	Epoch: 2	Loss: 0.386573
Client Index = 0	Epoch: 3	Loss: 0.263344
Client Index = 0	Epoch: 4	Loss: 0.271860
test acc on this client after 386 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 1
local mask changes: 296902.0 / 11173962
choose client_indexes: [ 1  2  9 10 15], accoring to random
choose mask diff: [296902.0, 843636.0, 842924.0, 852746.0, 859118.0]
Doing local aggregation!
test acc on this client before 451 / 503 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.194192
Client Index = 1	Epoch: 1	Loss: 0.233493
Client Index = 1	Epoch: 2	Loss: 0.119302
Client Index = 1	Epoch: 3	Loss: 0.090976
Client Index = 1	Epoch: 4	Loss: 0.060022
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 2
local mask changes: 296684.0 / 11173962
choose client_indexes: [ 2  4  6  8 12], accoring to random
choose mask diff: [296684.0, 846828.0, 879562.0, 859088.0, 858302.0]
Doing local aggregation!
test acc on this client before 438 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.225179
Client Index = 2	Epoch: 1	Loss: 0.132674
Client Index = 2	Epoch: 2	Loss: 0.106655
Client Index = 2	Epoch: 3	Loss: 0.090260
Client Index = 2	Epoch: 4	Loss: 0.056971
test acc on this client after 442 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 3
local mask changes: 296866.0 / 11173962
choose client_indexes: [ 0  3  4  8 11], accoring to random
choose mask diff: [894104.0, 296866.0, 857230.0, 880606.0, 867208.0]
Doing local aggregation!
test acc on this client before 401 / 504 : 0.80
Client Index = 3	Epoch: 0	Loss: 0.359555
Client Index = 3	Epoch: 1	Loss: 0.326547
Client Index = 3	Epoch: 2	Loss: 0.298890
Client Index = 3	Epoch: 3	Loss: 0.313535
Client Index = 3	Epoch: 4	Loss: 0.290844
test acc on this client after 391 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 4
local mask changes: 296718.0 / 11173962
choose client_indexes: [ 1  3  4  8 17], accoring to random
choose mask diff: [855458.0, 850166.0, 296718.0, 870640.0, 840658.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.453783
Client Index = 4	Epoch: 1	Loss: 0.185998
Client Index = 4	Epoch: 2	Loss: 0.136729
Client Index = 4	Epoch: 3	Loss: 0.128692
Client Index = 4	Epoch: 4	Loss: 0.393972
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 5
local mask changes: 296856.0 / 11173962
choose client_indexes: [ 5 12 14 16 17], accoring to random
choose mask diff: [296856.0, 865318.0, 867480.0, 853722.0, 838062.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 5	Epoch: 0	Loss: 0.317941
Client Index = 5	Epoch: 1	Loss: 0.241838
Client Index = 5	Epoch: 2	Loss: 0.169547
Client Index = 5	Epoch: 3	Loss: 0.154923
Client Index = 5	Epoch: 4	Loss: 0.148267
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 6
local mask changes: 296634.0 / 11173962
choose client_indexes: [ 4  6  7  9 13], accoring to random
choose mask diff: [866760.0, 296634.0, 880702.0, 885946.0, 880228.0]
Doing local aggregation!
test acc on this client before 403 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.386335
Client Index = 6	Epoch: 1	Loss: 0.442823
Client Index = 6	Epoch: 2	Loss: 0.314684
Client Index = 6	Epoch: 3	Loss: 0.245609
Client Index = 6	Epoch: 4	Loss: 0.270529
test acc on this client after 381 / 505 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 7
local mask changes: 296986.0 / 11173962
choose client_indexes: [ 1  7 12 15 18], accoring to random
choose mask diff: [848412.0, 296986.0, 865322.0, 861082.0, 852642.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.270583
Client Index = 7	Epoch: 1	Loss: 0.512016
Client Index = 7	Epoch: 2	Loss: 0.205216
Client Index = 7	Epoch: 3	Loss: 0.184163
Client Index = 7	Epoch: 4	Loss: 0.254008
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 8
local mask changes: 296734.0 / 11173962
choose client_indexes: [ 4  5  6  8 16], accoring to random
choose mask diff: [870932.0, 857400.0, 882434.0, 296734.0, 867788.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.373151
Client Index = 8	Epoch: 1	Loss: 0.291401
Client Index = 8	Epoch: 2	Loss: 0.281311
Client Index = 8	Epoch: 3	Loss: 0.195512
Client Index = 8	Epoch: 4	Loss: 0.285678
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 9
local mask changes: 296580.0 / 11173962
choose client_indexes: [ 7  9 10 11 15], accoring to random
choose mask diff: [862906.0, 296580.0, 859056.0, 850184.0, 852638.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 9	Epoch: 0	Loss: 0.254023
Client Index = 9	Epoch: 1	Loss: 0.174360
Client Index = 9	Epoch: 2	Loss: 0.192462
Client Index = 9	Epoch: 3	Loss: 0.126292
Client Index = 9	Epoch: 4	Loss: 0.125791
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 10
local mask changes: 296848.0 / 11173962
choose client_indexes: [ 7  8 10 11 13], accoring to random
choose mask diff: [875968.0, 873504.0, 296848.0, 867004.0, 870210.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 10	Epoch: 0	Loss: 0.293729
Client Index = 10	Epoch: 1	Loss: 0.201940
Client Index = 10	Epoch: 2	Loss: 0.161819
Client Index = 10	Epoch: 3	Loss: 0.279858
Client Index = 10	Epoch: 4	Loss: 0.114214
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 11
local mask changes: 296810.0 / 11173962
choose client_indexes: [ 5 10 11 13 16], accoring to random
choose mask diff: [856334.0, 864744.0, 296810.0, 852786.0, 846074.0]
Doing local aggregation!
test acc on this client before 457 / 504 : 0.91
Client Index = 11	Epoch: 0	Loss: 0.242164
Client Index = 11	Epoch: 1	Loss: 0.140310
Client Index = 11	Epoch: 2	Loss: 0.122470
Client Index = 11	Epoch: 3	Loss: 0.131174
Client Index = 11	Epoch: 4	Loss: 0.075536
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 12
local mask changes: 296928.0 / 11173962
choose client_indexes: [ 1 12 13 17 19], accoring to random
choose mask diff: [855548.0, 296928.0, 871538.0, 849892.0, 869876.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 12	Epoch: 0	Loss: 0.283513
Client Index = 12	Epoch: 1	Loss: 0.257042
Client Index = 12	Epoch: 2	Loss: 0.216747
Client Index = 12	Epoch: 3	Loss: 0.307035
Client Index = 12	Epoch: 4	Loss: 0.336335
test acc on this client after 347 / 504 : 0.69
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 13
local mask changes: 296686.0 / 11173962
choose client_indexes: [12 13 14 15 19], accoring to random
choose mask diff: [875442.0, 296686.0, 879792.0, 871312.0, 868538.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.290035
Client Index = 13	Epoch: 1	Loss: 0.239023
Client Index = 13	Epoch: 2	Loss: 0.245216
Client Index = 13	Epoch: 3	Loss: 0.203899
Client Index = 13	Epoch: 4	Loss: 0.159555
test acc on this client after 402 / 503 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 14
local mask changes: 296846.0 / 11173962
choose client_indexes: [ 6  9 12 14 16], accoring to random
choose mask diff: [884352.0, 864814.0, 889102.0, 296846.0, 872286.0]
Doing local aggregation!
test acc on this client before 432 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.368504
Client Index = 14	Epoch: 1	Loss: 0.327430
Client Index = 14	Epoch: 2	Loss: 0.255047
Client Index = 14	Epoch: 3	Loss: 0.270273
Client Index = 14	Epoch: 4	Loss: 0.253815
test acc on this client after 420 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 15
local mask changes: 296712.0 / 11173962
choose client_indexes: [ 2 11 14 15 16], accoring to random
choose mask diff: [856336.0, 862508.0, 873136.0, 296712.0, 867132.0]
Doing local aggregation!
test acc on this client before 403 / 504 : 0.80
Client Index = 15	Epoch: 0	Loss: 0.302036
Client Index = 15	Epoch: 1	Loss: 0.173317
Client Index = 15	Epoch: 2	Loss: 0.156384
Client Index = 15	Epoch: 3	Loss: 0.196980
Client Index = 15	Epoch: 4	Loss: 0.111982
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 16
local mask changes: 297026.0 / 11173962
choose client_indexes: [ 3 13 14 15 16], accoring to random
choose mask diff: [859320.0, 866702.0, 868420.0, 862604.0, 297026.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.414842
Client Index = 16	Epoch: 1	Loss: 0.228922
Client Index = 16	Epoch: 2	Loss: 0.151132
Client Index = 16	Epoch: 3	Loss: 0.130808
Client Index = 16	Epoch: 4	Loss: 0.145506
test acc on this client after 429 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 17
local mask changes: 296906.0 / 11173962
choose client_indexes: [ 4  7 11 17 18], accoring to random
choose mask diff: [840020.0, 856602.0, 831240.0, 296906.0, 842934.0]
Doing local aggregation!
test acc on this client before 401 / 505 : 0.79
Client Index = 17	Epoch: 0	Loss: 0.403579
Client Index = 17	Epoch: 1	Loss: 0.248204
Client Index = 17	Epoch: 2	Loss: 0.136083
Client Index = 17	Epoch: 3	Loss: 0.099957
Client Index = 17	Epoch: 4	Loss: 0.081599
test acc on this client after 402 / 505 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 18
local mask changes: 296820.0 / 11173962
choose client_indexes: [ 5  7 17 18 19], accoring to random
choose mask diff: [840142.0, 853772.0, 841472.0, 296820.0, 849094.0]
Doing local aggregation!
test acc on this client before 414 / 504 : 0.82
Client Index = 18	Epoch: 0	Loss: 0.284367
Client Index = 18	Epoch: 1	Loss: 0.217818
Client Index = 18	Epoch: 2	Loss: 0.178536
Client Index = 18	Epoch: 3	Loss: 0.231109
Client Index = 18	Epoch: 4	Loss: 0.290463
test acc on this client after 444 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(84) with spasity 0.5: 19
local mask changes: 296580.0 / 11173962
choose client_indexes: [ 1 10 11 17 19], accoring to random
choose mask diff: [860204.0, 875140.0, 856968.0, 856782.0, 296580.0]
Doing local aggregation!
test acc on this client before 415 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.253637
Client Index = 19	Epoch: 1	Loss: 0.192553
Client Index = 19	Epoch: 2	Loss: 0.180730
Client Index = 19	Epoch: 3	Loss: 0.162410
Client Index = 19	Epoch: 4	Loss: 0.116326
test acc on this client after 407 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 84
{'test_acc': 0.8264331395239681, 'test_loss': 0.5984995862965538}
################local_test_on_all_clients before local training in communication round: 84
{'test_acc': 0.8456861156952117, 'test_loss': 0.49977480166461674}
################Communication round : 85
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 0
local mask changes: 264822.0 / 11173962
choose client_indexes: [ 0 12 14 18 19], accoring to random
choose mask diff: [264822.0, 870372.0, 882238.0, 866880.0, 881072.0]
Doing local aggregation!
test acc on this client before 385 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.414683
Client Index = 0	Epoch: 1	Loss: 0.378587
Client Index = 0	Epoch: 2	Loss: 0.336107
Client Index = 0	Epoch: 3	Loss: 0.370388
Client Index = 0	Epoch: 4	Loss: 0.251397
test acc on this client after 355 / 504 : 0.70
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 1
local mask changes: 264854.0 / 11173962
choose client_indexes: [ 0  1  2  9 11], accoring to random
choose mask diff: [865802.0, 264854.0, 822710.0, 823086.0, 823356.0]
Doing local aggregation!
test acc on this client before 436 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.335600
Client Index = 1	Epoch: 1	Loss: 0.149859
Client Index = 1	Epoch: 2	Loss: 0.127584
Client Index = 1	Epoch: 3	Loss: 0.119453
Client Index = 1	Epoch: 4	Loss: 0.094648
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 2
local mask changes: 264874.0 / 11173962
choose client_indexes: [ 2  3  7 11 15], accoring to random
choose mask diff: [264874.0, 841400.0, 834618.0, 821576.0, 836182.0]
Doing local aggregation!
test acc on this client before 437 / 502 : 0.87
Client Index = 2	Epoch: 0	Loss: 0.251134
Client Index = 2	Epoch: 1	Loss: 0.126147
Client Index = 2	Epoch: 2	Loss: 0.102014
Client Index = 2	Epoch: 3	Loss: 0.093196
Client Index = 2	Epoch: 4	Loss: 0.354051
test acc on this client after 455 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 3
local mask changes: 264980.0 / 11173962
choose client_indexes: [ 3  9 12 14 18], accoring to random
choose mask diff: [264980.0, 846150.0, 854460.0, 859546.0, 843572.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.353522
Client Index = 3	Epoch: 1	Loss: 0.318257
Client Index = 3	Epoch: 2	Loss: 0.276231
Client Index = 3	Epoch: 3	Loss: 0.354300
Client Index = 3	Epoch: 4	Loss: 0.213390
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 4
local mask changes: 264646.0 / 11173962
choose client_indexes: [ 1  4  7 12 18], accoring to random
choose mask diff: [837514.0, 264646.0, 847216.0, 851802.0, 836654.0]
Doing local aggregation!
test acc on this client before 361 / 503 : 0.72
Client Index = 4	Epoch: 0	Loss: 0.278804
Client Index = 4	Epoch: 1	Loss: 0.186259
Client Index = 4	Epoch: 2	Loss: 0.181388
Client Index = 4	Epoch: 3	Loss: 0.123308
Client Index = 4	Epoch: 4	Loss: 0.115976
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 5
local mask changes: 264576.0 / 11173962
choose client_indexes: [ 0  5  6  7 14], accoring to random
choose mask diff: [861574.0, 264576.0, 857034.0, 831634.0, 848090.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 5	Epoch: 0	Loss: 0.248082
Client Index = 5	Epoch: 1	Loss: 0.187503
Client Index = 5	Epoch: 2	Loss: 0.171357
Client Index = 5	Epoch: 3	Loss: 0.156603
Client Index = 5	Epoch: 4	Loss: 0.475540
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 6
local mask changes: 264792.0 / 11173962
choose client_indexes: [ 2  6  9 14 19], accoring to random
choose mask diff: [865324.0, 264792.0, 867736.0, 869486.0, 866736.0]
Doing local aggregation!
test acc on this client before 405 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.374410
Client Index = 6	Epoch: 1	Loss: 0.476885
Client Index = 6	Epoch: 2	Loss: 0.291364
Client Index = 6	Epoch: 3	Loss: 0.242931
Client Index = 6	Epoch: 4	Loss: 0.426429
test acc on this client after 412 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 7
local mask changes: 264622.0 / 11173962
choose client_indexes: [ 4  7  8 12 16], accoring to random
choose mask diff: [847488.0, 264622.0, 842508.0, 844056.0, 851070.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.372134
Client Index = 7	Epoch: 1	Loss: 0.252480
Client Index = 7	Epoch: 2	Loss: 0.164063
Client Index = 7	Epoch: 3	Loss: 0.194991
Client Index = 7	Epoch: 4	Loss: 0.144135
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 8
local mask changes: 264728.0 / 11173962
choose client_indexes: [ 8 10 13 16 18], accoring to random
choose mask diff: [264728.0, 856500.0, 855226.0, 849716.0, 837140.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.393826
Client Index = 8	Epoch: 1	Loss: 0.275603
Client Index = 8	Epoch: 2	Loss: 0.280295
Client Index = 8	Epoch: 3	Loss: 0.182797
Client Index = 8	Epoch: 4	Loss: 0.296235
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 9
local mask changes: 264978.0 / 11173962
choose client_indexes: [ 4  7  9 11 16], accoring to random
choose mask diff: [842554.0, 842080.0, 264978.0, 829312.0, 830728.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.243858
Client Index = 9	Epoch: 1	Loss: 0.182632
Client Index = 9	Epoch: 2	Loss: 0.168618
Client Index = 9	Epoch: 3	Loss: 0.153640
Client Index = 9	Epoch: 4	Loss: 0.108686
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 10
local mask changes: 264914.0 / 11173962
choose client_indexes: [ 4  5  7 10 13], accoring to random
choose mask diff: [845228.0, 847290.0, 855716.0, 264914.0, 851480.0]
Doing local aggregation!
test acc on this client before 429 / 503 : 0.85
Client Index = 10	Epoch: 0	Loss: 0.228043
Client Index = 10	Epoch: 1	Loss: 0.383622
Client Index = 10	Epoch: 2	Loss: 0.189847
Client Index = 10	Epoch: 3	Loss: 0.147290
Client Index = 10	Epoch: 4	Loss: 0.172620
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 11
local mask changes: 264904.0 / 11173962
choose client_indexes: [ 2  4 10 11 17], accoring to random
choose mask diff: [822844.0, 820510.0, 845128.0, 264904.0, 811770.0]
Doing local aggregation!
test acc on this client before 460 / 504 : 0.91
Client Index = 11	Epoch: 0	Loss: 0.218421
Client Index = 11	Epoch: 1	Loss: 0.147494
Client Index = 11	Epoch: 2	Loss: 0.143183
Client Index = 11	Epoch: 3	Loss: 0.112419
Client Index = 11	Epoch: 4	Loss: 0.114629
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 12
local mask changes: 264766.0 / 11173962
choose client_indexes: [ 2  3  8  9 12], accoring to random
choose mask diff: [846576.0, 856126.0, 861076.0, 850604.0, 264766.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.273516
Client Index = 12	Epoch: 1	Loss: 0.222832
Client Index = 12	Epoch: 2	Loss: 0.312222
Client Index = 12	Epoch: 3	Loss: 0.179020
Client Index = 12	Epoch: 4	Loss: 0.168476
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 13
local mask changes: 264804.0 / 11173962
choose client_indexes: [ 3  8  9 13 17], accoring to random
choose mask diff: [862516.0, 854812.0, 843172.0, 264804.0, 837326.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.393505
Client Index = 13	Epoch: 1	Loss: 0.248528
Client Index = 13	Epoch: 2	Loss: 0.177505
Client Index = 13	Epoch: 3	Loss: 0.216826
Client Index = 13	Epoch: 4	Loss: 0.177787
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 14
local mask changes: 264938.0 / 11173962
choose client_indexes: [ 0 14 15 16 18], accoring to random
choose mask diff: [881472.0, 264938.0, 859014.0, 851246.0, 849146.0]
Doing local aggregation!
test acc on this client before 422 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.407129
Client Index = 14	Epoch: 1	Loss: 0.244058
Client Index = 14	Epoch: 2	Loss: 0.220002
Client Index = 14	Epoch: 3	Loss: 0.237740
Client Index = 14	Epoch: 4	Loss: 0.256198
test acc on this client after 414 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 15
local mask changes: 264754.0 / 11173962
choose client_indexes: [ 0  1  7 12 15], accoring to random
choose mask diff: [865664.0, 843328.0, 846108.0, 853212.0, 264754.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.218508
Client Index = 15	Epoch: 1	Loss: 0.229320
Client Index = 15	Epoch: 2	Loss: 0.145060
Client Index = 15	Epoch: 3	Loss: 0.161275
Client Index = 15	Epoch: 4	Loss: 0.119848
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 16
local mask changes: 264906.0 / 11173962
choose client_indexes: [ 8 12 15 16 18], accoring to random
choose mask diff: [852634.0, 853860.0, 845080.0, 264906.0, 832064.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.249005
Client Index = 16	Epoch: 1	Loss: 0.250381
Client Index = 16	Epoch: 2	Loss: 0.210518
Client Index = 16	Epoch: 3	Loss: 0.118033
Client Index = 16	Epoch: 4	Loss: 0.097841
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 17
local mask changes: 264946.0 / 11173962
choose client_indexes: [ 5  9 14 17 18], accoring to random
choose mask diff: [816654.0, 824270.0, 839448.0, 264946.0, 820782.0]
Doing local aggregation!
test acc on this client before 427 / 505 : 0.85
Client Index = 17	Epoch: 0	Loss: 0.418647
Client Index = 17	Epoch: 1	Loss: 0.176852
Client Index = 17	Epoch: 2	Loss: 0.136582
Client Index = 17	Epoch: 3	Loss: 0.112618
Client Index = 17	Epoch: 4	Loss: 0.280795
test acc on this client after 454 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 18
local mask changes: 264868.0 / 11173962
choose client_indexes: [ 2 10 11 12 18], accoring to random
choose mask diff: [826330.0, 852098.0, 833766.0, 841256.0, 264868.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.359512
Client Index = 18	Epoch: 1	Loss: 0.194193
Client Index = 18	Epoch: 2	Loss: 0.177636
Client Index = 18	Epoch: 3	Loss: 0.207106
Client Index = 18	Epoch: 4	Loss: 0.140669
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(85) with spasity 0.5: 19
local mask changes: 265000.0 / 11173962
choose client_indexes: [ 1  5  7 13 19], accoring to random
choose mask diff: [840038.0, 851974.0, 855136.0, 853206.0, 265000.0]
Doing local aggregation!
test acc on this client before 409 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.303517
Client Index = 19	Epoch: 1	Loss: 0.179790
Client Index = 19	Epoch: 2	Loss: 0.167819
Client Index = 19	Epoch: 3	Loss: 0.169471
Client Index = 19	Epoch: 4	Loss: 0.171313
test acc on this client after 398 / 506 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 85
{'test_acc': 0.8420048382762854, 'test_loss': 0.5234166502084527}
################local_test_on_all_clients before local training in communication round: 85
{'test_acc': 0.8368344628977393, 'test_loss': 0.5236847135464515}
################Communication round : 86
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 0
local mask changes: 234452.0 / 11173962
choose client_indexes: [ 0  4  6  9 10], accoring to random
choose mask diff: [234452.0, 852420.0, 863274.0, 857562.0, 863472.0]
Doing local aggregation!
test acc on this client before 400 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.419537
Client Index = 0	Epoch: 1	Loss: 0.377466
Client Index = 0	Epoch: 2	Loss: 0.311477
Client Index = 0	Epoch: 3	Loss: 0.315260
Client Index = 0	Epoch: 4	Loss: 0.498042
test acc on this client after 383 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 1
local mask changes: 234416.0 / 11173962
choose client_indexes: [ 0  1  3  5 16], accoring to random
choose mask diff: [848162.0, 234416.0, 828310.0, 811388.0, 813534.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 1	Epoch: 0	Loss: 0.376993
Client Index = 1	Epoch: 1	Loss: 0.135915
Client Index = 1	Epoch: 2	Loss: 0.109587
Client Index = 1	Epoch: 3	Loss: 0.097411
Client Index = 1	Epoch: 4	Loss: 0.089012
test acc on this client after 457 / 503 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 2
local mask changes: 234264.0 / 11173962
choose client_indexes: [ 0  2 10 18 19], accoring to random
choose mask diff: [852940.0, 234264.0, 828718.0, 812236.0, 828308.0]
Doing local aggregation!
test acc on this client before 429 / 502 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.165149
Client Index = 2	Epoch: 1	Loss: 0.248850
Client Index = 2	Epoch: 2	Loss: 0.108175
Client Index = 2	Epoch: 3	Loss: 0.084773
Client Index = 2	Epoch: 4	Loss: 0.064170
test acc on this client after 437 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 3
local mask changes: 234240.0 / 11173962
choose client_indexes: [ 3  8 11 13 17], accoring to random
choose mask diff: [234240.0, 848590.0, 833422.0, 849098.0, 835954.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.385345
Client Index = 3	Epoch: 1	Loss: 0.336972
Client Index = 3	Epoch: 2	Loss: 0.257849
Client Index = 3	Epoch: 3	Loss: 0.368882
Client Index = 3	Epoch: 4	Loss: 0.214569
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 4
local mask changes: 234310.0 / 11173962
choose client_indexes: [ 4  5 12 16 18], accoring to random
choose mask diff: [234310.0, 827012.0, 834764.0, 829712.0, 818482.0]
Doing local aggregation!
test acc on this client before 410 / 503 : 0.82
Client Index = 4	Epoch: 0	Loss: 0.367854
Client Index = 4	Epoch: 1	Loss: 0.166134
Client Index = 4	Epoch: 2	Loss: 0.147537
Client Index = 4	Epoch: 3	Loss: 0.114369
Client Index = 4	Epoch: 4	Loss: 0.373383
test acc on this client after 424 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 5
local mask changes: 234330.0 / 11173962
choose client_indexes: [ 5  7 10 14 15], accoring to random
choose mask diff: [234330.0, 818006.0, 835094.0, 833512.0, 837076.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 5	Epoch: 0	Loss: 0.217025
Client Index = 5	Epoch: 1	Loss: 0.302518
Client Index = 5	Epoch: 2	Loss: 0.181721
Client Index = 5	Epoch: 3	Loss: 0.160289
Client Index = 5	Epoch: 4	Loss: 0.125098
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 6
local mask changes: 234258.0 / 11173962
choose client_indexes: [ 3  6  7 10 17], accoring to random
choose mask diff: [863444.0, 234258.0, 849994.0, 857556.0, 838536.0]
Doing local aggregation!
test acc on this client before 411 / 505 : 0.81
Client Index = 6	Epoch: 0	Loss: 0.433591
Client Index = 6	Epoch: 1	Loss: 0.349011
Client Index = 6	Epoch: 2	Loss: 0.317867
Client Index = 6	Epoch: 3	Loss: 0.323853
Client Index = 6	Epoch: 4	Loss: 0.239053
test acc on this client after 411 / 505 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 7
local mask changes: 234320.0 / 11173962
choose client_indexes: [ 0  3  7 16 17], accoring to random
choose mask diff: [866180.0, 844824.0, 234320.0, 833328.0, 822168.0]
Doing local aggregation!
test acc on this client before 429 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.303257
Client Index = 7	Epoch: 1	Loss: 0.282609
Client Index = 7	Epoch: 2	Loss: 0.191519
Client Index = 7	Epoch: 3	Loss: 0.137464
Client Index = 7	Epoch: 4	Loss: 0.113641
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 8
local mask changes: 234228.0 / 11173962
choose client_indexes: [ 0  1  8 12 13], accoring to random
choose mask diff: [867178.0, 830138.0, 234228.0, 848574.0, 838738.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.429429
Client Index = 8	Epoch: 1	Loss: 0.255335
Client Index = 8	Epoch: 2	Loss: 0.283446
Client Index = 8	Epoch: 3	Loss: 0.288531
Client Index = 8	Epoch: 4	Loss: 0.157128
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 9
local mask changes: 234094.0 / 11173962
choose client_indexes: [ 2  7  9 11 18], accoring to random
choose mask diff: [822524.0, 825302.0, 234094.0, 811098.0, 806622.0]
Doing local aggregation!
test acc on this client before 413 / 504 : 0.82
Client Index = 9	Epoch: 0	Loss: 0.246614
Client Index = 9	Epoch: 1	Loss: 0.227600
Client Index = 9	Epoch: 2	Loss: 0.193056
Client Index = 9	Epoch: 3	Loss: 0.105853
Client Index = 9	Epoch: 4	Loss: 0.211814
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 10
local mask changes: 234150.0 / 11173962
choose client_indexes: [ 0  4  9 10 16], accoring to random
choose mask diff: [862522.0, 829530.0, 827254.0, 234150.0, 834240.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 10	Epoch: 0	Loss: 0.397525
Client Index = 10	Epoch: 1	Loss: 0.246901
Client Index = 10	Epoch: 2	Loss: 0.168550
Client Index = 10	Epoch: 3	Loss: 0.223405
Client Index = 10	Epoch: 4	Loss: 0.113544
test acc on this client after 409 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 11
local mask changes: 234380.0 / 11173962
choose client_indexes: [ 0  4  5 11 19], accoring to random
choose mask diff: [845672.0, 804724.0, 821196.0, 234380.0, 819072.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.229470
Client Index = 11	Epoch: 1	Loss: 0.117961
Client Index = 11	Epoch: 2	Loss: 0.128151
Client Index = 11	Epoch: 3	Loss: 0.171014
Client Index = 11	Epoch: 4	Loss: 0.080394
test acc on this client after 448 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 12
local mask changes: 234234.0 / 11173962
choose client_indexes: [ 8  9 12 14 19], accoring to random
choose mask diff: [844304.0, 832126.0, 234234.0, 858086.0, 835962.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 12	Epoch: 0	Loss: 0.512919
Client Index = 12	Epoch: 1	Loss: 0.235512
Client Index = 12	Epoch: 2	Loss: 0.188827
Client Index = 12	Epoch: 3	Loss: 0.141978
Client Index = 12	Epoch: 4	Loss: 0.243672
test acc on this client after 414 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 13
local mask changes: 234226.0 / 11173962
choose client_indexes: [ 2  8 13 16 17], accoring to random
choose mask diff: [834020.0, 838482.0, 234226.0, 834088.0, 818990.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 13	Epoch: 0	Loss: 0.289936
Client Index = 13	Epoch: 1	Loss: 0.232674
Client Index = 13	Epoch: 2	Loss: 0.188958
Client Index = 13	Epoch: 3	Loss: 0.255909
Client Index = 13	Epoch: 4	Loss: 0.170116
test acc on this client after 413 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 14
local mask changes: 234372.0 / 11173962
choose client_indexes: [ 4  6  8 14 16], accoring to random
choose mask diff: [841108.0, 854478.0, 849244.0, 234372.0, 831936.0]
Doing local aggregation!
test acc on this client before 432 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.325762
Client Index = 14	Epoch: 1	Loss: 0.238504
Client Index = 14	Epoch: 2	Loss: 0.293053
Client Index = 14	Epoch: 3	Loss: 0.250875
Client Index = 14	Epoch: 4	Loss: 0.225239
test acc on this client after 410 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 15
local mask changes: 234280.0 / 11173962
choose client_indexes: [ 0  9 15 17 19], accoring to random
choose mask diff: [849980.0, 820046.0, 234280.0, 834078.0, 844118.0]
Doing local aggregation!
test acc on this client before 427 / 504 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.263440
Client Index = 15	Epoch: 1	Loss: 0.211430
Client Index = 15	Epoch: 2	Loss: 0.207284
Client Index = 15	Epoch: 3	Loss: 0.164622
Client Index = 15	Epoch: 4	Loss: 0.106039
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 16
local mask changes: 234318.0 / 11173962
choose client_indexes: [ 4  7  9 12 16], accoring to random
choose mask diff: [829780.0, 835434.0, 816904.0, 838312.0, 234318.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 16	Epoch: 0	Loss: 0.315764
Client Index = 16	Epoch: 1	Loss: 0.160461
Client Index = 16	Epoch: 2	Loss: 0.185979
Client Index = 16	Epoch: 3	Loss: 0.149911
Client Index = 16	Epoch: 4	Loss: 0.095388
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 17
local mask changes: 234326.0 / 11173962
choose client_indexes: [ 4 11 16 17 19], accoring to random
choose mask diff: [804912.0, 793810.0, 818680.0, 234326.0, 820304.0]
Doing local aggregation!
test acc on this client before 419 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.281750
Client Index = 17	Epoch: 1	Loss: 0.171114
Client Index = 17	Epoch: 2	Loss: 0.273613
Client Index = 17	Epoch: 3	Loss: 0.173299
Client Index = 17	Epoch: 4	Loss: 0.144255
test acc on this client after 420 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 18
local mask changes: 234198.0 / 11173962
choose client_indexes: [ 4 13 14 15 18], accoring to random
choose mask diff: [820888.0, 824616.0, 833004.0, 830692.0, 234198.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 18	Epoch: 0	Loss: 0.231344
Client Index = 18	Epoch: 1	Loss: 0.218488
Client Index = 18	Epoch: 2	Loss: 0.192511
Client Index = 18	Epoch: 3	Loss: 0.216076
Client Index = 18	Epoch: 4	Loss: 0.145078
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(86) with spasity 0.5: 19
local mask changes: 234192.0 / 11173962
choose client_indexes: [ 2  5 15 17 19], accoring to random
choose mask diff: [828374.0, 834940.0, 843424.0, 820518.0, 234192.0]
Doing local aggregation!
test acc on this client before 419 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.236073
Client Index = 19	Epoch: 1	Loss: 0.221005
Client Index = 19	Epoch: 2	Loss: 0.167128
Client Index = 19	Epoch: 3	Loss: 0.149062
Client Index = 19	Epoch: 4	Loss: 0.207511
test acc on this client after 414 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 86
{'test_acc': 0.8399134113339821, 'test_loss': 0.5348420431225402}
################local_test_on_all_clients before local training in communication round: 86
{'test_acc': 0.8420951840124025, 'test_loss': 0.5039982590348604}
################Communication round : 87
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 0
local mask changes: 205496.0 / 11173962
choose client_indexes: [ 0  4  9 17 19], accoring to random
choose mask diff: [205496.0, 839536.0, 845236.0, 836698.0, 853146.0]
Doing local aggregation!
test acc on this client before 405 / 504 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.386196
Client Index = 0	Epoch: 1	Loss: 0.447714
Client Index = 0	Epoch: 2	Loss: 0.343872
Client Index = 0	Epoch: 3	Loss: 0.309209
Client Index = 0	Epoch: 4	Loss: 0.262483
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 1
local mask changes: 205424.0 / 11173962
choose client_indexes: [ 1  7 11 12 19], accoring to random
choose mask diff: [205424.0, 802816.0, 791598.0, 809324.0, 809044.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.186923
Client Index = 1	Epoch: 1	Loss: 0.104758
Client Index = 1	Epoch: 2	Loss: 0.112505
Client Index = 1	Epoch: 3	Loss: 0.401677
Client Index = 1	Epoch: 4	Loss: 0.090990
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 2
local mask changes: 205394.0 / 11173962
choose client_indexes: [ 2  7  8 16 19], accoring to random
choose mask diff: [205394.0, 805188.0, 812390.0, 810460.0, 812318.0]
Doing local aggregation!
test acc on this client before 434 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.195356
Client Index = 2	Epoch: 1	Loss: 0.117652
Client Index = 2	Epoch: 2	Loss: 0.112427
Client Index = 2	Epoch: 3	Loss: 0.246736
Client Index = 2	Epoch: 4	Loss: 0.109799
test acc on this client after 437 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 3
local mask changes: 205612.0 / 11173962
choose client_indexes: [ 0  3 12 16 18], accoring to random
choose mask diff: [848628.0, 205612.0, 825992.0, 815624.0, 814882.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.480927
Client Index = 3	Epoch: 1	Loss: 0.275450
Client Index = 3	Epoch: 2	Loss: 0.267442
Client Index = 3	Epoch: 3	Loss: 0.222099
Client Index = 3	Epoch: 4	Loss: 0.274829
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 4
local mask changes: 205272.0 / 11173962
choose client_indexes: [ 1  2  4  5 18], accoring to random
choose mask diff: [805576.0, 802028.0, 205272.0, 814266.0, 802676.0]
Doing local aggregation!
test acc on this client before 384 / 503 : 0.76
Client Index = 4	Epoch: 0	Loss: 0.255799
Client Index = 4	Epoch: 1	Loss: 0.285019
Client Index = 4	Epoch: 2	Loss: 0.150518
Client Index = 4	Epoch: 3	Loss: 0.112245
Client Index = 4	Epoch: 4	Loss: 0.107258
test acc on this client after 439 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 5
local mask changes: 205572.0 / 11173962
choose client_indexes: [ 0  5  8 12 19], accoring to random
choose mask diff: [835848.0, 205572.0, 812154.0, 823036.0, 824474.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 5	Epoch: 0	Loss: 0.286834
Client Index = 5	Epoch: 1	Loss: 0.158993
Client Index = 5	Epoch: 2	Loss: 0.238909
Client Index = 5	Epoch: 3	Loss: 0.180177
Client Index = 5	Epoch: 4	Loss: 0.228463
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 6
local mask changes: 205502.0 / 11173962
choose client_indexes: [ 0  6  8 10 14], accoring to random
choose mask diff: [852520.0, 205502.0, 836616.0, 842814.0, 840436.0]
Doing local aggregation!
test acc on this client before 413 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.409868
Client Index = 6	Epoch: 1	Loss: 0.316493
Client Index = 6	Epoch: 2	Loss: 0.289673
Client Index = 6	Epoch: 3	Loss: 0.250188
Client Index = 6	Epoch: 4	Loss: 0.350692
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 7
local mask changes: 205346.0 / 11173962
choose client_indexes: [ 5  6  7 10 11], accoring to random
choose mask diff: [805270.0, 837496.0, 205346.0, 826272.0, 814526.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 7	Epoch: 0	Loss: 0.258640
Client Index = 7	Epoch: 1	Loss: 0.184403
Client Index = 7	Epoch: 2	Loss: 0.232879
Client Index = 7	Epoch: 3	Loss: 0.205353
Client Index = 7	Epoch: 4	Loss: 0.255042
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 8
local mask changes: 205572.0 / 11173962
choose client_indexes: [ 0  6  8  9 12], accoring to random
choose mask diff: [852048.0, 836664.0, 205572.0, 818476.0, 829156.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.319819
Client Index = 8	Epoch: 1	Loss: 0.416482
Client Index = 8	Epoch: 2	Loss: 0.220562
Client Index = 8	Epoch: 3	Loss: 0.222862
Client Index = 8	Epoch: 4	Loss: 0.194104
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 9
local mask changes: 205416.0 / 11173962
choose client_indexes: [ 2  4  9 11 19], accoring to random
choose mask diff: [807366.0, 812698.0, 205416.0, 795508.0, 812512.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 9	Epoch: 0	Loss: 0.253606
Client Index = 9	Epoch: 1	Loss: 0.240605
Client Index = 9	Epoch: 2	Loss: 0.155919
Client Index = 9	Epoch: 3	Loss: 0.141173
Client Index = 9	Epoch: 4	Loss: 0.151107
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 10
local mask changes: 205414.0 / 11173962
choose client_indexes: [ 3  5  7 10 14], accoring to random
choose mask diff: [835372.0, 820766.0, 827108.0, 205414.0, 842748.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.276742
Client Index = 10	Epoch: 1	Loss: 0.250275
Client Index = 10	Epoch: 2	Loss: 0.183852
Client Index = 10	Epoch: 3	Loss: 0.148404
Client Index = 10	Epoch: 4	Loss: 0.134970
test acc on this client after 415 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 11
local mask changes: 205378.0 / 11173962
choose client_indexes: [ 1 10 11 18 19], accoring to random
choose mask diff: [791280.0, 811668.0, 205378.0, 800200.0, 803360.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 11	Epoch: 0	Loss: 0.234162
Client Index = 11	Epoch: 1	Loss: 0.113996
Client Index = 11	Epoch: 2	Loss: 0.116080
Client Index = 11	Epoch: 3	Loss: 0.088497
Client Index = 11	Epoch: 4	Loss: 0.233745
test acc on this client after 458 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 12
local mask changes: 205446.0 / 11173962
choose client_indexes: [ 4  7  8 12 19], accoring to random
choose mask diff: [822184.0, 816866.0, 829246.0, 205446.0, 820490.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 12	Epoch: 0	Loss: 0.270393
Client Index = 12	Epoch: 1	Loss: 0.199076
Client Index = 12	Epoch: 2	Loss: 0.156085
Client Index = 12	Epoch: 3	Loss: 0.283436
Client Index = 12	Epoch: 4	Loss: 0.263358
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 13
local mask changes: 205480.0 / 11173962
choose client_indexes: [ 0  3  4 13 17], accoring to random
choose mask diff: [853490.0, 833052.0, 817048.0, 205480.0, 803872.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.238399
Client Index = 13	Epoch: 1	Loss: 0.221885
Client Index = 13	Epoch: 2	Loss: 0.199188
Client Index = 13	Epoch: 3	Loss: 0.137679
Client Index = 13	Epoch: 4	Loss: 0.267439
test acc on this client after 396 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 14
local mask changes: 205348.0 / 11173962
choose client_indexes: [ 0  6 14 15 17], accoring to random
choose mask diff: [850774.0, 837078.0, 205348.0, 826884.0, 812482.0]
Doing local aggregation!
test acc on this client before 423 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.340562
Client Index = 14	Epoch: 1	Loss: 0.288862
Client Index = 14	Epoch: 2	Loss: 0.227097
Client Index = 14	Epoch: 3	Loss: 0.322665
Client Index = 14	Epoch: 4	Loss: 0.201308
test acc on this client after 412 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 15
local mask changes: 205632.0 / 11173962
choose client_indexes: [ 1  3 10 12 15], accoring to random
choose mask diff: [808320.0, 829958.0, 820386.0, 825618.0, 205632.0]
Doing local aggregation!
test acc on this client before 438 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.266739
Client Index = 15	Epoch: 1	Loss: 0.185910
Client Index = 15	Epoch: 2	Loss: 0.244663
Client Index = 15	Epoch: 3	Loss: 0.123805
Client Index = 15	Epoch: 4	Loss: 0.117433
test acc on this client after 389 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 16
local mask changes: 205388.0 / 11173962
choose client_indexes: [ 4  9 10 14 16], accoring to random
choose mask diff: [813850.0, 797978.0, 821414.0, 819056.0, 205388.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.196325
Client Index = 16	Epoch: 1	Loss: 0.146317
Client Index = 16	Epoch: 2	Loss: 0.289212
Client Index = 16	Epoch: 3	Loss: 0.112290
Client Index = 16	Epoch: 4	Loss: 0.095525
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 17
local mask changes: 205582.0 / 11173962
choose client_indexes: [ 1  6  8 17 19], accoring to random
choose mask diff: [787066.0, 825312.0, 816294.0, 205582.0, 803558.0]
Doing local aggregation!
test acc on this client before 417 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.287291
Client Index = 17	Epoch: 1	Loss: 0.251977
Client Index = 17	Epoch: 2	Loss: 0.167898
Client Index = 17	Epoch: 3	Loss: 0.150522
Client Index = 17	Epoch: 4	Loss: 0.095979
test acc on this client after 451 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 18
local mask changes: 205328.0 / 11173962
choose client_indexes: [11 13 16 18 19], accoring to random
choose mask diff: [801056.0, 808840.0, 800552.0, 205328.0, 800820.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.301348
Client Index = 18	Epoch: 1	Loss: 0.186318
Client Index = 18	Epoch: 2	Loss: 0.168278
Client Index = 18	Epoch: 3	Loss: 0.188348
Client Index = 18	Epoch: 4	Loss: 0.136172
test acc on this client after 447 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(87) with spasity 0.5: 19
local mask changes: 205212.0 / 11173962
choose client_indexes: [ 4 11 13 15 19], accoring to random
choose mask diff: [801952.0, 807720.0, 821530.0, 827984.0, 205212.0]
Doing local aggregation!
test acc on this client before 409 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.273382
Client Index = 19	Epoch: 1	Loss: 0.183705
Client Index = 19	Epoch: 2	Loss: 0.152066
Client Index = 19	Epoch: 3	Loss: 0.205500
Client Index = 19	Epoch: 4	Loss: 0.173037
test acc on this client after 407 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 87
{'test_acc': 0.8332693284428754, 'test_loss': 0.5587842407767001}
################local_test_on_all_clients before local training in communication round: 87
{'test_acc': 0.8473562496595258, 'test_loss': 0.492465120746135}
################Communication round : 88
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 0
local mask changes: 178326.0 / 11173962
choose client_indexes: [ 0  4  7 13 17], accoring to random
choose mask diff: [178326.0, 826402.0, 842150.0, 844758.0, 822984.0]
Doing local aggregation!
test acc on this client before 383 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.398878
Client Index = 0	Epoch: 1	Loss: 0.345004
Client Index = 0	Epoch: 2	Loss: 0.298143
Client Index = 0	Epoch: 3	Loss: 0.271345
Client Index = 0	Epoch: 4	Loss: 0.336750
test acc on this client after 388 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 1
local mask changes: 178224.0 / 11173962
choose client_indexes: [ 0  1  4 13 15], accoring to random
choose mask diff: [824078.0, 178224.0, 793658.0, 802994.0, 796424.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 1	Epoch: 0	Loss: 0.361333
Client Index = 1	Epoch: 1	Loss: 0.131559
Client Index = 1	Epoch: 2	Loss: 0.103660
Client Index = 1	Epoch: 3	Loss: 0.083447
Client Index = 1	Epoch: 4	Loss: 0.082792
test acc on this client after 450 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 2
local mask changes: 178192.0 / 11173962
choose client_indexes: [ 2  6 13 14 19], accoring to random
choose mask diff: [178192.0, 821276.0, 805432.0, 809110.0, 796528.0]
Doing local aggregation!
test acc on this client before 432 / 502 : 0.86
Client Index = 2	Epoch: 0	Loss: 0.197855
Client Index = 2	Epoch: 1	Loss: 0.129094
Client Index = 2	Epoch: 2	Loss: 0.136731
Client Index = 2	Epoch: 3	Loss: 0.081174
Client Index = 2	Epoch: 4	Loss: 0.069418
test acc on this client after 459 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 3
local mask changes: 178212.0 / 11173962
choose client_indexes: [ 3  8 13 14 17], accoring to random
choose mask diff: [178212.0, 822858.0, 819854.0, 821322.0, 808256.0]
Doing local aggregation!
test acc on this client before 410 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.390919
Client Index = 3	Epoch: 1	Loss: 0.313979
Client Index = 3	Epoch: 2	Loss: 0.204681
Client Index = 3	Epoch: 3	Loss: 0.355587
Client Index = 3	Epoch: 4	Loss: 0.223080
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 4
local mask changes: 178110.0 / 11173962
choose client_indexes: [ 1  4 10 15 16], accoring to random
choose mask diff: [790764.0, 178110.0, 802956.0, 814522.0, 799380.0]
Doing local aggregation!
test acc on this client before 403 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.482491
Client Index = 4	Epoch: 1	Loss: 0.157935
Client Index = 4	Epoch: 2	Loss: 0.177200
Client Index = 4	Epoch: 3	Loss: 0.123901
Client Index = 4	Epoch: 4	Loss: 0.210286
test acc on this client after 446 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 5
local mask changes: 178326.0 / 11173962
choose client_indexes: [ 1  3  5  6 16], accoring to random
choose mask diff: [787624.0, 824116.0, 178326.0, 820784.0, 800248.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 5	Epoch: 0	Loss: 0.276537
Client Index = 5	Epoch: 1	Loss: 0.201926
Client Index = 5	Epoch: 2	Loss: 0.177301
Client Index = 5	Epoch: 3	Loss: 0.156300
Client Index = 5	Epoch: 4	Loss: 0.105655
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 6
local mask changes: 178180.0 / 11173962
choose client_indexes: [ 1  3  6 18 19], accoring to random
choose mask diff: [827628.0, 838806.0, 178180.0, 823650.0, 830106.0]
Doing local aggregation!
test acc on this client before 400 / 505 : 0.79
Client Index = 6	Epoch: 0	Loss: 0.421699
Client Index = 6	Epoch: 1	Loss: 0.328047
Client Index = 6	Epoch: 2	Loss: 0.275464
Client Index = 6	Epoch: 3	Loss: 0.322171
Client Index = 6	Epoch: 4	Loss: 0.329606
test acc on this client after 369 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 7
local mask changes: 178128.0 / 11173962
choose client_indexes: [ 0  7  9 10 19], accoring to random
choose mask diff: [842242.0, 178128.0, 799904.0, 813822.0, 816494.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 7	Epoch: 0	Loss: 0.199166
Client Index = 7	Epoch: 1	Loss: 0.285180
Client Index = 7	Epoch: 2	Loss: 0.155543
Client Index = 7	Epoch: 3	Loss: 0.306310
Client Index = 7	Epoch: 4	Loss: 0.148177
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 8
local mask changes: 178208.0 / 11173962
choose client_indexes: [ 3  5  7  8 19], accoring to random
choose mask diff: [823062.0, 802250.0, 802940.0, 178208.0, 819128.0]
Doing local aggregation!
test acc on this client before 446 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.310710
Client Index = 8	Epoch: 1	Loss: 0.348726
Client Index = 8	Epoch: 2	Loss: 0.240430
Client Index = 8	Epoch: 3	Loss: 0.223477
Client Index = 8	Epoch: 4	Loss: 0.196148
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 9
local mask changes: 178200.0 / 11173962
choose client_indexes: [ 1  4  9 12 17], accoring to random
choose mask diff: [780340.0, 799092.0, 178200.0, 804200.0, 779720.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.287916
Client Index = 9	Epoch: 1	Loss: 0.197686
Client Index = 9	Epoch: 2	Loss: 0.141535
Client Index = 9	Epoch: 3	Loss: 0.158067
Client Index = 9	Epoch: 4	Loss: 0.385130
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 10
local mask changes: 178342.0 / 11173962
choose client_indexes: [ 3  4  8 10 12], accoring to random
choose mask diff: [822372.0, 804634.0, 814328.0, 178342.0, 822960.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 10	Epoch: 0	Loss: 0.269261
Client Index = 10	Epoch: 1	Loss: 0.239325
Client Index = 10	Epoch: 2	Loss: 0.272975
Client Index = 10	Epoch: 3	Loss: 0.131347
Client Index = 10	Epoch: 4	Loss: 0.121277
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 11
local mask changes: 178194.0 / 11173962
choose client_indexes: [ 1  6 11 17 19], accoring to random
choose mask diff: [777624.0, 811718.0, 178194.0, 764034.0, 790204.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.311446
Client Index = 11	Epoch: 1	Loss: 0.140500
Client Index = 11	Epoch: 2	Loss: 0.214201
Client Index = 11	Epoch: 3	Loss: 0.080398
Client Index = 11	Epoch: 4	Loss: 0.079341
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 12
local mask changes: 178112.0 / 11173962
choose client_indexes: [ 0  9 12 15 17], accoring to random
choose mask diff: [835358.0, 806078.0, 178112.0, 815554.0, 796748.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 12	Epoch: 0	Loss: 0.250473
Client Index = 12	Epoch: 1	Loss: 0.219537
Client Index = 12	Epoch: 2	Loss: 0.190114
Client Index = 12	Epoch: 3	Loss: 0.277972
Client Index = 12	Epoch: 4	Loss: 0.171413
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 13
local mask changes: 178126.0 / 11173962
choose client_indexes: [ 5 11 13 16 18], accoring to random
choose mask diff: [818520.0, 794368.0, 178126.0, 807230.0, 798322.0]
Doing local aggregation!
test acc on this client before 411 / 503 : 0.82
Client Index = 13	Epoch: 0	Loss: 0.258171
Client Index = 13	Epoch: 1	Loss: 0.244853
Client Index = 13	Epoch: 2	Loss: 0.296228
Client Index = 13	Epoch: 3	Loss: 0.148630
Client Index = 13	Epoch: 4	Loss: 0.116812
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 14
local mask changes: 178156.0 / 11173962
choose client_indexes: [ 6 10 14 16 19], accoring to random
choose mask diff: [824674.0, 832078.0, 178156.0, 807284.0, 819600.0]
Doing local aggregation!
test acc on this client before 421 / 502 : 0.84
Client Index = 14	Epoch: 0	Loss: 0.370820
Client Index = 14	Epoch: 1	Loss: 0.325537
Client Index = 14	Epoch: 2	Loss: 0.206655
Client Index = 14	Epoch: 3	Loss: 0.221965
Client Index = 14	Epoch: 4	Loss: 0.314376
test acc on this client after 406 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 15
local mask changes: 178086.0 / 11173962
choose client_indexes: [ 4  7 13 15 16], accoring to random
choose mask diff: [815522.0, 803750.0, 811658.0, 178086.0, 801644.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.224568
Client Index = 15	Epoch: 1	Loss: 0.342837
Client Index = 15	Epoch: 2	Loss: 0.199916
Client Index = 15	Epoch: 3	Loss: 0.103939
Client Index = 15	Epoch: 4	Loss: 0.086563
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 16
local mask changes: 178246.0 / 11173962
choose client_indexes: [ 0  9 16 18 19], accoring to random
choose mask diff: [842734.0, 784430.0, 178246.0, 789306.0, 814178.0]
Doing local aggregation!
test acc on this client before 433 / 503 : 0.86
Client Index = 16	Epoch: 0	Loss: 0.289051
Client Index = 16	Epoch: 1	Loss: 0.176338
Client Index = 16	Epoch: 2	Loss: 0.116463
Client Index = 16	Epoch: 3	Loss: 0.197749
Client Index = 16	Epoch: 4	Loss: 0.147274
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 17
local mask changes: 178222.0 / 11173962
choose client_indexes: [ 0  1  4 14 17], accoring to random
choose mask diff: [823484.0, 772616.0, 776448.0, 800266.0, 178222.0]
Doing local aggregation!
test acc on this client before 423 / 505 : 0.84
Client Index = 17	Epoch: 0	Loss: 0.321553
Client Index = 17	Epoch: 1	Loss: 0.182573
Client Index = 17	Epoch: 2	Loss: 0.213381
Client Index = 17	Epoch: 3	Loss: 0.131985
Client Index = 17	Epoch: 4	Loss: 0.088454
test acc on this client after 454 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 18
local mask changes: 178206.0 / 11173962
choose client_indexes: [ 2  3  6  7 18], accoring to random
choose mask diff: [781080.0, 802484.0, 821548.0, 792168.0, 178206.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.255408
Client Index = 18	Epoch: 1	Loss: 0.185139
Client Index = 18	Epoch: 2	Loss: 0.179650
Client Index = 18	Epoch: 3	Loss: 0.151538
Client Index = 18	Epoch: 4	Loss: 0.164867
test acc on this client after 444 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(88) with spasity 0.5: 19
local mask changes: 178264.0 / 11173962
choose client_indexes: [ 5 12 17 18 19], accoring to random
choose mask diff: [810888.0, 809922.0, 790728.0, 790410.0, 178264.0]
Doing local aggregation!
test acc on this client before 427 / 506 : 0.84
Client Index = 19	Epoch: 0	Loss: 0.200774
Client Index = 19	Epoch: 1	Loss: 0.139384
Client Index = 19	Epoch: 2	Loss: 0.174556
Client Index = 19	Epoch: 3	Loss: 0.086754
Client Index = 19	Epoch: 4	Loss: 0.146101
test acc on this client after 421 / 506 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 88
{'test_acc': 0.8419109741779367, 'test_loss': 0.5393258573944977}
################local_test_on_all_clients before local training in communication round: 88
{'test_acc': 0.8422896590799296, 'test_loss': 0.4964767106248182}
################Communication round : 89
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 0
local mask changes: 152596.0 / 11173962
choose client_indexes: [ 0  7 10 11 14], accoring to random
choose mask diff: [152596.0, 831570.0, 828958.0, 813534.0, 831190.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.365729
Client Index = 0	Epoch: 1	Loss: 0.266411
Client Index = 0	Epoch: 2	Loss: 0.342114
Client Index = 0	Epoch: 3	Loss: 0.308170
Client Index = 0	Epoch: 4	Loss: 0.236397
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 1
local mask changes: 152588.0 / 11173962
choose client_indexes: [ 0  1  2 10 17], accoring to random
choose mask diff: [811286.0, 152588.0, 769330.0, 785488.0, 762510.0]
Doing local aggregation!
test acc on this client before 455 / 503 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.250901
Client Index = 1	Epoch: 1	Loss: 0.137934
Client Index = 1	Epoch: 2	Loss: 0.112227
Client Index = 1	Epoch: 3	Loss: 0.093838
Client Index = 1	Epoch: 4	Loss: 0.065145
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 2
local mask changes: 152640.0 / 11173962
choose client_indexes: [ 2  4  7  8 17], accoring to random
choose mask diff: [152640.0, 777048.0, 782956.0, 789816.0, 772254.0]
Doing local aggregation!
test acc on this client before 450 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.162325
Client Index = 2	Epoch: 1	Loss: 0.123748
Client Index = 2	Epoch: 2	Loss: 0.141783
Client Index = 2	Epoch: 3	Loss: 0.097429
Client Index = 2	Epoch: 4	Loss: 0.061860
test acc on this client after 452 / 502 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 3
local mask changes: 152650.0 / 11173962
choose client_indexes: [ 1  3  5 16 17], accoring to random
choose mask diff: [793720.0, 152650.0, 814842.0, 793484.0, 795862.0]
Doing local aggregation!
test acc on this client before 384 / 504 : 0.76
Client Index = 3	Epoch: 0	Loss: 0.457147
Client Index = 3	Epoch: 1	Loss: 0.322896
Client Index = 3	Epoch: 2	Loss: 0.246141
Client Index = 3	Epoch: 3	Loss: 0.264822
Client Index = 3	Epoch: 4	Loss: 0.188303
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 4
local mask changes: 152840.0 / 11173962
choose client_indexes: [ 2  4  5  8 18], accoring to random
choose mask diff: [777620.0, 152840.0, 790506.0, 802350.0, 775798.0]
Doing local aggregation!
test acc on this client before 416 / 503 : 0.83
Client Index = 4	Epoch: 0	Loss: 0.300775
Client Index = 4	Epoch: 1	Loss: 0.149438
Client Index = 4	Epoch: 2	Loss: 0.141640
Client Index = 4	Epoch: 3	Loss: 0.139332
Client Index = 4	Epoch: 4	Loss: 0.349819
test acc on this client after 433 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 5
local mask changes: 152680.0 / 11173962
choose client_indexes: [ 1  5  8 13 18], accoring to random
choose mask diff: [775668.0, 152680.0, 789252.0, 808326.0, 774846.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 5	Epoch: 0	Loss: 0.369663
Client Index = 5	Epoch: 1	Loss: 0.211168
Client Index = 5	Epoch: 2	Loss: 0.145677
Client Index = 5	Epoch: 3	Loss: 0.165464
Client Index = 5	Epoch: 4	Loss: 0.181799
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 6
local mask changes: 152766.0 / 11173962
choose client_indexes: [ 0  6  7  9 13], accoring to random
choose mask diff: [830538.0, 152766.0, 815240.0, 821216.0, 818216.0]
Doing local aggregation!
test acc on this client before 418 / 505 : 0.83
Client Index = 6	Epoch: 0	Loss: 0.346438
Client Index = 6	Epoch: 1	Loss: 0.431759
Client Index = 6	Epoch: 2	Loss: 0.275062
Client Index = 6	Epoch: 3	Loss: 0.303167
Client Index = 6	Epoch: 4	Loss: 0.200491
test acc on this client after 394 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 7
local mask changes: 152784.0 / 11173962
choose client_indexes: [ 7 10 12 13 16], accoring to random
choose mask diff: [152784.0, 799678.0, 796162.0, 805898.0, 794322.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 7	Epoch: 0	Loss: 0.423720
Client Index = 7	Epoch: 1	Loss: 0.191536
Client Index = 7	Epoch: 2	Loss: 0.184276
Client Index = 7	Epoch: 3	Loss: 0.173664
Client Index = 7	Epoch: 4	Loss: 0.155517
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 8
local mask changes: 152710.0 / 11173962
choose client_indexes: [ 2  6  8 12 18], accoring to random
choose mask diff: [790970.0, 813298.0, 152710.0, 801990.0, 787648.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 8	Epoch: 0	Loss: 0.395846
Client Index = 8	Epoch: 1	Loss: 0.234366
Client Index = 8	Epoch: 2	Loss: 0.267916
Client Index = 8	Epoch: 3	Loss: 0.193680
Client Index = 8	Epoch: 4	Loss: 0.211899
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 9
local mask changes: 152720.0 / 11173962
choose client_indexes: [ 4  8  9 15 19], accoring to random
choose mask diff: [787638.0, 796260.0, 152720.0, 782782.0, 789490.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.225645
Client Index = 9	Epoch: 1	Loss: 0.186642
Client Index = 9	Epoch: 2	Loss: 0.216119
Client Index = 9	Epoch: 3	Loss: 0.131197
Client Index = 9	Epoch: 4	Loss: 0.085953
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 10
local mask changes: 152676.0 / 11173962
choose client_indexes: [ 3  9 10 14 15], accoring to random
choose mask diff: [810380.0, 792536.0, 152676.0, 820784.0, 797910.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 10	Epoch: 0	Loss: 0.256362
Client Index = 10	Epoch: 1	Loss: 0.207627
Client Index = 10	Epoch: 2	Loss: 0.168065
Client Index = 10	Epoch: 3	Loss: 0.136761
Client Index = 10	Epoch: 4	Loss: 0.165155
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 11
local mask changes: 152672.0 / 11173962
choose client_indexes: [ 7  9 11 12 14], accoring to random
choose mask diff: [790842.0, 771352.0, 152672.0, 795590.0, 803016.0]
Doing local aggregation!
test acc on this client before 456 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.178142
Client Index = 11	Epoch: 1	Loss: 0.141491
Client Index = 11	Epoch: 2	Loss: 0.084493
Client Index = 11	Epoch: 3	Loss: 0.121397
Client Index = 11	Epoch: 4	Loss: 0.145699
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 12
local mask changes: 152494.0 / 11173962
choose client_indexes: [ 5  6 12 13 19], accoring to random
choose mask diff: [801426.0, 833930.0, 152494.0, 805646.0, 799044.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 12	Epoch: 0	Loss: 0.277699
Client Index = 12	Epoch: 1	Loss: 0.177524
Client Index = 12	Epoch: 2	Loss: 0.244173
Client Index = 12	Epoch: 3	Loss: 0.236188
Client Index = 12	Epoch: 4	Loss: 0.112911
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 13
local mask changes: 152558.0 / 11173962
choose client_indexes: [ 2  6 10 11 13], accoring to random
choose mask diff: [796548.0, 817162.0, 804324.0, 783338.0, 152558.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 13	Epoch: 0	Loss: 0.255042
Client Index = 13	Epoch: 1	Loss: 0.268441
Client Index = 13	Epoch: 2	Loss: 0.156045
Client Index = 13	Epoch: 3	Loss: 0.147799
Client Index = 13	Epoch: 4	Loss: 0.166930
test acc on this client after 423 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 14
local mask changes: 152594.0 / 11173962
choose client_indexes: [10 14 15 16 18], accoring to random
choose mask diff: [819584.0, 152594.0, 805990.0, 794360.0, 797536.0]
Doing local aggregation!
test acc on this client before 430 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.308254
Client Index = 14	Epoch: 1	Loss: 0.287556
Client Index = 14	Epoch: 2	Loss: 0.201433
Client Index = 14	Epoch: 3	Loss: 0.200557
Client Index = 14	Epoch: 4	Loss: 0.294884
test acc on this client after 401 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 15
local mask changes: 152708.0 / 11173962
choose client_indexes: [ 0  7  8 13 15], accoring to random
choose mask diff: [817634.0, 792886.0, 802260.0, 799476.0, 152708.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.213834
Client Index = 15	Epoch: 1	Loss: 0.195976
Client Index = 15	Epoch: 2	Loss: 0.213237
Client Index = 15	Epoch: 3	Loss: 0.166237
Client Index = 15	Epoch: 4	Loss: 0.114393
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 16
local mask changes: 152610.0 / 11173962
choose client_indexes: [ 0  6 12 16 17], accoring to random
choose mask diff: [829984.0, 828618.0, 802222.0, 152610.0, 781632.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.292187
Client Index = 16	Epoch: 1	Loss: 0.163057
Client Index = 16	Epoch: 2	Loss: 0.135381
Client Index = 16	Epoch: 3	Loss: 0.230155
Client Index = 16	Epoch: 4	Loss: 0.149325
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 17
local mask changes: 152466.0 / 11173962
choose client_indexes: [ 5  7 12 15 17], accoring to random
choose mask diff: [765716.0, 784212.0, 785376.0, 794304.0, 152466.0]
Doing local aggregation!
test acc on this client before 439 / 505 : 0.87
Client Index = 17	Epoch: 0	Loss: 0.299824
Client Index = 17	Epoch: 1	Loss: 0.307462
Client Index = 17	Epoch: 2	Loss: 0.173521
Client Index = 17	Epoch: 3	Loss: 0.111037
Client Index = 17	Epoch: 4	Loss: 0.084396
test acc on this client after 459 / 505 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 18
local mask changes: 152746.0 / 11173962
choose client_indexes: [ 2 13 15 16 18], accoring to random
choose mask diff: [768740.0, 784664.0, 792534.0, 775964.0, 152746.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.232226
Client Index = 18	Epoch: 1	Loss: 0.204420
Client Index = 18	Epoch: 2	Loss: 0.244555
Client Index = 18	Epoch: 3	Loss: 0.142491
Client Index = 18	Epoch: 4	Loss: 0.118452
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(89) with spasity 0.5: 19
local mask changes: 152670.0 / 11173962
choose client_indexes: [ 4 15 16 18 19], accoring to random
choose mask diff: [779708.0, 801004.0, 804134.0, 775976.0, 152670.0]
Doing local aggregation!
test acc on this client before 408 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.213054
Client Index = 19	Epoch: 1	Loss: 0.332467
Client Index = 19	Epoch: 2	Loss: 0.148939
Client Index = 19	Epoch: 3	Loss: 0.113322
Client Index = 19	Epoch: 4	Loss: 0.267933
test acc on this client after 424 / 506 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 89
{'test_acc': 0.8484455971102316, 'test_loss': 0.500923930889819}
################local_test_on_all_clients before local training in communication round: 89
{'test_acc': 0.8485601742679172, 'test_loss': 0.48226821112293117}
################Communication round : 90
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 0
local mask changes: 129052.0 / 11173962
choose client_indexes: [ 0 10 12 14 18], accoring to random
choose mask diff: [129052.0, 820606.0, 818038.0, 823798.0, 810724.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 0	Epoch: 0	Loss: 0.423023
Client Index = 0	Epoch: 1	Loss: 0.377721
Client Index = 0	Epoch: 2	Loss: 0.308705
Client Index = 0	Epoch: 3	Loss: 0.259593
Client Index = 0	Epoch: 4	Loss: 0.225242
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 1
local mask changes: 128950.0 / 11173962
choose client_indexes: [ 0  1  3 15 19], accoring to random
choose mask diff: [800882.0, 128950.0, 784324.0, 772942.0, 776842.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.329179
Client Index = 1	Epoch: 1	Loss: 0.200068
Client Index = 1	Epoch: 2	Loss: 0.116133
Client Index = 1	Epoch: 3	Loss: 0.102055
Client Index = 1	Epoch: 4	Loss: 0.073991
test acc on this client after 451 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 2
local mask changes: 128854.0 / 11173962
choose client_indexes: [ 2  4  9 14 18], accoring to random
choose mask diff: [128854.0, 766306.0, 774542.0, 790302.0, 759692.0]
Doing local aggregation!
test acc on this client before 425 / 502 : 0.85
Client Index = 2	Epoch: 0	Loss: 0.149941
Client Index = 2	Epoch: 1	Loss: 0.167560
Client Index = 2	Epoch: 2	Loss: 0.077342
Client Index = 2	Epoch: 3	Loss: 0.122671
Client Index = 2	Epoch: 4	Loss: 0.087289
test acc on this client after 424 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 3
local mask changes: 128940.0 / 11173962
choose client_indexes: [ 0  3  7 12 13], accoring to random
choose mask diff: [820456.0, 128940.0, 803032.0, 797418.0, 798088.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.390623
Client Index = 3	Epoch: 1	Loss: 0.290126
Client Index = 3	Epoch: 2	Loss: 0.288948
Client Index = 3	Epoch: 3	Loss: 0.235896
Client Index = 3	Epoch: 4	Loss: 0.237860
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 4
local mask changes: 128968.0 / 11173962
choose client_indexes: [ 0  4 12 13 15], accoring to random
choose mask diff: [806238.0, 128968.0, 789190.0, 785910.0, 791544.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.310511
Client Index = 4	Epoch: 1	Loss: 0.155461
Client Index = 4	Epoch: 2	Loss: 0.127669
Client Index = 4	Epoch: 3	Loss: 0.132321
Client Index = 4	Epoch: 4	Loss: 0.131972
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 5
local mask changes: 128926.0 / 11173962
choose client_indexes: [ 5  9 13 17 19], accoring to random
choose mask diff: [128926.0, 781030.0, 795676.0, 757968.0, 788304.0]
Doing local aggregation!
test acc on this client before 415 / 504 : 0.82
Client Index = 5	Epoch: 0	Loss: 0.212093
Client Index = 5	Epoch: 1	Loss: 0.199487
Client Index = 5	Epoch: 2	Loss: 0.129426
Client Index = 5	Epoch: 3	Loss: 0.284180
Client Index = 5	Epoch: 4	Loss: 0.127451
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 6
local mask changes: 129022.0 / 11173962
choose client_indexes: [ 0  1  6  7 12], accoring to random
choose mask diff: [821234.0, 809326.0, 129022.0, 805760.0, 826882.0]
Doing local aggregation!
test acc on this client before 405 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.495318
Client Index = 6	Epoch: 1	Loss: 0.334355
Client Index = 6	Epoch: 2	Loss: 0.338102
Client Index = 6	Epoch: 3	Loss: 0.288215
Client Index = 6	Epoch: 4	Loss: 0.199992
test acc on this client after 385 / 505 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 7
local mask changes: 128944.0 / 11173962
choose client_indexes: [ 5  7 16 17 19], accoring to random
choose mask diff: [772294.0, 128944.0, 784592.0, 776820.0, 796496.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 7	Epoch: 0	Loss: 0.225287
Client Index = 7	Epoch: 1	Loss: 0.182125
Client Index = 7	Epoch: 2	Loss: 0.294765
Client Index = 7	Epoch: 3	Loss: 0.159765
Client Index = 7	Epoch: 4	Loss: 0.166362
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 8
local mask changes: 128726.0 / 11173962
choose client_indexes: [ 2  5  8 13 16], accoring to random
choose mask diff: [781100.0, 780006.0, 128726.0, 792116.0, 791600.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.385511
Client Index = 8	Epoch: 1	Loss: 0.201567
Client Index = 8	Epoch: 2	Loss: 0.223239
Client Index = 8	Epoch: 3	Loss: 0.407695
Client Index = 8	Epoch: 4	Loss: 0.137143
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 9
local mask changes: 129070.0 / 11173962
choose client_indexes: [ 5  7  9 11 17], accoring to random
choose mask diff: [779710.0, 779338.0, 129070.0, 763940.0, 759204.0]
Doing local aggregation!
test acc on this client before 433 / 504 : 0.86
Client Index = 9	Epoch: 0	Loss: 0.201208
Client Index = 9	Epoch: 1	Loss: 0.193718
Client Index = 9	Epoch: 2	Loss: 0.158327
Client Index = 9	Epoch: 3	Loss: 0.122419
Client Index = 9	Epoch: 4	Loss: 0.203969
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 10
local mask changes: 128952.0 / 11173962
choose client_indexes: [ 1 10 11 14 16], accoring to random
choose mask diff: [778734.0, 128952.0, 783702.0, 809548.0, 789354.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 10	Epoch: 0	Loss: 0.353531
Client Index = 10	Epoch: 1	Loss: 0.197915
Client Index = 10	Epoch: 2	Loss: 0.153965
Client Index = 10	Epoch: 3	Loss: 0.120422
Client Index = 10	Epoch: 4	Loss: 0.215123
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 11
local mask changes: 129020.0 / 11173962
choose client_indexes: [ 1  9 11 15 17], accoring to random
choose mask diff: [754428.0, 762328.0, 129020.0, 784050.0, 743196.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 11	Epoch: 0	Loss: 0.311367
Client Index = 11	Epoch: 1	Loss: 0.113898
Client Index = 11	Epoch: 2	Loss: 0.133860
Client Index = 11	Epoch: 3	Loss: 0.086448
Client Index = 11	Epoch: 4	Loss: 0.092995
test acc on this client after 457 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 12
local mask changes: 128938.0 / 11173962
choose client_indexes: [ 7  9 12 16 17], accoring to random
choose mask diff: [788852.0, 784758.0, 128938.0, 795324.0, 776348.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 12	Epoch: 0	Loss: 0.285483
Client Index = 12	Epoch: 1	Loss: 0.203944
Client Index = 12	Epoch: 2	Loss: 0.183005
Client Index = 12	Epoch: 3	Loss: 0.135912
Client Index = 12	Epoch: 4	Loss: 0.138880
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 13
local mask changes: 128906.0 / 11173962
choose client_indexes: [ 4  7 11 13 19], accoring to random
choose mask diff: [786178.0, 797826.0, 773160.0, 128906.0, 791212.0]
Doing local aggregation!
test acc on this client before 433 / 503 : 0.86
Client Index = 13	Epoch: 0	Loss: 0.248466
Client Index = 13	Epoch: 1	Loss: 0.180509
Client Index = 13	Epoch: 2	Loss: 0.189483
Client Index = 13	Epoch: 3	Loss: 0.134116
Client Index = 13	Epoch: 4	Loss: 0.148839
test acc on this client after 411 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 14
local mask changes: 129010.0 / 11173962
choose client_indexes: [ 7 10 14 16 19], accoring to random
choose mask diff: [795506.0, 810846.0, 129010.0, 786242.0, 802804.0]
Doing local aggregation!
test acc on this client before 419 / 502 : 0.83
Client Index = 14	Epoch: 0	Loss: 0.326886
Client Index = 14	Epoch: 1	Loss: 0.226305
Client Index = 14	Epoch: 2	Loss: 0.259240
Client Index = 14	Epoch: 3	Loss: 0.190154
Client Index = 14	Epoch: 4	Loss: 0.262606
test acc on this client after 407 / 502 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 15
local mask changes: 129044.0 / 11173962
choose client_indexes: [11 12 13 15 17], accoring to random
choose mask diff: [784996.0, 792808.0, 790114.0, 129044.0, 786592.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.198450
Client Index = 15	Epoch: 1	Loss: 0.213213
Client Index = 15	Epoch: 2	Loss: 0.195908
Client Index = 15	Epoch: 3	Loss: 0.154800
Client Index = 15	Epoch: 4	Loss: 0.120125
test acc on this client after 430 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 16
local mask changes: 128922.0 / 11173962
choose client_indexes: [ 1 13 15 16 19], accoring to random
choose mask diff: [769640.0, 787770.0, 782360.0, 128922.0, 793786.0]
Doing local aggregation!
test acc on this client before 438 / 503 : 0.87
Client Index = 16	Epoch: 0	Loss: 0.244531
Client Index = 16	Epoch: 1	Loss: 0.183230
Client Index = 16	Epoch: 2	Loss: 0.134815
Client Index = 16	Epoch: 3	Loss: 0.129952
Client Index = 16	Epoch: 4	Loss: 0.096034
test acc on this client after 430 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 17
local mask changes: 129054.0 / 11173962
choose client_indexes: [ 3 13 15 17 18], accoring to random
choose mask diff: [785688.0, 770440.0, 782522.0, 129054.0, 755608.0]
Doing local aggregation!
test acc on this client before 424 / 505 : 0.84
Client Index = 17	Epoch: 0	Loss: 0.318912
Client Index = 17	Epoch: 1	Loss: 0.142098
Client Index = 17	Epoch: 2	Loss: 0.224196
Client Index = 17	Epoch: 3	Loss: 0.140685
Client Index = 17	Epoch: 4	Loss: 0.101044
test acc on this client after 455 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 18
local mask changes: 128900.0 / 11173962
choose client_indexes: [ 0 13 17 18 19], accoring to random
choose mask diff: [808414.0, 772418.0, 755838.0, 128900.0, 766868.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 18	Epoch: 0	Loss: 0.319647
Client Index = 18	Epoch: 1	Loss: 0.171033
Client Index = 18	Epoch: 2	Loss: 0.176090
Client Index = 18	Epoch: 3	Loss: 0.133863
Client Index = 18	Epoch: 4	Loss: 0.144169
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(90) with spasity 0.5: 19
local mask changes: 128864.0 / 11173962
choose client_indexes: [ 9 16 17 18 19], accoring to random
choose mask diff: [781518.0, 791872.0, 767568.0, 766372.0, 128864.0]
Doing local aggregation!
test acc on this client before 418 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.218055
Client Index = 19	Epoch: 1	Loss: 0.190592
Client Index = 19	Epoch: 2	Loss: 0.259208
Client Index = 19	Epoch: 3	Loss: 0.102846
Client Index = 19	Epoch: 4	Loss: 0.108817
test acc on this client after 418 / 506 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 90
{'test_acc': 0.8396002149822067, 'test_loss': 0.5481569938561541}
################local_test_on_all_clients before local training in communication round: 90
{'test_acc': 0.847161988828903, 'test_loss': 0.48256615062656527}
################Communication round : 91
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 0
local mask changes: 107102.0 / 11173962
choose client_indexes: [ 0  2  8 14 17], accoring to random
choose mask diff: [107102.0, 806768.0, 820972.0, 817010.0, 795268.0]
Doing local aggregation!
test acc on this client before 381 / 504 : 0.76
Client Index = 0	Epoch: 0	Loss: 0.435278
Client Index = 0	Epoch: 1	Loss: 0.352528
Client Index = 0	Epoch: 2	Loss: 0.291504
Client Index = 0	Epoch: 3	Loss: 0.253076
Client Index = 0	Epoch: 4	Loss: 0.336540
test acc on this client after 380 / 504 : 0.75
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 1
local mask changes: 107046.0 / 11173962
choose client_indexes: [ 1  5 10 14 17], accoring to random
choose mask diff: [107046.0, 758264.0, 768700.0, 791148.0, 741822.0]
Doing local aggregation!
test acc on this client before 445 / 503 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.165176
Client Index = 1	Epoch: 1	Loss: 0.144612
Client Index = 1	Epoch: 2	Loss: 0.094061
Client Index = 1	Epoch: 3	Loss: 0.110127
Client Index = 1	Epoch: 4	Loss: 0.189576
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 2
local mask changes: 106932.0 / 11173962
choose client_indexes: [1 2 3 7 9], accoring to random
choose mask diff: [750592.0, 106932.0, 778984.0, 764798.0, 765058.0]
Doing local aggregation!
test acc on this client before 452 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.174367
Client Index = 2	Epoch: 1	Loss: 0.156835
Client Index = 2	Epoch: 2	Loss: 0.104664
Client Index = 2	Epoch: 3	Loss: 0.089321
Client Index = 2	Epoch: 4	Loss: 0.086258
test acc on this client after 438 / 502 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 3
local mask changes: 107108.0 / 11173962
choose client_indexes: [0 1 3 4 8], accoring to random
choose mask diff: [813776.0, 777942.0, 107108.0, 776374.0, 797074.0]
Doing local aggregation!
test acc on this client before 408 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.354634
Client Index = 3	Epoch: 1	Loss: 0.229600
Client Index = 3	Epoch: 2	Loss: 0.272694
Client Index = 3	Epoch: 3	Loss: 0.217312
Client Index = 3	Epoch: 4	Loss: 0.263077
test acc on this client after 415 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 4
local mask changes: 107096.0 / 11173962
choose client_indexes: [ 3  4  5 17 19], accoring to random
choose mask diff: [774232.0, 107096.0, 773300.0, 749218.0, 763896.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.419591
Client Index = 4	Epoch: 1	Loss: 0.142397
Client Index = 4	Epoch: 2	Loss: 0.152074
Client Index = 4	Epoch: 3	Loss: 0.086346
Client Index = 4	Epoch: 4	Loss: 0.130841
test acc on this client after 445 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 5
local mask changes: 107092.0 / 11173962
choose client_indexes: [ 0  5  7 15 19], accoring to random
choose mask diff: [801730.0, 107092.0, 765714.0, 784556.0, 779954.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 5	Epoch: 0	Loss: 0.231466
Client Index = 5	Epoch: 1	Loss: 0.155572
Client Index = 5	Epoch: 2	Loss: 0.247237
Client Index = 5	Epoch: 3	Loss: 0.156331
Client Index = 5	Epoch: 4	Loss: 0.251716
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 6
local mask changes: 107108.0 / 11173962
choose client_indexes: [ 6  8 12 17 18], accoring to random
choose mask diff: [107108.0, 798780.0, 817388.0, 788440.0, 797034.0]
Doing local aggregation!
test acc on this client before 405 / 505 : 0.80
Client Index = 6	Epoch: 0	Loss: 0.359465
Client Index = 6	Epoch: 1	Loss: 0.291428
Client Index = 6	Epoch: 2	Loss: 0.396659
Client Index = 6	Epoch: 3	Loss: 0.268460
Client Index = 6	Epoch: 4	Loss: 0.310705
test acc on this client after 368 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 7
local mask changes: 106994.0 / 11173962
choose client_indexes: [ 0  3  7 14 17], accoring to random
choose mask diff: [813088.0, 795964.0, 106994.0, 788902.0, 765530.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 7	Epoch: 0	Loss: 0.327711
Client Index = 7	Epoch: 1	Loss: 0.155807
Client Index = 7	Epoch: 2	Loss: 0.193302
Client Index = 7	Epoch: 3	Loss: 0.190835
Client Index = 7	Epoch: 4	Loss: 0.102488
test acc on this client after 432 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 8
local mask changes: 107130.0 / 11173962
choose client_indexes: [ 0  5  8 13 14], accoring to random
choose mask diff: [819408.0, 769446.0, 107130.0, 783756.0, 802038.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.476754
Client Index = 8	Epoch: 1	Loss: 0.219102
Client Index = 8	Epoch: 2	Loss: 0.245904
Client Index = 8	Epoch: 3	Loss: 0.191497
Client Index = 8	Epoch: 4	Loss: 0.214745
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 9
local mask changes: 107024.0 / 11173962
choose client_indexes: [ 1  5  7  9 14], accoring to random
choose mask diff: [753080.0, 771004.0, 770628.0, 107024.0, 788024.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.210580
Client Index = 9	Epoch: 1	Loss: 0.280684
Client Index = 9	Epoch: 2	Loss: 0.120245
Client Index = 9	Epoch: 3	Loss: 0.112327
Client Index = 9	Epoch: 4	Loss: 0.100972
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 10
local mask changes: 107106.0 / 11173962
choose client_indexes: [10 11 12 14 15], accoring to random
choose mask diff: [107106.0, 776554.0, 798604.0, 800738.0, 782222.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.269950
Client Index = 10	Epoch: 1	Loss: 0.261894
Client Index = 10	Epoch: 2	Loss: 0.147413
Client Index = 10	Epoch: 3	Loss: 0.121164
Client Index = 10	Epoch: 4	Loss: 0.110158
test acc on this client after 426 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 11
local mask changes: 107112.0 / 11173962
choose client_indexes: [11 12 14 18 19], accoring to random
choose mask diff: [107112.0, 778250.0, 787142.0, 756904.0, 761446.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.189440
Client Index = 11	Epoch: 1	Loss: 0.287503
Client Index = 11	Epoch: 2	Loss: 0.094014
Client Index = 11	Epoch: 3	Loss: 0.084927
Client Index = 11	Epoch: 4	Loss: 0.103792
test acc on this client after 463 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 12
local mask changes: 107060.0 / 11173962
choose client_indexes: [ 2 12 16 18 19], accoring to random
choose mask diff: [777620.0, 107060.0, 785262.0, 776994.0, 780422.0]
Doing local aggregation!
test acc on this client before 424 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.258607
Client Index = 12	Epoch: 1	Loss: 0.221011
Client Index = 12	Epoch: 2	Loss: 0.218022
Client Index = 12	Epoch: 3	Loss: 0.183684
Client Index = 12	Epoch: 4	Loss: 0.135405
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 13
local mask changes: 107122.0 / 11173962
choose client_indexes: [ 2 13 16 18 19], accoring to random
choose mask diff: [776336.0, 107122.0, 781420.0, 766862.0, 783198.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.216701
Client Index = 13	Epoch: 1	Loss: 0.225618
Client Index = 13	Epoch: 2	Loss: 0.233349
Client Index = 13	Epoch: 3	Loss: 0.132995
Client Index = 13	Epoch: 4	Loss: 0.125439
test acc on this client after 399 / 503 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 14
local mask changes: 107078.0 / 11173962
choose client_indexes: [ 5 12 14 15 18], accoring to random
choose mask diff: [789100.0, 812982.0, 107078.0, 791150.0, 781302.0]
Doing local aggregation!
test acc on this client before 429 / 502 : 0.85
Client Index = 14	Epoch: 0	Loss: 0.338758
Client Index = 14	Epoch: 1	Loss: 0.298654
Client Index = 14	Epoch: 2	Loss: 0.224983
Client Index = 14	Epoch: 3	Loss: 0.260100
Client Index = 14	Epoch: 4	Loss: 0.188166
test acc on this client after 411 / 502 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 15
local mask changes: 107026.0 / 11173962
choose client_indexes: [ 7  9 15 16 18], accoring to random
choose mask diff: [776442.0, 765338.0, 107026.0, 776650.0, 775418.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.248145
Client Index = 15	Epoch: 1	Loss: 0.148003
Client Index = 15	Epoch: 2	Loss: 0.148045
Client Index = 15	Epoch: 3	Loss: 0.126077
Client Index = 15	Epoch: 4	Loss: 0.126069
test acc on this client after 423 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 16
local mask changes: 107114.0 / 11173962
choose client_indexes: [ 8 12 14 16 18], accoring to random
choose mask diff: [784868.0, 786234.0, 779792.0, 107114.0, 758042.0]
Doing local aggregation!
test acc on this client before 444 / 503 : 0.88
Client Index = 16	Epoch: 0	Loss: 0.177108
Client Index = 16	Epoch: 1	Loss: 0.212039
Client Index = 16	Epoch: 2	Loss: 0.134598
Client Index = 16	Epoch: 3	Loss: 0.118735
Client Index = 16	Epoch: 4	Loss: 0.093168
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 17
local mask changes: 107078.0 / 11173962
choose client_indexes: [ 1  8 10 11 17], accoring to random
choose mask diff: [741636.0, 777300.0, 777486.0, 735640.0, 107078.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.350299
Client Index = 17	Epoch: 1	Loss: 0.119894
Client Index = 17	Epoch: 2	Loss: 0.188603
Client Index = 17	Epoch: 3	Loss: 0.109880
Client Index = 17	Epoch: 4	Loss: 0.090949
test acc on this client after 418 / 505 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 18
local mask changes: 107026.0 / 11173962
choose client_indexes: [10 13 15 16 18], accoring to random
choose mask diff: [784932.0, 763728.0, 774590.0, 757210.0, 107026.0]
Doing local aggregation!
test acc on this client before 449 / 504 : 0.89
Client Index = 18	Epoch: 0	Loss: 0.354114
Client Index = 18	Epoch: 1	Loss: 0.202864
Client Index = 18	Epoch: 2	Loss: 0.221437
Client Index = 18	Epoch: 3	Loss: 0.156501
Client Index = 18	Epoch: 4	Loss: 0.134962
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(91) with spasity 0.5: 19
local mask changes: 107022.0 / 11173962
choose client_indexes: [ 0  4 12 18 19], accoring to random
choose mask diff: [815230.0, 764008.0, 779930.0, 757352.0, 107022.0]
Doing local aggregation!
test acc on this client before 420 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.232521
Client Index = 19	Epoch: 1	Loss: 0.160343
Client Index = 19	Epoch: 2	Loss: 0.110255
Client Index = 19	Epoch: 3	Loss: 0.093122
Client Index = 19	Epoch: 4	Loss: 0.137425
test acc on this client after 403 / 506 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 91
{'test_acc': 0.8426112519323607, 'test_loss': 0.5478709704372534}
################local_test_on_all_clients before local training in communication round: 91
{'test_acc': 0.8525325653144012, 'test_loss': 0.4852076624236609}
################Communication round : 92
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 0
local mask changes: 87092.0 / 11173962
choose client_indexes: [ 0  4  5 10 13], accoring to random
choose mask diff: [87092.0, 796216.0, 798834.0, 810044.0, 813826.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.429404
Client Index = 0	Epoch: 1	Loss: 0.292760
Client Index = 0	Epoch: 2	Loss: 0.284379
Client Index = 0	Epoch: 3	Loss: 0.202191
Client Index = 0	Epoch: 4	Loss: 0.311621
test acc on this client after 387 / 504 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 1
local mask changes: 87106.0 / 11173962
choose client_indexes: [ 1  2 12 14 15], accoring to random
choose mask diff: [87106.0, 745610.0, 767214.0, 785006.0, 760296.0]
Doing local aggregation!
test acc on this client before 447 / 503 : 0.89
Client Index = 1	Epoch: 0	Loss: 0.186088
Client Index = 1	Epoch: 1	Loss: 0.121316
Client Index = 1	Epoch: 2	Loss: 0.116210
Client Index = 1	Epoch: 3	Loss: 0.071355
Client Index = 1	Epoch: 4	Loss: 0.070715
test acc on this client after 447 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 2
local mask changes: 87104.0 / 11173962
choose client_indexes: [ 2  4 10 12 16], accoring to random
choose mask diff: [87104.0, 749830.0, 772582.0, 771118.0, 764388.0]
Doing local aggregation!
test acc on this client before 440 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.253926
Client Index = 2	Epoch: 1	Loss: 0.118756
Client Index = 2	Epoch: 2	Loss: 0.101583
Client Index = 2	Epoch: 3	Loss: 0.057960
Client Index = 2	Epoch: 4	Loss: 0.179455
test acc on this client after 458 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 3
local mask changes: 87124.0 / 11173962
choose client_indexes: [ 2  3  5 12 17], accoring to random
choose mask diff: [776334.0, 87124.0, 791204.0, 786330.0, 772044.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.363117
Client Index = 3	Epoch: 1	Loss: 0.296311
Client Index = 3	Epoch: 2	Loss: 0.210740
Client Index = 3	Epoch: 3	Loss: 0.277919
Client Index = 3	Epoch: 4	Loss: 0.268066
test acc on this client after 410 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 4
local mask changes: 87084.0 / 11173962
choose client_indexes: [ 0  4  6 16 19], accoring to random
choose mask diff: [793990.0, 87084.0, 788114.0, 765244.0, 756686.0]
Doing local aggregation!
test acc on this client before 434 / 503 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.243254
Client Index = 4	Epoch: 1	Loss: 0.121096
Client Index = 4	Epoch: 2	Loss: 0.177509
Client Index = 4	Epoch: 3	Loss: 0.087907
Client Index = 4	Epoch: 4	Loss: 0.343053
test acc on this client after 437 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 5
local mask changes: 87026.0 / 11173962
choose client_indexes: [ 2  5 16 17 18], accoring to random
choose mask diff: [767568.0, 87026.0, 769092.0, 741726.0, 752376.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 5	Epoch: 0	Loss: 0.390214
Client Index = 5	Epoch: 1	Loss: 0.158217
Client Index = 5	Epoch: 2	Loss: 0.204924
Client Index = 5	Epoch: 3	Loss: 0.130642
Client Index = 5	Epoch: 4	Loss: 0.100419
test acc on this client after 435 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 6
local mask changes: 87196.0 / 11173962
choose client_indexes: [ 0  6 10 12 19], accoring to random
choose mask diff: [810914.0, 87196.0, 807402.0, 811370.0, 802266.0]
Doing local aggregation!
test acc on this client before 425 / 505 : 0.84
Client Index = 6	Epoch: 0	Loss: 0.406651
Client Index = 6	Epoch: 1	Loss: 0.332328
Client Index = 6	Epoch: 2	Loss: 0.298282
Client Index = 6	Epoch: 3	Loss: 0.327565
Client Index = 6	Epoch: 4	Loss: 0.238673
test acc on this client after 401 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 7
local mask changes: 87162.0 / 11173962
choose client_indexes: [ 1  7  8  9 12], accoring to random
choose mask diff: [760612.0, 87162.0, 772244.0, 765752.0, 773226.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 7	Epoch: 0	Loss: 0.198060
Client Index = 7	Epoch: 1	Loss: 0.268282
Client Index = 7	Epoch: 2	Loss: 0.289325
Client Index = 7	Epoch: 3	Loss: 0.105856
Client Index = 7	Epoch: 4	Loss: 0.088039
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 8
local mask changes: 87196.0 / 11173962
choose client_indexes: [ 1  5  8 13 14], accoring to random
choose mask diff: [774306.0, 763006.0, 87196.0, 777868.0, 796270.0]
Doing local aggregation!
test acc on this client before 452 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.373187
Client Index = 8	Epoch: 1	Loss: 0.369959
Client Index = 8	Epoch: 2	Loss: 0.200109
Client Index = 8	Epoch: 3	Loss: 0.224241
Client Index = 8	Epoch: 4	Loss: 0.161809
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 9
local mask changes: 87126.0 / 11173962
choose client_indexes: [ 8  9 10 14 17], accoring to random
choose mask diff: [774206.0, 87126.0, 771626.0, 781664.0, 743574.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 9	Epoch: 0	Loss: 0.239360
Client Index = 9	Epoch: 1	Loss: 0.221458
Client Index = 9	Epoch: 2	Loss: 0.138204
Client Index = 9	Epoch: 3	Loss: 0.106487
Client Index = 9	Epoch: 4	Loss: 0.105750
test acc on this client after 440 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 10
local mask changes: 87128.0 / 11173962
choose client_indexes: [ 4  5 10 11 15], accoring to random
choose mask diff: [772260.0, 777738.0, 87128.0, 769630.0, 775960.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.253777
Client Index = 10	Epoch: 1	Loss: 0.350997
Client Index = 10	Epoch: 2	Loss: 0.112889
Client Index = 10	Epoch: 3	Loss: 0.109470
Client Index = 10	Epoch: 4	Loss: 0.159619
test acc on this client after 342 / 503 : 0.68
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 11
local mask changes: 87058.0 / 11173962
choose client_indexes: [ 0  3 11 15 18], accoring to random
choose mask diff: [791868.0, 777806.0, 87058.0, 767760.0, 749308.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.185308
Client Index = 11	Epoch: 1	Loss: 0.120802
Client Index = 11	Epoch: 2	Loss: 0.105119
Client Index = 11	Epoch: 3	Loss: 0.076709
Client Index = 11	Epoch: 4	Loss: 0.182754
test acc on this client after 412 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 12
local mask changes: 87132.0 / 11173962
choose client_indexes: [ 7 12 14 15 16], accoring to random
choose mask diff: [773568.0, 87132.0, 807724.0, 779788.0, 778574.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.316523
Client Index = 12	Epoch: 1	Loss: 0.186184
Client Index = 12	Epoch: 2	Loss: 0.235428
Client Index = 12	Epoch: 3	Loss: 0.134609
Client Index = 12	Epoch: 4	Loss: 0.118115
test acc on this client after 429 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 13
local mask changes: 87050.0 / 11173962
choose client_indexes: [ 3  5 13 17 19], accoring to random
choose mask diff: [786522.0, 782250.0, 87050.0, 756676.0, 776640.0]
Doing local aggregation!
test acc on this client before 420 / 503 : 0.83
Client Index = 13	Epoch: 0	Loss: 0.379869
Client Index = 13	Epoch: 1	Loss: 0.219349
Client Index = 13	Epoch: 2	Loss: 0.139759
Client Index = 13	Epoch: 3	Loss: 0.146145
Client Index = 13	Epoch: 4	Loss: 0.120719
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 14
local mask changes: 87100.0 / 11173962
choose client_indexes: [ 7 10 11 14 15], accoring to random
choose mask diff: [783326.0, 794798.0, 783366.0, 87100.0, 785202.0]
Doing local aggregation!
test acc on this client before 437 / 502 : 0.87
Client Index = 14	Epoch: 0	Loss: 0.321449
Client Index = 14	Epoch: 1	Loss: 0.217641
Client Index = 14	Epoch: 2	Loss: 0.224437
Client Index = 14	Epoch: 3	Loss: 0.209237
Client Index = 14	Epoch: 4	Loss: 0.176812
test acc on this client after 424 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 15
local mask changes: 87106.0 / 11173962
choose client_indexes: [ 1  7  9 15 16], accoring to random
choose mask diff: [760524.0, 769456.0, 758386.0, 87106.0, 768252.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.247199
Client Index = 15	Epoch: 1	Loss: 0.196938
Client Index = 15	Epoch: 2	Loss: 0.133496
Client Index = 15	Epoch: 3	Loss: 0.134626
Client Index = 15	Epoch: 4	Loss: 0.117390
test acc on this client after 420 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 16
local mask changes: 87106.0 / 11173962
choose client_indexes: [ 3 12 16 18 19], accoring to random
choose mask diff: [773848.0, 777912.0, 87106.0, 750834.0, 775662.0]
Doing local aggregation!
test acc on this client before 448 / 503 : 0.89
Client Index = 16	Epoch: 0	Loss: 0.231921
Client Index = 16	Epoch: 1	Loss: 0.264266
Client Index = 16	Epoch: 2	Loss: 0.172820
Client Index = 16	Epoch: 3	Loss: 0.101733
Client Index = 16	Epoch: 4	Loss: 0.081098
test acc on this client after 442 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 17
local mask changes: 87082.0 / 11173962
choose client_indexes: [ 3  7  9 17 18], accoring to random
choose mask diff: [769824.0, 758600.0, 743226.0, 87082.0, 738432.0]
Doing local aggregation!
test acc on this client before 429 / 505 : 0.85
Client Index = 17	Epoch: 0	Loss: 0.335581
Client Index = 17	Epoch: 1	Loss: 0.126439
Client Index = 17	Epoch: 2	Loss: 0.232974
Client Index = 17	Epoch: 3	Loss: 0.192653
Client Index = 17	Epoch: 4	Loss: 0.071987
test acc on this client after 454 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 18
local mask changes: 86982.0 / 11173962
choose client_indexes: [ 3  4  8 14 18], accoring to random
choose mask diff: [769480.0, 751882.0, 764224.0, 774782.0, 86982.0]
Doing local aggregation!
test acc on this client before 452 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.258329
Client Index = 18	Epoch: 1	Loss: 0.179561
Client Index = 18	Epoch: 2	Loss: 0.206388
Client Index = 18	Epoch: 3	Loss: 0.181277
Client Index = 18	Epoch: 4	Loss: 0.130695
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(92) with spasity 0.5: 19
local mask changes: 87138.0 / 11173962
choose client_indexes: [ 7 10 13 18 19], accoring to random
choose mask diff: [782448.0, 790462.0, 777816.0, 748522.0, 87138.0]
Doing local aggregation!
test acc on this client before 412 / 506 : 0.81
Client Index = 19	Epoch: 0	Loss: 0.253563
Client Index = 19	Epoch: 1	Loss: 0.157584
Client Index = 19	Epoch: 2	Loss: 0.142632
Client Index = 19	Epoch: 3	Loss: 0.108580
Client Index = 19	Epoch: 4	Loss: 0.090918
test acc on this client after 417 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 92
{'test_acc': 0.8425916415686178, 'test_loss': 0.5398437223577923}
################local_test_on_all_clients before local training in communication round: 92
{'test_acc': 0.8574889475799207, 'test_loss': 0.46476555865886227}
################Communication round : 93
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 0
local mask changes: 69094.0 / 11173962
choose client_indexes: [ 0 10 11 12 17], accoring to random
choose mask diff: [69094.0, 806266.0, 790756.0, 803784.0, 786132.0]
Doing local aggregation!
test acc on this client before 393 / 504 : 0.78
Client Index = 0	Epoch: 0	Loss: 0.360349
Client Index = 0	Epoch: 1	Loss: 0.305803
Client Index = 0	Epoch: 2	Loss: 0.257091
Client Index = 0	Epoch: 3	Loss: 0.261745
Client Index = 0	Epoch: 4	Loss: 0.358704
test acc on this client after 372 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 1
local mask changes: 69126.0 / 11173962
choose client_indexes: [ 1  4  8 11 12], accoring to random
choose mask diff: [69126.0, 751558.0, 769948.0, 736006.0, 761894.0]
Doing local aggregation!
test acc on this client before 443 / 503 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.213650
Client Index = 1	Epoch: 1	Loss: 0.120341
Client Index = 1	Epoch: 2	Loss: 0.111514
Client Index = 1	Epoch: 3	Loss: 0.106024
Client Index = 1	Epoch: 4	Loss: 0.051811
test acc on this client after 458 / 503 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 2
local mask changes: 69066.0 / 11173962
choose client_indexes: [ 0  2  6  8 17], accoring to random
choose mask diff: [795700.0, 69066.0, 788626.0, 760570.0, 741740.0]
Doing local aggregation!
test acc on this client before 453 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.160704
Client Index = 2	Epoch: 1	Loss: 0.150232
Client Index = 2	Epoch: 2	Loss: 0.089000
Client Index = 2	Epoch: 3	Loss: 0.066649
Client Index = 2	Epoch: 4	Loss: 0.181418
test acc on this client after 456 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 3
local mask changes: 69082.0 / 11173962
choose client_indexes: [ 0  1  3 16 18], accoring to random
choose mask diff: [805752.0, 766688.0, 69082.0, 771398.0, 767530.0]
Doing local aggregation!
test acc on this client before 420 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.336648
Client Index = 3	Epoch: 1	Loss: 0.338300
Client Index = 3	Epoch: 2	Loss: 0.197260
Client Index = 3	Epoch: 3	Loss: 0.271988
Client Index = 3	Epoch: 4	Loss: 0.177434
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 4
local mask changes: 69062.0 / 11173962
choose client_indexes: [ 1  4  9 13 15], accoring to random
choose mask diff: [752936.0, 69062.0, 761876.0, 766268.0, 774292.0]
Doing local aggregation!
test acc on this client before 402 / 503 : 0.80
Client Index = 4	Epoch: 0	Loss: 0.226474
Client Index = 4	Epoch: 1	Loss: 0.147808
Client Index = 4	Epoch: 2	Loss: 0.362691
Client Index = 4	Epoch: 3	Loss: 0.116405
Client Index = 4	Epoch: 4	Loss: 0.092696
test acc on this client after 434 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 5
local mask changes: 69074.0 / 11173962
choose client_indexes: [ 0  1  5  7 15], accoring to random
choose mask diff: [792706.0, 748004.0, 69074.0, 753060.0, 773620.0]
Doing local aggregation!
test acc on this client before 437 / 504 : 0.87
Client Index = 5	Epoch: 0	Loss: 0.371866
Client Index = 5	Epoch: 1	Loss: 0.153341
Client Index = 5	Epoch: 2	Loss: 0.133532
Client Index = 5	Epoch: 3	Loss: 0.175962
Client Index = 5	Epoch: 4	Loss: 0.182076
test acc on this client after 451 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 6
local mask changes: 69090.0 / 11173962
choose client_indexes: [ 1  2  6  7 19], accoring to random
choose mask diff: [794312.0, 790204.0, 69090.0, 790952.0, 798208.0]
Doing local aggregation!
test acc on this client before 413 / 505 : 0.82
Client Index = 6	Epoch: 0	Loss: 0.377553
Client Index = 6	Epoch: 1	Loss: 0.337958
Client Index = 6	Epoch: 2	Loss: 0.336172
Client Index = 6	Epoch: 3	Loss: 0.270141
Client Index = 6	Epoch: 4	Loss: 0.189598
test acc on this client after 375 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 7
local mask changes: 69048.0 / 11173962
choose client_indexes: [ 1  3  7 12 14], accoring to random
choose mask diff: [755558.0, 785248.0, 69048.0, 768196.0, 777244.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 7	Epoch: 0	Loss: 0.341514
Client Index = 7	Epoch: 1	Loss: 0.163998
Client Index = 7	Epoch: 2	Loss: 0.173922
Client Index = 7	Epoch: 3	Loss: 0.110450
Client Index = 7	Epoch: 4	Loss: 0.102954
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 8
local mask changes: 69152.0 / 11173962
choose client_indexes: [ 0  3  8 11 14], accoring to random
choose mask diff: [809258.0, 787852.0, 69152.0, 764360.0, 791718.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.340835
Client Index = 8	Epoch: 1	Loss: 0.232145
Client Index = 8	Epoch: 2	Loss: 0.182276
Client Index = 8	Epoch: 3	Loss: 0.174800
Client Index = 8	Epoch: 4	Loss: 0.299961
test acc on this client after 362 / 504 : 0.72
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 9
local mask changes: 69140.0 / 11173962
choose client_indexes: [ 0  7  9 17 19], accoring to random
choose mask diff: [801048.0, 759890.0, 69140.0, 737938.0, 760504.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 9	Epoch: 0	Loss: 0.229659
Client Index = 9	Epoch: 1	Loss: 0.179350
Client Index = 9	Epoch: 2	Loss: 0.178035
Client Index = 9	Epoch: 3	Loss: 0.111626
Client Index = 9	Epoch: 4	Loss: 0.084343
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 10
local mask changes: 69142.0 / 11173962
choose client_indexes: [ 8 10 14 17 19], accoring to random
choose mask diff: [781238.0, 69142.0, 789706.0, 767768.0, 786856.0]
Doing local aggregation!
test acc on this client before 428 / 503 : 0.85
Client Index = 10	Epoch: 0	Loss: 0.254364
Client Index = 10	Epoch: 1	Loss: 0.191238
Client Index = 10	Epoch: 2	Loss: 0.250310
Client Index = 10	Epoch: 3	Loss: 0.110324
Client Index = 10	Epoch: 4	Loss: 0.126944
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 11
local mask changes: 69102.0 / 11173962
choose client_indexes: [ 0  3  7 11 19], accoring to random
choose mask diff: [787880.0, 773850.0, 764022.0, 69102.0, 751522.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 11	Epoch: 0	Loss: 0.174703
Client Index = 11	Epoch: 1	Loss: 0.150634
Client Index = 11	Epoch: 2	Loss: 0.345880
Client Index = 11	Epoch: 3	Loss: 0.094492
Client Index = 11	Epoch: 4	Loss: 0.070215
test acc on this client after 459 / 504 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 12
local mask changes: 69044.0 / 11173962
choose client_indexes: [ 3 10 12 15 19], accoring to random
choose mask diff: [783122.0, 788616.0, 69044.0, 774382.0, 768414.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 12	Epoch: 0	Loss: 0.240156
Client Index = 12	Epoch: 1	Loss: 0.333056
Client Index = 12	Epoch: 2	Loss: 0.147684
Client Index = 12	Epoch: 3	Loss: 0.139928
Client Index = 12	Epoch: 4	Loss: 0.111069
test acc on this client after 373 / 504 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 13
local mask changes: 69064.0 / 11173962
choose client_indexes: [ 7  9 10 13 14], accoring to random
choose mask diff: [778618.0, 768212.0, 780926.0, 69064.0, 794266.0]
Doing local aggregation!
test acc on this client before 435 / 503 : 0.86
Client Index = 13	Epoch: 0	Loss: 0.293635
Client Index = 13	Epoch: 1	Loss: 0.217991
Client Index = 13	Epoch: 2	Loss: 0.151460
Client Index = 13	Epoch: 3	Loss: 0.151428
Client Index = 13	Epoch: 4	Loss: 0.128375
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 14
local mask changes: 69118.0 / 11173962
choose client_indexes: [ 7 10 11 14 15], accoring to random
choose mask diff: [777228.0, 788884.0, 777132.0, 69118.0, 780472.0]
Doing local aggregation!
test acc on this client before 433 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.404039
Client Index = 14	Epoch: 1	Loss: 0.259846
Client Index = 14	Epoch: 2	Loss: 0.193181
Client Index = 14	Epoch: 3	Loss: 0.206070
Client Index = 14	Epoch: 4	Loss: 0.187984
test acc on this client after 384 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 15
local mask changes: 69152.0 / 11173962
choose client_indexes: [ 4  5  7  8 15], accoring to random
choose mask diff: [774094.0, 774608.0, 764792.0, 778032.0, 69152.0]
Doing local aggregation!
test acc on this client before 439 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.222603
Client Index = 15	Epoch: 1	Loss: 0.161016
Client Index = 15	Epoch: 2	Loss: 0.129885
Client Index = 15	Epoch: 3	Loss: 0.116660
Client Index = 15	Epoch: 4	Loss: 0.100542
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 16
local mask changes: 69166.0 / 11173962
choose client_indexes: [ 2  9 11 16 17], accoring to random
choose mask diff: [760320.0, 749838.0, 751334.0, 69166.0, 752658.0]
Doing local aggregation!
test acc on this client before 445 / 503 : 0.88
Client Index = 16	Epoch: 0	Loss: 0.214242
Client Index = 16	Epoch: 1	Loss: 0.155078
Client Index = 16	Epoch: 2	Loss: 0.112979
Client Index = 16	Epoch: 3	Loss: 0.210063
Client Index = 16	Epoch: 4	Loss: 0.115437
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 17
local mask changes: 69106.0 / 11173962
choose client_indexes: [ 1  5  8 17 18], accoring to random
choose mask diff: [728010.0, 736454.0, 764990.0, 69106.0, 732226.0]
Doing local aggregation!
test acc on this client before 424 / 505 : 0.84
Client Index = 17	Epoch: 0	Loss: 0.293331
Client Index = 17	Epoch: 1	Loss: 0.132822
Client Index = 17	Epoch: 2	Loss: 0.156005
Client Index = 17	Epoch: 3	Loss: 0.116290
Client Index = 17	Epoch: 4	Loss: 0.128508
test acc on this client after 450 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 18
local mask changes: 69152.0 / 11173962
choose client_indexes: [ 3  7 12 13 18], accoring to random
choose mask diff: [764882.0, 755878.0, 765266.0, 751802.0, 69152.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.246296
Client Index = 18	Epoch: 1	Loss: 0.201626
Client Index = 18	Epoch: 2	Loss: 0.167070
Client Index = 18	Epoch: 3	Loss: 0.155312
Client Index = 18	Epoch: 4	Loss: 0.112850
test acc on this client after 437 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(93) with spasity 0.5: 19
local mask changes: 69076.0 / 11173962
choose client_indexes: [ 0  8 10 13 19], accoring to random
choose mask diff: [805564.0, 783786.0, 785352.0, 771240.0, 69076.0]
Doing local aggregation!
test acc on this client before 417 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.346343
Client Index = 19	Epoch: 1	Loss: 0.144974
Client Index = 19	Epoch: 2	Loss: 0.161456
Client Index = 19	Epoch: 3	Loss: 0.077534
Client Index = 19	Epoch: 4	Loss: 0.108986
test acc on this client after 435 / 506 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 93
{'test_acc': 0.8345499960639033, 'test_loss': 0.5775635620567466}
################local_test_on_all_clients before local training in communication round: 93
{'test_acc': 0.8606651340757037, 'test_loss': 0.4528285512192879}
################Communication round : 94
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 0
local mask changes: 53036.0 / 11173962
choose client_indexes: [ 0  3  9 11 18], accoring to random
choose mask diff: [53036.0, 805358.0, 801218.0, 787546.0, 790882.0]
Doing local aggregation!
test acc on this client before 397 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.342872
Client Index = 0	Epoch: 1	Loss: 0.279743
Client Index = 0	Epoch: 2	Loss: 0.266082
Client Index = 0	Epoch: 3	Loss: 0.229372
Client Index = 0	Epoch: 4	Loss: 0.213126
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 1
local mask changes: 53098.0 / 11173962
choose client_indexes: [ 1  2  8  9 16], accoring to random
choose mask diff: [53098.0, 734872.0, 764948.0, 738802.0, 747762.0]
Doing local aggregation!
test acc on this client before 440 / 503 : 0.87
Client Index = 1	Epoch: 0	Loss: 0.163862
Client Index = 1	Epoch: 1	Loss: 0.143720
Client Index = 1	Epoch: 2	Loss: 0.352809
Client Index = 1	Epoch: 3	Loss: 0.115217
Client Index = 1	Epoch: 4	Loss: 0.084881
test acc on this client after 458 / 503 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 2
local mask changes: 53078.0 / 11173962
choose client_indexes: [ 2  3 11 14 17], accoring to random
choose mask diff: [53078.0, 765960.0, 738548.0, 772124.0, 736988.0]
Doing local aggregation!
test acc on this client before 446 / 502 : 0.89
Client Index = 2	Epoch: 0	Loss: 0.314718
Client Index = 2	Epoch: 1	Loss: 0.132948
Client Index = 2	Epoch: 2	Loss: 0.097736
Client Index = 2	Epoch: 3	Loss: 0.081194
Client Index = 2	Epoch: 4	Loss: 0.054134
test acc on this client after 456 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 3
local mask changes: 53060.0 / 11173962
choose client_indexes: [ 1  3  6 15 16], accoring to random
choose mask diff: [762972.0, 53060.0, 806322.0, 784084.0, 766966.0]
Doing local aggregation!
test acc on this client before 409 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.422351
Client Index = 3	Epoch: 1	Loss: 0.229458
Client Index = 3	Epoch: 2	Loss: 0.264313
Client Index = 3	Epoch: 3	Loss: 0.267000
Client Index = 3	Epoch: 4	Loss: 0.188294
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 4
local mask changes: 53048.0 / 11173962
choose client_indexes: [ 4  8 13 14 18], accoring to random
choose mask diff: [53048.0, 774132.0, 762576.0, 782098.0, 744412.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.262724
Client Index = 4	Epoch: 1	Loss: 0.138785
Client Index = 4	Epoch: 2	Loss: 0.176780
Client Index = 4	Epoch: 3	Loss: 0.095773
Client Index = 4	Epoch: 4	Loss: 0.098681
test acc on this client after 391 / 503 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 5
local mask changes: 53130.0 / 11173962
choose client_indexes: [ 0  1  5 12 17], accoring to random
choose mask diff: [788884.0, 743912.0, 53130.0, 772726.0, 732272.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 5	Epoch: 0	Loss: 0.287780
Client Index = 5	Epoch: 1	Loss: 0.150216
Client Index = 5	Epoch: 2	Loss: 0.175417
Client Index = 5	Epoch: 3	Loss: 0.134897
Client Index = 5	Epoch: 4	Loss: 0.113191
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 6
local mask changes: 53074.0 / 11173962
choose client_indexes: [ 0  6  8  9 15], accoring to random
choose mask diff: [806138.0, 53074.0, 787872.0, 796598.0, 805916.0]
Doing local aggregation!
test acc on this client before 420 / 505 : 0.83
Client Index = 6	Epoch: 0	Loss: 0.344337
Client Index = 6	Epoch: 1	Loss: 0.341872
Client Index = 6	Epoch: 2	Loss: 0.328193
Client Index = 6	Epoch: 3	Loss: 0.236198
Client Index = 6	Epoch: 4	Loss: 0.194868
test acc on this client after 371 / 505 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 7
local mask changes: 53104.0 / 11173962
choose client_indexes: [ 6  7  9 11 17], accoring to random
choose mask diff: [787860.0, 53104.0, 756236.0, 761384.0, 748894.0]
Doing local aggregation!
test acc on this client before 451 / 504 : 0.89
Client Index = 7	Epoch: 0	Loss: 0.206805
Client Index = 7	Epoch: 1	Loss: 0.209951
Client Index = 7	Epoch: 2	Loss: 0.125663
Client Index = 7	Epoch: 3	Loss: 0.095207
Client Index = 7	Epoch: 4	Loss: 0.248922
test acc on this client after 443 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 8
local mask changes: 53096.0 / 11173962
choose client_indexes: [ 2  7  8 18 19], accoring to random
choose mask diff: [760212.0, 765642.0, 53096.0, 758502.0, 782656.0]
Doing local aggregation!
test acc on this client before 444 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.367910
Client Index = 8	Epoch: 1	Loss: 0.283712
Client Index = 8	Epoch: 2	Loss: 0.161691
Client Index = 8	Epoch: 3	Loss: 0.169298
Client Index = 8	Epoch: 4	Loss: 0.206297
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 9
local mask changes: 53134.0 / 11173962
choose client_indexes: [ 0  6  9 10 13], accoring to random
choose mask diff: [798212.0, 795370.0, 53134.0, 763500.0, 764802.0]
Doing local aggregation!
test acc on this client before 426 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.216566
Client Index = 9	Epoch: 1	Loss: 0.254699
Client Index = 9	Epoch: 2	Loss: 0.181302
Client Index = 9	Epoch: 3	Loss: 0.114287
Client Index = 9	Epoch: 4	Loss: 0.105398
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 10
local mask changes: 53058.0 / 11173962
choose client_indexes: [ 3  6  9 10 14], accoring to random
choose mask diff: [787340.0, 801474.0, 764618.0, 53058.0, 785766.0]
Doing local aggregation!
test acc on this client before 425 / 503 : 0.84
Client Index = 10	Epoch: 0	Loss: 0.260704
Client Index = 10	Epoch: 1	Loss: 0.176128
Client Index = 10	Epoch: 2	Loss: 0.158574
Client Index = 10	Epoch: 3	Loss: 0.086803
Client Index = 10	Epoch: 4	Loss: 0.098270
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 11
local mask changes: 53096.0 / 11173962
choose client_indexes: [ 0  9 11 18 19], accoring to random
choose mask diff: [784892.0, 739470.0, 53096.0, 740912.0, 748148.0]
Doing local aggregation!
test acc on this client before 457 / 504 : 0.91
Client Index = 11	Epoch: 0	Loss: 0.214137
Client Index = 11	Epoch: 1	Loss: 0.180784
Client Index = 11	Epoch: 2	Loss: 0.111786
Client Index = 11	Epoch: 3	Loss: 0.071095
Client Index = 11	Epoch: 4	Loss: 0.065712
test acc on this client after 424 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 12
local mask changes: 53096.0 / 11173962
choose client_indexes: [ 4  7 12 17 18], accoring to random
choose mask diff: [770126.0, 764750.0, 53096.0, 752646.0, 762836.0]
Doing local aggregation!
test acc on this client before 421 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.239255
Client Index = 12	Epoch: 1	Loss: 0.178167
Client Index = 12	Epoch: 2	Loss: 0.163034
Client Index = 12	Epoch: 3	Loss: 0.102300
Client Index = 12	Epoch: 4	Loss: 0.139610
test acc on this client after 417 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 13
local mask changes: 53040.0 / 11173962
choose client_indexes: [ 6 12 13 14 17], accoring to random
choose mask diff: [792668.0, 778580.0, 53040.0, 791412.0, 748454.0]
Doing local aggregation!
test acc on this client before 430 / 503 : 0.85
Client Index = 13	Epoch: 0	Loss: 0.297376
Client Index = 13	Epoch: 1	Loss: 0.206507
Client Index = 13	Epoch: 2	Loss: 0.166721
Client Index = 13	Epoch: 3	Loss: 0.120721
Client Index = 13	Epoch: 4	Loss: 0.173172
test acc on this client after 410 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 14
local mask changes: 53094.0 / 11173962
choose client_indexes: [ 2  4  8 12 14], accoring to random
choose mask diff: [773812.0, 783454.0, 790718.0, 800378.0, 53094.0]
Doing local aggregation!
test acc on this client before 431 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.340844
Client Index = 14	Epoch: 1	Loss: 0.224483
Client Index = 14	Epoch: 2	Loss: 0.250304
Client Index = 14	Epoch: 3	Loss: 0.219250
Client Index = 14	Epoch: 4	Loss: 0.215658
test acc on this client after 382 / 502 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 15
local mask changes: 53108.0 / 11173962
choose client_indexes: [ 1  9 10 15 16], accoring to random
choose mask diff: [751290.0, 750558.0, 769128.0, 53108.0, 760766.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.216721
Client Index = 15	Epoch: 1	Loss: 0.187008
Client Index = 15	Epoch: 2	Loss: 0.150418
Client Index = 15	Epoch: 3	Loss: 0.113029
Client Index = 15	Epoch: 4	Loss: 0.076546
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 16
local mask changes: 53092.0 / 11173962
choose client_indexes: [ 0  5 11 16 17], accoring to random
choose mask diff: [804978.0, 760774.0, 748326.0, 53092.0, 748504.0]
Doing local aggregation!
test acc on this client before 442 / 503 : 0.88
Client Index = 16	Epoch: 0	Loss: 0.196582
Client Index = 16	Epoch: 1	Loss: 0.139354
Client Index = 16	Epoch: 2	Loss: 0.148633
Client Index = 16	Epoch: 3	Loss: 0.110704
Client Index = 16	Epoch: 4	Loss: 0.191833
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 17
local mask changes: 53096.0 / 11173962
choose client_indexes: [ 1 12 17 18 19], accoring to random
choose mask diff: [723370.0, 751628.0, 53096.0, 727936.0, 743886.0]
Doing local aggregation!
test acc on this client before 440 / 505 : 0.87
Client Index = 17	Epoch: 0	Loss: 0.278303
Client Index = 17	Epoch: 1	Loss: 0.240420
Client Index = 17	Epoch: 2	Loss: 0.097940
Client Index = 17	Epoch: 3	Loss: 0.079568
Client Index = 17	Epoch: 4	Loss: 0.117460
test acc on this client after 439 / 505 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 18
local mask changes: 53088.0 / 11173962
choose client_indexes: [ 9 11 14 18 19], accoring to random
choose mask diff: [740340.0, 741064.0, 766226.0, 53088.0, 740176.0]
Doing local aggregation!
test acc on this client before 453 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.244453
Client Index = 18	Epoch: 1	Loss: 0.151747
Client Index = 18	Epoch: 2	Loss: 0.169191
Client Index = 18	Epoch: 3	Loss: 0.165846
Client Index = 18	Epoch: 4	Loss: 0.121358
test acc on this client after 456 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(94) with spasity 0.5: 19
local mask changes: 53060.0 / 11173962
choose client_indexes: [ 0  6 11 18 19], accoring to random
choose mask diff: [802282.0, 795124.0, 749434.0, 740496.0, 53060.0]
Doing local aggregation!
test acc on this client before 419 / 506 : 0.83
Client Index = 19	Epoch: 0	Loss: 0.209108
Client Index = 19	Epoch: 1	Loss: 0.139459
Client Index = 19	Epoch: 2	Loss: 0.422945
Client Index = 19	Epoch: 3	Loss: 0.125350
Client Index = 19	Epoch: 4	Loss: 0.147922
test acc on this client after 424 / 506 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 94
{'test_acc': 0.8393140313346498, 'test_loss': 0.5613403521810999}
################local_test_on_all_clients before local training in communication round: 94
{'test_acc': 0.8599632104878557, 'test_loss': 0.4556857783044581}
################Communication round : 95
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 0
local mask changes: 39098.0 / 11173962
choose client_indexes: [ 0  5 14 18 19], accoring to random
choose mask diff: [39098.0, 789924.0, 808968.0, 789402.0, 803184.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.305282
Client Index = 0	Epoch: 1	Loss: 0.489365
Client Index = 0	Epoch: 2	Loss: 0.251596
Client Index = 0	Epoch: 3	Loss: 0.270495
Client Index = 0	Epoch: 4	Loss: 0.203607
test acc on this client after 367 / 504 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 1
local mask changes: 39112.0 / 11173962
choose client_indexes: [ 1 10 12 16 17], accoring to random
choose mask diff: [39112.0, 753206.0, 756458.0, 745424.0, 721508.0]
Doing local aggregation!
test acc on this client before 463 / 503 : 0.92
Client Index = 1	Epoch: 0	Loss: 0.140526
Client Index = 1	Epoch: 1	Loss: 0.172208
Client Index = 1	Epoch: 2	Loss: 0.104587
Client Index = 1	Epoch: 3	Loss: 0.075443
Client Index = 1	Epoch: 4	Loss: 0.100513
test acc on this client after 452 / 503 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 2
local mask changes: 39120.0 / 11173962
choose client_indexes: [ 2  3  5 14 16], accoring to random
choose mask diff: [39120.0, 763182.0, 755848.0, 770402.0, 752966.0]
Doing local aggregation!
test acc on this client before 442 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.179780
Client Index = 2	Epoch: 1	Loss: 0.116642
Client Index = 2	Epoch: 2	Loss: 0.105799
Client Index = 2	Epoch: 3	Loss: 0.113038
Client Index = 2	Epoch: 4	Loss: 0.071272
test acc on this client after 462 / 502 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 3
local mask changes: 39154.0 / 11173962
choose client_indexes: [ 0  3  5 14 19], accoring to random
choose mask diff: [802900.0, 39154.0, 782490.0, 790736.0, 778136.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.349836
Client Index = 3	Epoch: 1	Loss: 0.236473
Client Index = 3	Epoch: 2	Loss: 0.250522
Client Index = 3	Epoch: 3	Loss: 0.223552
Client Index = 3	Epoch: 4	Loss: 0.248694
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 4
local mask changes: 39126.0 / 11173962
choose client_indexes: [ 4 13 14 15 18], accoring to random
choose mask diff: [39126.0, 760746.0, 780608.0, 768150.0, 742152.0]
Doing local aggregation!
test acc on this client before 421 / 503 : 0.84
Client Index = 4	Epoch: 0	Loss: 0.329844
Client Index = 4	Epoch: 1	Loss: 0.144108
Client Index = 4	Epoch: 2	Loss: 0.107224
Client Index = 4	Epoch: 3	Loss: 0.104318
Client Index = 4	Epoch: 4	Loss: 0.123822
test acc on this client after 447 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 5
local mask changes: 39104.0 / 11173962
choose client_indexes: [ 4  5  9 14 17], accoring to random
choose mask diff: [759018.0, 39104.0, 753252.0, 776150.0, 728394.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 5	Epoch: 0	Loss: 0.285284
Client Index = 5	Epoch: 1	Loss: 0.216617
Client Index = 5	Epoch: 2	Loss: 0.157940
Client Index = 5	Epoch: 3	Loss: 0.094771
Client Index = 5	Epoch: 4	Loss: 0.206198
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 6
local mask changes: 39112.0 / 11173962
choose client_indexes: [ 6  8 10 14 19], accoring to random
choose mask diff: [39112.0, 787280.0, 800944.0, 795568.0, 793916.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 6	Epoch: 0	Loss: 0.362850
Client Index = 6	Epoch: 1	Loss: 0.318490
Client Index = 6	Epoch: 2	Loss: 0.221179
Client Index = 6	Epoch: 3	Loss: 0.273250
Client Index = 6	Epoch: 4	Loss: 0.202829
test acc on this client after 415 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 7
local mask changes: 39148.0 / 11173962
choose client_indexes: [ 2  4  5  7 16], accoring to random
choose mask diff: [749456.0, 765692.0, 747812.0, 39148.0, 762386.0]
Doing local aggregation!
test acc on this client before 460 / 504 : 0.91
Client Index = 7	Epoch: 0	Loss: 0.359366
Client Index = 7	Epoch: 1	Loss: 0.164022
Client Index = 7	Epoch: 2	Loss: 0.129506
Client Index = 7	Epoch: 3	Loss: 0.143942
Client Index = 7	Epoch: 4	Loss: 0.333807
test acc on this client after 320 / 504 : 0.63
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 8
local mask changes: 39136.0 / 11173962
choose client_indexes: [ 1  5  8 13 19], accoring to random
choose mask diff: [764948.0, 755364.0, 39136.0, 771278.0, 779222.0]
Doing local aggregation!
test acc on this client before 454 / 504 : 0.90
Client Index = 8	Epoch: 0	Loss: 0.308712
Client Index = 8	Epoch: 1	Loss: 0.327019
Client Index = 8	Epoch: 2	Loss: 0.179341
Client Index = 8	Epoch: 3	Loss: 0.247258
Client Index = 8	Epoch: 4	Loss: 0.160879
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 9
local mask changes: 39110.0 / 11173962
choose client_indexes: [ 9 10 16 17 19], accoring to random
choose mask diff: [39110.0, 761528.0, 744314.0, 729784.0, 755206.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 9	Epoch: 0	Loss: 0.214864
Client Index = 9	Epoch: 1	Loss: 0.207679
Client Index = 9	Epoch: 2	Loss: 0.120213
Client Index = 9	Epoch: 3	Loss: 0.233957
Client Index = 9	Epoch: 4	Loss: 0.103663
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 10
local mask changes: 39128.0 / 11173962
choose client_indexes: [ 0  1 10 14 19], accoring to random
choose mask diff: [802704.0, 753784.0, 39128.0, 783566.0, 779598.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 10	Epoch: 0	Loss: 0.254643
Client Index = 10	Epoch: 1	Loss: 0.151759
Client Index = 10	Epoch: 2	Loss: 0.156145
Client Index = 10	Epoch: 3	Loss: 0.405093
Client Index = 10	Epoch: 4	Loss: 0.095511
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 11
local mask changes: 39134.0 / 11173962
choose client_indexes: [ 3  5 10 11 19], accoring to random
choose mask diff: [768694.0, 755844.0, 760922.0, 39134.0, 745460.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 11	Epoch: 0	Loss: 0.168780
Client Index = 11	Epoch: 1	Loss: 0.109736
Client Index = 11	Epoch: 2	Loss: 0.078329
Client Index = 11	Epoch: 3	Loss: 0.351037
Client Index = 11	Epoch: 4	Loss: 0.071199
test acc on this client after 450 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 12
local mask changes: 39134.0 / 11173962
choose client_indexes: [ 0 12 13 18 19], accoring to random
choose mask diff: [800016.0, 39134.0, 777420.0, 759566.0, 763984.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 12	Epoch: 0	Loss: 0.254101
Client Index = 12	Epoch: 1	Loss: 0.168007
Client Index = 12	Epoch: 2	Loss: 0.135898
Client Index = 12	Epoch: 3	Loss: 0.178962
Client Index = 12	Epoch: 4	Loss: 0.123890
test acc on this client after 434 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 13
local mask changes: 39096.0 / 11173962
choose client_indexes: [ 8  9 11 13 16], accoring to random
choose mask diff: [771922.0, 763456.0, 753114.0, 39096.0, 765784.0]
Doing local aggregation!
test acc on this client before 424 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.230403
Client Index = 13	Epoch: 1	Loss: 0.192681
Client Index = 13	Epoch: 2	Loss: 0.148701
Client Index = 13	Epoch: 3	Loss: 0.237653
Client Index = 13	Epoch: 4	Loss: 0.103534
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 14
local mask changes: 39102.0 / 11173962
choose client_indexes: [ 2  3 14 15 17], accoring to random
choose mask diff: [771986.0, 790932.0, 39102.0, 776710.0, 762702.0]
Doing local aggregation!
test acc on this client before 430 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.277760
Client Index = 14	Epoch: 1	Loss: 0.276418
Client Index = 14	Epoch: 2	Loss: 0.183424
Client Index = 14	Epoch: 3	Loss: 0.189451
Client Index = 14	Epoch: 4	Loss: 0.159784
test acc on this client after 425 / 502 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 15
local mask changes: 39132.0 / 11173962
choose client_indexes: [ 2  6 11 12 15], accoring to random
choose mask diff: [755490.0, 804136.0, 758786.0, 769576.0, 39132.0]
Doing local aggregation!
test acc on this client before 428 / 504 : 0.85
Client Index = 15	Epoch: 0	Loss: 0.209219
Client Index = 15	Epoch: 1	Loss: 0.153237
Client Index = 15	Epoch: 2	Loss: 0.197852
Client Index = 15	Epoch: 3	Loss: 0.126293
Client Index = 15	Epoch: 4	Loss: 0.097439
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 16
local mask changes: 39106.0 / 11173962
choose client_indexes: [ 3  5 11 15 16], accoring to random
choose mask diff: [765344.0, 758430.0, 746208.0, 759896.0, 39106.0]
Doing local aggregation!
test acc on this client before 447 / 503 : 0.89
Client Index = 16	Epoch: 0	Loss: 0.224043
Client Index = 16	Epoch: 1	Loss: 0.126409
Client Index = 16	Epoch: 2	Loss: 0.284551
Client Index = 16	Epoch: 3	Loss: 0.095737
Client Index = 16	Epoch: 4	Loss: 0.069248
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 17
local mask changes: 39134.0 / 11173962
choose client_indexes: [ 1  3 11 17 19], accoring to random
choose mask diff: [720092.0, 758686.0, 717438.0, 39134.0, 741194.0]
Doing local aggregation!
test acc on this client before 445 / 505 : 0.88
Client Index = 17	Epoch: 0	Loss: 0.378976
Client Index = 17	Epoch: 1	Loss: 0.150994
Client Index = 17	Epoch: 2	Loss: 0.103597
Client Index = 17	Epoch: 3	Loss: 0.143613
Client Index = 17	Epoch: 4	Loss: 0.263646
test acc on this client after 442 / 505 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 18
local mask changes: 39116.0 / 11173962
choose client_indexes: [ 4  7 11 16 18], accoring to random
choose mask diff: [742366.0, 749998.0, 738054.0, 738380.0, 39116.0]
Doing local aggregation!
test acc on this client before 455 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.217876
Client Index = 18	Epoch: 1	Loss: 0.229196
Client Index = 18	Epoch: 2	Loss: 0.131520
Client Index = 18	Epoch: 3	Loss: 0.110420
Client Index = 18	Epoch: 4	Loss: 0.100457
test acc on this client after 452 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(95) with spasity 0.5: 19
local mask changes: 39094.0 / 11173962
choose client_indexes: [ 1  8 12 13 19], accoring to random
choose mask diff: [755246.0, 780236.0, 763882.0, 765624.0, 39094.0]
Doing local aggregation!
test acc on this client before 424 / 506 : 0.84
Client Index = 19	Epoch: 0	Loss: 0.217807
Client Index = 19	Epoch: 1	Loss: 0.173360
Client Index = 19	Epoch: 2	Loss: 0.133591
Client Index = 19	Epoch: 3	Loss: 0.121565
Client Index = 19	Epoch: 4	Loss: 0.208305
test acc on this client after 428 / 506 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 95
{'test_acc': 0.8427084325441718, 'test_loss': 0.5353959997871309}
################local_test_on_all_clients before local training in communication round: 95
{'test_acc': 0.8686949595037987, 'test_loss': 0.4310803897612482}
################Communication round : 96
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 0
local mask changes: 27232.0 / 11173962
choose client_indexes: [ 0  1  2  8 19], accoring to random
choose mask diff: [27232.0, 786274.0, 794080.0, 808510.0, 802274.0]
Doing local aggregation!
test acc on this client before 417 / 504 : 0.83
Client Index = 0	Epoch: 0	Loss: 0.339271
Client Index = 0	Epoch: 1	Loss: 0.246126
Client Index = 0	Epoch: 2	Loss: 0.282684
Client Index = 0	Epoch: 3	Loss: 0.223953
Client Index = 0	Epoch: 4	Loss: 0.419023
test acc on this client after 306 / 504 : 0.61
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 1
local mask changes: 27224.0 / 11173962
choose client_indexes: [ 1  7 12 13 19], accoring to random
choose mask diff: [27224.0, 748608.0, 755270.0, 761802.0, 754166.0]
Doing local aggregation!
test acc on this client before 456 / 503 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.151671
Client Index = 1	Epoch: 1	Loss: 0.167547
Client Index = 1	Epoch: 2	Loss: 0.090539
Client Index = 1	Epoch: 3	Loss: 0.099124
Client Index = 1	Epoch: 4	Loss: 0.047870
test acc on this client after 466 / 503 : 0.93
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 2
local mask changes: 27236.0 / 11173962
choose client_indexes: [ 0  2  6  8 18], accoring to random
choose mask diff: [791996.0, 27236.0, 782716.0, 755020.0, 732880.0]
Doing local aggregation!
test acc on this client before 443 / 502 : 0.88
Client Index = 2	Epoch: 0	Loss: 0.316545
Client Index = 2	Epoch: 1	Loss: 0.119024
Client Index = 2	Epoch: 2	Loss: 0.082402
Client Index = 2	Epoch: 3	Loss: 0.075887
Client Index = 2	Epoch: 4	Loss: 0.084273
test acc on this client after 464 / 502 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 3
local mask changes: 27244.0 / 11173962
choose client_indexes: [ 0  3 10 15 18], accoring to random
choose mask diff: [802096.0, 27244.0, 785292.0, 781876.0, 759632.0]
Doing local aggregation!
test acc on this client before 412 / 504 : 0.82
Client Index = 3	Epoch: 0	Loss: 0.312241
Client Index = 3	Epoch: 1	Loss: 0.401755
Client Index = 3	Epoch: 2	Loss: 0.227041
Client Index = 3	Epoch: 3	Loss: 0.232224
Client Index = 3	Epoch: 4	Loss: 0.161280
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 4
local mask changes: 27230.0 / 11173962
choose client_indexes: [ 4  7 10 13 19], accoring to random
choose mask diff: [27230.0, 764720.0, 763788.0, 759932.0, 746454.0]
Doing local aggregation!
test acc on this client before 432 / 503 : 0.86
Client Index = 4	Epoch: 0	Loss: 0.184831
Client Index = 4	Epoch: 1	Loss: 0.338378
Client Index = 4	Epoch: 2	Loss: 0.128334
Client Index = 4	Epoch: 3	Loss: 0.132475
Client Index = 4	Epoch: 4	Loss: 0.108608
test acc on this client after 441 / 503 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 5
local mask changes: 27242.0 / 11173962
choose client_indexes: [ 0  3  5  8 17], accoring to random
choose mask diff: [787980.0, 781670.0, 27242.0, 754858.0, 727162.0]
Doing local aggregation!
test acc on this client before 451 / 504 : 0.89
Client Index = 5	Epoch: 0	Loss: 0.180102
Client Index = 5	Epoch: 1	Loss: 0.285503
Client Index = 5	Epoch: 2	Loss: 0.154242
Client Index = 5	Epoch: 3	Loss: 0.129752
Client Index = 5	Epoch: 4	Loss: 0.111096
test acc on this client after 446 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 6
local mask changes: 27246.0 / 11173962
choose client_indexes: [ 0  6  8 12 18], accoring to random
choose mask diff: [806082.0, 27246.0, 786654.0, 804604.0, 783760.0]
Doing local aggregation!
test acc on this client before 418 / 505 : 0.83
Client Index = 6	Epoch: 0	Loss: 0.439075
Client Index = 6	Epoch: 1	Loss: 0.273444
Client Index = 6	Epoch: 2	Loss: 0.270882
Client Index = 6	Epoch: 3	Loss: 0.284069
Client Index = 6	Epoch: 4	Loss: 0.243524
test acc on this client after 390 / 505 : 0.77
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 7
local mask changes: 27232.0 / 11173962
choose client_indexes: [ 0  2  4  7 16], accoring to random
choose mask diff: [803308.0, 749026.0, 765476.0, 27232.0, 762700.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 7	Epoch: 0	Loss: 0.208501
Client Index = 7	Epoch: 1	Loss: 0.195771
Client Index = 7	Epoch: 2	Loss: 0.169701
Client Index = 7	Epoch: 3	Loss: 0.108959
Client Index = 7	Epoch: 4	Loss: 0.198929
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 8
local mask changes: 27240.0 / 11173962
choose client_indexes: [1 3 4 7 8], accoring to random
choose mask diff: [763270.0, 783814.0, 772866.0, 763054.0, 27240.0]
Doing local aggregation!
test acc on this client before 450 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.285890
Client Index = 8	Epoch: 1	Loss: 0.276876
Client Index = 8	Epoch: 2	Loss: 0.162656
Client Index = 8	Epoch: 3	Loss: 0.222363
Client Index = 8	Epoch: 4	Loss: 0.178211
test acc on this client after 426 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 9
local mask changes: 27226.0 / 11173962
choose client_indexes: [ 1  2  9 10 11], accoring to random
choose mask diff: [735844.0, 748338.0, 27226.0, 759748.0, 736228.0]
Doing local aggregation!
test acc on this client before 425 / 504 : 0.84
Client Index = 9	Epoch: 0	Loss: 0.190395
Client Index = 9	Epoch: 1	Loss: 0.167252
Client Index = 9	Epoch: 2	Loss: 0.206228
Client Index = 9	Epoch: 3	Loss: 0.097072
Client Index = 9	Epoch: 4	Loss: 0.098037
test acc on this client after 425 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 10
local mask changes: 27234.0 / 11173962
choose client_indexes: [ 2  5 10 12 13], accoring to random
choose mask diff: [763482.0, 768842.0, 27234.0, 784350.0, 777002.0]
Doing local aggregation!
test acc on this client before 446 / 503 : 0.89
Client Index = 10	Epoch: 0	Loss: 0.254280
Client Index = 10	Epoch: 1	Loss: 0.218895
Client Index = 10	Epoch: 2	Loss: 0.149690
Client Index = 10	Epoch: 3	Loss: 0.117655
Client Index = 10	Epoch: 4	Loss: 0.228967
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 11
local mask changes: 27240.0 / 11173962
choose client_indexes: [ 0  7  8 11 18], accoring to random
choose mask diff: [782342.0, 756980.0, 759740.0, 27240.0, 736206.0]
Doing local aggregation!
test acc on this client before 463 / 504 : 0.92
Client Index = 11	Epoch: 0	Loss: 0.242909
Client Index = 11	Epoch: 1	Loss: 0.105451
Client Index = 11	Epoch: 2	Loss: 0.076532
Client Index = 11	Epoch: 3	Loss: 0.095515
Client Index = 11	Epoch: 4	Loss: 0.073974
test acc on this client after 441 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 12
local mask changes: 27222.0 / 11173962
choose client_indexes: [ 3  4  5 11 12], accoring to random
choose mask diff: [777646.0, 767442.0, 770690.0, 763988.0, 27222.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 12	Epoch: 0	Loss: 0.189607
Client Index = 12	Epoch: 1	Loss: 0.239118
Client Index = 12	Epoch: 2	Loss: 0.163000
Client Index = 12	Epoch: 3	Loss: 0.124655
Client Index = 12	Epoch: 4	Loss: 0.133729
test acc on this client after 421 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 13
local mask changes: 27248.0 / 11173962
choose client_indexes: [ 3  4  7 11 13], accoring to random
choose mask diff: [779950.0, 761040.0, 773580.0, 751976.0, 27248.0]
Doing local aggregation!
test acc on this client before 427 / 503 : 0.85
Client Index = 13	Epoch: 0	Loss: 0.256135
Client Index = 13	Epoch: 1	Loss: 0.167467
Client Index = 13	Epoch: 2	Loss: 0.168702
Client Index = 13	Epoch: 3	Loss: 0.131543
Client Index = 13	Epoch: 4	Loss: 0.102467
test acc on this client after 408 / 503 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 14
local mask changes: 27248.0 / 11173962
choose client_indexes: [ 3  6 14 15 19], accoring to random
choose mask diff: [790108.0, 795704.0, 27248.0, 775690.0, 784506.0]
Doing local aggregation!
test acc on this client before 431 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.320103
Client Index = 14	Epoch: 1	Loss: 0.233243
Client Index = 14	Epoch: 2	Loss: 0.183501
Client Index = 14	Epoch: 3	Loss: 0.306046
Client Index = 14	Epoch: 4	Loss: 0.138183
test acc on this client after 415 / 502 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 15
local mask changes: 27248.0 / 11173962
choose client_indexes: [ 1  3  8 13 15], accoring to random
choose mask diff: [747896.0, 781736.0, 773374.0, 770022.0, 27248.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 15	Epoch: 0	Loss: 0.204390
Client Index = 15	Epoch: 1	Loss: 0.159767
Client Index = 15	Epoch: 2	Loss: 0.186982
Client Index = 15	Epoch: 3	Loss: 0.109910
Client Index = 15	Epoch: 4	Loss: 0.088762
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 16
local mask changes: 27232.0 / 11173962
choose client_indexes: [ 1  9 16 18 19], accoring to random
choose mask diff: [745184.0, 744052.0, 27232.0, 738312.0, 766678.0]
Doing local aggregation!
test acc on this client before 442 / 503 : 0.88
Client Index = 16	Epoch: 0	Loss: 0.195858
Client Index = 16	Epoch: 1	Loss: 0.134523
Client Index = 16	Epoch: 2	Loss: 0.099360
Client Index = 16	Epoch: 3	Loss: 0.105806
Client Index = 16	Epoch: 4	Loss: 0.160651
test acc on this client after 447 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 17
local mask changes: 27238.0 / 11173962
choose client_indexes: [ 4  9 15 17 18], accoring to random
choose mask diff: [731304.0, 728510.0, 754972.0, 27238.0, 723806.0]
Doing local aggregation!
test acc on this client before 421 / 505 : 0.83
Client Index = 17	Epoch: 0	Loss: 0.282491
Client Index = 17	Epoch: 1	Loss: 0.120516
Client Index = 17	Epoch: 2	Loss: 0.308377
Client Index = 17	Epoch: 3	Loss: 0.123842
Client Index = 17	Epoch: 4	Loss: 0.076660
test acc on this client after 452 / 505 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 18
local mask changes: 27262.0 / 11173962
choose client_indexes: [ 5 10 16 17 18], accoring to random
choose mask diff: [740578.0, 769746.0, 737298.0, 723694.0, 27262.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.218012
Client Index = 18	Epoch: 1	Loss: 0.200529
Client Index = 18	Epoch: 2	Loss: 0.184536
Client Index = 18	Epoch: 3	Loss: 0.133858
Client Index = 18	Epoch: 4	Loss: 0.110321
test acc on this client after 427 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(96) with spasity 0.5: 19
local mask changes: 27248.0 / 11173962
choose client_indexes: [ 2  7 11 12 19], accoring to random
choose mask diff: [754736.0, 772690.0, 744724.0, 763046.0, 27248.0]
Doing local aggregation!
test acc on this client before 413 / 506 : 0.82
Client Index = 19	Epoch: 0	Loss: 0.159873
Client Index = 19	Epoch: 1	Loss: 0.183720
Client Index = 19	Epoch: 2	Loss: 0.136272
Client Index = 19	Epoch: 3	Loss: 0.178736
Client Index = 19	Epoch: 4	Loss: 0.072916
test acc on this client after 433 / 506 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 96
{'test_acc': 0.8469725241867936, 'test_loss': 0.5186285309157588}
################local_test_on_all_clients before local training in communication round: 96
{'test_acc': 0.8626555551763214, 'test_loss': 0.4433863291266726}
################Communication round : 97
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 0
local mask changes: 17454.0 / 11173962
choose client_indexes: [0 1 5 7 9], accoring to random
choose mask diff: [17454.0, 787180.0, 790128.0, 805792.0, 798958.0]
Doing local aggregation!
test acc on this client before 399 / 504 : 0.79
Client Index = 0	Epoch: 0	Loss: 0.355250
Client Index = 0	Epoch: 1	Loss: 0.263653
Client Index = 0	Epoch: 2	Loss: 0.251942
Client Index = 0	Epoch: 3	Loss: 0.356200
Client Index = 0	Epoch: 4	Loss: 0.170221
test acc on this client after 395 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 1
local mask changes: 17478.0 / 11173962
choose client_indexes: [ 1  5 10 12 18], accoring to random
choose mask diff: [17478.0, 740156.0, 751798.0, 755052.0, 737100.0]
Doing local aggregation!
test acc on this client before 455 / 503 : 0.90
Client Index = 1	Epoch: 0	Loss: 0.144971
Client Index = 1	Epoch: 1	Loss: 0.111970
Client Index = 1	Epoch: 2	Loss: 0.330772
Client Index = 1	Epoch: 3	Loss: 0.093338
Client Index = 1	Epoch: 4	Loss: 0.050642
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 2
local mask changes: 17464.0 / 11173962
choose client_indexes: [ 2  4  9 12 18], accoring to random
choose mask diff: [17464.0, 740170.0, 748134.0, 760024.0, 732226.0]
Doing local aggregation!
test acc on this client before 452 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.213102
Client Index = 2	Epoch: 1	Loss: 0.121391
Client Index = 2	Epoch: 2	Loss: 0.078502
Client Index = 2	Epoch: 3	Loss: 0.061319
Client Index = 2	Epoch: 4	Loss: 0.082956
test acc on this client after 456 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 3
local mask changes: 17460.0 / 11173962
choose client_indexes: [ 2  3  9 16 17], accoring to random
choose mask diff: [762880.0, 17460.0, 770552.0, 764354.0, 758640.0]
Doing local aggregation!
test acc on this client before 407 / 504 : 0.81
Client Index = 3	Epoch: 0	Loss: 0.286745
Client Index = 3	Epoch: 1	Loss: 0.309183
Client Index = 3	Epoch: 2	Loss: 0.358655
Client Index = 3	Epoch: 3	Loss: 0.163662
Client Index = 3	Epoch: 4	Loss: 0.244155
test acc on this client after 419 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 4
local mask changes: 17460.0 / 11173962
choose client_indexes: [ 4  6  9 11 18], accoring to random
choose mask diff: [17460.0, 781470.0, 756098.0, 739734.0, 740022.0]
Doing local aggregation!
test acc on this client before 438 / 503 : 0.87
Client Index = 4	Epoch: 0	Loss: 0.309790
Client Index = 4	Epoch: 1	Loss: 0.192652
Client Index = 4	Epoch: 2	Loss: 0.117291
Client Index = 4	Epoch: 3	Loss: 0.089645
Client Index = 4	Epoch: 4	Loss: 0.284228
test acc on this client after 446 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 5
local mask changes: 17458.0 / 11173962
choose client_indexes: [ 5  8  9 11 16], accoring to random
choose mask diff: [17458.0, 754320.0, 752378.0, 754890.0, 757242.0]
Doing local aggregation!
test acc on this client before 431 / 504 : 0.86
Client Index = 5	Epoch: 0	Loss: 0.325092
Client Index = 5	Epoch: 1	Loss: 0.174996
Client Index = 5	Epoch: 2	Loss: 0.115731
Client Index = 5	Epoch: 3	Loss: 0.089842
Client Index = 5	Epoch: 4	Loss: 0.127847
test acc on this client after 442 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 6
local mask changes: 17466.0 / 11173962
choose client_indexes: [ 2  3  6  9 11], accoring to random
choose mask diff: [783970.0, 805346.0, 17466.0, 793560.0, 779098.0]
Doing local aggregation!
test acc on this client before 424 / 505 : 0.84
Client Index = 6	Epoch: 0	Loss: 0.393340
Client Index = 6	Epoch: 1	Loss: 0.273644
Client Index = 6	Epoch: 2	Loss: 0.316217
Client Index = 6	Epoch: 3	Loss: 0.273379
Client Index = 6	Epoch: 4	Loss: 0.220454
test acc on this client after 399 / 505 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 7
local mask changes: 17480.0 / 11173962
choose client_indexes: [ 0  7 14 16 18], accoring to random
choose mask diff: [804032.0, 17480.0, 772576.0, 762130.0, 749988.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 7	Epoch: 0	Loss: 0.205996
Client Index = 7	Epoch: 1	Loss: 0.261611
Client Index = 7	Epoch: 2	Loss: 0.121771
Client Index = 7	Epoch: 3	Loss: 0.088527
Client Index = 7	Epoch: 4	Loss: 0.096873
test acc on this client after 416 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 8
local mask changes: 17456.0 / 11173962
choose client_indexes: [ 1  2  8 16 18], accoring to random
choose mask diff: [762892.0, 755844.0, 17456.0, 770502.0, 755384.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 8	Epoch: 0	Loss: 0.412354
Client Index = 8	Epoch: 1	Loss: 0.213891
Client Index = 8	Epoch: 2	Loss: 0.261076
Client Index = 8	Epoch: 3	Loss: 0.204837
Client Index = 8	Epoch: 4	Loss: 0.137386
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 9
local mask changes: 17456.0 / 11173962
choose client_indexes: [ 0  2  9 12 14], accoring to random
choose mask diff: [797178.0, 747904.0, 17456.0, 762500.0, 773034.0]
Doing local aggregation!
test acc on this client before 442 / 504 : 0.88
Client Index = 9	Epoch: 0	Loss: 0.257896
Client Index = 9	Epoch: 1	Loss: 0.200715
Client Index = 9	Epoch: 2	Loss: 0.119308
Client Index = 9	Epoch: 3	Loss: 0.128402
Client Index = 9	Epoch: 4	Loss: 0.132734
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 10
local mask changes: 17454.0 / 11173962
choose client_indexes: [ 1  8 10 12 14], accoring to random
choose mask diff: [752438.0, 777838.0, 17454.0, 784366.0, 783748.0]
Doing local aggregation!
test acc on this client before 445 / 503 : 0.88
Client Index = 10	Epoch: 0	Loss: 0.247106
Client Index = 10	Epoch: 1	Loss: 0.181620
Client Index = 10	Epoch: 2	Loss: 0.204461
Client Index = 10	Epoch: 3	Loss: 0.176289
Client Index = 10	Epoch: 4	Loss: 0.101367
test acc on this client after 428 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 11
local mask changes: 17476.0 / 11173962
choose client_indexes: [ 0  2  5  7 11], accoring to random
choose mask diff: [782676.0, 734388.0, 754524.0, 757578.0, 17476.0]
Doing local aggregation!
test acc on this client before 464 / 504 : 0.92
Client Index = 11	Epoch: 0	Loss: 0.203889
Client Index = 11	Epoch: 1	Loss: 0.105880
Client Index = 11	Epoch: 2	Loss: 0.123232
Client Index = 11	Epoch: 3	Loss: 0.056147
Client Index = 11	Epoch: 4	Loss: 0.059072
test acc on this client after 464 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 12
local mask changes: 17470.0 / 11173962
choose client_indexes: [ 1  3  7 12 16], accoring to random
choose mask diff: [756078.0, 778024.0, 763148.0, 17470.0, 766824.0]
Doing local aggregation!
test acc on this client before 422 / 504 : 0.84
Client Index = 12	Epoch: 0	Loss: 0.251531
Client Index = 12	Epoch: 1	Loss: 0.151452
Client Index = 12	Epoch: 2	Loss: 0.140967
Client Index = 12	Epoch: 3	Loss: 0.191772
Client Index = 12	Epoch: 4	Loss: 0.113847
test acc on this client after 422 / 504 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 13
local mask changes: 17470.0 / 11173962
choose client_indexes: [ 0 13 15 17 18], accoring to random
choose mask diff: [808854.0, 17470.0, 770408.0, 745070.0, 747270.0]
Doing local aggregation!
test acc on this client before 423 / 503 : 0.84
Client Index = 13	Epoch: 0	Loss: 0.271912
Client Index = 13	Epoch: 1	Loss: 0.179232
Client Index = 13	Epoch: 2	Loss: 0.182058
Client Index = 13	Epoch: 3	Loss: 0.136048
Client Index = 13	Epoch: 4	Loss: 0.086538
test acc on this client after 425 / 503 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 14
local mask changes: 17468.0 / 11173962
choose client_indexes: [ 3  6  8 14 15], accoring to random
choose mask diff: [789852.0, 795588.0, 788432.0, 17468.0, 775848.0]
Doing local aggregation!
test acc on this client before 435 / 502 : 0.87
Client Index = 14	Epoch: 0	Loss: 0.324439
Client Index = 14	Epoch: 1	Loss: 0.235722
Client Index = 14	Epoch: 2	Loss: 0.193867
Client Index = 14	Epoch: 3	Loss: 0.170845
Client Index = 14	Epoch: 4	Loss: 0.258130
test acc on this client after 356 / 502 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 15
local mask changes: 17460.0 / 11173962
choose client_indexes: [12 13 14 15 16], accoring to random
choose mask diff: [769326.0, 769988.0, 775764.0, 17460.0, 758212.0]
Doing local aggregation!
test acc on this client before 434 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.179482
Client Index = 15	Epoch: 1	Loss: 0.174151
Client Index = 15	Epoch: 2	Loss: 0.133005
Client Index = 15	Epoch: 3	Loss: 0.136581
Client Index = 15	Epoch: 4	Loss: 0.080929
test acc on this client after 445 / 504 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 16
local mask changes: 17476.0 / 11173962
choose client_indexes: [ 6  8  9 16 19], accoring to random
choose mask diff: [801156.0, 770128.0, 743100.0, 17476.0, 766254.0]
Doing local aggregation!
test acc on this client before 447 / 503 : 0.89
Client Index = 16	Epoch: 0	Loss: 0.234706
Client Index = 16	Epoch: 1	Loss: 0.202185
Client Index = 16	Epoch: 2	Loss: 0.110173
Client Index = 16	Epoch: 3	Loss: 0.095336
Client Index = 16	Epoch: 4	Loss: 0.092914
test acc on this client after 440 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 17
local mask changes: 17470.0 / 11173962
choose client_indexes: [ 2  4  5  6 17], accoring to random
choose mask diff: [731818.0, 730716.0, 726880.0, 773726.0, 17470.0]
Doing local aggregation!
test acc on this client before 428 / 505 : 0.85
Client Index = 17	Epoch: 0	Loss: 0.325428
Client Index = 17	Epoch: 1	Loss: 0.226235
Client Index = 17	Epoch: 2	Loss: 0.105479
Client Index = 17	Epoch: 3	Loss: 0.073722
Client Index = 17	Epoch: 4	Loss: 0.073582
test acc on this client after 374 / 505 : 0.74
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 18
local mask changes: 17474.0 / 11173962
choose client_indexes: [ 8  9 10 11 18], accoring to random
choose mask diff: [754780.0, 736306.0, 769806.0, 735018.0, 17474.0]
Doing local aggregation!
test acc on this client before 443 / 504 : 0.88
Client Index = 18	Epoch: 0	Loss: 0.206993
Client Index = 18	Epoch: 1	Loss: 0.203938
Client Index = 18	Epoch: 2	Loss: 0.158494
Client Index = 18	Epoch: 3	Loss: 0.129249
Client Index = 18	Epoch: 4	Loss: 0.082239
test acc on this client after 439 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(97) with spasity 0.5: 19
local mask changes: 17476.0 / 11173962
choose client_indexes: [ 6  8 17 18 19], accoring to random
choose mask diff: [792108.0, 777828.0, 740368.0, 736802.0, 17476.0]
Doing local aggregation!
test acc on this client before 426 / 506 : 0.84
Client Index = 19	Epoch: 0	Loss: 0.164656
Client Index = 19	Epoch: 1	Loss: 0.115943
Client Index = 19	Epoch: 2	Loss: 0.108220
Client Index = 19	Epoch: 3	Loss: 0.436557
Client Index = 19	Epoch: 4	Loss: 0.088283
test acc on this client after 429 / 506 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 97
{'test_acc': 0.8428909446894866, 'test_loss': 0.5685789452124106}
################local_test_on_all_clients before local training in communication round: 97
{'test_acc': 0.8640429170030149, 'test_loss': 0.4390889531057046}
################Communication round : 98
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 0
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 0  6 16 17 18], accoring to random
choose mask diff: [9842.0, 808978.0, 806630.0, 784250.0, 789936.0]
Doing local aggregation!
test acc on this client before 402 / 504 : 0.80
Client Index = 0	Epoch: 0	Loss: 0.301407
Client Index = 0	Epoch: 1	Loss: 0.292557
Client Index = 0	Epoch: 2	Loss: 0.256669
Client Index = 0	Epoch: 3	Loss: 0.286291
Client Index = 0	Epoch: 4	Loss: 0.285191
test acc on this client after 398 / 504 : 0.79
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 1
local mask changes: 9836.0 / 11173962
choose client_indexes: [ 1  2  7 15 18], accoring to random
choose mask diff: [9836.0, 730496.0, 749202.0, 747506.0, 737014.0]
Doing local aggregation!
test acc on this client before 456 / 503 : 0.91
Client Index = 1	Epoch: 0	Loss: 0.161066
Client Index = 1	Epoch: 1	Loss: 0.412320
Client Index = 1	Epoch: 2	Loss: 0.100002
Client Index = 1	Epoch: 3	Loss: 0.076353
Client Index = 1	Epoch: 4	Loss: 0.072182
test acc on this client after 450 / 503 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 2
local mask changes: 9846.0 / 11173962
choose client_indexes: [ 0  2  5 10 16], accoring to random
choose mask diff: [793848.0, 9846.0, 754892.0, 763050.0, 751452.0]
Doing local aggregation!
test acc on this client before 451 / 502 : 0.90
Client Index = 2	Epoch: 0	Loss: 0.248003
Client Index = 2	Epoch: 1	Loss: 0.191183
Client Index = 2	Epoch: 2	Loss: 0.096449
Client Index = 2	Epoch: 3	Loss: 0.060596
Client Index = 2	Epoch: 4	Loss: 0.061600
test acc on this client after 443 / 502 : 0.88
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 3
local mask changes: 9840.0 / 11173962
choose client_indexes: [ 3  7  9 10 19], accoring to random
choose mask diff: [9840.0, 782108.0, 770648.0, 786184.0, 778142.0]
Doing local aggregation!
test acc on this client before 416 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.352775
Client Index = 3	Epoch: 1	Loss: 0.208071
Client Index = 3	Epoch: 2	Loss: 0.491717
Client Index = 3	Epoch: 3	Loss: 0.150944
Client Index = 3	Epoch: 4	Loss: 0.198839
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 4
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 0  4  8 12 13], accoring to random
choose mask diff: [790442.0, 9842.0, 772680.0, 767592.0, 759848.0]
Doing local aggregation!
test acc on this client before 444 / 503 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.197111
Client Index = 4	Epoch: 1	Loss: 0.178730
Client Index = 4	Epoch: 2	Loss: 0.135495
Client Index = 4	Epoch: 3	Loss: 0.243581
Client Index = 4	Epoch: 4	Loss: 0.083957
test acc on this client after 438 / 503 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 5
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 0  5  6  8 17], accoring to random
choose mask diff: [789892.0, 9842.0, 787682.0, 754602.0, 727046.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 5	Epoch: 0	Loss: 0.258933
Client Index = 5	Epoch: 1	Loss: 0.146482
Client Index = 5	Epoch: 2	Loss: 0.117233
Client Index = 5	Epoch: 3	Loss: 0.086961
Client Index = 5	Epoch: 4	Loss: 0.110963
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 6
local mask changes: 9844.0 / 11173962
choose client_indexes: [ 0  1  6  7 19], accoring to random
choose mask diff: [808770.0, 789340.0, 9844.0, 786944.0, 793286.0]
Doing local aggregation!
test acc on this client before 427 / 505 : 0.85
Client Index = 6	Epoch: 0	Loss: 0.406274
Client Index = 6	Epoch: 1	Loss: 0.374640
Client Index = 6	Epoch: 2	Loss: 0.229295
Client Index = 6	Epoch: 3	Loss: 0.301687
Client Index = 6	Epoch: 4	Loss: 0.187243
test acc on this client after 415 / 505 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 7
local mask changes: 9838.0 / 11173962
choose client_indexes: [ 4  7  8 10 17], accoring to random
choose mask diff: [764992.0, 9838.0, 764142.0, 774420.0, 746132.0]
Doing local aggregation!
test acc on this client before 445 / 504 : 0.88
Client Index = 7	Epoch: 0	Loss: 0.245986
Client Index = 7	Epoch: 1	Loss: 0.168764
Client Index = 7	Epoch: 2	Loss: 0.101373
Client Index = 7	Epoch: 3	Loss: 0.092522
Client Index = 7	Epoch: 4	Loss: 0.243889
test acc on this client after 438 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 8
local mask changes: 9838.0 / 11173962
choose client_indexes: [ 2  5  8  9 18], accoring to random
choose mask diff: [755526.0, 754998.0, 9838.0, 767062.0, 755348.0]
Doing local aggregation!
test acc on this client before 440 / 504 : 0.87
Client Index = 8	Epoch: 0	Loss: 0.353245
Client Index = 8	Epoch: 1	Loss: 0.218959
Client Index = 8	Epoch: 2	Loss: 0.159270
Client Index = 8	Epoch: 3	Loss: 0.140590
Client Index = 8	Epoch: 4	Loss: 0.169121
test acc on this client after 384 / 504 : 0.76
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 9
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 3  5  8  9 13], accoring to random
choose mask diff: [770556.0, 752584.0, 767004.0, 9842.0, 761766.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 9	Epoch: 0	Loss: 0.244787
Client Index = 9	Epoch: 1	Loss: 0.210592
Client Index = 9	Epoch: 2	Loss: 0.111848
Client Index = 9	Epoch: 3	Loss: 0.085908
Client Index = 9	Epoch: 4	Loss: 0.093418
test acc on this client after 431 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 10
local mask changes: 9838.0 / 11173962
choose client_indexes: [ 7 10 14 17 19], accoring to random
choose mask diff: [774696.0, 9838.0, 784554.0, 761812.0, 779824.0]
Doing local aggregation!
test acc on this client before 439 / 503 : 0.87
Client Index = 10	Epoch: 0	Loss: 0.241556
Client Index = 10	Epoch: 1	Loss: 0.158325
Client Index = 10	Epoch: 2	Loss: 0.097545
Client Index = 10	Epoch: 3	Loss: 0.118837
Client Index = 10	Epoch: 4	Loss: 0.173546
test acc on this client after 365 / 503 : 0.73
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 11
local mask changes: 9844.0 / 11173962
choose client_indexes: [ 2 11 14 17 18], accoring to random
choose mask diff: [734166.0, 9844.0, 772512.0, 715984.0, 734688.0]
Doing local aggregation!
test acc on this client before 468 / 504 : 0.93
Client Index = 11	Epoch: 0	Loss: 0.163864
Client Index = 11	Epoch: 1	Loss: 0.110833
Client Index = 11	Epoch: 2	Loss: 0.101765
Client Index = 11	Epoch: 3	Loss: 0.109153
Client Index = 11	Epoch: 4	Loss: 0.080257
test acc on this client after 456 / 504 : 0.90
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 12
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 6 12 14 17 19], accoring to random
choose mask diff: [805614.0, 9842.0, 799226.0, 749150.0, 762864.0]
Doing local aggregation!
test acc on this client before 430 / 504 : 0.85
Client Index = 12	Epoch: 0	Loss: 0.246290
Client Index = 12	Epoch: 1	Loss: 0.185837
Client Index = 12	Epoch: 2	Loss: 0.145979
Client Index = 12	Epoch: 3	Loss: 0.124052
Client Index = 12	Epoch: 4	Loss: 0.119440
test acc on this client after 393 / 504 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 13
local mask changes: 9836.0 / 11173962
choose client_indexes: [ 1  4  7 10 13], accoring to random
choose mask diff: [762098.0, 759972.0, 774520.0, 777620.0, 9836.0]
Doing local aggregation!
test acc on this client before 433 / 503 : 0.86
Client Index = 13	Epoch: 0	Loss: 0.266936
Client Index = 13	Epoch: 1	Loss: 0.152106
Client Index = 13	Epoch: 2	Loss: 0.195078
Client Index = 13	Epoch: 3	Loss: 0.161855
Client Index = 13	Epoch: 4	Loss: 0.104990
test acc on this client after 431 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 14
local mask changes: 9834.0 / 11173962
choose client_indexes: [ 2  4 11 14 18], accoring to random
choose mask diff: [769464.0, 780528.0, 773380.0, 9834.0, 765754.0]
Doing local aggregation!
test acc on this client before 433 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.273541
Client Index = 14	Epoch: 1	Loss: 0.225429
Client Index = 14	Epoch: 2	Loss: 0.321678
Client Index = 14	Epoch: 3	Loss: 0.147319
Client Index = 14	Epoch: 4	Loss: 0.175862
test acc on this client after 420 / 502 : 0.84
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 15
local mask changes: 9844.0 / 11173962
choose client_indexes: [ 2 10 11 15 19], accoring to random
choose mask diff: [754474.0, 767818.0, 757996.0, 9844.0, 771212.0]
Doing local aggregation!
test acc on this client before 436 / 504 : 0.87
Client Index = 15	Epoch: 0	Loss: 0.189930
Client Index = 15	Epoch: 1	Loss: 0.160772
Client Index = 15	Epoch: 2	Loss: 0.150253
Client Index = 15	Epoch: 3	Loss: 0.138937
Client Index = 15	Epoch: 4	Loss: 0.080689
test acc on this client after 418 / 504 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 16
local mask changes: 9854.0 / 11173962
choose client_indexes: [ 3  5 11 16 18], accoring to random
choose mask diff: [764444.0, 757326.0, 744266.0, 9854.0, 736872.0]
Doing local aggregation!
test acc on this client before 453 / 503 : 0.90
Client Index = 16	Epoch: 0	Loss: 0.183322
Client Index = 16	Epoch: 1	Loss: 0.159658
Client Index = 16	Epoch: 2	Loss: 0.133940
Client Index = 16	Epoch: 3	Loss: 0.089108
Client Index = 16	Epoch: 4	Loss: 0.082212
test acc on this client after 412 / 503 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 17
local mask changes: 9832.0 / 11173962
choose client_indexes: [ 0  3  9 16 17], accoring to random
choose mask diff: [783538.0, 758260.0, 727384.0, 743958.0, 9832.0]
Doing local aggregation!
test acc on this client before 426 / 505 : 0.84
Client Index = 17	Epoch: 0	Loss: 0.230611
Client Index = 17	Epoch: 1	Loss: 0.367926
Client Index = 17	Epoch: 2	Loss: 0.115134
Client Index = 17	Epoch: 3	Loss: 0.088116
Client Index = 17	Epoch: 4	Loss: 0.198536
test acc on this client after 448 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 18
local mask changes: 9834.0 / 11173962
choose client_indexes: [ 1  4  5 18 19], accoring to random
choose mask diff: [737128.0, 740006.0, 740416.0, 9834.0, 736920.0]
Doing local aggregation!
test acc on this client before 456 / 504 : 0.90
Client Index = 18	Epoch: 0	Loss: 0.225643
Client Index = 18	Epoch: 1	Loss: 0.148363
Client Index = 18	Epoch: 2	Loss: 0.135786
Client Index = 18	Epoch: 3	Loss: 0.193634
Client Index = 18	Epoch: 4	Loss: 0.119485
test acc on this client after 449 / 504 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(98) with spasity 0.5: 19
local mask changes: 9842.0 / 11173962
choose client_indexes: [ 5 10 12 13 19], accoring to random
choose mask diff: [765230.0, 779790.0, 762774.0, 766058.0, 9842.0]
Doing local aggregation!
test acc on this client before 432 / 506 : 0.85
Client Index = 19	Epoch: 0	Loss: 0.186216
Client Index = 19	Epoch: 1	Loss: 0.135907
Client Index = 19	Epoch: 2	Loss: 0.202936
Client Index = 19	Epoch: 3	Loss: 0.102205
Client Index = 19	Epoch: 4	Loss: 0.098589
test acc on this client after 418 / 506 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 98
{'test_acc': 0.8377226349424353, 'test_loss': 0.5867292996133038}
################local_test_on_all_clients before local training in communication round: 98
{'test_acc': 0.8687052334129778, 'test_loss': 0.4273916763252985}
################Communication round : 99
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 0
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 0  2  8 10 15], accoring to random
choose mask diff: [4384.0, 794898.0, 810790.0, 806610.0, 799532.0]
Doing local aggregation!
test acc on this client before 386 / 504 : 0.77
Client Index = 0	Epoch: 0	Loss: 0.351507
Client Index = 0	Epoch: 1	Loss: 0.287661
Client Index = 0	Epoch: 2	Loss: 0.297130
Client Index = 0	Epoch: 3	Loss: 0.173082
Client Index = 0	Epoch: 4	Loss: 0.206086
test acc on this client after 403 / 504 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 1
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 1  6 11 14 19], accoring to random
choose mask diff: [4386.0, 789608.0, 730708.0, 777874.0, 753936.0]
Doing local aggregation!
test acc on this client before 445 / 503 : 0.88
Client Index = 1	Epoch: 0	Loss: 0.144316
Client Index = 1	Epoch: 1	Loss: 0.114174
Client Index = 1	Epoch: 2	Loss: 0.091104
Client Index = 1	Epoch: 3	Loss: 0.291277
Client Index = 1	Epoch: 4	Loss: 0.118282
test acc on this client after 417 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 2
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 1  2  7 12 14], accoring to random
choose mask diff: [730898.0, 4384.0, 748938.0, 761048.0, 769678.0]
Doing local aggregation!
test acc on this client before 462 / 502 : 0.92
Client Index = 2	Epoch: 0	Loss: 0.131062
Client Index = 2	Epoch: 1	Loss: 0.087707
Client Index = 2	Epoch: 2	Loss: 0.249696
Client Index = 2	Epoch: 3	Loss: 0.066017
Client Index = 2	Epoch: 4	Loss: 0.048953
test acc on this client after 455 / 502 : 0.91
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 3
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 3 10 12 14 17], accoring to random
choose mask diff: [4386.0, 786916.0, 779426.0, 791206.0, 758974.0]
Doing local aggregation!
test acc on this client before 419 / 504 : 0.83
Client Index = 3	Epoch: 0	Loss: 0.382726
Client Index = 3	Epoch: 1	Loss: 0.222886
Client Index = 3	Epoch: 2	Loss: 0.181549
Client Index = 3	Epoch: 3	Loss: 0.206708
Client Index = 3	Epoch: 4	Loss: 0.213084
test acc on this client after 357 / 504 : 0.71
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 4
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 4 10 11 12 14], accoring to random
choose mask diff: [4386.0, 765332.0, 740166.0, 768132.0, 780904.0]
Doing local aggregation!
test acc on this client before 444 / 503 : 0.88
Client Index = 4	Epoch: 0	Loss: 0.257461
Client Index = 4	Epoch: 1	Loss: 0.147744
Client Index = 4	Epoch: 2	Loss: 0.105361
Client Index = 4	Epoch: 3	Loss: 0.113295
Client Index = 4	Epoch: 4	Loss: 0.101663
test acc on this client after 416 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 5
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 0  5  6 13 17], accoring to random
choose mask diff: [790304.0, 4388.0, 788280.0, 774330.0, 727058.0]
Doing local aggregation!
test acc on this client before 441 / 504 : 0.88
Client Index = 5	Epoch: 0	Loss: 0.244388
Client Index = 5	Epoch: 1	Loss: 0.144574
Client Index = 5	Epoch: 2	Loss: 0.141006
Client Index = 5	Epoch: 3	Loss: 0.134172
Client Index = 5	Epoch: 4	Loss: 0.106256
test acc on this client after 411 / 504 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 6
local mask changes: 4382.0 / 11173962
choose client_indexes: [ 1  2  3  6 14], accoring to random
choose mask diff: [789642.0, 783864.0, 806318.0, 4382.0, 797166.0]
Doing local aggregation!
test acc on this client before 427 / 505 : 0.85
Client Index = 6	Epoch: 0	Loss: 0.344757
Client Index = 6	Epoch: 1	Loss: 0.340592
Client Index = 6	Epoch: 2	Loss: 0.224064
Client Index = 6	Epoch: 3	Loss: 0.261491
Client Index = 6	Epoch: 4	Loss: 0.180400
test acc on this client after 396 / 505 : 0.78
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 7
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 7 15 16 17 19], accoring to random
choose mask diff: [4384.0, 761714.0, 762208.0, 746250.0, 774360.0]
Doing local aggregation!
test acc on this client before 456 / 504 : 0.90
Client Index = 7	Epoch: 0	Loss: 0.359882
Client Index = 7	Epoch: 1	Loss: 0.184774
Client Index = 7	Epoch: 2	Loss: 0.134467
Client Index = 7	Epoch: 3	Loss: 0.223937
Client Index = 7	Epoch: 4	Loss: 0.090504
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 8
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 4  6  8  9 12], accoring to random
choose mask diff: [773280.0, 787972.0, 4384.0, 767574.0, 780566.0]
Doing local aggregation!
test acc on this client before 447 / 504 : 0.89
Client Index = 8	Epoch: 0	Loss: 0.381068
Client Index = 8	Epoch: 1	Loss: 0.203907
Client Index = 8	Epoch: 2	Loss: 0.215511
Client Index = 8	Epoch: 3	Loss: 0.231469
Client Index = 8	Epoch: 4	Loss: 0.109250
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 9
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 4  9 11 13 14], accoring to random
choose mask diff: [756844.0, 4386.0, 736454.0, 762114.0, 774592.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 9	Epoch: 0	Loss: 0.313506
Client Index = 9	Epoch: 1	Loss: 0.169330
Client Index = 9	Epoch: 2	Loss: 0.120898
Client Index = 9	Epoch: 3	Loss: 0.092208
Client Index = 9	Epoch: 4	Loss: 0.114367
test acc on this client after 428 / 504 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 10
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 0  2  6 10 12], accoring to random
choose mask diff: [806412.0, 763878.0, 801292.0, 4388.0, 785596.0]
Doing local aggregation!
test acc on this client before 444 / 503 : 0.88
Client Index = 10	Epoch: 0	Loss: 0.212045
Client Index = 10	Epoch: 1	Loss: 0.398007
Client Index = 10	Epoch: 2	Loss: 0.134140
Client Index = 10	Epoch: 3	Loss: 0.147384
Client Index = 10	Epoch: 4	Loss: 0.169671
test acc on this client after 427 / 503 : 0.85
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 11
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 0  3  7 11 12], accoring to random
choose mask diff: [784268.0, 768876.0, 758000.0, 4384.0, 764534.0]
Doing local aggregation!
test acc on this client before 460 / 504 : 0.91
Client Index = 11	Epoch: 0	Loss: 0.157687
Client Index = 11	Epoch: 1	Loss: 0.264498
Client Index = 11	Epoch: 2	Loss: 0.090917
Client Index = 11	Epoch: 3	Loss: 0.056592
Client Index = 11	Epoch: 4	Loss: 0.057029
test acc on this client after 464 / 504 : 0.92
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 12
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 0  6 12 13 19], accoring to random
choose mask diff: [803054.0, 806254.0, 4388.0, 777416.0, 763362.0]
Doing local aggregation!
test acc on this client before 435 / 504 : 0.86
Client Index = 12	Epoch: 0	Loss: 0.228595
Client Index = 12	Epoch: 1	Loss: 0.182411
Client Index = 12	Epoch: 2	Loss: 0.241078
Client Index = 12	Epoch: 3	Loss: 0.155268
Client Index = 12	Epoch: 4	Loss: 0.100101
test acc on this client after 409 / 504 : 0.81
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 13
local mask changes: 4388.0 / 11173962
choose client_indexes: [12 13 14 17 18], accoring to random
choose mask diff: [777424.0, 4388.0, 791822.0, 745418.0, 747750.0]
Doing local aggregation!
test acc on this client before 431 / 503 : 0.86
Client Index = 13	Epoch: 0	Loss: 0.236979
Client Index = 13	Epoch: 1	Loss: 0.297788
Client Index = 13	Epoch: 2	Loss: 0.131468
Client Index = 13	Epoch: 3	Loss: 0.119685
Client Index = 13	Epoch: 4	Loss: 0.155759
test acc on this client after 420 / 503 : 0.83
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 14
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 5 10 11 14 15], accoring to random
choose mask diff: [777936.0, 785676.0, 773660.0, 4386.0, 776868.0]
Doing local aggregation!
test acc on this client before 431 / 502 : 0.86
Client Index = 14	Epoch: 0	Loss: 0.277461
Client Index = 14	Epoch: 1	Loss: 0.255410
Client Index = 14	Epoch: 2	Loss: 0.168598
Client Index = 14	Epoch: 3	Loss: 0.221614
Client Index = 14	Epoch: 4	Loss: 0.148136
test acc on this client after 404 / 502 : 0.80
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 15
local mask changes: 4384.0 / 11173962
choose client_indexes: [ 0  2  3 12 15], accoring to random
choose mask diff: [799310.0, 754806.0, 782408.0, 770238.0, 4384.0]
Doing local aggregation!
test acc on this client before 432 / 504 : 0.86
Client Index = 15	Epoch: 0	Loss: 0.257024
Client Index = 15	Epoch: 1	Loss: 0.137566
Client Index = 15	Epoch: 2	Loss: 0.094374
Client Index = 15	Epoch: 3	Loss: 0.095410
Client Index = 15	Epoch: 4	Loss: 0.104227
test acc on this client after 433 / 504 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 16
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 1  2 13 16 18], accoring to random
choose mask diff: [744270.0, 752002.0, 765952.0, 4388.0, 737212.0]
Doing local aggregation!
test acc on this client before 447 / 503 : 0.89
Client Index = 16	Epoch: 0	Loss: 0.162811
Client Index = 16	Epoch: 1	Loss: 0.145722
Client Index = 16	Epoch: 2	Loss: 0.113375
Client Index = 16	Epoch: 3	Loss: 0.128541
Client Index = 16	Epoch: 4	Loss: 0.079416
test acc on this client after 433 / 503 : 0.86
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 17
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 8 13 14 17 18], accoring to random
choose mask diff: [760744.0, 745220.0, 762742.0, 4386.0, 722990.0]
Doing local aggregation!
test acc on this client before 409 / 505 : 0.81
Client Index = 17	Epoch: 0	Loss: 0.266967
Client Index = 17	Epoch: 1	Loss: 0.126084
Client Index = 17	Epoch: 2	Loss: 0.105537
Client Index = 17	Epoch: 3	Loss: 0.164530
Client Index = 17	Epoch: 4	Loss: 0.076071
test acc on this client after 450 / 505 : 0.89
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 18
local mask changes: 4388.0 / 11173962
choose client_indexes: [ 9 12 14 17 18], accoring to random
choose mask diff: [736742.0, 758928.0, 766028.0, 723008.0, 4388.0]
Doing local aggregation!
test acc on this client before 448 / 504 : 0.89
Client Index = 18	Epoch: 0	Loss: 0.239422
Client Index = 18	Epoch: 1	Loss: 0.356168
Client Index = 18	Epoch: 2	Loss: 0.130838
Client Index = 18	Epoch: 3	Loss: 0.144096
Client Index = 18	Epoch: 4	Loss: 0.078471
test acc on this client after 436 / 504 : 0.87
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
@@@@@@@@@@@@@@@@ Training Client CM(99) with spasity 0.5: 19
local mask changes: 4386.0 / 11173962
choose client_indexes: [ 1  2  3 13 19], accoring to random
choose mask diff: [754002.0, 754894.0, 778608.0, 766618.0, 4386.0]
Doing local aggregation!
test acc on this client before 432 / 506 : 0.85
Client Index = 19	Epoch: 0	Loss: 0.156670
Client Index = 19	Epoch: 1	Loss: 0.173846
Client Index = 19	Epoch: 2	Loss: 0.119546
Client Index = 19	Epoch: 3	Loss: 0.134794
Client Index = 19	Epoch: 4	Loss: 0.090851
test acc on this client after 413 / 506 : 0.82
-----------------------------------
training flops per data 2653344000.0
full flops for search 3332536350
################local_test_on_all_clients after local training in communication round: 99
{'test_acc': 0.8378289134319102, 'test_loss': 0.5628343515546539}
################local_test_on_all_clients before local training in communication round: 99
{'test_acc': 0.8666260356885782, 'test_loss': 0. }
